let viewportGoals=[],burst_goals_setup=()=>{for(let e=0;e<burst.goals.active.length;e++){var t=burst.goals.active[e];t.url&&t.url!==window.location.pathname&&"*"!==t.url&&burst.goals.active.splice(e,1)}for(let e=0;e<burst.goals.active.length;e++){var r=burst.goals.active[e];("views"===r.type?burst_setup_viewport_tracker:burst_setup_click_tracker)(r)}window.addEventListener("scroll",handle_viewport_goals,!0)},handle_viewport_goals=()=>{[...viewportGoals].forEach((t,e)=>{var r;burst_is_element_in_viewport(t.element)&&(burst_goal_triggered(t.goal),-1!==(r=viewportGoals.findIndex(e=>e.goal.ID===t.goal.ID)))&&viewportGoals.splice(r,1)})},burst_setup_viewport_tracker=t=>{if(0!==t.attribute_value.length){var r=document.querySelectorAll(("id"===t.attribute?"#":".")+t.attribute_value);for(let e=0;e<r.length;e++){var i=r[e];burst_is_element_in_viewport(i)?burst_goal_triggered(t):viewportGoals.push({element:i,goal:t})}}},is_element_truly_visible=e=>{var t;return!e||"none"!==(t=window.getComputedStyle(e)).display&&"0"!==t.opacity&&is_element_truly_visible(e.parentElement)},burst_is_element_in_viewport=e=>!!is_element_truly_visible(e)&&0<=(e=e.getBoundingClientRect()).top&&0<=e.left&&e.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&e.right<=(window.innerWidth||document.documentElement.clientWidth),burst_listener_view=(e,t)=>{burst_is_element_in_viewport(e)&&(burst_goal_triggered(t),window.removeEventListener("scroll",()=>burst_listener_view(e,t),!0))},burst_setup_click_tracker=t=>{document.body.addEventListener("click",function(e){burst_recursive_trigger_check(e.target,t)})},burst_recursive_trigger_check=(e,t)=>{0!==t.attribute_value.length&&(e.matches(("id"===t.attribute?"#":".")+t.attribute_value)?burst_goal_triggered(t):e.parentElement&&burst_recursive_trigger_check(e.parentElement,t))},burst_goal_triggered=e=>{let t=parseInt(e.ID,10);-1===burst.goals.completed.indexOf(t)&&(burst.goals.completed.push(t),viewportGoals=viewportGoals.filter(e=>parseInt(e.goal.ID,10)!==t)),burst_update_hit(!1,!0)};export default()=>{burst_goals_setup()};