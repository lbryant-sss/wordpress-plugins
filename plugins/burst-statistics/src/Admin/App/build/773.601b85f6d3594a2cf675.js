"use strict";(globalThis.webpackChunkburst_statistics=globalThis.webpackChunkburst_statistics||[]).push([[773],{240:(e,t,r)=>{r.d(t,{c:()=>u});var n=r(71511),a=r(87134),i=r(1932),s=r(27723),o=function(){return o=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},o.apply(this,arguments)},l={page_url:{label:(0,s.__)("Page","burst-statistics"),icon:"page"},goal_id:{label:(0,s.__)("Goal","burst-statistics"),icon:"goals"},referrer:{label:(0,s.__)("Referrer URL","burst-statistics"),icon:"referrer"},device:{label:(0,s.__)("Device","burst-statistics"),icon:"desktop"},browser:{label:(0,s.__)("Browser","burst-statistics"),icon:"browser"},platform:{label:(0,s.__)("Operating System","burst-statistics"),icon:"operating-system"},country_code:{label:(0,s.__)("Country","burst-statistics"),icon:"world"},continent_code:{label:(0,s.__)("Continent","burst-statistics"),icon:"world"},county:{label:(0,s.__)("County","burst-statistics"),icon:"world"},city:{label:(0,s.__)("City","burst-statistics"),icon:"world"}},c=Object.keys(l).reduce((function(e,t){return e[t]="",e}),{}),u=(0,n.v)((0,a.Zr)((function(e){return{filters:c,filtersConf:l,setFilters:function(t,r){e((function(e){return(0,i.jM)(e,(function(e){e.filters[t]=r}))}))},deleteFilter:function(t){e((function(e){return(0,i.jM)(e,(function(e){e.filters[t]=""}))}))},clearAllFilters:function(){e((function(e){return(0,i.jM)(e,(function(e){e.filters=o({},c)}))}))},getActiveFilters:function(){var e=u.getState().filters;return Object.entries(e).filter((function(e){return e[0],""!==e[1]})).reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})},hasActiveFilters:function(){var e=u.getState().filters;return Object.values(e).some((function(e){return""!==e}))}}}),{name:"burst-filters-storage",partialize:function(e){return{filters:e.filters}}}))},332:(e,t,r)=>{r.d(t,{G:()=>i});var n=r(71511),a=r(87134),i=(0,n.v)((0,a.Zr)((function(e,t){return{metrics:["visitors","pageviews"],loaded:!1,getMetrics:function(){if(t().loaded)return t().metrics;var r=t().metrics||["visitors","pageviews"];return r=r.filter((function(e){return"conversions"!==e})),e({metrics:r,loaded:!0}),r},setMetrics:function(t){e({metrics:t})}}}),{name:"burst-insights-storage",partialize:function(e){return{metrics:e.metrics}},onRehydrateStorage:function(){return function(e){e&&e.metrics&&(e.metrics=e.metrics.filter((function(e){return"conversions"!==e})))}}}))},681:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(74848),a=r(51609),i=r(27723),s=r(57112),o=(0,a.forwardRef)((function(e,t){var r=e.id,a=e.name,o=e.value,l=e.label,c=e.checked,u=e.disabled,d=void 0!==u&&u,f=e.onChange,m=e.className,p=void 0===m?"":m,h=e.tooltip,g=void 0===h?"":h,v=e.recommended,b=void 0!==v&&v,y=e.children;return(0,n.jsxs)("div",{className:"flex items-center gap-2 ".concat(p),children:[(0,n.jsx)("input",{ref:t,type:"radio",id:r,name:a,value:o,checked:c,disabled:d,onChange:function(e){return f(e.target.value)},className:"h-4 w-4 text-primary focus:ring-primary border-gray-300 my-1 mx-0"}),(0,n.jsxs)("label",{htmlFor:r,className:"text-sm text-gray cursor-pointer",children:[l," ",y," ",b&&(0,n.jsxs)("span",{className:"text-xs font-semibold",children:["(",(0,i.__)("Recommended","burst-statistics"),")"]})]}),g&&(0,n.jsx)(s.A,{tooltip:g,color:"blue",name:"help",size:16,className:"bg-blue-light rounded-full"})]})}));o.displayName="RadioInput";const l=o},5560:(e,t,r)=>{r.d(t,{A:()=>l});var n=r(74848),a=r(51609),i=r(79014),s=function(){return s=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},s.apply(this,arguments)},o=(0,a.forwardRef)((function(e,t){var r=e.value,a=e.onChange,o=e.disabled,l=e.required,c=e.size,u=void 0===c?"default":c,d=e.className,f=void 0===d?"":d,m=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}(e,["value","onChange","disabled","required","size","className"]),p="string"==typeof r?"1"===r:Boolean(r),h="small"===u?"w-8 h-5":"w-10 h-6",g="small"===u?"w-3 h-3 translate-x-1 data-[state=checked]:translate-x-4":"w-4 h-4 translate-x-1 data-[state=checked]:translate-x-5";return(0,n.jsx)("div",{className:"flex items-center",children:(0,n.jsx)(i.bL,s({ref:t,className:"".concat(h," bg-gray-400 rounded-full relative focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed data-[state=checked]:bg-primary ").concat(f),checked:p,onCheckedChange:a,disabled:o,required:l},m,{children:(0,n.jsx)(i.zi,{className:"block ".concat(g," bg-white rounded-full shadow transform transition-transform duration-200")})}))})}));o.displayName="SwitchInput";const l=o},17926:(e,t,r)=>{r.d(t,{e:()=>s});var n=r(74848),a=r(34164),i=r(96850),s=(0,r(51609).memo)((function(e){var t=e.className,r=void 0===t?"":t,s=e.children;return(0,n.jsx)(i.A,{children:(0,n.jsx)("div",{className:(0,a.A)("col-span-12 flex flex-col rounded-xl bg-white shadow-md relative border border-gray-100",r),children:s})})}));s.displayName="Block"},22773:(e,t,r)=>{r.r(t),r.d(t,{component:()=>et});var n=r(74848),a=r(47307),i=r(41437),s=r(46241),o=r(240),l=r(27723),c=r(17926),u=r(96744),d=r(43933),f=r(51609),m=r(74988),p=(r(96714),r(30806)),h=r(7616),g=r(50183),v=r(48710);const b=(0,f.memo)((function(e){var t=e.path,r=e.graticule,a=e.lineWidth,i=e.lineColor;return(0,n.jsx)("path",{fill:"none",strokeWidth:a,stroke:i,d:t(r())})}));var y=(0,f.memo)((function(e){var t,r=e.feature,a=e.path,i=e.fillColor,s=e.borderWidth,o=e.borderColor,l=e.onClick,c=e.onMouseEnter,u=e.onMouseMove,d=e.onMouseLeave,f=e.opacity,m=void 0===f?1:f;return(0,n.jsx)("path",{fill:null!==(t=null==r?void 0:r.fill)&&void 0!==t?t:i,strokeWidth:s,stroke:o,strokeLinejoin:"bevel",d:a(r),opacity:m,style:{cursor:l?"pointer":"default"},onMouseEnter:function(e){return null==c?void 0:c(r,e)},onMouseMove:function(e){return null==u?void 0:u(r,e)},onMouseLeave:function(e){return null==d?void 0:d(r,e)},onClick:function(e){return null==l?void 0:l(r,e)}},r.id)}));const x=y;var j=r(1882),w=r.n(j),_=r(58156),N=r.n(_),A=r(80902),k=r(90940),M=r(27380),C=r(89110),O=r(17100),D=r(52228),S=r(28878),T=r(77144),F=r(80608),E=r(64620),P=r(73102),I=r(85891),z=r(41647),V=r(24028),L=r(51004),G=r(2538),R=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},q={blues:["#f7fbff","#deebf7","#9ecae1","#6baed6","#3182bd","#08519c","#08306b"],greens:["#d5edce","#c1e2ba","#a1d99b","#41ab5d","#238b45","#006d2c","#00441b"],reds:["#ffebee","#ffcdd2","#ef9a9a","#e53935","#cb181d","#a50f15","#67000d"],blueRedDiverging:["#313695","#74add1","#e0f3f8","#ffffbf","#fee090","#f46d43","#a50026"],greenRedDiverging:["#006837","#66bd63","#d9ef8b","#ffffbf","#fee08b","#f46d43","#a50026"]},W=function(e){if(!e||0===e.length)return[];var t=e.map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)&&isFinite(e)}));if(0===t.length)return[];var r=t.filter((function(e){return e>0})),n=t.some((function(e){return 0===e}));if(0===r.length)return n?[0,0]:[];if(r.length<2)return n?[0,r[0]]:[r[0],r[0]];var a=R([],r,!0).sort((function(e,t){return e-t})),i=Math.max(3,Math.min(7,Math.ceil(1+Math.log2(a.length)))),s=[];n&&s.push(0);for(var o=1;o<i;o++){var l=o/i*(a.length-1),c=Math.floor(l),u=Math.ceil(l);if(c===u){var d=a[c];s.push(d)}else{var f=l-c,m=a[c]*(1-f)+a[u]*f;s.push(m)}}var p=a[a.length-1];s[s.length-1]!==p&&s.push(p);var h=s.sort((function(e,t){return e-t})),g=[];for(o=0;o<h.length;o++)(0===o||Math.abs(h[o]-h[o-1])>1e-10)&&g.push(h[o]);return g},U=function(e){if(!e||0===e.length)return[];var t=e.map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)&&isFinite(e)}));if(0===t.length)return[];var r=Math.min.apply(Math,t),n=Math.max.apply(Math,t),a=Math.max(3,Math.min(7,Math.ceil(1+Math.log2(t.length))));0===r&&100===n&&(a=5);for(var i=(n-r)/a,s=[],o=0;o<=a;o++)s.push(r+i*o);return s},B=function(e){if(!e||0===e.length)return[];var t=e.map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)&&isFinite(e)}));if(0===t.length)return[];for(var r=t.reduce((function(e,t){return e+t}),0)/t.length,n=t.reduce((function(e,t){return e+Math.pow(t-r,2)}),0)/t.length,a=Math.sqrt(n),i=Math.min.apply(Math,t),s=Math.max.apply(Math,t),o=(s-i)/(2*a),l=o>=3?7:o>=2?5:o>=1?4:3,c=Math.floor(l/2),u=[],d=-c;d<=c;d++){var f=r+d*a;u.push(f)}l%2==0&&u.push(r+(c+1)*a),u.sort((function(e,t){return e-t}));var m=u.map((function(e){return Math.max(Math.min(e,s),i)})),p=new Set(m),h=Array.from(p).sort((function(e,t){return e-t}));if(h.length<3)throw new Error("Standard deviation classification failed: data distribution does not allow for meaningful standard deviation classes");for(var g=R([],h,!0);g.length>l+1;){var v=Math.floor(g.length/2);g.splice(v,1)}for(;g.length<l+1;){var b=g.length-1,y=[];for(d=0;d<b;d++)if(y.push(g[d]),g.length<l+1){var x=(g[d]+g[d+1])/2;y.push(x)}if(y.push(g[g.length-1]),g=Array.from(new Set(y)).sort((function(e,t){return e-t})),y.length===g.length)break}return g[0]=i,g[g.length-1]=s,g},Z=r(80900),J=function(){return J=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},J.apply(this,arguments)},Q=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},K={azimuthalEqualArea:k.A,azimuthalEquidistant:M.A,gnomonic:C.A,orthographic:O.A,stereographic:D.A,equalEarth:S.A,equirectangular:T.A,mercator:F.Ay,transverseMercator:E.A,naturalEarth1:P.A},H=function(e){var t=e.features,r=e.data,n=e.match,a=e.label,i=e.value,s=e.valueFormat,o=e.unknownColor,l=e.domain,c=e.metric,u=e.colors,d=e.patternsEnabled,m=void 0!==d&&d,p=e.zoomLevel,h=void 0===p?1:p,g=e.classificationMethod,v=void 0===g?"quantile":g,b=e.metricOptions,y=void 0===b?{}:b,x=(0,f.useMemo)((function(){return r&&r.length>0&&r.some((function(e){var t=e[c];return null!=t&&!isNaN(t)&&isFinite(t)}))}),[r,c]),j=(0,f.useMemo)((function(){if(!x||!t)return null;var e=t.length,n=r.map((function(e){return e[c]})).filter((function(e){return null!=e&&!isNaN(e)&&isFinite(e)}));return e>n.length&&(n=Q(Q([],n,!0),Array(Math.min(e-n.length,195)).fill(0),!0)),n}),[r,c,t,x]),_=(0,f.useMemo)((function(){if(!x||!r)return null;var e=r.map((function(e){return e[c]})).filter((function(e){return null!=e&&!isNaN(e)&&e>0}));if(0===e.length)return null;var t=Math.min.apply(Math,e),n=Math.max.apply(Math,e);return{min:t,max:n,range:n-t}}),[r,c,x]),k=(0,f.useMemo)((function(){if(!m)return[];var e=function(e,t){return h<=2?{size:e,spacing:t}:h<=10?{size:.5*e,spacing:.5*t}:h<=20?{size:.25*e,spacing:.25*t}:{size:.15*e,spacing:.15*t}};return[J(J({id:"dots-very-low",type:"patternDots",background:"inherit",color:"rgba(0, 0, 0, 0.6)"},e(1,3)),{stagger:!1}),{id:"lines-low",type:"patternLines",background:"inherit",color:"rgba(0, 0, 0, 0.5)",spacing:e(3,0).size,rotation:0,lineWidth:Math.max(1,e(1,0).size)},J(J({id:"squares-low-medium",type:"patternSquares",background:"inherit",color:"rgba(0, 0, 0, 0.4)"},e(2,3)),{stagger:!1}),{id:"lines-medium",type:"patternLines",background:"inherit",color:"rgba(0, 0, 0, 0.5)",spacing:e(4,0).size,rotation:45,lineWidth:Math.max(1,e(2,0).size)},{id:"lines-medium-high",type:"patternLines",background:"inherit",color:"rgba(0, 0, 0, 0.6)",spacing:e(3,0).size,rotation:90,lineWidth:Math.max(1,e(1,0).size)},J(J({id:"squares-high",type:"patternSquares",background:"inherit",color:"rgba(0, 0, 0, 0.5)"},e(4,1)),{stagger:!0}),J(J({id:"dots-very-high",type:"patternDots",background:"inherit",color:"rgba(0, 0, 0, 0.7)"},e(4,1)),{stagger:!0})]}),[m,h]),M=(0,f.useCallback)((function(e,t,r){return{match:function(r){if(!m||!_)return!1;if(!r||!r.value||0===r.value)return!1;if(_.range<=0)return!1;var n=(r.value-_.min)/_.range;return n>=e&&n<t},id:r}}),[null==_?void 0:_.min,null==_?void 0:_.max,null==_?void 0:_.range,m]),C=(0,f.useMemo)((function(){return m?[M(0,1/7,"dots-very-low"),M(1/7,2/7,"lines-low"),M(2/7,3/7,"squares-low-medium"),M(3/7,4/7,"lines-medium"),M(4/7,5/7,"lines-medium-high"),M(5/7,6/7,"squares-high"),M(6/7,1,"dots-very-high")]:[]}),[M,m]),O=(0,f.useMemo)((function(){return x&&j?function(e,t,r,n){if(void 0===t&&(t=[0,100]),void 0===r&&(r="quantile"),void 0===n&&(n=[0,0]),!e)throw new Error("colorScheme parameter is required");var a;if("string"==typeof e){if(!q[e])throw new Error("Unknown color scheme '".concat(e,"'. Available schemes: ").concat(Object.keys(q).join(", ")));a=q[e]}else{if(!Array.isArray(e))throw new Error("colorScheme must be either a string key or an array of colors");if(0===e.length)throw new Error("Color scheme array cannot be empty");a=e}var i=["quantile","equal-interval","standard-deviation","natural-breaks"];if(!i.includes(r))throw new Error("Invalid classification method '".concat(r,"'. Valid methods: ").concat(i.join(", ")));if(null==n)return null;if(!Array.isArray(n))throw new Error("values parameter must be an array when provided");if(0===n.length)return null;var s,o,l=n.filter((function(e){return null!=e&&!isNaN(e)&&isFinite(e)}));if(0===l.length)return null;if(l.length<2)return null;if(!Array.isArray(t))throw new Error("domain parameter must be an array");try{s=function(e,t){if(void 0===t&&(t="quantile"),!e||!Array.isArray(e))return console.error("values parameter must be an array"),[];if(0===e.length)return console.error("values array cannot be empty"),[];var r=e.filter((function(e){return null!=e&&!isNaN(e)&&isFinite(e)}));if(0===r.length)return console.error("validValues array cannot be empty"),[];if(r.length<2)return console.error("validValues array must have at least 2 values"),[];var n,a=["quantile","equal-interval","standard-deviation","natural-breaks"];if(!a.includes(t))return console.error("Invalid classification method '".concat(t,"'. Valid methods: ").concat(a.join(", "))),[];try{switch(t){case"natural-breaks":n=function(e,t){if(!e||0===e.length)return[];if((!t||t<=0)&&(t=Math.max(3,Math.min(7,Math.ceil(1+Math.log2(e.length))))),t<=0)return[];var r=e.map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)&&isFinite(e)}));if(0===r.length)return[];var n=r,a=new Set(n),i=Array.from(a);if(i.length<t)return i.sort((function(e,t){return e-t}));var s,o,l=R([],n,!0).sort((function(e,t){return e-t})),c=l.length;if(t+1<=0||c+1<=0)return console.error("[ERROR] jenksNaturalBreaks: Invalid matrix dimensions: ".concat(t+1," x ").concat(c+1)),[];if(t+1>1e4||c+1>1e4)return console.error("[ERROR] jenksNaturalBreaks: Matrix dimensions too large: ".concat(t+1," x ").concat(c+1)),[];try{s=Array(t+1).fill(0).map((function(){return Array(c+1).fill(0)})),o=Array(t+1).fill(0).map((function(){return Array(c+1).fill(0)}))}catch(e){return console.error("[ERROR] jenksNaturalBreaks: Failed to create matrices:",e),[]}for(var u=function(e,t){for(var r=0,n=0,a=e;a<t;a++)r+=l[a],n+=l[a]*l[a];return n-r*(r/(t-e))},d=1;d<=c;d++)s[1][d]=u(0,d);for(var f=2;f<=t;f++)for(d=f;d<=c;d++){for(var m=1/0,p=-1,h=f-1;h<d;h++){var g=s[f-1][h]+u(h,d);g<m&&(m=g,p=h)}s[f][d]=m,o[f][d]=p}var v=[],b=c;for(f=t;f>0;f--)f===t&&v.push(l[b-1]),0!==(b=o[f][b])&&v.push(l[b-1]);v.push(l[0]);var y=v.reverse(),x=[];for(d=0;d<y.length;d++)(0===d||Math.abs(y[d]-y[d-1])>1e-10)&&x.push(y[d]);return x}(r);break;case"equal-interval":n=U(r);break;case"standard-deviation":n=B(r);break;case"quantile":n=W(r)}}catch(e){return console.error("classification method failed",e),[]}return!n||n.length<2?(console.error("classification result is invalid"),[]):n}(n,r)}catch(e){return console.error("[WorldMap] Classification failed:",e),null}if(!s||s.length<2)return console.warn("[WorldMap] Invalid breaks, returning null."),null;if(s.length-1<1)throw new Error("Classification resulted in no valid classes");if(o=a,s.length>2){var c=s.slice(1,-1),u=(0,L.A)().domain(c).range(o);return(d=function(e){return 0===e?o[0]:u(e)}).domain=function(){return s},d.range=function(){return o},d}var d,f=[s[0],s[s.length-1]],m=(0,G.A)().domain(f).range(o);return(d=function(e){return 0===e&&0===f[0]?o[0]:m(e)}).domain=function(){var e=m.domain();if("function"!=typeof m.quantiles)return e;var t=m.quantiles();return R(R([e[0]],t,!0),[e[1]],!1)},d.range=function(){return m.range()},d}(u,l,v,j):null}),[u,l,v,j,x]),D=(0,f.useMemo)((function(){return w()(n)?n:function(e,t){var r=N()(e,n),a=N()(t,n);return r&&r===a}}),[n]),S=(0,f.useMemo)((function(){return w()(a)?a:function(e){return N()(e,a)}}),[a]),T=(0,f.useMemo)((function(){return w()(i)?i:function(e){return N()(e,i)}}),[i]),F=(0,f.useMemo)((function(){return c&&y[c]?(0,Z.Ad)(c,y):void 0===s?function(e){return e}:w()(s)?s:(0,A.GP)(s)}),[c,y,s]),E=(0,f.useMemo)((function(){return function(e){return O&&void 0!==e.value?O(e.value):o}}),[O,o]),P=(0,f.useMemo)((function(){return t&&r?t.map((function(e){var t=r.find((function(t){return D(e,t)})),n=T(t);if(t){var a=J(J({},e),{data:t,value:n,formattedValue:F(n)});return a.color=E(a),a.label=S(a),a}return e})):[]}),[t,r,D,T,F,E,S]),I=Y({colors:u,scale:O,valueFormat:F,unknownColor:o,patternsEnabled:m,patternFills:C});return{colorScale:O,getFillColor:E,boundFeatures:P,valueFormatter:F,legendData:I,patternDefs:k,patternFills:C}},Y=function(e){var t=e.scale,r=e.domain,n=e.reverse,a=void 0!==n&&n,i=e.valueFormat,s=void 0===i?function(e){return e}:i,o=e.separator,l=void 0===o?" - ":o,c=e.unknownColor,u=void 0===c?"#dee2e6":c,d=e.patternsEnabled,m=void 0!==d&&d,p=e.patternFills,h=void 0===p?[]:p;return(0,f.useMemo)((function(){if(!t)return[{id:u,index:0,extent:[u,u],label:"No data",value:u,color:u,pattern:""}];var e=null!=r?r:t.range(),n=t.domain(),i=m?{"dots-very-low":"⚬","lines-low":"━","squares-low-medium":"▢","lines-medium":"⟋","lines-medium-high":"┃","squares-high":"■","dots-very-high":"●"}:{},o=e.map((function(e,r){var a;if(r>=n.length-1)return null;var o=n[r],c=n[r+1],u="";if(m&&h.length>0){var d=Math.min(r,h.length-1),f=null===(a=h[d])||void 0===a?void 0:a.id;u=i[f]||""}return{id:e,index:r,extent:[o,c],label:"".concat(s(o)).concat(l).concat(s(c)),value:t(o),color:e,pattern:u}})).filter((function(e){return null!==e}));return o.unshift({id:u,index:o.length,extent:[u,u],label:"No data",value:t(u),color:u,pattern:""}),a&&o.reverse(),o}),[r,t,a,l,s,u,m,h])},X=r(51456),$=r(71511),ee=r(87134),te=function(){return te=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},te.apply(this,arguments)},re=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},ne={level:"world",id:null,parentId:null,title:"World View"},ae={scale:144,translation:[.5,.5],rotation:[0,0,0]},ie={visitors:{label:(0,l.__)("Visitors","burst-statistics"),recommendedClassification:"natural-breaks",default:!0,colorScheme:"greens",isPercentage:!1,showPercentageOfTotal:!0,precision:0,suffix:""},sessions:{label:(0,l.__)("Sessions","burst-statistics"),recommendedClassification:"natural-breaks",colorScheme:"greens",isPercentage:!1,showPercentageOfTotal:!0,precision:0,suffix:""},bounce_rate:{label:(0,l.__)("Bounce Rate","burst-statistics"),recommendedClassification:"equal-interval",colorScheme:"blueRedDiverging",isPercentage:!0,showPercentageOfTotal:!1,precision:1,suffix:"%"},avg_session_duration:{label:(0,l.__)("Avg. Session Duration","burst-statistics"),recommendedClassification:"standard-deviation",colorScheme:"blueRedDiverging",isPercentage:!1,isTime:!0,showPercentageOfTotal:!1,precision:0,suffix:"s"},conversion_rate:{label:(0,l.__)("Conversion Rate","burst-statistics"),recommendedClassification:"natural-breaks",colorScheme:"greens",isPercentage:!0,showPercentageOfTotal:!1,precision:2,suffix:"%"}},se={"natural-breaks":{label:(0,l.__)("Natural Breaks (Jenks)","burst-statistics"),description:(0,l.__)("Finds patterns in the data to create categories with minimal variation within groups. Works well for all metrics, especially Pageviews and Conversion Rate.","burst-statistics")},"equal-interval":{label:(0,l.__)("Equal Interval","burst-statistics"),description:(0,l.__)("Splits the data range into equal-sized intervals. Ideal for percentage-based metrics like Bounce Rate or Conversion Rate.","burst-statistics")},"standard-deviation":{label:(0,l.__)("Standard Deviation","burst-statistics"),description:(0,l.__)("Groups data based on how far values deviate from the average. Highlights outliers in metrics like Bounce Rate or Avg. Session Duration.","burst-statistics")},quantile:{label:(0,l.__)("Quantile","burst-statistics"),description:(0,l.__)("Divides data into equal-sized groups, ensuring each category has the same number of regions. Best for evenly distributed metrics like Pageviews or Visitors.","burst-statistics")}},oe=(0,$.v)((0,ee.Zr)((function(e,t){return{selectedMetric:"visitors",setSelectedMetric:function(t){return e({selectedMetric:t})},patternsEnabled:!1,setPatternsEnabled:function(t){return e({patternsEnabled:t})},classificationMethod:"quantile",setClassificationMethod:function(t){return e({classificationMethod:t})},zoomTarget:null,setZoomTarget:function(t){return e({zoomTarget:t})},defaultView:ne,currentView:ne,currentViewHasIncompleteData:!1,setCurrentViewHasIncompleteData:function(t){e({currentViewHasIncompleteData:t})},currentViewMissingData:null,setCurrentViewMissingData:function(t){e({currentViewMissingData:t})},history:[ne],projection:te({},ae),longitude:0,navigateToView:function(t){e((function(e){return{currentView:t,history:re(re([],e.history,!0),[t],!1)}})),setTimeout((function(){return e({zoomTarget:null})}),750)},navigateBack:function(){e((function(e){if(e.history.length>1){var t=e.history.slice(0,-1),r=t[t.length-1],n="world"===r.level;return te({history:t,currentView:r,zoomTarget:n?"reset":null},n&&{projection:te({},ae)})}return{}})),setTimeout((function(){return e({zoomTarget:null})}),750)},resetGeoToDefault:function(){var r=t().defaultView;e({currentView:r,history:[r],projection:te({},ae),zoomTarget:"reset"}),setTimeout((function(){return e({zoomTarget:null})}),750)},setProjection:function(t){e((function(e){return{projection:te(te({},e.projection),t)}}))},autoSelectOption:null,setAutoSelectOption:function(t){return e({autoSelectOption:t})},incompleteDataNoticeDismissedAt:null,isIncompleteDataNoticeDismissed:!1,dismissIncompleteDataNotice:function(){var t=Date.now();e({incompleteDataNoticeDismissedAt:t,isIncompleteDataNoticeDismissed:!0})},checkDismissalExpiry:function(){var r=t().incompleteDataNoticeDismissedAt;if(!r)return e({isIncompleteDataNoticeDismissed:!1});var n=Date.now()-r<2592e6;e({isIncompleteDataNoticeDismissed:n})}}}),{name:"burst-geo-storage",partialize:function(e){return{selectedMetric:e.selectedMetric,currentView:e.currentView,history:e.history,patternsEnabled:e.patternsEnabled,classificationMethod:e.classificationMethod,autoSelectOption:e.autoSelectOption,incompleteDataNoticeDismissedAt:e.incompleteDataNoticeDismissedAt,isIncompleteDataNoticeDismissed:e.isIncompleteDataNoticeDismissed}}})),le=(0,f.memo)((function(e){var t,r=e.feature,a=e.total,i=e.selectedMetric,s=e.valueFormatter,o=e.geoIpDatabaseType;if(!r)return null;var c="Admin-0 country"!==r.properties.featurecla,u=(null===(t=r.properties)||void 0===t?void 0:t.name)||r.label||(0,l.__)("Unknown location","burst-statistics"),d=r.value||0,f=ie[i]||ie.visitors,m=s?s(d):(0,Z.Ad)(i,ie)(d),p=f.showPercentageOfTotal,h=a&&0<a&&p?(0,Z.Ee)(d/a*100):null;return(0,n.jsxs)("div",{className:"min-w-[10em] max-w-xs rounded-md border border-gray-200 bg-white p-3 text-sm shadow-lg",children:[c&&r.properties.name_en&&(0,n.jsxs)("span",{className:"text-xs text-gray",children:[r.properties.name_en," (",r.properties.type_en,")"]}),(0,n.jsx)("div",{className:"mb-1 flex items-center gap-2 text-md font-semibold",children:c?(0,n.jsxs)(n.Fragment,{children:[" ",u," "]}):(0,n.jsx)(X.A,{country:r.properties.iso_a2,countryNiceName:(0,Z.qQ)(r.properties.iso_a2)})}),!c&&r.properties.continent&&(0,n.jsxs)("div",{className:"flex items-center gap-1",children:[(0,n.jsx)("div",{className:"text-xs text-gray",children:r.properties.continent}),r.properties.continent!==r.properties.subregion&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{className:"text-xs text-gray",children:"•"}),(0,n.jsx)("div",{className:"text-xs text-gray",children:r.properties.subregion})]})]}),(0,n.jsxs)("div",{className:"mb-2 mt-3 rounded-lg border border-gray-100 bg-gray-50 p-2",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsx)("div",{className:"text-xs font-medium uppercase tracking-wide text-gray",children:f.label}),f.isPercentage&&(0,n.jsx)("div",{className:"bg-blue-500 h-2 w-2 rounded-full"})]}),(0,n.jsx)("div",{className:"mt-1 text-xl font-bold text-black",children:m}),p&&h&&(0,n.jsxs)("div",{className:"mt-1 flex items-center gap-1 text-xs text-gray",children:[(0,n.jsx)("div",{className:"h-1 w-1 rounded-full bg-gray-400"}),(0,l.sprintf)(/* translators: %s: Percentage value */ /* translators: %s: Percentage value */
(0,l.__)("%s of total","burst-statistics"),h)]})]}),r.properties.pop_est&&(0,n.jsx)(n.Fragment,{children:(0,n.jsx)("div",{className:"text-xs text-gray",children:(0,l.sprintf)(/* translators: 1: Population number, 2: Year */ /* translators: 1: Population number, 2: Year */
(0,l.__)("Population: %1$s (%2$s)","burst-statistics"),(0,Z.ZV)(r.properties.pop_est),r.properties.pop_year)})}),!c&&"city"===o&&(0,n.jsx)("div",{className:"mt-2 text-xs font-semibold text-gray",children:(0,l.__)("Click to see country specific data","burst-statistics")})]})}));const ce=le,ue=(0,f.memo)((function(e){var t=e.data,r=e.containerWidth,a=e.containerHeight,i=e.anchor,s=void 0===i?"bottom-left":i,o=(e.translateX,e.translateY,e.itemWidth),l=void 0===o?94:o,c=e.itemHeight,u=void 0===c?18:c,d=e.itemsSpacing,f=void 0===d?0:d,m=e.itemTextColor,p=void 0===m?"#444444":m,h=e.symbolSize,g=void 0===h?18:h,v=e.patternsEnabled,b=void 0!==v&&v;if(!t||0===t.length)return null;var y=function(){var e,n,i=t.length*(u+f),o=l;switch(s){case"bottom-left":default:e=20,n=a-i-20;break;case"bottom-right":e=r-o-20,n=a-i-20;break;case"top-left":e=20,n=20;break;case"top-right":e=r-o-20,n=20}return{x:e=Math.max(10,Math.min(e,r-o-10)),y:n=Math.max(10,Math.min(n,a-i-10))}}(),x=y.x,j=y.y;return(0,n.jsx)("g",{className:"pattern-legend",transform:"translate(".concat(x,", ").concat(j,")"),children:t.map((function(e,t){var r=t*(u+f);return(0,n.jsxs)("g",{className:"legend-item",transform:"translate(0, ".concat(r,")"),children:[(0,n.jsx)("rect",{x:0,y:0,width:g,height:g,fill:e.color,stroke:"rgba(0,0,0,0.1)",strokeWidth:.5}),b&&e.pattern&&(0,n.jsx)("text",{x:g/2,y:g/2,textAnchor:"middle",dominantBaseline:"central",fontSize:"10",fill:"rgba(0,0,0,0.8)",fontWeight:"bold",children:e.pattern}),(0,n.jsx)("text",{x:g+8,y:g/2,dominantBaseline:"central",fontSize:"11",fill:p,children:e.label})]},e.id)}))})}));var de=function(){return de=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},de.apply(this,arguments)},fe=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},me=(0,f.memo)((0,f.forwardRef)((function(e,t){var r,a=e.width,i=e.height,s=e.margin,o=e.features,l=e.data,c=e.match,u=void 0===c?"id":c,d=e.label,y=void 0===d?"id":d,j=e.value,w=void 0===j?"value":j,_=e.valueFormat,N=e.projectionType,A=void 0===N?"mercator":N,k=e.projectionScale,M=void 0===k?100:k,C=e.projectionTranslation,O=void 0===C?[.5,.5]:C,D=e.projectionRotation,S=void 0===D?[0,0,0]:D,T=e.colors,F=void 0===T?"greens":T,E=e.domain,P=e.unknownColor,L=void 0===P?"#dee2e6":P,G=e.borderWidth,R=void 0===G?0:G,q=e.borderColor,W=void 0===q?"#000000":q,U=e.enableGraticule,B=void 0!==U&&U,Z=e.graticuleLineWidth,J=void 0===Z?.5:Z,Q=e.graticuleLineColor,Y=void 0===Q?"#999999":Q,X=e.baseMapFeatures,$=void 0===X?[]:X,ee=e.baseMapFeatureColor,te=void 0!==ee&&ee,re=e.overlayFeatures,ne=void 0===re?[]:re,ae=e.overlayData,ie=void 0===ae?[]:ae,se=e.overlayMatch,oe=e.overlayValue,le=e.overlayColors,me=e.showBaseLayer,pe=void 0===me||me,he=e.overlayOpacity,ge=void 0===he?1:he,_x=e.baseLayerOpacity,ve=void 0===_x?.3:_x,be=e.layers,ye=void 0===be?["graticule","baseMapFeatures","features","overlayFeatures","legends"]:be,xe=e.legends,je=void 0===xe?[]:xe,we=e.isInteractive,_e=void 0===we||we,Ne=e.onClick,Ae=void 0===Ne?function(){}:Ne,ke=e.tooltip,Me=void 0===ke?ce:ke,Ce=e.role,Oe=void 0===Ce?"img":Ce,De=e.defs,Se=void 0===De?[]:De,Te=e.fill,Fe=void 0===Te?[]:Te,Ee=e.transform,Pe=void 0===Ee?{scale:1,x:0,y:0}:Ee,Ie=e.classificationMethod,ze=void 0===Ie?"quantile":Ie,Ve=(e.normalizeData,e.populationField,e.metric),Le=e.metricOptions,Ge=e.patternsEnabled,Re=void 0!==Ge&&Ge,qe=e.tooltipTotal,We=e.selectedMetric,Ue=e.zoomToFeature,Be=e.geoIpDatabaseType;console.log("features",o),console.log("data",l),console.log("match",u),console.log("label",y),console.log("value",w),console.log("valueFormat",_),console.log("baseMapFeatures",$),console.log("baseMapFeatures length",null==$?void 0:$.length),console.log("layers",ye);var Ze=(0,f.useRef)(null),Je=(0,f.useRef)(null),Qe=(0,f.useRef)(null),Ke=(0,f.useRef)(null),He=(0,m.Xl)(a,i,s),Ye=He.margin,Xe=He.outerWidth,$e=He.outerHeight,et=(0,f.useState)(1),tt=et[0],rt=et[1],nt=(0,f.useCallback)((function(e){return e<=2?1:e<=5?2:e<=10?3:4}),[]),at=(0,f.useCallback)((function(e){if(Re){var t=nt(e);rt((function(r){return nt(r)!==t?e:r}))}}),[nt,Re]),it=H({features:o,data:l,match:u,label:y,value:w,valueFormat:_,unknownColor:L,domain:E,metric:Ve,metricOptions:Le,colors:F,patternsEnabled:Re,zoomLevel:Re?nt(tt):void 0,classificationMethod:ze}),st=it.getFillColor,ot=it.boundFeatures,lt=it.legendData,ct=it.patternDefs,ut=it.patternFills,dt=it.valueFormatter,ft=(null===(r=null==ne?void 0:ne.features)||void 0===r?void 0:r.length)>0,mt=H({features:ft&&(null==ne?void 0:ne.features)||[],data:ft?ie||l:[],match:se||u,label:y,value:oe||w,valueFormat:_,unknownColor:L,domain:E,metric:Ve,metricOptions:Le,colors:le||F,patternsEnabled:Re,zoomLevel:Re?nt(tt):void 0,classificationMethod:ze}),pt=mt.getFillColor,ht=mt.boundFeatures,gt=mt.legendData,vt=mt.patternDefs,bt=mt.patternFills,yt=mt.valueFormatter,xt=function(e){var t=e.width,r=e.height,n=e.projectionType,a=e.projectionScale,i=e.projectionTranslation,s=e.projectionRotation,o=e.fillColor,l=e.borderWidth,c=e.borderColor,u=e.theme,d=e.onZoomChange,m=i[0],p=i[1],v=s[0],b=s[1],y=s[2],x=(0,f.useRef)({k:1,x:0,y:0}),j=(0,f.useMemo)((function(){return K[n]().scale(a).translate([t*m,r*p]).rotate([v,b,y])}),[t,r,n,a,m,p,v,b,y]),w=(0,f.useMemo)((function(){return(0,I.A)(j)}),[j]),_=(0,f.useMemo)((function(){return(0,z.A)()}),[]),N=(0,f.useMemo)((function(){var e="function"==typeof l?l:function(){return l};return function(t){return e(t)/x.current.k}}),[l]),A=(0,f.useCallback)((function(e,t){var r=1===e.k?{k:1,x:0,y:0}:{k:e.k,x:e.x,y:e.y};x.current=r,d&&d(r.k);var n="translate(".concat(r.x,",").concat(r.y,") scale(").concat(r.k,")");t.attr("transform",n),t.selectAll("path").attr("stroke-width",(function(e){return N(e)}))}),[N,d]),k=(0,f.useCallback)((function(){var e;return(null===(e=x.current)||void 0===e?void 0:e.k)||1}),[]),M=(0,f.useCallback)((function(e,n){if(!e.current||!n.current)return null;var a=(0,g.A)(e.current),i=(0,g.A)(n.current),s=(0,h.s_)().scaleExtent([1,100]).on("zoom",(function(e){A(e.transform,i)}));return a.call(s),{cleanup:function(){a.on("zoom",null)},zoomToFeature:function(e){if(e&&e.geometry)try{var n=w.bounds(e),i=n[0],o=i[0],l=i[1],c=n[1],u=c[0],d=c[1],f=(o+u)/2,m=(l+d)/2,p=.8*Math.min(t/(u-o),r/(d-l)),g=Math.max(1,Math.min(100,p)),v=t/2-f*g,b=r/2-m*g;a.transition().duration(750).call(s.transform,h.GS.translate(v,b).scale(g))}catch(e){console.warn("Error zooming to feature:",e)}},reset:function(){a.transition().duration(750).call(s.transform,h.GS,(0,h._V)(a.node()).invert([t/2,r/2]))},zoom:s}}),[t,r,A,w]),C=(0,V.nz)(c,u),O=(0,f.useMemo)((function(){return"function"==typeof o?o:function(){return o}}),[o]);return{projection:j,path:w,graticule:_,getBorderWidth:N,getBorderColor:C,getFillColor:O,setupZoom:M,zoomTransformRef:x,getCurrentZoomLevel:k}}({width:a,height:i,projectionType:A,projectionScale:M,projectionTranslation:O,projectionRotation:S,fillColor:function(){},borderWidth:R,borderColor:W,transform:Pe,onZoomChange:at,patternsEnabled:Re}),jt=xt.graticule,wt=xt.path,_t=xt.getBorderWidth,Nt=xt.getBorderColor,At=fe(fe(fe([],Se,!0),ct,!0),ft?vt:[],!0),kt=fe(fe(fe([],Fe,!0),ut,!0),ft?bt:[],!0),Mt=(0,m.kc)(At,fe(fe([],ot,!0),ft?ht:[],!0),kt,{dataKey:"data",targetKey:"fill"}),Ct=(0,p.fS)(),Ot=Ct.showTooltipFromEvent,Dt=Ct.hideTooltip,St=(0,f.useCallback)((function(e,t){return _e&&Ae&&Ae(e,t)}),[_e,Ae]),Tt=(0,f.useCallback)((function(e,t){if(_e&&Me){var r=ft?yt:dt;Ot((0,n.jsx)(Me,{feature:e,total:qe,selectedMetric:We,valueFormatter:r,geoIpDatabaseType:Be}),t)}}),[_e,Ot,Me,qe,We,ft,yt,dt,Be]),Ft=(0,f.useCallback)((function(e,t){if(_e&&Me){var r=ft?yt:dt;Ot((0,n.jsx)(Me,{feature:e,total:qe,selectedMetric:We,valueFormatter:r,geoIpDatabaseType:Be}),t)}}),[_e,Ot,Me,qe,We,ft,yt,dt,Be]),Et=(0,f.useCallback)((function(){return _e&&Dt()}),[_e,Dt]);return(0,f.useEffect)((function(){if(Ze.current&&Je.current){var e=(0,g.A)(Ze.current),t=(0,g.A)(Je.current),r=(0,h.s_)().scaleExtent([1,1e3]).on("zoom",(function(e){var r=e.transform;t.attr("transform","translate(".concat(r.x,",").concat(r.y,") scale(").concat(r.k,")")),t.selectAll("path").attr("stroke-width",(function(){return R/r.k})),at&&at(r.k)}));return e.call(r),Qe.current={svg:e,zoom:r,path:wt},function(){e.on("zoom",null),Qe.current=null}}}),[wt,at,R]),(0,f.useEffect)((function(){if(Ue&&Qe.current){var e=Qe.current,t=e.svg,r=e.zoom,n=e.path;if("reset"!==Ue)try{var s=void 0;if("FeatureCollection"===Ue.type&&Ke.current){var o=Ke.current.getBBox();o.width>0&&o.height>0&&(s=[[o.x,o.y],[o.x+o.width,o.y+o.height]])}if(!s&&(Ue.geometry||"FeatureCollection"===Ue.type))if("FeatureCollection"===Ue.type){var l=(0,v.A)(Ue),c=l[0],u=c[0],d=c[1],f=l[1],m=f[0],p=f[1],g=n.projection()([u,d]),b=n.projection()([m,p]);if(!g||!b)return void console.error("Failed to project geographic bounds, aborting zoom");s=[g,b]}else s=n.bounds(Ue);if(!s)return;var y=s[0],x=y[0],j=y[1],w=s[1],_=w[0],N=w[1],A=Math.min(100,.8/Math.max((_-x)/a,(N-j)/i)),k=Math.max(1,A),M=a/2-(x+_)/2*k,C=i/2-(j+N)/2*k,O=h.GS.translate(M,C).scale(k);t.transition().duration(750).call(r.transform,O)}catch(e){console.error("Error zooming to feature:",e)}else t.transition().duration(750).call(r.transform,h.GS)}}),[Ue,a,i]),(0,f.useEffect)((function(){if(Ze.current&&Je.current){var e=(0,g.A)(Ze.current),t=(0,g.A)(Je.current),r=e.node().__zoom||{k:1};r.k>1&&t.selectAll("path").attr("stroke-width",(function(){return R/r.k}))}}),[ot,ht,R]),(0,n.jsxs)(m.Ge,{width:Xe,height:$e,margin:Ye,defs:Mt,role:Oe,ref:Ze,children:[(0,n.jsx)("g",{ref:Je,className:"map-layers",children:ye.map((function(e,t){if("graticule"===e)return!0!==B?null:(0,n.jsx)(b,{path:wt,graticule:jt,lineWidth:J,lineColor:Y},"graticule");if("baseMapFeatures"===e)return console.log("Processing baseMapFeatures layer"),console.log("baseMapFeatures check:",$),console.log("baseMapFeatures length check:",null==$?void 0:$.length),$&&0!==$.length?(console.log("Rendering baseMapFeatures with",$.length,"features"),(0,n.jsx)(f.Fragment,{children:(0,n.jsx)("g",{className:"base-map-features-group",children:$.map((function(e,t){return(0,n.jsx)(x,{feature:e,path:wt,fillColor:te||"#e9ecef",borderWidth:_t(e),borderColor:"rgb(249 249 249)"},"base-".concat(e.id||t))}))})},"baseMapFeatures")):(console.log("baseMapFeatures is null or empty, returning null"),null);if("features"===e){var r=ft&&pe?ve:1;return!ft||pe?(0,n.jsx)(f.Fragment,{children:(0,n.jsx)("g",{className:"features-group",children:ot.map((function(e,t){return(0,n.jsx)(x,{feature:e,path:wt,fillColor:st(e),borderWidth:_t(e),borderColor:Nt(e),onMouseEnter:ft?void 0:Tt,onMouseMove:ft?void 0:Ft,onMouseLeave:ft?void 0:Et,onClick:ft?void 0:St,opacity:r},e.id||"feature-".concat(t))}))})},"features"):null}return"overlayFeatures"===e?ft?(0,n.jsx)(f.Fragment,{children:(0,n.jsx)("g",{className:"overlay-features-group",ref:Ke,children:ht.map((function(e,t){return(0,n.jsx)(x,{feature:e,path:wt,fillColor:pt(e),borderWidth:_t(e),borderColor:Nt(e),onMouseEnter:Tt,onMouseMove:Ft,onMouseLeave:Et,onClick:St,opacity:ge},"overlay-".concat(e.id||t))}))})},"overlayFeatures"):null:"legends"!==e?(0,n.jsx)(f.Fragment,{children:e({})},t):null})).filter(Boolean)}),function(){if(!ye.includes("legends"))return null;var e=ft?gt:lt;return(0,n.jsx)("g",{className:"legends-layer",children:je.map((function(t,r){return(0,n.jsx)(ue,de({containerWidth:a,containerHeight:i,data:e,patternsEnabled:Re},t),r)}))})}()]})})));const pe=(0,m.Ub)(me);var he=function(){return he=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},he.apply(this,arguments)};const ge=(0,f.forwardRef)((function(e,t){return(0,n.jsx)(m.KF,{children:function(r){var a=r.width,i=r.height;return(0,n.jsx)(pe,he({ref:t,width:a,height:i},e))}})}));var ve=r(86087),be=r(57112);const ye=function(){var e=oe((function(e){return e.currentView})),t=oe((function(e){return e.history})),r=oe((function(e){return e.navigateBack})),a=oe((function(e){return e.resetGeoToDefault})),i=(0,ve.useCallback)((function(){r()}),[r]),s=(0,ve.useCallback)((function(){"world"!==e.level&&a()}),[e.level,a]),o=[{label:(0,l._x)("World","navigation item","burst-statistics"),isActive:"world"===e.level,onClick:s,isClickable:"world"!==e.level}];"world"!==e.level&&o.push({label:e.title||e.id,isActive:!0,isClickable:!1,id:e.id});var c=1<t.length;return(0,n.jsxs)("div",{className:"flex items-stretch gap-2",children:[(0,n.jsx)("div",{className:"flex items-center rounded-lg border border-gray-200 bg-white/95 text-sm shadow-sm transition-all hover:shadow-md",children:(0,n.jsx)("button",{onClick:c?i:void 0,disabled:!c,className:"focus:ring-blue-500 flex h-9 w-9 items-center justify-center rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-offset-1 ".concat(c?"cursor-pointer text-white hover:bg-gray-100":"cursor-not-allowed text-gray"),title:c?(0,l._x)("Go back","button title","burst-statistics"):(0,l._x)("No previous page","button title","burst-statistics"),children:(0,n.jsx)(be.A,{name:"chevron-left",size:16,color:c?"black":"gray"})})}),(0,n.jsx)("div",{className:"flex items-center rounded-lg border border-gray-200 bg-white/95 px-3 py-2 text-sm shadow-sm transition-all hover:shadow-md",children:(0,n.jsx)("nav",{className:"flex items-center","aria-label":(0,l._x)("Map navigation","aria label","burst-statistics"),children:(0,n.jsx)("ol",{className:"flex items-center space-x-1",children:o.map((function(e,t){return(0,n.jsxs)("li",{className:"m-0 flex items-center",children:[0<t&&(0,n.jsx)(be.A,{name:"chevron-right",size:14,color:"gray",className:"mx-1 flex-shrink-0"}),e.isClickable?(0,n.jsx)("button",{onClick:e.onClick,className:"text-blue-600 hover:text-blue-800 focus:ring-blue-500 rounded px-1 py-0.5 text-sm transition-colors hover:underline focus:outline-none focus:ring-2 focus:ring-offset-1",children:e.label}):(0,n.jsx)("span",{className:"rounded px-1 py-0.5 text-sm ".concat(e.isActive?"font-medium text-black":"bg-gray-200 text-gray"),children:(0,n.jsx)(X.A,{country:e.id,countryNiceName:e.label})})]},t)}))})})})]})};var xe=r(48069),je=r(51796),we=r(86275),_e=r(76870),Ne=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))},Ae=function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},ke=burst_settings.plugin_url+"src/Pro/assets/maps",Me=burst_settings.plugin_url+"assets/maps/world/world_loading.json",Ce="".concat(ke,"/world"),Oe="".concat(ke,"/countries"),De=function(e,t){if(!e||!e.objects||!e.objects[t])return console.warn("TopoData or objectKey '".concat(t,"' not found for conversion."),null==e?void 0:e.objects),{type:"FeatureCollection",features:[]};try{var r=(0,je.A)(e,e.objects[t]);return e.transform&&(r.transform=e.transform),r}catch(e){return console.error("Error converting TopoJSON to GeoJSON:",e),{type:"FeatureCollection",features:[]}}},Se=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Ne(void 0,function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0),void 0,(function(e){var t,r;return void 0===e&&(e=!1),Ae(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),t=e?Me:"".concat(Ce,"/world.json"),[4,(0,we.nd)(t)];case 1:return[2,n.sent()];case 2:throw r=n.sent(),console.error("Error fetching world topo:",r),r;case 3:return[2]}}))}))},Te=function(){var e,t=oe((function(e){return e.currentView})),r=(0,_e.A)((function(e){return e.isPro})),n=(0,xe.I)({queryKey:["simplified_initial_world_topo"],queryFn:function(){return Se(!0)},staleTime:1/0,cacheTime:1/0,retry:3,enabled:!0}),a=n.data,i=n.isLoading;if(r)var s=(0,xe.I)({queryKey:["world_data_detailed"],queryFn:function(){return Se(!1)},staleTime:1/0,cacheTime:1/0,retry:3,enabled:!0}),o=s.data,l=s.isLoading;var c,u=(0,xe.I)({queryKey:(c=t.id,["country_overlay",c]),queryFn:function(){return e=t.id,Ne(void 0,void 0,void 0,(function(){var t,r;return Ae(this,(function(n){switch(n.label){case 0:if(n.trys.push([0,2,,3]),!e)throw new Error("Country ID is required");return t="".concat(Oe,"/").concat(e.toLowerCase(),".json"),[4,(0,we.nd)(t)];case 1:return[2,n.sent()];case 2:throw r=n.sent(),console.error("Error fetching country topo:",r),r;case 3:return[2]}}))}));var e},enabled:"country"===t.level&&!!t.id,staleTime:1/0,cacheTime:1/0,retry:3}),d=u.data,f=u.isLoading,m=(0,ve.useMemo)((function(){if(!a)return{type:"FeatureCollection",features:[]};var e=Object.keys(a.objects||{})[0]||"features";return De(a,e)}),[a]),p=(0,ve.useMemo)((function(){if(!o)return{type:"FeatureCollection",features:[]};var e=Object.keys(o.objects||{})[0]||"features";return De(o,e)}),[o]),h=(0,ve.useMemo)((function(){if(!d)return{type:"FeatureCollection",features:[]};var e=Object.keys(d.objects||{})[0]||"features";return De(d,e)}),[d]),g=(0,ve.useMemo)((function(){var e,r;switch(t.level){case"world":return 0<(null===(e=null==p?void 0:p.features)||void 0===e?void 0:e.length)?p:m;case"country":return 0<(null===(r=null==h?void 0:h.features)||void 0===r?void 0:r.length)?h:p;default:return m}}),[t.level,p,h,m]),v=(0,ve.useMemo)((function(){return m}),[m]),b=(0,ve.useMemo)((function(){var e;return"country"===t.level&&0<(null===(e=null==h?void 0:h.features)||void 0===e?void 0:e.length)?h:{type:"FeatureCollection",features:[]}}),[t.level,h]),y=(0,ve.useMemo)((function(){var e,r,n;return"world"===t.level?l&&!(null===(e=null==p?void 0:p.features)||void 0===e?void 0:e.length)&&!(0<(null===(r=null==m?void 0:m.features)||void 0===r?void 0:r.length)):"country"===t.level?f&&!(null===(n=null==h?void 0:h.features)||void 0===n?void 0:n.length):i}),[t.level,l,f,i,p,h,m]);return{geoFeatures:g,simplifiedWorldGeoJson:m,baseLayerFeatures:v,overlayFeatures:b,worldGeoJson:p,countryOverlayGeoJson:h,isGeoLoading:y,isGeoFetching:f,isGeoSimpleLoading:i,isWorldLoading:l,isCountryOverlayLoading:f,currentView:t,hasOverlay:"country"===t.level&&0<(null===(e=null==h?void 0:h.features)||void 0===e?void 0:e.length),geoError:null}};const Fe=function(e){return t=void 0,r=[e],a=function(e){var t,r=e.startDate,n=e.endDate,a=e.range,i=e.args;return function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,(0,we.bQ)("geo",r,n,a,i)];case 1:return[2,e.sent().data];case 2:return t=e.sent(),console.error("Error fetching geo data:",t),[2,[]];case 3:return[2]}}))},new((n=void 0)||(n=Promise))((function(e,i){function s(e){try{l(a.next(e))}catch(e){i(e)}}function o(e){try{l(a.throw(e))}catch(e){i(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(s,o)}l((a=a.apply(t,r||[])).next())}));var t,r,n,a};var Ee=r(22895),Pe=r(23392),Ie=r(24660);const ze=function(){var e,t,r,a,i=oe((function(e){return e.currentView})),s=oe((function(e){return e.currentViewMissingData})),c=oe((function(e){return e.setCurrentViewMissingData})),u=oe((function(e){return e.navigateToView})),d=oe((function(e){return e.projection})),f=oe((function(e){return e.selectedMetric})),m=oe((function(e){return e.patternsEnabled})),p=oe((function(e){return e.classificationMethod})),h=oe((function(e){return e.dismissIncompleteDataNotice})),g=oe((function(e){return e.isIncompleteDataNoticeDismissed})),v=oe((function(e){return e.checkDismissalExpiry})),b=(0,Ie.A)().getValue,y=b("burst_update_to_city_geo_database_time"),x=b("geo_ip_database_type"),j=(0,ve.useMemo)((function(){var e;return(null===(e=ie[f])||void 0===e?void 0:e.colorScheme)||"greens"}),[f]),w=(0,ve.useMemo)((function(){return(0,Z.Ad)(f,ie)}),[f]),_=oe((function(e){return e.zoomTarget})),N=oe((function(e){return e.setZoomTarget})),A=Te(),k=A.geoFeatures,M=A.simplifiedWorldGeoJson,C=A.baseLayerFeatures,O=A.overlayFeatures,D=A.hasOverlay,S=A.isGeoLoading,T=A.isGeoFetching,F=A.isGeoSimpleLoading,E=A.error,P=function(){var e=(0,Ee.S)((function(e){return e})),t=e.startDate,r=e.endDate,n=e.range,a=(0,o.c)((function(e){return e.filters})),i=oe((function(e){return e.selectedMetric})),s=oe((function(e){return e.currentView})),l={filters:a,metrics:i,currentView:{level:s.level,id:s.id}};return(0,xe.I)({queryKey:["geo_analytics",t,r,s.level,s.id,i,a],queryFn:function(){return Fe({startDate:t,endDate:r,range:n,args:l})},staleTime:3e5,placeholderData:[]})}(),I=P.data,z=void 0===I?[]:I,V=P.isFetching,L=P.error,G=(0,ve.useCallback)((function(e){var t,r,n,a,s,o;e&&(null===(t=e.properties)||void 0===t?void 0:t.iso_a2)&&"country"!==x&&("country"===i.level&&i.id===e.properties.iso_a2||("world"===i.level?o={level:"country",id:null===(r=e.properties)||void 0===r?void 0:r.iso_a2,parentId:null,title:"".concat((null===(n=e.properties)||void 0===n?void 0:n.name)||e.id)}:"continent"===i.level&&(o={level:"country",id:null===(a=e.properties)||void 0===a?void 0:a.iso_a2,parentId:i.id,title:"".concat((null===(s=e.properties)||void 0===s?void 0:s.name)||e.id)}),!o||"city"!==x&&"world"!==i.level||u(o)))}),[i.level,i.id,u,x]);(0,ve.useEffect)((function(){v()}),[v]),(0,ve.useEffect)((function(){var e;if("country"===i.level&&i.id&&!T&&!S&&0<(null===(e=null==O?void 0:O.features)||void 0===e?void 0:e.length)){var t={type:"FeatureCollection",features:O.features};N(t)}}),[i.level,i.id,O,T,S,N]);var R=(0,ve.useMemo)((function(){return function(e,t){var r,n;if("world"===i.level){var a=null===(r=e.properties)||void 0===r?void 0:r.iso_a2,s=t.country_code;return a&&s&&a===s}return"country"===i.level&&"city"===x&&(a=null===(n=e.properties)||void 0===n?void 0:n.iso_3166_2,s=t.country_code+"-"+t.state_code,a&&s&&a===s)}}),[i.level,i.id,x]),q=(0,ve.useMemo)((function(){return function(e){if(!e)return 0;var t=parseInt(e[f],10);return isNaN(t)?0:t}}),[f]),W=(0,ve.useMemo)((function(){return function(e){var t,r;return(null===(t=e.properties)||void 0===t?void 0:t.name_en)||(null===(r=e.properties)||void 0===r?void 0:r.iso_a2)||(0,l.__)("Unknown","burst-statistics")}}),[]),U=(0,ve.useMemo)((function(){return z&&0!==z.length?("city"===x&&"country"===i.level&&z.some((function(e){return!e.state_code}))?c(z.find((function(e){return!e.state_code}))):c(null),z.reduce((function(e,t){return e+q(t)}),0)):0}),[z,q]),B=(0,ve.useMemo)((function(){if(!z||0===z.length)return null;var e=z.map((function(e){return q(e)})).filter((function(e){return 0<e}));if(0===e.length)return null;var t=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0).sort((function(e,t){return e-t})),r=e.reduce((function(e,t){return e+t}),0)/e.length,n=t[Math.floor(t.length/2)];return{count:e.length,min:Math.min.apply(Math,e),max:Math.max.apply(Math,e),mean:Math.round(r),median:Math.round(n),total:U}}),[z,q,U]),J=(0,ve.useMemo)((function(){if(!z||0===z.length)return[0,100];var e=z.map((function(e){return q(e)})).filter((function(e){return 0<e}));return 0===e.length?[0,100]:[Math.min.apply(Math,e),Math.max.apply(Math,e)]}),[z,q]),Q=E||L,K=S||T||V;return Q?(0,n.jsxs)("div",{className:"text-red-500 relative p-4",children:[(0,n.jsx)("div",{className:"absolute left-3 top-3 z-10",children:(0,n.jsx)(ye,{})}),(0,n.jsx)("div",{className:"mt-12",children:(0,n.jsx)("p",{children:(0,l.sprintf)(/* translators: %s: Error message */ /* translators: %s: Error message */
(0,l.__)("Error: %s","burst-statistics"),String(Q))})})]}):F?(0,n.jsx)("div",{className:"p-4 text-gray",children:(0,l.__)("Loading map data...","burst-statistics")}):f?(0,n.jsxs)("div",{className:"relative h-full min-h-[450px] w-full rounded-b-lg",style:{boxShadow:"inset 0 0 40px rgba(0, 0, 0, 0.06)"},children:[K&&(0,n.jsx)("div",{className:"absolute inset-0 z-20 flex items-center justify-center bg-white/30 backdrop-blur-sm",children:(0,n.jsxs)("div",{className:"flex flex-col items-center gap-3 rounded-lg bg-white p-6 shadow-lg",children:[(0,n.jsx)("div",{className:"border-blue-600 h-8 w-8 animate-spin rounded-full border-b-2"}),(0,n.jsx)("div",{className:"text-sm font-medium text-gray",children:S||T?(0,l.__)("Loading map data...","burst-statistics"):(0,l.__)("Loading analytics...","burst-statistics")})]})}),"city"===x&&(0,n.jsx)("div",{className:"absolute left-3 top-3 z-10",children:(0,n.jsx)(ye,{})}),"city"===x&&s&&!g&&(0,n.jsx)("div",{className:"absolute left-3 top-16 z-10 max-w-md",children:(0,n.jsx)("div",{className:"rounded-lg border border-gray-200 bg-white/95 px-4 py-3 text-sm shadow-sm transition-all hover:shadow-md",children:(0,n.jsxs)("div",{className:"flex items-start gap-3",children:[(0,n.jsx)(be.A,{name:"help",size:16,color:"blue",className:"mt-0.5 flex-shrink-0"}),(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsxs)("div",{className:"mb-2 text-black",children:[(0,n.jsx)("p",{className:"font-semibold",children:(0,l.sprintf)((0,l.__)("Region-level data is available for visits after %s.","burst-statistics"),y?(0,Z.BM)(y):"")}),(0,n.jsx)("p",{className:"mt-1",children:(0,l.__)("Region tracking is a new feature, so this data is only available for visits recorded after it was enabled.","burst-statistics")})]}),(0,n.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,n.jsx)("a",{href:(0,Pe.U)("new-feature-region-tracking/",{utm_source:"worldmap",utm_content:"incomplete-data-notice"}),target:"_blank",rel:"noopener noreferrer",className:"text-blue underline",children:(0,l.__)("Learn more","burst-statistics")}),(0,n.jsx)("button",{onClick:h,className:"rounded bg-gray-200 px-3 py-1 text-gray hover:bg-gray-300 hover:text-gray",title:(0,l.__)("Dismiss for 30 days","burst-statistics"),children:(0,l.__)("Dismiss","burst-statistics")})]})]})]})})}),(0,n.jsx)("div",{className:"absolute z-10 ".concat("country"===x?"left-3 top-3":"right-3 top-3"),children:(0,n.jsxs)("div",{className:"duration-400 group rounded-lg border border-gray-200 bg-white/95 px-3 py-2 text-sm shadow-sm transition-all hover:shadow-md",children:[(0,n.jsx)("div",{className:"font-semibold text-black",children:(0,l.sprintf)(/* translators: 1: Metric name (e.g., "Pageviews", "Visitors"), 2: Location type (e.g., "Country" or "Region") */ /* translators: 1: Metric name (e.g., "Pageviews", "Visitors"), 2: Location type (e.g., "Country" or "Region") */
(0,l._x)("%1$s per %2$s","metric by location","burst-statistics"),(null===(e=ie[f])||void 0===e?void 0:e.label)||f,"world"===i.level||"country"===x?(0,l._x)("country","location type","burst-statistics"):(0,l._x)("region","location type","burst-statistics"))}),B&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"mt-1 text-xs text-gray",children:(0,l.sprintf)(/* translators: %d: Number of locations that have data */
"country"===x?(0,l._n)("%d country with data","%d countries with data",B.count,"burst-statistics"):(0,l._n)("%d region with data","%d regions with data",B.count,"burst-statistics"),B.count)}),m&&(0,n.jsxs)("div",{className:"mt-1 text-xs text-gray",children:["• ",(0,l.__)("Patterns enabled","burst-statistics")]}),s&&(0,n.jsxs)("div",{className:"mt-1 flex items-center gap-1 text-xs text-gray",children:[(0,n.jsx)(be.A,{name:"help",size:12,strokeWidth:2,color:"blue"}),(0,l.sprintf)(/* translators: %d: Number of visitors with unknown region, %s: metric label */ /* translators: %d: Number of visitors with unknown region, %s: metric label */
(0,l.__)("%d %s with unknown region","burst-statistics"),w(q(s)),(null===(r=null===(t=ie[f])||void 0===t?void 0:t.label)||void 0===r?void 0:r.toLowerCase())||f.toLowerCase())]})]}),B&&(0,n.jsx)("div",{className:"max-h-0 overflow-hidden opacity-0 transition-all duration-300 ease-in-out group-hover:max-h-32 group-hover:opacity-100",children:(0,n.jsxs)("div",{className:"mt-2 space-y-1 border-t border-gray-100 pt-2 text-xs text-gray",children:[(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{children:[(0,l._x)("Range","statistic label","burst-statistics"),":"]}),(0,n.jsxs)("span",{children:[w(B.min)," -"," ",w(B.max)]})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{children:[(0,l._x)("Average","statistic label","burst-statistics"),":"]}),(0,n.jsx)("span",{children:w(B.mean)})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{children:[(0,l._x)("Median","statistic label","burst-statistics"),":"]}),(0,n.jsx)("span",{children:w(B.median)})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{children:[(0,l._x)("Total","statistic label","burst-statistics"),":"]}),(0,n.jsx)("span",{className:"font-medium",children:w(B.total)})]}),(0,n.jsxs)("div",{className:"flex justify-between",children:[(0,n.jsxs)("span",{children:[(0,l._x)("Method","statistic label","burst-statistics"),":"]}),(0,n.jsx)("span",{className:"font-medium capitalize",children:(0,l._x)(p.replace("-"," "),"classification method","burst-statistics")})]})]})})]})}),0<(null===(a=null==k?void 0:k.features)||void 0===a?void 0:a.length)&&!F&&(0,n.jsx)(ge,{onClick:G,data:z,features:"world"===i.level?k.features:C.features,transform:k.transform,baseMapFeatures:M.features,overlayFeatures:D?O:{features:[]},overlayData:D?z:[],overlayMatch:R,overlayValue:q,showBaseLayer:D,baseLayerOpacity:.2,overlayOpacity:1,match:R,value:q,margin:{top:0,right:0,bottom:0,left:0},colors:j,domain:J,unknownColor:"#dee2e6",label:W,valueFormat:w,projectionType:"naturalEarth1",projectionScale:d.scale,projectionTranslation:d.translation,projectionRotation:d.rotation,enableGraticule:!0,graticuleLineColor:"#dddddd",borderWidth:.5,borderColor:"#adb5bd",metric:f,metricOptions:ie,patternsEnabled:m,classificationMethod:p,zoomToFeature:_,legends:[{anchor:"bottom-left",direction:"column",justify:!0,translateX:20,translateY:-100,itemsSpacing:0,itemWidth:94,itemHeight:18,itemDirection:"left-to-right",itemTextColor:"#444444",itemOpacity:.85,symbolSize:18,effects:[{on:"hover",style:{itemTextColor:"#000000",itemOpacity:1}}]}],tooltipTotal:null==B?void 0:B.total,selectedMetric:f,geoIpDatabaseType:x},"choropleth-".concat(m?"patterns":"no-patterns","-").concat(p))]}):(0,n.jsx)("div",{className:"p-4 text-gray",children:(0,l.__)("No metrics available for display.","burst-statistics")})};var Ve=r(9823),Le=r(681),Ge=r(5560),Re=r(46512);const qe=function(){var e=(0,ve.useState)(!1),t=e[0],r=e[1],a=oe((function(e){return e.selectedMetric})),i=oe((function(e){return e.setSelectedMetric})),s=oe((function(e){return e.patternsEnabled})),o=oe((function(e){return e.setPatternsEnabled})),c=oe((function(e){return e.classificationMethod})),u=oe((function(e){return e.setClassificationMethod})),d=oe((function(e){return e.resetGeoToDefault})),f=oe((function(e){var t;return null===(t=e.autoSelectOption)||void 0===t||t})),m=oe((function(e){return e.setAutoSelectOption})),p=(0,ve.useState)(a),h=p[0],g=p[1],v=(0,ve.useState)(s),b=v[0],y=v[1],x=(0,ve.useState)(c),j=x[0],w=x[1];return(0,ve.useEffect)((function(){g(a),y(s),w(c)}),[a,s,c]),(0,ve.useEffect)((function(){var e;if(f&&h){var t=(null===(e=ie[h])||void 0===e?void 0:e.recommendedClassification)||"quantile";w(t)}}),[h,f]),(0,n.jsxs)(Ve.bL,{open:t,onOpenChange:function(e){e?r(!0):(r(!1),g(a),y(s),w(c))},children:[(0,n.jsx)(Ve.l9,{className:"".concat(t?"bg-gray-400 shadow-lg":"bg-gray-300"," focus:ring-blue-500 cursor-pointer rounded-full p-3 transition-all duration-200 hover:bg-gray-400 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2"),onClick:function(){return r(!t)},title:(0,l.__)("Metrics & options","burst-statistics"),children:(0,n.jsx)(be.A,{name:"filter",size:16})}),(0,n.jsx)(Ve.ZL,{container:document.querySelector(".burst"),children:(0,n.jsxs)(Ve.UC,{className:"z-50 min-w-[320px] max-w-[400px] rounded-lg border border-gray-200 bg-white p-0 shadow-xl",align:"end",sideOffset:10,arrowPadding:10,children:[(0,n.jsx)(Ve.i3,{className:"fill-white drop-shadow-sm"}),(0,n.jsx)("div",{className:"border-b border-gray-100 px-4 py-3",children:(0,n.jsx)("h5",{className:"m-0 text-base font-semibold text-black",children:(0,l.__)("Metrics & options","burst-statistics")})}),(0,n.jsxs)("div",{className:"max-h-[80vh] overflow-y-auto px-4 py-4",children:[(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"mb-3 block text-sm font-medium text-gray",children:(0,l.__)("Select metric","burst-statistics")}),(0,n.jsx)("div",{className:"flex flex-col",children:Object.entries(ie).map((function(e){var t=e[0],r=e[1];return(0,n.jsx)(Le.A,{id:"metric_".concat(t),name:"metric_selection",value:t,label:r.label,checked:h===t,onChange:g},t)}))})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center gap-2",children:[(0,n.jsx)("label",{className:"block text-sm font-medium text-gray",children:(0,l.__)("Classification method","burst-statistics")}),(0,n.jsx)(be.A,{color:"blue",name:"help",size:16,className:"rounded-full bg-blue-light",tooltip:(0,l.__)("A classification method determines how data values are grouped into ranges or categories to color regions on a choropleth map. The recommended method is based on the selected metric. For more information for each method, see the help icon next to each method.","burst-statistics")})]}),(0,n.jsxs)("div",{className:"flex items-center gap-2 rounded-full border border-gray-200 bg-gray-100 px-2 py-1",children:[(0,n.jsx)("label",{htmlFor:"auto-select",className:"text-sm text-gray",children:(0,l.__)("Auto-select","burst-statistics")}),(0,n.jsx)(Ge.A,{id:"auto-select",value:f,onChange:function(e){var t;if(m(e),e){var r=(null===(t=ie[h])||void 0===t?void 0:t.recommendedClassification)||"quantile";w(r)}},size:"small"})]})]}),(0,n.jsx)("div",{className:"flex flex-col",children:Object.entries(se).map((function(e){var t,r=e[0],a=e[1],i=(null===(t=ie[h])||void 0===t?void 0:t.recommendedClassification)===r,s=f?i:j===r;return(0,n.jsx)("div",{className:"mb-1 flex items-center gap-2 ".concat(f?"opacity-90":""),children:(0,n.jsx)(Le.A,{id:"classification_".concat(r),name:"classification_method",value:r,label:a.label,checked:s,onChange:function(){return function(e){m(!1),w(e)}(r)},tooltip:a.description,recommended:i})},r)}))})]}),(0,n.jsxs)("div",{className:"mb-6",children:[(0,n.jsx)("label",{className:"mb-3 block text-sm font-medium text-gray",children:(0,l.__)("Accessibility","burst-statistics")}),(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex-1",children:[(0,n.jsx)("div",{className:"mb-1 text-sm text-black",children:(0,l.__)("Colorblind Patterns","burst-statistics")}),(0,n.jsx)("div",{className:"text-xs text-gray",children:(0,l.__)("Add patterns for colorblind accessibility","burst-statistics")})]}),(0,n.jsx)(Ge.A,{value:b,onChange:y,size:"default"})]})]})]}),(0,n.jsx)("div",{className:"rounded-b-lg border-t border-gray-100 bg-gray-50 px-4 py-3",children:(0,n.jsx)("div",{className:"space-y-2",children:(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(Re.A,{onClick:function(){var e;if(i(h),o(b),f){var t=(null===(e=ie[h])||void 0===e?void 0:e.recommendedClassification)||"quantile";u(t)}else u(j);r(!1)},btnVariant:"primary",size:"sm",className:"flex-1",children:(0,l.__)("Apply","burst-statistics")}),(0,n.jsx)(Re.A,{onClick:function(){var e,t=Object.keys(ie).find((function(e){return ie[e].default}))||"visitors";g(t),y(!1),w("quantile"),m(!0),i(t),o(!1);var n=(null===(e=ie[t])||void 0===e?void 0:e.recommendedClassification)||"quantile";u(n),d(),r(!1)},btnVariant:"tertiary",size:"sm",className:"flex-1",children:(0,l.__)("Reset to defaults","burst-statistics")})]})})})]})})]})},We=function(){return(0,n.jsx)("div",{className:"flex items-center gap-2",children:(0,n.jsx)(qe,{})})};var Ue=r(96850);const Be=(0,f.memo)((function(){return(0,n.jsx)(c.e,{className:"row-span-2 xl:col-span-6",children:(0,n.jsxs)(Ue.A,{children:[(0,n.jsx)(u.q,{className:"border-b border-gray-300",title:(0,l.__)("World View","burst-statistics"),controls:(0,n.jsx)(We,{})}),(0,n.jsx)(d.t,{className:"px-0 py-0",children:(0,n.jsx)(ze,{})})]})})})),Ze=function(){var e;console.log("GhostWorldMap: Component mounted");var t=Te(),r=t.simplifiedWorldGeoJson,a=t.isGeoSimpleLoading,i=oe((function(e){return e.projection}));return console.log("GhostWorldMap: isGeoSimpleLoading:",a),console.log("GhostWorldMap: simplifiedWorldGeoJson:",r),a?(console.log("GhostWorldMap: Still loading, returning loading message"),(0,n.jsx)("div",{children:"Loading..."})):r?(console.log("GhostWorldMap: simplifiedWorldGeoJson.features length:",null===(e=r.features)||void 0===e?void 0:e.length),console.log("GhostWorldMap: About to render ResponsiveChoropleth"),(0,n.jsx)("div",{className:"relative h-full min-h-[450px] w-full rounded-b-lg",style:{boxShadow:"inset 0 0 40px rgba(0, 0, 0, 0.06)"},children:(0,n.jsx)(ge,{features:[],data:[],baseMapFeatures:r.features,transform:r.transform,baseLayerOpacity:1,baseMapFeatureColor:"#006d2c",match:"id",value:"value",margin:{top:0,right:0,bottom:0,left:0},projectionType:"naturalEarth1",projectionScale:i.scale,projectionTranslation:i.translation,projectionRotation:i.rotation,enableGraticule:!0,graticuleLineColor:"#dddddd",borderWidth:.5,borderColor:"#adb5bd",isInteractive:!1,layers:["baseMapFeatures","graticule"],legends:[],zoomToFeature:null})})):(console.log("GhostWorldMap: No simplifiedWorldGeoJson data available"),(0,n.jsx)("div",{children:"No data available"}))},Je=(0,f.memo)((function(){return(0,n.jsx)(c.e,{className:"row-span-2 xl:col-span-6",children:(0,n.jsxs)(Ue.A,{children:[(0,n.jsx)(u.q,{className:"border-b border-gray-300",title:(0,l.__)("World View","burst-statistics")}),(0,n.jsx)(d.t,{className:"px-0 py-0",children:(0,n.jsx)(Ze,{})})]})})})),Qe=function(e){return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"col-span-12 flex items-center justify-between",children:[(0,n.jsx)(Ue.A,{children:(0,n.jsx)(a.y,{})}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(i.A,{})})]}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(Je,{})}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(s.A,{allowedConfigs:["pages"],id:99})}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(s.A,{allowedConfigs:["pages"],id:99})}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(s.A,{allowedConfigs:["pages"],id:99})})]})},Ke=function(e){var t=e.children,r=e.className,a=void 0===r?"":r;return(0,n.jsxs)("div",{className:"absolute inset-0 z-50 ".concat(a),children:[(0,n.jsx)("div",{className:"absolute inset-0 backdrop-blur-sm"}),(0,n.jsx)("div",{className:"relative flex justify-center pt-8 m-8 mt-24",children:(0,n.jsx)("div",{className:"mx-4 min-w-fit rounded-md border border-gray-300 bg-gray-100 px-8 py-12 shadow-md",children:t})})]})};var He=function(){return He=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},He.apply(this,arguments)},Ye=(0,$.v)((0,ee.Zr)((function(e,t){return{testVariations:{},getTestVariation:function(e){var r;return(null===(r=t().testVariations[e])||void 0===r?void 0:r.variation)||null},setTestVariation:function(t,r){e((function(e){var n;return{testVariations:He(He({},e.testVariations),(n={},n[t]={variation:r,assignedAt:Date.now()},n))}}))},assignRandomVariation:function(e,r){var n=r[Math.floor(Math.random()*r.length)];return t().setTestVariation(e,n),n},hasTestVariation:function(e){var r=t();return Boolean(r.testVariations[e])},getTestData:function(e){return t().testVariations[e]||null},removeTestVariation:function(t){e((function(e){var r=He({},e.testVariations);return delete r[t],{testVariations:r}}))},clearAllTests:function(){e({testVariations:{}})},getTestsSummary:function(){var e=t();return Object.entries(e.testVariations).reduce((function(e,t){var r=t[0],n=t[1];return e[r]={variation:n.variation,assignedAt:n.assignedAt,assignedDate:new Date(n.assignedAt).toISOString()},e}),{})}}}),{name:"burst-ab-test-storage",partialize:function(e){return{testVariations:e.testVariations}}}));const Xe=function(e){var t=e.className,r=void 0===t?"":t,a=function(e,t,r){void 0===t&&(t=["A","B"]),void 0===r&&(r={});var n=r.defaultVariation,a=void 0===n?t[0]:n,i=r.trafficAllocation,s=void 0===i?100:i,o=Ye(),l=o.getTestVariation,c=(o.setTestVariation,o.assignRandomVariation),u=(o.hasTestVariation,o.getTestData),d=o.removeTestVariation;if(!Array.isArray(t)||0===t.length)throw new Error("useABTest: variations must be a non-empty array");if(s<0||s>100)throw new Error("useABTest: trafficAllocation must be between 0 and 100");var m=(0,f.useMemo)((function(){if(!(100===s||100*Math.random()<s))return{variation:a,isNewAssignment:!1,testData:null,isInTest:!1};var r=l(e);if(r){if(t.includes(r))return{variation:r,isNewAssignment:!1,testData:u(e),isInTest:!0};console.warn('useABTest: Existing variation "'.concat(r,'" for test "').concat(e,'" is not in current variations list. Reassigning.')),d(e)}return{variation:c(e,t),isNewAssignment:!0,testData:u(e),isInTest:!0}}),[e,t,a,s,l,u,d,c]);return{variation:m.variation,isNewAssignment:m.isNewAssignment,testData:m.testData,isInTest:m.isInTest,reassign:function(){return d(e),c(e,t)}}}("upsell-copy-v1",["A","B"]).variation,i={utm_source:"plugin",utm_medium:"upsell",utm_campaign:"upsell-variation-".concat(a.toLowerCase())},s=function(e){switch(e){case"A":return{title:(0,l.__)("Are you just guessing with your marketing?","burst-statistics"),description:(0,l.__)("You spend time and money creating campaigns, but can't see what's actually working. Are your newsletters driving traffic or just getting opened? Is your social media budget paying off? Without clear tracking, you're making decisions in the dark, which is inefficient and frustrating.","burst-statistics"),bullets:[{icon:"goals",text:(0,l.__)("Stop guessing: Track UTM campaigns to see which channels deliver real visitors.","burst-statistics")},{icon:"filter",text:(0,l.__)("Optimize with confidence: Refine on-site promotions by analyzing custom URL parameters.","burst-statistics")},{icon:"world",text:(0,l.__)("Go beyond numbers: Visualize exactly where your visitors are with an interactive world map.","burst-statistics")}]};case"B":return{title:(0,l.__)("Turn your traffic into targeted growth.","burst-statistics"),description:(0,l.__)("Effective growth comes from understanding your audience on a deeper level. Burst Pro provides the tools to see not just how many people visit, but who they are and what brought them to you, so you can focus your efforts where they matter most.","burst-statistics"),bullets:[{icon:"goals",text:(0,l.__)("Measure the success of your marketing with automatic UTM campaign tracking.","burst-statistics")},{icon:"filter",text:(0,l.__)("Optimize your website by tracking how visitors interact with specific parameters.","burst-statistics")},{icon:"world",text:(0,l.__)("Tailor your content by identifying key visitor locations, from country down to the city.","burst-statistics")}]};default:return s("A")}},o=s(a);return(0,n.jsxs)("div",{className:"mx-auto flex max-w-3xl gap-8 flex-wrap".concat(r),children:[(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)("h2",{className:"mb-4 text-2xl font-bold leading-tight text-black md:text-3xl",children:o.title}),(0,n.jsx)("p",{className:"text-base leading-relaxed text-gray",children:o.description})]}),(0,n.jsx)("div",{className:"max-w-content mx-auto flex flex-col space-y-4",children:o.bullets.map((function(e,t){var r=e.text.split(":"),a=r.length>1;return(0,n.jsxs)("div",{className:"flex max-w-fit items-center space-x-4",children:[(0,n.jsx)("div",{className:"mt-0.5 flex-shrink-0",children:(0,n.jsx)("div",{className:"flex h-7 w-7 items-center justify-center rounded-full bg-primary-light",children:(0,n.jsx)(be.A,{name:e.icon,color:"black",size:14,strokeWidth:2})})}),(0,n.jsx)("div",{className:"pt-1",children:(0,n.jsx)("p",{className:"m-0 whitespace-nowrap text-md leading-relaxed text-gray",children:a?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("span",{className:"font-semibold text-gray",children:[r[0],":"]}),(0,n.jsx)("span",{className:"ml-1",children:r.slice(1).join(":")})]}):(0,n.jsx)("span",{className:"font-semibold text-gray",children:e.text})})})]},t)}))}),(0,n.jsxs)("div",{className:"flex w-full flex-col items-center space-y-3 text-center",children:[(0,n.jsx)(Re.A,{btnVariant:"primary",size:"lg",link:{to:(0,Pe.U)("pricing",i)},children:(0,l.__)("Upgrade to Pro","burst-statistics")}),(0,n.jsx)("div",{children:(0,n.jsx)(Re.A,{btnVariant:"tertiary",size:"md",link:{to:(0,Pe.U)("/",i)},children:(0,l.__)("Learn about all features","burst-statistics")})})]}),!1]})};var $e=r(16060),et=function(){var e=$e.q.useLoaderData(),t=e.hasActiveLicense,r=e.isPro;return console.log("hasActiveLicense",t),console.log("isPro",r),r?t?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:"col-span-12 flex items-center justify-between",children:[(0,n.jsx)(Ue.A,{children:(0,n.jsx)(a.y,{})}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(i.A,{})})]}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(Be,{})}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(s.A,{allowedConfigs:["countries"],id:5})}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(s.A,{allowedConfigs:["campaigns"],id:3})}),(0,n.jsx)(Ue.A,{children:(0,n.jsx)(s.A,{allowedConfigs:["referrers"],id:4})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Qe,{}),(0,n.jsx)(Ke,{children:(0,n.jsxs)("div",{className:"text-center space-y-6",children:[(0,n.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:(0,l.__)("Unlock Source Insights","burst-statistics")}),(0,n.jsx)("p",{className:"text-lg text-gray-600 max-w-md mx-auto",children:(0,l.__)("Get detailed insights into where your traffic comes from.","burst-statistics")}),(0,n.jsx)("p",{className:"text-base text-gray-500",children:(0,l.__)("Already have a license? Activate it to access these features.","burst-statistics")}),(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center items-center",children:[(0,n.jsx)(Re.A,{btnVariant:"primary",size:"lg",link:{to:"/settings/license"},children:(0,l.__)("Activate License","burst-statistics")}),(0,n.jsx)(Re.A,{btnVariant:"secondary",size:"lg",onClick:function(){window.open((0,Pe.U)("pricing"),"_blank")},children:(0,l.__)("Upgrade Plan","burst-statistics")})]})]})})]}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(Qe,{}),(0,n.jsx)(Ke,{children:(0,n.jsx)(Xe,{})})]})}},22895:(e,t,r)=>{r.d(t,{S:()=>d});var n=r(71511),a=r(87134),i=r(72346),s=r(31127),o=r(979),l=r(66212),c=r(80900),u=function(e){if(c.cA[e]){var t=c.cA[e].range(),r=t.startDate,n=t.endDate;return{startDate:(0,i.default)(r,"yyyy-MM-dd"),endDate:(0,i.default)(n,"yyyy-MM-dd"),range:e}}return null},d=(0,n.v)((0,a.Zr)((function(e,t){return{startDate:(0,i.default)((0,s.default)((0,o.A)(new Date,7)),"yyyy-MM-dd"),endDate:(0,i.default)((0,l.default)((0,o.A)(new Date,1)),"yyyy-MM-dd"),range:"last-7-days",setStartDate:function(t){return e({startDate:t})},setEndDate:function(t){return e({endDate:t})},setRange:function(t){if("custom"!==t){var r=u(t);r&&e(r)}else e({range:t})}}}),{name:"burst-date-storage",partialize:function(e){return{range:e.range,startDate:e.startDate,endDate:e.endDate}},onRehydrateStorage:function(){return function(e){if(e&&e.range&&"custom"!==e.range){var t=u(e.range);t&&Object.assign(e,t)}}}}))},24660:(e,t,r)=>{r.d(t,{A:()=>d});var n=r(97665),a=r(48069),i=r(57097),s=r(86275),o=r(55446),l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},l.apply(this,arguments)},c=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))},u=function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}};const d=function(){var e=(0,n.jE)(),t=(0,a.I)({queryKey:["settings_fields"],queryFn:function(){return c(void 0,void 0,void 0,(function(){return u(this,(function(e){switch(e.label){case 0:return[4,(0,s.ww)()];case 1:return[2,e.sent().fields]}}))}))},staleTime:3e5,initialData:window.burst_settings&&window.burst_settings.fields,retry:0,select:function(e){return function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}([],e,!0)}}),r=(0,i.n)({mutationFn:function(t){return c(void 0,void 0,void 0,(function(){return u(this,(function(r){switch(r.label){case 0:return[4,(0,s.Ey)(t)];case 1:return r.sent(),[4,e.invalidateQueries(["settings_fields"])];case 2:return r.sent(),[2]}}))}))},onSuccess:function(){o.toast.success("Settings saved")}}),d=r.mutateAsync,f=r.isLoading;return{settings:t.data,saveSettings:d,getValue:function(e){var r;return null===(r=t.data.find((function(t){return t.id===e})))||void 0===r?void 0:r.value},addNotice:function(t,r,n,a){e.setQueryData(["settings_fields"],(function(e){return e.map((function(e){if(e.id!==t)return e;var i={title:a,label:r,description:n};return l(l({},e),{notice:i})}))}))},setValue:function(e,r){var n=t.data.find((function(t){return t.id===e}));n&&(n.value=r)},isSavingSettings:f,invalidateSettings:function(){return e.invalidateQueries(["settings_fields"])}}}},29369:(e,t,r)=>{r.d(t,{A:()=>h});var n=r(74848),a=r(51609),i=r.n(a),s=r(240),o=r(83101),l=r(332),c=r(22895),u=r(44301),d=r(27723),f=r(55446),m=r(80900),p=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};const h=i().memo((function(e){var t=e.filter,r=e.filterValue,i=e.label,h=e.children,g=e.startDate,v=e.endDate,b=(0,s.c)((function(e){return e.setFilters})),y=(0,s.c)((function(e){return e.filtersConf})),x=(0,o.A)().getGoal,j=(0,l.G)((function(e){return e.setMetrics})),w=(0,l.G)((function(e){return e.getMetrics()})),_=(0,c.S)((function(e){return e.setStartDate})),N=(0,c.S)((function(e){return e.setEndDate})),A=(0,c.S)((function(e){return e.setRange})),k=(0,a.useMemo)((function(){return t&&y&&Object.prototype.hasOwnProperty.call(y,t)}),[t,y]);if(!k)return(0,n.jsx)(n.Fragment,{children:h});var M=(0,a.useMemo)((function(){return i?"".concat((0,d.__)("Click to filter by:","burst-statistics")," ").concat(i):(0,d.__)("Click to filter","burst-statistics")}),[i,k]),C=(0,a.useCallback)((function(){if(g){var e="",t="";if(/^\d+$/.test(g)){var r=10===g.toString().length?1e3*g:g;e=new Date(r).toISOString().split("T")[0]}else/\d{4}-\d{2}-\d{2}/.test(g)&&(e=g);v?/^\d+$/.test(v)?(r=10===v.toString().length?1e3*v:v,t=new Date(r).toISOString().split("T")[0]):/\d{4}-\d{2}-\d{2}/.test(v)&&(t=v):t=(new Date).toISOString().split("T")[0],(0,m.vd)(e)&&(0,m.vd)(t)&&(_(e),N(t),A("custom"))}}),[g,v,_,N,A]),O=(0,a.useCallback)((function(e){var t=x(e);(null==t?void 0:t.goal_specific_page)?(b("page_url",t.goal_specific_page),b("goal_id",e),f.toast.info((0,d.__)("Filtering by goal & goal specific page","burst-statistics"))):(b("goal_id",e),f.toast.info((0,d.__)("Filtering by goal","burst-statistics"))),w.includes("conversions")||j(p(p([],w,!0),["conversions"],!1))}),[x,b,w,j]),D=(0,a.useCallback)((function(){k?("goal_id"===t?O(r):b(t,r),C()):console.warn('ClickToFilter: Invalid filter "'.concat(t,'" - not found in filter configuration'))}),[t,r,k,O,b,C]);return t&&r&&k?(0,n.jsx)(u.A,{content:M,children:(0,n.jsx)("span",{onClick:D,className:"burst-click-to-filter",children:h})}):(0,n.jsx)(n.Fragment,{children:h})}))},41437:(e,t,r)=>{r.d(t,{A:()=>h});var n=r(74848),a=r(51609),i=r(30020),s=r(1806),o=r(72346),l=r(57112),c=r(22895),u=r(80900),d=r(9823),f="yyyy-MM-dd",m=new Date(2022,0,1),p=function(e){var t=e.range,r=e.display,a=e.isOpen,i=e.setIsOpen;return(0,n.jsxs)(d.l9,{className:"flex min-w-[200px] items-center gap-2 rounded-md border border-gray-400 bg-gray-100 px-3 py-2  shadow-md transition-all duration-200 hover:[box-shadow:0_0_0_3px_rgba(0,0,0,0.1)]",onClick:function(){return i(!a)},children:[(0,n.jsx)(l.A,{name:"calendar",size:"18"}),(0,n.jsx)("span",{className:"w-full text-base",children:"custom"===t?"".concat(r.startDate," - ").concat(r.endDate):u.cA[t].label}),(0,n.jsx)(l.A,{name:"chevron-down"})]})};const h=function(){var e=(0,a.useState)(!1),t=e[0],r=e[1],l=(0,c.S)(),h=l.startDate,g=l.endDate,v=l.setStartDate,b=l.setEndDate,y=l.setRange,x=l.range,j=(0,a.useState)({startDate:(0,s.A)(h),endDate:(0,s.A)(g),key:"selection"}),w=j[0],_=j[1],N=(0,a.useRef)(0),A=burst_settings.date_ranges,k=(0,a.useMemo)((function(){return(0,u.cf)(A)}),[A]),M=(0,a.useMemo)((function(){return(0,u.YP)(h,g)}),[h,g]),C=(0,a.useCallback)((function(e){try{N.current++;var t=e.selection,n=t.startDate,a=t.endDate,i=(0,o.default)(n,f),l=(0,o.default)(a,f);_({startDate:(0,s.A)(i),endDate:(0,s.A)(l),key:"selection"});var c=Object.keys(u.cA).find((function(t){return u.cA[t].isSelected(e.selection)}))||"custom";(2===N.current||"custom"!==c||i!==l)&&(N.current=0,v(i),b(l),y(c),r(!1))}catch(e){console.error("Error updating date range:",e)}}),[v,b,y]);return(0,n.jsx)("div",{className:"ml-auto w-auto",children:(0,n.jsxs)(d.bL,{open:t,onOpenChange:r,children:[(0,n.jsx)(p,{range:x,display:M,isOpen:t,setIsOpen:r}),(0,n.jsx)(d.ZL,{container:document.querySelector(".burst"),children:(0,n.jsxs)(d.UC,{align:"end",sideOffset:10,arrowPadding:10,id:"burst-statistics",children:[(0,n.jsx)("span",{className:"absolute right-4 mt-1 h-4 w-4 -translate-y-2 rotate-45 transform bg-green-light"}),(0,n.jsx)("div",{className:"z-50 rounded-lg border border-gray-200 bg-white shadow-md",children:(0,n.jsx)(i.Ur,{ranges:[w],rangeColors:["#2B8133"],dateDisplayFormat:"dd MMMM yyyy",monthDisplayFormat:"MMMM",onChange:C,inputRanges:[],showSelectionPreview:!0,months:2,direction:"horizontal",minDate:m,maxDate:(0,u.ii)(),staticRanges:k})})]})})]})})}},43933:(e,t,r)=>{r.d(t,{t:()=>s});var n=r(74848),a=r(51609),i=r(34164),s=(0,a.memo)((function(e){var t=e.children,r=e.className,a=void 0===r?"":r,s=/\bp-\S+/.test(a);return(0,n.jsx)("div",{className:(0,i.A)("flex-grow",{"p-6":!s},a),children:t})}));s.displayName="BlockContent"},44301:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(74848),a=(r(51609),r(3881));const i=function(e){var t=e.children,r=e.content,i=e.delayDuration,s=void 0===i?400:i;return r?(0,n.jsx)(a.Kq,{children:(0,n.jsxs)(a.bL,{delayDuration:s,children:[(0,n.jsx)(a.l9,{asChild:!0,children:t}),(0,n.jsxs)(a.UC,{className:"burst-tooltip-content z-53",sideOffset:5,children:[r,(0,n.jsx)(a.i3,{className:"burst-tooltip-arrow"})]})]})}):(0,n.jsx)(n.Fragment,{children:t})}},46241:(e,t,r)=>{r.d(t,{A:()=>J});var n=r(74848),a=r(27723),i=r(51609),s=r(75500),o=r(40585),l=r(57112),c=r(9823);const u=function(e){var t=e.children,r=e.className,s=(e.onClick,e.show,e.title),o=e.subtitle,u=e.bulletPoints,d=void 0===u?[]:u,f=e.primaryButtonUrl,m=e.secondaryButtonUrl,p=(0,i.useState)(!1),h=p[0],g=p[1];return(0,n.jsxs)(c.bL,{open:h,onOpenChange:g,children:[(0,n.jsx)(c.l9,{className:"cursor-pointer ".concat(r),onMouseEnter:function(){return g(!0)},children:t}),(0,n.jsx)(c.ZL,{children:(0,n.jsxs)(c.UC,{className:"z-[9999] min-w-[320px] max-w-[400px] rounded-lg border border-gray-200 bg-white p-0 shadow-xl",align:"start",sideOffset:10,arrowPadding:10,children:[(0,n.jsx)(c.i3,{className:"fill-white drop-shadow-sm"}),(0,n.jsxs)("div",{className:"relative border-b border-gray-100 px-6 py-4",children:[(0,n.jsx)(c.bm,{className:"absolute right-3 top-3 rounded-full p-1 transition-colors hover:bg-gray-100",children:(0,n.jsx)(l.A,{name:"times",size:16})}),(0,n.jsx)("h5",{className:"mb-1 pr-8 text-lg font-semibold text-black",children:s}),(0,n.jsx)("h6",{className:"m-0 text-sm text-gray",children:o})]}),(0,n.jsxs)("div",{className:"px-6 py-4",children:[(0,n.jsx)("p",{className:"mb-3 text-xs font-medium uppercase tracking-wide text-gray",children:(0,a.__)("Pro features include:","burst-statistics")}),(0,n.jsx)("div",{className:"space-y-2",children:d.map((function(e){var t=e.text,r=e.icon;return(0,n.jsxs)("div",{className:"flex items-center gap-3",children:[(0,n.jsx)("div",{className:"flex h-5 w-5 flex-shrink-0 items-center justify-center",children:(0,n.jsx)(l.A,{name:r,size:16,color:"#2B8133"})}),(0,n.jsx)("p",{className:"m-0 text-sm text-gray",children:t})]},t)}))})]}),(0,n.jsxs)("div",{className:"flex flex-col gap-2 rounded-b-lg border-t border-gray-100 bg-gray-50 px-6 py-4",children:[(0,n.jsx)("a",{href:f,target:"_blank",rel:"noopener noreferrer",className:"w-full rounded bg-primary px-4 py-1 text-center text-base font-normal text-white no-underline transition-all duration-200 hover:bg-primary hover:[box-shadow:0_0_0_3px_rgba(43,129,51,0.5)]",children:(0,a.__)("Upgrade to Pro","burst-statistics")}),(0,n.jsx)("a",{href:m,target:"_blank",rel:"noopener noreferrer",className:"w-full rounded border border-gray-400 bg-gray-100 px-4 py-1 text-center text-base font-normal text-gray no-underline transition-all duration-200 hover:bg-gray-200 hover:text-gray hover:[box-shadow:0_0_0_3px_rgba(0,0,0,0.1)]",children:(0,a.__)("Learn More","burst-statistics")})]})]})})]})};var d=r(76870);const f=(0,i.memo)((function(e){var t=e.value,r=e.onChange,a=e.options,s=(0,i.useCallback)((function(e){r(e)}),[r]),c=(0,d.A)(),f=c.isLicenseValid,m=c.isPro,p=m&&f(),h=(0,i.useMemo)((function(){return{hasProOptions:a.some((function(e){return e.pro})),firstOption:a[0]}}),[a]),g=h.hasProOptions,v=h.firstOption;return g&&!p&&(null==v?void 0:v.upsellPopover)?(0,n.jsxs)(u,{title:v.upsellPopover.title,subtitle:v.upsellPopover.subtitle,bulletPoints:v.upsellPopover.bulletPoints,primaryButtonUrl:v.upsellPopover.primaryButtonUrl,secondaryButtonUrl:v.upsellPopover.secondaryButtonUrl,children:[(0,n.jsx)("h3",{className:"burst-grid-title burst-h4",children:v.label}),(0,n.jsx)(l.A,{name:"chevron-down"})]}):1===a.length?(0,n.jsx)("span",{className:"text-lg font-semibold",children:a[0].label}):(0,n.jsxs)(o.bL,{value:t,onValueChange:s,children:[(0,n.jsxs)(o.l9,{className:"burst-datatable__select-trigger",children:[(0,n.jsx)(o.WT,{placeholder:"Select an option…"}),(0,n.jsx)(o.In,{className:"burst-datatable__select-trigger__icon",children:(0,n.jsx)(l.A,{name:"chevron-down"})})]}),(0,n.jsx)(o.UC,{className:"burst-datatable__select-content",position:"popper",alignOffset:-10,children:(0,n.jsx)(o.LM,{children:a.map((function(e){return(0,n.jsx)(o.q7,{value:e.key,className:"burst-datatable__select-content__item",disabled:e.pro&&!m,children:(0,n.jsx)(o.p4,{className:"burst-datatable__select-content__label",children:e.label})},e.key)}))})})]})}));var m=r(71511),p=r(87134),h=function(){return h=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},h.apply(this,arguments)},g=(0,m.v)((0,p.Zr)((function(e,t){return{selectedConfigs:{},setSelectedConfig:function(t,r){e((function(e){var n;return{selectedConfigs:h(h({},e.selectedConfigs),(n={},n[t]=r,n))}}))},getSelectedConfig:function(e,r){return t().selectedConfigs[e]||r},columnConfigs:{},setColumns:function(t,r){e((function(e){var n;return{columnConfigs:h(h({},e.columnConfigs),(n={},n[t]=r,n))}}))},getColumns:function(e,r){return t().columnConfigs[e]||r},filterTexts:{},setFilterText:function(t,r){e((function(e){var n;return{filterTexts:h(h({},e.filterTexts),(n={},n[t]=r,n))}}))},getFilterText:function(e){return t().filterTexts[e]||""},clearTableData:function(t){e((function(e){var r=h({},e.selectedConfigs),n=h({},e.filterTexts);return delete r[t],delete n[t],{selectedConfigs:r,filterTexts:n}}))},resetAll:function(){e({selectedConfigs:{},columnConfigs:{},filterTexts:{}})}}}),{name:"burst-datatable-storage",partialize:function(e){return{selectedConfigs:e.selectedConfigs,columnConfigs:e.columnConfigs}}}));const v=(0,i.memo)((function(e){var t=e.isLoading,r=e.error,i=e.noData;return t?(0,n.jsx)("div",{className:"burst-datatable-message burst-loading",children:(0,n.jsx)("p",{children:(0,a.__)("Loading data...","burst-statistics")})}):r?(0,n.jsx)("div",{className:"burst-datatable-message burst-error",children:(0,n.jsxs)("p",{children:[(0,a.__)("Error:","burst-statistics")," ",r.message]})}):i?(0,n.jsx)("div",{className:"burst-datatable-message burst-no-data",children:(0,n.jsx)("p",{children:(0,a.__)("No data available in table","burst-statistics")})}):(0,n.jsx)("div",{className:"burst-datatable-message burst-unexpected-error",children:(0,n.jsx)("p",{children:(0,a.__)("Unexpected error","burst-statistics")})})}));var b,y=r(83757),x=r(22895),j=r(240),w=r(48069),_=r(86275),N=r(80900),A=r(51456),k=r(29369),M=r(23392),C=function(){return C=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},C.apply(this,arguments)},O=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},D={PERCENTAGE:"percentage",TIME:"time",COUNTRY:"country",CONTINENT:"continent",URL:"url",TEXT:"text",INTEGER:"integer"},S=(0,i.memo)(k.A),T=(0,i.memo)((function(e){var t=e.value;return(0,n.jsx)(S,{filter:"country_code",filterValue:t,children:(0,n.jsx)(A.A,{country:t,countryNiceName:(0,N.qQ)(t)})})})),F=(0,i.memo)((function(e){var t=e.value;return(0,n.jsx)(S,{filter:"page_url",filterValue:t,children:(0,M.S)(t)})})),E=((0,i.memo)((function(e){var t=e.value;return(0,n.jsx)(S,{filter:"referrer",filterValue:t,children:(0,M.S)(t)})})),new Map,S=(0,i.memo)(k.A),T=(0,i.memo)((function(e){var t=e.value;return(0,n.jsx)(S,{filter:"country_code",filterValue:t,children:(0,n.jsx)(A.A,{country:t,countryNiceName:(0,N.qQ)(t)})})})),(0,i.memo)((function(e){var t=e.value;return(0,n.jsx)(S,{filter:"continent_code",filterValue:t,children:(0,n.jsx)(n.Fragment,{children:(0,N.Iq)(t)})})}))),P=(F=(0,i.memo)((function(e){var t=e.filter,r=e.value;return(0,n.jsx)(S,{filter:t,filterValue:r,children:(0,M.S)(r)})})),(0,i.memo)((function(e){var t=e.filter,r=e.value;return(0,n.jsx)(S,{filter:t,filterValue:r,children:r})}))),I=((b={})[D.PERCENTAGE]=function(e){return(0,N.Ee)(e)},b[D.TIME]=function(e){return(0,N.fU)(e)},b[D.INTEGER]=function(e){return parseInt(e,10)},b[D.COUNTRY]=function(e){return e&&""!==e?(0,n.jsx)(T,{value:e}):(0,a.__)("Not set","burst-statistics")},b[D.CONTINENT]=function(e){return(0,n.jsx)(E,{value:e})},b[D.URL]=function(e,t){return(0,n.jsx)(F,{filter:t,value:e})},b[D.TEXT]=function(e,t){return(0,n.jsx)(P,{filter:t,value:e})},b),z=function(e,t){var r=[D.PERCENTAGE,D.TIME,D.INTEGER].includes(t);return function(t,n){var a=t[e],i=n[e];if(null==a&&null==i)return 0;if(null==a)return 1;if(null==i)return-1;if(r){var s=parseFloat(a),o=parseFloat(i);return isNaN(s)&&isNaN(o)?0:isNaN(s)?1:isNaN(o)?-1:s-o}return String(a).toLowerCase().localeCompare(String(i).toLowerCase())}},V=function(e,t){var r=I[e];return r?function(e){var n;try{var a=null!==(n=e[t])&&void 0!==n?n:"";return r(a,t)}catch(r){return console.error("Error formatting cell value for column ".concat(t,":"),r),e[t]||""}}:(console.warn("Unknown column format: ".concat(e,". Using default text formatter.")),function(e){return e[t]||""})},L=function(e,t){try{return function(e){if(!e||"object"!=typeof e)throw new Error("Invalid response: expected object");if(!Array.isArray(e.columns))throw new Error("Invalid response: columns must be an array");if(!Array.isArray(e.data))throw new Error("Invalid response: data must be an array")}(e),{columns:e.columns.map((function(e){return function(e,t){var r=t[e.id];if(!r)return e;var n=r.format||D.INTEGER,a=r.align||"left";return C(C({},e),{selector:function(t){return t[e.id]},right:"left"!==a,sortFunction:z(e.id,n),cell:V(n,e.id)})}(e,t)})),data:O([],e.data,!0)}}catch(e){return console.error("Data transformation error:",e),{columns:[],data:[],error:e.message}}};const G=function(e){return t=void 0,r=void 0,a=function(){var t,r,n,a,i,s,o;return function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),function(e){var t=e.startDate,r=e.endDate,n=e.range,a=e.columnsOptions;if(!t||!r||!n)throw new Error("Missing required parameters: startDate, endDate, range");if(!a||"object"!=typeof a)throw new Error("Missing or invalid columnsOptions parameter")}(e),t=e.startDate,r=e.endDate,n=e.range,a=e.args,i=e.columnsOptions,[4,(0,_.bQ)("datatable",t,r,n,a)];case 1:if(!(s=l.sent().data))throw new Error("No data received from API");return[2,L(s,i)];case 2:return o=l.sent(),console.error("Error fetching data table data:",o),[2,{columns:[],data:[],error:o.message}];case 3:return[2]}}))},new((n=void 0)||(n=Promise))((function(e,i){function s(e){try{l(a.next(e))}catch(e){i(e)}}function o(e){try{l(a.throw(e))}catch(e){i(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(s,o)}l((a=a.apply(t,r||[])).next())}));var t,r,n,a};var R=r(17926),q=r(96744),W=r(43933),U=function(){return U=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},U.apply(this,arguments)},B={pageviews:{label:(0,a.__)("Pageviews","burst-statistics"),default:!0,align:"right"},sessions:{label:(0,a.__)("Sessions","burst-statistics"),pro:!0,align:"right"},visitors:{label:(0,a.__)("Visitors","burst-statistics"),pro:!0,align:"right"},conversions:{label:(0,a.__)("Conversions","burst-statistics"),pro:!0,align:"right"},bounce_rate:{label:(0,a.__)("Bounce rate","burst-statistics"),format:"percentage",pro:!0,align:"right"},avg_time_on_page:{label:(0,a.__)("Time on page","burst-statistics"),pro:!0,format:"time",align:"right"}},Z={pages:{label:(0,a.__)("Pages","burst-statistics"),searchable:!0,defaultColumns:["page_url","pageviews"],columnsOptions:U({page_url:{label:(0,a.__)("Page URL","burst-statistics"),default:!0,format:"url",align:"left",group_by:!0}},B)},referrers:{label:(0,a.__)("Referrers","burst-statistics"),searchable:!0,defaultColumns:["referrer","pageviews"],columnsOptions:U({referrer:{label:(0,a.__)("Referrer","burst-statistics"),default:!0,format:"referrer",align:"left",group_by:!0}},B)},countries:{label:(0,a.__)("Locations","burst-statistics"),pro:!0,searchable:!0,defaultColumns:["country_code","state","city","pageviews"],columnsOptions:U({country_code:{label:(0,a.__)("Country","burst-statistics"),default:!0,format:"country",align:"left",group_by:!0},state:{label:(0,a.__)("State","burst-statistics"),format:"text",align:"left",group_by:!0},city:{label:(0,a.__)("City","burst-statistics"),format:"text",align:"left",group_by:!0},continent:{label:(0,a.__)("Continent","burst-statistics"),format:"continent",align:"left",group_by:!0}},B)},campaigns:{label:(0,a.__)("Campaigns","burst-statistics"),pro:!0,searchable:!0,defaultColumns:["source","pageviews"],columnsOptions:U({campaign:{label:(0,a.__)("Campaign","burst-statistics"),default:!0,format:"text",align:"left",group_by:!0},source:{label:(0,a.__)("Source","burst-statistics"),format:"text",align:"left",group_by:!0},medium:{label:(0,a.__)("Medium","burst-statistics"),format:"text",align:"left",group_by:!0},term:{label:(0,a.__)("Term","burst-statistics"),format:"text",align:"left",group_by:!0},content:{label:(0,a.__)("Content","burst-statistics"),format:"text",align:"left",group_by:!0}},B)},parameters:{label:(0,a.__)("Parameters","burst-statistics"),searchable:!0,pro:!0,defaultColumns:["parameter","pageviews"],columnsOptions:U({parameter:{label:(0,a.__)("Parameter","burst-statistics"),default:!0,format:"text",align:"left",group_by:!0},parameters:{label:(0,a.__)("Parameters","burst-statistics"),format:"text",align:"left",group_by:!0}},B)},ghost:{label:(0,a.__)("Ghost","burst-statistics"),searchable:!0,defaultColumns:["pageviews"],columnsOptions:U({},B)}};const J=(0,i.memo)((function(e){var t=e.allowedConfigs,r=void 0===t?["pages","referrers"]:t,o=e.id,l=(0,x.S)((function(e){return e})),c=l.startDate,u=l.endDate,d=l.range,m=(0,j.c)((function(e){return e.filters})),p=r[0],h=g(),b=h.getSelectedConfig,_=h.setSelectedConfig,N=h.getColumns,A=h.setColumns,k=(0,i.useState)((function(){return b(o,p)})),M=k[0],C=k[1],O=(0,i.useMemo)((function(){return Z[M]}),[M]),D=(0,i.useMemo)((function(){return(null==O?void 0:O.columnsOptions)||{}}),[O]),S=(0,i.useMemo)((function(){return(null==O?void 0:O.defaultColumns)||[]}),[O]),T=(0,i.useState)((function(){var e=N(M,S),t=Object.keys(D);return e.filter((function(e){return t.includes(e)}))})),F=T[0],E=T[1],P=(0,i.useCallback)((function(e){var t=e.filter((function(e){return Object.keys(D).includes(e)}));JSON.stringify(t)!==JSON.stringify(F)&&(E(t),A(M,t))}),[M,F,D,A]),I=(0,i.useCallback)((function(e){return t=void 0,r=void 0,a=function(){return function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(t){return C(e),_(o,e),[2]}))},new((n=void 0)||(n=Promise))((function(e,i){function s(e){try{l(a.next(e))}catch(e){i(e)}}function o(e){try{l(a.throw(e))}catch(e){i(e)}}function l(t){var r;t.done?e(t.value):(r=t.value,r instanceof n?r:new n((function(e){e(r)}))).then(s,o)}l((a=a.apply(t,r||[])).next())}));var t,r,n,a}),[o,_]);(0,i.useEffect)((function(){var e,t=N(M,(null===(e=Z[M])||void 0===e?void 0:e.defaultColumns)||[]);P(t)}),[M,P,N]);var z=(0,i.useState)(""),V=z[0],L=z[1],B=(0,i.useMemo)((function(){return Object.keys(Z).filter((function(e){return r.includes(e)})).map((function(e){return{key:e,label:Z[e].label,pro:!!Z[e].pro,upsellPopover:Z[e].upsellPopover||null}}))}),[r]),J=(0,i.useMemo)((function(){var e={filters:m,metrics:Object.keys(D).filter((function(e){return F.includes(e)})),group_by:[]};return F.forEach((function(t){var r;(null===(r=D[t])||void 0===r?void 0:r.group_by)&&e.group_by.push(t)})),e}),[m,D,F]),Q=(0,w.I)({queryKey:[M,c,u,J],queryFn:function(){return G({type:"datatable",startDate:c,endDate:u,range:d,args:J,columnsOptions:D})},enabled:!!M}),K=Q.data||{},H=K.data,Y=K.columns,X=(0,i.useMemo)((function(){var e=[];if((null==O?void 0:O.searchable)&&Array.isArray(H))if(""===V.trim())e=H;else{var t=V.toLowerCase(),r=Object.keys(D).filter((function(e){var t;return null===(t=D[e])||void 0===t?void 0:t.group_by}));e=H.filter((function(e){return r.some((function(r){var n=e[r];return null!=n&&n.toString().toLowerCase().includes(t)}))}))}else e=H;return Array.isArray(e)?e:[]}),[H,V,null==O?void 0:O.searchable,D]),$=Q.isLoading||Q.isFetching,ee=Q.error,te=0===X.length,re=(0,i.useMemo)((function(){if(!Y||!D)return[];var e=Object.keys(D);return Y.sort((function(t,r){return e.indexOf(t.selector)-e.indexOf(r.selector)}))}),[Y,D]);if(!O)return null;var ne=(0,i.useMemo)((function(){return{columns:re,data:X,defaultSortFieldId:2,defaultSortAsc:!1,pagination:!0,paginationRowsPerPageOptions:[10,25,50,100,200],paginationPerPage:10,paginationComponentOptions:{rowsPerPageText:"",rangeSeparatorText:(0,a.__)("of","burst-statistics"),noRowsPerPage:!1,selectAllRowsItem:!0,selectAllRowsItemText:(0,a.__)("All","burst-statistics")},noDataComponent:(0,n.jsx)(v,{noData:te,data:[],isLoading:$,error:ee}),progressPending:$,progressComponent:(0,n.jsx)(v,{noData:te,data:[],isLoading:$,error:ee})}}),[re,X,te,$,ee]);return(0,n.jsxs)(R.e,{className:"row-span-2 overflow-hidden xl:col-span-6",children:[(0,n.jsx)(q.q,{title:(0,n.jsx)(f,{value:M,onChange:I,options:B,disabled:[]}),controls:(0,n.jsxs)(n.Fragment,{children:[O.searchable&&(0,n.jsx)("input",{className:"burst-datatable-search ml-auto",type:"text",placeholder:(0,a.__)("Search","burst-statistics"),value:V,onChange:function(e){return L(e.target.value)}}),(0,n.jsx)(s.A,{selectedOptions:F,options:D,onApply:P})]})}),(0,n.jsx)(W.t,{className:"px-0 py-0",children:(0,n.jsx)(y.Ay,U({},ne))})]})}))},47307:(e,t,r)=>{r.d(t,{y:()=>u});var n=r(74848),a=r(240),i=r(57112),s=r(27723),o=r(83101),l=r(332),c=r(23392),u=function(){var e=(0,a.c)((function(e){return e.filters})),t=(0,a.c)((function(e){return e.filtersConf})),r=(0,a.c)((function(e){return e.setFilters})),u=(0,o.A)().getGoal,d=(0,l.G)((function(e){return e.setMetrics})),f=(0,l.G)((function(e){return e.getMetrics()})),m="";return(0,n.jsx)("div",{className:"flex flex-wrap gap-2",children:Object.keys(t).map((function(a,o){if(""!==e[a])return"goal_id"===a?(p=e[a],h=u(p),m=h?h.title:""):"device"===a?m=function(e){switch(e){case"desktop":return(0,s.__)("Desktop","burst-statistics");case"tablet":return(0,s.__)("Tablet","burst-statistics");case"mobile":return(0,s.__)("Mobile","burst-statistics");default:return(0,s.__)("Other","burst-statistics")}}(e[a]):"country_code"===a?(l=e[a],m=l?(l=l.toUpperCase(),burst_settings.countries[l]||l):""):m=e[a],""!==t[a].icon&&t[a].icon,(0,n.jsxs)("div",{className:"inline-flex items-center gap-2 px-3 py-2 bg-gray-100 border border-gray-400 shadow-md rounded-md text-sm",children:[(0,n.jsx)(i.A,{name:t[a].icon,size:"16"}),(0,n.jsx)("p",{className:"font-medium",children:t[a].label}),(0,n.jsx)("span",{className:"h-4 w-px bg-gray-400"}),(0,n.jsx)("p",{className:"text-gray",children:(0,c.S)(m)}),(0,n.jsx)("button",{onClick:function(){return function(e){r(e,""),"goal_id"===e&&d(f.filter((function(e){return"conversions"!==e})))}(a)},className:"rounded-full p-1 transition-colors hover:bg-gray-200",children:(0,n.jsx)(i.A,{name:"times",color:"var(--rsp-grey-500)",size:"16"})})]},o);var l,p,h}))})}},51456:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(74848),a=r(19809);const i=function(e){var t=e.country,r=e.countryNiceName,i=void 0===r?"":r;if("string"!=typeof t)return(0,n.jsx)("span",{className:"burst-flag-wrapper",children:i});""===i&&(i=t),""===i&&(i=__("Unknown","burst-statistics")),t=t.toLowerCase();var s="".concat(burst_settings.plugin_url,"src/Pro/assets/flags/4x3/").concat(t,".svg");return(0,n.jsxs)("span",{className:"burst-flag-wrapper",children:[(0,n.jsx)(a.k,{src:s,className:"burst-flag burst-flag-".concat(t),title:i})," ",i]})}},57112:(e,t,r)=>{r.d(t,{A:()=>ue});var n=r(74848),a=r(51609),i=r(44301),s=r(68309),o=r(20613),l=r(88007),c=r(45773),u=r(418),d=r(37946),f=r(48697),m=r(79804),p=r(50180),h=r(72102),g=r(75107),v=r(87677),b=r(60250),y=r(80697),x=r(86241),j=r(15977),w=r(69137),_=r(14021),N=r(80827),A=r(7962),k=r(89108),M=r(32307),C=r(46050),O=r(58641),D=r(64997),S=r(35404),T=r(1839),F=r(48686),E=r(93893),P=r(27235),I=r(3160),z=r(82853),V=r(68397),L=r(55042),G=r(45899),R=r(96844),q=r(50541),W=r(44080),U=r(38818),B=r(45742),Z=r(8904),J=r(89798),Q=r(4179),K=r(52105),H=r(39574),Y=r(70099),X=r(83194),$=r(73291),ee=r(40073),te=r(14539),re=r(41233),ne=r(75333),ae=r(18931),ie=r(80072),se=r(6443),oe=function(){return oe=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},oe.apply(this,arguments)},le={black:"var(--rsp-black)",green:"var(--rsp-green)",yellow:"var(--rsp-yellow)",red:"var(--rsp-red)",blue:"var(--rsp-blue)",gray:"var(--rsp-grey-400)",lightgray:"var(--rsp-grey-350)",white:"var(--rsp-white)"},ce={"circle-open":s.A,bullet:s.A,dot:s.A,circle:o.A,period:l.A,check:c.A,warning:u.A,error:d.A,times:f.A,"circle-check":m.A,"circle-times":p.A,"chevron-up":h.A,"chevron-down":g.A,"chevron-right":v.A,"chevron-left":b.A,plus:y.A,minus:x.A,sync:j.A,"sync-error":w.A,shortcode:_.A,file:N.A,"file-disabled":A.A,"file-download":k.A,calendar:M.A,"calendar-error":C.A,website:O.A,help:D.A,copy:S.A,trash:T.A,visitor:F.A,visitors:E.A,"visitors-crowd":E.A,time:P.A,pageviews:I.A,referrer:z.A,sessions:V.A,bounces:L.A,bounced_sessions:L.A,bounce_rate:L.A,winner:G.A,live:R.A,total:q.A,graph:W.A,conversion_rate:U.A,goals:B.A,conversions:B.A,"goals-empty":l.A,filter:Z.A,loading:J.A,desktop:Q.A,tablet:K.A,mobile:H.A,other:Y.A,mouse:X.A,eye:I.A,page:$.A,hashtag:ee.A,sun:te.A,world:re.A,filters:ne.A,referrers:ae.A,hook:ie.A,"log-in":se.A,"log-out":L.A,alert:d.A};const ue=(0,a.memo)((function(e){var t=e.name,r=void 0===t?"bullet":t,a=e.color,o=void 0===a?"black":a,l=e.size,c=void 0===l?18:l,u=e.strokeWidth,d=void 0===u?1.5:u,f=e.tooltip,m=e.onClick,p=e.className,h=le[o]||o,g=ce[r]||s.A,v={size:c,color:h,strokeWidth:d},b=(0,n.jsx)("div",{onClick:function(){m&&m()},className:"flex items-center justify-center",children:"bullet"!==r&&"dot"!==r||g!==s.A?(0,n.jsx)(g,oe({className:p},v)):(0,n.jsx)(s.A,oe({},v,{fill:h}))});return f?(0,n.jsx)(i.A,{content:f,children:b}):b}))},75500:(e,t,r)=>{r.d(t,{A:()=>h});var n=r(74848),a=r(51609),i=r(92731),s=r(681),o=r(46512),l=r(57112),c=r(27723),u=r(9292),d=r(9823);const f=function(e){var t=e.title,r=e.children,a=e.footer,i=e.isOpen,s=e.setIsOpen;return(0,n.jsxs)(d.bL,{open:i,onOpenChange:s,children:[(0,n.jsx)(d.l9,{id:"burst-filter-button",className:"".concat(i?"bg-gray-400 shadow-lg":"bg-gray-300"," focus:ring-blue-500 cursor-pointer rounded-full p-3 transition-all duration-200 hover:bg-gray-400 hover:shadow-md focus:outline-none focus:ring-2 focus:ring-offset-2"),onClick:function(){return s(!i)},children:(0,n.jsx)(l.A,{name:"filter"})}),(0,n.jsx)(d.ZL,{container:document.querySelector(".burst"),children:(0,n.jsxs)(d.UC,{className:"z-50 min-w-[280px] max-w-[400px] rounded-lg border border-gray-200 bg-white p-0 shadow-xl",align:"end",sideOffset:10,arrowPadding:10,children:[(0,n.jsx)(d.i3,{className:"fill-white drop-shadow-sm"}),(0,n.jsx)("div",{className:"border-b border-gray-100 px-4 py-3",children:(0,n.jsx)("h5",{className:"m-0 text-base font-semibold text-black",children:t})}),(0,n.jsx)("div",{className:"px-4 py-2",children:r}),a&&(0,n.jsx)("div",{className:"flex gap-2 rounded-b-lg border-t border-gray-100 bg-gray-50 px-4 py-3",children:a})]})})]})};var m=r(76870),p=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))};const h=function(e){var t=e.onApply,r=e.id,d=e.options,h=e.selectedOptions,g=e.selectionMode,v=void 0===g?"multiple":g,b=(0,a.useState)(!1),y=b[0],x=b[1],j=(0,a.useState)(h),w=j[0],_=j[1];(0,a.useEffect)((function(){_(h)}),[h]);var N=(0,m.A)().isLicenseValid,A=function(e){if("single"!==v||e&&0!==e.length)t(e);else{var r=Object.keys(d)[0];r&&t([r])}x(!1)},k=(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(o.A,{onClick:function(){return A(w),void x(!1)},btnVariant:"primary",size:"sm",className:"flex-1",children:(0,c.__)("Apply","burst-statistics")}),(0,n.jsx)(o.A,{onClick:function(){return function(){var e=Object.keys(d).filter((function(e){return d[e].default}));if("single"===v){var t=0<e.length?e[0]:Object.keys(d)[0];_([t]),A([t])}else _(e),A(e);x(!1)}()},btnVariant:"tertiary",size:"sm",className:"flex-1",children:(0,c.__)("Reset to defaults","burst-statistics")})]});return(0,n.jsx)(f,{isOpen:y,setIsOpen:function(e){e?x(!0):(x(!1),_(h))},title:"single"===v?(0,c.__)("Select metric","burst-statistics"):(0,c.__)("Select metrics","burst-statistics"),footer:k,children:"single"===v?(0,n.jsx)("div",{className:"flex flex-col gap-2",children:Object.keys(d).map((function(e){return(0,n.jsx)(s.A,{id:r+"_"+e,name:r+"_radio_group",value:e,label:d[e].label,checked:w[0]===e,disabled:!0===d[e].disabled||d[e].pro&&!N(),onChange:function(e){return _([e])},children:d[e].pro&&!N()&&(0,n.jsx)(u.A,{label:"Pro"})},e)}))}):Object.keys(d).map((function(e){return(0,n.jsxs)("div",{className:"flex items-center gap-3 py-1",children:[(0,n.jsx)(i.bL,{className:"focus:ring-blue-500 flex h-4 w-4 items-center justify-center rounded border-2 border-gray-300 bg-white transition-colors hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2",id:r+"_"+e,checked:w.includes(e),"aria-label":(0,c.__)("Change metrics","burst-statistics"),disabled:!0===d[e].disabled||d[e].pro&&!N(),onCheckedChange:function(){return function(e){"single"===v?_([e]):w.includes(e)?_(w.filter((function(t){return t!==e}))):_(p(p([],w,!0),[e],!1))}(e)},children:(0,n.jsx)(i.C1,{children:(0,n.jsx)(l.A,{name:"check",size:14,color:"green",strokeWidth:2})})}),(0,n.jsx)("label",{className:"flex-1 cursor-pointer text-sm text-gray",htmlFor:r+"_"+e,children:d[e].label}),(0,n.jsx)("div",{className:"flex-shrink-0",children:d[e].pro&&!N()&&(0,n.jsx)(u.A,{label:"Pro"})})]},e)}))})}},80900:(e,t,r)=>{r.d(t,{Ad:()=>F,BM:()=>x,Ee:()=>N,Iq:()=>k,Nj:()=>v,YP:()=>S,ZV:()=>_,cA:()=>O,cf:()=>D,fU:()=>w,fs:()=>b,gs:()=>g,ii:()=>M,oI:()=>y,qQ:()=>A,vd:()=>j});var n=r(38443),a=r(31127),i=r(66212),s=r(92998),o=r(20543),l=r(2118),c=r(19312),u=r(17054),d=r(49317),f=r(53039),m=r(72346),p=r(81810),h=r(27723),g=function(e,t){if(void 0===t&&(t=new Date),"number"==typeof e&&(e=new Date(1e3*e)),!(e instanceof Date))return"-";var r={year:31536e6,month:2628e6,day:864e5,hour:36e5,minute:6e4,second:1e3},n=new Intl.RelativeTimeFormat("en",{numeric:"auto"}),a=e-t;for(var i in r)if(Math.abs(a)>r[i]||"second"===i)return n.format(Math.round(a/r[i]),i)},v=function(e,t,r){void 0===r&&(r=!0);var n=(e=Number(e))/(t=Number(t));return isNaN(n)&&(n=0),r?new Intl.NumberFormat(void 0,{style:"percent",maximumFractionDigits:1}).format(n):n};function b(e,t){var r={},n=((e=Number(e))-(t=Number(t)))/t;return isNaN(n)&&(n=0),r.val=new Intl.NumberFormat(void 0,{style:"percent",maximumFractionDigits:1,signDisplay:"exceptZero"}).format(n),r.status=0<n?"positive":"negative",n===1/0&&(r.val="",r.status="positive"),r}function y(e,t){var r={},n=((e=Number(e))-(t=Number(t)))/100;return isNaN(n)&&(n=0),r.val=new Intl.NumberFormat(void 0,{style:"percent",maximumFractionDigits:1,signDisplay:"exceptZero"}).format(n),r.status=0<n?"positive":"negative",n===1/0&&(r.val="",r.status="positive"),r}var x=function(e){return(0,n.dateI18n)(burst_settings.date_format,new Date(1e3*e))},j=function(e){return e&&("number"==typeof e||Date.parse(e)>=16409952e5)};function w(e){void 0===e&&(e=0);var t=Number(e);isNaN(t)&&(t=0);var r=Math.floor(t/1e3),n=Math.floor(r/3600),a=Math.floor((r-3600*n)/60),i=r-3600*n-60*a,s=function(e){return isNaN(e)?"00":String(e).padStart(2,"0")};return 0===n?[a,i].map(s).join(":"):[n,a,i].map(s).join(":")}function _(e,t){return void 0===t&&(t=1),e=Number(e),isNaN(e)&&(e=0),e<1e3&&(t=0),new Intl.NumberFormat(void 0,{style:"decimal",notation:"compact",compactDisplay:"short",maximumFractionDigits:t}).format(e)}function N(e,t){return void 0===t&&(t=1),e=Number(e),isNaN(e)&&(e=0),0===e?"0%":e>0&&e<.1?"<0.1%":new Intl.NumberFormat(void 0,{style:"percent",maximumFractionDigits:t}).format(e/100)}function A(e){return e?burst_settings.countries[e.toUpperCase()]||(0,h.__)("Not set","burst-statistics"):(0,h.__)("Unknown","burst-statistics")}function k(e){return e?burst_settings.continents[e.toUpperCase()]||(0,h.__)("Not set","burst-statistics"):(0,h.__)("Unknown","burst-statistics")}function M(e){void 0===e&&(e=new Date);var t=-60*e.getTimezoneOffset(),r=Math.floor(e.getTime()/1e3)+3600*burst_settings.gmt_offset-t;return new Date(1e3*r)}var C=M(),O={today:{label:(0,h.__)("Today","burst-statistics"),range:function(){return{startDate:(0,a.default)(C),endDate:(0,i.default)(C)}}},yesterday:{label:(0,h.__)("Yesterday","burst-statistics"),range:function(){return{startDate:(0,a.default)((0,s.default)(C,-1)),endDate:(0,i.default)((0,s.default)(C,-1))}}},"last-7-days":{label:(0,h.__)("Last 7 days","burst-statistics"),range:function(){return{startDate:(0,a.default)((0,s.default)(C,-7)),endDate:(0,i.default)((0,s.default)(C,-1))}}},"last-30-days":{label:(0,h.__)("Last 30 days","burst-statistics"),range:function(){return{startDate:(0,a.default)((0,s.default)(C,-30)),endDate:(0,i.default)((0,s.default)(C,-1))}}},"last-90-days":{label:(0,h.__)("Last 90 days","burst-statistics"),range:function(){return{startDate:(0,a.default)((0,s.default)(C,-90)),endDate:(0,i.default)((0,s.default)(C,-1))}}},"last-month":{label:(0,h.__)("Last month","burst-statistics"),range:function(){return{startDate:(0,o.default)((0,l.default)(C,-1)),endDate:(0,c.default)((0,l.default)(C,-1))}}},"week-to-date":{label:(0,h.__)("Week to date","burst-statistics"),range:function(){return{startDate:(0,a.default)((0,s.default)(C,-C.getDay())),endDate:(0,i.default)(C)}}},"month-to-date":{label:(0,h.__)("Month to date","burst-statistics"),range:function(){return{startDate:(0,o.default)(C),endDate:(0,i.default)(C)}}},"year-to-date":{label:(0,h.__)("Year to date","burst-statistics"),range:function(){return{startDate:(0,u.A)(C),endDate:(0,i.default)(C)}}},"last-year":{label:(0,h.__)("Last year","burst-statistics"),range:function(){return{startDate:(0,u.A)((0,d.default)(C,-1)),endDate:(0,f.A)((0,d.default)(C,-1))}}}},D=function(e){return Object.values(e).filter(Boolean).map((function(e){var t=O[e];return t.isSelected=T,t}))},S=function(e,t){var r="MMMM d, yyyy";return{startDate:e?(0,m.default)(new Date(e),r):"",endDate:t?(0,m.default)(new Date(t),r):""}};function T(e){var t=this.range();return(0,p.default)(e.startDate,t.startDate)&&(0,p.default)(e.endDate,t.endDate)}function F(e,t){if(void 0===t&&(t={}),!e||!t[e])return function(e){return _(e)};var r=t[e],n=r.isPercentage,a=r.isTime,i=r.precision,s=r.suffix;return function(e){if(null==e)return"";if(n)return N(e,i);if(a)return w(e);var t=_(e,i);return s&&(t+=s),t}}},83101:(e,t,r)=>{r.d(t,{A:()=>h,l:()=>p});var n=r(97665),a=r(48069),i=r(57097),s=r(86275),o=r(55446),l=r(27723),c=r(1932),u=r(76870),d=function(){return d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},d.apply(this,arguments)},f=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))},m=function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},p=function(e){return e.map((function(t){var r=d({},t);if(t.react_conditions){var n=function(e,t){return!e||0===Object.keys(e).length||Object.entries(e).some((function(e){var r=e[0],n=e[1],a=t.find((function(e){return e.id===r}));if(!a)return!1;var i=a.value;return!!i&&n.includes(i)}))}(t.react_conditions,e);"disable"===t.condition_action?r.disabled=!n:r.conditionallyDisabled=!n}return r}))};const h=function(){var e,t,r,p=(0,n.jE)(),h=(0,a.I)({queryKey:["goals_data"],queryFn:function(){return f(void 0,void 0,void 0,(function(){var e;return m(this,(function(t){switch(t.label){case 0:return[4,(0,s.DX)()];case 1:return[2,{goals:(e=t.sent()).goals||[],predefinedGoals:e.predefinedGoals||[],goalFields:Object.values(e.goalFields||{})}]}}))}))},retry:1}),g=(0,i.n)({mutationFn:function(){return f(void 0,void 0,void 0,(function(){var e,t;return m(this,(function(r){switch(r.label){case 0:return e=(null===(t=p.getQueryData(["goals_data"]))||void 0===t?void 0:t.goals)||[],[4,(0,s.d2)({goals:e})];case 1:return[2,r.sent()]}}))}))},onSuccess:function(){},onError:function(e){console.error(e),o.toast.error((0,l.__)("Failed to save goals","burst-statistics"))}}),v=(0,i.n)({mutationFn:function(e){return f(void 0,[e],void 0,(function(e){var t,r=e.id,n=e.value;return m(this,(function(e){switch(e.label){case 0:return t=[{id:r,title:n}],[4,(0,s.d2)({goals:t})];case 1:return[2,e.sent()]}}))}))},onError:function(e){console.error(e),o.toast.error((0,l.__)("Failed to save goal title","burst-statistics"))}}),b=(0,i.n)({mutationFn:function(){return f(void 0,void 0,void 0,(function(){return m(this,(function(e){switch(e.label){case 0:return[4,(0,s.D)()];case 1:return[2,e.sent()]}}))}))},onSuccess:function(e){p.setQueryData(["goals_data"],(function(t){return t?(0,c.jM)(t,(function(t){t.goals.push(e.goal)})):t})),o.toast.success((0,l.__)("Goal added successfully!","burst-statistics"))},onError:function(e){console.error(e),o.toast.error((0,l.__)("Failed to add goal","burst-statistics"))}}),y=(0,i.n)({mutationFn:function(e){return f(void 0,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return[4,(0,s.$x)(e)];case 1:return[2,t.sent()]}}))}))},onSuccess:function(e,t){e.deleted&&(p.setQueryData(["goals_data"],(function(e){return e?(0,c.jM)(e,(function(e){if(1===e.goals.length)e.goals=[];else{var r=e.goals.findIndex((function(e){return e.id===t}));-1!==r&&e.goals.splice(r,1)}})):e})),o.toast.success((0,l.__)("Goal deleted successfully!","burst-statistics")))},onError:function(e){console.error(e),o.toast.error((0,l.__)("Failed to delete goal","burst-statistics"))}}),x=(0,i.n)({mutationFn:function(e){return f(void 0,[e],void 0,(function(e){var t=e.predefinedGoalId,r=e.type,n=e.cookieless;return m(this,(function(e){switch(e.label){case 0:if("hook"===r&&n)throw new Error((0,l.__)("Cannot add server side goals in combination with cookieless tracking","burst-statistics"));if(!u.A.getState().isPro)throw new Error((0,l.__)("Predefined goals are a premium feature.","burst-statistics"));return[4,(0,s.ZI)(t)];case 1:return[2,e.sent()]}}))}))},onSuccess:function(e){p.setQueryData(["goals_data"],(function(t){return t?(0,c.jM)(t,(function(t){t.goals.push(e.goal)})):t})),o.toast.success((0,l.__)("Successfully added predefined goal!","burst-statistics"))},onError:function(e){console.error(e),o.toast.error(e.message||(0,l.__)("Failed to add predefined goal","burst-statistics"))}});return{goals:(null===(e=h.data)||void 0===e?void 0:e.goals)||[],goalFields:(null===(t=h.data)||void 0===t?void 0:t.goalFields)||[],predefinedGoals:(null===(r=h.data)||void 0===r?void 0:r.predefinedGoals)||[],isLoading:h.isLoading,isError:h.isError,getGoal:function(e){var t,r=(null===(t=h.data)||void 0===t?void 0:t.goals)||[];if(!Array.isArray(r))return!1;var n=r.findIndex((function(t){return t.id==e}));return-1!==n&&r[n]},setGoalValue:function(e,t,r){p.setQueryData(["goals_data"],(function(n){return n?(0,c.jM)(n,(function(n){var a=n.goals.findIndex((function(t){return t.id===e}));-1!==a&&(n.goals[a][t]=r)})):n}))},updateGoal:function(e,t){p.setQueryData(["goals_data"],(function(r){return r?(0,c.jM)(r,(function(r){var n=r.goals.findIndex((function(t){return t.id===e}));-1!==n&&(r.goals[n]=d(d({},r.goals[n]),t))})):r}))},saveGoals:g.mutateAsync,saveGoalTitle:function(e,t){return v.mutateAsync({id:e,value:t})},addGoal:b.mutateAsync,deleteGoal:y.mutateAsync,addPredefinedGoal:function(e,t,r){return x.mutateAsync({predefinedGoalId:e,type:t,cookieless:r})},invalidateGoals:function(){return p.invalidateQueries(["goals_data"])}}}},86275:(e,t,r)=>{r.d(t,{$x:()=>N,D:()=>A,DX:()=>_,Eo:()=>M,Ey:()=>j,K5:()=>O,ZI:()=>k,bQ:()=>C,d2:()=>w,nd:()=>D,qN:()=>y,ww:()=>x});var n=r(74848),a=r(1455),i=r.n(a),s=r(27723),o=r(55446),l=function(){return l=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},l.apply(this,arguments)},c=function(e,t,r,n){return new(r||(r=Promise))((function(a,i){function s(e){try{l(n.next(e))}catch(e){i(e)}}function o(e){try{l(n.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(s,o)}l((n=n.apply(e,t||[])).next())}))},u=function(e,t){var r,n,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},s=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return s.next=o(0),s.throw=o(1),s.return=o(2),"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(l){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(i=0)),i;)try{if(r=1,n&&(a=2&o[0]?n.return:o[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,o[1])).done)return a;switch(n=0,a&&(o=[2&o[0],a.value]),o[0]){case 0:case 1:a=o;break;case 4:return i.label++,{value:o[1],done:!1};case 5:i.label++,n=o[1],o=[0];continue;case 7:o=i.ops.pop(),i.trys.pop();continue;default:if(!((a=(a=i.trys).length>0&&a[a.length-1])||6!==o[0]&&2!==o[0])){i=0;continue}if(3===o[0]&&(!a||o[1]>a[0]&&o[1]<a[3])){i.label=o[1];break}if(6===o[0]&&i.label<a[1]){i.label=a[1],a=o;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(o);break}a[2]&&i.ops.pop(),i.trys.pop();continue}o=t.call(e,i)}catch(e){o=[6,e],n=0}finally{r=a=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}},d=function(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))},f=function(){return-1!==burst_settings.site_url.indexOf("?")?"&":"?"},m=function(){return"nonce="+burst_settings.burst_nonce+"&token="+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)},p=function(e,t){void 0===t&&(t=!1);var r=(0,s.__)("Server error","burst-statistics");if(e=e.replace(/(<([^>]+)>)/gi,""),t){var a=t.split("?")[0].split("/"),i=a.indexOf("v1")+1;r=(0,s.__)("Server error in","burst-statistics")+" "+a[i]+"/"+a[i+1]}r+=": "+e;var l=(0,n.jsx)("div",{title:(0,s.__)("Click to copy","burst-statistics"),onClick:function(){navigator.clipboard.writeText(r),o.toast.success((0,s.__)("Error copied to clipboard","burst-statistics"))},children:r});o.toast.error(l,{autoClose:15e3})},h=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return c(void 0,d([e],t,!0),void 0,(function(e,t,r){var n;return void 0===t&&(t="GET"),void 0===r&&(r={}),u(this,(function(a){return n={path:e,method:t},"POST"===t&&(r.nonce=burst_settings.burst_nonce,n.data=r),[2,i()(n).then((function(e){if(!e.request_success)throw e.hasOwnProperty("message")?new Error(e.message):new Error("Received unexpected response from server. Please check if the Rest API is enabled.");if(e.code&&200!==e.code)throw new Error(e.message);return delete e.request_success,e})).catch((function(a){return g(t,e,r).catch((function(){throw p(a.message,n.path),a}))}))]}))}))},g=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return c(void 0,d([e,t],r,!0),void 0,(function(e,t,r){var n,a,i,s;return void 0===r&&(r=null),u(this,(function(o){switch(o.label){case 0:n="GET"===e?"".concat(b("ajax"),"&rest_action=").concat(t.replace("?","&")):b("ajax"),a={method:e,headers:{"Content-Type":"application/json; charset=UTF-8"}},"POST"===e&&(a.body=JSON.stringify({path:t,data:r},v)),o.label=1;case 1:return o.trys.push([1,4,,5]),[4,fetch(n,a)];case 2:if(!(i=o.sent()).ok)throw p(!1,i.statusText),new Error(i.statusText);return[4,i.json()];case 3:if(!(s=o.sent()).data||!Object.prototype.hasOwnProperty.call(s.data,"request_success"))throw new Error("Invalid data error");return delete s.data.request_success,[2,Promise.resolve(s.data)];case 4:return o.sent(),[2,Promise.reject(new Error("AJAX request failed"))];case 5:return[2]}}))}))},v=function(e,t){return e?e&&e.includes("Control")?void 0:"object"==typeof t?JSON.parse(JSON.stringify(t,v)):t:t},b=function(e){var t;return t=void 0===e?burst_settings.site_url:burst_settings.admin_ajax_url,"https:"===window.location.protocol&&-1===t.indexOf("https://")?t.replace("http://","https://"):t},y=function(e,t){return h("burst/v1/options/set"+f()+m(),"POST",{option:{option:e,value:t}})},x=function(){return h("burst/v1/fields/get"+f()+m())},j=function(e){return h("burst/v1/fields/set"+f(),"POST",{fields:e})},w=function(e){return h("burst/v1/goals/set"+f()+m(),"POST",e)},_=function(){return h("burst/v1/goals/get"+f()+m())},N=function(e){return h("burst/v1/goals/delete"+f()+m(),"POST",{id:e})},A=function(){return h("burst/v1/goals/add"+f()+m(),"POST",{})},k=function(e){return h("burst/v1/goals/add_predefined"+f()+m(),"POST",{id:e})},M=function(e,t){return void 0===t&&(t={}),h("burst/v1/do_action/".concat(e),"POST",{action_data:t}).then((function(e){return Object.prototype.hasOwnProperty.call(e,"data")?e.data:[]}))},C=function(e,t,r,n){for(var a=[],i=4;i<arguments.length;i++)a[i-4]=arguments[i];return c(void 0,d([e,t,r,n],a,!0),void 0,(function(e,t,r,n,a){var i,s,o,c,d,m,p;return void 0===a&&(a={}),u(this,(function(u){switch(u.label){case 0:return i=a.filters,s=a.metrics,o=a.group_by,c=a.currentView,d=l(l(l(l({date_start:t,date_end:r,date_range:n,nonce:burst_settings.burst_nonce,goal_id:a.goal_id,token:Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,5)},i&&{filters:i}),s&&{metrics:s}),o&&{group_by:o}),c&&{currentView:c}),g=d,m=Object.keys(g).filter((function(e){return void 0!==g[e]&&null!==g[e]})).map((function(e){var t=function(e){return Array.isArray(e)?e:"object"==typeof e&&null!==e?JSON.stringify(e):e}(g[e]);return Array.isArray(t)?t.map((function(t){return"".concat(encodeURIComponent(e),"[]=").concat(encodeURIComponent(t))})).join("&"):"".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t))})).join("&"),p="burst/v1/data/".concat(e).concat(f()).concat(m),[4,h(p,"GET")];case 1:return[2,u.sent()]}var g}))}))},O=function(e){return h("burst/v1/posts/".concat(f()).concat(m(),"&search=").concat(e)).then((function(e){return Object.prototype.hasOwnProperty.call(e,"posts")?e.posts:[]}))},D=function(e){return c(void 0,void 0,void 0,(function(){var t,r;return u(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),[4,fetch(e)];case 1:if(!(t=n.sent()).ok)throw new Error("HTTP error! Status: ".concat(t.status));return[4,t.json()];case 2:return[2,n.sent()];case 3:throw r=n.sent(),console.error("Error fetching JSON data:",r),r;case 4:return[2]}}))}))}},96744:(e,t,r)=>{r.d(t,{q:()=>s});var n=r(74848),a=r(51609),i=r(34164),s=(0,a.memo)((function(e){var t=e.title,r=e.controls,a=e.className,s=void 0===a?"":a;return(0,n.jsxs)("div",{className:(0,i.A)(s,"flex min-h-16 items-center justify-between px-6 gap-4"),children:[(0,n.jsx)("h2",{className:"text-lg font-semibold",children:t}),r]})}));s.displayName="BlockHeading"}}]);