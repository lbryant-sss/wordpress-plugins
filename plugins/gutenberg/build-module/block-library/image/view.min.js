import{store as B,getContext as b,getElement as x,withSyncEvent as S}from"@wordpress/interactivity";var w=!1,W=0,{state:e,actions:O,callbacks:$}=B("core/image",{state:{currentImageId:null,get currentImage(){return e.metadata[e.currentImageId]},get overlayOpened(){return e.currentImageId!==null},get roleAttribute(){return e.overlayOpened?"dialog":null},get ariaModal(){return e.overlayOpened?"true":null},get enlargedSrc(){return e.currentImage.uploadedSrc||"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},get figureStyles(){return e.overlayOpened&&`${e.currentImage.figureStyles?.replace(/margin[^;]*;?/g,"")};`},get imgStyles(){return e.overlayOpened&&`${e.currentImage.imgStyles?.replace(/;$/,"")}; object-fit:cover;`},get imageButtonRight(){let{imageId:t}=b();return e.metadata[t].imageButtonRight},get imageButtonTop(){let{imageId:t}=b();return e.metadata[t].imageButtonTop},get isContentHidden(){let t=b();return e.overlayEnabled&&e.currentImageId===t.imageId},get isContentVisible(){let t=b();return!e.overlayEnabled&&e.currentImageId===t.imageId}},actions:{showLightbox(){let{imageId:t}=b();e.metadata[t].imageRef?.complete&&(e.scrollTopReset=document.documentElement.scrollTop,e.scrollLeftReset=document.documentElement.scrollLeft,e.overlayEnabled=!0,e.currentImageId=t,$.setOverlayStyles())},hideLightbox(){e.overlayEnabled&&(e.overlayEnabled=!1,setTimeout(function(){e.currentImage.buttonRef.focus({preventScroll:!0}),e.currentImageId=null},450))},handleKeydown:S(t=>{if(e.overlayEnabled){if(t.key==="Tab"){t.preventDefault();let{ref:r}=x();r.querySelector("button").focus()}t.key==="Escape"&&O.hideLightbox()}}),handleTouchMove:S(t=>{e.overlayEnabled&&t.preventDefault()}),handleTouchStart(){w=!0},handleTouchEnd(){W=Date.now(),w=!1},handleScroll(){e.overlayOpened&&!w&&Date.now()-W>450&&window.scrollTo(e.scrollLeftReset,e.scrollTopReset)}},callbacks:{setOverlayStyles(){if(!e.overlayEnabled)return;let{naturalWidth:t,naturalHeight:r,offsetWidth:g,offsetHeight:s}=e.currentImage.imageRef,{x:f,y:p}=e.currentImage.imageRef.getBoundingClientRect(),l=t/r,d=g/s;if(e.currentImage.scaleAttr==="contain")if(l>d){let c=g/l;p+=(s-c)/2,s=c}else{let c=s*l;f+=(g-c)/2,g=c}d=g/s;let n=parseFloat(e.currentImage.targetWidth!=="none"?e.currentImage.targetWidth:t),i=parseFloat(e.currentImage.targetHeight!=="none"?e.currentImage.targetHeight:r),u=n/i,h=n,m=i,o=n,a=i;if(l.toFixed(2)!==u.toFixed(2)){if(l>u){let c=n/l;i-c>n?(i=c,n=c*l):i=n/l}else{let c=i*l;n-c>i?(n=c,i=c/l):n=i*l}o=n,a=i,u=n/i,d>u?(h=n,m=h/d):(m=i,h=m*d)}(g>o||s>a)&&(o=g,a=s);let y=0;window.innerWidth>480?y=80:window.innerWidth>1920&&(y=160);let I=80,v=Math.min(window.innerWidth-y,o),R=Math.min(window.innerHeight-I,a),A=v/R;d>A?(o=v,a=o/d):(a=R,o=a*d);let E=g/o,H=n*(o/h),T=i*(a/m);e.overlayStyles=`
					--wp--lightbox-initial-top-position: ${p}px;
					--wp--lightbox-initial-left-position: ${f}px;
					--wp--lightbox-container-width: ${o+1}px;
					--wp--lightbox-container-height: ${a+1}px;
					--wp--lightbox-image-width: ${H}px;
					--wp--lightbox-image-height: ${T}px;
					--wp--lightbox-scale: ${E};
					--wp--lightbox-scrollbar-width: ${window.innerWidth-document.documentElement.clientWidth}px;
				`},setButtonStyles(){let{imageId:t}=b(),{ref:r}=x();e.metadata[t].imageRef=r,e.metadata[t].currentSrc=r.currentSrc;let{naturalWidth:g,naturalHeight:s,offsetWidth:f,offsetHeight:p}=r;if(g===0||s===0)return;let l=r.parentElement,d=r.parentElement.clientWidth,n=r.parentElement.clientHeight,i=l.querySelector("figcaption");if(i){let a=window.getComputedStyle(i);["absolute","fixed"].includes(a.position)||(n=n-i.offsetHeight-parseFloat(a.marginTop)-parseFloat(a.marginBottom))}let u=n-p,h=d-f,m=u+16,o=h+16;if(e.metadata[t].scaleAttr==="contain"){let a=g/s,y=f/p;if(a>=y){let I=f/a;m=(p-I)/2+u+16,o=h+16}else{let I=p*a;m=u+16,o=(f-I)/2+h+16}}e.metadata[t].imageButtonTop=m,e.metadata[t].imageButtonRight=o},setOverlayFocus(){if(e.overlayEnabled){let{ref:t}=x();t.focus()}},initTriggerButton(){let{imageId:t}=b(),{ref:r}=x();e.metadata[t].buttonRef=r}}},{lock:!0});
//# sourceMappingURL=view.min.js.map
