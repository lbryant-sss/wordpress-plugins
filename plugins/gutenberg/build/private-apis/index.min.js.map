{
  "version": 3,
  "sources": ["../../packages/private-apis/src/index.ts", "../../packages/private-apis/src/implementation.ts"],
  "sourcesContent": ["export { __dangerousOptInToUnstableAPIsOnlyForCoreModules } from './implementation';\n", "/**\n * wordpress/private-apis \u2013 the utilities to enable private cross-package\n * exports of private APIs.\n *\n * This \"implementation.ts\" file is needed for the sake of the unit tests. It\n * exports more than the public API of the package to aid in testing.\n */\n\n/**\n * The list of core modules allowed to opt-in to the private APIs.\n */\nconst CORE_MODULES_USING_PRIVATE_APIS = [\n\t'@wordpress/block-directory',\n\t'@wordpress/block-editor',\n\t'@wordpress/block-library',\n\t'@wordpress/blocks',\n\t'@wordpress/commands',\n\t'@wordpress/components',\n\t'@wordpress/core-commands',\n\t'@wordpress/core-data',\n\t'@wordpress/customize-widgets',\n\t'@wordpress/data',\n\t'@wordpress/edit-post',\n\t'@wordpress/edit-site',\n\t'@wordpress/edit-widgets',\n\t'@wordpress/editor',\n\t'@wordpress/format-library',\n\t'@wordpress/patterns',\n\t'@wordpress/preferences',\n\t'@wordpress/reusable-blocks',\n\t'@wordpress/router',\n\t'@wordpress/sync',\n\t'@wordpress/dataviews',\n\t'@wordpress/fields',\n\t'@wordpress/media-utils',\n\t'@wordpress/upload-media',\n];\n\n/**\n * A list of core modules that already opted-in to\n * the privateApis package.\n */\nconst registeredPrivateApis: Array< string > = [];\n\n/*\n * Warning for theme and plugin developers.\n *\n * The use of private developer APIs is intended for use by WordPress Core\n * and the Gutenberg plugin exclusively.\n *\n * Dangerously opting in to using these APIs is NOT RECOMMENDED. Furthermore,\n * the WordPress Core philosophy to strive to maintain backward compatibility\n * for third-party developers DOES NOT APPLY to private APIs.\n *\n * THE CONSENT STRING FOR OPTING IN TO THESE APIS MAY CHANGE AT ANY TIME AND\n * WITHOUT NOTICE. THIS CHANGE WILL BREAK EXISTING THIRD-PARTY CODE. SUCH A\n * CHANGE MAY OCCUR IN EITHER A MAJOR OR MINOR RELEASE.\n */\nconst requiredConsent =\n\t'I acknowledge private features are not for use in themes or plugins and doing so will break in the next version of WordPress.';\n\n// The safety measure is meant for WordPress core where IS_WORDPRESS_CORE is set to true.\nconst allowReRegistration = globalThis.IS_WORDPRESS_CORE ? false : true;\n\n/**\n * Called by a @wordpress package wishing to opt-in to accessing or exposing\n * private private APIs.\n *\n * @param consent    The consent string.\n * @param moduleName The name of the module that is opting in.\n * @return An object containing the lock and unlock functions.\n */\nexport const __dangerousOptInToUnstableAPIsOnlyForCoreModules = (\n\tconsent: string,\n\tmoduleName: string\n) => {\n\tif ( ! CORE_MODULES_USING_PRIVATE_APIS.includes( moduleName ) ) {\n\t\tthrow new Error(\n\t\t\t`You tried to opt-in to unstable APIs as module \"${ moduleName }\". ` +\n\t\t\t\t'This feature is only for JavaScript modules shipped with WordPress core. ' +\n\t\t\t\t'Please do not use it in plugins and themes as the unstable APIs will be removed ' +\n\t\t\t\t'without a warning. If you ignore this error and depend on unstable features, ' +\n\t\t\t\t'your product will inevitably break on one of the next WordPress releases.'\n\t\t);\n\t}\n\tif (\n\t\t! allowReRegistration &&\n\t\tregisteredPrivateApis.includes( moduleName )\n\t) {\n\t\t// This check doesn't play well with Story Books / Hot Module Reloading\n\t\t// and isn't included in the Gutenberg plugin. It only matters in the\n\t\t// WordPress core release.\n\t\tthrow new Error(\n\t\t\t`You tried to opt-in to unstable APIs as module \"${ moduleName }\" which is already registered. ` +\n\t\t\t\t'This feature is only for JavaScript modules shipped with WordPress core. ' +\n\t\t\t\t'Please do not use it in plugins and themes as the unstable APIs will be removed ' +\n\t\t\t\t'without a warning. If you ignore this error and depend on unstable features, ' +\n\t\t\t\t'your product will inevitably break on one of the next WordPress releases.'\n\t\t);\n\t}\n\tif ( consent !== requiredConsent ) {\n\t\tthrow new Error(\n\t\t\t`You tried to opt-in to unstable APIs without confirming you know the consequences. ` +\n\t\t\t\t'This feature is only for JavaScript modules shipped with WordPress core. ' +\n\t\t\t\t'Please do not use it in plugins and themes as the unstable APIs will removed ' +\n\t\t\t\t'without a warning. If you ignore this error and depend on unstable features, ' +\n\t\t\t\t'your product will inevitably break on the next WordPress release.'\n\t\t);\n\t}\n\tregisteredPrivateApis.push( moduleName );\n\n\treturn {\n\t\tlock,\n\t\tunlock,\n\t};\n};\n\n/**\n * Binds private data to an object.\n * It does not alter the passed object in any way, only\n * registers it in an internal map of private data.\n *\n * The private data can't be accessed by any other means\n * than the `unlock` function.\n *\n * @example\n * ```js\n * const object = {};\n * const privateData = { a: 1 };\n * lock( object, privateData );\n *\n * object\n * // {}\n *\n * unlock( object );\n * // { a: 1 }\n * ```\n *\n * @param object      The object to bind the private data to.\n * @param privateData The private data to bind to the object.\n */\nfunction lock( object: unknown, privateData: unknown ) {\n\tif ( ! object ) {\n\t\tthrow new Error( 'Cannot lock an undefined object.' );\n\t}\n\tconst _object = object as Record< symbol, WeakKey >;\n\n\tif ( ! ( __private in _object ) ) {\n\t\t_object[ __private ] = {};\n\t}\n\tlockedData.set( _object[ __private ], privateData );\n}\n\n/**\n * Unlocks the private data bound to an object.\n *\n * It does not alter the passed object in any way, only\n * returns the private data paired with it using the `lock()`\n * function.\n *\n * @example\n * ```js\n * const object = {};\n * const privateData = { a: 1 };\n * lock( object, privateData );\n *\n * object\n * // {}\n *\n * unlock( object );\n * // { a: 1 }\n * ```\n *\n * @param object The object to unlock the private data from.\n * @return The private data bound to the object.\n */\nfunction unlock< T = any >( object: unknown ): T {\n\tif ( ! object ) {\n\t\tthrow new Error( 'Cannot unlock an undefined object.' );\n\t}\n\tconst _object = object as Record< symbol, WeakKey >;\n\n\tif ( ! ( __private in _object ) ) {\n\t\tthrow new Error(\n\t\t\t'Cannot unlock an object that was not locked before. '\n\t\t);\n\t}\n\n\treturn lockedData.get( _object[ __private ] );\n}\n\nconst lockedData = new WeakMap();\n\n/**\n * Used by lock() and unlock() to uniquely identify the private data\n * related to a containing object.\n */\nconst __private = Symbol( 'Private API ID' );\n\n// Unit tests utilities:\n\n/**\n * Private function to allow the unit tests to allow\n * a mock module to access the private APIs.\n *\n * @param name The name of the module.\n */\nexport function allowCoreModule( name: string ) {\n\tCORE_MODULES_USING_PRIVATE_APIS.push( name );\n}\n\n/**\n * Private function to allow the unit tests to set\n * a custom list of allowed modules.\n */\nexport function resetAllowedCoreModules() {\n\twhile ( CORE_MODULES_USING_PRIVATE_APIS.length ) {\n\t\tCORE_MODULES_USING_PRIVATE_APIS.pop();\n\t}\n}\n/**\n * Private function to allow the unit tests to reset\n * the list of registered private apis.\n */\nexport function resetRegisteredPrivateApis() {\n\twhile ( registeredPrivateApis.length ) {\n\t\tregisteredPrivateApis.pop();\n\t}\n}\n"],
  "mappings": "4cAAA,IAAAA,EAAA,GAAAC,EAAAD,EAAA,sDAAAE,ICWA,IAAMC,EAAkC,CACvC,6BACA,0BACA,2BACA,oBACA,sBACA,wBACA,2BACA,uBACA,+BACA,kBACA,uBACA,uBACA,0BACA,oBACA,4BACA,sBACA,yBACA,6BACA,oBACA,kBACA,uBACA,oBACA,yBACA,yBACD,EAMMC,EAAyC,CAAC,EAgB1CC,EACL,gIAaM,IAAMC,EAAmD,CAC/DC,EACAC,IACI,CACJ,GAAK,CAAEC,EAAgC,SAAUD,CAAW,EAC3D,MAAM,IAAI,MACT,mDAAoDA,CAAW,oTAKhE,EAiBD,GAAKD,IAAYG,EAChB,MAAM,IAAI,MACT,yXAKD,EAED,OAAAC,EAAsB,KAAMH,CAAW,EAEhC,CACN,KAAAI,EACA,OAAAC,CACD,CACD,EA0BA,SAASD,EAAME,EAAiBC,EAAuB,CACtD,GAAK,CAAED,EACN,MAAM,IAAI,MAAO,kCAAmC,EAErD,IAAME,EAAUF,EAEPG,KAAaD,IACrBA,EAASC,CAAU,EAAI,CAAC,GAEzBC,EAAW,IAAKF,EAASC,CAAU,EAAGF,CAAY,CACnD,CAyBA,SAASF,EAAmBC,EAAqB,CAChD,GAAK,CAAEA,EACN,MAAM,IAAI,MAAO,oCAAqC,EAEvD,IAAME,EAAUF,EAEhB,GAAK,EAAIG,KAAaD,GACrB,MAAM,IAAI,MACT,sDACD,EAGD,OAAOE,EAAW,IAAKF,EAASC,CAAU,CAAE,CAC7C,CAEA,IAAMC,EAAa,IAAI,QAMjBD,EAAY,OAAQ,gBAAiB",
  "names": ["index_exports", "__export", "__dangerousOptInToUnstableAPIsOnlyForCoreModules", "CORE_MODULES_USING_PRIVATE_APIS", "registeredPrivateApis", "requiredConsent", "__dangerousOptInToUnstableAPIsOnlyForCoreModules", "consent", "moduleName", "CORE_MODULES_USING_PRIVATE_APIS", "requiredConsent", "registeredPrivateApis", "lock", "unlock", "object", "privateData", "_object", "__private", "lockedData"]
}
