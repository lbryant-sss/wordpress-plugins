(()=>{"use strict";var e={20:(e,t,s)=>{var a=s(609),c=Symbol.for("react.element"),o=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,r={key:!0,ref:!0,__self:!0,__source:!0};function m(e,t,s){var a,o={},m=null,l=null;for(a in void 0!==s&&(m=""+s),void 0!==t.key&&(m=""+t.key),void 0!==t.ref&&(l=t.ref),t)n.call(t,a)&&!r.hasOwnProperty(a)&&(o[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===o[a]&&(o[a]=t[a]);return{$$typeof:c,type:e,key:m,ref:l,props:o,_owner:i.current}}t.Fragment=o,t.jsx=m,t.jsxs=m},609:e=>{e.exports=window.React},848:(e,t,s)=>{e.exports=s(20)}},t={};const s=window.wc.wcBlocksRegistry,a=window.wc.wcSettings,c=window.wp.element,o=window.wp.htmlEntities,n="mercadopago_blocks_update_cart";var i=function s(a){var c=t[a];if(void 0!==c)return c.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,s),o.exports}(848);const r=({labelMessage:e,helperInvalid:t,helperEmpty:s,helperWrong:a,inputName:c,hiddenId:o,inputDataCheckout:n,selectId:r,selectName:m,selectDataCheckout:l,flagError:d,documents:p,validate:u})=>(0,i.jsx)("div",{className:"mp-checkout-ticket-input-document",children:(0,i.jsx)("input-document",{"label-message":e,"helper-invalid":t,"helper-empty":s,"helper-wrong":a,"input-name":c,"hidden-id":o,"input-data-checkout":n,"select-id":r,"select-name":m,"select-data-checkout":l,"flag-error":d,documents:p,validate:u})}),m=({isVisible:e,message:t,inputId:s,id:a,dataMain:c})=>(0,i.jsx)("input-helper",{isVisible:e,message:t,"input-id":s,id:a,"data-main":c}),l=({isOptinal:e,message:t,forId:s})=>(0,i.jsx)("input-label",{isOptinal:e,message:t,for:s}),d=({methods:e})=>(0,i.jsx)("payment-methods",{methods:e}),p=({description:e,linkText:t,linkSrc:s,checkoutClass:a="pro"})=>(0,i.jsx)("div",{className:`mp-checkout-${a}-terms-and-conditions`,children:(0,i.jsx)("terms-and-conditions",{description:e,"link-text":t,"link-src":s})}),u=({title:e,description:t,linkText:s,linkSrc:a})=>(0,i.jsx)("div",{className:"mp-test-mode-container",children:(0,i.jsx)("test-mode",{title:e,description:t,"link-text":s,"link-src":a})}),h=(e,t,s)=>{const a={name:e,message:t,target:s,plugin:{version:wc_mercadopago_custom_checkout_params.plugin_version},platform:{name:"woocommerce",uri:window.location.href,version:wc_mercadopago_custom_checkout_params.platform_version,location:`${wc_mercadopago_custom_checkout_params.location}_${wc_mercadopago_custom_checkout_params.theme}`}};navigator.sendBeacon("https://api.mercadopago.com/v1/plugins/melidata/errors",JSON.stringify(a))};var _;const x="mp_checkout_blocks",k="woo-mercado-pago-custom",y=(0,a.getSetting)("woo-mercado-pago-custom_data",{}),v=(0,o.decodeEntities)(y.title)||"Checkout Custom",j=e=>{const{PaymentMethodLabel:t}=e.components,s=(0,o.decodeEntities)(y?.params?.fee_title||""),a=`${v} ${s}`;return(0,i.jsx)(t,{text:a})},g=e=>{(e=>{const{extensionCartUpdate:t}=wc.blocksCheckout,{eventRegistration:s,emitResponse:a}=e,{onPaymentSetup:o}=s;(0,c.useEffect)((()=>{((e,t)=>{e({namespace:n,data:{action:"add",gateway:t}})})(t,k);const e=o((()=>({type:a.responseTypes.SUCCESS})));return()=>(((e,t)=>{e({namespace:n,data:{action:"remove",gateway:t}})})(t,k),e())}),[o])})(e);const{test_mode:t,test_mode_title:s,test_mode_description:a,test_mode_link_text:o,test_mode_link_src:_,wallet_button:v,wallet_button_image:j,wallet_button_title:g,wallet_button_description:f,wallet_button_button_text:b,available_payments_title_icon:w,available_payments_title:N,available_payments_image:S,payment_methods_items:C,payment_methods_promotion_link:E,payment_methods_promotion_text:I,site_id:T,card_form_title:R,card_number_input_label:O,card_number_input_helper:M,card_holder_name_input_label:P,card_holder_name_input_helper:F,card_expiration_input_label:U,card_expiration_input_helper:D,card_security_code_input_label:L,card_security_code_input_helper:B,card_document_input_label:V,card_input_document_helper_invalid:$,card_input_document_helper_empty:A,card_input_document_helper_wrong:q,card_installments_title:Y,card_issuer_input_label:H,card_installments_input_helper:W,terms_and_conditions_description:K,terms_and_conditions_link_text:z,terms_and_conditions_link_src:J,amount:Q,currency_ratio:G,message_error_amount:X}=y.params;if(null==Q)return(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("p",{className:"alert-message",children:X})});const Z=(0,c.useRef)(null),[ee,te]=(0,c.useState)("custom"),{eventRegistration:se,emitResponse:ae,onSubmit:ce}=e,{onPaymentSetup:oe,onCheckoutSuccess:ne,onCheckoutFail:ie}=se;return window.mpFormId="blocks_checkout_form",window.mpCheckoutForm=document.querySelector(".wc-block-components-form.wc-block-checkout__form"),jQuery(window.mpCheckoutForm).prop("id",mpFormId),(0,c.useEffect)((()=>{var t,s;t=e.billing.cartTotal.value,s=e.billing.currency,cardFormMounted&&cardForm.unmount(),initCardForm(function(e,t){if(!Number.isInteger(e)||"object"!=typeof t)throw new Error("Invalid input");const s=(e/Math.pow(10,t.minorUnit)).toFixed(t.minorUnit).split(".");return`${s[0]}.${s[1]}`}(t,s))}),[e.billing.cartTotal.value]),(0,c.useEffect)((()=>{const e=oe((async()=>{const e=document.querySelector("#form-checkout__cardholderName"),t=document.querySelector("#mp-card-holder-name-helper");var s;if(""==e.value&&((s=t)&&s.style&&(s.style.display="flex")),"wallet_button"!==document.querySelector("#mp_checkout_type").value)try{if(!CheckoutPage.validateInputsCreateToken())return{type:ae.responseTypes.ERROR};{const e=await cardForm.createCardToken();document.querySelector("#cardTokenId").value=e.token}}catch(e){console.warn("Token creation error: ",e)}const a=Z.current,c={};return a.childNodes.forEach((e=>{"INPUT"===e.tagName&&e.name&&(c[e.name]=e.value)})),te("custom"),{type:ae.responseTypes.SUCCESS,meta:{paymentMethodData:c}}}));return()=>e()}),[oe,ae.responseTypes.ERROR,ae.responseTypes.SUCCESS]),(0,c.useEffect)((()=>{const e=ne((async e=>{const t=e.processingResponse,s=e.processingResponse.paymentDetails;if(s.three_ds_flow){const e=new Promise(((e,t)=>{window.addEventListener("completed_3ds",(s=>{s.detail.error&&(console.log("rejecting with "+s.detail.error),t(s.detail.error)),e()}))}));return load3DSFlow(s.last_four_digits),await e.then((()=>({type:ae.responseTypes.SUCCESS}))).catch((e=>({type:ae.responseTypes.FAIL,message:e,messageContext:ae.noticeContexts.PAYMENTS})))}return h("MP_CUSTOM_BLOCKS_SUCCESS",t.paymentStatus,x),{type:ae.responseTypes.SUCCESS}}));return()=>e()}),[ne]),(0,c.useEffect)((()=>{const e=ie((e=>{const t=e.processingResponse;return h("MP_CUSTOM_BLOCKS_ERROR",t.paymentStatus,x),{type:ae.responseTypes.FAIL,messageContext:ae.noticeContexts.PAYMENTS,message:t.paymentDetails.message}}));return()=>e()}),[ie]),(0,i.jsxs)("div",{children:[(0,i.jsx)("div",{className:"mp-checkout-custom-load",children:(0,i.jsx)("div",{className:"spinner-card-form"})}),(0,i.jsx)("div",{className:"mp-checkout-container",children:(0,i.jsxs)("div",{className:"mp-checkout-custom-container",children:[t?(0,i.jsx)("div",{className:"mp-test-mode-container",children:(0,i.jsx)(u,{title:s,description:a,linkText:o,linkSrc:_})}):null,"yes"===v?(0,i.jsxs)("div",{className:"mp-wallet-button-container",children:[(0,i.jsx)("img",{src:j}),(0,i.jsx)("div",{className:"mp-wallet-button-title",children:(0,i.jsx)("span",{children:g})}),(0,i.jsx)("div",{className:"mp-wallet-button-description",children:f}),(0,i.jsx)("div",{className:"mp-wallet-button-button",children:(0,i.jsx)("button",{id:"mp-wallet-button",type:"button",onClick:e=>{e.preventDefault(),te("wallet_button"),ce()},children:b})})]}):null,(0,i.jsxs)("div",{id:"mp-custom-checkout-form-container",children:[(0,i.jsxs)("div",{className:"mp-checkout-custom-available-payments",children:[(0,i.jsxs)("div",{className:"mp-checkout-custom-available-payments-header",onClick:()=>{const e=document.getElementsByClassName("mp-checkout-custom-available-payments")[0],t=e.getElementsByClassName("mp-checkout-custom-available-payments-header")[0].getElementsByClassName("mp-checkout-custom-available-payments-collapsible")[0],s=e.getElementsByClassName("mp-checkout-custom-available-payments-content")[0];if(s.style.maxHeight)t.src=y.params.available_payments_chevron_down,s.style.maxHeight=null,s.style.padding="0px";else{let e=s.scrollHeight+15+"px";t.src=y.params.available_payments_chevron_up,s.style.setProperty("max-height",e,"important"),s.style.setProperty("padding","24px 0px 0px","important")}},children:[(0,i.jsxs)("div",{className:"mp-checkout-custom-available-payments-title",children:[(0,i.jsx)("img",{src:w,className:"mp-icon"}),(0,i.jsx)("p",{className:"mp-checkout-custom-available-payments-text",children:N})]}),(0,i.jsx)("img",{src:S,className:"mp-checkout-custom-available-payments-collapsible"})]}),(0,i.jsxs)("div",{className:"mp-checkout-custom-available-payments-content",children:[(0,i.jsx)(d,{methods:C}),"MLA"===T?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{id:"mp_promotion_link",children:" | "}),(0,i.jsx)("a",{href:E,id:"mp_checkout_link",className:"mp-checkout-link mp-pl-10",target:"_blank",children:I})]}):null,(0,i.jsx)("hr",{})]})]}),(0,i.jsxs)("div",{className:"mp-checkout-custom-card-form",children:[(0,i.jsx)("p",{className:"mp-checkout-custom-card-form-title",children:R}),(0,i.jsxs)("div",{className:"mp-checkout-custom-card-row",children:[(0,i.jsx)(l,{isOptinal:!1,message:O,forId:"mp-card-number"}),(0,i.jsx)("div",{className:"mp-checkout-custom-card-input",id:"form-checkout__cardNumber-container"}),(0,i.jsx)(m,{isVisible:!1,message:M,inputId:"mp-card-number-helper"})]}),(0,i.jsxs)("div",{className:"mp-checkout-custom-card-row",id:"mp-card-holder-div",children:[(0,i.jsx)(l,{message:P,isOptinal:!1}),(0,i.jsx)("input",{className:"mp-checkout-custom-card-input mp-card-holder-name",placeholder:"Ex.: María López",id:"form-checkout__cardholderName",name:"mp-card-holder-name","data-checkout":"cardholderName"}),(0,i.jsx)(m,{isVisible:!1,message:F,inputId:"mp-card-holder-name-helper",dataMain:"mp-card-holder-name"})]}),(0,i.jsxs)("div",{className:"mp-checkout-custom-card-row mp-checkout-custom-dual-column-row",children:[(0,i.jsxs)("div",{className:"mp-checkout-custom-card-column",children:[(0,i.jsx)(l,{message:U,isOptinal:!1}),(0,i.jsx)("div",{id:"form-checkout__expirationDate-container",className:"mp-checkout-custom-card-input mp-checkout-custom-left-card-input"}),(0,i.jsx)(m,{isVisible:!1,message:D,inputId:"mp-expiration-date-helper"})]}),(0,i.jsxs)("div",{className:"mp-checkout-custom-card-column",children:[(0,i.jsx)(l,{message:L,isOptinal:!1}),(0,i.jsx)("div",{id:"form-checkout__securityCode-container",className:"mp-checkout-custom-card-input"}),(0,i.jsx)("p",{id:"mp-security-code-info",className:"mp-checkout-custom-info-text"}),(0,i.jsx)(m,{isVisible:!1,message:B,inputId:"mp-security-code-helper"})]})]}),(0,i.jsx)("div",{id:"mp-doc-div",className:"mp-checkout-custom-input-document",style:{display:"none"},children:(0,i.jsx)(r,{labelMessage:V,helperInvalid:$,helperEmpty:A,helperWrong:q,inputName:"identificationNumber",hiddenId:"form-checkout__identificationNumber",inputDataCheckout:"docNumber",selectId:"form-checkout__identificationType",selectName:"identificationType",selectDataCheckout:"docType",flagError:"docNumberError"})})]}),(0,i.jsxs)("div",{id:"mp-checkout-custom-installments",className:"mp-checkout-custom-installments-display-none",children:[(0,i.jsx)("p",{className:"mp-checkout-custom-card-form-title",children:Y}),(0,i.jsxs)("div",{id:"mp-checkout-custom-issuers-container",className:"mp-checkout-custom-issuers-container",children:[(0,i.jsx)("div",{className:"mp-checkout-custom-card-row",children:(0,i.jsx)(l,{isOptinal:!1,message:H,forId:"mp-issuer"})}),(0,i.jsx)("div",{className:"mp-input-select-input",children:(0,i.jsx)("select",{name:"issuer",id:"form-checkout__issuer",className:"mp-input-select-select"})})]}),(0,i.jsx)("div",{id:"mp-checkout-custom-installments-container",className:"mp-checkout-custom-installments-container"}),(0,i.jsx)(m,{isVisible:!1,message:W,inputId:"mp-installments-helper"}),(0,i.jsx)("select",{style:{display:"none"},"data-checkout":"installments",name:"installments",id:"form-checkout__installments",className:"mp-input-select-select"}),(0,i.jsxs)("div",{id:"mp-checkout-custom-box-input-tax-cft",children:[(0,i.jsx)("div",{id:"mp-checkout-custom-box-input-tax-tea",children:(0,i.jsx)("div",{id:"mp-checkout-custom-tax-tea-text"})}),(0,i.jsx)("div",{id:"mp-checkout-custom-tax-cft-text"})]})]}),(0,i.jsx)("div",{className:"mp-checkout-custom-terms-and-conditions",children:(0,i.jsx)(p,{description:K,linkText:z,linkSrc:J,checkoutClass:"custom"})})]})]})}),(0,i.jsxs)("div",{ref:Z,id:"mercadopago-utilities",style:{display:"none"},children:[(0,i.jsx)("input",{type:"hidden",id:"cardTokenId",name:"mercadopago_custom[token]"}),(0,i.jsx)("input",{type:"hidden",id:"mpCardSessionId",name:"mercadopago_custom[session_id]"}),(0,i.jsx)("input",{type:"hidden",id:"cardExpirationYear","data-checkout":"cardExpirationYear"}),(0,i.jsx)("input",{type:"hidden",id:"cardExpirationMonth","data-checkout":"cardExpirationMonth"}),(0,i.jsx)("input",{type:"hidden",id:"cardInstallments",name:"mercadopago_custom[installments]"}),(0,i.jsx)("input",{type:"hidden",id:"paymentMethodId",name:"mercadopago_custom[payment_method_id]"}),(0,i.jsx)("input",{type:"hidden",id:"mp-amount",defaultValue:Q,name:"mercadopago_custom[amount]"}),(0,i.jsx)("input",{type:"hidden",id:"currency_ratio",defaultValue:G,name:"mercadopago_custom[currency_ratio]"}),(0,i.jsx)("input",{type:"hidden",id:"mp_checkout_type",name:"mercadopago_custom[checkout_type]",value:ee})]})]})},f={name:k,label:(0,i.jsx)(j,{}),content:(0,i.jsx)(g,{}),edit:(0,i.jsx)(g,{}),canMakePayment:()=>!0,ariaLabel:v,supports:{features:null!==(_=y?.supports)&&void 0!==_?_:[]}};(0,s.registerPaymentMethod)(f)})();