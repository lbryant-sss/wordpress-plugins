(()=>{"use strict";const e=window.React,t=window.wc.wcBlocksRegistry,n=window.wc.wcSettings,a=window.wp.element,o=window.wp.htmlEntities,s="mercadopago_blocks_update_cart",c=({labelMessage:t,helperInvalid:n,helperEmpty:a,helperWrong:o,inputName:s,hiddenId:c,inputDataCheckout:r,selectId:i,selectName:l,selectDataCheckout:p,flagError:d,documents:m,validate:u})=>(0,e.createElement)("div",{className:"mp-checkout-ticket-input-document"},(0,e.createElement)("input-document",{"label-message":t,"helper-invalid":n,"helper-empty":a,"helper-wrong":o,"input-name":s,"hidden-id":c,"input-data-checkout":r,"select-id":i,"select-name":l,"select-data-checkout":p,"flag-error":d,documents:m,validate:u})),r=({description:t,linkText:n,linkSrc:a,checkoutClass:o="pro"})=>(0,e.createElement)("div",{className:`mp-checkout-${o}-terms-and-conditions`},(0,e.createElement)("terms-and-conditions",{description:t,"link-text":n,"link-src":a})),i=({title:t,description:n,linkText:a,linkSrc:o})=>(0,e.createElement)("div",{className:"mp-test-mode-container"},(0,e.createElement)("test-mode",{title:t,description:n,"link-text":a,"link-src":o})),l=({name:t,label:n,optional:a,options:o,helperMessage:s,hiddenId:c,defaultOption:r})=>(0,e.createElement)("input-select",{name:t,label:n,options:o,optional:a,"helper-message":s,"hidden-id":c,"default-option":r});var p;const d="mp_checkout_blocks",m="woo-mercado-pago-pse",u=(0,n.getSetting)("woo-mercado-pago-pse_data",{}),_=(0,o.decodeEntities)(u.title)||"Checkout Pse",h=t=>{(e=>{const{extensionCartUpdate:t}=wc.blocksCheckout,{eventRegistration:n,emitResponse:o}=e,{onPaymentSetup:c,onCheckoutSuccess:r,onCheckoutFail:i}=n;(0,a.useEffect)((()=>{((e,t)=>{e({namespace:s,data:{action:"add",gateway:t}})})(t,m);const e=c((()=>({type:o.responseTypes.SUCCESS})));return()=>(((e,t)=>{e({namespace:s,data:{action:"remove",gateway:t}})})(t,m),e())}),[c]),(0,a.useEffect)((()=>{const e=r((async e=>{const t=e.processingResponse;return sendMetric("MP_PSE_BLOCKS_SUCCESS",t.paymentStatus,d),{type:o.responseTypes.SUCCESS}}));return()=>e()}),[r]),(0,a.useEffect)((()=>{const e=i((e=>{const t=e.processingResponse;return sendMetric("MP_PSE_BLOCKS_ERROR",t.paymentStatus,d),{type:o.responseTypes.FAIL,messageContext:o.noticeContexts.PAYMENTS,message:t.paymentDetails.message}}));return()=>e()}),[i])})(t);const{test_mode_title:n,test_mode_description:o,test_mode_link_text:p,test_mode_link_src:_,input_document_label:h,input_document_helper_empty:k,input_document_helper_invalid:y,input_document_helper_wrong:g,pse_text_label:E,person_type_label:S,amount:v,site_id:f,terms_and_conditions_description:b,terms_and_conditions_link_text:C,terms_and_conditions_link_src:w,test_mode:N,financial_institutions:x,financial_institutions_label:R,financial_institutions_helper:T,financial_placeholder:M,message_error_amount:P}=u.params;if(null==v)return(0,e.createElement)(e.Fragment,null,(0,e.createElement)("p",{className:"alert-message"},P));const q=(0,a.useRef)(null),{eventRegistration:I,emitResponse:O}=t,{onPaymentSetup:U}=I;let L={labelMessage:h,helperInvalid:y,helperEmpty:k,helperWrong:g,validate:"true",selectId:"doc_type",flagError:"mercadopago_pse[docNumberError]",inputName:"mercadopago_pse[docNumber]",selectName:"mercadopago_pse[docType]",documents:'["CC","CE","NIT"]'};return(0,a.useEffect)((()=>{const e=U((async()=>{const e=document.querySelector(".mp-checkout-pse-input-document").querySelector(".mp-input-document > input-helper > div"),t={"mercadopago_pse[site_id]":f,"mercadopago_pse[amount]":v.toString(),"mercadopago_pse[doc_type]":q.current.querySelector("#doc_type")?.value,"mercadopago_pse[doc_number]":q.current.querySelector("#form-checkout__identificationNumber-container > input")?.value,"mercadopago_pse[bank]":q.current.querySelector("#mercadopago_pse\\[bank\\]").value,"mercadopago_pse[person_type]":q.current.querySelector("#mercadopago_pse\\[person_type\\]").value};L.documents&&""===t["mercadopago_pse[doc_number]"]&&o(e,"flex");let n=document.querySelector("#mercadopago_pse\\[bank\\]"),a=document.querySelector(".mp-checkout-pse-bank").querySelector("input-helper > div");function o(e,t){e&&e.style&&(e.style.display=t)}function s(e){return e&&"flex"===e.style.display}return""!==n.value&&M!==n.value||o(a,"flex"),{type:s(a)||s(e)?O.responseTypes.ERROR:O.responseTypes.SUCCESS,meta:{paymentMethodData:t}}}));return()=>e()}),[O.responseTypes.ERROR,O.responseTypes.SUCCESS,U]),(0,e.createElement)("div",{className:"mp-checkout-container"},(0,e.createElement)("p",{className:"mp-checkout-pse-text","data-cy":"checkout-pse-text"},E),(0,e.createElement)("div",{className:"mp-checkout-pse-container"},(0,e.createElement)("div",{ref:q,className:"mp-checkout-pse-content"},N?(0,e.createElement)(i,{title:n,description:o,"link-text":p,"link-src":_}):null,(0,e.createElement)("div",{className:"mp-checkout-pse-person"},(0,e.createElement)(l,{name:"mercadopago_pse[person_type]",label:S,optional:!1,options:'[{"id":"individual", "description": "individual"},{"id":"association", "description": "asociaciÃ³n"}]'})),(0,e.createElement)("div",{className:"mp-checkout-pse-input-document"},L.documents?(0,e.createElement)(c,{...L}):null),(0,e.createElement)("div",{className:"mp-checkout-pse-bank"},(0,e.createElement)(l,{name:"mercadopago_pse[bank]",label:R,optional:!1,options:x,"hidden-id":"hidden-financial-pse","helper-message":T,"default-option":M})),(0,e.createElement)("div",{id:"mp-box-loading"}))),(0,e.createElement)(r,{description:b,linkText:C,linkSrc:w,checkoutClass:"pse"}))},k={name:m,label:(0,e.createElement)((t=>{const{PaymentMethodLabel:n}=t.components,a=(0,o.decodeEntities)(u?.params?.fee_title||""),s=`${_} ${a}`;return(0,e.createElement)(n,{text:s})}),null),content:(0,e.createElement)(h,null),edit:(0,e.createElement)(h,null),canMakePayment:()=>!0,ariaLabel:_,supports:{features:null!==(p=u?.supports)&&void 0!==p?p:[]}};(0,t.registerPaymentMethod)(k)})();