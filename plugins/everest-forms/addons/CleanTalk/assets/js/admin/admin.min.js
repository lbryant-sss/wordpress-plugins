!function(e){const t={init:function(){e(document).ready((function(){t.bindCleanTalkInit(),t.toggleCleanTalkSettings(),e(document).on("click","#everest-forms-clean-talk-save-settings",(function(a){a.preventDefault(),t.saveCleanTalkSettings(e(this))})),e(document).on("change",'input[name="everest_forms_clean_talk_methods"]',(function(){t.toggleCleanTalkSettings()}))}))},bindCleanTalkInit:function(){const a=e("#everest-forms-panel-field-settings-cleantalk");t.cleanTalkToggle(a),e(document).on("change","#everest-forms-panel-field-settings-cleantalk",(function(){t.cleanTalkToggle(e(this))}))},toggleCleanTalkSettings:function(){"rest_api"===e('input[name="everest_forms_clean_talk_methods"]:checked').val()?e(document).find(".evf-clean-talk-access-key").removeClass("everest-forms-hidden"):e(document).find(".evf-clean-talk-access-key").addClass("everest-forms-hidden")},cleanTalkToggle:function(t){e(t).is(":checked")?e(".everest-forms-cleantalk-protection-type").show():e(".everest-forms-cleantalk-protection-type").hide()},saveCleanTalkSettings:function(t){const a=e("#everest-forms-clean-talk-settings-form").serializeArray(),s={action:"everest_forms_save_clean_talk_settings",security:everest_forms_clean_talk.security,form_data:a,is_clean_talk_enabled:"yes"},n=t;e.ajax({type:"POST",url:everest_forms_clean_talk.ajax_url,data:s,beforeSend:function(){n.append('<i class="evf-loading evf-loading-active"></i>'),n.attr("disabled",!0),n.css({cursor:"not-allowed",opacity:.5})},success:function(t){n.find(".evf-loading").remove();const a=setInterval((function(){window.onbeforeunload=null,e(window).off("beforeunload")}),500);setTimeout((function(){clearInterval(a)}),5e3);const s=e(document).find(".evf-clean-talk-message");s.empty(),s.append(t.data.html),t.success?s.find(".everest-forms-clean-talk-message-outer-wrapper").addClass("everest-forms-clean-talk-success-state"):"empty"===t.data.error?s.find(".everest-forms-clean-talk-message-outer-wrapper").addClass("everest-forms-clean-talk-empty-state"):s.find(".everest-forms-clean-talk-message-outer-wrapper").addClass("everest-forms-clean-talk-invalid-state"),n.attr("disabled",!1),n.css({cursor:"",opacity:1}),setTimeout((function(){s.fadeOut(300,(function(){s.find(".everest-forms-clean-talk-message-outer-wrapper").removeClass("everest-forms-clean-talk-empty-state"),s.find(".everest-forms-clean-talk-message-outer-wrapper").removeClass("everest-forms-clean-talk-invalid-state"),s.find(".everest-forms-clean-talk-message-outer-wrapper").removeClass("everest-forms-clean-talk-success-state"),s.attr("style","").text("").show()}))}),5e3)},error:function(){alert("Error saving settings."),n.val(originalText)}})}};t.init()}(jQuery);
