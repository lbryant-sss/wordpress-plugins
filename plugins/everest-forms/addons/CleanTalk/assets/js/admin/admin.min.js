!function(e){const n={init:function(){e(document).ready((function(){n.bindCleanTalkInit(),n.toggleCleanTalkSettings(),e(document).on("click","#everest-forms-clean-talk-save-settings",(function(t){t.preventDefault(),n.saveCleanTalkSettings(e(this))})),e(document).on("change","#everest_forms_enable_cleantalk_spam_protection",(function(){n.hideShowCleanTalkSetting(e(this))})),e(document).on("change",'input[name="everest_forms_clean_talk_methods"]',(function(){n.toggleCleanTalkSettings()}))}))},bindCleanTalkInit:function(){const t=e("#everest-forms-panel-field-settings-cleantalk");n.cleanTalkToggle(t),e(document).on("change","#everest-forms-panel-field-settings-cleantalk",(function(){n.cleanTalkToggle(e(this))}))},toggleCleanTalkSettings:function(){"rest_api"===e('input[name="everest_forms_clean_talk_methods"]:checked').val()?e(document).find(".evf-clean-talk-access-key").removeClass("everest-forms-hidden"):e(document).find(".evf-clean-talk-access-key").addClass("everest-forms-hidden")},cleanTalkToggle:function(n){e(n).is(":checked")?e(".everest-forms-cleantalk-protection-type").show():e(".everest-forms-cleantalk-protection-type").hide()},saveCleanTalkSettings:function(n){const t=e("#everest_forms_enable_cleantalk_spam_protection").is(":checked"),a=e("#everest-forms-clean-talk-settings-form").serializeArray(),s={action:"everest_forms_save_clean_talk_settings",security:everest_forms_clean_talk.security,form_data:a,is_clean_talk_enabled:t?"yes":"no"},l=n,o=l.val();l.prop("disabled",!0).val("Saving..."),e.ajax({type:"POST",url:everest_forms_clean_talk.ajax_url,data:s,success:function(n){const t=setInterval((function(){window.onbeforeunload=null,e(window).off("beforeunload")}),500);setTimeout((function(){clearInterval(t)}),5e3),n.success&&l.val("Saved")},error:function(){alert("Error saving settings."),l.val(o)},complete:function(){setTimeout((function(){l.prop("disabled",!1).val(o)}),2e3)}})},hideShowCleanTalkSetting:function(n){n.is(":checked")?e(document).find("#evf-clean-talk-section-container").removeClass("everest-forms-hidden"):e(document).find("#evf-clean-talk-section-container").addClass("everest-forms-hidden")}};n.init()}(jQuery);
