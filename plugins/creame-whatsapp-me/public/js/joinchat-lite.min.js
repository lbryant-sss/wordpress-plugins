((c,i,a)=>{a={settings:null,is_mobile:/Mobile|Android|iPhone|iPad/i.test(navigator.userAgent),can_qr:c.QrCreator&&"function"==typeof QrCreator.render,...a},(c.joinchat_obj=a).send_event=function(o){if((o={event_category:"JoinChat",event_label:"",event_action:"",chat_channel:"whatsapp",chat_id:"--",is_mobile:this.is_mobile?"yes":"no",page_location:location.href,page_title:i.title||"no title",...o}).event_label=o.event_label||o.link||"",o.event_action=o.event_action||o.chat_channel+": "+o.chat_id,delete o.link,i.dispatchEvent(new CustomEvent("joinchat:event",{detail:o,cancelable:!0}))){let e=c[this.settings.data_layer]||c[c.gtm4wp_datalayer_name]||c.dataLayer;if("object"==typeof e){let i=c.gtag||function(){e.push(arguments)},s=void 0!==this.settings.ga_event?this.settings.ga_event:"generate_lead";if(s){let t={transport_type:"beacon",...o},n=(Object.keys(t).forEach(e=>{"page_location"===e?t[e]=t[e].substring(0,1e3):"page_referrer"===e?t[e]=t[e].substring(0,420):"page_title"===e?t[e]=t[e].substring(0,300):"string"==typeof t[e]&&(t[e]=t[e].substring(0,100))}),[]),a=e=>{n.includes(e)||(e.startsWith("G-")||e.startsWith("GT-"))&&(n.push(e),i("event",s,{send_to:e,...t}))};if(c.google_tag_data&&google_tag_data.tidr&&google_tag_data.tidr.destination)for(var r in google_tag_data.tidr.destination)a(r);e.forEach(e=>{"config"===e[0]&&e[1]&&a(e[1])})}this.settings.gads&&i("event","conversion",{send_to:this.settings.gads})}var t,n,a=o.event_category;delete o.event_category,"object"==typeof e&&e.push({event:a,...o}),"function"==typeof fbq&&("whatsapp"===o.chat_channel&&(n=""+(t=o.chat_id).substring(0,3)+"X".repeat(t.length-5)+t.substring(t.length-2),o.chat_id=n,o.event_label=o.event_label.replace(t,n),o.event_action=o.event_action.replace(t,n)),fbq("trackCustom",a,o))}},a.get_wa_link=function(e,t,n){t=void 0!==t?t:this.settings.message_send||"",n=void 0!==n?n:this.settings.whatsapp_web&&!this.is_mobile;n=new URL((n?"https://web.whatsapp.com/send?phone=":"https://wa.me/")+(e||this.settings.telephone));return t&&n.searchParams.set("text",t),n.toString()},a.open_whatsapp=function(e,t){e=e||this.settings.telephone,t=void 0!==t?t:this.settings.message_send||"";e={link:this.get_wa_link(e,t),chat_channel:"whatsapp",chat_id:e,chat_message:t};i.dispatchEvent(new CustomEvent("joinchat:open",{detail:e,cancelable:!0}))&&(this.send_event(e),c.open(e.link,"joinchat","noopener"))},a.qr=function(e,t){var n=i.createElement("CANVAS");return QrCreator.render(Object.assign({text:e,radius:.4,background:"#FFF",size:200*(c.devicePixelRatio||1)},this.settings.qr||{},t||{}),n),n};var e=()=>{if(i.addEventListener("click",function(e){e.target.closest('.joinchat_open, .joinchat_app, a[href="#joinchat"], a[href="#whatsapp"]')&&(e.preventDefault(),a.open_whatsapp(e.target.dataset.phone,e.target.dataset.message))}),a.can_qr&&!a.is_mobile?i.querySelectorAll(".joinchat-button__qr").forEach(e=>e.appendChild(a.qr(a.get_wa_link(e.dataset.phone,e.dataset.message,!1)))):i.querySelectorAll(".wp-block-joinchat-button figure").forEach(e=>e.remove()),void 0!==a.settings.sku&&"function"==typeof jQuery){let n=a.settings.message_send;jQuery("form.variations_form").on("found_variation reset_data",function(e,t){t=t&&t.sku||a.settings.sku;a.settings.message_send=n.replace(/<jc-sku>.*<\/jc-sku>/g,t)})}};"loading"!==i.readyState?e():i.addEventListener("DOMContentLoaded",e)})(window,document,window.joinchat_obj||{});