import{r as e,h as t,H as s}from"./p-e97fde0a.js";import{s as a}from"./p-3aa9debd.js";import{a as d}from"./p-d9fa04f9.js";import"./p-401e165e.js";import"./p-d3366af3.js";const i=":host{display:block}";const n=i;const c=class{constructor(t){e(this,t);this.liveMode=true;this.customerId=undefined;this.successUrl=undefined;this.currency=undefined;this.loading=undefined;this.loaded=undefined;this.error=undefined;this.paymentIntent=undefined}async handlePaymentIntentCreate(){var e,t;const{public_key:s,access_code:d}=((t=(e=this.paymentIntent)===null||e===void 0?void 0:e.processor_data)===null||t===void 0?void 0:t.paystack)||{};if(!s||!d)return;const i=new a;await i.newTransaction({key:s,accessCode:d,onSuccess:async e=>{if((e===null||e===void 0?void 0:e.status)!=="success"){throw{message:wp.i18n.sprintf(wp.i18n.__("Paystack transaction could not be finished. Status: %s","surecart"),e===null||e===void 0?void 0:e.status)}}window.location.assign(this.successUrl)},onClose:e=>{console.error(e);alert((e===null||e===void 0?void 0:e.message)||wp.i18n.__("The payment did not process. Please try again.","surecart"))}})}async createPaymentIntent(){var e,t;try{this.loading=true;this.error="";this.paymentIntent=await d({method:"POST",path:"surecart/v1/payment_intents",data:{processor_type:"paystack",reusable:true,live_mode:this.liveMode,customer_id:this.customerId,currency:this.currency,refresh_status:true}})}catch(s){this.error=((t=(e=s===null||s===void 0?void 0:s.additional_errors)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.message)||(s===null||s===void 0?void 0:s.message)||wp.i18n.__("Something went wrong","surecart")}finally{this.loading=false}}render(){return t(s,{key:"8a19fc59bc0d87ad22f1a5574c9d942f464aba4f"},this.error&&t("sc-alert",{key:"661046d0974f7c00cff964ec88eb6cbed177d78c",open:!!this.error,type:"danger"},t("span",{key:"3410da48c11db8f4bd1b48f04b08d41b15d38c9e",slot:"title"},wp.i18n.__("Error","surecart")),this.error),t("div",{key:"aa037364c7b1999e3b58f933f745d9f6e62b2f82",class:"sc-paystack-button-container"},t("sc-alert",{key:"c25fb3973c4d124016d43240dfccbae4601b0e7c",open:true,type:"warning"},wp.i18n.__("In order to add a new card, we will need to make a small transaction to authenticate it. This is for authentication purposes and will be immediately refunded.","surecart"),t("div",{key:"beb25c49ee9c02ee4187dd97f90e5126cb28ed0b"},t("sc-button",{key:"5d21c5e4c8ecfeb8416288587082ad7bd7dc0b7b",loading:this.loading,type:"primary",onClick:()=>this.createPaymentIntent(),style:{marginTop:"var(--sc-spacing-medium)"}},wp.i18n.__("Add New Card","surecart"))))))}static get watchers(){return{paymentIntent:["handlePaymentIntentCreate"]}}};c.style=n;export{c as sc_paystack_add_method};
//# sourceMappingURL=p-0e27312e.entry.js.map