import{by as Rs,bz as Dr,t as ii,c as _,r as F,x as R,bA as Nr,a as c,d as y,s as $,u as t,i as we,n as q,g as be,y as H,k as m,e as C,q as O,aB as Dn,b as U,w as x,l as ce,p as Se,f as ko,M as Ge,_ as We,bB as Or,bC as Mr,b7 as nt,a$ as he,bD as Tl,br as oi,j as De,ac as ga,z as fe,F as ee,ba as za,bE as Ol,ar as qe,bF as Us,ap as He,aI as Ml,aH as Fl,bG as Ba,aP as Ne,b5 as Sl,D as Qe,bh as Fr,bi as Vr,a4 as Zs,o as Je,b2 as st,bk as _t,aY as at,bl as Br,bm as Lt,ai as pt,bc as Co,bH as Rr,bI as xo,bJ as qr,bj as et,bK as Ni,J as Be,K as El,L as rt,B as ri,b8 as va,b9 as _a,aL as Ta,bL as Ur,bM as ci,bN as ms,bO as La,bP as Oi,bQ as zr,bR as jr,ao as it,bS as ui,aS as yt,bT as wo,bU as To,bV as bs,bW as ks,aX as mt,m as Mi,b6 as ht,bX as hs,bY as Yr,bZ as ja,b_ as So,ag as Eo,b$ as Nt,c0 as Bt,aD as zt,c1 as ia,c2 as Gs,aE as Lo,c3 as jt,c4 as Ia,aA as Ao,aq as Io,c5 as Wr,aQ as Js,c6 as Hr,c7 as vs,as as tt,c8 as di,c9 as Zr,ca as Fi,cb as Vi,bn as dt,cc as Ll,bg as Gr,cd as Vl,a9 as Jr,aV as $a,aU as Bl,a_ as Xr,ce as Qr,cf as $o,cg as Kr,ch as ec,ci as tc,cj as ac,ck as mi,cl as sc,cm as lc,cn as Bi,co as nc,af as ic,ak as oc}from"./stepForm.8bc9de25.js";import{e as rc,f as Ye,u as cc,m as Ke,_ as Al}from"./eventListForm.b561069d.js";import{_ as uc}from"./catalogForm.d14347f6.js";function Dt(n,a){let e=a!==""?JSON.parse(n.translations)[a]:JSON.parse(n.translations);if(Rs in e)return e[Rs];let s=Object.keys(e),l=Object.keys(e).map(o=>o.length>2?o.slice(0,2):o),i="";for(let o=0;o<l.length;o++){if(Dr===s[o]&&e[s[o]]){i=e[s[o]];break}l[o]===Rs&&e[s[o]]&&(i=e[s[o]])}return i}function Nn(n,a){return n.translations&&JSON.parse(n.translations)[a]&&Dt(n,a)?Dt(n,a):n[a]}function Vt(n){return n.translations&&JSON.parse(n.translations).name&&Dt(n,"name")?Dt(n,"name"):n.name}function dc(n){return n.translations&&Dt(n,"")?Dt(n,""):n.name}function nx(n){return n.translations&&Dt(n,"")?Dt(n,""):n.content}function mc(n){return n.translations&&Dt(n,"name")?Dt(n,"name"):n.label}function pc(n){return n.translations&&Dt(n,"")?Dt(n,""):n.label}function na(n){return n.translations&&JSON.parse(n.translations).description&&Dt(n,"description")?Dt(n,"description"):n.description}function ix(n){n.services&&n.services.length&&n.services.forEach(a=>{a.name=Vt(a),a.description=na(a),a.extras.forEach(e=>{e.name=Vt(e),e.description=na(e)})}),n.locations&&n.locations.length&&n.locations.forEach(a=>{a.name=Vt(a),a.description=na(a)}),n.packages&&n.packages.length&&n.packages.forEach(a=>{a.name=Vt(a),a.description=na(a),a.bookable.forEach(e=>{e.service.name=Vt(e.service),e.service.description=na(e.service),"extras"in e.service&&e.service.extras.forEach(s=>{s.name=Vt(s),s.description=na(s)})})}),n.categories&&n.categories.length&&n.categories.forEach(a=>{a.name=Vt(a),a.serviceList.forEach(e=>{e.name=Vt(e),e.description=na(e),e.extras.forEach(s=>{s.name=Vt(s),s.description=na(s)})})}),n.events&&n.events.length&&n.events.forEach(a=>{a.name=Vt(a),a.description=na(a),a.extras.forEach(e=>{e.name=Vt(e),e.description=na(e)})}),n.customFields&&n.customFields.length&&n.customFields.forEach(a=>{a.label=mc(a),a.options.forEach(e=>{e.label=pc(e)})}),n.employees&&n.employees.length&&n.employees.forEach(a=>{a.firstName=Nn(a,"firstName"),a.lastName=Nn(a,"lastName"),a.description=Nn(a,"description")})}const lt={props:{modelValue:{type:[Boolean,String,Number],default:!1},id:{type:String},name:{type:String},width:{type:[Number,String]},size:{type:String,default:"default",validator(n){return["large","default","small"].includes(n)}},validateEvent:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},activeColor:{type:String},inactiveColor:{type:String},activeText:{type:String},inactiveText:{type:String},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeIconClass:{type:String},inactiveIconClass:{type:String},activeIcon:{type:String},inactiveIcon:{type:String},beforeChange:{type:[Function,Boolean],default:()=>{}},borderColor:{type:String},inlinePrompt:{type:Boolean,default:!1},parentClass:{type:String},class:{type:String},ariaLabel:{type:String}},emits:["update:modelValue","change"],setup(n,{emit:a}){const e=n,{modelValue:s}=ii(e),l=_({get:()=>s.value,set:u=>a("update:modelValue",u)}),i=F(null),o=R("amColors",F({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#1A2C37",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF",colorBtnWaiting:"#CCA20C",colorBtnWaitingText:"#FFFFFF",colorBtnDanger:"#B4190F",colorBtnDangerText:"#FFFFFF"})),r=_(()=>({"--am-c-switch-bgr-active":o.value.colorPrimary,"--am-c-switch-bgr-inactive":o.value.colorInpBorder,"--am-c-switch-action":o.value.colorMainBgr,"--am-c-switch-text":o.value.colorMainText}));return(u,d)=>{const f=Nr;return c(),y("div",{class:q(["am-switch-wrapper",n.parentClass]),style:be(t(r))},[$(f,{id:n.id,ref_key:"amSwitch",ref:i,modelValue:t(l),"onUpdate:modelValue":d[0]||(d[0]=v=>we(l)?l.value=v:null),class:q(["am-switch",e.class]),name:n.name,width:n.width,size:n.size,"validate-event":n.validateEvent,loading:n.loading,disabled:n.disabled,"active-color":n.activeColor,"inactive-color":n.inactiveColor,"active-text":n.activeText,"inactive-text":n.inactiveText,"active-value":n.activeValue,"inactive-value":n.inactiveValue,"active-icon-class":n.activeIconClass,"inactive-icon-class":n.inactiveIconClass,"active-icon":n.activeIcon,"inactive-icon":n.inactiveIcon,"before-change":n.beforeChange,"border-color":n.borderColor,"inline-prompt":n.inlinePrompt,"aria-label":n.ariaLabel,onChange:d[1]||(d[1]=v=>a("change",v))},null,8,["id","modelValue","class","name","width","size","validate-event","loading","disabled","active-color","inactive-color","active-text","inactive-text","active-value","inactive-value","active-icon-class","inactive-icon-class","active-icon","inactive-icon","before-change","border-color","inline-prompt","aria-label"])],6)}}};const gc={class:"am-oit__wrapper"},fc={class:"am-oit"},hc={class:"am-oit__img"},vc={key:0},_c={class:"am-oit__content am-oit__content-short"},yc={class:"am-oit__data"},bc={class:"am-oit__data-label-name"},kc=["innerHTML"],Cc={style:{display:"flex"}},xc=m("span",{class:"am-icon-circle-info"},null,-1),wc=[xc],Tc={class:"am-dialog__title"},Sc={class:"am-dialog__body"},Ec={class:"am-dialog__body-heading"},Lc={class:"am-oit__img"},Ac={key:0},Ic={class:"am-dialog__body-heading__text"},$c={class:"am-dialog__body-heading__text-name"},Pc=["innerHTML"],Dc={inheritAttrs:!1},Nc=Object.assign(Dc,{props:{identifier:{type:[String,Number],required:!0},imageThumb:{type:String,default:""},label:{type:[String,Number],default:""},description:{type:String,default:""},price:{type:[String,Number],default:""},dialogTitle:{type:String,default:""},dialogButtonText:{type:String,default:""},badge:{type:[String,Number,Object]}},emits:["click"],setup(n,{emit:a}){const e=n;let s=F(!1);const l=g=>{g.stopPropagation(),s.value=!0},i=()=>{s.value=!1,a("click",e.identifier)};function o(g){return g=g.replace(/<\/p>/g," </p>").replace(/<\/h1>/g," </h1>").replace(/<\/h2>/g," </h2>").replace(/<\/h3>/g," </h3>").replace(/<\/h4>/g," </h4>"),g=g.replace(/<\/li>/g," </li>"),g}function r(){if(e.label){let g="";return e.label.split(" ").forEach(k=>{g+=k.charAt(0).toUpperCase()}),g}}let u=R("primDescBtnType","filled"),d=R("amColors"),f=_(()=>({"--am-oit-c-main-bgr":d.value.colorMainBgr,"--am-oit-c-main-btn-color":d.value.colorBtnPrim,"--am-oit-c-main-btn-color-text":d.value.colorBtnPrimText,"--am-oit-c-main-heading-text":d.value.colorMainHeadingText,"--am-oit-c-main-heading-text-op90":H(d.value.colorMainHeadingText,.9),"--am-oit-c-main-text":d.value.colorMainText,"--am-c-option-img-text":d.value.colorMainBgr})),v=_(()=>({"--am-c-option-selected":d.value.colorPrimary}));return(g,k)=>(c(),y("span",gc,[m("span",fc,[m("span",hc,[m("span",{class:"am-oit__img-placeholder",style:be({backgroundImage:`url(${e.imageThumb})`})},[e.imageThumb?O("",!0):(c(),y("span",vc,C(r()),1))],4)]),m("span",_c,[m("span",yc,[m("span",{class:q(`am-oit__data-label ${n.badge?"am-oit__data-label-wrap":""}`)},[m("span",bc,C(n.label),1),n.badge?(c(),y("span",{key:0,class:"am-oit__data-label-badge",style:be({background:n.badge.color})},C(n.badge.content),5)):O("",!0)],2),!n.badge&&t(Dn)(n.description)?(c(),y("span",{key:0,class:"am-oit__data-description",innerHTML:o(n.description)},null,8,kc)):O("",!0)]),m("span",Cc,[e.price?(c(),y("span",{key:0,class:"am-oit__price",style:be(t(v))},C(e.price),5)):O("",!0),t(Dn)(n.description)?(c(),y("span",{key:1,class:"am-oit__info-trigger",onClick:l},wc)):O("",!0)])])]),t(Dn)(n.description)?(c(),U(uc,{key:0,modelValue:t(s),"onUpdate:modelValue":k[0]||(k[0]=N=>we(s)?s.value=N:s=N),"custom-class":"am-option-template-dialog am-dialog ql-description","append-to-body":!0,"custom-styles":t(f),"destroy-on-close":!0,"align-center":!0,"modal-class":"am-dialog-employee-description"},{title:x(()=>[m("span",Tc,C(n.dialogTitle),1)]),footer:x(()=>[$(Se,{type:t(u),category:"primary",onClick:i},{default:x(()=>[ce(C(n.dialogButtonText),1)]),_:1},8,["type"])]),default:x(()=>[m("div",Sc,[m("div",Ec,[m("span",Lc,[m("span",{class:"am-oit__img-placeholder",style:be({backgroundImage:`url(${e.imageThumb})`})},[e.imageThumb?O("",!0):(c(),y("span",Ac,C(r()),1))],4)]),m("div",Ic,[m("span",$c,C(n.label),1),n.badge?(c(),y("span",{key:0,class:"am-dialog__body-heading__text-badge",style:be({background:n.badge.color})},C(n.badge.content),5)):O("",!0)])]),m("div",{class:"am-dialog__body-content",innerHTML:n.description},null,8,Pc)])]),_:1},8,["modelValue","custom-styles"])):O("",!0)]))}});const Oc={props:{ready:{type:Boolean,default:!0}},setup(n){let a=R("amColors",F({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#1A2C37",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),e=_(()=>({"--am-c-caph-text":a.value.colorMainText,"--am-c-caph-heading-text":a.value.colorMainHeadingText,"--am-c-caph-text-op15":H(a.value.colorMainText,.15)}));return(s,l)=>(c(),y("div",{class:"am-caph__main",style:be(t(e))},[ko(s.$slots,"default")],4))}};const Mc={key:0},Fc={key:1},Vc={key:2},Bc={name:"MainProfileFooter"},Rc=Object.assign(Bc,{props:{parentWidth:{type:Number,default:1200},display:{type:String,default:"first"},loading:{type:Boolean,default:!1},customizedLabels:{type:Object,default:()=>({})},deleteFooterType:{type:String,default:"plain"},saveFooterButton:{type:String,default:"filled"},passFooterButton:{type:String,default:"filled"}},setup(n){const a=n,e=R("labels");function s(v){return Object.keys(a.customizedLabels).length&&a.customizedLabels[v]?a.customizedLabels[v]:e[v]}const l=R("settings");let i=R("deleteProfileDialog",F(!1)),o=R("saveProfileChanges",()=>{}),r=R("saveCustomerCustomFields",()=>{}),u=R("changeProfilePassword",()=>{}),d=R("amColors"),f=_(()=>({"--am-c-cappf-bgr":d.value.colorMainBgr,"--am-c-cappf-text":d.value.colorMainText,"--am-c-cappf-text-op15":H(d.value.colorMainText,.15)}));return(v,g)=>(c(),y("div",{class:"am-cappf",style:be(t(f))},[m("div",{class:q(["am-cappf__options",{"am-only-one":n.display==="second"||!t(l).roles.allowCustomerDeleteProfile}])},[n.display==="first"&&t(l).roles.allowCustomerDeleteProfile?(c(),y("div",Mc,[$(Se,{category:"danger",size:t(a).parentWidth<=360?"small":"default",type:t(a).deleteFooterType,class:"am-cappf__delete",disabled:n.loading,onClick:g[0]||(g[0]=k=>we(i)?i.value=!0:i=!0)},{default:x(()=>[ce(C(s("delete_profile")),1)]),_:1},8,["size","type","disabled"])])):O("",!0),n.display==="first"||n.display==="third"?(c(),y("div",Fc,[$(Se,{type:t(a).saveFooterButton,size:t(a).parentWidth<=360?"small":"default",disabled:n.loading,onClick:g[1]||(g[1]=k=>n.display==="first"?t(o)():t(r)())},{default:x(()=>[ce(C(s("save_changes")),1)]),_:1},8,["type","size","disabled"])])):O("",!0),n.display==="second"?(c(),y("div",Vc,[$(Se,{type:t(a).passFooterButton,size:t(a).parentWidth<=360?"small":"default",disabled:n.loading,onClick:g[2]||(g[2]=k=>t(u)())},{default:x(()=>[ce(C(s("change_password")),1)]),_:1},8,["type","size","disabled"])])):O("",!0)],2)],4))}});const qc={key:0,class:"am-date-picker__input-date"},Uc={key:1,class:"am-date-picker__input-start"},zc={key:2,class:"am-date-picker__input-end"},Yt={props:{modelValue:{type:[String,Array,Object,Number]},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},size:{type:String,default:"default",validator(n){return["default","medium","small","mini","micro"].includes(n)}},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!1},placeholder:{type:String,default:""},startPlaceholder:{type:String},endPlaceholder:{type:String},type:{type:String,default:"date",validator(n){return["year","years","month","months","date","dates","datetime","week","datetimerange","daterange","monthrange","yearrange"].includes(n)}},format:{type:String},popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>{}},rangeSeparator:{type:String,default:"-"},defaultValue:{type:[String,Array,Object,Number]},defaultTime:{type:[String,Array,Object,Number]},valueFormat:{type:String},id:{type:[String,Array]},name:{type:[String,Array]},unlinkPanels:{type:Boolean,default:!1},prefixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="calendar"/>'})},clearIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="close"/>'})},validateEvent:{type:Boolean,default:!0},disabledDate:{type:Function,default:()=>{}},shortcuts:{type:Array,default:()=>[]},cellClassName:{type:Function},teleported:{type:Boolean,default:!0},emptyValues:{type:[String,Array]},valueOnClear:{type:[String,Number,Boolean,Function],default:""},fallbackPlacements:{type:Array},placement:{type:String,default:"bottom",validator(n){return["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"].includes(n)}},lang:{type:String,default:""}},emits:["update:modelValue","change","blur","focus","clear","calendar-change","panel-change","visible-change"],setup(n,{emit:a}){const e=n;let{modelValue:s}=ii(e),l=_({get:()=>s.value,set:d=>{a("update:modelValue",d)}});const i=F(null);function o(){i.value&&i.value.focus()}let r=R("amColors"),u=_(()=>({"--am-c-primary":r.value.colorPrimary,"--am-c-inp-bgr":r.value.colorInpBgr,"--am-c-inp-border":r.value.colorInpBorder,"--am-c-inp-text":r.value.colorInpText,"--am-c-inp-text-op03":H(r.value.colorInpText,.03),"--am-c-inp-text-op05":H(r.value.colorInpText,.05),"--am-c-inp-text-op40":H(r.value.colorInpText,.4),"--am-c-inp-text-op60":H(r.value.colorInpText,.6),"--am-c-inp-placeholder":r.value.colorInpPlaceHolder,"--am-c-drop-bgr":r.value.colorDropBgr,"--am-c-drop-text":r.value.colorDropText,"--am-c-drop-text-op03":H(r.value.colorDropText,.03),"--am-c-drop-text-op10":H(r.value.colorDropText,.1),"--am-c-drop-text-op30":H(r.value.colorDropText,.3),"--am-c-drop-text-op50":H(r.value.colorDropText,.5),"--am-c-drop-text-op70":H(r.value.colorDropText,.7),"--am-c-drop-text-op80":H(r.value.colorDropText,.8),"--am-c-drop-border":r.value.colorDropBorder,"--am-c-skeleton-op20":H(r.value.colorMainText,.2),"--am-c-skeleton-op60":H(r.value.colorMainText,.6),"--am-c-skeleton-sb-op20":H(r.value.colorSbText,.2),"--am-c-skeleton-sb-op60":H(r.value.colorSbText,.6)}));return(d,f)=>{const v=Or,g=Mr;return c(),y("div",{class:q(["am-date-picker__wrapper",{"is-disabled":e.disabled}]),style:be(t(u))},[m("div",{class:q(["am-date-picker__input",[`am-${e.type}`,{"is-disabled":e.disabled}]]),onClick:o},[e.type==="date"&&t(l)?(c(),y("div",qc,C(t(nt)(t(he)(t(l)).format("YYYY-MM-DD"))),1)):O("",!0),e.type==="daterange"&&t(l)[0]?(c(),y("div",Uc,C(t(nt)(t(he)(t(l)[0]).format("YYYY-MM-DD"))),1)):O("",!0),e.type==="daterange"&&t(l)[1]?(c(),y("div",zc,C(t(nt)(t(he)(t(l)[1]).format("YYYY-MM-DD"))),1)):O("",!0)],2),$(g,{locale:t(rc)(e.lang)},{default:x(()=>[$(v,{id:n.id,ref_key:"amDatePicker",ref:i,modelValue:t(l),"onUpdate:modelValue":f[0]||(f[0]=k=>we(l)?l.value=k:l=k),readonly:e.readonly,disabled:e.disabled,editable:e.editable,clearable:e.clearable,placeholder:e.placeholder,"start-placeholder":e.startPlaceholder,"end-placeholder":e.endPlaceholder,type:e.type,format:e.format,"popper-class":e.popperClass,"popper-options":e.popperOptions,"popper-style":t(u),"range-separator":e.rangeSeparator,"default-value":e.defaultValue,"default-time":e.defaultTime,"value-format":e.valueFormat,"unlink-panels":e.unlinkPanels,"prefix-icon":e.prefixIcon,"clear-icon":e.clearIcon,"validate-event":e.validateEvent,"disabled-date":n.disabledDate,shortcuts:e.shortcuts,"cell-class-name":e.cellClassName,teleported:e.teleported,"empty-values":e.emptyValues,"value-on-clear":e.valueOnClear,"fallback-placements":e.fallbackPlacements,placement:e.placement,class:q(["am-date-picker",[`am-date-picker--${n.size}`,{"am-date-picker--disabled":e.disabled}]]),onChange:f[1]||(f[1]=k=>d.$emit("change",k)),onBlur:f[2]||(f[2]=k=>d.$emit("blur",k)),onFocus:f[3]||(f[3]=k=>d.$emit("focus",k)),onClear:f[4]||(f[4]=k=>d.$emit("clear",k)),onCalendarChange:f[5]||(f[5]=k=>d.$emit("calendar-change",k)),onPanelChange:f[6]||(f[6]=k=>d.$emit("panel-change",k)),onVisibleChange:f[7]||(f[7]=k=>d.$emit("visible-change",k))},null,8,["id","modelValue","readonly","disabled","editable","clearable","placeholder","start-placeholder","end-placeholder","type","format","popper-class","popper-options","popper-style","range-separator","default-value","default-time","value-format","unlink-panels","prefix-icon","clear-icon","validate-event","disabled-date","shortcuts","cell-class-name","teleported","empty-values","value-on-clear","fallback-placements","placement","class"])]),_:1},8,["locale"])],6)}}};function jc(n,a,e){let s={};return n.forEach(l=>{a===""&&l.periods.forEach(f=>{f.periodStart=Tl(f.periodStart),f.periodEnd=Tl(f.periodEnd)});let o=he(l.periods[0].periodStart,"YYYY-MM-DD HH:mm:ss").format("YYYY-MM-DD"),r=e.getters.getSettings.general.usedLanguages.map(f=>f.length>2?f.slice(0,2):f);(e.getters.getSettings.general.usedLanguages.indexOf(e.getters.getLocalLanguage)!==-1||r.indexOf(e.getters.getLocalLanguage.split("_")[0])!==-1)&&(l.name=Vt(l),l.customTickets.forEach(f=>{f.name=dc(f)})),l.recurring&&l.recurring.until&&(l.recurring.until=l.recurring.until.split(" ")[0]),o in s||(s[o]={date:o,events:[]});let d=l.bookings.some(f=>f.status==="waiting");if(l.full&&l.status==="approved"?l.status="full":l.upcoming&&l.status==="approved"&&(l.status="upcoming"),d&&(l.status="waiting"),e.getters["auth/getProfile"].type==="provider"){let f=JSON.parse(JSON.stringify(l));s[o].events.push(f)}else l.bookings.forEach(f=>{let v=JSON.parse(JSON.stringify(l));v.bookings=[f],s[o].events.push(v)})}),s}function Po(n){let a=0;return n.bookings.forEach(e=>{if(["approved","pending"].includes(e.status)){let s=0;if(e.ticketsData.length>0)for(let i=0;i<e.ticketsData.length;i++)s+=e.ticketsData[i].persons*e.ticketsData[i].price;else s+=n.price;let l=oi(n,e.coupon,e.tax?e.tax[0]:null,s,!1);a+=l.price-l.discount+l.tax}}),a>=0?a:0}function Yc(n){let a=[];return n.forEach(e=>{let s=he(e.periodStart.split(" ")[0],"YYYY-MM-DD"),l=he(e.periodEnd.split(" ")[0],"YYYY-MM-DD"),i=e.periodStart.split(" ")[1].slice(0,5),o=e.periodEnd.split(" ")[1].slice(0,5);o==="00:00"&&(o="24:00",l.subtract(1,"days"));let r=[];for(;s.isSameOrBefore(l);)r.push(s.format("YYYY-MM-DD")),s.add(1,"days");r.forEach(u=>{a.push({date:u,startTime:i,endTime:o,periodStart:u+" "+i,periodEnd:u+" "+o,zoomLink:n.length>1&&e.zoomMeeting?e.zoomMeeting.joinUrl:"",lessonSpaceLink:n.length>1&&e.lessonSpace?e.lessonSpace:"",googleMeetLink:n.length>1&&e.googleMeetUrl?e.googleMeetUrl:"",microsoftTeamsLink:n.length>1&&e.microsoftTeamsUrl?e.microsoftTeamsUrl:""})})}),a}function Wc(n){let a={};return n.bookings.forEach(e=>{["approved","pending"].includes(e.status)&&e.ticketsData&&e.ticketsData.length&&e.ticketsData.forEach(s=>{s.eventTicketId in a||(a[s.eventTicketId]={persons:0,price:s.price,name:n.customTickets.find(l=>l.id===s.eventTicketId).name}),a[s.eventTicketId].persons=a[s.eventTicketId].persons+s.persons})}),a}function Hc(n,a){let e=n.getters["entities/getLocations"];if(a.locationId&&e.length){let s=e.find(l=>l.id===a.locationId);return typeof s<"u"?s:null}else if(a.customLocation)return{address:"",name:a.customLocation};return null}const Zc={class:"am-msd__item-wrapper"},Gc={class:"am-msd__item-inner"},Jc=m("div",{class:"am-msd__item-icon"},[m("span",{class:"am-icon-close"})],-1),Xc=["onClick"],Qc={class:"am-msd__item-inner"},Kc={class:"am-msd__item-icon"},eu={key:1,class:"am-msd__item-divider"},tu={class:"am-msd__item-inner"},au=m("div",{class:"am-msd__item-icon"},[m("span",{class:"am-icon-logout"})],-1),su={class:"am-msd__item-heading"},lu={props:{visibility:{type:Boolean,required:!0},customizedLabels:{type:Object,default:()=>({})},monitor:{type:String,required:!0},menuItems:{type:Array,required:!0},customCss:{type:Object,default:()=>{}},width:{type:Number,default:300},position:{type:String,default:"right",validator(n){return["right","left","top","bottom"].includes(n)}}},emits:["click","update:visibility","logout"],setup(n,{emit:a}){const e=n;let s=R("labels");const l=De();let i=_(()=>document?document.documentElement.dir==="rtl":!1);function o(f,v){a("click",{step:f,index:v}),a("update:visibility",!1)}function r(){a("update:visibility",!1)}function u(f){return Object.keys(e.customizedLabels).length&&e.customizedLabels[f]?e.customizedLabels[f]:s[f]}let d=_(()=>({"--am-mw-msd":`${e.width}px`}));return(f,v)=>(c(),U(za,{visibility:n.visibility,position:n.position,"custom-class":"am-msd","close-outside":!0,"custom-css":{...n.customCss,...t(d)},"onUpdate:visibility":v[1]||(v[1]=g=>t(a)("update:visibility",!1))},{footer:x(()=>[m("div",{class:"am-msd__item",onClick:v[0]||(v[0]=()=>t(a)("logout"))},[m("div",tu,[au,m("p",su,C(u("log_out")),1)])])]),default:x(()=>[m("div",Zc,[m("div",{class:"am-msd__item",onClick:r},[m("div",Gc,[$(ga,{name:"fade"},{default:x(()=>[m("p",{class:q(["am-msd__item-heading",{"am-rtl":t(i)}])},C(u("menu_title")),3)]),_:1}),$(ga,{name:"fade"},{default:x(()=>[Jc]),_:1})])]),(c(!0),y(ee,null,fe(n.menuItems,(g,k)=>(c(),y(ee,{key:g.key},[g.key!=="packages"||t(l).getters["entities/getPackages"].length?(c(),y("div",{key:0,class:q(["am-msd__item",{selected:n.monitor===g.key}]),onClick:N=>o(g,k)},[m("div",Qc,[m("div",Kc,[m("span",{class:q(`am-icon-${g.icon}`)},null,2)]),$(ga,{name:"fade"},{default:x(()=>[m("p",{class:q(["am-msd__item-heading",{"am-rtl":t(i)}])},C(g.label),3)]),_:2},1024),$(ga,{name:"fade"},{default:x(()=>[m("div",{class:q(["am-msd__item-indicator",{"am-rtl":t(i)}])},[m("span",{class:q(t(i)?"am-icon-arrow-big-left":"am-icon-arrow-big-right")},null,2)],2)]),_:1})])],10,Xc)):O("",!0),k===0?(c(),y("div",eu)):O("",!0)],64))),128))])]),_:1},8,["visibility","position","custom-css"]))}};const Yn={props:{size:{type:String,default:"default"}},setup(n){const a=n,e=Ol().cookies,s=R("settings");let l=R("cabinetType"),{bookingsCounterChanger:i}=R("bookingsCounterChanger",{bookingsCounterChanger:()=>{}});const o=De();let r=_({get:()=>o.getters["cabinet/getTimeZone"],set:b=>{o.commit("cabinet/setTimeZone",b||"")}}),u=_(()=>o.getters["appointment/getActive"]||o.getters["event/getActive"]||o.getters["attendee/getActive"]);const d=R("timeZone"),f=R("timeZones");let v=F("");function g(b){v.value=b.toLowerCase()}let k=_(()=>v.value?f.filter(b=>b.toLowerCase().includes(v.value)):f);function N(){let b;s.general.showClientTimeZone?b=Us():b=d.value,e.set("ameliaUserTimeZone",b,s.roles[l.value+"Cabinet"].tokenValidTime),i(),o.commit("cabinet/setTimeZone",b)}function E(b){e.set("ameliaUserTimeZone",b,s.roles[l.value+"Cabinet"].tokenValidTime),i()}return(b,A)=>t(u)?O("",!0):(c(),U(He,{key:0,modelValue:t(r),"onUpdate:modelValue":A[0]||(A[0]=S=>we(r)?r.value=S:r=S),filterable:!0,placeholder:t(Us)(),clearable:!0,size:t(a).size,"custom-class":"am-ctz","prefix-icon":"globe-watch","filter-method":g,onClear:N,onChange:E},{default:x(()=>[(c(!0),y(ee,null,fe(t(k),(S,P)=>(c(),U(qe,{key:P,label:S,value:S},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","size"]))}};function Do(){return"ameliaBooking"in window&&"cabinet"in window.ameliaBooking&&"disableAuthorizationHeader"in window.ameliaBooking.cabinet&&window.ameliaBooking.cabinet.disableAuthorizationHeader}function ze(n){let a=n.getters["auth/getToken"];return a&&!Do()?{headers:{Authorization:"Bearer "+a}}:{}}const nu={key:0,class:"el-skeleton-item-wrapper-title"},iu={name:"AuthSkeleton"},Wt=Object.assign(iu,{props:{centerFirst:{type:Boolean,default:!1},count:{type:Number,default:3},mainClass:{type:String,default:""}},setup(n){const a=n;return(e,s)=>{const l=Ml,i=Fl;return c(),U(i,{animated:"",class:q(["am-asi-el-skeleton",t(a).mainClass])},{template:x(()=>[t(a).centerFirst?(c(),y("div",nu,[$(l,{variant:"rect"})])):O("",!0),(c(!0),y(ee,null,fe(new Array(t(a).count),o=>(c(),y("div",{key:o,class:"el-skeleton-item-wrapper"},[$(l,{variant:"rect"})]))),128))]),_:1},8,["class"])}}});function ou(n,a){let e=Ba(Ba(Ba(window.location.href,"code"),"state"),"scope");Ne.post("/google/authorization/token",{authCode:n,userId:Sl(window.location.href).state,redirectUri:e}).then(()=>{history.pushState(null,null,e)}).catch(s=>{console.log(s)}).finally(()=>{a()})}function ru(n){n.getters["auth/getGoogleLoading"]||(n.commit("auth/setGoogleLoading",!0),Ne.get("/google/authorization/url/"+n.getters["employee/getId"],Object.assign({redirectUri:window.location.href.split("?")[0]},ze(n))).then(a=>{window.location.href=a.data.data.authUrl.replace(/redirect_uri=.+?&/,"redirect_uri="+window.location.href+"&")}).catch(a=>{console.log(a),n.commit("auth/setGoogleLoading",!1)}))}function cu(n){n.commit("auth/setGoogleLoading",!0),Ne.post("/google/disconnect/"+n.getters["employee/getId"]).then(()=>{n.commit("employee/setGoogleId",null),n.commit("employee/setGoogleCalendarId",""),n.commit("employee/setGoogleToken",null),n.commit("auth/setGoogleCalendars",[])}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setGoogleLoading",!1)})}function uu(n,a){let e=Ba(Ba(Ba(window.location.href,"code"),"state"),"type");Ne.post("/outlook/authorization/token",{authCode:n,userId:Sl(window.location.href).state.split("amelia-outlook-calendar-auth-")[1],redirectUri:window.location.href.split("?")[0]}).then(()=>{history.pushState({},null,e)}).catch(s=>{console.log(s)}).finally(()=>{a()})}function du(n){n.getters["auth/getOutlookLoading"]||(n.commit("auth/setOutlookLoading",!0),Ne.get("/outlook/authorization/url/"+n.getters["employee/getId"],Object.assign({redirectUri:window.location.href.split("?")[0]},ze(n))).then(a=>{window.location.href=a.data.data.authUrl.replace(/redirect_uri=.+?&/,"redirect_uri="+window.location.href+"&")}).catch(a=>{console.log(a),n.commit("auth/setGoogleLoading",!1)}))}function mu(n){n.commit("auth/setOutlookLoading",!0),Ne.post("/outlook/disconnect/"+n.getters["employee/getId"]).then(()=>{n.commit("employee/setOutlookId",""),n.commit("employee/setOutlookCalendarId",""),n.commit("employee/setOutlookToken",null),n.commit("auth/setOutlookCalendars",[])}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setOutlookLoading",!1)})}function pu(n){n.commit("auth/setZoomLoading",!0),Ne.get("/zoom/users",Object.assign(ze(n),{params:{source:"cabinet-provider"}})).then(a=>{"data"in a.data&&"users"in a.data.data&&n.commit("auth/setZoomUsers",a.data.data?.users?a.data.data.users:[])}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setZoomLoading",!1)})}function gu(n){n.commit("auth/setStripeLoading",!0),Ne.get("/stripe/accounts/"+n.getters["employee/getId"],Object.assign({},ze(n))).then(a=>{a.data.data.account&&(n.commit("auth/setStripeProvider",a.data.data.account),n.getters["employee/getStripeConnect"]||n.commit("employee/setStripeConnect",{id:a.data.data.account.id,amount:null}))}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function fu(n,a){n.commit("auth/setStripeLoading",!0),Ne.post("/stripe/onboard/"+n.getters["auth/getProfile"].id,Object.assign({returnUrl:window.location.href,accountType:a},ze(n))).then(e=>{window.location.href=e.data.data.url}).catch(e=>{n.commit("auth/setStripeLoading",!1),console.log("response"in e&&"data"in e.response&&"message"in e.response.data?e.response.data.message:e.message)})}function hu(n){n.commit("auth/setStripeLoading",!0),Ne.post("/stripe/disconnect/"+n.getters["auth/getProfile"].id,ze(n)).then(()=>{n.commit("auth/setStripeProvider",{id:"",email:"",type:"",completed:!1}),n.commit("employee/setStripeConnect",null)}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function vu(n){let a=n.getters["auth/getStripeProvider"];n.commit("auth/setStripeLoading",!0),a.type==="standard"?(window.open("https://dashboard.stripe.com/"+a.id,"_blank"),n.commit("auth/setStripeLoading",!1)):a.type==="express"&&Ne.post("/stripe/dashboard/"+n.getters["auth/getProfile"].id,ze(n)).then(e=>{e.data.data.url&&window.open(e.data.data.url,"_blank")}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}let xa=F(!1);function Wn(n){n.commit("auth/setAppleLoading",!0),Ne.get("/apple/calendar-list/"+n.getters["employee/getId"],ze(n)).then(a=>{n.commit("auth/setAppleCalendars",a.data.data?.calendarList?a.data.data.calendarList:[]),n.getters["auth/getAppleCalendars"].map(e=>e.id).indexOf(n.getters["employee/getAppleCalendarId"])===-1&&n.commit("employee/setAppleCalendarId",""),n.commit("employee/setAppleCalendarId",a.data.data?.appleCalendarId),xa.value=a.data.data.isEmployeeConnectedToPersonalAppleCalendar}).catch(a=>{console.log(a)}).finally(()=>{n.commit("auth/setAppleLoading",!1)})}const _u={class:"am-asi__top"},yu={class:"am-asi__header"},bu={class:"am-asi__text"},ku={key:0},Cu={class:"am-asi__social-wrapper"},xu={class:"am-asi__social-divider"},wu={class:"par-sm"},Tu={class:"am-asi__footer"},Su={class:"am-asi__footer-text"},Eu={key:1,id:"am-recaptcha",class:"am-recaptcha-holder"},Lu={name:"AuthSignIn"},Au=Object.assign(Lu,{setup(n){let a=R("licence"),e=De();const s=Ol().cookies,l=R("settings");let i=R("amCustomize");const o=R("labels"),r=R("localLanguage");let u=_(()=>l.general.usedLanguages.includes(r.value)),d=_(()=>{let M=Qe({...o}),Z=i.value.signIn.translations;return Z&&Object.keys(Z).forEach(W=>{Z[W][r.value]&&u.value?M[W]=Z[W][r.value]:Z[W].default&&(M[W]=Z[W].default)}),M}),f={components:{IconComponent:We},template:'<IconComponent icon="email"></IconComponent>'},v={components:{IconComponent:We},template:'<IconComponent icon="password"></IconComponent>'},g=F("");const k=Fr.factory(Ne,Vr);function N({provider:M,credentials:Z}){e.commit("setLoading",!0);const W=`/users/authentication/${M}`,le={};g=M,le.cabinetType=z.value,M==="facebook"&&(le.redirectUri=k.options.providers[M].redirectUri,k.options.providers[M].url=`${W}`,e.commit("setLoading",!1),k.authenticate(M,le).then(de=>{L.value.email=de.data.data.user.email,E(de)}).catch(de=>{k.isAuthenticated()||(se.value=!0,j.value="User is not authenticated.",e.commit("setLoading",!1)),de.response?.data&&(se.value=!0,j.value=de.response.data.message),e.commit("setLoading",!1)})),M==="google"&&(le.code=Z,Ne.post(`${W}`,le).then(de=>{L.value.email=de.data.data.user.email,E(de)}).catch(de=>{if(!("data"in de.response.data)&&"message"in de.response.data){se.value=!0,j.value=de.response.data.message;return}"invalid_credentials"in de.response.data.data&&(se.value=!0,j.value=d.value.invalid_credentials)}).finally(()=>{e.commit("setLoading",!1)}))}function E(M){"token"in M.data.data&&(s.set("ameliaToken",M.data.data.token,l.roles[z.value+"Cabinet"].tokenValidTime,null,null,!0),s.set("ameliaUserEmail",M.data.data.user.email,l.roles[z.value+"Cabinet"].tokenValidTime,null,null,!0),e.commit("auth/setToken",M.data.data.token)),"user"in M.data.data&&M.data.data.user.type==="provider"&&te(M),e.commit("auth/setProfile",M.data.data.user),M.data.data.user.timeZone&&e.commit("cabinet/setTimeZone",M.data.data.user.timeZone),e.commit("auth/setAuthenticated",!0);let Z=z.value==="customer"?l.roles.customerCabinet.tokenValidTime*1e3:l.roles.providerCabinet.tokenValidTime*1e3;Z>0&&Z<18144e5&&setTimeout(()=>{e.dispatch("auth/logout")},Z)}let b=F(null),A=F(!1),S=F(null);function P(){A.value=!1,se.value=!0,j.value=d.value.recaptcha_invalid_error}function h(M){A.value=!0,S.value=M,l.general.googleRecaptcha.invisible&&K()}let I=F(null),L=F({email:_({get:()=>e.getters["auth/getEmail"],set:M=>{e.commit("auth/setEmail",M||"")}}),password:_({get:()=>e.getters["auth/getPassword"],set:M=>{e.commit("auth/setPassword",M||"")}})}),T=F({email:[{required:!0,message:d.value.enter_email_or_username_warning,trigger:"submit"}],password:[{required:!0,message:d.value.enter_password_warning,trigger:"submit"}]}),w=F({email:{template:Ye.text,props:{itemName:"email",label:d.value.email_or_username,prefixIcon:Ge(f),placeholder:"",class:"am-asi__item"}},password:{template:Ye.text,props:{itemName:"password",itemType:"password",showPassword:!0,label:d.value.password,prefixIcon:Ge(v),placeholder:"",class:"am-asi__item"}}}),B=R("pageKey"),z=R("cabinetType"),D=_(()=>e.getters.getLoading),G=_(()=>e.getters["auth/getProfileDeleted"]),se=F(!1),j=F("");function ne(M,Z){let W=Ni("token");M?oe(M,!1,!1,!1):W?oe(W,!0,!1,Z):oe("",!1,!0,!1)}function te(M){let Z={id:M.data.data.user.id,firstName:M.data.data.user.firstName,lastName:M.data.data.user.lastName,email:M.data.data.user.email,phone:M.data.data.user.phone,countryPhoneIso:M.data.data.user.countryPhoneIso,googleCalendar:{id:"id"in M.data.data.user.googleCalendar?M.data.data.user.googleCalendar.id:null,calendarId:M.data.data.user.googleCalendar.calendarId?M.data.data.user.googleCalendar.calendarId:"",token:"token"in M.data.data.user.googleCalendar?M.data.data.user.googleCalendar.token:null},outlookCalendar:{id:"id"in M.data.data.user.outlookCalendar?M.data.data.user.outlookCalendar.id:null,calendarId:M.data.data.user.outlookCalendar.calendarId?M.data.data.user.outlookCalendar.calendarId:"",token:"token"in M.data.data.user.outlookCalendar?M.data.data.user.outlookCalendar.token:null},appleCalendarId:M.data.data.user.appleCalendarId?M.data.data.user.appleCalendarId:"",stripeConnect:M.data.data.user.stripeConnect,zoomUserId:M.data.data.user.zoomUserId?M.data.data.user.zoomUserId:"",locationId:M.data.data.user.locationId,pictureFullPath:M.data.data.user.pictureFullPath,pictureThumbPath:M.data.data.user.pictureThumbPath,description:M.data.data.user.description,weekDayList:M.data.data.user.weekDayList,specialDayList:M.data.data.user.specialDayList,dayOffList:M.data.data.user.dayOffList,serviceList:M.data.data.user.serviceList};Z.serviceList.forEach(W=>{Rr(W)}),e.getters["entities/getReady"]&&(e.commit("entities/setEmployees",[JSON.parse(JSON.stringify(Z))]),Z.serviceList=xo(e,Z.serviceList)),e.commit("employee/setEmployee",qr(e,Z)),e.commit("auth/setOutlookCalendars",M.data.data.user.outlookCalendar?.calendarList?M.data.data.user.outlookCalendar.calendarList:[]),e.commit("auth/setGoogleCalendars",M.data.data.user.googleCalendar?.calendarList?M.data.data.user.googleCalendar.calendarList:[]),l.appleCalendar&&!a.isLite&&!a.isStarter&&Wn(e),l.payments.stripe.enabled&&l.payments.stripe.connect.enabled&&!a.isLite&&!a.isStarter&&!a.isBasic&&gu(e),l.zoom.enabled&&!a.isLite&&!a.isStarter&&pu(e)}function oe(M,Z,W,le){let de={cabinetType:z.value,changePass:le};S.value!==null&&(de.recaptcha=S.value),W&&(de.checkIfWpUser=!0);let ae=e.getters["auth/getPassword"],xe=e.getters["auth/getEmail"];!M&&ae&&xe&&(de.password=ae,de.email=xe),Z&&(de.token=M),Ne.post("/users/authenticate",de,M!==null&&!Do()?{headers:{Authorization:"Bearer "+M}}:{}).then(ye=>{if("authentication_required"in ye.data.data){l.roles[z.value+"Cabinet"].loginEnabled||(B.value="sendAccessLink");return}"token"in ye.data.data&&(s.set("ameliaToken",ye.data.data.token,l.roles[z.value+"Cabinet"].tokenValidTime,null,null,!0),s.set("ameliaUserEmail",ye.data.data.user.email,l.roles[z.value+"Cabinet"].tokenValidTime,null,null,!0),e.commit("auth/setToken",ye.data.data.token)),"user"in ye.data.data&&ye.data.data.user.type==="provider"&&te(ye),Ni("token")&&window.history.replaceState(null,null,Ba(window.location.href,"token")),e.commit("auth/setProfile",ye.data.data.user),!ye.data.data.user.countryPhoneIso&&l.general.phoneDefaultCountryCode&&l.general.phoneDefaultCountryCode!=="auto"&&e.commit("auth/setProfileCountryPhoneIso",l.general.phoneDefaultCountryCode),ye.data.data.user.timeZone&&e.commit("cabinet/setTimeZone",ye.data.data.user.timeZone),"set_password"in ye.data.data&&ye.data.data.set_password||"change_password"in ye.data.data&&ye.data.data.change_password?B.value="setPassword":e.commit("auth/setAuthenticated",!0);let pe=z.value==="customer"?l.roles.customerCabinet.tokenValidTime*1e3:l.roles.providerCabinet.tokenValidTime*1e3;pe>0&&pe<18144e5&&setTimeout(()=>{e.dispatch("auth/logout")},pe)}).catch(ye=>{if(!("data"in ye.response.data)&&"message"in ye.response.data){se.value=!0,j.value=ye.response.data.message;return}"invalid_credentials"in ye.response.data.data&&(se.value=!0,j.value=d.value.invalid_credentials),"recaptcha_error"in ye.response.data.data&&(se.value=!0,j.value=d.value.recaptcha_error)}).finally(()=>{e.commit("setLoading",!1)})}function ie(){I.value.validate(M=>{if(M)if(l.general.googleRecaptcha.enabled&&l.roles[z.value+"Cabinet"].googleRecaptcha)if(l.general.googleRecaptcha.invisible)b.value.execute();else if(A.value)K();else return se.value=!0,j.value=d.value.recaptcha_error,!1;else K();else return!1})}function K(){e.commit("setLoading",!0),oe(null,!1,!1,!1)}function me(){ne(s.get("ameliaToken"),"changePass"in Sl(window.location.href))}Zs(()=>{e.commit("setLoading",!0)}),Je(()=>{if(e.getters["auth/getLoggedOut"])l.roles[z.value+"Cabinet"].loginEnabled||(B.value="sendAccessLink"),e.commit("setLoading",!1);else{let M=Sl(window.location.href);l.googleCalendar.enabled&&z.value==="provider"&&M&&M.code&&M.scope?ou(M.code,me):l.outlookCalendar.enabled&&z.value==="provider"&&M&&M.code&&M.state?uu(M.code,me):me()}});let Ae=R("containerWidth"),Ve=_(()=>st(Ae.value)),Q=R("amFonts"),_e=R("amColors"),X=_(()=>({"--am-c-primary":_e.value.colorPrimary,"--am-c-success":_e.value.colorSuccess,"--am-c-error":_e.value.colorError,"--am-c-warning":_e.value.colorWarning,"--am-c-main-bgr":_e.value.colorMainBgr,"--am-c-main-heading-text":_e.value.colorMainHeadingText,"--am-c-main-text":_e.value.colorMainText,"--am-c-main-text-op70":H(_e.value.colorMainText,.7),"--am-c-main-text-op60":H(_e.value.colorMainText,.6),"--am-c-main-text-op40":H(_e.value.colorMainText,.4),"--am-c-main-text-op25":H(_e.value.colorMainText,.25),"--am-c-inp-bgr":_e.value.colorInpBgr,"--am-c-inp-border":_e.value.colorInpBorder,"--am-c-inp-text":_e.value.colorInpText,"--am-c-inp-placeholder":_e.value.colorInpPlaceHolder,"--am-c-btn-prim":_e.value.colorBtnPrim,"--am-c-btn-prim-text":_e.value.colorBtnPrimText,"--am-c-skeleton-op20":H(_e.value.colorMainText,.2),"--am-c-skeleton-op60":H(_e.value.colorMainText,.6),"--am-font-family":Q.value.fontFamily,"--am-c-scroll-op30":H(_e.value.colorPrimary,.3),"--am-c-scroll-op10":H(_e.value.colorPrimary,.1)}));return(M,Z)=>{const W=et;return t(D)?(c(),U(t(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi-sign-in am-asi"})):(c(),y("div",{key:0,class:"am-asi",style:be(t(X))},[m("div",_u,[t(G)?(c(),U(_t,{key:0,class:"am-asi__top-message am-asi__top-message-success",type:"success",title:t(d).profile_deleted,description:"","show-icon":!0,closable:!0,onClose:Z[0]||(Z[0]=le=>t(e).commit("auth/setProfileDeleted",!1))},null,8,["title"])):O("",!0),t(se)?(c(),U(_t,{key:1,class:"am-asi__top-message am-asi__top-message-error",type:"error",title:t(j),description:"","show-icon":!0,closable:!0,onClose:Z[1]||(Z[1]=le=>t(e).commit("auth/setProfileDeleted",!1))},null,8,["title"])):O("",!0),m("div",yu,C(t(d).welcome_back),1),m("div",bu,C(t(d).enter_credentials),1)]),t(at).socialLogin.googleLoginEnabled&&t(at).general.googleClientId||t(at).socialLogin.facebookLoginEnabled&&t(at).socialLogin.facebookCredentialsEnabled?(c(),y("div",ku,[m("div",Cu,[$(Br,{provider:t(g),onSocialAction:N},null,8,["provider"])]),m("div",xu,[m("span",wu,C(t(d).or_enter_details_below),1)])])):O("",!0),$(W,{ref_key:"authFormRef",ref:I,model:t(L),rules:t(T),"label-position":"top",class:q(["am-asi__form",t(Ve)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(w),(le,de)=>(c(),U(pt(le.template),Lt({key:de,ref_for:!0,ref:"customerCollectorRef",modelValue:t(L)[de],"onUpdate:modelValue":ae=>t(L)[de]=ae},le.props,{onEnter:ie}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),$(Se,{class:"am-asi__btn",type:t(i).signIn.options.signInBtn.buttonType,onClick:ie},{default:x(()=>[ce(C(t(d).sign_in),1)]),_:1},8,["type"]),m("div",Tu,[m("span",Su,C(t(d).forgot_your_password),1),m("span",{class:"am-asi__footer-link",onClick:Z[2]||(Z[2]=le=>we(B)?B.value="sendAccessLink":B="sendAccessLink")},C(t(d).reset_password),1)]),t(l).general.googleRecaptcha.enabled&&t(l).roles[t(z)+"Cabinet"].googleRecaptcha?(c(),y("div",Eu,[$(t(Co),{ref_key:"recaptchaRef",ref:b,size:t(l).general.googleRecaptcha.invisible?"invisible":null,"load-recaptcha-script":!0,sitekey:t(l).general.googleRecaptcha.siteKey,onVerify:h,onExpired:P},null,8,["size","sitekey"])])):O("",!0)],4))}}});const Iu={class:"am-asi__top"},$u={class:"am-asi__header"},Pu={class:"am-asi__text"},Du={key:0,class:"am-asi__footer"},Nu={key:1,id:"am-recaptcha",class:"am-recaptcha-holder"},Ou={name:"AuthReset"},Mu=Object.assign(Ou,{setup(n){let a=De();const e=R("settings");let s=R("amCustomize");const l=R("labels"),i=R("localLanguage");let o=_(()=>e.general.usedLanguages.includes(i.value)),r=_(()=>{let se=Qe({...l}),j=s.value.accessLink.translations;return j&&Object.keys(j).forEach(ne=>{j[ne][i.value]&&o.value?se[ne]=j[ne][i.value]:j[ne].default&&(se[ne]=j[ne].default)}),se}),u=F(!1),d=F(""),f=F(null),v=F(!1),g=F(null);function k(){v.value=!1,u.value=!0,d.value=r.value.recaptcha_invalid_error}function N(se){v.value=!0,g.value=se,e.general.googleRecaptcha.invisible&&T()}let E=F(null),b=F({email:_({get:()=>a.getters["auth/getEmail"],set:se=>{a.commit("auth/setEmail",se||"")}})}),A=F({email:[{required:!0,message:r.value.enter_email_warning,trigger:"submit"}]}),S=F({email:{template:Ye.text,props:{itemName:"email",itemType:"email",label:r.value.email,placeholder:"",class:"am-asi__item"}}}),P=R("pageKey"),h=R("cabinetType"),I=_(()=>a.getters.getLoading);function L(){E.value.validate(se=>{if(se)if(e.general.googleRecaptcha.enabled&&e.roles[h.value+"Cabinet"].googleRecaptcha)if(e.general.googleRecaptcha.invisible)f.value.execute();else if(v.value)T();else return u.value=!0,d.value=r.value.recaptcha_error,!1;else T();else return!1})}function T(){a.commit("setLoading",!0);let se={email:a.getters["auth/getEmail"],locale:window.localeLanguage[0],cabinetType:h.value};g.value!==null&&(se.recaptcha=g.value),Ne.post("/users/customers/reauthorize",se).then(()=>{P.value="sendAccessLinkProcess"}).catch(()=>{}).finally(()=>{a.commit("setLoading",!1)})}let w=R("containerWidth"),B=_(()=>st(w.value)),z=R("amFonts"),D=R("amColors"),G=_(()=>({"--am-c-primary":D.value.colorPrimary,"--am-c-success":D.value.colorSuccess,"--am-c-error":D.value.colorError,"--am-c-warning":D.value.colorWarning,"--am-c-main-bgr":D.value.colorMainBgr,"--am-c-main-heading-text":D.value.colorMainHeadingText,"--am-c-main-text":D.value.colorMainText,"--am-c-main-text-op70":H(D.value.colorMainText,.7),"--am-c-main-text-op60":H(D.value.colorMainText,.6),"--am-c-main-text-op40":H(D.value.colorMainText,.4),"--am-c-main-text-op25":H(D.value.colorMainText,.25),"--am-c-inp-bgr":D.value.colorInpBgr,"--am-c-inp-border":D.value.colorInpBorder,"--am-c-inp-text":D.value.colorInpText,"--am-c-inp-placeholder":D.value.colorInpPlaceHolder,"--am-c-btn-prim":D.value.colorBtnPrim,"--am-c-btn-prim-text":D.value.colorBtnPrimText,"--am-c-skeleton-op20":H(D.value.colorMainText,.2),"--am-c-skeleton-op60":H(D.value.colorMainText,.6),"--am-font-family":z.value.fontFamily,"--am-c-scroll-op30":H(D.value.colorPrimary,.3),"--am-c-scroll-op10":H(D.value.colorPrimary,.1)}));return(se,j)=>{const ne=et;return t(I)?(c(),U(t(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi"})):(c(),y("div",{key:0,class:"am-asi",style:be(t(G))},[m("div",Iu,[t(u)?(c(),U(_t,{key:0,class:"am-asi__top-message am-asi__top-message-error",type:"error",title:t(d),description:"","show-icon":!0,closable:!0},null,8,["title"])):O("",!0),m("div",$u,C(t(r).access_link_send),1),m("div",Pu,C(t(r).access_link_send_description),1)]),$(ne,{ref_key:"authFormRef",ref:E,model:t(b),rules:t(A),"label-position":"top",class:q(["am-asi__form",t(B)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(S),(te,oe)=>(c(),U(pt(te.template),Lt({key:oe,ref_for:!0,ref:"customerCollectorRef",modelValue:t(b)[oe],"onUpdate:modelValue":ie=>t(b)[oe]=ie},te.props,{onEnter:L}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),$(Se,{class:"am-asi__btn",type:t(s).accessLink.options.sendBtn.buttonType,onClick:L},{default:x(()=>[ce(C(t(r).send),1)]),_:1},8,["type"]),t(e).roles[t(h)+"Cabinet"].loginEnabled?(c(),y("div",Du,[m("span",{class:"am-asi__footer-link",onClick:j[0]||(j[0]=te=>we(P)?P.value="signIn":P="signIn")},C(t(r).sign_in),1)])):O("",!0),t(e).general.googleRecaptcha.enabled&&t(e).roles[t(h)+"Cabinet"].googleRecaptcha?(c(),y("div",Nu,[$(t(Co),{ref_key:"recaptchaRef",ref:f,size:t(e).general.googleRecaptcha.invisible?"invisible":null,"load-recaptcha-script":!0,sitekey:t(e).general.googleRecaptcha.siteKey,onVerify:N,onExpired:k},null,8,["size","sitekey"])])):O("",!0)],4))}}});const Fu={class:"am-asi__top"},Vu={class:"am-asi__header"},Bu={class:"am-asi__text"},Ru={class:"am-asi__email"},qu={class:"am-asi__footer"},Uu={class:"am-asi__footer-text"},zu={name:"AuthResetProcess"},ju=Object.assign(zu,{setup(n){let a=De();const e=R("settings");let s=R("amCustomize");const l=R("labels"),i=R("localLanguage");let o=_(()=>e.general.usedLanguages.includes(i.value)),r=_(()=>{let k=Qe({...l}),N=s.value.accessLinkSuccess.translations;return N&&Object.keys(N).forEach(E=>{N[E][i.value]&&o.value?k[E]=N[E][i.value]:N[E].default&&(k[E]=N[E].default)}),k}),u=_(()=>a.getters["auth/getEmail"]),d=R("pageKey"),f=R("amFonts"),v=R("amColors"),g=_(()=>({"--am-c-primary":v.value.colorPrimary,"--am-c-success":v.value.colorSuccess,"--am-c-error":v.value.colorError,"--am-c-warning":v.value.colorWarning,"--am-c-main-bgr":v.value.colorMainBgr,"--am-c-main-heading-text":v.value.colorMainHeadingText,"--am-c-main-text":v.value.colorMainText,"--am-c-main-text-op70":H(v.value.colorMainText,.7),"--am-c-main-text-op60":H(v.value.colorMainText,.6),"--am-c-main-text-op40":H(v.value.colorMainText,.4),"--am-c-main-text-op25":H(v.value.colorMainText,.25),"--am-c-inp-bgr":v.value.colorInpBgr,"--am-c-inp-border":v.value.colorInpBorder,"--am-c-inp-text":v.value.colorInpText,"--am-c-inp-placeholder":v.value.colorInpPlaceHolder,"--am-c-btn-prim":v.value.colorBtnPrim,"--am-c-btn-prim-text":v.value.colorBtnPrimText,"--am-c-skeleton-op20":H(v.value.colorMainText,.2),"--am-c-skeleton-op60":H(v.value.colorMainText,.6),"--am-font-family":f.value.fontFamily,"--am-c-scroll-op30":H(v.value.colorPrimary,.3),"--am-c-scroll-op10":H(v.value.colorPrimary,.1)}));return(k,N)=>(c(),y("div",{class:"am-asi",style:be(t(g))},[m("div",Fu,[m("div",Vu,C(t(r).access_link_send_check),1),m("div",Bu,C(t(r).access_link_send_click),1),m("div",Ru,C(t(u)),1)]),m("div",qu,[m("span",Uu,C(t(r).access_link_send_inbox),1),m("span",{class:"am-asi__footer-link",onClick:N[0]||(N[0]=E=>we(d)?d.value="sendAccessLink":d="sendAccessLink")},C(t(r).access_link_send_retry),1)])],4))}});const Yu={class:"am-asi__top"},Wu={class:"am-asi__header"},Hu={class:"am-asi__text"},Zu={name:"AuthNewPass"},Gu=Object.assign(Zu,{setup(n){let a=De();const e=R("settings");let s=R("amCustomize");const l=R("labels"),i=R("localLanguage");let o=_(()=>e.general.usedLanguages.includes(i.value)),r=_(()=>{let h=Qe({...l}),I=s.value.setPass.translations;return I&&Object.keys(I).forEach(L=>{I[L][i.value]&&o.value?h[L]=I[L][i.value]:I[L].default&&(h[L]=I[L].default)}),h}),u=F(null),d=F({newPassword:_({get:()=>a.getters["auth/getNewPassword"],set:h=>{a.commit("auth/setNewPassword",h||"")}}),confirmPassword:_({get:()=>a.getters["auth/getConfirmPassword"],set:h=>{a.commit("auth/setConfirmPassword",h||"")}})}),f=F({newPassword:[{required:!0,message:r.value.new_password_required,trigger:"submit"},{min:4,message:r.value.new_password_length,trigger:"submit"}],confirmPassword:[{required:!0,message:r.value.new_password_required,trigger:"submit"},{min:4,message:r.value.new_password_length,trigger:"submit"},{validator:()=>a.getters["auth/getNewPassword"]===a.getters["auth/getConfirmPassword"],message:r.value.passwords_not_match,trigger:"submit"}]}),v=F({newPassword:{template:Ye.text,props:{itemName:"newPassword",itemType:"password",showPassword:!0,label:r.value.new_password_colon,placeholder:"",minLength:3,class:"am-asi__item"}},confirmPassword:{template:Ye.text,props:{itemName:"confirmPassword",itemType:"password",showPassword:!0,label:r.value.new_password_colon_retype,placeholder:"",minLength:3,class:"am-asi__item"}}}),g=R("cabinetType"),k=_(()=>a.getters.getLoading);function N(){u.value.validate(h=>{if(h&&a.getters["auth/getNewPassword"]===a.getters["auth/getConfirmPassword"]){let I=a.getters["auth/getProfile"];a.commit("setLoading",!0),Ne.post("/users/"+g.value+"s/"+I.id,{password:a.getters["auth/getNewPassword"]},Object.assign(ze(a),{params:{source:"cabinet-"+g.value}})).then(()=>{a.commit("auth/setAuthenticated",!0)}).catch(()=>{}).finally(()=>{a.commit("setLoading",!1)})}else return!1})}let E=R("containerWidth"),b=_(()=>st(E.value)),A=R("amFonts"),S=R("amColors"),P=_(()=>({"--am-c-primary":S.value.colorPrimary,"--am-c-success":S.value.colorSuccess,"--am-c-error":S.value.colorError,"--am-c-warning":S.value.colorWarning,"--am-c-main-bgr":S.value.colorMainBgr,"--am-c-main-heading-text":S.value.colorMainHeadingText,"--am-c-main-text":S.value.colorMainText,"--am-c-main-text-op70":H(S.value.colorMainText,.7),"--am-c-main-text-op60":H(S.value.colorMainText,.6),"--am-c-main-text-op40":H(S.value.colorMainText,.4),"--am-c-main-text-op25":H(S.value.colorMainText,.25),"--am-c-inp-bgr":S.value.colorInpBgr,"--am-c-inp-border":S.value.colorInpBorder,"--am-c-inp-text":S.value.colorInpText,"--am-c-inp-placeholder":S.value.colorInpPlaceHolder,"--am-c-btn-prim":S.value.colorBtnPrim,"--am-c-btn-prim-text":S.value.colorBtnPrimText,"--am-c-skeleton-op20":H(S.value.colorMainText,.2),"--am-c-skeleton-op60":H(S.value.colorMainText,.6),"--am-font-family":A.value.fontFamily,"--am-c-scroll-op30":H(S.value.colorPrimary,.3),"--am-c-scroll-op10":H(S.value.colorPrimary,.1)}));return(h,I)=>{const L=et;return t(k)?(c(),U(t(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi"})):(c(),y("div",{key:0,class:"am-asi",style:be(t(P))},[m("div",Yu,[m("div",Wu,C(t(r).new_password_set),1),m("div",Hu,C(t(r).new_password_set_description),1)]),$(L,{ref_key:"authFormRef",ref:u,model:t(d),rules:t(f),"label-position":"top",class:q(["am-asi__form",t(b)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(v),(T,w)=>(c(),U(pt(T.template),Lt({key:w,ref_for:!0,ref:"customerCollectorRef",modelValue:t(d)[w],"onUpdate:modelValue":B=>t(d)[w]=B},T.props,{onEnter:N}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),$(Se,{class:"am-asi__btn",type:t(s).setPass.options.newPassBtn.buttonType,onClick:N},{default:x(()=>[ce(C(t(r).new_password_set_action),1)]),_:1},8,["type"])],4))}}});const Ju={class:"am-asi__top"},Xu=m("div",{class:"am-asi__img"},[m("span",{class:"am-icon-check"})],-1),Qu={class:"am-asi__header"},Ku={class:"am-asi__text"},ed={name:"ChangePassSuccess"},td=Object.assign(ed,{setup(n){const a=R("settings");let e=R("amCustomize");const s=R("labels"),l=R("localLanguage");let i=_(()=>a.general.usedLanguages.includes(l.value)),o=_(()=>{let v=Qe({...s}),g=e.value.setPassSuccess.translations;return g&&Object.keys(g).forEach(k=>{g[k][l.value]&&i.value?v[k]=g[k][l.value]:g[k].default&&(v[k]=g[k].default)}),v}),r=R("pageKey"),u=R("amFonts"),d=R("amColors"),f=_(()=>({"--am-c-primary":d.value.colorPrimary,"--am-c-success":d.value.colorSuccess,"--am-c-error":d.value.colorError,"--am-c-warning":d.value.colorWarning,"--am-c-main-bgr":d.value.colorMainBgr,"--am-c-main-heading-text":d.value.colorMainHeadingText,"--am-c-main-text":d.value.colorMainText,"--am-c-main-text-op70":H(d.value.colorMainText,.7),"--am-c-main-text-op60":H(d.value.colorMainText,.6),"--am-c-main-text-op40":H(d.value.colorMainText,.4),"--am-c-main-text-op25":H(d.value.colorMainText,.25),"--am-c-btn-prim":d.value.colorBtnPrim,"--am-c-btn-prim-text":d.value.colorBtnPrimText,"--am-c-skeleton-op20":H(d.value.colorMainText,.2),"--am-c-skeleton-op60":H(d.value.colorMainText,.6),"--am-font-family":u.value.fontFamily,"--am-c-scroll-op30":H(d.value.colorPrimary,.3),"--am-c-scroll-op10":H(d.value.colorPrimary,.1)}));return(v,g)=>(c(),y("div",{class:"am-asi",style:be(t(f))},[m("div",Ju,[Xu,m("div",Qu,C(t(o).new_password_changed),1),m("div",Ku,C(t(o).new_password_changed_description),1)]),$(Se,{class:"am-asi__btn",type:t(e).setPassSuccess.options.signInBtn.buttonType,onClick:g[0]||(g[0]=k=>we(r)?r.value="signIn":r="signIn")},{default:x(()=>[ce(C(t(o).sign_in),1)]),_:1},8,["type"])],4))}}),ad={name:"AuthWrapper"},sd=Object.assign(ad,{setup(n){const a=R("settings");let e=F({signIn:Ge(Au),sendAccessLink:Ge(Mu),sendAccessLinkProcess:Ge(ju),setPassword:Ge(Gu),changeSuccess:Ge(td)}),s=R("originKey"),l=F("signIn");Be("pageKey",l);const i=F(a.customizedData?a.customizedData.fonts:El.fonts);Be("amFonts",i);let o=_(()=>a.customizedData&&s.value in a.customizedData?a.customizedData[s.value].colors:El[s.value].colors);return Be("amColors",o),(r,u)=>(c(),U(pt(t(e)[t(l)])))}});const ld={class:"am-csd__inner"},nd={class:"am-csd__header"},id={class:"am-csd__header-text"},od={class:"am-csd__content"},rd={class:"am-csd__footer"},cd={name:"DeleteProfile"},ud=Object.assign(cd,{props:{visibility:{type:Boolean,required:!0},customizedLabels:{type:Object,default:()=>({})},customizedOptions:{type:Object,default:()=>({})}},emits:["close","deleteProfile"],setup(n,{emit:a}){const e=n;let s=R("containerWidth");const l=R("labels");function i(d){return Object.keys(e.customizedLabels).length&&e.customizedLabels[d]?e.customizedLabels[d]:l[d]}let o=R("amFonts"),r=R("amColors"),u=_(()=>({"--am-c-csd-text":r.value.colorMainText,"--am-c-csd-bgr":r.value.colorMainBgr,"--am-c-csd-text-op10":H(r.value.colorMainText,.1),"--am-font-family":o.value.fontFamily}));return(d,f)=>(c(),U(za,{visibility:t(e).visibility,"custom-class":"am-csd am-csd__cancel",style:be(t(u)),position:"center"},{footer:x(()=>[m("div",rd,[$(Se,{category:"secondary",size:t(s)<=360?"small":"default",type:t(e).customizedOptions.closeBtn.buttonType,onClick:f[1]||(f[1]=()=>{a("close")})},{default:x(()=>[ce(C(i("close")),1)]),_:1},8,["size","type"]),$(Se,{category:"danger",size:t(s)<=360?"small":"default","loading-icon":"loading",type:t(e).customizedOptions.confirmBtn.buttonType,onClick:f[2]||(f[2]=()=>{a("deleteProfile")})},{default:x(()=>[ce(C(i("delete")),1)]),_:1},8,["size","type"])])]),default:x(()=>[m("div",ld,[m("div",nd,[m("div",id,C(i("delete_profile")),1),m("div",{class:"am-csd__header-btn",onClick:f[0]||(f[0]=()=>{a("close")})},[$(We,{icon:"close"})])]),m("div",od,[m("p",null,C(i("delete_profile_description")),1)])])]),_:1},8,["visibility","style"]))}});const wl={props:{pageWidth:{type:Number,default:768},count:{type:[Number,String],default:2},itemDirection:{type:String,default:"row",validator(n){return["row","row-reverse","column","column-reverse","initial","revert","unset"].includes(n)}}},setup(n){const a=n;let e=_(()=>st(a.pageWidth)),s=R("amColors"),l=_(()=>({"--am-c-skeleton-op20":H(s.value.colorMainText,.2),"--am-c-skeleton-op60":H(s.value.colorMainText,.6),"--am-c-flex-direction":a.itemDirection}));return(i,o)=>{const r=Ml,u=Fl;return c(),U(u,{animated:"",class:"am-cps",style:be(t(l))},{template:x(()=>[(c(!0),y(ee,null,fe(new Array(t(a).count),d=>(c(),y("div",{key:d,class:q(["am-cps__item",t(e)])},[$(r,{class:"am-cps__item-label",variant:"rect"}),$(r,{class:"am-cps__item-input",variant:"rect"})],2))),128))]),_:1},8,["style"])}}};const dd={class:"am-capi__inner"},md=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),pd={name:"CabinetProfile",key:"profile"},gd=Object.assign(pd,{setup(n){let a=De(),e=_(()=>a.getters.getLoading),s=F(null),l=F(0),i=R("sidebarCollapsed");window.addEventListener("resize",o);function o(){s.value&&(l.value=s.value.offsetWidth)}rt(i,pe=>{pe?setTimeout(()=>{r()},1500):setTimeout(()=>{r()},500)});function r(){l.value=s.value.offsetWidth}Je(()=>{ri(()=>{l.value=s.value.offsetWidth}),de()});let u=_(()=>st(l.value));const d=R("settings");let f=R("cabinetType"),v=R("amCustomize");const g=R("labels"),k=R("localLanguage");let N=_(()=>d.general.usedLanguages.includes(k.value));function E(pe,Te){return Te&&Object.keys(Te).forEach(Pe=>{Te[Pe][k.value]&&N.value?pe[Pe]=Te[Pe][k.value]:Te[Pe].default&&(pe[Pe]=Te[Pe].default)}),pe}let b=_(()=>{let pe=Qe({...g}),Te=v.value.profile.translations;return E(pe,Te)});function A(pe){let Te={},Pe=v.value[pe].translations;return E(Te,Pe)}let S=_(()=>v.value.profile.options),P=F("first"),h=F("");function I(){oe.value=!1,h.value=""}let L=F(null),T=F(!1),w=F({firstName:_({get:()=>a.getters["auth/getProfile"].firstName,set:pe=>{a.commit("auth/setProfileFirstName",pe||"")}}),lastName:_({get:()=>a.getters["auth/getProfile"].lastName,set:pe=>{a.commit("auth/setProfileLastName",pe||"")}}),email:_({get:()=>a.getters["auth/getProfile"].email,set:pe=>{a.commit("auth/setProfileEmail",pe||"")}}),phone:_({get:()=>a.getters["auth/getProfile"].phone,set:pe=>{a.commit("auth/setProfilePhone",pe||"")}}),birthday:_({get:()=>a.getters["auth/getProfile"].birthday?a.getters["auth/getProfile"].birthday:"",set:pe=>{a.commit("auth/setProfileBirthday",pe?he(pe).format("YYYY-MM-DD"):"")}})}),B=F({firstName:{template:Ye.text,props:{itemName:"firstName",label:b.value.first_name_colon,placeholder:b.value.enter_first_name,class:_(()=>`am-capi__item ${u.value}`)}},lastName:{template:Ye.text,props:{itemName:"lastName",label:b.value.last_name_colon,placeholder:b.value.enter_last_name,class:_(()=>`am-capi__item ${u.value}`)}},email:{template:Ye.text,props:{itemName:"email",label:b.value.email_colon,placeholder:b.value.enter_email,class:_(()=>`am-capi__item ${u.value}`)}},phone:{countryPhoneIso:_({get:()=>a.getters["auth/getProfile"].countryPhoneIso?a.getters["auth/getProfile"].countryPhoneIso:"",set:pe=>{a.commit("auth/setProfileCountryPhoneIso",pe?pe.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:b.value.phone_colon,placeholder:b.value.enter_phone,defaultCode:_(()=>a.getters["auth/getProfile"].countryPhoneIso?a.getters["auth/getProfile"].countryPhoneIso:""),phoneError:_(()=>T.value),whatsAppLabel:b.value.whatsapp_opt_in_text,isWhatsApp:d.notifications.whatsAppEnabled&&d.notifications.whatsAppAccessToken&&d.notifications.whatsAppBusinessID&&d.notifications.whatsAppPhoneID,class:_(()=>`am-capi__item ${u.value}`)}},birthday:{template:Ye.datepicker,props:{itemName:"birthday",label:b.value.date_of_birth,placeholder:b.value.enter_date_of_birth,clearable:!0,readonly:!1,class:_(()=>`am-capi__item am-capi__item-birthday ${u.value}`)}}}),z=F({firstName:[{required:!0,message:b.value.enter_first_name_warning,trigger:"submit"}],lastName:[{required:S.value.lastName.required,message:b.value.enter_last_name_warning,trigger:"submit"}],email:[{required:S.value.email.required,type:"email",message:b.value.enter_valid_email_warning,trigger:"submit"}],phone:[{required:S.value.phone.required,message:b.value.enter_phone_warning,trigger:"submit"}],birthday:[{required:S.value.birthday.required,message:b.value.enter_date_of_birth_warning,trigger:"submit"}]}),D=F(!1);Be("deleteProfileDialog",D);function G(){a.commit("auth/setProfileFirstName",w.value.firstName?w.value.firstName.trim():""),a.commit("auth/setProfileLastName",w.value.lastName?w.value.lastName.trim():""),a.commit("auth/setProfileEmail",w.value.email?w.value.email.trim():""),L.value.validate(pe=>{if(pe){h.value=b.value.profile_data_success;let Te=a.getters["auth/getProfile"];a.commit("setLoading",!0),Ne.post("/users/"+f.value+"s/"+Te.id,Te,ze(a)).finally(()=>{a.commit("setLoading",!1),oe.value=!0,S.value.phone.required&&w.value.phone&&(T.value=!1)})}else return S.value.phone.required&&!w.value.phone&&(T.value=!0),!1})}Be("saveProfileChanges",G);let se=F(null),j=F({newPass:_({get:()=>a.getters["auth/getNewPassword"],set:pe=>{a.commit("auth/setNewPassword",pe||"")}}),confirmPass:_({get:()=>a.getters["auth/getConfirmPassword"],set:pe=>{a.commit("auth/setConfirmPassword",pe||"")}})}),ne=F({newPass:{template:Ye.text,props:{itemName:"newPass",itemType:"password",showPassword:!0,label:b.value.new_password_colon,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${u.value}`)}},confirmPass:{template:Ye.text,props:{itemName:"confirmPass",itemType:"password",showPassword:!0,label:b.value.new_password_colon_retype,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${u.value}`)}}}),te=F({newPass:[{required:!0,message:b.value.new_password_required,trigger:"submit"},{min:4,message:b.value.new_password_length,trigger:"submit"}],confirmPass:[{required:!0,message:b.value.new_password_required,trigger:"submit"},{min:4,message:b.value.new_password_length,trigger:"submit"},{validator:()=>a.getters["auth/getNewPassword"]===a.getters["auth/getConfirmPassword"],message:b.value.passwords_not_match,trigger:"submit"}]}),oe=F(!1);function ie(){oe.value=!1}function K(){se.value.validate(pe=>{if(pe){let Te=a.getters["auth/getProfile"];a.commit("setLoading",!0),Ne.post("/users/customers/"+Te.id,{password:a.getters["auth/getNewPassword"]},ze(a)).then(()=>{h.value=b.value.password_success,a.commit("auth/setNewPassword",""),a.commit("auth/setConfirmPassword","")}).catch(()=>{}).finally(()=>{a.commit("setLoading",!1),oe.value=!0})}else return!1})}Be("changeProfilePassword",K);function me(){D.value=!1,a.commit("auth/setProfileDeleted",!0),a.dispatch("auth/logout")}function Ae(){a.commit("setLoading",!0);let pe=a.getters["auth/getProfile"]?a.getters["auth/getProfile"].id:null;if(!pe)return;let Te={email:"",firstName:b.value.customer,lastName:pe,phone:"",birthday:"",gender:"",externalId:"",password:""};const Pe=Ol().cookies;Ne.post("/users/customers/"+pe,Object.assign(ze(a),Te)).then(()=>{a.commit("auth/setProfile",{}),Pe.remove("ameliaUserEmail"),a.commit("setLoading",!1),me()}).catch(Oe=>{a.commit("setLoading",!1),console.log(Oe)})}const Ve=F(null),Q=Qe({}),_e=Qe({}),X=Qe({}),M=Qe({});function Z(pe,Te,Pe){Q[Te]=Pe??""}function W(pe,Te){if(X[Te]={template:Ye[pe.type],props:{id:Te,itemName:Te.toString(),label:pe.label,options:pe.options,class:`am-capei-att-cf__item am-cf-width-${pe.width}`}},pe.type==="text-area"&&(X[Te].props.itemType="textarea"),pe.type==="datepicker"&&(X[Te].props.weekStartsFromDay=d.wordpress.startOfWeek),pe.type==="file"){let Pe=a.getters["auth/getProfile"]?a.getters["auth/getProfile"].id:null;X[Te].props={...X[Te].props,btnLabel:b.value.upload_file_here,isUpload:!0,bookingId:Pe,source:"cabinet-customer"}}}function le(pe){_e[pe.id]=[{message:b.value.required_field,required:pe.required,trigger:["submit","change"]}]}function de(){const pe=a.getters["entities/getCustomFields"],Te=JSON.parse(a.getters["auth/getProfile"].customFields||"{}");pe.filter(Pe=>Pe.saveType==="customer"&&Pe.type!=="content").sort((Pe,Oe)=>Pe.position-Oe.position).forEach(Pe=>{const{position:Oe,id:Re}=Pe,ke=Te[Re]?.value;M[Oe]={...Pe,value:ke??(Pe.type==="checkbox"||Pe.type==="file"?[]:"")},Z(Pe,Re,M[Oe].value),W(Pe,Re),le(Pe)})}function ae(){Ve.value.validate(pe=>{if(pe){const Te=a.getters["auth/getProfile"],Pe={};for(const Re in M){const ke=M[Re],Ue=Q[ke.id];Pe[ke.id]={label:ke.label,type:ke.type,value:typeof Ue=="string"?Ue.trim():Ue}}const Oe={...Te,customFields:JSON.stringify(Pe)};a.commit("setLoading",!0),Ne.post(`/users/${f.value}s/${Te.id}`,Oe,ze(a)).finally(()=>{a.commit("setLoading",!1),h.value=b.value.profile_data_success,oe.value=!0})}else return!1})}Be("saveCustomerCustomFields",ae);let xe=R("amColors"),ye=_(()=>({"--am-c-capi-primary":xe.value.colorPrimary,"--am-c-capi-text":xe.value.colorMainText,"--am-c-capi-text-op10":H(xe.value.colorMainText,.1)}));return(pe,Te)=>{const Pe=et,Oe=va,Re=_a;return c(),y("div",{ref_key:"pageContainer",ref:s,class:"am-capi",style:be(t(ye))},[m("div",dd,[t(oe)?(c(),U(_t,{key:0,type:"success","show-border":!0,"close-after":5e3,"custom-class":"am-capi__alert",onClose:I,onTriggerClose:I},{title:x(()=>[md,ce(" "+C(t(h)),1)]),_:1})):O("",!0),$(Re,{modelValue:t(P),"onUpdate:modelValue":Te[0]||(Te[0]=ke=>we(P)?P.value=ke:P=ke),class:"am-capi__tabs",onTabClick:ie},{default:x(()=>[$(Oe,{class:"am-capi__tabs-item",label:t(b).personal_info,name:"first"},{default:x(()=>[t(e)?(c(),U(wl,{key:1,count:5,"page-width":t(l)},null,8,["page-width"])):(c(),y(ee,{key:0},[t(a).getters["auth/getProfile"]?(c(),U(Pe,{key:0,ref_key:"infoFormRef",ref:L,model:t(w),rules:t(z),"label-position":"top",class:q(["am-capi__form",t(u)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(v).profile.order,ke=>(c(),y(ee,{key:ke.id},[!t(S)[ke.id]||t(S)[ke.id].visibility?(c(),U(pt(t(B)[ke.id].template),Lt({key:0,ref_for:!0,ref:"customerCollectorRef",modelValue:t(w)[ke.id],"onUpdate:modelValue":Ue=>t(w)[ke.id]=Ue,countryPhoneIso:t(B)[ke.id].countryPhoneIso,"onUpdate:countryPhoneIso":Ue=>t(B)[ke.id].countryPhoneIso=Ue},t(B)[ke.id].props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"])):O("",!0)],64))),128))]),_:1},8,["model","rules","class"])):O("",!0)],64))]),_:1},8,["label"]),Object.keys(t(M)).length?(c(),U(Oe,{key:0,label:t(b).custom_fields,name:"third"},{default:x(()=>[t(e)?(c(),U(wl,{key:1,count:Object.keys(t(M)).length,"page-width":t(l)},null,8,["count","page-width"])):(c(),U(Pe,{key:0,ref_key:"customFieldsFormRef",ref:Ve,model:t(Q),rules:t(_e),"label-position":"top",class:q(["am-capei-att-cf__form",t(u)])},{default:x(()=>[(c(!0),y(ee,null,fe(Object.values(t(M)),ke=>(c(),y(ee,{key:ke.id},[ke.id in t(Q)?(c(),U(pt(t(X)[ke.id]?.template),Lt({key:0,modelValue:t(Q)[ke.id],"onUpdate:modelValue":Ue=>t(Q)[ke.id]=Ue},t(X)[ke.id]?.props),null,16,["modelValue","onUpdate:modelValue"])):O("",!0)],64))),128))]),_:1},8,["model","rules","class"]))]),_:1},8,["label"])):O("",!0),$(Oe,{class:"am-capi__tabs-item",label:t(b).password_tab,name:"second"},{default:x(()=>[t(e)?(c(),U(wl,{key:1,"item-direction":"column",count:2,"page-width":t(l)},null,8,["page-width"])):(c(),U(Pe,{key:0,ref_key:"passFormRef",ref:se,model:t(j),rules:t(te),"label-position":"top",class:q(["am-capi__form",t(u)])},{default:x(()=>[(c(!0),y(ee,null,fe(t(ne),(ke,Ue)=>(c(),U(pt(ke.template),Lt({key:ke.props.itemName,ref_for:!0,ref:"customerPassCollectorRef",modelValue:t(j)[Ue],"onUpdate:modelValue":J=>t(j)[Ue]=J},ke.props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]))]),_:1},8,["label"])]),_:1},8,["modelValue"]),$(ud,{visibility:t(D),"customized-labels":A("deleteProfile"),"customized-options":t(v).deleteProfile.options,onClose:Te[1]||(Te[1]=ke=>we(D)?D.value=!1:D=!1),onDeleteProfile:Ae},null,8,["visibility","customized-labels","customized-options"]),$(Rc,{loading:t(e),display:t(P),"parent-width":t(l),"customized-labels":t(b),"save-footer-button":t(S).saveFooterButton.buttonType,"delete-footer-type":t(S).deleteFooterButton.buttonType,"pass-footer-button":t(S).passFooterButton.buttonType},null,8,["loading","display","parent-width","customized-labels","save-footer-button","delete-footer-type","pass-footer-button"])])],4)}}});var Ie=(n=>(n[n.TYPE=3]="TYPE",n[n.LEVEL=12]="LEVEL",n[n.ATTRIBUTE=13]="ATTRIBUTE",n[n.BLOT=14]="BLOT",n[n.INLINE=7]="INLINE",n[n.BLOCK=11]="BLOCK",n[n.BLOCK_BLOT=10]="BLOCK_BLOT",n[n.INLINE_BLOT=6]="INLINE_BLOT",n[n.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",n[n.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",n[n.ANY=15]="ANY",n))(Ie||{});class oa{constructor(a,e,s={}){this.attrName=a,this.keyName=e;const l=Ie.TYPE&Ie.ATTRIBUTE;this.scope=s.scope!=null?s.scope&Ie.LEVEL|l:Ie.ATTRIBUTE,s.whitelist!=null&&(this.whitelist=s.whitelist)}static keys(a){return Array.from(a.attributes).map(e=>e.name)}add(a,e){return this.canAdd(a,e)?(a.setAttribute(this.keyName,e),!0):!1}canAdd(a,e){return this.whitelist==null?!0:typeof e=="string"?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1}remove(a){a.removeAttribute(this.keyName)}value(a){const e=a.getAttribute(this.keyName);return this.canAdd(a,e)&&e?e:""}}class ps extends Error{constructor(a){a="[Parchment] "+a,super(a),this.message=a,this.name=this.constructor.name}}const No=class Hn{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(a,e=!1){if(a==null)return null;if(this.blots.has(a))return this.blots.get(a)||null;if(e){let s=null;try{s=a.parentNode}catch{return null}return this.find(s,e)}return null}create(a,e,s){const l=this.query(e);if(l==null)throw new ps(`Unable to create ${e} blot`);const i=l,o=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:i.create(s),r=new i(a,o,s);return Hn.blots.set(r.domNode,r),r}find(a,e=!1){return Hn.find(a,e)}query(a,e=Ie.ANY){let s;return typeof a=="string"?s=this.types[a]||this.attributes[a]:a instanceof Text||a.nodeType===Node.TEXT_NODE?s=this.types.text:typeof a=="number"?a&Ie.LEVEL&Ie.BLOCK?s=this.types.block:a&Ie.LEVEL&Ie.INLINE&&(s=this.types.inline):a instanceof Element&&((a.getAttribute("class")||"").split(/\s+/).some(l=>(s=this.classes[l],!!s)),s=s||this.tags[a.tagName]),s==null?null:"scope"in s&&e&Ie.LEVEL&s.scope&&e&Ie.TYPE&s.scope?s:null}register(...a){return a.map(e=>{const s="blotName"in e,l="attrName"in e;if(!s&&!l)throw new ps("Invalid definition");if(s&&e.blotName==="abstract")throw new ps("Cannot register abstract class");const i=s?e.blotName:l?e.attrName:void 0;return this.types[i]=e,l?typeof e.keyName=="string"&&(this.attributes[e.keyName]=e):s&&(e.className&&(this.classes[e.className]=e),e.tagName&&(Array.isArray(e.tagName)?e.tagName=e.tagName.map(o=>o.toUpperCase()):e.tagName=e.tagName.toUpperCase(),(Array.isArray(e.tagName)?e.tagName:[e.tagName]).forEach(o=>{(this.tags[o]==null||e.className==null)&&(this.tags[o]=e)}))),e})}};No.blots=new WeakMap;let _s=No;function Ri(n,a){return(n.getAttribute("class")||"").split(/\s+/).filter(e=>e.indexOf(`${a}-`)===0)}class fd extends oa{static keys(a){return(a.getAttribute("class")||"").split(/\s+/).map(e=>e.split("-").slice(0,-1).join("-"))}add(a,e){return this.canAdd(a,e)?(this.remove(a),a.classList.add(`${this.keyName}-${e}`),!0):!1}remove(a){Ri(a,this.keyName).forEach(e=>{a.classList.remove(e)}),a.classList.length===0&&a.removeAttribute("class")}value(a){const e=(Ri(a,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(a,e)?e:""}}const ea=fd;function On(n){const a=n.split("-"),e=a.slice(1).map(s=>s[0].toUpperCase()+s.slice(1)).join("");return a[0]+e}class hd extends oa{static keys(a){return(a.getAttribute("style")||"").split(";").map(e=>e.split(":")[0].trim())}add(a,e){return this.canAdd(a,e)?(a.style[On(this.keyName)]=e,!0):!1}remove(a){a.style[On(this.keyName)]="",a.getAttribute("style")||a.removeAttribute("style")}value(a){const e=a.style[On(this.keyName)];return this.canAdd(a,e)?e:""}}const Pa=hd;class vd{constructor(a){this.attributes={},this.domNode=a,this.build()}attribute(a,e){e?a.add(this.domNode,e)&&(a.value(this.domNode)!=null?this.attributes[a.attrName]=a:delete this.attributes[a.attrName]):(a.remove(this.domNode),delete this.attributes[a.attrName])}build(){this.attributes={};const a=_s.find(this.domNode);if(a==null)return;const e=oa.keys(this.domNode),s=ea.keys(this.domNode),l=Pa.keys(this.domNode);e.concat(s).concat(l).forEach(i=>{const o=a.scroll.query(i,Ie.ATTRIBUTE);o instanceof oa&&(this.attributes[o.attrName]=o)})}copy(a){Object.keys(this.attributes).forEach(e=>{const s=this.attributes[e].value(this.domNode);a.format(e,s)})}move(a){this.copy(a),Object.keys(this.attributes).forEach(e=>{this.attributes[e].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((a,e)=>(a[e]=this.attributes[e].value(this.domNode),a),{})}}const Rl=vd,Oo=class{constructor(a,e){this.scroll=a,this.domNode=e,_s.blots.set(e,this),this.prev=null,this.next=null}static create(a){if(this.tagName==null)throw new ps("Blot definition missing tagName");let e,s;return Array.isArray(this.tagName)?(typeof a=="string"?(s=a.toUpperCase(),parseInt(s,10).toString()===s&&(s=parseInt(s,10))):typeof a=="number"&&(s=a),typeof s=="number"?e=document.createElement(this.tagName[s-1]):s&&this.tagName.indexOf(s)>-1?e=document.createElement(s):e=document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const a=this.domNode.cloneNode(!1);return this.scroll.create(a)}detach(){this.parent!=null&&this.parent.removeChild(this),_s.blots.delete(this.domNode)}deleteAt(a,e){this.isolate(a,e).remove()}formatAt(a,e,s,l){const i=this.isolate(a,e);if(this.scroll.query(s,Ie.BLOT)!=null&&l)i.wrap(s,l);else if(this.scroll.query(s,Ie.ATTRIBUTE)!=null){const o=this.scroll.create(this.statics.scope);i.wrap(o),o.format(s,l)}}insertAt(a,e,s){const l=s==null?this.scroll.create("text",e):this.scroll.create(e,s),i=this.split(a);this.parent.insertBefore(l,i||void 0)}isolate(a,e){const s=this.split(a);if(s==null)throw new Error("Attempt to isolate at end");return s.split(e),s}length(){return 1}offset(a=this.parent){return this.parent==null||this===a?0:this.parent.children.offset(this)+this.parent.offset(a)}optimize(a){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(a,e){const s=typeof a=="string"?this.scroll.create(a,e):a;return this.parent!=null&&(this.parent.insertBefore(s,this.next||void 0),this.remove()),s}split(a,e){return a===0?this:this.next}update(a,e){}wrap(a,e){const s=typeof a=="string"?this.scroll.create(a,e):a;if(this.parent!=null&&this.parent.insertBefore(s,this.next||void 0),typeof s.appendChild!="function")throw new ps(`Cannot wrap ${a}`);return s.appendChild(this),s}};Oo.blotName="abstract";let Mo=Oo;const Fo=class extends Mo{static value(a){return!0}index(a,e){return this.domNode===a||this.domNode.compareDocumentPosition(a)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(a,e){let s=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return a>0&&(s+=1),[this.parent.domNode,s]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};Fo.scope=Ie.INLINE_BLOT;let _d=Fo;const xt=_d;class yd{constructor(){this.head=null,this.tail=null,this.length=0}append(...a){if(this.insertBefore(a[0],null),a.length>1){const e=a.slice(1);this.append(...e)}}at(a){const e=this.iterator();let s=e();for(;s&&a>0;)a-=1,s=e();return s}contains(a){const e=this.iterator();let s=e();for(;s;){if(s===a)return!0;s=e()}return!1}indexOf(a){const e=this.iterator();let s=e(),l=0;for(;s;){if(s===a)return l;l+=1,s=e()}return-1}insertBefore(a,e){a!=null&&(this.remove(a),a.next=e,e!=null?(a.prev=e.prev,e.prev!=null&&(e.prev.next=a),e.prev=a,e===this.head&&(this.head=a)):this.tail!=null?(this.tail.next=a,a.prev=this.tail,this.tail=a):(a.prev=null,this.head=this.tail=a),this.length+=1)}offset(a){let e=0,s=this.head;for(;s!=null;){if(s===a)return e;e+=s.length(),s=s.next}return-1}remove(a){this.contains(a)&&(a.prev!=null&&(a.prev.next=a.next),a.next!=null&&(a.next.prev=a.prev),a===this.head&&(this.head=a.next),a===this.tail&&(this.tail=a.prev),this.length-=1)}iterator(a=this.head){return()=>{const e=a;return a!=null&&(a=a.next),e}}find(a,e=!1){const s=this.iterator();let l=s();for(;l;){const i=l.length();if(a<i||e&&a===i&&(l.next==null||l.next.length()!==0))return[l,a];a-=i,l=s()}return[null,0]}forEach(a){const e=this.iterator();let s=e();for(;s;)a(s),s=e()}forEachAt(a,e,s){if(e<=0)return;const[l,i]=this.find(a);let o=a-i;const r=this.iterator(l);let u=r();for(;u&&o<a+e;){const d=u.length();a>o?s(u,a-o,Math.min(e,o+d-a)):s(u,0,Math.min(d,a+e-o)),o+=d,u=r()}}map(a){return this.reduce((e,s)=>(e.push(a(s)),e),[])}reduce(a,e){const s=this.iterator();let l=s();for(;l;)e=a(e,l),l=s();return e}}function qi(n,a){const e=a.find(n);if(e)return e;try{return a.create(n)}catch{const s=a.create(Ie.INLINE);return Array.from(n.childNodes).forEach(l=>{s.domNode.appendChild(l)}),n.parentNode&&n.parentNode.replaceChild(s.domNode,n),s.attach(),s}}const Vo=class wa extends Mo{constructor(a,e){super(a,e),this.uiNode=null,this.build()}appendChild(a){this.insertBefore(a)}attach(){super.attach(),this.children.forEach(a=>{a.attach()})}attachUI(a){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=a,wa.uiClass&&this.uiNode.classList.add(wa.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new yd,Array.from(this.domNode.childNodes).filter(a=>a!==this.uiNode).reverse().forEach(a=>{try{const e=qi(a,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(e){if(e instanceof ps)return;throw e}})}deleteAt(a,e){if(a===0&&e===this.length())return this.remove();this.children.forEachAt(a,e,(s,l,i)=>{s.deleteAt(l,i)})}descendant(a,e=0){const[s,l]=this.children.find(e);return a.blotName==null&&a(s)||a.blotName!=null&&s instanceof a?[s,l]:s instanceof wa?s.descendant(a,l):[null,-1]}descendants(a,e=0,s=Number.MAX_VALUE){let l=[],i=s;return this.children.forEachAt(e,s,(o,r,u)=>{(a.blotName==null&&a(o)||a.blotName!=null&&o instanceof a)&&l.push(o),o instanceof wa&&(l=l.concat(o.descendants(a,r,i))),i-=u}),l}detach(){this.children.forEach(a=>{a.detach()}),super.detach()}enforceAllowedChildren(){let a=!1;this.children.forEach(e=>{a||this.statics.allowedChildren.some(s=>e instanceof s)||(e.statics.scope===Ie.BLOCK_BLOT?(e.next!=null&&this.splitAfter(e),e.prev!=null&&this.splitAfter(e.prev),e.parent.unwrap(),a=!0):e instanceof wa?e.unwrap():e.remove())})}formatAt(a,e,s,l){this.children.forEachAt(a,e,(i,o,r)=>{i.formatAt(o,r,s,l)})}insertAt(a,e,s){const[l,i]=this.children.find(a);if(l)l.insertAt(i,e,s);else{const o=s==null?this.scroll.create("text",e):this.scroll.create(e,s);this.appendChild(o)}}insertBefore(a,e){a.parent!=null&&a.parent.children.remove(a);let s=null;this.children.insertBefore(a,e||null),a.parent=this,e!=null&&(s=e.domNode),(this.domNode.parentNode!==a.domNode||this.domNode.nextSibling!==s)&&this.domNode.insertBefore(a.domNode,s),a.attach()}length(){return this.children.reduce((a,e)=>a+e.length(),0)}moveChildren(a,e){this.children.forEach(s=>{a.insertBefore(s,e)})}optimize(a){if(super.optimize(a),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove()}path(a,e=!1){const[s,l]=this.children.find(a,e),i=[[this,a]];return s instanceof wa?i.concat(s.path(l,e)):(s!=null&&i.push([s,l]),i)}removeChild(a){this.children.remove(a)}replaceWith(a,e){const s=typeof a=="string"?this.scroll.create(a,e):a;return s instanceof wa&&this.moveChildren(s),super.replaceWith(s)}split(a,e=!1){if(!e){if(a===0)return this;if(a===this.length())return this.next}const s=this.clone();return this.parent&&this.parent.insertBefore(s,this.next||void 0),this.children.forEachAt(a,this.length(),(l,i,o)=>{const r=l.split(i,e);r!=null&&s.appendChild(r)}),s}splitAfter(a){const e=this.clone();for(;a.next!=null;)e.appendChild(a.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(a,e){const s=[],l=[];a.forEach(i=>{i.target===this.domNode&&i.type==="childList"&&(s.push(...i.addedNodes),l.push(...i.removedNodes))}),l.forEach(i=>{if(i.parentNode!=null&&i.tagName!=="IFRAME"&&document.body.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const o=this.scroll.find(i);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),s.filter(i=>i.parentNode===this.domNode&&i!==this.uiNode).sort((i,o)=>i===o?0:i.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(i=>{let o=null;i.nextSibling!=null&&(o=this.scroll.find(i.nextSibling));const r=qi(i,this.scroll);(r.next!==o||r.next==null)&&(r.parent!=null&&r.parent.removeChild(this),this.insertBefore(r,o||void 0))}),this.enforceAllowedChildren()}};Vo.uiClass="";let bd=Vo;const Qt=bd;function kd(n,a){if(Object.keys(n).length!==Object.keys(a).length)return!1;for(const e in n)if(n[e]!==a[e])return!1;return!0}const is=class os extends Qt{static create(a){return super.create(a)}static formats(a,e){const s=e.query(os.blotName);if(!(s!=null&&a.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return a.tagName.toLowerCase()}}constructor(a,e){super(a,e),this.attributes=new Rl(this.domNode)}format(a,e){if(a===this.statics.blotName&&!e)this.children.forEach(s=>{s instanceof os||(s=s.wrap(os.blotName,!0)),this.attributes.copy(s)}),this.unwrap();else{const s=this.scroll.query(a,Ie.INLINE);if(s==null)return;s instanceof oa?this.attributes.attribute(s,e):e&&(a!==this.statics.blotName||this.formats()[a]!==e)&&this.replaceWith(a,e)}}formats(){const a=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(a[this.statics.blotName]=e),a}formatAt(a,e,s,l){this.formats()[s]!=null||this.scroll.query(s,Ie.ATTRIBUTE)?this.isolate(a,e).format(s,l):super.formatAt(a,e,s,l)}optimize(a){super.optimize(a);const e=this.formats();if(Object.keys(e).length===0)return this.unwrap();const s=this.next;s instanceof os&&s.prev===this&&kd(e,s.formats())&&(s.moveChildren(this),s.remove())}replaceWith(a,e){const s=super.replaceWith(a,e);return this.attributes.copy(s),s}update(a,e){super.update(a,e),a.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}wrap(a,e){const s=super.wrap(a,e);return s instanceof os&&this.attributes.move(s),s}};is.allowedChildren=[is,xt],is.blotName="inline",is.scope=Ie.INLINE_BLOT,is.tagName="SPAN";let Cd=is;const pi=Cd,rs=class Zn extends Qt{static create(a){return super.create(a)}static formats(a,e){const s=e.query(Zn.blotName);if(!(s!=null&&a.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return a.tagName.toLowerCase()}}constructor(a,e){super(a,e),this.attributes=new Rl(this.domNode)}format(a,e){const s=this.scroll.query(a,Ie.BLOCK);s!=null&&(s instanceof oa?this.attributes.attribute(s,e):a===this.statics.blotName&&!e?this.replaceWith(Zn.blotName):e&&(a!==this.statics.blotName||this.formats()[a]!==e)&&this.replaceWith(a,e))}formats(){const a=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(a[this.statics.blotName]=e),a}formatAt(a,e,s,l){this.scroll.query(s,Ie.BLOCK)!=null?this.format(s,l):super.formatAt(a,e,s,l)}insertAt(a,e,s){if(s==null||this.scroll.query(e,Ie.INLINE)!=null)super.insertAt(a,e,s);else{const l=this.split(a);if(l!=null){const i=this.scroll.create(e,s);l.parent.insertBefore(i,l)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(a,e){const s=super.replaceWith(a,e);return this.attributes.copy(s),s}update(a,e){super.update(a,e),a.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}};rs.blotName="block",rs.scope=Ie.BLOCK_BLOT,rs.tagName="P",rs.allowedChildren=[pi,rs,xt];let xd=rs;const zs=xd,Gn=class extends Qt{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(a,e){super.deleteAt(a,e),this.enforceAllowedChildren()}formatAt(a,e,s,l){super.formatAt(a,e,s,l),this.enforceAllowedChildren()}insertAt(a,e,s){super.insertAt(a,e,s),this.enforceAllowedChildren()}optimize(a){super.optimize(a),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Gn.blotName="container",Gn.scope=Ie.BLOCK_BLOT;let wd=Gn;const ql=wd;class Td extends xt{static formats(a,e){}format(a,e){super.formatAt(0,this.length(),a,e)}formatAt(a,e,s,l){a===0&&e===this.length()?this.format(s,l):super.formatAt(a,e,s,l)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Mt=Td,Sd={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},Ed=100,cs=class extends Qt{constructor(a,e){super(null,e),this.registry=a,this.scroll=this,this.build(),this.observer=new MutationObserver(s=>{this.update(s)}),this.observer.observe(this.domNode,Sd),this.attach()}create(a,e){return this.registry.create(this,a,e)}find(a,e=!1){const s=this.registry.find(a,e);return s?s.scroll===this?s:e?this.find(s.scroll.domNode.parentNode,!0):null:null}query(a,e=Ie.ANY){return this.registry.query(a,e)}register(...a){return this.registry.register(...a)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(a,e){this.update(),a===0&&e===this.length()?this.children.forEach(s=>{s.remove()}):super.deleteAt(a,e)}formatAt(a,e,s,l){this.update(),super.formatAt(a,e,s,l)}insertAt(a,e,s){this.update(),super.insertAt(a,e,s)}optimize(a=[],e={}){super.optimize(e);const s=e.mutationsMap||new WeakMap;let l=Array.from(this.observer.takeRecords());for(;l.length>0;)a.push(l.pop());const i=(u,d=!0)=>{u==null||u===this||u.domNode.parentNode!=null&&(s.has(u.domNode)||s.set(u.domNode,[]),d&&i(u.parent))},o=u=>{s.has(u.domNode)&&(u instanceof Qt&&u.children.forEach(o),s.delete(u.domNode),u.optimize(e))};let r=a;for(let u=0;r.length>0;u+=1){if(u>=Ed)throw new Error("[Parchment] Maximum optimize iterations reached");for(r.forEach(d=>{const f=this.find(d.target,!0);f!=null&&(f.domNode===d.target&&(d.type==="childList"?(i(this.find(d.previousSibling,!1)),Array.from(d.addedNodes).forEach(v=>{const g=this.find(v,!1);i(g,!1),g instanceof Qt&&g.children.forEach(k=>{i(k,!1)})})):d.type==="attributes"&&i(f.prev)),i(f))}),this.children.forEach(o),r=Array.from(this.observer.takeRecords()),l=r.slice();l.length>0;)a.push(l.pop())}}update(a,e={}){a=a||this.observer.takeRecords();const s=new WeakMap;a.map(l=>{const i=this.find(l.target,!0);return i==null?null:s.has(i.domNode)?(s.get(i.domNode).push(l),null):(s.set(i.domNode,[l]),i)}).forEach(l=>{l!=null&&l!==this&&s.has(l.domNode)&&l.update(s.get(l.domNode)||[],e)}),e.mutationsMap=s,s.has(this.domNode)&&super.update(s.get(this.domNode),e),this.optimize(a,e)}};cs.blotName="scroll",cs.defaultChild=zs,cs.allowedChildren=[zs,ql],cs.scope=Ie.BLOCK_BLOT,cs.tagName="DIV";let Ld=cs;const gi=Ld,Jn=class Bo extends xt{static create(a){return document.createTextNode(a)}static value(a){return a.data}constructor(a,e){super(a,e),this.text=this.statics.value(this.domNode)}deleteAt(a,e){this.domNode.data=this.text=this.text.slice(0,a)+this.text.slice(a+e)}index(a,e){return this.domNode===a?e:-1}insertAt(a,e,s){s==null?(this.text=this.text.slice(0,a)+e+this.text.slice(a),this.domNode.data=this.text):super.insertAt(a,e,s)}length(){return this.text.length}optimize(a){super.optimize(a),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof Bo&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(a,e=!1){return[this.domNode,a]}split(a,e=!1){if(!e){if(a===0)return this;if(a===this.length())return this.next}const s=this.scroll.create(this.domNode.splitText(a));return this.parent.insertBefore(s,this.next||void 0),this.text=this.statics.value(this.domNode),s}update(a,e){a.some(s=>s.type==="characterData"&&s.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Jn.blotName="text",Jn.scope=Ie.INLINE_BLOT;let Ad=Jn;const Il=Ad;var Id=Object.freeze(Object.defineProperty({__proto__:null,Attributor:oa,AttributorStore:Rl,BlockBlot:zs,ClassAttributor:ea,ContainerBlot:ql,EmbedBlot:Mt,InlineBlot:pi,LeafBlot:xt,ParentBlot:Qt,Registry:_s,Scope:Ie,ScrollBlot:gi,StyleAttributor:Pa,TextBlot:Il},Symbol.toStringTag,{value:"Module"})),Pt={exports:{}},Ot=-1,Et=1,ut=0;function js(n,a,e,s,l){if(n===a)return n?[[ut,n]]:[];if(e!=null){var i=Bd(n,a,e);if(i)return i}var o=fi(n,a),r=n.substring(0,o);n=n.substring(o),a=a.substring(o),o=Ul(n,a);var u=n.substring(n.length-o);n=n.substring(0,n.length-o),a=a.substring(0,a.length-o);var d=$d(n,a);return r&&d.unshift([ut,r]),u&&d.push([ut,u]),hi(d,l),s&&Nd(d),d}function $d(n,a){var e;if(!n)return[[Et,a]];if(!a)return[[Ot,n]];var s=n.length>a.length?n:a,l=n.length>a.length?a:n,i=s.indexOf(l);if(i!==-1)return e=[[Et,s.substring(0,i)],[ut,l],[Et,s.substring(i+l.length)]],n.length>a.length&&(e[0][0]=e[2][0]=Ot),e;if(l.length===1)return[[Ot,n],[Et,a]];var o=Dd(n,a);if(o){var r=o[0],u=o[1],d=o[2],f=o[3],v=o[4],g=js(r,d),k=js(u,f);return g.concat([[ut,v]],k)}return Pd(n,a)}function Pd(n,a){for(var e=n.length,s=a.length,l=Math.ceil((e+s)/2),i=l,o=2*l,r=new Array(o),u=new Array(o),d=0;d<o;d++)r[d]=-1,u[d]=-1;r[i+1]=0,u[i+1]=0;for(var f=e-s,v=f%2!==0,g=0,k=0,N=0,E=0,b=0;b<l;b++){for(var A=-b+g;A<=b-k;A+=2){var S=i+A,P;A===-b||A!==b&&r[S-1]<r[S+1]?P=r[S+1]:P=r[S-1]+1;for(var h=P-A;P<e&&h<s&&n.charAt(P)===a.charAt(h);)P++,h++;if(r[S]=P,P>e)k+=2;else if(h>s)g+=2;else if(v){var I=i+f-A;if(I>=0&&I<o&&u[I]!==-1){var L=e-u[I];if(P>=L)return Ui(n,a,P,h)}}}for(var T=-b+N;T<=b-E;T+=2){var I=i+T,L;T===-b||T!==b&&u[I-1]<u[I+1]?L=u[I+1]:L=u[I-1]+1;for(var w=L-T;L<e&&w<s&&n.charAt(e-L-1)===a.charAt(s-w-1);)L++,w++;if(u[I]=L,L>e)E+=2;else if(w>s)N+=2;else if(!v){var S=i+f-T;if(S>=0&&S<o&&r[S]!==-1){var P=r[S],h=i+P-S;if(L=e-L,P>=L)return Ui(n,a,P,h)}}}}return[[Ot,n],[Et,a]]}function Ui(n,a,e,s){var l=n.substring(0,e),i=a.substring(0,s),o=n.substring(e),r=a.substring(s),u=js(l,i),d=js(o,r);return u.concat(d)}function fi(n,a){if(!n||!a||n.charAt(0)!==a.charAt(0))return 0;for(var e=0,s=Math.min(n.length,a.length),l=s,i=0;e<l;)n.substring(i,l)==a.substring(i,l)?(e=l,i=e):s=l,l=Math.floor((s-e)/2+e);return Ro(n.charCodeAt(l-1))&&l--,l}function zi(n,a){var e=n.length,s=a.length;if(e==0||s==0)return 0;e>s?n=n.substring(e-s):e<s&&(a=a.substring(0,e));var l=Math.min(e,s);if(n==a)return l;for(var i=0,o=1;;){var r=n.substring(l-o),u=a.indexOf(r);if(u==-1)return i;o+=u,(u==0||n.substring(l-o)==a.substring(0,o))&&(i=o,o++)}}function Ul(n,a){if(!n||!a||n.slice(-1)!==a.slice(-1))return 0;for(var e=0,s=Math.min(n.length,a.length),l=s,i=0;e<l;)n.substring(n.length-l,n.length-i)==a.substring(a.length-l,a.length-i)?(e=l,i=e):s=l,l=Math.floor((s-e)/2+e);return qo(n.charCodeAt(n.length-l))&&l--,l}function Dd(n,a){var e=n.length>a.length?n:a,s=n.length>a.length?a:n;if(e.length<4||s.length*2<e.length)return null;function l(k,N,E){for(var b=k.substring(E,E+Math.floor(k.length/4)),A=-1,S="",P,h,I,L;(A=N.indexOf(b,A+1))!==-1;){var T=fi(k.substring(E),N.substring(A)),w=Ul(k.substring(0,E),N.substring(0,A));S.length<w+T&&(S=N.substring(A-w,A)+N.substring(A,A+T),P=k.substring(0,E-w),h=k.substring(E+T),I=N.substring(0,A-w),L=N.substring(A+T))}return S.length*2>=k.length?[P,h,I,L,S]:null}var i=l(e,s,Math.ceil(e.length/4)),o=l(e,s,Math.ceil(e.length/2)),r;if(!i&&!o)return null;o?i?r=i[4].length>o[4].length?i:o:r=o:r=i;var u,d,f,v;n.length>a.length?(u=r[0],d=r[1],f=r[2],v=r[3]):(f=r[0],v=r[1],u=r[2],d=r[3]);var g=r[4];return[u,d,f,v,g]}function Nd(n){for(var a=!1,e=[],s=0,l=null,i=0,o=0,r=0,u=0,d=0;i<n.length;)n[i][0]==ut?(e[s++]=i,o=u,r=d,u=0,d=0,l=n[i][1]):(n[i][0]==Et?u+=n[i][1].length:d+=n[i][1].length,l&&l.length<=Math.max(o,r)&&l.length<=Math.max(u,d)&&(n.splice(e[s-1],0,[Ot,l]),n[e[s-1]+1][0]=Et,s--,s--,i=s>0?e[s-1]:-1,o=0,r=0,u=0,d=0,l=null,a=!0)),i++;for(a&&hi(n),Fd(n),i=1;i<n.length;){if(n[i-1][0]==Ot&&n[i][0]==Et){var f=n[i-1][1],v=n[i][1],g=zi(f,v),k=zi(v,f);g>=k?(g>=f.length/2||g>=v.length/2)&&(n.splice(i,0,[ut,v.substring(0,g)]),n[i-1][1]=f.substring(0,f.length-g),n[i+1][1]=v.substring(g),i++):(k>=f.length/2||k>=v.length/2)&&(n.splice(i,0,[ut,f.substring(0,k)]),n[i-1][0]=Et,n[i-1][1]=v.substring(0,v.length-k),n[i+1][0]=Ot,n[i+1][1]=f.substring(k),i++),i++}i++}}var ji=/[^a-zA-Z0-9]/,Yi=/\s/,Wi=/[\r\n]/,Od=/\n\r?\n$/,Md=/^\r?\n\r?\n/;function Fd(n){function a(k,N){if(!k||!N)return 6;var E=k.charAt(k.length-1),b=N.charAt(0),A=E.match(ji),S=b.match(ji),P=A&&E.match(Yi),h=S&&b.match(Yi),I=P&&E.match(Wi),L=h&&b.match(Wi),T=I&&k.match(Od),w=L&&N.match(Md);return T||w?5:I||L?4:A&&!P&&h?3:P||h?2:A||S?1:0}for(var e=1;e<n.length-1;){if(n[e-1][0]==ut&&n[e+1][0]==ut){var s=n[e-1][1],l=n[e][1],i=n[e+1][1],o=Ul(s,l);if(o){var r=l.substring(l.length-o);s=s.substring(0,s.length-o),l=r+l.substring(0,l.length-o),i=r+i}for(var u=s,d=l,f=i,v=a(s,l)+a(l,i);l.charAt(0)===i.charAt(0);){s+=l.charAt(0),l=l.substring(1)+i.charAt(0),i=i.substring(1);var g=a(s,l)+a(l,i);g>=v&&(v=g,u=s,d=l,f=i)}n[e-1][1]!=u&&(u?n[e-1][1]=u:(n.splice(e-1,1),e--),n[e][1]=d,f?n[e+1][1]=f:(n.splice(e+1,1),e--))}e++}}function hi(n,a){n.push([ut,""]);for(var e=0,s=0,l=0,i="",o="",r;e<n.length;){if(e<n.length-1&&!n[e][1]){n.splice(e,1);continue}switch(n[e][0]){case Et:l++,o+=n[e][1],e++;break;case Ot:s++,i+=n[e][1],e++;break;case ut:var u=e-l-s-1;if(a){if(u>=0&&zo(n[u][1])){var d=n[u][1].slice(-1);if(n[u][1]=n[u][1].slice(0,-1),i=d+i,o=d+o,!n[u][1]){n.splice(u,1),e--;var f=u-1;n[f]&&n[f][0]===Et&&(l++,o=n[f][1]+o,f--),n[f]&&n[f][0]===Ot&&(s++,i=n[f][1]+i,f--),u=f}}if(Uo(n[e][1])){var d=n[e][1].charAt(0);n[e][1]=n[e][1].slice(1),i+=d,o+=d}}if(e<n.length-1&&!n[e][1]){n.splice(e,1);break}if(i.length>0||o.length>0){i.length>0&&o.length>0&&(r=fi(o,i),r!==0&&(u>=0?n[u][1]+=o.substring(0,r):(n.splice(0,0,[ut,o.substring(0,r)]),e++),o=o.substring(r),i=i.substring(r)),r=Ul(o,i),r!==0&&(n[e][1]=o.substring(o.length-r)+n[e][1],o=o.substring(0,o.length-r),i=i.substring(0,i.length-r)));var v=l+s;i.length===0&&o.length===0?(n.splice(e-v,v),e=e-v):i.length===0?(n.splice(e-v,v,[Et,o]),e=e-v+1):o.length===0?(n.splice(e-v,v,[Ot,i]),e=e-v+1):(n.splice(e-v,v,[Ot,i],[Et,o]),e=e-v+2)}e!==0&&n[e-1][0]===ut?(n[e-1][1]+=n[e][1],n.splice(e,1)):e++,l=0,s=0,i="",o="";break}}n[n.length-1][1]===""&&n.pop();var g=!1;for(e=1;e<n.length-1;)n[e-1][0]===ut&&n[e+1][0]===ut&&(n[e][1].substring(n[e][1].length-n[e-1][1].length)===n[e-1][1]?(n[e][1]=n[e-1][1]+n[e][1].substring(0,n[e][1].length-n[e-1][1].length),n[e+1][1]=n[e-1][1]+n[e+1][1],n.splice(e-1,1),g=!0):n[e][1].substring(0,n[e+1][1].length)==n[e+1][1]&&(n[e-1][1]+=n[e+1][1],n[e][1]=n[e][1].substring(n[e+1][1].length)+n[e+1][1],n.splice(e+1,1),g=!0)),e++;g&&hi(n,a)}function Ro(n){return n>=55296&&n<=56319}function qo(n){return n>=56320&&n<=57343}function Uo(n){return qo(n.charCodeAt(0))}function zo(n){return Ro(n.charCodeAt(n.length-1))}function Vd(n){for(var a=[],e=0;e<n.length;e++)n[e][1].length>0&&a.push(n[e]);return a}function Mn(n,a,e,s){return zo(n)||Uo(s)?null:Vd([[ut,n],[Ot,a],[Et,e],[ut,s]])}function Bd(n,a,e){var s=typeof e=="number"?{index:e,length:0}:e.oldRange,l=typeof e=="number"?null:e.newRange,i=n.length,o=a.length;if(s.length===0&&(l===null||l.length===0)){var r=s.index,u=n.slice(0,r),d=n.slice(r),f=l?l.index:null;e:{var v=r+o-i;if(f!==null&&f!==v||v<0||v>o)break e;var g=a.slice(0,v),k=a.slice(v);if(k!==d)break e;var N=Math.min(r,v),E=u.slice(0,N),b=g.slice(0,N);if(E!==b)break e;var A=u.slice(N),S=g.slice(N);return Mn(E,A,S,d)}e:{if(f!==null&&f!==r)break e;var P=r,g=a.slice(0,P),k=a.slice(P);if(g!==u)break e;var h=Math.min(i-P,o-P),I=d.slice(d.length-h),L=k.slice(k.length-h);if(I!==L)break e;var A=d.slice(0,d.length-h),S=k.slice(0,k.length-h);return Mn(u,A,S,I)}}if(s.length>0&&l&&l.length===0){e:{var E=n.slice(0,s.index),I=n.slice(s.index+s.length),N=E.length,h=I.length;if(o<N+h)break e;var b=a.slice(0,N),L=a.slice(o-h);if(E!==b||I!==L)break e;var A=n.slice(N,i-h),S=a.slice(N,o-h);return Mn(E,A,S,I)}}return null}function zl(n,a,e,s){return js(n,a,e,s,!0)}zl.INSERT=Et;zl.DELETE=Ot;zl.EQUAL=ut;var Rd=zl,$l={exports:{}};(function(n,a){var e=200,s="__lodash_hash_undefined__",l=9007199254740991,i="[object Arguments]",o="[object Array]",r="[object Boolean]",u="[object Date]",d="[object Error]",f="[object Function]",v="[object GeneratorFunction]",g="[object Map]",k="[object Number]",N="[object Object]",E="[object Promise]",b="[object RegExp]",A="[object Set]",S="[object String]",P="[object Symbol]",h="[object WeakMap]",I="[object ArrayBuffer]",L="[object DataView]",T="[object Float32Array]",w="[object Float64Array]",B="[object Int8Array]",z="[object Int16Array]",D="[object Int32Array]",G="[object Uint8Array]",se="[object Uint8ClampedArray]",j="[object Uint16Array]",ne="[object Uint32Array]",te=/[\\^$.*+?()[\]{}|]/g,oe=/\w*$/,ie=/^\[object .+?Constructor\]$/,K=/^(?:0|[1-9]\d*)$/,me={};me[i]=me[o]=me[I]=me[L]=me[r]=me[u]=me[T]=me[w]=me[B]=me[z]=me[D]=me[g]=me[k]=me[N]=me[b]=me[A]=me[S]=me[P]=me[G]=me[se]=me[j]=me[ne]=!0,me[d]=me[f]=me[h]=!1;var Ae=typeof Ta=="object"&&Ta&&Ta.Object===Object&&Ta,Ve=typeof self=="object"&&self&&self.Object===Object&&self,Q=Ae||Ve||Function("return this")(),_e=a&&!a.nodeType&&a,X=_e&&!0&&n&&!n.nodeType&&n,M=X&&X.exports===_e;function Z(p,V){return p.set(V[0],V[1]),p}function W(p,V){return p.add(V),p}function le(p,V){for(var Y=-1,re=p?p.length:0;++Y<re&&V(p[Y],Y,p)!==!1;);return p}function de(p,V){for(var Y=-1,re=V.length,Fe=p.length;++Y<re;)p[Fe+Y]=V[Y];return p}function ae(p,V,Y,re){var Fe=-1,$e=p?p.length:0;for(re&&$e&&(Y=p[++Fe]);++Fe<$e;)Y=V(Y,p[Fe],Fe,p);return Y}function xe(p,V){for(var Y=-1,re=Array(p);++Y<p;)re[Y]=V(Y);return re}function ye(p,V){return p?.[V]}function pe(p){var V=!1;if(p!=null&&typeof p.toString!="function")try{V=!!(p+"")}catch{}return V}function Te(p){var V=-1,Y=Array(p.size);return p.forEach(function(re,Fe){Y[++V]=[Fe,re]}),Y}function Pe(p,V){return function(Y){return p(V(Y))}}function Oe(p){var V=-1,Y=Array(p.size);return p.forEach(function(re){Y[++V]=re}),Y}var Re=Array.prototype,ke=Function.prototype,Ue=Object.prototype,J=Q["__core-js_shared__"],ve=function(){var p=/[^.]+$/.exec(J&&J.keys&&J.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),ge=ke.toString,Me=Ue.hasOwnProperty,Ce=Ue.toString,ba=RegExp("^"+ge.call(Me).replace(te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wt=M?Q.Buffer:void 0,Za=Q.Symbol,xs=Q.Uint8Array,Ft=Pe(Object.getPrototypeOf,Object),tl=Object.create,al=Ue.propertyIsEnumerable,Zl=Re.splice,ws=Object.getOwnPropertySymbols,Ga=wt?wt.isBuffer:void 0,sl=Pe(Object.keys,Object),Ja=Zt(Q,"DataView"),Da=Zt(Q,"Map"),Ht=Zt(Q,"Promise"),Xa=Zt(Q,"Set"),Ts=Zt(Q,"WeakMap"),Na=Zt(Object,"create"),Ss=Tt(Ja),Oa=Tt(Da),Es=Tt(Ht),Ls=Tt(Xa),As=Tt(Ts),ka=Za?Za.prototype:void 0,ll=ka?ka.valueOf:void 0;function ca(p){var V=-1,Y=p?p.length:0;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function Gl(){this.__data__=Na?Na(null):{}}function Jl(p){return this.has(p)&&delete this.__data__[p]}function Xl(p){var V=this.__data__;if(Na){var Y=V[p];return Y===s?void 0:Y}return Me.call(V,p)?V[p]:void 0}function nl(p){var V=this.__data__;return Na?V[p]!==void 0:Me.call(V,p)}function Is(p,V){var Y=this.__data__;return Y[p]=Na&&V===void 0?s:V,this}ca.prototype.clear=Gl,ca.prototype.delete=Jl,ca.prototype.get=Xl,ca.prototype.has=nl,ca.prototype.set=Is;function gt(p){var V=-1,Y=p?p.length:0;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function Ql(){this.__data__=[]}function Kl(p){var V=this.__data__,Y=Ka(V,p);if(Y<0)return!1;var re=V.length-1;return Y==re?V.pop():Zl.call(V,Y,1),!0}function en(p){var V=this.__data__,Y=Ka(V,p);return Y<0?void 0:V[Y][1]}function tn(p){return Ka(this.__data__,p)>-1}function an(p,V){var Y=this.__data__,re=Ka(Y,p);return re<0?Y.push([p,V]):Y[re][1]=V,this}gt.prototype.clear=Ql,gt.prototype.delete=Kl,gt.prototype.get=en,gt.prototype.has=tn,gt.prototype.set=an;function bt(p){var V=-1,Y=p?p.length:0;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function sn(){this.__data__={hash:new ca,map:new(Da||gt),string:new ca}}function ln(p){return Fa(this,p).delete(p)}function nn(p){return Fa(this,p).get(p)}function on(p){return Fa(this,p).has(p)}function rn(p,V){return Fa(this,p).set(p,V),this}bt.prototype.clear=sn,bt.prototype.delete=ln,bt.prototype.get=nn,bt.prototype.has=on,bt.prototype.set=rn;function It(p){this.__data__=new gt(p)}function cn(){this.__data__=new gt}function un(p){return this.__data__.delete(p)}function dn(p){return this.__data__.get(p)}function mn(p){return this.__data__.has(p)}function pn(p,V){var Y=this.__data__;if(Y instanceof gt){var re=Y.__data__;if(!Da||re.length<e-1)return re.push([p,V]),this;Y=this.__data__=new bt(re)}return Y.set(p,V),this}It.prototype.clear=cn,It.prototype.delete=un,It.prototype.get=dn,It.prototype.has=mn,It.prototype.set=pn;function Qa(p,V){var Y=Ns(p)||ts(p)?xe(p.length,String):[],re=Y.length,Fe=!!re;for(var $e in p)(V||Me.call(p,$e))&&!(Fe&&($e=="length"||En($e,re)))&&Y.push($e);return Y}function il(p,V,Y){var re=p[V];(!(Me.call(p,V)&&dl(re,Y))||Y===void 0&&!(V in p))&&(p[V]=Y)}function Ka(p,V){for(var Y=p.length;Y--;)if(dl(p[Y][0],V))return Y;return-1}function aa(p,V){return p&&Ds(V,Ms(V),p)}function $s(p,V,Y,re,Fe,$e,je){var Ze;if(re&&(Ze=$e?re(p,Fe,$e,je):re(p)),Ze!==void 0)return Ze;if(!la(p))return p;var ot=Ns(p);if(ot){if(Ze=Tn(p),!V)return Cn(p,Ze)}else{var Xe=da(p),kt=Xe==f||Xe==v;if(ml(p))return es(p,V);if(Xe==N||Xe==i||kt&&!$e){if(pe(p))return $e?p:{};if(Ze=sa(kt?{}:p),!V)return xn(p,aa(Ze,p))}else{if(!me[Xe])return $e?p:{};Ze=Sn(p,Xe,$s,V)}}je||(je=new It);var $t=je.get(p);if($t)return $t;if(je.set(p,Ze),!ot)var ct=Y?wn(p):Ms(p);return le(ct||p,function(Ct,ft){ct&&(ft=Ct,Ct=p[ft]),il(Ze,ft,$s(Ct,V,Y,re,ft,p,je))}),Ze}function gn(p){return la(p)?tl(p):{}}function fn(p,V,Y){var re=V(p);return Ns(p)?re:de(re,Y(p))}function hn(p){return Ce.call(p)}function vn(p){if(!la(p)||An(p))return!1;var V=Os(p)||pe(p)?ba:ie;return V.test(Tt(p))}function _n(p){if(!cl(p))return sl(p);var V=[];for(var Y in Object(p))Me.call(p,Y)&&Y!="constructor"&&V.push(Y);return V}function es(p,V){if(V)return p.slice();var Y=new p.constructor(p.length);return p.copy(Y),Y}function Ps(p){var V=new p.constructor(p.byteLength);return new xs(V).set(new xs(p)),V}function Ma(p,V){var Y=V?Ps(p.buffer):p.buffer;return new p.constructor(Y,p.byteOffset,p.byteLength)}function ol(p,V,Y){var re=V?Y(Te(p),!0):Te(p);return ae(re,Z,new p.constructor)}function rl(p){var V=new p.constructor(p.source,oe.exec(p));return V.lastIndex=p.lastIndex,V}function yn(p,V,Y){var re=V?Y(Oe(p),!0):Oe(p);return ae(re,W,new p.constructor)}function bn(p){return ll?Object(ll.call(p)):{}}function kn(p,V){var Y=V?Ps(p.buffer):p.buffer;return new p.constructor(Y,p.byteOffset,p.length)}function Cn(p,V){var Y=-1,re=p.length;for(V||(V=Array(re));++Y<re;)V[Y]=p[Y];return V}function Ds(p,V,Y,re){Y||(Y={});for(var Fe=-1,$e=V.length;++Fe<$e;){var je=V[Fe],Ze=re?re(Y[je],p[je],je,Y,p):void 0;il(Y,je,Ze===void 0?p[je]:Ze)}return Y}function xn(p,V){return Ds(p,ua(p),V)}function wn(p){return fn(p,Ms,ua)}function Fa(p,V){var Y=p.__data__;return Ln(V)?Y[typeof V=="string"?"string":"hash"]:Y.map}function Zt(p,V){var Y=ye(p,V);return vn(Y)?Y:void 0}var ua=ws?Pe(ws,Object):$n,da=hn;(Ja&&da(new Ja(new ArrayBuffer(1)))!=L||Da&&da(new Da)!=g||Ht&&da(Ht.resolve())!=E||Xa&&da(new Xa)!=A||Ts&&da(new Ts)!=h)&&(da=function(p){var V=Ce.call(p),Y=V==N?p.constructor:void 0,re=Y?Tt(Y):void 0;if(re)switch(re){case Ss:return L;case Oa:return g;case Es:return E;case Ls:return A;case As:return h}return V});function Tn(p){var V=p.length,Y=p.constructor(V);return V&&typeof p[0]=="string"&&Me.call(p,"index")&&(Y.index=p.index,Y.input=p.input),Y}function sa(p){return typeof p.constructor=="function"&&!cl(p)?gn(Ft(p)):{}}function Sn(p,V,Y,re){var Fe=p.constructor;switch(V){case I:return Ps(p);case r:case u:return new Fe(+p);case L:return Ma(p,re);case T:case w:case B:case z:case D:case G:case se:case j:case ne:return kn(p,re);case g:return ol(p,re,Y);case k:case S:return new Fe(p);case b:return rl(p);case A:return yn(p,re,Y);case P:return bn(p)}}function En(p,V){return V=V??l,!!V&&(typeof p=="number"||K.test(p))&&p>-1&&p%1==0&&p<V}function Ln(p){var V=typeof p;return V=="string"||V=="number"||V=="symbol"||V=="boolean"?p!=="__proto__":p===null}function An(p){return!!ve&&ve in p}function cl(p){var V=p&&p.constructor,Y=typeof V=="function"&&V.prototype||Ue;return p===Y}function Tt(p){if(p!=null){try{return ge.call(p)}catch{}try{return p+""}catch{}}return""}function ul(p){return $s(p,!0,!0)}function dl(p,V){return p===V||p!==p&&V!==V}function ts(p){return In(p)&&Me.call(p,"callee")&&(!al.call(p,"callee")||Ce.call(p)==i)}var Ns=Array.isArray;function as(p){return p!=null&&pl(p.length)&&!Os(p)}function In(p){return gl(p)&&as(p)}var ml=Ga||Pn;function Os(p){var V=la(p)?Ce.call(p):"";return V==f||V==v}function pl(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=l}function la(p){var V=typeof p;return!!p&&(V=="object"||V=="function")}function gl(p){return!!p&&typeof p=="object"}function Ms(p){return as(p)?Qa(p):_n(p)}function $n(){return[]}function Pn(){return!1}n.exports=ul})($l,$l.exports);var Pl={exports:{}};(function(n,a){var e=200,s="__lodash_hash_undefined__",l=1,i=2,o=9007199254740991,r="[object Arguments]",u="[object Array]",d="[object AsyncFunction]",f="[object Boolean]",v="[object Date]",g="[object Error]",k="[object Function]",N="[object GeneratorFunction]",E="[object Map]",b="[object Number]",A="[object Null]",S="[object Object]",P="[object Promise]",h="[object Proxy]",I="[object RegExp]",L="[object Set]",T="[object String]",w="[object Symbol]",B="[object Undefined]",z="[object WeakMap]",D="[object ArrayBuffer]",G="[object DataView]",se="[object Float32Array]",j="[object Float64Array]",ne="[object Int8Array]",te="[object Int16Array]",oe="[object Int32Array]",ie="[object Uint8Array]",K="[object Uint8ClampedArray]",me="[object Uint16Array]",Ae="[object Uint32Array]",Ve=/[\\^$.*+?()[\]{}|]/g,Q=/^\[object .+?Constructor\]$/,_e=/^(?:0|[1-9]\d*)$/,X={};X[se]=X[j]=X[ne]=X[te]=X[oe]=X[ie]=X[K]=X[me]=X[Ae]=!0,X[r]=X[u]=X[D]=X[f]=X[G]=X[v]=X[g]=X[k]=X[E]=X[b]=X[S]=X[I]=X[L]=X[T]=X[z]=!1;var M=typeof Ta=="object"&&Ta&&Ta.Object===Object&&Ta,Z=typeof self=="object"&&self&&self.Object===Object&&self,W=M||Z||Function("return this")(),le=a&&!a.nodeType&&a,de=le&&!0&&n&&!n.nodeType&&n,ae=de&&de.exports===le,xe=ae&&M.process,ye=function(){try{return xe&&xe.binding&&xe.binding("util")}catch{}}(),pe=ye&&ye.isTypedArray;function Te(p,V){for(var Y=-1,re=p==null?0:p.length,Fe=0,$e=[];++Y<re;){var je=p[Y];V(je,Y,p)&&($e[Fe++]=je)}return $e}function Pe(p,V){for(var Y=-1,re=V.length,Fe=p.length;++Y<re;)p[Fe+Y]=V[Y];return p}function Oe(p,V){for(var Y=-1,re=p==null?0:p.length;++Y<re;)if(V(p[Y],Y,p))return!0;return!1}function Re(p,V){for(var Y=-1,re=Array(p);++Y<p;)re[Y]=V(Y);return re}function ke(p){return function(V){return p(V)}}function Ue(p,V){return p.has(V)}function J(p,V){return p?.[V]}function ve(p){var V=-1,Y=Array(p.size);return p.forEach(function(re,Fe){Y[++V]=[Fe,re]}),Y}function ge(p,V){return function(Y){return p(V(Y))}}function Me(p){var V=-1,Y=Array(p.size);return p.forEach(function(re){Y[++V]=re}),Y}var Ce=Array.prototype,ba=Function.prototype,wt=Object.prototype,Za=W["__core-js_shared__"],xs=ba.toString,Ft=wt.hasOwnProperty,tl=function(){var p=/[^.]+$/.exec(Za&&Za.keys&&Za.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),al=wt.toString,Zl=RegExp("^"+xs.call(Ft).replace(Ve,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ws=ae?W.Buffer:void 0,Ga=W.Symbol,sl=W.Uint8Array,Ja=wt.propertyIsEnumerable,Da=Ce.splice,Ht=Ga?Ga.toStringTag:void 0,Xa=Object.getOwnPropertySymbols,Ts=ws?ws.isBuffer:void 0,Na=ge(Object.keys,Object),Ss=ua(W,"DataView"),Oa=ua(W,"Map"),Es=ua(W,"Promise"),Ls=ua(W,"Set"),As=ua(W,"WeakMap"),ka=ua(Object,"create"),ll=Tt(Ss),ca=Tt(Oa),Gl=Tt(Es),Jl=Tt(Ls),Xl=Tt(As),nl=Ga?Ga.prototype:void 0,Is=nl?nl.valueOf:void 0;function gt(p){var V=-1,Y=p==null?0:p.length;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function Ql(){this.__data__=ka?ka(null):{},this.size=0}function Kl(p){var V=this.has(p)&&delete this.__data__[p];return this.size-=V?1:0,V}function en(p){var V=this.__data__;if(ka){var Y=V[p];return Y===s?void 0:Y}return Ft.call(V,p)?V[p]:void 0}function tn(p){var V=this.__data__;return ka?V[p]!==void 0:Ft.call(V,p)}function an(p,V){var Y=this.__data__;return this.size+=this.has(p)?0:1,Y[p]=ka&&V===void 0?s:V,this}gt.prototype.clear=Ql,gt.prototype.delete=Kl,gt.prototype.get=en,gt.prototype.has=tn,gt.prototype.set=an;function bt(p){var V=-1,Y=p==null?0:p.length;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function sn(){this.__data__=[],this.size=0}function ln(p){var V=this.__data__,Y=es(V,p);if(Y<0)return!1;var re=V.length-1;return Y==re?V.pop():Da.call(V,Y,1),--this.size,!0}function nn(p){var V=this.__data__,Y=es(V,p);return Y<0?void 0:V[Y][1]}function on(p){return es(this.__data__,p)>-1}function rn(p,V){var Y=this.__data__,re=es(Y,p);return re<0?(++this.size,Y.push([p,V])):Y[re][1]=V,this}bt.prototype.clear=sn,bt.prototype.delete=ln,bt.prototype.get=nn,bt.prototype.has=on,bt.prototype.set=rn;function It(p){var V=-1,Y=p==null?0:p.length;for(this.clear();++V<Y;){var re=p[V];this.set(re[0],re[1])}}function cn(){this.size=0,this.__data__={hash:new gt,map:new(Oa||bt),string:new gt}}function un(p){var V=Zt(this,p).delete(p);return this.size-=V?1:0,V}function dn(p){return Zt(this,p).get(p)}function mn(p){return Zt(this,p).has(p)}function pn(p,V){var Y=Zt(this,p),re=Y.size;return Y.set(p,V),this.size+=Y.size==re?0:1,this}It.prototype.clear=cn,It.prototype.delete=un,It.prototype.get=dn,It.prototype.has=mn,It.prototype.set=pn;function Qa(p){var V=-1,Y=p==null?0:p.length;for(this.__data__=new It;++V<Y;)this.add(p[V])}function il(p){return this.__data__.set(p,s),this}function Ka(p){return this.__data__.has(p)}Qa.prototype.add=Qa.prototype.push=il,Qa.prototype.has=Ka;function aa(p){var V=this.__data__=new bt(p);this.size=V.size}function $s(){this.__data__=new bt,this.size=0}function gn(p){var V=this.__data__,Y=V.delete(p);return this.size=V.size,Y}function fn(p){return this.__data__.get(p)}function hn(p){return this.__data__.has(p)}function vn(p,V){var Y=this.__data__;if(Y instanceof bt){var re=Y.__data__;if(!Oa||re.length<e-1)return re.push([p,V]),this.size=++Y.size,this;Y=this.__data__=new It(re)}return Y.set(p,V),this.size=Y.size,this}aa.prototype.clear=$s,aa.prototype.delete=gn,aa.prototype.get=fn,aa.prototype.has=hn,aa.prototype.set=vn;function _n(p,V){var Y=ts(p),re=!Y&&dl(p),Fe=!Y&&!re&&as(p),$e=!Y&&!re&&!Fe&&gl(p),je=Y||re||Fe||$e,Ze=je?Re(p.length,String):[],ot=Ze.length;for(var Xe in p)(V||Ft.call(p,Xe))&&!(je&&(Xe=="length"||Fe&&(Xe=="offset"||Xe=="parent")||$e&&(Xe=="buffer"||Xe=="byteLength"||Xe=="byteOffset")||Sn(Xe,ot)))&&Ze.push(Xe);return Ze}function es(p,V){for(var Y=p.length;Y--;)if(ul(p[Y][0],V))return Y;return-1}function Ps(p,V,Y){var re=V(p);return ts(p)?re:Pe(re,Y(p))}function Ma(p){return p==null?p===void 0?B:A:Ht&&Ht in Object(p)?da(p):cl(p)}function ol(p){return la(p)&&Ma(p)==r}function rl(p,V,Y,re,Fe){return p===V?!0:p==null||V==null||!la(p)&&!la(V)?p!==p&&V!==V:yn(p,V,Y,re,rl,Fe)}function yn(p,V,Y,re,Fe,$e){var je=ts(p),Ze=ts(V),ot=je?u:sa(p),Xe=Ze?u:sa(V);ot=ot==r?S:ot,Xe=Xe==r?S:Xe;var kt=ot==S,$t=Xe==S,ct=ot==Xe;if(ct&&as(p)){if(!as(V))return!1;je=!0,kt=!1}if(ct&&!kt)return $e||($e=new aa),je||gl(p)?Ds(p,V,Y,re,Fe,$e):xn(p,V,ot,Y,re,Fe,$e);if(!(Y&l)){var Ct=kt&&Ft.call(p,"__wrapped__"),ft=$t&&Ft.call(V,"__wrapped__");if(Ct||ft){var Ca=Ct?p.value():p,ma=ft?V.value():V;return $e||($e=new aa),Fe(Ca,ma,Y,re,$e)}}return ct?($e||($e=new aa),wn(p,V,Y,re,Fe,$e)):!1}function bn(p){if(!pl(p)||Ln(p))return!1;var V=ml(p)?Zl:Q;return V.test(Tt(p))}function kn(p){return la(p)&&Os(p.length)&&!!X[Ma(p)]}function Cn(p){if(!An(p))return Na(p);var V=[];for(var Y in Object(p))Ft.call(p,Y)&&Y!="constructor"&&V.push(Y);return V}function Ds(p,V,Y,re,Fe,$e){var je=Y&l,Ze=p.length,ot=V.length;if(Ze!=ot&&!(je&&ot>Ze))return!1;var Xe=$e.get(p);if(Xe&&$e.get(V))return Xe==V;var kt=-1,$t=!0,ct=Y&i?new Qa:void 0;for($e.set(p,V),$e.set(V,p);++kt<Ze;){var Ct=p[kt],ft=V[kt];if(re)var Ca=je?re(ft,Ct,kt,V,p,$e):re(Ct,ft,kt,p,V,$e);if(Ca!==void 0){if(Ca)continue;$t=!1;break}if(ct){if(!Oe(V,function(ma,Va){if(!Ue(ct,Va)&&(Ct===ma||Fe(Ct,ma,Y,re,$e)))return ct.push(Va)})){$t=!1;break}}else if(!(Ct===ft||Fe(Ct,ft,Y,re,$e))){$t=!1;break}}return $e.delete(p),$e.delete(V),$t}function xn(p,V,Y,re,Fe,$e,je){switch(Y){case G:if(p.byteLength!=V.byteLength||p.byteOffset!=V.byteOffset)return!1;p=p.buffer,V=V.buffer;case D:return!(p.byteLength!=V.byteLength||!$e(new sl(p),new sl(V)));case f:case v:case b:return ul(+p,+V);case g:return p.name==V.name&&p.message==V.message;case I:case T:return p==V+"";case E:var Ze=ve;case L:var ot=re&l;if(Ze||(Ze=Me),p.size!=V.size&&!ot)return!1;var Xe=je.get(p);if(Xe)return Xe==V;re|=i,je.set(p,V);var kt=Ds(Ze(p),Ze(V),re,Fe,$e,je);return je.delete(p),kt;case w:if(Is)return Is.call(p)==Is.call(V)}return!1}function wn(p,V,Y,re,Fe,$e){var je=Y&l,Ze=Fa(p),ot=Ze.length,Xe=Fa(V),kt=Xe.length;if(ot!=kt&&!je)return!1;for(var $t=ot;$t--;){var ct=Ze[$t];if(!(je?ct in V:Ft.call(V,ct)))return!1}var Ct=$e.get(p);if(Ct&&$e.get(V))return Ct==V;var ft=!0;$e.set(p,V),$e.set(V,p);for(var Ca=je;++$t<ot;){ct=Ze[$t];var ma=p[ct],Va=V[ct];if(re)var Di=je?re(Va,ma,ct,V,p,$e):re(ma,Va,ct,p,V,$e);if(!(Di===void 0?ma===Va||Fe(ma,Va,Y,re,$e):Di)){ft=!1;break}Ca||(Ca=ct=="constructor")}if(ft&&!Ca){var fl=p.constructor,hl=V.constructor;fl!=hl&&"constructor"in p&&"constructor"in V&&!(typeof fl=="function"&&fl instanceof fl&&typeof hl=="function"&&hl instanceof hl)&&(ft=!1)}return $e.delete(p),$e.delete(V),ft}function Fa(p){return Ps(p,Ms,Tn)}function Zt(p,V){var Y=p.__data__;return En(V)?Y[typeof V=="string"?"string":"hash"]:Y.map}function ua(p,V){var Y=J(p,V);return bn(Y)?Y:void 0}function da(p){var V=Ft.call(p,Ht),Y=p[Ht];try{p[Ht]=void 0;var re=!0}catch{}var Fe=al.call(p);return re&&(V?p[Ht]=Y:delete p[Ht]),Fe}var Tn=Xa?function(p){return p==null?[]:(p=Object(p),Te(Xa(p),function(V){return Ja.call(p,V)}))}:$n,sa=Ma;(Ss&&sa(new Ss(new ArrayBuffer(1)))!=G||Oa&&sa(new Oa)!=E||Es&&sa(Es.resolve())!=P||Ls&&sa(new Ls)!=L||As&&sa(new As)!=z)&&(sa=function(p){var V=Ma(p),Y=V==S?p.constructor:void 0,re=Y?Tt(Y):"";if(re)switch(re){case ll:return G;case ca:return E;case Gl:return P;case Jl:return L;case Xl:return z}return V});function Sn(p,V){return V=V??o,!!V&&(typeof p=="number"||_e.test(p))&&p>-1&&p%1==0&&p<V}function En(p){var V=typeof p;return V=="string"||V=="number"||V=="symbol"||V=="boolean"?p!=="__proto__":p===null}function Ln(p){return!!tl&&tl in p}function An(p){var V=p&&p.constructor,Y=typeof V=="function"&&V.prototype||wt;return p===Y}function cl(p){return al.call(p)}function Tt(p){if(p!=null){try{return xs.call(p)}catch{}try{return p+""}catch{}}return""}function ul(p,V){return p===V||p!==p&&V!==V}var dl=ol(function(){return arguments}())?ol:function(p){return la(p)&&Ft.call(p,"callee")&&!Ja.call(p,"callee")},ts=Array.isArray;function Ns(p){return p!=null&&Os(p.length)&&!ml(p)}var as=Ts||Pn;function In(p,V){return rl(p,V)}function ml(p){if(!pl(p))return!1;var V=Ma(p);return V==k||V==N||V==d||V==h}function Os(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=o}function pl(p){var V=typeof p;return p!=null&&(V=="object"||V=="function")}function la(p){return p!=null&&typeof p=="object"}var gl=pe?ke(pe):kn;function Ms(p){return Ns(p)?_n(p):Cn(p)}function $n(){return[]}function Pn(){return!1}n.exports=In})(Pl,Pl.exports);var vi={};Object.defineProperty(vi,"__esModule",{value:!0});const qd=$l.exports,Ud=Pl.exports;var Xn;(function(n){function a(i={},o={},r=!1){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});let u=qd(o);r||(u=Object.keys(u).reduce((d,f)=>(u[f]!=null&&(d[f]=u[f]),d),{}));for(const d in i)i[d]!==void 0&&o[d]===void 0&&(u[d]=i[d]);return Object.keys(u).length>0?u:void 0}n.compose=a;function e(i={},o={}){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});const r=Object.keys(i).concat(Object.keys(o)).reduce((u,d)=>(Ud(i[d],o[d])||(u[d]=o[d]===void 0?null:o[d]),u),{});return Object.keys(r).length>0?r:void 0}n.diff=e;function s(i={},o={}){i=i||{};const r=Object.keys(o).reduce((u,d)=>(o[d]!==i[d]&&i[d]!==void 0&&(u[d]=o[d]),u),{});return Object.keys(i).reduce((u,d)=>(i[d]!==o[d]&&o[d]===void 0&&(u[d]=null),u),r)}n.invert=s;function l(i,o,r=!1){if(typeof i!="object")return o;if(typeof o!="object")return;if(!r)return o;const u=Object.keys(o).reduce((d,f)=>(i[f]===void 0&&(d[f]=o[f]),d),{});return Object.keys(u).length>0?u:void 0}n.transform=l})(Xn||(Xn={}));vi.default=Xn;var jl={};Object.defineProperty(jl,"__esModule",{value:!0});var Qn;(function(n){function a(e){return typeof e.delete=="number"?e.delete:typeof e.retain=="number"?e.retain:typeof e.retain=="object"&&e.retain!==null?1:typeof e.insert=="string"?e.insert.length:1}n.length=a})(Qn||(Qn={}));jl.default=Qn;var _i={};Object.defineProperty(_i,"__esModule",{value:!0});const Hi=jl;class zd{constructor(a){this.ops=a,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(a){a||(a=1/0);const e=this.ops[this.index];if(e){const s=this.offset,l=Hi.default.length(e);if(a>=l-s?(a=l-s,this.index+=1,this.offset=0):this.offset+=a,typeof e.delete=="number")return{delete:a};{const i={};return e.attributes&&(i.attributes=e.attributes),typeof e.retain=="number"?i.retain=a:typeof e.retain=="object"&&e.retain!==null?i.retain=e.retain:typeof e.insert=="string"?i.insert=e.insert.substr(s,a):i.insert=e.insert,i}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?Hi.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const a=this.ops[this.index];return a?typeof a.delete=="number"?"delete":typeof a.retain=="number"||typeof a.retain=="object"&&a.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const a=this.offset,e=this.index,s=this.next(),l=this.ops.slice(this.index);return this.offset=a,this.index=e,[s].concat(l)}}else return[]}}_i.default=zd;(function(n,a){Object.defineProperty(a,"__esModule",{value:!0}),a.AttributeMap=a.OpIterator=a.Op=void 0;const e=Rd,s=$l.exports,l=Pl.exports,i=vi;a.AttributeMap=i.default;const o=jl;a.Op=o.default;const r=_i;a.OpIterator=r.default;const u=String.fromCharCode(0),d=(v,g)=>{if(typeof v!="object"||v===null)throw new Error(`cannot retain a ${typeof v}`);if(typeof g!="object"||g===null)throw new Error(`cannot retain a ${typeof g}`);const k=Object.keys(v)[0];if(!k||k!==Object.keys(g)[0])throw new Error(`embed types not matched: ${k} != ${Object.keys(g)[0]}`);return[k,v[k],g[k]]};class f{constructor(g){Array.isArray(g)?this.ops=g:g!=null&&Array.isArray(g.ops)?this.ops=g.ops:this.ops=[]}static registerEmbed(g,k){this.handlers[g]=k}static unregisterEmbed(g){delete this.handlers[g]}static getHandler(g){const k=this.handlers[g];if(!k)throw new Error(`no handlers for embed type "${g}"`);return k}insert(g,k){const N={};return typeof g=="string"&&g.length===0?this:(N.insert=g,k!=null&&typeof k=="object"&&Object.keys(k).length>0&&(N.attributes=k),this.push(N))}delete(g){return g<=0?this:this.push({delete:g})}retain(g,k){if(typeof g=="number"&&g<=0)return this;const N={retain:g};return k!=null&&typeof k=="object"&&Object.keys(k).length>0&&(N.attributes=k),this.push(N)}push(g){let k=this.ops.length,N=this.ops[k-1];if(g=s(g),typeof N=="object"){if(typeof g.delete=="number"&&typeof N.delete=="number")return this.ops[k-1]={delete:N.delete+g.delete},this;if(typeof N.delete=="number"&&g.insert!=null&&(k-=1,N=this.ops[k-1],typeof N!="object"))return this.ops.unshift(g),this;if(l(g.attributes,N.attributes)){if(typeof g.insert=="string"&&typeof N.insert=="string")return this.ops[k-1]={insert:N.insert+g.insert},typeof g.attributes=="object"&&(this.ops[k-1].attributes=g.attributes),this;if(typeof g.retain=="number"&&typeof N.retain=="number")return this.ops[k-1]={retain:N.retain+g.retain},typeof g.attributes=="object"&&(this.ops[k-1].attributes=g.attributes),this}}return k===this.ops.length?this.ops.push(g):this.ops.splice(k,0,g),this}chop(){const g=this.ops[this.ops.length-1];return g&&typeof g.retain=="number"&&!g.attributes&&this.ops.pop(),this}filter(g){return this.ops.filter(g)}forEach(g){this.ops.forEach(g)}map(g){return this.ops.map(g)}partition(g){const k=[],N=[];return this.forEach(E=>{(g(E)?k:N).push(E)}),[k,N]}reduce(g,k){return this.ops.reduce(g,k)}changeLength(){return this.reduce((g,k)=>k.insert?g+o.default.length(k):k.delete?g-k.delete:g,0)}length(){return this.reduce((g,k)=>g+o.default.length(k),0)}slice(g=0,k=1/0){const N=[],E=new r.default(this.ops);let b=0;for(;b<k&&E.hasNext();){let A;b<g?A=E.next(g-b):(A=E.next(k-b),N.push(A)),b+=o.default.length(A)}return new f(N)}compose(g){const k=new r.default(this.ops),N=new r.default(g.ops),E=[],b=N.peek();if(b!=null&&typeof b.retain=="number"&&b.attributes==null){let S=b.retain;for(;k.peekType()==="insert"&&k.peekLength()<=S;)S-=k.peekLength(),E.push(k.next());b.retain-S>0&&N.next(b.retain-S)}const A=new f(E);for(;k.hasNext()||N.hasNext();)if(N.peekType()==="insert")A.push(N.next());else if(k.peekType()==="delete")A.push(k.next());else{const S=Math.min(k.peekLength(),N.peekLength()),P=k.next(S),h=N.next(S);if(h.retain){const I={};if(typeof P.retain=="number")I.retain=typeof h.retain=="number"?S:h.retain;else if(typeof h.retain=="number")P.retain==null?I.insert=P.insert:I.retain=P.retain;else{const T=P.retain==null?"insert":"retain",[w,B,z]=d(P[T],h.retain),D=f.getHandler(w);I[T]={[w]:D.compose(B,z,T==="retain")}}const L=i.default.compose(P.attributes,h.attributes,typeof P.retain=="number");if(L&&(I.attributes=L),A.push(I),!N.hasNext()&&l(A.ops[A.ops.length-1],I)){const T=new f(k.rest());return A.concat(T).chop()}}else typeof h.delete=="number"&&(typeof P.retain=="number"||typeof P.retain=="object"&&P.retain!==null)&&A.push(h)}return A.chop()}concat(g){const k=new f(this.ops.slice());return g.ops.length>0&&(k.push(g.ops[0]),k.ops=k.ops.concat(g.ops.slice(1))),k}diff(g,k){if(this.ops===g.ops)return new f;const N=[this,g].map(P=>P.map(h=>{if(h.insert!=null)return typeof h.insert=="string"?h.insert:u;const I=P===g?"on":"with";throw new Error("diff() called "+I+" non-document")}).join("")),E=new f,b=e(N[0],N[1],k,!0),A=new r.default(this.ops),S=new r.default(g.ops);return b.forEach(P=>{let h=P[1].length;for(;h>0;){let I=0;switch(P[0]){case e.INSERT:I=Math.min(S.peekLength(),h),E.push(S.next(I));break;case e.DELETE:I=Math.min(h,A.peekLength()),A.next(I),E.delete(I);break;case e.EQUAL:I=Math.min(A.peekLength(),S.peekLength(),h);const L=A.next(I),T=S.next(I);l(L.insert,T.insert)?E.retain(I,i.default.diff(L.attributes,T.attributes)):E.push(T).delete(I);break}h-=I}}),E.chop()}eachLine(g,k=`
`){const N=new r.default(this.ops);let E=new f,b=0;for(;N.hasNext();){if(N.peekType()!=="insert")return;const A=N.peek(),S=o.default.length(A)-N.peekLength(),P=typeof A.insert=="string"?A.insert.indexOf(k,S)-S:-1;if(P<0)E.push(N.next());else if(P>0)E.push(N.next(P));else{if(g(E,N.next(1).attributes||{},b)===!1)return;b+=1,E=new f}}E.length()>0&&g(E,{},b)}invert(g){const k=new f;return this.reduce((N,E)=>{if(E.insert)k.delete(o.default.length(E));else{if(typeof E.retain=="number"&&E.attributes==null)return k.retain(E.retain),N+E.retain;if(E.delete||typeof E.retain=="number"){const b=E.delete||E.retain;return g.slice(N,N+b).forEach(S=>{E.delete?k.push(S):E.retain&&E.attributes&&k.retain(o.default.length(S),i.default.invert(E.attributes,S.attributes))}),N+b}else if(typeof E.retain=="object"&&E.retain!==null){const b=g.slice(N,N+1),A=new r.default(b.ops).next(),[S,P,h]=d(E.retain,A.insert),I=f.getHandler(S);return k.retain({[S]:I.invert(P,h)},i.default.invert(E.attributes,A.attributes)),N+1}}return N},0),k.chop()}transform(g,k=!1){if(k=!!k,typeof g=="number")return this.transformPosition(g,k);const N=g,E=new r.default(this.ops),b=new r.default(N.ops),A=new f;for(;E.hasNext()||b.hasNext();)if(E.peekType()==="insert"&&(k||b.peekType()!=="insert"))A.retain(o.default.length(E.next()));else if(b.peekType()==="insert")A.push(b.next());else{const S=Math.min(E.peekLength(),b.peekLength()),P=E.next(S),h=b.next(S);if(P.delete)continue;if(h.delete)A.push(h);else{const I=P.retain,L=h.retain;let T=typeof L=="object"&&L!==null?L:S;if(typeof I=="object"&&I!==null&&typeof L=="object"&&L!==null){const w=Object.keys(I)[0];if(w===Object.keys(L)[0]){const B=f.getHandler(w);B&&(T={[w]:B.transform(I[w],L[w],k)})}}A.retain(T,i.default.transform(P.attributes,h.attributes,k))}}return A.chop()}transformPosition(g,k=!1){k=!!k;const N=new r.default(this.ops);let E=0;for(;N.hasNext()&&E<=g;){const b=N.peekLength(),A=N.peekType();if(N.next(),A==="delete"){g-=Math.min(b,g-E);continue}else A==="insert"&&(E<g||!k)&&(g+=b);E+=b}return g}}f.Op=o.default,f.OpIterator=r.default,f.AttributeMap=i.default,f.handlers={},a.default=f,n.exports=f,n.exports.default=f})(Pt,Pt.exports);var Le=Ur(Pt.exports);class ta extends Mt{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}ta.blotName="break";ta.tagName="BR";class Kt extends Il{}const jd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Yl(n){return n.replace(/[&<>"']/g,a=>jd[a])}class St extends pi{static allowedChildren=[St,ta,Mt,Kt];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(a,e){const s=St.order.indexOf(a),l=St.order.indexOf(e);return s>=0||l>=0?s-l:a===e?0:a<e?-1:1}formatAt(a,e,s,l){if(St.compare(this.statics.blotName,s)<0&&this.scroll.query(s,Ie.BLOT)){const i=this.isolate(a,e);l&&i.wrap(s,l)}else super.formatAt(a,e,s,l)}optimize(a){if(super.optimize(a),this.parent instanceof St&&St.compare(this.statics.blotName,this.parent.statics.blotName)>0){const e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}}const Zi=1;class vt extends zs{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=jo(this)),this.cache.delta}deleteAt(a,e){super.deleteAt(a,e),this.cache={}}formatAt(a,e,s,l){e<=0||(this.scroll.query(s,Ie.BLOCK)?a+e===this.length()&&this.format(s,l):super.formatAt(a,Math.min(e,this.length()-a-1),s,l),this.cache={})}insertAt(a,e,s){if(s!=null){super.insertAt(a,e,s),this.cache={};return}if(e.length===0)return;const l=e.split(`
`),i=l.shift();i.length>0&&(a<this.length()-1||this.children.tail==null?super.insertAt(Math.min(a,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});let o=this;l.reduce((r,u)=>(o=o.split(r,!0),o.insertAt(0,u),u.length),a+i.length)}insertBefore(a,e){const{head:s}=this.children;super.insertBefore(a,e),s instanceof ta&&s.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Zi),this.cache.length}moveChildren(a,e){super.moveChildren(a,e),this.cache={}}optimize(a){super.optimize(a),this.cache={}}path(a){return super.path(a,!0)}removeChild(a){super.removeChild(a),this.cache={}}split(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e&&(a===0||a>=this.length()-Zi)){const l=this.clone();return a===0?(this.parent.insertBefore(l,this),this):(this.parent.insertBefore(l,this.next),l)}const s=super.split(a,e);return this.cache={},s}}vt.blotName="block";vt.tagName="P";vt.defaultChild=ta;vt.allowedChildren=[ta,St,Mt,Kt];class Ut extends Mt{attach(){super.attach(),this.attributes=new Rl(this.domNode)}delta(){return new Le().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(a,e){const s=this.scroll.query(a,Ie.BLOCK_ATTRIBUTE);s!=null&&this.attributes.attribute(s,e)}formatAt(a,e,s,l){this.format(s,l)}insertAt(a,e,s){if(s!=null){super.insertAt(a,e,s);return}const l=e.split(`
`),i=l.pop(),o=l.map(u=>{const d=this.scroll.create(vt.blotName);return d.insertAt(0,u),d}),r=this.split(a);o.forEach(u=>{this.parent.insertBefore(u,r)}),i&&this.parent.insertBefore(this.scroll.create("text",i),r)}}Ut.scope=Ie.BLOCK_BLOT;function jo(n){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.descendants(xt).reduce((e,s)=>s.length()===0?e:e.insert(s.value(),Rt(s,{},a)),new Le).insert(`
`,Rt(n))}function Rt(n){let a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return n==null||("formats"in n&&typeof n.formats=="function"&&(a={...a,...n.formats()},e&&delete a["code-token"]),n.parent==null||n.parent.statics.blotName==="scroll"||n.parent.statics.scope!==n.statics.scope)?a:Rt(n.parent,a,e)}class Jt extends Mt{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(a,e,s){super(a,e),this.selection=s,this.textNode=document.createTextNode(Jt.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(a,e){if(this.savedLength!==0){super.format(a,e);return}let s=this,l=0;for(;s!=null&&s.statics.scope!==Ie.BLOCK_BLOT;)l+=s.offset(s.parent),s=s.parent;s!=null&&(this.savedLength=Jt.CONTENTS.length,s.optimize(),s.formatAt(l,Jt.CONTENTS.length,a,e),this.savedLength=0)}index(a,e){return a===this.textNode?0:super.index(a,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const a=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof Kt?this.prev:null,s=e?e.length():0,l=this.next instanceof Kt?this.next:null,i=l?l.text:"",{textNode:o}=this,r=o.data.split(Jt.CONTENTS).join("");o.data=Jt.CONTENTS;let u;if(e)u=e,(r||l)&&(e.insertAt(e.length(),r+i),l&&l.remove());else if(l)u=l,l.insertAt(0,r);else{const d=document.createTextNode(r);u=this.scroll.create(d),this.parent.insertBefore(u,this)}if(this.remove(),a){const d=(g,k)=>e&&g===e.domNode?k:g===o?s+k-1:l&&g===l.domNode?s+r.length+k:null,f=d(a.start.node,a.start.offset),v=d(a.end.node,a.end.offset);if(f!==null&&v!==null)return{startNode:u.domNode,startOffset:f,endNode:u.domNode,endOffset:v}}return null}update(a,e){if(a.some(s=>s.type==="characterData"&&s.target===this.textNode)){const s=this.restore();s&&(e.range=s)}}optimize(a){super.optimize(a);let{parent:e}=this;for(;e;){if(e.domNode.tagName==="A"){this.savedLength=Jt.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}}var Yo={exports:{}};(function(n){var a=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function l(u,d,f){this.fn=u,this.context=d,this.once=f||!1}function i(u,d,f,v,g){if(typeof f!="function")throw new TypeError("The listener must be a function");var k=new l(f,v||u,g),N=e?e+d:d;return u._events[N]?u._events[N].fn?u._events[N]=[u._events[N],k]:u._events[N].push(k):(u._events[N]=k,u._eventsCount++),u}function o(u,d){--u._eventsCount===0?u._events=new s:delete u._events[d]}function r(){this._events=new s,this._eventsCount=0}r.prototype.eventNames=function(){var d=[],f,v;if(this._eventsCount===0)return d;for(v in f=this._events)a.call(f,v)&&d.push(e?v.slice(1):v);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(f)):d},r.prototype.listeners=function(d){var f=e?e+d:d,v=this._events[f];if(!v)return[];if(v.fn)return[v.fn];for(var g=0,k=v.length,N=new Array(k);g<k;g++)N[g]=v[g].fn;return N},r.prototype.listenerCount=function(d){var f=e?e+d:d,v=this._events[f];return v?v.fn?1:v.length:0},r.prototype.emit=function(d,f,v,g,k,N){var E=e?e+d:d;if(!this._events[E])return!1;var b=this._events[E],A=arguments.length,S,P;if(b.fn){switch(b.once&&this.removeListener(d,b.fn,void 0,!0),A){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,f),!0;case 3:return b.fn.call(b.context,f,v),!0;case 4:return b.fn.call(b.context,f,v,g),!0;case 5:return b.fn.call(b.context,f,v,g,k),!0;case 6:return b.fn.call(b.context,f,v,g,k,N),!0}for(P=1,S=new Array(A-1);P<A;P++)S[P-1]=arguments[P];b.fn.apply(b.context,S)}else{var h=b.length,I;for(P=0;P<h;P++)switch(b[P].once&&this.removeListener(d,b[P].fn,void 0,!0),A){case 1:b[P].fn.call(b[P].context);break;case 2:b[P].fn.call(b[P].context,f);break;case 3:b[P].fn.call(b[P].context,f,v);break;case 4:b[P].fn.call(b[P].context,f,v,g);break;default:if(!S)for(I=1,S=new Array(A-1);I<A;I++)S[I-1]=arguments[I];b[P].fn.apply(b[P].context,S)}}return!0},r.prototype.on=function(d,f,v){return i(this,d,f,v,!1)},r.prototype.once=function(d,f,v){return i(this,d,f,v,!0)},r.prototype.removeListener=function(d,f,v,g){var k=e?e+d:d;if(!this._events[k])return this;if(!f)return o(this,k),this;var N=this._events[k];if(N.fn)N.fn===f&&(!g||N.once)&&(!v||N.context===v)&&o(this,k);else{for(var E=0,b=[],A=N.length;E<A;E++)(N[E].fn!==f||g&&!N[E].once||v&&N[E].context!==v)&&b.push(N[E]);b.length?this._events[k]=b.length===1?b[0]:b:o(this,k)}return this},r.prototype.removeAllListeners=function(d){var f;return d?(f=e?e+d:d,this._events[f]&&o(this,f)):(this._events=new s,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=e,r.EventEmitter=r,n.exports=r})(Yo);var Yd=Yo.exports,Kn=new WeakMap;const ei=["error","warn","log","info"];let ti="warn";function Wo(n){if(ti&&ei.indexOf(n)<=ei.indexOf(ti)){for(var a=arguments.length,e=new Array(a>1?a-1:0),s=1;s<a;s++)e[s-1]=arguments[s];console[n](...e)}}function ya(n){return ei.reduce((a,e)=>(a[e]=Wo.bind(console,e,n),a),{})}ya.level=n=>{ti=n};Wo.level=ya.level;const Fn=ya("quill:events"),Wd=["selectionchange","mousedown","mouseup","click"];Wd.forEach(n=>{document.addEventListener(n,function(){for(var a=arguments.length,e=new Array(a),s=0;s<a;s++)e[s]=arguments[s];Array.from(document.querySelectorAll(".ql-container")).forEach(l=>{const i=Kn.get(l);i&&i.emitter&&i.emitter.handleDOM(...e)})})});class Ee extends Yd{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",Fn.error)}emit(){for(var a=arguments.length,e=new Array(a),s=0;s<a;s++)e[s]=arguments[s];return Fn.log.call(Fn,...e),super.emit(...e)}handleDOM(a){for(var e=arguments.length,s=new Array(e>1?e-1:0),l=1;l<e;l++)s[l-1]=arguments[l];(this.domListeners[a.type]||[]).forEach(i=>{let{node:o,handler:r}=i;(a.target===o||o.contains(a.target))&&r(a,...s)})}listenDOM(a,e,s){this.domListeners[a]||(this.domListeners[a]=[]),this.domListeners[a].push({node:e,handler:s})}}const Vn=ya("quill:selection");class Ra{constructor(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=a,this.length=e}}class Hd{constructor(a,e){this.emitter=e,this.scroll=a,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Ra(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,Ee.sources.USER),1)}),this.emitter.on(Ee.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const s=this.getNativeRange();s!=null&&s.start.node!==this.cursor.textNode&&this.emitter.once(Ee.events.SCROLL_UPDATE,(l,i)=>{try{this.root.contains(s.start.node)&&this.root.contains(s.end.node)&&this.setNativeRange(s.start.node,s.start.offset,s.end.node,s.end.offset);const o=i.some(r=>r.type==="characterData"||r.type==="childList"||r.type==="attributes"&&r.target===this.root);this.update(o?Ee.sources.SILENT:l)}catch{}})}),this.emitter.on(Ee.events.SCROLL_OPTIMIZE,(s,l)=>{if(l.range){const{startNode:i,startOffset:o,endNode:r,endOffset:u}=l.range;this.setNativeRange(i,o,r,u),this.update(Ee.sources.SILENT)}}),this.update(Ee.sources.SILENT)}handleComposition(){this.emitter.on(Ee.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(Ee.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const a=this.cursor.restore();if(!a)return;setTimeout(()=>{this.setNativeRange(a.startNode,a.startOffset,a.endNode,a.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(Ee.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(a,e){this.scroll.update();const s=this.getNativeRange();if(!(s==null||!s.native.collapsed||this.scroll.query(a,Ie.BLOCK))){if(s.start.node!==this.cursor.textNode){const l=this.scroll.find(s.start.node,!1);if(l==null)return;if(l instanceof xt){const i=l.split(s.start.offset);l.parent.insertBefore(this.cursor,i)}else l.insertBefore(this.cursor,s.start.node);this.cursor.attach()}this.cursor.format(a,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=this.scroll.length();a=Math.min(a,s-1),e=Math.min(a+e,s-1)-a;let l,[i,o]=this.scroll.leaf(a);if(i==null)return null;if(e>0&&o===i.length()){const[f]=this.scroll.leaf(a+1);if(f){const[v]=this.scroll.line(a),[g]=this.scroll.line(a+1);v===g&&(i=f,o=0)}}[l,o]=i.position(o,!0);const r=document.createRange();if(e>0)return r.setStart(l,o),[i,o]=this.scroll.leaf(a+e),i==null?null:([l,o]=i.position(o,!0),r.setEnd(l,o),r.getBoundingClientRect());let u="left",d;if(l instanceof Text){if(!l.data.length)return null;o<l.data.length?(r.setStart(l,o),r.setEnd(l,o+1)):(r.setStart(l,o-1),r.setEnd(l,o),u="right"),d=r.getBoundingClientRect()}else{if(!(i.domNode instanceof Element))return null;d=i.domNode.getBoundingClientRect(),o>0&&(u="right")}return{bottom:d.top+d.height,height:d.height,left:d[u],right:d[u],top:d.top,width:0}}getNativeRange(){const a=document.getSelection();if(a==null||a.rangeCount<=0)return null;const e=a.getRangeAt(0);if(e==null)return null;const s=this.normalizeNative(e);return Vn.info("getNativeRange",s),s}getRange(){const a=this.scroll.domNode;if("isConnected"in a&&!a.isConnected)return[null,null];const e=this.getNativeRange();return e==null?[null,null]:[this.normalizedToRange(e),e]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&Bn(this.root,document.activeElement)}normalizedToRange(a){const e=[[a.start.node,a.start.offset]];a.native.collapsed||e.push([a.end.node,a.end.offset]);const s=e.map(o=>{const[r,u]=o,d=this.scroll.find(r,!0),f=d.offset(this.scroll);return u===0?f:d instanceof xt?f+d.index(r,u):f+d.length()}),l=Math.min(Math.max(...s),this.scroll.length()-1),i=Math.min(l,...s);return new Ra(i,l-i)}normalizeNative(a){if(!Bn(this.root,a.startContainer)||!a.collapsed&&!Bn(this.root,a.endContainer))return null;const e={start:{node:a.startContainer,offset:a.startOffset},end:{node:a.endContainer,offset:a.endOffset},native:a};return[e.start,e.end].forEach(s=>{let{node:l,offset:i}=s;for(;!(l instanceof Text)&&l.childNodes.length>0;)if(l.childNodes.length>i)l=l.childNodes[i],i=0;else if(l.childNodes.length===i)l=l.lastChild,l instanceof Text?i=l.data.length:l.childNodes.length>0?i=l.childNodes.length:i=l.childNodes.length+1;else break;s.node=l,s.offset=i}),e}rangeToNative(a){const e=this.scroll.length(),s=(l,i)=>{l=Math.min(e-1,l);const[o,r]=this.scroll.leaf(l);return o?o.position(r,i):[null,-1]};return[...s(a.index,!1),...s(a.index+a.length,!0)]}setNativeRange(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(Vn.info("setNativeRange",a,e,s,l),a!=null&&(this.root.parentNode==null||a.parentNode==null||s.parentNode==null))return;const o=document.getSelection();if(o!=null)if(a!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:r}=this.getNativeRange()||{};if(r==null||i||a!==r.startContainer||e!==r.startOffset||s!==r.endContainer||l!==r.endOffset){a instanceof Element&&a.tagName==="BR"&&(e=Array.from(a.parentNode.childNodes).indexOf(a),a=a.parentNode),s instanceof Element&&s.tagName==="BR"&&(l=Array.from(s.parentNode.childNodes).indexOf(s),s=s.parentNode);const u=document.createRange();u.setStart(a,e),u.setEnd(s,l),o.removeAllRanges(),o.addRange(u)}}else o.removeAllRanges(),this.root.blur()}setRange(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ee.sources.API;if(typeof e=="string"&&(s=e,e=!1),Vn.info("setRange",a),a!=null){const l=this.rangeToNative(a);this.setNativeRange(...l,e)}else this.setNativeRange(null);this.update(s)}update(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ee.sources.USER;const e=this.lastRange,[s,l]=this.getRange();if(this.lastRange=s,this.lastNative=l,this.lastRange!=null&&(this.savedRange=this.lastRange),!ci(e,this.lastRange)){if(!this.composing&&l!=null&&l.native.collapsed&&l.start.node!==this.cursor.textNode){const o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}const i=[Ee.events.SELECTION_CHANGE,ms(this.lastRange),ms(e),a];this.emitter.emit(Ee.events.EDITOR_CHANGE,...i),a!==Ee.sources.SILENT&&this.emitter.emit(...i)}}}function Bn(n,a){try{a.parentNode}catch{return!1}return n.contains(a)}const Zd=/^[ -~]*$/;class Gd{constructor(a){this.scroll=a,this.delta=this.getDelta()}applyDelta(a){this.scroll.update();let e=this.scroll.length();this.scroll.batchStart();const s=Gi(a),l=new Le;return Xd(s.ops.slice()).reduce((o,r)=>{const u=Pt.exports.Op.length(r);let d=r.attributes||{},f=!1,v=!1;if(r.insert!=null){if(l.retain(u),typeof r.insert=="string"){const N=r.insert;v=!N.endsWith(`
`)&&(e<=o||!!this.scroll.descendant(Ut,o)[0]),this.scroll.insertAt(o,N);const[E,b]=this.scroll.line(o);let A=La({},Rt(E));if(E instanceof vt){const[S]=E.descendant(xt,b);S&&(A=La(A,Rt(S)))}d=Pt.exports.AttributeMap.diff(A,d)||{}}else if(typeof r.insert=="object"){const N=Object.keys(r.insert)[0];if(N==null)return o;const E=this.scroll.query(N,Ie.INLINE)!=null;if(E)(e<=o||!!this.scroll.descendant(Ut,o)[0])&&(v=!0);else if(o>0){const[b,A]=this.scroll.descendant(xt,o-1);b instanceof Kt?b.value()[A]!==`
`&&(f=!0):b instanceof Mt&&b.statics.scope===Ie.INLINE_BLOT&&(f=!0)}if(this.scroll.insertAt(o,N,r.insert[N]),E){const[b]=this.scroll.descendant(xt,o);if(b){const A=La({},Rt(b));d=Pt.exports.AttributeMap.diff(A,d)||{}}}}e+=u}else if(l.push(r),r.retain!==null&&typeof r.retain=="object"){const N=Object.keys(r.retain)[0];if(N==null)return o;this.scroll.updateEmbedAt(o,N,r.retain[N])}Object.keys(d).forEach(N=>{this.scroll.formatAt(o,u,N,d[N])});const g=f?1:0,k=v?1:0;return e+=g+k,l.retain(g),l.delete(k),o+u+g+k},0),l.reduce((o,r)=>typeof r.delete=="number"?(this.scroll.deleteAt(o,r.delete),o):o+Pt.exports.Op.length(r),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(s)}deleteText(a,e){return this.scroll.deleteAt(a,e),this.update(new Le().retain(a).delete(e))}formatLine(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(s).forEach(i=>{this.scroll.lines(a,Math.max(e,1)).forEach(o=>{o.format(i,s[i])})}),this.scroll.optimize();const l=new Le().retain(a).retain(e,ms(s));return this.update(l)}formatText(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(s).forEach(i=>{this.scroll.formatAt(a,e,i,s[i])});const l=new Le().retain(a).retain(e,ms(s));return this.update(l)}getContents(a,e){return this.delta.slice(a,a+e)}getDelta(){return this.scroll.lines().reduce((a,e)=>a.concat(e.delta()),new Le)}getFormat(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=[],l=[];e===0?this.scroll.path(a).forEach(r=>{const[u]=r;u instanceof vt?s.push(u):u instanceof xt&&l.push(u)}):(s=this.scroll.lines(a,e),l=this.scroll.descendants(xt,a,e));const[i,o]=[s,l].map(r=>{const u=r.shift();if(u==null)return{};let d=Rt(u);for(;Object.keys(d).length>0;){const f=r.shift();if(f==null)return d;d=Jd(Rt(f),d)}return d});return{...i,...o}}getHTML(a,e){const[s,l]=this.scroll.line(a);if(s){const i=s.length();return s.length()>=l+e&&!(l===0&&e===i)?Ys(s,l,e,!0):Ys(this.scroll,a,e,!0)}return""}getText(a,e){return this.getContents(a,e).filter(s=>typeof s.insert=="string").map(s=>s.insert).join("")}insertContents(a,e){const s=Gi(e),l=new Le().retain(a).concat(s);return this.scroll.insertContents(a,s),this.update(l)}insertEmbed(a,e,s){return this.scroll.insertAt(a,e,s),this.update(new Le().retain(a).insert({[e]:s}))}insertText(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(a,e),Object.keys(s).forEach(l=>{this.scroll.formatAt(a,e.length,l,s[l])}),this.update(new Le().retain(a).insert(e,ms(s)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const a=this.scroll.children.head;if(a?.statics.blotName!==vt.blotName)return!1;const e=a;return e.children.length>1?!1:e.children.head instanceof ta}removeFormat(a,e){const s=this.getText(a,e),[l,i]=this.scroll.line(a+e);let o=0,r=new Le;l!=null&&(o=l.length()-i,r=l.delta().slice(i,i+o-1).insert(`
`));const d=this.getContents(a,e+o).diff(new Le().insert(s).concat(r)),f=new Le().retain(a).concat(d);return this.applyDelta(f)}update(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const l=this.delta;if(e.length===1&&e[0].type==="characterData"&&e[0].target.data.match(Zd)&&this.scroll.find(e[0].target)){const i=this.scroll.find(e[0].target),o=Rt(i),r=i.offset(this.scroll),u=e[0].oldValue.replace(Jt.CONTENTS,""),d=new Le().insert(u),f=new Le().insert(i.value()),v=s&&{oldRange:Ji(s.oldRange,-r),newRange:Ji(s.newRange,-r)};a=new Le().retain(r).concat(d.diff(f,v)).reduce((k,N)=>N.insert?k.insert(N.insert,o):k.push(N),new Le),this.delta=l.compose(a)}else this.delta=this.getDelta(),(!a||!ci(l.compose(a),this.delta))&&(a=l.diff(this.delta,s));return a}}function us(n,a,e){if(n.length===0){const[k]=Rn(e.pop());return a<=0?`</li></${k}>`:`</li></${k}>${us([],a-1,e)}`}const[{child:s,offset:l,length:i,indent:o,type:r},...u]=n,[d,f]=Rn(r);if(o>a)return e.push(r),o===a+1?`<${d}><li${f}>${Ys(s,l,i)}${us(u,o,e)}`:`<${d}><li>${us(n,a+1,e)}`;const v=e[e.length-1];if(o===a&&r===v)return`</li><li${f}>${Ys(s,l,i)}${us(u,o,e)}`;const[g]=Rn(e.pop());return`</li></${g}>${us(n,a-1,e)}`}function Ys(n,a,e){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in n&&typeof n.html=="function")return n.html(a,e);if(n instanceof Kt)return Yl(n.value().slice(a,a+e)).replaceAll(" ","&nbsp;");if(n instanceof Qt){if(n.statics.blotName==="list-container"){const d=[];return n.children.forEachAt(a,e,(f,v,g)=>{const k="formats"in f&&typeof f.formats=="function"?f.formats():{};d.push({child:f,offset:v,length:g,indent:k.indent||0,type:k.list})}),us(d,-1,[])}const l=[];if(n.children.forEachAt(a,e,(d,f,v)=>{l.push(Ys(d,f,v))}),s||n.statics.blotName==="list")return l.join("");const{outerHTML:i,innerHTML:o}=n.domNode,[r,u]=i.split(`>${o}<`);return r==="<table"?`<table style="border: 1px solid #000;">${l.join("")}<${u}`:`${r}>${l.join("")}<${u}`}return n.domNode instanceof Element?n.domNode.outerHTML:""}function Jd(n,a){return Object.keys(a).reduce((e,s)=>{if(n[s]==null)return e;const l=a[s];return l===n[s]?e[s]=l:Array.isArray(l)?l.indexOf(n[s])<0?e[s]=l.concat([n[s]]):e[s]=l:e[s]=[l,n[s]],e},{})}function Rn(n){const a=n==="ordered"?"ol":"ul";switch(n){case"checked":return[a,' data-list="checked"'];case"unchecked":return[a,' data-list="unchecked"'];default:return[a,""]}}function Gi(n){return n.reduce((a,e)=>{if(typeof e.insert=="string"){const s=e.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return a.insert(s,e.attributes)}return a.push(e)},new Le)}function Ji(n,a){let{index:e,length:s}=n;return new Ra(e+a,s)}function Xd(n){const a=[];return n.forEach(e=>{typeof e.insert=="string"?e.insert.split(`
`).forEach((l,i)=>{i&&a.push({insert:`
`,attributes:e.attributes}),l&&a.push({insert:l,attributes:e.attributes})}):a.push(e)}),a}class ra{static DEFAULTS={};constructor(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=a,this.options=e}}const vl="\uFEFF";class yi extends Mt{constructor(a,e){super(a,e),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(s=>{this.contentNode.appendChild(s)}),this.leftGuard=document.createTextNode(vl),this.rightGuard=document.createTextNode(vl),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(a,e){return a===this.leftGuard?0:a===this.rightGuard?1:super.index(a,e)}restore(a){let e=null,s;const l=a.data.split(vl).join("");if(a===this.leftGuard)if(this.prev instanceof Kt){const i=this.prev.length();this.prev.insertAt(i,l),e={startNode:this.prev.domNode,startOffset:i+l.length}}else s=document.createTextNode(l),this.parent.insertBefore(this.scroll.create(s),this),e={startNode:s,startOffset:l.length};else a===this.rightGuard&&(this.next instanceof Kt?(this.next.insertAt(0,l),e={startNode:this.next.domNode,startOffset:l.length}):(s=document.createTextNode(l),this.parent.insertBefore(this.scroll.create(s),this.next),e={startNode:s,startOffset:l.length}));return a.data=vl,e}update(a,e){a.forEach(s=>{if(s.type==="characterData"&&(s.target===this.leftGuard||s.target===this.rightGuard)){const l=this.restore(s.target);l&&(e.range=l)}})}}class Qd{isComposing=!1;constructor(a,e){this.scroll=a,this.emitter=e,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",a=>{this.isComposing||this.handleCompositionStart(a)}),this.scroll.domNode.addEventListener("compositionend",a=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(a)})})}handleCompositionStart(a){const e=a.target instanceof Node?this.scroll.find(a.target,!0):null;e&&!(e instanceof yi)&&(this.emitter.emit(Ee.events.COMPOSITION_BEFORE_START,a),this.scroll.batchStart(),this.emitter.emit(Ee.events.COMPOSITION_START,a),this.isComposing=!0)}handleCompositionEnd(a){this.emitter.emit(Ee.events.COMPOSITION_BEFORE_END,a),this.scroll.batchEnd(),this.emitter.emit(Ee.events.COMPOSITION_END,a),this.isComposing=!1}}class Cs{static DEFAULTS={modules:{}};static themes={default:Cs};modules={};constructor(a,e){this.quill=a,this.options=e}init(){Object.keys(this.options.modules).forEach(a=>{this.modules[a]==null&&this.addModule(a)})}addModule(a){const e=this.quill.constructor.import(`modules/${a}`);return this.modules[a]=new e(this.quill,this.options.modules[a]||{}),this.modules[a]}}const Kd=n=>n.parentElement||n.getRootNode().host||null,em=n=>{const a=n.getBoundingClientRect(),e="offsetWidth"in n&&Math.abs(a.width)/n.offsetWidth||1,s="offsetHeight"in n&&Math.abs(a.height)/n.offsetHeight||1;return{top:a.top,right:a.left+n.clientWidth*e,bottom:a.top+n.clientHeight*s,left:a.left}},_l=n=>{const a=parseInt(n,10);return Number.isNaN(a)?0:a},Xi=(n,a,e,s,l,i)=>n<e&&a>s?0:n<e?-(e-n+l):a>s?a-n>s-e?n+l-e:a-s+i:0,tm=(n,a)=>{const e=n.ownerDocument;let s=a,l=n;for(;l;){const i=l===e.body,o=i?{top:0,right:window.visualViewport?.width??e.documentElement.clientWidth,bottom:window.visualViewport?.height??e.documentElement.clientHeight,left:0}:em(l),r=getComputedStyle(l),u=Xi(s.left,s.right,o.left,o.right,_l(r.scrollPaddingLeft),_l(r.scrollPaddingRight)),d=Xi(s.top,s.bottom,o.top,o.bottom,_l(r.scrollPaddingTop),_l(r.scrollPaddingBottom));if(u||d)if(i)e.defaultView?.scrollBy(u,d);else{const{scrollLeft:f,scrollTop:v}=l;d&&(l.scrollTop+=d),u&&(l.scrollLeft+=u);const g=l.scrollLeft-f,k=l.scrollTop-v;s={left:s.left-g,top:s.top-k,right:s.right-g,bottom:s.bottom-k}}l=i||r.position==="fixed"?null:Kd(l)}},am=100,sm=["block","break","cursor","inline","scroll","text"],lm=(n,a,e)=>{const s=new _s;return sm.forEach(l=>{const i=a.query(l);i&&s.register(i)}),n.forEach(l=>{let i=a.query(l);i||e.error(`Cannot register "${l}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;i;)if(s.register(i),i="blotName"in i?i.requiredContainer??null:null,o+=1,o>am){e.error(`Cycle detected in registering blot requiredContainer: "${l}"`);break}}),s},gs=ya("quill"),yl=new _s;Qt.uiClass="ql-ui";class ue{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:yl,theme:"default"};static events=Ee.events;static sources=Ee.sources;static version="2.0.3";static imports={delta:Le,parchment:Id,"core/module":ra,"core/theme":Cs};static debug(a){a===!0&&(a="log"),ya.level(a)}static find(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return Kn.get(a)||yl.find(a,e)}static import(a){return this.imports[a]==null&&gs.error(`Cannot import ${a}. Are you sure it was registered?`),this.imports[a]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const a=arguments.length<=0?void 0:arguments[0],e=!!(!(arguments.length<=1)&&arguments[1]),s="attrName"in a?a.attrName:a.blotName;typeof s=="string"?this.register(`formats/${s}`,a,e):Object.keys(a).forEach(l=>{this.register(l,a[l],e)})}else{const a=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1],s=!!(!(arguments.length<=2)&&arguments[2]);this.imports[a]!=null&&!s&&gs.warn(`Overwriting ${a} with`,e),this.imports[a]=e,(a.startsWith("blots/")||a.startsWith("formats/"))&&e&&typeof e!="boolean"&&e.blotName!=="abstract"&&yl.register(e),typeof e.register=="function"&&e.register(yl)}}constructor(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=nm(a,e),this.container=this.options.container,this.container==null){gs.error("Invalid Quill container",a);return}this.options.debug&&ue.debug(this.options.debug);const s=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",Kn.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new Ee;const l=gi.blotName,i=this.options.registry.query(l);if(!i||!("blotName"in i))throw new Error(`Cannot initialize Quill without "${l}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new Gd(this.scroll),this.selection=new Hd(this.scroll,this.emitter),this.composition=new Qd(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(Ee.events.EDITOR_CHANGE,o=>{o===Ee.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(Ee.events.SCROLL_UPDATE,(o,r)=>{const u=this.selection.lastRange,[d]=this.selection.getRange(),f=u&&d?{oldRange:u,newRange:d}:void 0;Gt.call(this,()=>this.editor.update(null,r,f),o)}),this.emitter.on(Ee.events.SCROLL_EMBED_UPDATE,(o,r)=>{const u=this.selection.lastRange,[d]=this.selection.getRange(),f=u&&d?{oldRange:u,newRange:d}:void 0;Gt.call(this,()=>{const v=new Le().retain(o.offset(this)).retain({[o.statics.blotName]:r});return this.editor.update(v,[],f)},ue.sources.USER)}),s){const o=this.clipboard.convert({html:`${s}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof a=="string"){const s=a;a=document.createElement("div"),a.classList.add(s)}return this.container.insertBefore(a,e),a}blur(){this.selection.setRange(null)}deleteText(a,e,s){return[a,e,,s]=pa(a,e,s),Gt.call(this,()=>this.editor.deleteText(a,e),s,a,-1*e)}disable(){this.enable(!1)}editReadOnly(a){this.allowReadOnlyEdits=!0;const e=a();return this.allowReadOnlyEdits=!1,e}enable(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(a),this.container.classList.toggle("ql-disabled",!a)}focus(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),a.preventScroll||this.scrollSelectionIntoView()}format(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ee.sources.API;return Gt.call(this,()=>{const l=this.getSelection(!0);let i=new Le;if(l==null)return i;if(this.scroll.query(a,Ie.BLOCK))i=this.editor.formatLine(l.index,l.length,{[a]:e});else{if(l.length===0)return this.selection.format(a,e),i;i=this.editor.formatText(l.index,l.length,{[a]:e})}return this.setSelection(l,Ee.sources.SILENT),i},s)}formatLine(a,e,s,l,i){let o;return[a,e,o,i]=pa(a,e,s,l,i),Gt.call(this,()=>this.editor.formatLine(a,e,o),i,a,0)}formatText(a,e,s,l,i){let o;return[a,e,o,i]=pa(a,e,s,l,i),Gt.call(this,()=>this.editor.formatText(a,e,o),i,a,0)}getBounds(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=null;if(typeof a=="number"?s=this.selection.getBounds(a,e):s=this.selection.getBounds(a.index,a.length),!s)return null;const l=this.container.getBoundingClientRect();return{bottom:s.bottom-l.top,height:s.height,left:s.left-l.left,right:s.right-l.left,top:s.top-l.top,width:s.width}}getContents(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-a;return[a,e]=pa(a,e),this.editor.getContents(a,e)}getFormat(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof a=="number"?this.editor.getFormat(a,e):this.editor.getFormat(a.index,a.length)}getIndex(a){return a.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(a){return this.scroll.leaf(a)}getLine(a){return this.scroll.line(a)}getLines(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof a!="number"?this.scroll.lines(a.index,a.length):this.scroll.lines(a,e)}getModule(a){return this.theme.modules[a]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof a=="number"&&(e=e??this.getLength()-a),[a,e]=pa(a,e),this.editor.getHTML(a,e)}getText(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof a=="number"&&(e=e??this.getLength()-a),[a,e]=pa(a,e),this.editor.getText(a,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(a,e,s){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ue.sources.API;return Gt.call(this,()=>this.editor.insertEmbed(a,e,s),l,a)}insertText(a,e,s,l,i){let o;return[a,,o,i]=pa(a,0,s,l,i),Gt.call(this,()=>this.editor.insertText(a,e,o),i,a,e.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(a,e,s){return[a,e,,s]=pa(a,e,s),Gt.call(this,()=>this.editor.removeFormat(a,e),s,a)}scrollRectIntoView(a){tm(this.root,a)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const a=this.selection.lastRange,e=a&&this.selection.getBounds(a.index,a.length);e&&this.scrollRectIntoView(e)}setContents(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee.sources.API;return Gt.call(this,()=>{a=new Le(a);const s=this.getLength(),l=this.editor.deleteText(0,s),i=this.editor.insertContents(0,a),o=this.editor.deleteText(this.getLength()-1,1);return l.compose(i).compose(o)},e)}setSelection(a,e,s){a==null?this.selection.setRange(null,e||ue.sources.API):([a,e,,s]=pa(a,e,s),this.selection.setRange(new Ra(Math.max(0,a),e),s),s!==Ee.sources.SILENT&&this.scrollSelectionIntoView())}setText(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee.sources.API;const s=new Le().insert(a);return this.setContents(s,e)}update(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ee.sources.USER;const e=this.scroll.update(a);return this.selection.update(a),e}updateContents(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee.sources.API;return Gt.call(this,()=>(a=new Le(a),this.editor.applyDelta(a)),e,!0)}}function Qi(n){return typeof n=="string"?document.querySelector(n):n}function qn(n){return Object.entries(n??{}).reduce((a,e)=>{let[s,l]=e;return{...a,[s]:l===!0?{}:l}},{})}function Ki(n){return Object.fromEntries(Object.entries(n).filter(a=>a[1]!==void 0))}function nm(n,a){const e=Qi(n);if(!e)throw new Error("Invalid Quill container");const l=!a.theme||a.theme===ue.DEFAULTS.theme?Cs:ue.import(`themes/${a.theme}`);if(!l)throw new Error(`Invalid theme ${a.theme}. Did you register it?`);const{modules:i,...o}=ue.DEFAULTS,{modules:r,...u}=l.DEFAULTS;let d=qn(a.modules);d!=null&&d.toolbar&&d.toolbar.constructor!==Object&&(d={...d,toolbar:{container:d.toolbar}});const f=La({},qn(i),qn(r),d),v={...o,...Ki(u),...Ki(a)};let g=a.registry;return g?a.formats&&gs.warn('Ignoring "formats" option because "registry" is specified'):g=a.formats?lm(a.formats,v.registry,gs):v.registry,{...v,registry:g,container:e,theme:l,modules:Object.entries(f).reduce((k,N)=>{let[E,b]=N;if(!b)return k;const A=ue.import(`modules/${E}`);return A==null?(gs.error(`Cannot load ${E} module. Are you sure you registered it?`),k):{...k,[E]:La({},A.DEFAULTS||{},b)}},{}),bounds:Qi(v.bounds)}}function Gt(n,a,e,s){if(!this.isEnabled()&&a===Ee.sources.USER&&!this.allowReadOnlyEdits)return new Le;let l=e==null?null:this.getSelection();const i=this.editor.delta,o=n();if(l!=null&&(e===!0&&(e=l.index),s==null?l=eo(l,o,a):s!==0&&(l=eo(l,e,s,a)),this.setSelection(l,Ee.sources.SILENT)),o.length()>0){const r=[Ee.events.TEXT_CHANGE,o,i,a];this.emitter.emit(Ee.events.EDITOR_CHANGE,...r),a!==Ee.sources.SILENT&&this.emitter.emit(...r)}return o}function pa(n,a,e,s,l){let i={};return typeof n.index=="number"&&typeof n.length=="number"?typeof a!="number"?(l=s,s=e,e=a,a=n.length,n=n.index):(a=n.length,n=n.index):typeof a!="number"&&(l=s,s=e,e=a,a=0),typeof e=="object"?(i=e,l=s):typeof e=="string"&&(s!=null?i[e]=s:l=e),l=l||Ee.sources.API,[n,a,i,l]}function eo(n,a,e,s){const l=typeof e=="number"?e:0;if(n==null)return null;let i,o;return a&&typeof a.transformPosition=="function"?[i,o]=[n.index,n.index+n.length].map(r=>a.transformPosition(r,s!==Ee.sources.USER)):[i,o]=[n.index,n.index+n.length].map(r=>r<a||r===a&&s===Ee.sources.USER?r:l>=0?r+l:Math.max(a,r+l)),new Ra(i,o-i)}class Ya extends ql{}function to(n){return n instanceof vt||n instanceof Ut}function ao(n){return typeof n.updateContent=="function"}class im extends gi{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=vt;static allowedChildren=[vt,Ut,Ya];constructor(a,e,s){let{emitter:l}=s;super(a,e),this.emitter=l,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",i=>this.handleDragStart(i))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const a=this.batch;this.batch=!1,this.update(a)}emitMount(a){this.emitter.emit(Ee.events.SCROLL_BLOT_MOUNT,a)}emitUnmount(a){this.emitter.emit(Ee.events.SCROLL_BLOT_UNMOUNT,a)}emitEmbedUpdate(a,e){this.emitter.emit(Ee.events.SCROLL_EMBED_UPDATE,a,e)}deleteAt(a,e){const[s,l]=this.line(a),[i]=this.line(a+e);if(super.deleteAt(a,e),i!=null&&s!==i&&l>0){if(s instanceof Ut||i instanceof Ut){this.optimize();return}const o=i.children.head instanceof ta?null:i.children.head;s.moveChildren(i,o),s.remove()}this.optimize()}enable(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",a?"true":"false")}formatAt(a,e,s,l){super.formatAt(a,e,s,l),this.optimize()}insertAt(a,e,s){if(a>=this.length())if(s==null||this.scroll.query(e,Ie.BLOCK)==null){const l=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(l),s==null&&e.endsWith(`
`)?l.insertAt(0,e.slice(0,-1),s):l.insertAt(0,e,s)}else{const l=this.scroll.create(e,s);this.appendChild(l)}else super.insertAt(a,e,s);this.optimize()}insertBefore(a,e){if(a.statics.scope===Ie.INLINE_BLOT){const s=this.scroll.create(this.statics.defaultChild.blotName);s.appendChild(a),super.insertBefore(s,e)}else super.insertBefore(a,e)}insertContents(a,e){const s=this.deltaToRenderBlocks(e.concat(new Le().insert(`
`))),l=s.pop();if(l==null)return;this.batchStart();const i=s.shift();if(i){const u=i.type==="block"&&(i.delta.length()===0||!this.descendant(Ut,a)[0]&&a<this.length()),d=i.type==="block"?i.delta:new Le().insert({[i.key]:i.value});Un(this,a,d);const f=i.type==="block"?1:0,v=a+d.length()+f;u&&this.insertAt(v-1,`
`);const g=Rt(this.line(a)[0]),k=Pt.exports.AttributeMap.diff(g,i.attributes)||{};Object.keys(k).forEach(N=>{this.formatAt(v-1,1,N,k[N])}),a=v}let[o,r]=this.children.find(a);if(s.length&&(o&&(o=o.split(r),r=0),s.forEach(u=>{if(u.type==="block"){const d=this.createBlock(u.attributes,o||void 0);Un(d,0,u.delta)}else{const d=this.create(u.key,u.value);this.insertBefore(d,o||void 0),Object.keys(u.attributes).forEach(f=>{d.format(f,u.attributes[f])})}})),l.type==="block"&&l.delta.length()){const u=o?o.offset(o.scroll)+r:this.length();Un(this,u,l.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(a){const e=this.path(a).pop();if(!e)return[null,-1];const[s,l]=e;return s instanceof xt?[s,l]:[null,-1]}line(a){return a===this.length()?this.line(a-1):this.descendant(to,a)}lines(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const s=(l,i,o)=>{let r=[],u=o;return l.children.forEachAt(i,o,(d,f,v)=>{to(d)?r.push(d):d instanceof ql&&(r=r.concat(s(d,f,u))),u-=v}),r};return s(this,a,e)}optimize(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(a,e),a.length>0&&this.emitter.emit(Ee.events.SCROLL_OPTIMIZE,a,e))}path(a){return super.path(a).slice(1)}remove(){}update(a){if(this.batch){Array.isArray(a)&&(this.batch=this.batch.concat(a));return}let e=Ee.sources.USER;typeof a=="string"&&(e=a),Array.isArray(a)||(a=this.observer.takeRecords()),a=a.filter(s=>{let{target:l}=s;const i=this.find(l,!0);return i&&!ao(i)}),a.length>0&&this.emitter.emit(Ee.events.SCROLL_BEFORE_UPDATE,e,a),super.update(a.concat([])),a.length>0&&this.emitter.emit(Ee.events.SCROLL_UPDATE,e,a)}updateEmbedAt(a,e,s){const[l]=this.descendant(i=>i instanceof Ut,a);l&&l.statics.blotName===e&&ao(l)&&l.updateContent(s)}handleDragStart(a){a.preventDefault()}deltaToRenderBlocks(a){const e=[];let s=new Le;return a.forEach(l=>{const i=l?.insert;if(!!i)if(typeof i=="string"){const o=i.split(`
`);o.slice(0,-1).forEach(u=>{s.insert(u,l.attributes),e.push({type:"block",delta:s,attributes:l.attributes??{}}),s=new Le});const r=o[o.length-1];r&&s.insert(r,l.attributes)}else{const o=Object.keys(i)[0];if(!o)return;this.query(o,Ie.INLINE)?s.push(l):(s.length()&&e.push({type:"block",delta:s,attributes:{}}),s=new Le,e.push({type:"blockEmbed",key:o,value:i[o],attributes:l.attributes??{}}))}}),s.length()&&e.push({type:"block",delta:s,attributes:{}}),e}createBlock(a,e){let s;const l={};Object.entries(a).forEach(r=>{let[u,d]=r;this.query(u,Ie.BLOCK&Ie.BLOT)!=null?s=u:l[u]=d});const i=this.create(s||this.statics.defaultChild.blotName,s?a[s]:void 0);this.insertBefore(i,e||void 0);const o=i.length();return Object.entries(l).forEach(r=>{let[u,d]=r;i.formatAt(0,o,u,d)}),i}}function Un(n,a,e){e.reduce((s,l)=>{const i=Pt.exports.Op.length(l);let o=l.attributes||{};if(l.insert!=null){if(typeof l.insert=="string"){const r=l.insert;n.insertAt(s,r);const[u]=n.descendant(xt,s),d=Rt(u);o=Pt.exports.AttributeMap.diff(d,o)||{}}else if(typeof l.insert=="object"){const r=Object.keys(l.insert)[0];if(r==null)return s;if(n.insertAt(s,r,l.insert[r]),n.scroll.query(r,Ie.INLINE)!=null){const[d]=n.descendant(xt,s),f=Rt(d);o=Pt.exports.AttributeMap.diff(f,o)||{}}}}return Object.keys(o).forEach(r=>{n.formatAt(s,i,r,o[r])}),s+i},a)}const bi={scope:Ie.BLOCK,whitelist:["right","center","justify"]},om=new oa("align","align",bi),Ho=new ea("align","ql-align",bi),Zo=new Pa("align","text-align",bi);class Go extends Pa{value(a){let e=super.value(a);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${e.split(",").map(l=>`00${parseInt(l,10).toString(16)}`.slice(-2)).join("")}`):e}}const rm=new ea("color","ql-color",{scope:Ie.INLINE}),ki=new Go("color","color",{scope:Ie.INLINE}),cm=new ea("background","ql-bg",{scope:Ie.INLINE}),Ci=new Go("background","background-color",{scope:Ie.INLINE});class Wa extends Ya{static create(a){const e=super.create(a);return e.setAttribute("spellcheck","false"),e}code(a,e){return this.children.map(s=>s.length()<=1?"":s.domNode.innerText).join(`
`).slice(a,a+e)}html(a,e){return`<pre>
${Yl(this.code(a,e))}
</pre>`}}class At extends vt{static TAB="  ";static register(){ue.register(Wa)}}class xi extends St{}xi.blotName="code";xi.tagName="CODE";At.blotName="code-block";At.className="ql-code-block";At.tagName="DIV";Wa.blotName="code-block-container";Wa.className="ql-code-block-container";Wa.tagName="DIV";Wa.allowedChildren=[At];At.allowedChildren=[Kt,ta,Jt];At.requiredContainer=Wa;const wi={scope:Ie.BLOCK,whitelist:["rtl"]},Jo=new oa("direction","dir",wi),Xo=new ea("direction","ql-direction",wi),Qo=new Pa("direction","direction",wi),Ko={scope:Ie.INLINE,whitelist:["serif","monospace"]},er=new ea("font","ql-font",Ko);class um extends Pa{value(a){return super.value(a).replace(/["']/g,"")}}const tr=new um("font","font-family",Ko),ar=new ea("size","ql-size",{scope:Ie.INLINE,whitelist:["small","large","huge"]}),sr=new Pa("size","font-size",{scope:Ie.INLINE,whitelist:["10px","18px","32px"]}),dm=ya("quill:keyboard"),mm=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class Wl extends ra{static match(a,e){return["altKey","ctrlKey","metaKey","shiftKey"].some(s=>!!e[s]!==a[s]&&e[s]!==null)?!1:e.key===a.key||e.key===a.which}constructor(a,e){super(a,e),this.bindings={},Object.keys(this.options.bindings).forEach(s=>{this.options.bindings[s]&&this.addBinding(this.options.bindings[s])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const l=gm(a);if(l==null){dm.warn("Attempted to add invalid keyboard binding",l);return}typeof e=="function"&&(e={handler:e}),typeof s=="function"&&(s={handler:s}),(Array.isArray(l.key)?l.key:[l.key]).forEach(o=>{const r={...l,key:o,...e,...s};this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)})}listen(){this.quill.root.addEventListener("keydown",a=>{if(a.defaultPrevented||a.isComposing||a.keyCode===229&&(a.key==="Enter"||a.key==="Backspace"))return;const l=(this.bindings[a.key]||[]).concat(this.bindings[a.which]||[]).filter(A=>Wl.match(a,A));if(l.length===0)return;const i=ue.find(a.target,!0);if(i&&i.scroll!==this.quill.scroll)return;const o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;const[r,u]=this.quill.getLine(o.index),[d,f]=this.quill.getLeaf(o.index),[v,g]=o.length===0?[d,f]:this.quill.getLeaf(o.index+o.length),k=d instanceof Il?d.value().slice(0,f):"",N=v instanceof Il?v.value().slice(g):"",E={collapsed:o.length===0,empty:o.length===0&&r.length()<=1,format:this.quill.getFormat(o),line:r,offset:u,prefix:k,suffix:N,event:a};l.some(A=>{if(A.collapsed!=null&&A.collapsed!==E.collapsed||A.empty!=null&&A.empty!==E.empty||A.offset!=null&&A.offset!==E.offset)return!1;if(Array.isArray(A.format)){if(A.format.every(S=>E.format[S]==null))return!1}else if(typeof A.format=="object"&&!Object.keys(A.format).every(S=>A.format[S]===!0?E.format[S]!=null:A.format[S]===!1?E.format[S]==null:ci(A.format[S],E.format[S])))return!1;return A.prefix!=null&&!A.prefix.test(E.prefix)||A.suffix!=null&&!A.suffix.test(E.suffix)?!1:A.handler.call(this,o,E,A)!==!0})&&a.preventDefault()})}handleBackspace(a,e){const s=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;if(a.index===0||this.quill.getLength()<=1)return;let l={};const[i]=this.quill.getLine(a.index);let o=new Le().retain(a.index-s).delete(s);if(e.offset===0){const[r]=this.quill.getLine(a.index-1);if(r&&!(r.statics.blotName==="block"&&r.length()<=1)){const d=i.formats(),f=this.quill.getFormat(a.index-1,1);if(l=Pt.exports.AttributeMap.diff(d,f)||{},Object.keys(l).length>0){const v=new Le().retain(a.index+i.length()-2).retain(1,l);o=o.compose(v)}}}this.quill.updateContents(o,ue.sources.USER),this.quill.focus()}handleDelete(a,e){const s=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(a.index>=this.quill.getLength()-s)return;let l={};const[i]=this.quill.getLine(a.index);let o=new Le().retain(a.index).delete(s);if(e.offset>=i.length()-1){const[r]=this.quill.getLine(a.index+1);if(r){const u=i.formats(),d=this.quill.getFormat(a.index,1);l=Pt.exports.AttributeMap.diff(u,d)||{},Object.keys(l).length>0&&(o=o.retain(r.length()-1).retain(1,l))}}this.quill.updateContents(o,ue.sources.USER),this.quill.focus()}handleDeleteRange(a){Ti({range:a,quill:this.quill}),this.quill.focus()}handleEnter(a,e){const s=Object.keys(e.format).reduce((i,o)=>(this.quill.scroll.query(o,Ie.BLOCK)&&!Array.isArray(e.format[o])&&(i[o]=e.format[o]),i),{}),l=new Le().retain(a.index).delete(a.length).insert(`
`,s);this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(a.index+1,ue.sources.SILENT),this.quill.focus()}}const pm={bindings:{bold:zn("bold"),italic:zn("italic"),underline:zn("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(n,a){return a.collapsed&&a.offset!==0?!0:(this.quill.format("indent","+1",ue.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(n,a){return a.collapsed&&a.offset!==0?!0:(this.quill.format("indent","-1",ue.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(n,a){a.format.indent!=null?this.quill.format("indent","-1",ue.sources.USER):a.format.list!=null&&this.quill.format("list",!1,ue.sources.USER)}},"indent code-block":so(!0),"outdent code-block":so(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(n){this.quill.deleteText(n.index-1,1,ue.sources.USER)}},tab:{key:"Tab",handler(n,a){if(a.format.table)return!0;this.quill.history.cutoff();const e=new Le().retain(n.index).delete(n.length).insert("	");return this.quill.updateContents(e,ue.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index+1,ue.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,ue.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(n,a){const e={list:!1};a.format.indent&&(e.indent=!1),this.quill.formatLine(n.index,n.length,e,ue.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(n){const[a,e]=this.quill.getLine(n.index),s={...a.formats(),list:"checked"},l=new Le().retain(n.index).insert(`
`,s).retain(a.length()-e-1).retain(1,{list:"unchecked"});this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(n.index+1,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(n,a){const[e,s]=this.quill.getLine(n.index),l=new Le().retain(n.index).insert(`
`,a.format).retain(e.length()-s-1).retain(1,{header:null});this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(n.index+1,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(n){const a=this.quill.getModule("table");if(a){const[e,s,l,i]=a.getTable(n),o=fm(e,s,l,i);if(o==null)return;let r=e.offset();if(o<0){const u=new Le().retain(r).insert(`
`);this.quill.updateContents(u,ue.sources.USER),this.quill.setSelection(n.index+1,n.length,ue.sources.SILENT)}else if(o>0){r+=e.length();const u=new Le().retain(r).insert(`
`);this.quill.updateContents(u,ue.sources.USER),this.quill.setSelection(r,ue.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(n,a){const{event:e,line:s}=a,l=s.offset(this.quill.scroll);e.shiftKey?this.quill.setSelection(l-1,ue.sources.USER):this.quill.setSelection(l+s.length(),ue.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(n,a){if(this.quill.scroll.query("list")==null)return!0;const{length:e}=a.prefix,[s,l]=this.quill.getLine(n.index);if(l>e)return!0;let i;switch(a.prefix.trim()){case"[]":case"[ ]":i="unchecked";break;case"[x]":i="checked";break;case"-":case"*":i="bullet";break;default:i="ordered"}this.quill.insertText(n.index," ",ue.sources.USER),this.quill.history.cutoff();const o=new Le().retain(n.index-l).delete(e+1).retain(s.length()-2-l).retain(1,{list:i});return this.quill.updateContents(o,ue.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index-e,ue.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(n){const[a,e]=this.quill.getLine(n.index);let s=2,l=a;for(;l!=null&&l.length()<=1&&l.formats()["code-block"];)if(l=l.prev,s-=1,s<=0){const i=new Le().retain(n.index+a.length()-e-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,ue.sources.USER),this.quill.setSelection(n.index-1,ue.sources.SILENT),!1}return!0}},"embed left":bl("ArrowLeft",!1),"embed left shift":bl("ArrowLeft",!0),"embed right":bl("ArrowRight",!1),"embed right shift":bl("ArrowRight",!0),"table down":lo(!1),"table up":lo(!0)}};Wl.DEFAULTS=pm;function so(n){return{key:"Tab",shiftKey:!n,format:{"code-block":!0},handler(a,e){let{event:s}=e;const l=this.quill.scroll.query("code-block"),{TAB:i}=l;if(a.length===0&&!s.shiftKey){this.quill.insertText(a.index,i,ue.sources.USER),this.quill.setSelection(a.index+i.length,ue.sources.SILENT);return}const o=a.length===0?this.quill.getLines(a.index,1):this.quill.getLines(a);let{index:r,length:u}=a;o.forEach((d,f)=>{n?(d.insertAt(0,i),f===0?r+=i.length:u+=i.length):d.domNode.textContent.startsWith(i)&&(d.deleteAt(0,i.length),f===0?r-=i.length:u-=i.length)}),this.quill.update(ue.sources.USER),this.quill.setSelection(r,u,ue.sources.SILENT)}}}function bl(n,a){return{key:n,shiftKey:a,altKey:null,[n==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(s){let{index:l}=s;n==="ArrowRight"&&(l+=s.length+1);const[i]=this.quill.getLeaf(l);return i instanceof Mt?(n==="ArrowLeft"?a?this.quill.setSelection(s.index-1,s.length+1,ue.sources.USER):this.quill.setSelection(s.index-1,ue.sources.USER):a?this.quill.setSelection(s.index,s.length+1,ue.sources.USER):this.quill.setSelection(s.index+s.length+1,ue.sources.USER),!1):!0}}}function zn(n){return{key:n[0],shortKey:!0,handler(a,e){this.quill.format(n,!e.format[n],ue.sources.USER)}}}function lo(n){return{key:n?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(a,e){const s=n?"prev":"next",l=e.line,i=l.parent[s];if(i!=null){if(i.statics.blotName==="table-row"){let o=i.children.head,r=l;for(;r.prev!=null;)r=r.prev,o=o.next;const u=o.offset(this.quill.scroll)+Math.min(e.offset,o.length()-1);this.quill.setSelection(u,0,ue.sources.USER)}}else{const o=l.table()[s];o!=null&&(n?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,ue.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,ue.sources.USER))}return!1}}}function gm(n){if(typeof n=="string"||typeof n=="number")n={key:n};else if(typeof n=="object")n=ms(n);else return null;return n.shortKey&&(n[mm]=n.shortKey,delete n.shortKey),n}function Ti(n){let{quill:a,range:e}=n;const s=a.getLines(e);let l={};if(s.length>1){const i=s[0].formats(),o=s[s.length-1].formats();l=Pt.exports.AttributeMap.diff(o,i)||{}}a.deleteText(e,ue.sources.USER),Object.keys(l).length>0&&a.formatLine(e.index,1,l,ue.sources.USER),a.setSelection(e.index,ue.sources.SILENT)}function fm(n,a,e,s){return a.prev==null&&a.next==null?e.prev==null&&e.next==null?s===0?-1:1:e.prev==null?-1:1:a.prev==null?-1:a.next==null?1:null}const hm=/font-weight:\s*normal/,vm=["P","OL","UL"],no=n=>n&&vm.includes(n.tagName),_m=n=>{Array.from(n.querySelectorAll("br")).filter(a=>no(a.previousElementSibling)&&no(a.nextElementSibling)).forEach(a=>{a.parentNode?.removeChild(a)})},ym=n=>{Array.from(n.querySelectorAll('b[style*="font-weight"]')).filter(a=>a.getAttribute("style")?.match(hm)).forEach(a=>{const e=n.createDocumentFragment();e.append(...a.childNodes),a.parentNode?.replaceChild(e,a)})};function bm(n){n.querySelector('[id^="docs-internal-guid-"]')&&(ym(n),_m(n))}const km=/\bmso-list:[^;]*ignore/i,Cm=/\bmso-list:[^;]*\bl(\d+)/i,xm=/\bmso-list:[^;]*\blevel(\d+)/i,wm=(n,a)=>{const e=n.getAttribute("style"),s=e?.match(Cm);if(!s)return null;const l=Number(s[1]),i=e?.match(xm),o=i?Number(i[1]):1,r=new RegExp(`@list l${l}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),u=a.match(r),d=u&&u[1]==="bullet"?"bullet":"ordered";return{id:l,indent:o,type:d,element:n}},Tm=n=>{const a=Array.from(n.querySelectorAll("[style*=mso-list]")),e=[],s=[];a.forEach(o=>{(o.getAttribute("style")||"").match(km)?e.push(o):s.push(o)}),e.forEach(o=>o.parentNode?.removeChild(o));const l=n.documentElement.innerHTML,i=s.map(o=>wm(o,l)).filter(o=>o);for(;i.length;){const o=[];let r=i.shift();for(;r;)o.push(r),r=i.length&&i[0]?.element===r.element.nextElementSibling&&i[0].id===r.id?i.shift():null;const u=document.createElement("ul");o.forEach(v=>{const g=document.createElement("li");g.setAttribute("data-list",v.type),v.indent>1&&g.setAttribute("class",`ql-indent-${v.indent-1}`),g.innerHTML=v.element.innerHTML,u.appendChild(g)});const d=o[0]?.element,{parentNode:f}=d??{};d&&f?.replaceChild(u,d),o.slice(1).forEach(v=>{let{element:g}=v;f?.removeChild(g)})}};function Sm(n){n.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&Tm(n)}const Em=[Sm,bm],Lm=n=>{n.documentElement&&Em.forEach(a=>{a(n)})},Am=ya("quill:clipboard"),Im=[[Node.TEXT_NODE,zm],[Node.TEXT_NODE,oo],["br",Mm],[Node.ELEMENT_NODE,oo],[Node.ELEMENT_NODE,Om],[Node.ELEMENT_NODE,Nm],[Node.ELEMENT_NODE,qm],["li",Bm],["ol, ul",Rm],["pre",Fm],["tr",Um],["b",jn("bold")],["i",jn("italic")],["strike",jn("strike")],["style",Vm]],$m=[om,Jo].reduce((n,a)=>(n[a.keyName]=a,n),{}),io=[Zo,Ci,ki,Qo,tr,sr].reduce((n,a)=>(n[a.keyName]=a,n),{});class Pm extends ra{static DEFAULTS={matchers:[]};constructor(a,e){super(a,e),this.quill.root.addEventListener("copy",s=>this.onCaptureCopy(s,!1)),this.quill.root.addEventListener("cut",s=>this.onCaptureCopy(s,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],Im.concat(this.options.matchers??[]).forEach(s=>{let[l,i]=s;this.addMatcher(l,i)})}addMatcher(a,e){this.matchers.push([a,e])}convert(a){let{html:e,text:s}=a,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(l[At.blotName])return new Le().insert(s||"",{[At.blotName]:l[At.blotName]});if(!e)return new Le().insert(s||"",l);const i=this.convertHTML(e);return Xs(i,`
`)&&(i.ops[i.ops.length-1].attributes==null||l.table)?i.compose(new Le().retain(i.length()-1).delete(1)):i}normalizeHTML(a){Lm(a)}convertHTML(a){const e=new DOMParser().parseFromString(a,"text/html");this.normalizeHTML(e);const s=e.body,l=new WeakMap,[i,o]=this.prepareMatching(s,l);return Si(this.quill.scroll,s,i,o,l)}dangerouslyPasteHTML(a,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ue.sources.API;if(typeof a=="string"){const l=this.convert({html:a,text:""});this.quill.setContents(l,e),this.quill.setSelection(0,ue.sources.SILENT)}else{const l=this.convert({html:e,text:""});this.quill.updateContents(new Le().retain(a).concat(l),s),this.quill.setSelection(a+l.length(),ue.sources.SILENT)}}onCaptureCopy(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(a.defaultPrevented)return;a.preventDefault();const[s]=this.quill.selection.getRange();if(s==null)return;const{html:l,text:i}=this.onCopy(s,e);a.clipboardData?.setData("text/plain",i),a.clipboardData?.setData("text/html",l),e&&Ti({range:s,quill:this.quill})}normalizeURIList(a){return a.split(/\r?\n/).filter(e=>e[0]!=="#").join(`
`)}onCapturePaste(a){if(a.defaultPrevented||!this.quill.isEnabled())return;a.preventDefault();const e=this.quill.getSelection(!0);if(e==null)return;const s=a.clipboardData?.getData("text/html");let l=a.clipboardData?.getData("text/plain");if(!s&&!l){const o=a.clipboardData?.getData("text/uri-list");o&&(l=this.normalizeURIList(o))}const i=Array.from(a.clipboardData?.files||[]);if(!s&&i.length>0){this.quill.uploader.upload(e,i);return}if(s&&i.length>0){const o=new DOMParser().parseFromString(s,"text/html");if(o.body.childElementCount===1&&o.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(e,i);return}}this.onPaste(e,{html:s,text:l})}onCopy(a){const e=this.quill.getText(a);return{html:this.quill.getSemanticHTML(a),text:e}}onPaste(a,e){let{text:s,html:l}=e;const i=this.quill.getFormat(a.index),o=this.convert({text:s,html:l},i);Am.log("onPaste",o,{text:s,html:l});const r=new Le().retain(a.index).delete(a.length).concat(o);this.quill.updateContents(r,ue.sources.USER),this.quill.setSelection(r.length()-a.length,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(a,e){const s=[],l=[];return this.matchers.forEach(i=>{const[o,r]=i;switch(o){case Node.TEXT_NODE:l.push(r);break;case Node.ELEMENT_NODE:s.push(r);break;default:Array.from(a.querySelectorAll(o)).forEach(u=>{e.has(u)?e.get(u)?.push(r):e.set(u,[r])});break}}),[s,l]}}function Ha(n,a,e,s){return s.query(a)?n.reduce((l,i)=>{if(!i.insert)return l;if(i.attributes&&i.attributes[a])return l.push(i);const o=e?{[a]:e}:{};return l.insert(i.insert,{...o,...i.attributes})},new Le):n}function Xs(n,a){let e="";for(let s=n.ops.length-1;s>=0&&e.length<a.length;--s){const l=n.ops[s];if(typeof l.insert!="string")break;e=l.insert+e}return e.slice(-1*a.length)===a}function Sa(n,a){if(!(n instanceof Element))return!1;const e=a.query(n);return e&&e.prototype instanceof Mt?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(n.tagName.toLowerCase())}function Dm(n,a){return n.previousElementSibling&&n.nextElementSibling&&!Sa(n.previousElementSibling,a)&&!Sa(n.nextElementSibling,a)}const kl=new WeakMap;function lr(n){return n==null?!1:(kl.has(n)||(n.tagName==="PRE"?kl.set(n,!0):kl.set(n,lr(n.parentNode))),kl.get(n))}function Si(n,a,e,s,l){return a.nodeType===a.TEXT_NODE?s.reduce((i,o)=>o(a,i,n),new Le):a.nodeType===a.ELEMENT_NODE?Array.from(a.childNodes||[]).reduce((i,o)=>{let r=Si(n,o,e,s,l);return o.nodeType===a.ELEMENT_NODE&&(r=e.reduce((u,d)=>d(o,u,n),r),r=(l.get(o)||[]).reduce((u,d)=>d(o,u,n),r)),i.concat(r)},new Le):new Le}function jn(n){return(a,e,s)=>Ha(e,n,!0,s)}function Nm(n,a,e){const s=oa.keys(n),l=ea.keys(n),i=Pa.keys(n),o={};return s.concat(l).concat(i).forEach(r=>{let u=e.query(r,Ie.ATTRIBUTE);u!=null&&(o[u.attrName]=u.value(n),o[u.attrName])||(u=$m[r],u!=null&&(u.attrName===r||u.keyName===r)&&(o[u.attrName]=u.value(n)||void 0),u=io[r],u!=null&&(u.attrName===r||u.keyName===r)&&(u=io[r],o[u.attrName]=u.value(n)||void 0))}),Object.entries(o).reduce((r,u)=>{let[d,f]=u;return Ha(r,d,f,e)},a)}function Om(n,a,e){const s=e.query(n);if(s==null)return a;if(s.prototype instanceof Mt){const l={},i=s.value(n);if(i!=null)return l[s.blotName]=i,new Le().insert(l,s.formats(n,e))}else if(s.prototype instanceof zs&&!Xs(a,`
`)&&a.insert(`
`),"blotName"in s&&"formats"in s&&typeof s.formats=="function")return Ha(a,s.blotName,s.formats(n,e),e);return a}function Mm(n,a){return Xs(a,`
`)||a.insert(`
`),a}function Fm(n,a,e){const s=e.query("code-block"),l=s&&"formats"in s&&typeof s.formats=="function"?s.formats(n,e):!0;return Ha(a,"code-block",l,e)}function Vm(){return new Le}function Bm(n,a,e){const s=e.query(n);if(s==null||s.blotName!=="list"||!Xs(a,`
`))return a;let l=-1,i=n.parentNode;for(;i!=null;)["OL","UL"].includes(i.tagName)&&(l+=1),i=i.parentNode;return l<=0?a:a.reduce((o,r)=>r.insert?r.attributes&&typeof r.attributes.indent=="number"?o.push(r):o.insert(r.insert,{indent:l,...r.attributes||{}}):o,new Le)}function Rm(n,a,e){const s=n;let l=s.tagName==="OL"?"ordered":"bullet";const i=s.getAttribute("data-checked");return i&&(l=i==="true"?"checked":"unchecked"),Ha(a,"list",l,e)}function oo(n,a,e){if(!Xs(a,`
`)){if(Sa(n,e)&&(n.childNodes.length>0||n instanceof HTMLParagraphElement))return a.insert(`
`);if(a.length()>0&&n.nextSibling){let s=n.nextSibling;for(;s!=null;){if(Sa(s,e))return a.insert(`
`);const l=e.query(s);if(l&&l.prototype instanceof Ut)return a.insert(`
`);s=s.firstChild}}}return a}function qm(n,a,e){const s={},l=n.style||{};return l.fontStyle==="italic"&&(s.italic=!0),l.textDecoration==="underline"&&(s.underline=!0),l.textDecoration==="line-through"&&(s.strike=!0),(l.fontWeight?.startsWith("bold")||parseInt(l.fontWeight,10)>=700)&&(s.bold=!0),a=Object.entries(s).reduce((i,o)=>{let[r,u]=o;return Ha(i,r,u,e)},a),parseFloat(l.textIndent||0)>0?new Le().insert("	").concat(a):a}function Um(n,a,e){const s=n.parentElement?.tagName==="TABLE"?n.parentElement:n.parentElement?.parentElement;if(s!=null){const i=Array.from(s.querySelectorAll("tr")).indexOf(n)+1;return Ha(a,"table",i,e)}return a}function zm(n,a,e){let s=n.data;if(n.parentElement?.tagName==="O:P")return a.insert(s.trim());if(!lr(n)){if(s.trim().length===0&&s.includes(`
`)&&!Dm(n,e))return a;s=s.replace(/[^\S\u00a0]/g," "),s=s.replace(/ {2,}/g," "),(n.previousSibling==null&&n.parentElement!=null&&Sa(n.parentElement,e)||n.previousSibling instanceof Element&&Sa(n.previousSibling,e))&&(s=s.replace(/^ /,"")),(n.nextSibling==null&&n.parentElement!=null&&Sa(n.parentElement,e)||n.nextSibling instanceof Element&&Sa(n.nextSibling,e))&&(s=s.replace(/ $/,"")),s=s.replaceAll("\xA0"," ")}return a.insert(s)}class jm extends ra{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(a,e){super(a,e),this.quill.on(ue.events.EDITOR_CHANGE,(s,l,i,o)=>{s===ue.events.SELECTION_CHANGE?l&&o!==ue.sources.SILENT&&(this.currentRange=l):s===ue.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||o===ue.sources.USER?this.record(l,i):this.transform(l)),this.currentRange=ai(this.currentRange,l))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",s=>{s.inputType==="historyUndo"?(this.undo(),s.preventDefault()):s.inputType==="historyRedo"&&(this.redo(),s.preventDefault())})}change(a,e){if(this.stack[a].length===0)return;const s=this.stack[a].pop();if(!s)return;const l=this.quill.getContents(),i=s.delta.invert(l);this.stack[e].push({delta:i,range:ai(s.range,i)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(s.delta,ue.sources.USER),this.ignoreChange=!1,this.restoreSelection(s)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(a,e){if(a.ops.length===0)return;this.stack.redo=[];let s=a.invert(e),l=this.currentRange;const i=Date.now();if(this.lastRecorded+this.options.delay>i&&this.stack.undo.length>0){const o=this.stack.undo.pop();o&&(s=s.compose(o.delta),l=o.range)}else this.lastRecorded=i;s.length()!==0&&(this.stack.undo.push({delta:s,range:l}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(a){ro(this.stack.undo,a),ro(this.stack.redo,a)}undo(){this.change("undo","redo")}restoreSelection(a){if(a.range)this.quill.setSelection(a.range,ue.sources.USER);else{const e=Wm(this.quill.scroll,a.delta);this.quill.setSelection(e,ue.sources.USER)}}}function ro(n,a){let e=a;for(let s=n.length-1;s>=0;s-=1){const l=n[s];n[s]={delta:e.transform(l.delta,!0),range:l.range&&ai(l.range,e)},e=l.delta.transform(e),n[s].delta.length()===0&&n.splice(s,1)}}function Ym(n,a){const e=a.ops[a.ops.length-1];return e==null?!1:e.insert!=null?typeof e.insert=="string"&&e.insert.endsWith(`
`):e.attributes!=null?Object.keys(e.attributes).some(s=>n.query(s,Ie.BLOCK)!=null):!1}function Wm(n,a){const e=a.reduce((l,i)=>l+(i.delete||0),0);let s=a.length()-e;return Ym(n,a)&&(s-=1),s}function ai(n,a){if(!n)return n;const e=a.transformPosition(n.index),s=a.transformPosition(n.index+n.length);return{index:e,length:s-e}}class nr extends ra{constructor(a,e){super(a,e),a.root.addEventListener("drop",s=>{s.preventDefault();let l=null;if(document.caretRangeFromPoint)l=document.caretRangeFromPoint(s.clientX,s.clientY);else if(document.caretPositionFromPoint){const o=document.caretPositionFromPoint(s.clientX,s.clientY);l=document.createRange(),l.setStart(o.offsetNode,o.offset),l.setEnd(o.offsetNode,o.offset)}const i=l&&a.selection.normalizeNative(l);if(i){const o=a.selection.normalizedToRange(i);s.dataTransfer?.files&&this.upload(o,s.dataTransfer.files)}})}upload(a,e){const s=[];Array.from(e).forEach(l=>{l&&this.options.mimetypes?.includes(l.type)&&s.push(l)}),s.length>0&&this.options.handler.call(this,a,s)}}nr.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(n,a){if(!this.quill.scroll.query("image"))return;const e=a.map(s=>new Promise(l=>{const i=new FileReader;i.onload=()=>{l(i.result)},i.readAsDataURL(s)}));Promise.all(e).then(s=>{const l=s.reduce((i,o)=>i.insert({image:o}),new Le().retain(n.index).delete(n.length));this.quill.updateContents(l,Ee.sources.USER),this.quill.setSelection(n.index+s.length,Ee.sources.SILENT)})}};const Hm=["insertText","insertReplacementText"];class Zm extends ra{constructor(a,e){super(a,e),a.root.addEventListener("beforeinput",s=>{this.handleBeforeInput(s)}),/Android/i.test(navigator.userAgent)||a.on(ue.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(a){Ti({range:a,quill:this.quill})}replaceText(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(a.length===0)return!1;if(e){const s=this.quill.getFormat(a.index,1);this.deleteRange(a),this.quill.updateContents(new Le().retain(a.index).insert(e,s),ue.sources.USER)}else this.deleteRange(a);return this.quill.setSelection(a.index+e.length,0,ue.sources.SILENT),!0}handleBeforeInput(a){if(this.quill.composition.isComposing||a.defaultPrevented||!Hm.includes(a.inputType))return;const e=a.getTargetRanges?a.getTargetRanges()[0]:null;if(!e||e.collapsed===!0)return;const s=Gm(a);if(s==null)return;const l=this.quill.selection.normalizeNative(e),i=l?this.quill.selection.normalizedToRange(l):null;i&&this.replaceText(i,s)&&a.preventDefault()}handleCompositionStart(){const a=this.quill.getSelection();a&&this.replaceText(a)}}function Gm(n){return typeof n.data=="string"?n.data:n.dataTransfer?.types.includes("text/plain")?n.dataTransfer.getData("text/plain"):null}const Jm=/Mac/i.test(navigator.platform),Xm=100,Qm=n=>!!(n.key==="ArrowLeft"||n.key==="ArrowRight"||n.key==="ArrowUp"||n.key==="ArrowDown"||n.key==="Home"||Jm&&n.key==="a"&&n.ctrlKey===!0);class Km extends ra{isListening=!1;selectionChangeDeadline=0;constructor(a,e){super(a,e),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(a,e){let{line:s,event:l}=e;if(!(s instanceof Qt)||!s.uiNode)return!0;const i=getComputedStyle(s.domNode).direction==="rtl";return i&&l.key!=="ArrowRight"||!i&&l.key!=="ArrowLeft"?!0:(this.quill.setSelection(a.index-1,a.length+(l.shiftKey?1:0),ue.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",a=>{!a.defaultPrevented&&Qm(a)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+Xm,this.isListening)return;this.isListening=!0;const a=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",a,{once:!0})}handleSelectionChange(){const a=document.getSelection();if(!a)return;const e=a.getRangeAt(0);if(e.collapsed!==!0||e.startOffset!==0)return;const s=this.quill.scroll.find(e.startContainer);if(!(s instanceof Qt)||!s.uiNode)return;const l=document.createRange();l.setStartAfter(s.uiNode),l.setEndAfter(s.uiNode),a.removeAllRanges(),a.addRange(l)}}ue.register({"blots/block":vt,"blots/block/embed":Ut,"blots/break":ta,"blots/container":Ya,"blots/cursor":Jt,"blots/embed":yi,"blots/inline":St,"blots/scroll":im,"blots/text":Kt,"modules/clipboard":Pm,"modules/history":jm,"modules/keyboard":Wl,"modules/uploader":nr,"modules/input":Zm,"modules/uiNode":Km});class ep extends ea{add(a,e){let s=0;if(e==="+1"||e==="-1"){const l=this.value(a)||0;s=e==="+1"?l+1:l-1}else typeof e=="number"&&(s=e);return s===0?(this.remove(a),!0):super.add(a,s.toString())}canAdd(a,e){return super.canAdd(a,e)||super.canAdd(a,parseInt(e,10))}value(a){return parseInt(super.value(a),10)||void 0}}const tp=new ep("indent","ql-indent",{scope:Ie.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class ap extends vt{static blotName="blockquote";static tagName="blockquote"}class sp extends vt{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(a){return this.tagName.indexOf(a.tagName)+1}}class Qs extends Ya{}Qs.blotName="list-container";Qs.tagName="OL";class Ks extends vt{static create(a){const e=super.create();return e.setAttribute("data-list",a),e}static formats(a){return a.getAttribute("data-list")||void 0}static register(){ue.register(Qs)}constructor(a,e){super(a,e);const s=e.ownerDocument.createElement("span"),l=i=>{if(!a.isEnabled())return;const o=this.statics.formats(e,a);o==="checked"?(this.format("list","unchecked"),i.preventDefault()):o==="unchecked"&&(this.format("list","checked"),i.preventDefault())};s.addEventListener("mousedown",l),s.addEventListener("touchstart",l),this.attachUI(s)}format(a,e){a===this.statics.blotName&&e?this.domNode.setAttribute("data-list",e):super.format(a,e)}}Ks.blotName="list";Ks.tagName="LI";Qs.allowedChildren=[Ks];Ks.requiredContainer=Qs;class Ei extends St{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(a){super.optimize(a),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class lp extends Ei{static blotName="italic";static tagName=["EM","I"]}class Dl extends St{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(a){const e=super.create(a);return e.setAttribute("href",this.sanitize(a)),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"),e}static formats(a){return a.getAttribute("href")}static sanitize(a){return ir(a,this.PROTOCOL_WHITELIST)?a:this.SANITIZED_URL}format(a,e){a!==this.statics.blotName||!e?super.format(a,e):this.domNode.setAttribute("href",this.constructor.sanitize(e))}}function ir(n,a){const e=document.createElement("a");e.href=n;const s=e.href.slice(0,e.href.indexOf(":"));return a.indexOf(s)>-1}class np extends St{static blotName="script";static tagName=["SUB","SUP"];static create(a){return a==="super"?document.createElement("sup"):a==="sub"?document.createElement("sub"):super.create(a)}static formats(a){if(a.tagName==="SUB")return"sub";if(a.tagName==="SUP")return"super"}}class ip extends Ei{static blotName="strike";static tagName=["S","STRIKE"]}class op extends St{static blotName="underline";static tagName="U"}class rp extends yi{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(a){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const e=super.create(a);return typeof a=="string"&&(window.katex.render(a,e,{throwOnError:!1,errorColor:"#f00"}),e.setAttribute("data-value",a)),e}static value(a){return a.getAttribute("data-value")}html(){const{formula:a}=this.value();return`<span>${a}</span>`}}const co=["alt","height","width"];class cp extends Mt{static blotName="image";static tagName="IMG";static create(a){const e=super.create(a);return typeof a=="string"&&e.setAttribute("src",this.sanitize(a)),e}static formats(a){return co.reduce((e,s)=>(a.hasAttribute(s)&&(e[s]=a.getAttribute(s)),e),{})}static match(a){return/\.(jpe?g|gif|png)$/.test(a)||/^data:image\/.+;base64/.test(a)}static sanitize(a){return ir(a,["http","https","data"])?a:"//:0"}static value(a){return a.getAttribute("src")}format(a,e){co.indexOf(a)>-1?e?this.domNode.setAttribute(a,e):this.domNode.removeAttribute(a):super.format(a,e)}}const uo=["height","width"];class up extends Ut{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(a){const e=super.create(a);return e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","true"),e.setAttribute("src",this.sanitize(a)),e}static formats(a){return uo.reduce((e,s)=>(a.hasAttribute(s)&&(e[s]=a.getAttribute(s)),e),{})}static sanitize(a){return Dl.sanitize(a)}static value(a){return a.getAttribute("src")}format(a,e){uo.indexOf(a)>-1?e?this.domNode.setAttribute(a,e):this.domNode.removeAttribute(a):super.format(a,e)}html(){const{video:a}=this.value();return`<a href="${a}">${a}</a>`}}const Vs=new ea("code-token","hljs",{scope:Ie.INLINE});class fa extends St{static formats(a,e){for(;a!=null&&a!==e.domNode;){if(a.classList&&a.classList.contains(At.className))return super.formats(a,e);a=a.parentNode}}constructor(a,e,s){super(a,e,s),Vs.add(this.domNode,s)}format(a,e){a!==fa.blotName?super.format(a,e):e?Vs.add(this.domNode,e):(Vs.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),Vs.value(this.domNode)||this.unwrap()}}fa.blotName="code-token";fa.className="ql-token";class qt extends At{static create(a){const e=super.create(a);return typeof a=="string"&&e.setAttribute("data-language",a),e}static formats(a){return a.getAttribute("data-language")||"plain"}static register(){}format(a,e){a===this.statics.blotName&&e?this.domNode.setAttribute("data-language",e):super.format(a,e)}replaceWith(a,e){return this.formatAt(0,this.length(),fa.blotName,!1),super.replaceWith(a,e)}}class qs extends Wa{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(a,e){a===qt.blotName&&(this.forceNext=!0,this.children.forEach(s=>{s.format(a,e)}))}formatAt(a,e,s,l){s===qt.blotName&&(this.forceNext=!0),super.formatAt(a,e,s,l)}highlight(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const l=`${Array.from(this.domNode.childNodes).filter(o=>o!==this.uiNode).map(o=>o.textContent).join(`
`)}
`,i=qt.formats(this.children.head.domNode);if(e||this.forceNext||this.cachedText!==l){if(l.trim().length>0||this.cachedText==null){const o=this.children.reduce((u,d)=>u.concat(jo(d,!1)),new Le),r=a(l,i);o.diff(r).reduce((u,d)=>{let{retain:f,attributes:v}=d;return f?(v&&Object.keys(v).forEach(g=>{[qt.blotName,fa.blotName].includes(g)&&this.formatAt(u,f,g,v[g])}),u+f):u},0)}this.cachedText=l,this.forceNext=!1}}html(a,e){const[s]=this.children.find(a);return`<pre data-language="${s?qt.formats(s.domNode):"plain"}">
${Yl(this.code(a,e))}
</pre>`}optimize(a){if(super.optimize(a),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const e=qt.formats(this.children.head.domNode);e!==this.uiNode.value&&(this.uiNode.value=e)}}}qs.allowedChildren=[qt];qt.requiredContainer=qs;qt.allowedChildren=[fa,Jt,Kt,ta];const dp=(n,a,e)=>{if(typeof n.versionString=="string"){const s=n.versionString.split(".")[0];if(parseInt(s,10)>=11)return n.highlight(e,{language:a}).value}return n.highlight(a,e).value};class or extends ra{static register(){ue.register(fa,!0),ue.register(qt,!0),ue.register(qs,!0)}constructor(a,e){if(super(a,e),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((s,l)=>{let{key:i}=l;return s[i]=!0,s},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(ue.events.SCROLL_BLOT_MOUNT,a=>{if(!(a instanceof qs))return;const e=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(s=>{let{key:l,label:i}=s;const o=e.ownerDocument.createElement("option");o.textContent=i,o.setAttribute("value",l),e.appendChild(o)}),e.addEventListener("change",()=>{a.format(qt.blotName,e.value),this.quill.root.focus(),this.highlight(a,!0)}),a.uiNode==null&&(a.attachUI(e),a.children.head&&(e.value=qt.formats(a.children.head.domNode)))})}initTimer(){let a=null;this.quill.on(ue.events.SCROLL_OPTIMIZE,()=>{a&&clearTimeout(a),a=setTimeout(()=>{this.highlight(),a=null},this.options.interval)})}highlight(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(ue.sources.USER);const s=this.quill.getSelection();(a==null?this.quill.scroll.descendants(qs):[a]).forEach(i=>{i.highlight(this.highlightBlot,e)}),this.quill.update(ue.sources.SILENT),s!=null&&this.quill.setSelection(s,ue.sources.SILENT)}highlightBlot(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(e=this.languages[e]?e:"plain",e==="plain")return Yl(a).split(`
`).reduce((l,i,o)=>(o!==0&&l.insert(`
`,{[At.blotName]:e}),l.insert(i)),new Le);const s=this.quill.root.ownerDocument.createElement("div");return s.classList.add(At.className),s.innerHTML=dp(this.options.hljs,e,a),Si(this.quill.scroll,s,[(l,i)=>{const o=Vs.value(l);return o?i.compose(new Le().retain(i.length(),{[fa.blotName]:o})):i}],[(l,i)=>l.data.split(`
`).reduce((o,r,u)=>(u!==0&&o.insert(`
`,{[At.blotName]:e}),o.insert(r)),i)],new WeakMap)}}or.DEFAULTS={hljs:(()=>window.hljs)(),interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class Xt extends vt{static blotName="table";static tagName="TD";static create(a){const e=super.create();return a?e.setAttribute("data-row",a):e.setAttribute("data-row",Li()),e}static formats(a){if(a.hasAttribute("data-row"))return a.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(a,e){a===Xt.blotName&&e?this.domNode.setAttribute("data-row",e):super.format(a,e)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class qa extends Ya{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const a=this.children.head.formats(),e=this.children.tail.formats(),s=this.next.children.head.formats(),l=this.next.children.tail.formats();return a.table===e.table&&a.table===s.table&&a.table===l.table}return!1}optimize(a){super.optimize(a),this.children.forEach(e=>{if(e.next==null)return;const s=e.formats(),l=e.next.formats();if(s.table!==l.table){const i=this.splitAfter(e);i&&i.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class Aa extends Ya{static blotName="table-body";static tagName="TBODY"}class Nl extends Ya{static blotName="table-container";static tagName="TABLE";balanceCells(){const a=this.descendants(qa),e=a.reduce((s,l)=>Math.max(l.children.length,s),0);a.forEach(s=>{new Array(e-s.children.length).fill(0).forEach(()=>{let l;s.children.head!=null&&(l=Xt.formats(s.children.head.domNode));const i=this.scroll.create(Xt.blotName,l);s.appendChild(i),i.optimize()})})}cells(a){return this.rows().map(e=>e.children.at(a))}deleteColumn(a){const[e]=this.descendant(Aa);e==null||e.children.head==null||e.children.forEach(s=>{const l=s.children.at(a);l?.remove()})}insertColumn(a){const[e]=this.descendant(Aa);e==null||e.children.head==null||e.children.forEach(s=>{const l=s.children.at(a),i=Xt.formats(s.children.head.domNode),o=this.scroll.create(Xt.blotName,i);s.insertBefore(o,l)})}insertRow(a){const[e]=this.descendant(Aa);if(e==null||e.children.head==null)return;const s=Li(),l=this.scroll.create(qa.blotName);e.children.head.children.forEach(()=>{const o=this.scroll.create(Xt.blotName,s);l.appendChild(o)});const i=e.children.at(a);e.insertBefore(l,i)}rows(){const a=this.children.head;return a==null?[]:a.children.map(e=>e)}}Nl.allowedChildren=[Aa];Aa.requiredContainer=Nl;Aa.allowedChildren=[qa];qa.requiredContainer=Aa;qa.allowedChildren=[Xt];Xt.requiredContainer=qa;function Li(){return`row-${Math.random().toString(36).slice(2,6)}`}class mp extends ra{static register(){ue.register(Xt),ue.register(qa),ue.register(Aa),ue.register(Nl)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(Nl).forEach(a=>{a.balanceCells()})}deleteColumn(){const[a,,e]=this.getTable();e!=null&&(a.deleteColumn(e.cellOffset()),this.quill.update(ue.sources.USER))}deleteRow(){const[,a]=this.getTable();a!=null&&(a.remove(),this.quill.update(ue.sources.USER))}deleteTable(){const[a]=this.getTable();if(a==null)return;const e=a.offset();a.remove(),this.quill.update(ue.sources.USER),this.quill.setSelection(e,ue.sources.SILENT)}getTable(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(a==null)return[null,null,null,-1];const[e,s]=this.quill.getLine(a.index);if(e==null||e.statics.blotName!==Xt.blotName)return[null,null,null,-1];const l=e.parent;return[l.parent.parent,l,e,s]}insertColumn(a){const e=this.quill.getSelection();if(!e)return;const[s,l,i]=this.getTable(e);if(i==null)return;const o=i.cellOffset();s.insertColumn(o+a),this.quill.update(ue.sources.USER);let r=l.rowOffset();a===0&&(r+=1),this.quill.setSelection(e.index+r,e.length,ue.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(a){const e=this.quill.getSelection();if(!e)return;const[s,l,i]=this.getTable(e);if(i==null)return;const o=l.rowOffset();s.insertRow(o+a),this.quill.update(ue.sources.USER),a>0?this.quill.setSelection(e,ue.sources.SILENT):this.quill.setSelection(e.index+l.children.length,e.length,ue.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(a,e){const s=this.quill.getSelection();if(s==null)return;const l=new Array(a).fill(0).reduce(i=>{const o=new Array(e).fill(`
`).join("");return i.insert(o,{table:Li()})},new Le().retain(s.index));this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(s.index,ue.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(ue.events.SCROLL_OPTIMIZE,a=>{a.some(e=>["TD","TR","TBODY","TABLE"].includes(e.target.tagName)?(this.quill.once(ue.events.TEXT_CHANGE,(s,l,i)=>{i===ue.sources.USER&&this.balanceTables()}),!0):!1)})}}const mo=ya("quill:toolbar");class Ai extends ra{constructor(a,e){if(super(a,e),Array.isArray(this.options.container)){const s=document.createElement("div");s.setAttribute("role","toolbar"),pp(s,this.options.container),a.container?.parentNode?.insertBefore(s,a.container),this.container=s}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){mo.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(s=>{const l=this.options.handlers?.[s];l&&this.addHandler(s,l)}),Array.from(this.container.querySelectorAll("button, select")).forEach(s=>{this.attach(s)}),this.quill.on(ue.events.EDITOR_CHANGE,()=>{const[s]=this.quill.selection.getRange();this.update(s)})}addHandler(a,e){this.handlers[a]=e}attach(a){let e=Array.from(a.classList).find(l=>l.indexOf("ql-")===0);if(!e)return;if(e=e.slice(3),a.tagName==="BUTTON"&&a.setAttribute("type","button"),this.handlers[e]==null&&this.quill.scroll.query(e)==null){mo.warn("ignoring attaching to nonexistent format",e,a);return}const s=a.tagName==="SELECT"?"change":"click";a.addEventListener(s,l=>{let i;if(a.tagName==="SELECT"){if(a.selectedIndex<0)return;const r=a.options[a.selectedIndex];r.hasAttribute("selected")?i=!1:i=r.value||!1}else a.classList.contains("ql-active")?i=!1:i=a.value||!a.hasAttribute("value"),l.preventDefault();this.quill.focus();const[o]=this.quill.selection.getRange();if(this.handlers[e]!=null)this.handlers[e].call(this,i);else if(this.quill.scroll.query(e).prototype instanceof Mt){if(i=prompt(`Enter ${e}`),!i)return;this.quill.updateContents(new Le().retain(o.index).delete(o.length).insert({[e]:i}),ue.sources.USER)}else this.quill.format(e,i,ue.sources.USER);this.update(o)}),this.controls.push([e,a])}update(a){const e=a==null?{}:this.quill.getFormat(a);this.controls.forEach(s=>{const[l,i]=s;if(i.tagName==="SELECT"){let o=null;if(a==null)o=null;else if(e[l]==null)o=i.querySelector("option[selected]");else if(!Array.isArray(e[l])){let r=e[l];typeof r=="string"&&(r=r.replace(/"/g,'\\"')),o=i.querySelector(`option[value="${r}"]`)}o==null?(i.value="",i.selectedIndex=-1):o.selected=!0}else if(a==null)i.classList.remove("ql-active"),i.setAttribute("aria-pressed","false");else if(i.hasAttribute("value")){const o=e[l],r=o===i.getAttribute("value")||o!=null&&o.toString()===i.getAttribute("value")||o==null&&!i.getAttribute("value");i.classList.toggle("ql-active",r),i.setAttribute("aria-pressed",r.toString())}else{const o=e[l]!=null;i.classList.toggle("ql-active",o),i.setAttribute("aria-pressed",o.toString())}})}}Ai.DEFAULTS={};function po(n,a,e){const s=document.createElement("button");s.setAttribute("type","button"),s.classList.add(`ql-${a}`),s.setAttribute("aria-pressed","false"),e!=null?(s.value=e,s.setAttribute("aria-label",`${a}: ${e}`)):s.setAttribute("aria-label",a),n.appendChild(s)}function pp(n,a){Array.isArray(a[0])||(a=[a]),a.forEach(e=>{const s=document.createElement("span");s.classList.add("ql-formats"),e.forEach(l=>{if(typeof l=="string")po(s,l);else{const i=Object.keys(l)[0],o=l[i];Array.isArray(o)?gp(s,i,o):po(s,i,o)}}),n.appendChild(s)})}function gp(n,a,e){const s=document.createElement("select");s.classList.add(`ql-${a}`),e.forEach(l=>{const i=document.createElement("option");l!==!1?i.setAttribute("value",String(l)):i.setAttribute("selected","selected"),s.appendChild(i)}),n.appendChild(s)}Ai.DEFAULTS={container:null,handlers:{clean(){const n=this.quill.getSelection();if(n!=null)if(n.length===0){const a=this.quill.getFormat();Object.keys(a).forEach(e=>{this.quill.scroll.query(e,Ie.INLINE)!=null&&this.quill.format(e,!1,ue.sources.USER)})}else this.quill.removeFormat(n.index,n.length,ue.sources.USER)},direction(n){const{align:a}=this.quill.getFormat();n==="rtl"&&a==null?this.quill.format("align","right",ue.sources.USER):!n&&a==="right"&&this.quill.format("align",!1,ue.sources.USER),this.quill.format("direction",n,ue.sources.USER)},indent(n){const a=this.quill.getSelection(),e=this.quill.getFormat(a),s=parseInt(e.indent||0,10);if(n==="+1"||n==="-1"){let l=n==="+1"?1:-1;e.direction==="rtl"&&(l*=-1),this.quill.format("indent",s+l,ue.sources.USER)}},link(n){n===!0&&(n=prompt("Enter link URL:")),this.quill.format("link",n,ue.sources.USER)},list(n){const a=this.quill.getSelection(),e=this.quill.getFormat(a);n==="check"?e.list==="checked"||e.list==="unchecked"?this.quill.format("list",!1,ue.sources.USER):this.quill.format("list","unchecked",ue.sources.USER):this.quill.format("list",n,ue.sources.USER)}}};const fp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',hp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',vp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',_p='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',yp='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',bp='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',kp='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',Cp='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',go='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',xp='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',wp='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',Tp='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',Sp='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',Ep='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',Lp='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Ap='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Ip='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',$p='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Pp='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',Dp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',Np='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',Op='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',Mp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',Fp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',Vp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',Bp='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',Rp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',qp='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',Up='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',zp='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',jp='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',Yp='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',Wp='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>';var Ws={align:{"":fp,center:hp,right:vp,justify:_p},background:yp,blockquote:bp,bold:kp,clean:Cp,code:go,"code-block":go,color:xp,direction:{"":wp,rtl:Tp},formula:Sp,header:{"1":Ep,"2":Lp,"3":Ap,"4":Ip,"5":$p,"6":Pp},italic:Dp,image:Np,indent:{"+1":Op,"-1":Mp},link:Fp,list:{bullet:Vp,check:Bp,ordered:Rp},script:{sub:qp,super:Up},strike:zp,table:jp,underline:Yp,video:Wp};const Hp='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let fo=0;function ho(n,a){n.setAttribute(a,`${n.getAttribute(a)!=="true"}`)}class Hl{constructor(a){this.select=a,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),e.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),ho(this.label,"aria-expanded"),ho(this.options,"aria-hidden")}buildItem(a){const e=document.createElement("span");e.tabIndex="0",e.setAttribute("role","button"),e.classList.add("ql-picker-item");const s=a.getAttribute("value");return s&&e.setAttribute("data-value",s),a.textContent&&e.setAttribute("data-label",a.textContent),e.addEventListener("click",()=>{this.selectItem(e,!0)}),e.addEventListener("keydown",l=>{switch(l.key){case"Enter":this.selectItem(e,!0),l.preventDefault();break;case"Escape":this.escape(),l.preventDefault();break}}),e}buildLabel(){const a=document.createElement("span");return a.classList.add("ql-picker-label"),a.innerHTML=Hp,a.tabIndex="0",a.setAttribute("role","button"),a.setAttribute("aria-expanded","false"),this.container.appendChild(a),a}buildOptions(){const a=document.createElement("span");a.classList.add("ql-picker-options"),a.setAttribute("aria-hidden","true"),a.tabIndex="-1",a.id=`ql-picker-options-${fo}`,fo+=1,this.label.setAttribute("aria-controls",a.id),this.options=a,Array.from(this.select.options).forEach(e=>{const s=this.buildItem(e);a.appendChild(s),e.selected===!0&&this.selectItem(s)}),this.container.appendChild(a)}buildPicker(){Array.from(this.select.attributes).forEach(a=>{this.container.setAttribute(a.name,a.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(a){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.container.querySelector(".ql-selected");a!==s&&(s?.classList.remove("ql-selected"),a!=null&&(a.classList.add("ql-selected"),this.select.selectedIndex=Array.from(a.parentNode.children).indexOf(a),a.hasAttribute("data-value")?this.label.setAttribute("data-value",a.getAttribute("data-value")):this.label.removeAttribute("data-value"),a.hasAttribute("data-label")?this.label.setAttribute("data-label",a.getAttribute("data-label")):this.label.removeAttribute("data-label"),e&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let a;if(this.select.selectedIndex>-1){const s=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];a=this.select.options[this.select.selectedIndex],this.selectItem(s)}else this.selectItem(null);const e=a!=null&&a!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",e)}}class rr extends Hl{constructor(a,e){super(a),this.label.innerHTML=e,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(s=>{s.classList.add("ql-primary")})}buildItem(a){const e=super.buildItem(a);return e.style.backgroundColor=a.getAttribute("value")||"",e}selectItem(a,e){super.selectItem(a,e);const s=this.label.querySelector(".ql-color-label"),l=a&&a.getAttribute("data-value")||"";s&&(s.tagName==="line"?s.style.stroke=l:s.style.fill=l)}}class cr extends Hl{constructor(a,e){super(a),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(s=>{s.innerHTML=e[s.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(a,e){super.selectItem(a,e);const s=a||this.defaultItem;if(s!=null){if(this.label.innerHTML===s.innerHTML)return;this.label.innerHTML=s.innerHTML}}}const Zp=n=>{const{overflowY:a}=getComputedStyle(n,null);return a!=="visible"&&a!=="clip"};class ur{constructor(a,e){this.quill=a,this.boundsContainer=e||document.body,this.root=a.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,Zp(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(a){const e=a.left+a.width/2-this.root.offsetWidth/2,s=a.bottom+this.quill.root.scrollTop;this.root.style.left=`${e}px`,this.root.style.top=`${s}px`,this.root.classList.remove("ql-flip");const l=this.boundsContainer.getBoundingClientRect(),i=this.root.getBoundingClientRect();let o=0;if(i.right>l.right&&(o=l.right-i.right,this.root.style.left=`${e+o}px`),i.left<l.left&&(o=l.left-i.left,this.root.style.left=`${e+o}px`),i.bottom>l.bottom){const r=i.bottom-i.top,u=a.bottom-a.top+r;this.root.style.top=`${s-u}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const Gp=[!1,"center","right","justify"],Jp=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],Xp=[!1,"serif","monospace"],Qp=["1","2","3",!1],Kp=["small",!1,"large","huge"];class el extends Cs{constructor(a,e){super(a,e);const s=l=>{if(!document.body.contains(a.root)){document.body.removeEventListener("click",s);return}this.tooltip!=null&&!this.tooltip.root.contains(l.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(i=>{i.container.contains(l.target)||i.close()})};a.emitter.listenDOM("click",document.body,s)}addModule(a){const e=super.addModule(a);return a==="toolbar"&&this.extendToolbar(e),e}buildButtons(a,e){Array.from(a).forEach(s=>{(s.getAttribute("class")||"").split(/\s+/).forEach(i=>{if(!!i.startsWith("ql-")&&(i=i.slice(3),e[i]!=null))if(i==="direction")s.innerHTML=e[i][""]+e[i].rtl;else if(typeof e[i]=="string")s.innerHTML=e[i];else{const o=s.value||"";o!=null&&e[i][o]&&(s.innerHTML=e[i][o])}})})}buildPickers(a,e){this.pickers=Array.from(a).map(l=>{if(l.classList.contains("ql-align")&&(l.querySelector("option")==null&&Fs(l,Gp),typeof e.align=="object"))return new cr(l,e.align);if(l.classList.contains("ql-background")||l.classList.contains("ql-color")){const i=l.classList.contains("ql-background")?"background":"color";return l.querySelector("option")==null&&Fs(l,Jp,i==="background"?"#ffffff":"#000000"),new rr(l,e[i])}return l.querySelector("option")==null&&(l.classList.contains("ql-font")?Fs(l,Xp):l.classList.contains("ql-header")?Fs(l,Qp):l.classList.contains("ql-size")&&Fs(l,Kp)),new Hl(l)});const s=()=>{this.pickers.forEach(l=>{l.update()})};this.quill.on(Ee.events.EDITOR_CHANGE,s)}}el.DEFAULTS=La({},Cs.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let n=this.container.querySelector("input.ql-image[type=file]");n==null&&(n=document.createElement("input"),n.setAttribute("type","file"),n.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),n.classList.add("ql-image"),n.addEventListener("change",()=>{const a=this.quill.getSelection(!0);this.quill.uploader.upload(a,n.files),n.value=""}),this.container.appendChild(n)),n.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class dr extends ur{constructor(a,e){super(a,e),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",a=>{a.key==="Enter"?(this.save(),a.preventDefault()):a.key==="Escape"&&(this.cancel(),a.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;e!=null?this.textbox.value=e:a!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const s=this.quill.getBounds(this.quill.selection.savedRange);s!=null&&this.position(s),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${a}`)||""),this.root.setAttribute("data-mode",a)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:a}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:e}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",a,Ee.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",a,Ee.sources.USER)),this.quill.root.scrollTop=e;break}case"video":a=eg(a);case"formula":{if(!a)break;const e=this.quill.getSelection(!0);if(e!=null){const s=e.index+e.length;this.quill.insertEmbed(s,this.root.getAttribute("data-mode"),a,Ee.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(s+1," ",Ee.sources.USER),this.quill.setSelection(s+2,Ee.sources.USER)}break}}this.textbox.value="",this.hide()}}function eg(n){let a=n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return a?`${a[1]||"https"}://www.youtube.com/embed/${a[2]}?showinfo=0`:(a=n.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${a[1]||"https"}://player.vimeo.com/video/${a[2]}/`:n}function Fs(n,a){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a.forEach(s=>{const l=document.createElement("option");s===e?l.setAttribute("selected","selected"):l.setAttribute("value",String(s)),n.appendChild(l)})}const tg=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class ag extends dr{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(a,e){super(a,e),this.quill.on(Ee.events.EDITOR_CHANGE,(s,l,i,o)=>{if(s===Ee.events.SELECTION_CHANGE)if(l!=null&&l.length>0&&o===Ee.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const r=this.quill.getLines(l.index,l.length);if(r.length===1){const u=this.quill.getBounds(l);u!=null&&this.position(u)}else{const u=r[r.length-1],d=this.quill.getIndex(u),f=Math.min(u.length()-1,l.index+l.length-d),v=this.quill.getBounds(new Ra(d,f));v!=null&&this.position(v)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(Ee.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const a=this.quill.getSelection();if(a!=null){const e=this.quill.getBounds(a);e!=null&&this.position(e)}},1)})}cancel(){this.show()}position(a){const e=super.position(a),s=this.root.querySelector(".ql-tooltip-arrow");return s.style.marginLeft="",e!==0&&(s.style.marginLeft=`${-1*e-s.offsetWidth/2}px`),e}}class mr extends el{constructor(a,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=tg),super(a,e),this.quill.container.classList.add("ql-bubble")}extendToolbar(a){this.tooltip=new ag(this.quill,this.options.bounds),a.container!=null&&(this.tooltip.root.appendChild(a.container),this.buildButtons(a.container.querySelectorAll("button"),Ws),this.buildPickers(a.container.querySelectorAll("select"),Ws))}}mr.DEFAULTS=La({},el.DEFAULTS,{modules:{toolbar:{handlers:{link(n){n?this.quill.theme.tooltip.edit():this.quill.format("link",!1,ue.sources.USER)}}}}});const sg=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class lg extends dr{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",a=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),a.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",a=>{if(this.linkRange!=null){const e=this.linkRange;this.restoreFocus(),this.quill.formatText(e,"link",!1,Ee.sources.USER),delete this.linkRange}a.preventDefault(),this.hide()}),this.quill.on(Ee.events.SELECTION_CHANGE,(a,e,s)=>{if(a!=null){if(a.length===0&&s===Ee.sources.USER){const[l,i]=this.quill.scroll.descendant(Dl,a.index);if(l!=null){this.linkRange=new Ra(a.index-i,l.length());const o=Dl.formats(l.domNode);this.preview.textContent=o,this.preview.setAttribute("href",o),this.show();const r=this.quill.getBounds(this.linkRange);r!=null&&this.position(r);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class pr extends el{constructor(a,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=sg),super(a,e),this.quill.container.classList.add("ql-snow")}extendToolbar(a){a.container!=null&&(a.container.classList.add("ql-snow"),this.buildButtons(a.container.querySelectorAll("button"),Ws),this.buildPickers(a.container.querySelectorAll("select"),Ws),this.tooltip=new lg(this.quill,this.options.bounds),a.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(e,s)=>{a.handlers.link.call(a,!s.format.link)}))}}pr.DEFAULTS=La({},el.DEFAULTS,{modules:{toolbar:{handlers:{link(n){if(n){const a=this.quill.getSelection();if(a==null||a.length===0)return;let e=this.quill.getText(a);/^\S+@\S+\.\S+$/.test(e)&&e.indexOf("mailto:")!==0&&(e=`mailto:${e}`);const{tooltip:s}=this.quill.theme;s.edit("link",e)}else this.quill.format("link",!1,ue.sources.USER)}}}}});ue.register({"attributors/attribute/direction":Jo,"attributors/class/align":Ho,"attributors/class/background":cm,"attributors/class/color":rm,"attributors/class/direction":Xo,"attributors/class/font":er,"attributors/class/size":ar,"attributors/style/align":Zo,"attributors/style/background":Ci,"attributors/style/color":ki,"attributors/style/direction":Qo,"attributors/style/font":tr,"attributors/style/size":sr},!0);ue.register({"formats/align":Ho,"formats/direction":Xo,"formats/indent":tp,"formats/background":Ci,"formats/color":ki,"formats/font":er,"formats/size":ar,"formats/blockquote":ap,"formats/code-block":At,"formats/header":sp,"formats/list":Ks,"formats/bold":Ei,"formats/code":xi,"formats/italic":lp,"formats/link":Dl,"formats/script":np,"formats/strike":ip,"formats/underline":op,"formats/formula":rp,"formats/image":cp,"formats/video":up,"modules/syntax":or,"modules/table":mp,"modules/toolbar":Ai,"themes/bubble":mr,"themes/snow":pr,"ui/icons":Ws,"ui/picker":Hl,"ui/icon-picker":cr,"ui/color-picker":rr,"ui/tooltip":ur},!0);const ng={props:{content:String,value:String,disabled:{type:Boolean,default:!1},options:{type:Object,default:()=>({})}},emits:["ready","change","input","blur","focus","update:value"],setup(n,{emit:a}){const e=n,s={theme:"snow",boundary:document.body,modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},placeholder:"Insert content here ...",readOnly:!1},l=f=>{const v=new MutationObserver(g=>{g.forEach(()=>{})});return v.observe(f,{childList:!0,subtree:!0}),v},i=F(null);let o=null,r="";const u=(f,v)=>{for(const g in v)!f[g]||g!=="modules"?f[g]=v[g]:u(f[g],v[g]);return f},d=()=>{if(i.value){const f=u(s,e.options);f.readOnly=!!e.disabled,o=new ue(i.value,f),e.value&&o.clipboard.dangerouslyPasteHTML(e.value),o.on("selection-change",v=>{a(v?"focus":"blur",o)}),o.on("text-change",()=>{e.disabled&&o.enable(!1);let v=i.value.children[0].innerHTML;const g=o.getText();v==="<p><br></p>"&&(v=""),r=v,a("update:value",r),a("change",{html:v,text:g,quill:o})}),a("ready",o)}};return rt(()=>e.value,f=>{o&&f!==r?(r=f,o.clipboard.dangerouslyPasteHTML(f)):f||o.setText("")}),rt(()=>e.disabled,f=>{o&&o.enable(!f)}),Je(()=>{if(d(),i.value){const f=l(i.value);Oi(()=>{f.disconnect()})}}),zr(()=>{const f=i.value.previousSibling;f&&f.nodeType===1&&f.className.indexOf("ql-toolbar")>-1&&f.parentNode.removeChild(f)}),Oi(()=>{o=null}),(f,v)=>(c(),y("section",{ref_key:"editor",ref:i},null,512))}};const ig={class:"am-desc-editor__header"},og={class:"am-desc-editor__header-warning"},rg=m("span",{class:"am-icon-triangle-info"},null,-1),cg={key:1,class:"am-quill-wrapper"},gr={props:{modelValue:{type:String,default:""},mode:{type:String,default:"html"}},emits:["update:modelValue","setMode"],setup(n,{emit:a}){const e=n;let s=R("amLabels"),l=F(e.mode),i=_({get:()=>e.modelValue,set:v=>{a("update:modelValue",v)}});function o(){l.value="text",a("setMode","text")}function r(){l.value="html",a("setMode","html")}const u={theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{color:[]},{background:[]}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]]},readOnly:!1};let d=R("amColors",F({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#808A90",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),f=_(()=>({"--am-c-desce-text-op03":H(d.value.colorMainText,.03),"--am-c-desce-warn-op10":H(d.value.colorWarning,.1)}));return(v,g)=>t(l)?(c(),y("div",{key:0,class:"am-desc-editor",style:be(t(f))},[m("div",ig,[$(jr,null,{default:x(()=>[$(Se,{category:t(l)==="text"?"primary":"secondary",type:t(l)==="text"?"filled":"plain",size:"small",onClick:o},{default:x(()=>[ce(C(t(s).text_mode),1)]),_:1},8,["category","type"]),$(Se,{category:t(l)==="html"?"primary":"secondary",type:t(l)==="html"?"filled":"plain",size:"small",onClick:r},{default:x(()=>[ce(C(t(s).html_mode),1)]),_:1},8,["category","type"])]),_:1}),m("div",og,[rg,ce(" "+C(t(s).content_mode_tooltip),1)])]),t(l)==="html"?(c(),U(it,{key:0,modelValue:t(i),"onUpdate:modelValue":g[0]||(g[0]=k=>we(i)?i.value=k:i=k),type:"textarea",rows:3,style:{width:"100%"}},null,8,["modelValue"])):O("",!0),t(l)==="text"?(c(),y("div",cg,[$(ng,{value:t(i),"onUpdate:value":g[1]||(g[1]=k=>we(i)?i.value=k:i=k),options:u},null,8,["value"])])):O("",!0)],4)):O("",!0)}};const ug=["innerHTML"],dg={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:a}){const e=n,s=De(),l=R("settings");let i=R("amLabels"),o=_(()=>s.getters["entities/getEmployee"](s.getters["employee/getId"])),r=_(()=>s.getters["entities/getLocations"]),u=_(()=>r.value.map(E=>({value:E.id,label:E.name}))),d=F(null),f=F(!1),v=F({firstName:_({get:()=>s.getters["employee/getFirstName"],set:E=>{s.commit("employee/setFirstName",E||"")}}),lastName:_({get:()=>s.getters["employee/getLastName"],set:E=>{s.commit("employee/setLastName",E||"")}}),email:_({get:()=>s.getters["employee/getEmail"],set:E=>{s.commit("employee/setEmail",E||"")}}),phone:_({get:()=>s.getters["employee/getPhone"],set:E=>{s.commit("employee/setPhone",E||"")}}),locationId:_({get:()=>s.getters["employee/getLocationId"],set:E=>{s.commit("employee/setLocationId",E||"")}}),description:_({get:()=>s.getters["employee/getDescription"],set:E=>{s.commit("employee/setDescription",E||"")}})}),g=_(()=>({firstName:[{required:!0,message:i.enter_first_name_warning,trigger:["submit","change"]}],lastName:[{required:!0,message:i.enter_last_name_warning,trigger:["submit","change"]}],email:[{required:!0,message:i.enter_email_warning,trigger:["submit","change"]}],locationId:[{required:r.value.filter(E=>E.status==="visible").length>0,message:i.enter_location_warning,trigger:["submit","change"]}]})),k=F({firstName:{template:Ye.text,props:{itemName:"firstName",label:i.first_name_colon,placeholder:i.enter_first_name,class:_(()=>`am-caepif__item ${e.responsiveClass}`)}},lastName:{template:Ye.text,props:{itemName:"lastName",label:i.last_name_colon,placeholder:i.enter_last_name,class:_(()=>`am-caepif__item ${e.responsiveClass}`)}},email:{template:Ye.text,props:{itemName:"email",label:i.email_colon,placeholder:i.enter_email,class:_(()=>`am-caepif__item ${e.responsiveClass}`)}},phone:{countryPhoneIso:_({get:()=>s.getters["auth/getProfile"].countryPhoneIso?s.getters["auth/getProfile"].countryPhoneIso:"",set:E=>{s.commit("auth/setProfileCountryPhoneIso",E?E.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:i.phone_colon,placeholder:i.enter_phone,defaultCode:_(()=>s.getters["auth/getProfile"].countryPhoneIso?s.getters["auth/getProfile"].countryPhoneIso:""),phoneError:_(()=>f.value),whatsAppLabel:i.whatsapp_opt_in_text,isWhatsApp:l.notifications.whatsAppEnabled&&l.notifications.whatsAppAccessToken&&l.notifications.whatsAppBusinessID&&l.notifications.whatsAppPhoneID,class:_(()=>`am-caepif__item ${e.responsiveClass}`)}}}),N=F({locationId:{template:Ye.select,props:{itemName:"locationId",label:`${i.location}:`,placeholder:i.select_location,class:_(()=>`am-caepif__item ${e.responsiveClass} ${l.zoom.enabled||"am-w-100"}`),options:u.value}}});return Zs(()=>{r.value.length||delete N.value.locationId}),a({employeeFormRef:d}),(E,b)=>{const A=yt,S=et;return c(),U(S,{ref_key:"employeeFormRef",ref:d,model:t(v),rules:t(g),"label-position":"top",class:q(["am-caepif",e.responsiveClass])},{default:x(()=>[m("div",{class:q(["am-caepif__block",[{"am-w-70":t(o).pictureFullPath},e.responsiveClass]])},[(c(!0),y(ee,null,fe(t(k),(P,h)=>(c(),U(pt(P.template),Lt({key:h,ref_for:!0,ref:"customerCollectorRef",modelValue:t(v)[h],"onUpdate:modelValue":I=>t(v)[h]=I,countryPhoneIso:P.countryPhoneIso,"onUpdate:countryPhoneIso":I=>P.countryPhoneIso=I},P.props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"]))),128))],2),t(o).pictureFullPath?(c(),y("div",{key:0,class:q(["am-caepif__block am-w-30",e.responsiveClass])},[m("div",{class:"am-caepif__img",style:be({backgroundImage:`url(${t(o).pictureFullPath})`})},null,4)],2)):O("",!0),m("div",{class:q(["am-caepif__block",e.responsiveClass])},[(c(!0),y(ee,null,fe(t(N),(P,h)=>(c(),U(pt(P.template),Lt({key:h,ref_for:!0,ref:"customerCollectorRef",modelValue:t(v)[h],"onUpdate:modelValue":I=>t(v)[h]=I},P.props,ui(P.handlers?P.handlers:{})),{default:x(()=>[P.slots&&P.slots.default?(c(),y("div",{key:0,innerHTML:P.slots.default},null,8,ug)):O("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue"]))),128)),$(A,{label:t(i).description_colon},{default:x(()=>[$(gr,{modelValue:t(v).description,"onUpdate:modelValue":b[0]||(b[0]=P=>t(v).description=P),mode:t(s).getters["employee/getDescriptionMode"],onSetMode:b[1]||(b[1]=P=>t(s).commit("employee/setDescriptionMode",P))},null,8,["modelValue","mode"])]),_:1},8,["label"])],2)]),_:1},8,["model","rules","class"])}}};const mg={class:"am-caes__category-header"},pg={class:"am-caes__category-header__text"},gg={class:"am-caes__service-header"},fg={class:"am-caes__service-header__text"},hg={class:"am-caes__service-content"},vg={class:"am-caes__service-content__text"},_g={class:"am-caes__service-content__text"},yg={class:"am-caes__service-content__text"},bg={class:"am-caes__service-content__inner am-caes__service-content__disabled"},kg={class:"am-caes__service-content__text"},Cg={class:"am-caes__service-content__text"},xg={class:"am-caes__service-content__inner am-caes__service-content__disabled"},wg={class:"am-caes__service-content__text"},Tg={class:"am-caes__service-content__text"},Sg={class:"am-caes__service-content__inner am-caes__service-content__disabled"},Eg={class:"am-caes__service-content__text"},Lg={class:"am-caes__service__week-days"},Ag={class:"am-caes__service__week-periods"},Ig={class:"am-caes__service__week-periods-item-range"},$g=ce(" - "),Pg={class:"am-caes__service__date"},Dg=m("span",{class:"am-icon-calendar"},null,-1),Ng={class:"am-caes__service__week-periods"},Og={class:"am-caes__service__week-periods-item-range"},Mg=ce(" - "),Fg={name:"CabinetEmployeeProfileServices"},Vg=Object.assign(Fg,{props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=R("licence"),s=De(),l=R("amLabels"),i=F(""),o={components:{IconComponent:We},template:'<IconComponent icon="search"/>'},r=F([{label:"Mon",labelFull:"Monday",value:0},{label:"Tue",labelFull:"Tuesday",value:1},{label:"Wed",labelFull:"Wednesday",value:2},{label:"Thu",labelFull:"Thursday",value:3},{label:"Fri",labelFull:"Friday",value:4},{label:"Sat",labelFull:"Saturday",value:5},{label:"Sun",labelFull:"Sunday",value:6}]),u=F({}),d=_(()=>s.getters["employee/getEmployee"]),f=_(()=>s.getters["entities/getCategories"].filter(S=>S.status==="visible"&&S.serviceList.length>0&&(!i.value.trim()||S.serviceList.filter(P=>P.name.toLowerCase().includes(i.value.toLowerCase().trim())).length))),v=F(f.value.length===1?"category_"+f.value[0].id:null),g=F(0);function k(S){const P=S.serviceList.filter(h=>d.value.serviceList[S.id][h.id].enabled);return P.length>0&&P.length<S.serviceList.length}function N(S){const P=S.serviceList.filter(h=>d.value.serviceList[S.id][h.id].enabled);u.value[S.id]=P.length!==0}function E(S,P){P.serviceList.forEach(h=>{s.commit("employee/setServiceEnabled",{categoryId:P.id,serviceId:h.id,value:S})})}Je(()=>{Rs&&(r.value=r.value.map((S,P)=>({...S,label:wo[P],labelFull:To[P]}))),f.value.forEach(S=>{u.value[S.id]=S.serviceList.filter(P=>d.value.serviceList[S.id][P.id].enabled).length!==0})});let b=R("amColors"),A=_(()=>({"--am-c-caes-primary":b.value.colorPrimary,"--am-c-caes-primary-op03":H(b.value.colorPrimary,.3),"--am-c-caes-text":b.value.colorMainText,"--am-c-caes-text-op03":H(b.value.colorMainText,.03),"--am-c-caes-text-op50":H(b.value.colorMainText,.5),"--am-c-caes-inp-bgr-op03":H(b.value.colorInpBgr,.03),"--am-c-caes-border":b.value.colorInpBorder}));return(S,P)=>{const h=va,I=_a,L=bs,T=ks;return c(),y("div",null,[m("div",null,[$(it,{modelValue:t(i),"onUpdate:modelValue":P[0]||(P[0]=w=>we(i)?i.value=w:i=w),"prefix-icon":t(o),"aria-label":"Search"},null,8,["modelValue","prefix-icon"])]),$(T,{modelValue:t(v),"onUpdate:modelValue":P[2]||(P[2]=w=>we(v)?v.value=w:v=w),class:"am-caes",style:be(t(A))},{default:x(()=>[(c(!0),y(ee,null,fe(t(f),w=>(c(),U(L,{key:"category_"+w.id,name:"category_"+w.id,class:"am-caes__category"},{title:x(()=>[m("div",mg,[$(mt,{modelValue:t(u)[w.id],"onUpdate:modelValue":B=>t(u)[w.id]=B,indeterminate:k(w),onClick:B=>{B.stopPropagation(),we(v)?v.value=`category_${w.id}`:v=`category_${w.id}`},onChange:B=>E(B,w),onKeydown:Mi(B=>{B.stopPropagation(),we(v)?v.value=`category_${w.id}`:v=`category_${w.id}`,t(u)[w.id]=!t(u)[w.id],E(t(u)[w.id],w)},["enter"])},null,8,["modelValue","onUpdate:modelValue","indeterminate","onClick","onChange","onKeydown"]),m("div",pg,C(w.name),1)])]),default:x(()=>[$(T,{modelValue:t(g),"onUpdate:modelValue":P[1]||(P[1]=B=>we(g)?g.value=B:g=B),class:"am-caes__inner"},{default:x(()=>[(c(!0),y(ee,null,fe(t(f).find(B=>B.id===w.id).serviceList.filter(B=>!t(i).trim()||B.name.toLowerCase().includes(t(i).toLowerCase())),B=>(c(),U(L,{key:`service_${B.id}`,name:`service_${B.id}`,class:"am-caes__service"},{title:x(()=>[m("div",gg,[$(mt,{modelValue:t(d).serviceList[w.id][B.id].enabled,"onUpdate:modelValue":z=>t(d).serviceList[w.id][B.id].enabled=z,onClick:z=>{z.stopPropagation(),we(g)?g.value=`service_${B.id}`:g=`service_${B.id}`},onChange:z=>N(w),onKeydown:Mi(z=>{z.stopPropagation(),we(g)?g.value=`service_${B.id}`:g=`service_${B.id}`,t(d).serviceList[w.id][B.id].enabled=!t(d).serviceList[w.id][B.id].enabled,N(w)},["enter"])},null,8,["modelValue","onUpdate:modelValue","onClick","onChange","onKeydown"]),m("div",fg,C(B.name),1)])]),default:x(()=>[m("div",hg,[m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",vg,C(t(l).minimum_capacity),1),$(ht,{modelValue:t(d).serviceList[w.id][B.id].minCapacity,"onUpdate:modelValue":z=>t(d).serviceList[w.id][B.id].minCapacity=z,class:"am-caes__service-content__inner",min:1,size:"small"},null,8,["modelValue","onUpdate:modelValue"])],2),m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",_g,C(t(l).maximum_capacity),1),$(ht,{modelValue:t(d).serviceList[w.id][B.id].maxCapacity,"onUpdate:modelValue":z=>t(d).serviceList[w.id][B.id].maxCapacity=z,class:"am-caes__service-content__inner",min:t(d).serviceList[w.id][B.id].minCapacity,size:"small","aria-label":t(l).maximum_capacity},null,8,["modelValue","onUpdate:modelValue","min","aria-label"])],2),(c(!0),y(ee,null,fe(t(d).serviceList[w.id][B.id].customPricing.enabled==="duration"?t(d).serviceList[w.id][B.id].customPricing.durations:[],(z,D)=>(c(),y(ee,{key:D},[t(d).serviceList[w.id][B.id].customPricing.enabled==="duration"?(c(),y("div",{key:0,class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",yg,C(t(l).duration),1),m("div",bg,C(t(hs)(D,t(l).h,t(l).min)),1)],2)):O("",!0),m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",kg,C(t(l).price),1),$(it,{modelValue:z.price,"onUpdate:modelValue":G=>z.price=G,class:"am-caes__service-content__inner",placeholder:"","aria-label":t(l).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)],64))),128)),t(d).serviceList[w.id][B.id].customPricing.enabled==="period"||t(d).serviceList[w.id][B.id].customPricing.enabled===null?(c(),y("div",{key:0,class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",Cg,C(t(l).duration),1),m("div",xg,C(t(hs)(B.duration,t(l).h,t(l).min)),1)],2)):O("",!0),t(d).serviceList[w.id][B.id].customPricing.enabled==="period"||t(d).serviceList[w.id][B.id].customPricing.enabled===null?(c(),y("div",{key:1,class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",wg,C(t(l).price),1),$(it,{modelValue:t(d).serviceList[w.id][B.id].price,"onUpdate:modelValue":z=>t(d).serviceList[w.id][B.id].price=z,class:"am-caes__service-content__inner",placeholder:"","aria-label":t(l).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)):O("",!0),(c(!0),y(ee,null,fe(t(d).serviceList[w.id][B.id].customPricing.enabled==="person"?t(d).serviceList[w.id][B.id].customPricing.persons:[],(z,D)=>(c(),y(ee,{key:D},[m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",Tg,C(t(l).capacity),1),m("div",Sg,C(z.from)+" - "+C(D),1)],2),m("div",{class:q(["am-caes__service-content__item",a.responsiveClass])},[m("div",Eg,C(t(l).price),1),$(it,{modelValue:z.price,"onUpdate:modelValue":G=>z.price=G,class:"am-caes__service-content__inner",placeholder:"",size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue"])],2)],64))),128))]),t(d).serviceList[w.id][B.id].customPricing.enabled==="period"&&!t(e).isLite&&!t(e).isStarter&&!t(e).isBasic?(c(),U(I,{key:0,class:"am-caes__service-tabs",stretch:!0},{default:x(()=>[t(d).serviceList[w.id][B.id].customPricing.periods.default.length?(c(),U(h,{key:0,label:t(l).week_days},{default:x(()=>[(c(!0),y(ee,null,fe(t(d).serviceList[w.id][B.id].customPricing.periods.default,(z,D)=>(c(),y("div",{key:D,class:"am-caes__service__week"},[m("div",Lg,[(c(!0),y(ee,null,fe(t(r),(G,se)=>(c(),y("div",{key:se,class:q(["am-caes__service__week-day",{"am-caes__service__week-day-selected":z.days.indexOf(G.value)!==-1}])},[m("span",null,C(G.label),1)],2))),128))]),m("div",Ag,[(c(!0),y(ee,null,fe(z.ranges,(G,se)=>(c(),y("div",{key:se,class:"am-caes__service__week-periods-item"},[m("div",Ig,[m("span",null,C(G.from),1),$g,m("span",null,C(G.to),1)]),m("div",{class:q([a.responsiveClass,"am-caes__service__week-periods-item-price"])},[$(it,{modelValue:G.price,"onUpdate:modelValue":j=>G.price=j,placeholder:"","aria-label":t(l).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)]))),128))])]))),128))]),_:2},1032,["label"])):O("",!0),t(d).serviceList[w.id][B.id].customPricing.periods.custom.length?(c(),U(h,{key:1,label:t(l).custom_days},{default:x(()=>[(c(!0),y(ee,null,fe(t(d).serviceList[w.id][B.id].customPricing.periods.custom,(z,D)=>(c(),y("div",{key:D,class:"am-caes__service__week"},[m("div",Pg,[Dg,ce(C(t(nt)(z.dates.start))+" - "+C(t(nt)(z.dates.end)),1)]),m("div",Ng,[(c(!0),y(ee,null,fe(z.ranges,(G,se)=>(c(),y("div",{key:se,class:"am-caes__service__week-periods-item"},[m("div",Og,[m("span",null,C(G.from),1),Mg,m("span",null,C(G.to),1)]),m("div",{class:q([a.responsiveClass,"am-caes__service__week-periods-item-price"])},[$(it,{modelValue:G.price,"onUpdate:modelValue":j=>G.price=j,placeholder:"","aria-label":t(l).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)]))),128))])]))),128))]),_:2},1032,["label"])):O("",!0)]),_:2},1024)):O("",!0)]),_:2},1032,["name"]))),128))]),_:2},1032,["modelValue"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])])}}});const Ea={props:{modelValue:{type:String},id:{type:String,default:""},disabled:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},includeEndTime:{type:Boolean,default:!1},size:{type:String,default:"default",validator(n){return["default","medium","small","mini","micro"].includes(n)}},placeholder:{type:String,default:""},name:{type:String},effect:{type:String,default:"light",validator(n){return["dark","light"].includes(n)}},prefixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="clock"/>'})},suffixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="arrow-up"/>'})},clearIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="close"/>'})},start:{type:String,default:""},end:{type:String,default:""},step:{type:String,default:""},minTime:{type:String,default:""},maxTime:{type:String,default:""},format:{type:String,default:"HH:mm"},popperClass:{type:String,default:""},class:{type:String,default:""},parentClass:{type:String,default:""}},emits:["update:modelValue"],setup(n,{emit:a}){const e=n,{modelValue:s}=ii(e),l=_({get:()=>s.value,set:d=>{a("update:modelValue",d)}}),i=F(null);let o=R("amFonts",F({fontFamily:"Amelia Roboto, sans-serif",fontUrl:"",customFontFamily:"",fontFormat:"",customFontSelected:!1})),r=R("amColors",F({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#808A90",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),u=_(()=>({"--am-c-timeselect-shadow":H(r.value.colorInpText,.05),"--am-c-timeselect-text-op60":H(r.value.colorInpText,.6),"--am-c-timeselect-text-op40":H(r.value.colorInpText,.4),"--am-c-timeselect-text-op10":H(r.value.colorInpText,.03),"--am-font-family":o.value.fontFamily}));return Je(()=>{const d=document.querySelector("[id^='el-popper-container']");d.style.setProperty("--am-c-option-bgr",r.value.colorDropBgr),d.style.setProperty("--am-c-option-border",r.value.colorDropBorder),d.style.setProperty("--am-c-option-text",r.value.colorDropText),d.style.setProperty("--am-c-option-text-op65",H(r.value.colorDropText,.65)),d.style.setProperty("--am-c-option-text-op50",H(r.value.colorDropText,.5)),d.style.setProperty("--am-c-option-hover",H(r.value.colorDropText,.1)),d.style.setProperty("--am-c-option-selected",r.value.colorPrimary),d.style.setProperty("--am-c-option-selected-op10",H(r.value.colorPrimary,.1)),d.style.setProperty("--am-c-option-img-bgr",r.value.colorSuccess),d.style.setProperty("--am-c-option-img-text",r.value.colorMainBgr),d.style.setProperty("--am-font-family",o.value.fontFamily)}),(d,f)=>{const v=Yr;return c(),y("div",{class:q(["am-time-select__wrapper",n.parentClass]),style:be(t(u))},[$(v,{id:e.id,ref_key:"amTimeSelect",ref:i,modelValue:t(l),"onUpdate:modelValue":f[0]||(f[0]=g=>we(l)?l.value=g:null),class:q(["am-time-select",[`am-time-select--${n.size}`,{"am-time-select--disabled":n.disabled},{"am-time-select--prefix":e.prefixIcon},{"am-time-select--suffix":e.suffixIcon||e.clearIcon&&d.pross.clearable},e.class]]),disabled:e.disabled,placeholder:e.placeholder,"clear-icon":e.clearIcon,clearable:e.clearable,editable:e.editable,name:e.name,"popper-class":`am-time-select__popper${e.popperClass?" "+e.popperClass:e.popperClass}`,"prefix-icon":e.prefixIcon,"suffix-icon":e.suffixIcon,end:e.end,"max-time":e.maxTime,"min-time":e.minTime,start:e.start,step:e.step,format:e.format,"include-end-time":e.includeEndTime,effect:e.effect},null,8,["id","modelValue","class","disabled","placeholder","clear-icon","clearable","editable","name","popper-class","prefix-icon","suffix-icon","end","max-time","min-time","start","step","format","include-end-time","effect"])],6)}}};const Bg={class:"am-csd__period-header"},Rg={class:"am-csd__period-content__inner"},qg=m("span",{class:"am-icon-clearable"},null,-1),Ug={name:"WorkPeriod"},zg=Object.assign(Ug,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},origin:{type:String,default:""},periodIndex:{type:Number,default:0},originIndex:{type:Number,default:0},isNew:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:a}){const e=n;let s=De();const l=R("settings");let i=R("amLabels"),o=R("pageWidth"),r=F(null),u=_(()=>e.visibility);const{width:d}=ja(r),f=_(()=>st(d.value));rt(u,ne=>{ne&&setTimeout(()=>{E.value=JSON.parse(JSON.stringify(L.value[e.periodIndex]))},300)});let v=F(!1),g=F(null),k=F("");function N(){v.value=!1,k.value=""}let E=F(null),b=F({startTime:_({get:()=>T.value.startTime,set:ne=>{T.value.startTime=ne}}),endTime:_({get:()=>T.value.endTime,set:ne=>{T.value.endTime=ne}}),periodServiceList:_({get:()=>T.value.periodServiceList,set:ne=>{T.value.periodServiceList=ne}}),periodLocationList:_({get:()=>T.value.periodLocationList,set:ne=>{T.value.periodLocationList=ne}})}),A=F(null),S=_(()=>({startTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}],endTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}]})),P=F();Be("formWrapper",P);let h=F(s.getters["entities/getLocations"]),I=_(()=>{let ne=So(s),te=T.value.periodServiceList.filter(oe=>ne.map(ie=>ie.id).indexOf(oe)===-1);return ne.concat(s.getters["entities/getServices"].filter(oe=>te.indexOf(oe.id)!==-1))}),L=_(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].periodList),T=_(()=>e.periodIndex!==null?L.value[e.periodIndex]:null);function w(ne){return Nt(Bt(ne)-l.general.timeSlotLength)}function B(ne){let te=Nt(Bt(ne)+l.general.timeSlotLength);return te==="00:00"?null:te}function z(){A.value.validate(ne=>{ne&&a("close")})}function D(){e.isNew?L.value.pop():L.value[e.periodIndex]=E.value,a("close")}let G=R("amFonts"),se=R("amColors"),j=_(()=>({"--am-c-csd-text":se.value.colorMainText,"--am-c-csd-bgr":se.value.colorMainBgr,"--am-c-csd-text-op10":H(se.value.colorMainText,.1),"--am-c-scroll-op30":H(se.value.colorPrimary,.3),"--am-c-scroll-op10":H(se.value.colorPrimary,.1),"--am-font-family":G.value.fontFamily}));return(ne,te)=>{const oe=yt,ie=et;return c(),U(za,{visibility:t(e).visibility,style:be(t(j)),"custom-class":`am-csd am-csd__period${t(o)<=400?" am-w-100":""}`,position:"center","onUpdate:visibility":D},Eo({footer:x(()=>[m("div",{class:q(["am-csd__period-footer",t(f)])},[$(Se,{category:"secondary",type:"plain",size:t(o)>430?"default":"small",onClick:D},{default:x(()=>[ce(C(t(i).cancel),1)]),_:1},8,["size"]),$(Se,{size:t(o)>430?"default":"small",onClick:z},{default:x(()=>[ce(C(t(i).save),1)]),_:1},8,["size"])],2)]),default:x(()=>[t(T)?(c(),y("div",{key:0,ref_key:"popupPeriodRef",ref:r,class:"am-csd__period-content"},[m("div",Rg,[t(v)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:N,onTriggerClose:N},{title:x(()=>[qg,ce(" "+C(t(k)),1)]),_:1},512)):O("",!0),$(ie,{ref_key:"periodFormRef",ref:A,class:"am-csd__period-form",rules:t(S),model:t(b),"label-position":"top"},{default:x(()=>[$(oe,{label:`${t(i).time}:`,prop:"startTime",class:q(["am-csd__period-form__item am-w-50",t(f)])},{default:x(()=>[$(Ea,{modelValue:t(T).startTime,"onUpdate:modelValue":te[0]||(te[0]=K=>t(T).startTime=K),placeholder:t(i).from,start:"00:00",end:w("24:00"),"min-time":t(e).periodIndex===0?null:w(t(L)[t(e).periodIndex-1].endTime),"max-time":t(e).periodIndex===t(L).length-1?null:t(T).endTime,step:t(Nt)(t(l).general.timeSlotLength)},null,8,["modelValue","placeholder","end","min-time","max-time","step"])]),_:1},8,["label","class"]),$(oe,{label:`${t(i).time}:`,prop:"endTime",class:q(["am-csd__period-form__item am-w-50",t(f)])},{default:x(()=>[$(Ea,{modelValue:t(T).endTime,"onUpdate:modelValue":te[1]||(te[1]=K=>t(T).endTime=K),placeholder:t(i).to_upper,disabled:!t(T).startTime,start:B("00:00"),end:"24:00","min-time":t(T).startTime,"max-time":t(e).periodIndex===t(L).length-1?null:B(t(L)[t(e).periodIndex+1].startTime),step:t(Nt)(t(l).general.timeSlotLength)},null,8,["modelValue","placeholder","disabled","start","min-time","max-time","step"])]),_:1},8,["label","class"]),$(oe,{label:`${t(i).heading_services}:`,prop:"periodServiceList",class:"am-csd__period-form__item"},{default:x(()=>[$(He,{modelValue:t(T).periodServiceList,"onUpdate:modelValue":te[2]||(te[2]=K=>t(T).periodServiceList=K),placeholder:`${t(i).all_services}`,multiple:"",clearable:""},{default:x(()=>[(c(!0),y(ee,null,fe(t(I),K=>(c(),U(qe,{key:K.id,value:K.id,label:K.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),t(h).length>0?(c(),U(oe,{key:0,label:`${t(i).location}:`,prop:"periodLocationList",class:"am-csd__period-form__item"},{default:x(()=>[$(He,{modelValue:t(T).periodLocationList,"onUpdate:modelValue":te[3]||(te[3]=K=>t(T).periodLocationList=K),placeholder:`${t(i).all_locations}`,multiple:"",clearable:""},{default:x(()=>[(c(!0),y(ee,null,fe(t(h),K=>(c(),U(qe,{key:K.id,value:K.id,label:K.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):O("",!0)]),_:1},8,["rules","model"])])],512)):O("",!0)]),_:2},[t(e).title?{name:"header",fn:x(()=>[m("div",Bg,C(t(e).title),1)])}:void 0]),1032,["visibility","style","custom-class"])}}});const jg={class:"am-csd__timeOut-header"},Yg={class:"am-csd__timeOut-content__inner"},Wg=m("span",{class:"am-icon-clearable"},null,-1),Hg={name:"WorkTimeOut"},Zg=Object.assign(Hg,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},origin:{type:String,default:""},timeOutIndex:{type:Number,default:0},originIndex:{type:Number,default:0},isNew:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:a}){const e=n;let s=De();const l=R("settings");let i=R("amLabels"),o=R("pageWidth"),r=F(null),u=_(()=>e.visibility);const{width:d}=ja(r),f=_(()=>st(d.value));rt(u,j=>{j&&setTimeout(()=>{E.value=JSON.parse(JSON.stringify(h.value[e.timeOutIndex]))},300)});let v=F(!1),g=F(null),k=F("");function N(){v.value=!1,k.value=""}let E=F(null),b=F({startTime:_({get:()=>L.value.startTime,set:j=>{L.value.startTime=j}}),endTime:_({get:()=>L.value.endTime,set:j=>{L.value.endTime=j}})}),A=F(null),S=_(()=>({startTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}],endTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}]})),P=F();Be("formWrapper",P);let h=_(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].timeOutList),I=_(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].periodList),L=_(()=>e.timeOutIndex!==null?h.value[e.timeOutIndex]:null);_(()=>I.value.length?w(I.value[0].startTime):"00:00"),_(()=>I.value.length?T(I.value[I.value.length-1].endTime):"00:00");function T(j){return Nt(Bt(j)-l.general.timeSlotLength)}function w(j){let ne=Nt(Bt(j)+l.general.timeSlotLength);return ne==="00:00"?null:ne}function B(){A.value.validate(j=>{j&&a("close")})}function z(){e.isNew?h.value.pop():h.value[e.timeOutIndex]=E.value,a("close")}let D=R("amFonts"),G=R("amColors"),se=_(()=>({"--am-c-csd-text":G.value.colorMainText,"--am-c-csd-bgr":G.value.colorMainBgr,"--am-c-csd-text-op10":H(G.value.colorMainText,.1),"--am-c-scroll-op30":H(G.value.colorPrimary,.3),"--am-c-scroll-op10":H(G.value.colorPrimary,.1),"--am-font-family":D.value.fontFamily}));return(j,ne)=>{const te=yt,oe=et;return c(),U(za,{visibility:t(e).visibility,style:be(t(se)),"custom-class":`am-csd am-csd__timeOut${t(o)<=400?" am-w-100":""}`,position:"center","onUpdate:visibility":z},Eo({footer:x(()=>[m("div",{class:q(["am-csd__timeOut-footer",t(f)])},[$(Se,{category:"secondary",type:"plain",size:t(o)>430?"default":"small",onClick:z},{default:x(()=>[ce(C(t(i).cancel),1)]),_:1},8,["size"]),$(Se,{size:t(o)>430?"default":"small",onClick:B},{default:x(()=>[ce(C(t(i).save),1)]),_:1},8,["size"])],2)]),default:x(()=>[t(L)?(c(),y("div",{key:0,ref_key:"popupTimeOutRef",ref:r,class:"am-csd__timeOut-content"},[m("div",Yg,[t(v)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:N,onTriggerClose:N},{title:x(()=>[Wg,ce(" "+C(t(k)),1)]),_:1},512)):O("",!0),$(oe,{ref_key:"timeOutFormRef",ref:A,class:"am-csd__timeOut-form",rules:t(S),model:t(b),"label-position":"top"},{default:x(()=>[$(te,{label:`${t(i).time}:`,prop:"startTime",class:q(["am-csd__timeOut-form__item am-w-50",t(f)])},{default:x(()=>[$(Ea,{modelValue:t(L).startTime,"onUpdate:modelValue":ne[0]||(ne[0]=ie=>t(L).startTime=ie),placeholder:t(i).from,start:w(t(I)[0].startTime),end:T(t(I)[t(I).length-1].endTime),step:t(Nt)(t(l).general.timeSlotLength),"max-time":t(h)[t(e).timeOutIndex].endTime},null,8,["modelValue","placeholder","start","end","step","max-time"])]),_:1},8,["label","class"]),$(te,{label:`${t(i).time}:`,prop:"endTime",class:q(["am-csd__timeOut-form__item am-w-50",t(f)])},{default:x(()=>[$(Ea,{modelValue:t(L).endTime,"onUpdate:modelValue":ne[1]||(ne[1]=ie=>t(L).endTime=ie),placeholder:t(i).to_upper,disabled:!t(L).startTime,start:w(t(I)[0].startTime),end:T(t(I)[t(I).length-1].endTime),"min-time":t(h)[t(e).timeOutIndex].startTime,step:t(Nt)(t(l).general.timeSlotLength)},null,8,["modelValue","placeholder","disabled","start","end","min-time","step"])]),_:1},8,["label","class"])]),_:1},8,["rules","model"])])],512)):O("",!0)]),_:2},[t(e).title?{name:"header",fn:x(()=>[m("div",jg,C(t(e).title),1)])}:void 0]),1032,["visibility","style","custom-class"])}}});const Gg={class:"am-cc__edit"},Jg=m("span",{class:"am-icon-edit"},null,-1),Xg={class:"am-cc__edit-text"},Qg=m("span",{class:"am-icon-search"},null,-1),Kg={class:"am-cc__edit-text"},ef=m("span",{class:"am-icon-clearable"},null,-1),tf={class:"am-cc__edit-text"},af=m("span",{class:"am-icon-clearable"},null,-1),sf={class:"am-cc__edit-text"},lf={name:"DotsPopup"},ha=Object.assign(lf,{props:{index:{type:Number,default:0},referenceClass:{type:String,default:""},haveDuplicate:{type:Boolean,default:!1},haveDelete:{type:Boolean,default:!0},haveEdit:{type:Boolean,default:!0},haveView:{type:Boolean,default:!1}},emits:["remove","edit","duplicate"],setup(n,{emit:a}){const e=n;let s=R("amLabels"),l=F(!1);function i(){l.value=!0}function o(){a("edit",e.index),d()}function r(){a("remove",e.index),d()}function u(){a("duplicate",e.index),d()}function d(){l.value=!1}let f=R("amFonts"),v=R("amColors"),g=_(()=>({"--am-c-cc-error":v.value.colorError,"--am-c-cc-error-op15":H(v.value.colorError,.15),"--am-c-cc-bgr":v.value.colorMainBgr,"--am-c-cc-text":v.value.colorMainText,"--am-c-cc-text-op10":H(v.value.colorMainText,.1),"--am-c-cc-text-op15":H(v.value.colorMainText,.15),"--am-font-family":f.value.fontFamily}));return(k,N)=>{const E=Gs;return c(),U(E,{ref:"editRef",visible:t(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(g),trigger:"click"},{reference:x(()=>[m("span",{class:q(["am-cc__edit-btn am-icon-dots-vertical",t(e).referenceClass]),onClick:i},null,2)]),default:x(()=>[zt((c(),y("div",Gg,[t(e).haveEdit?(c(),y("div",{key:0,class:"am-cc__edit-item",onClick:o},[Jg,m("span",Xg,C(t(s).edit),1)])):O("",!0),t(e).haveView?(c(),y("div",{key:1,class:"am-cc__edit-item",onClick:o},[Qg,m("span",Kg,C(t(s).view),1)])):O("",!0),t(e).haveDelete?(c(),y("div",{key:2,class:"am-cc__edit-item am-delete",onClick:r},[ef,m("span",tf,C(t(s).delete),1)])):O("",!0),t(e).haveDuplicate?(c(),y("div",{key:3,class:"am-cc__edit-item am-clone",onClick:u},[af,m("span",sf,C(t(s).duplicate),1)])):O("",!0)])),[[t(ia),d]])]),_:1},8,["visible","popper-style"])}}});const nf={class:"am-caeper__heading-item am-w-20"},of={class:"am-caeper__heading-item am-w-40"},rf={class:"am-caeper__heading-item am-w-40"},cf={key:1},uf={class:"am-caeper__heading-item am-w-20"},df={key:0,class:"am-caeper__error"},mf={name:"WorkPeriods"},fr=Object.assign(mf,{props:{title:{type:String,default:""},type:{type:String,default:""},index:{type:Number,default:0},enabled:{type:Boolean,default:!1},headerVisible:{type:Boolean,default:!0},applyToAllDaysVisible:{type:Boolean,default:!0},footerVisible:{type:Boolean,default:!0},editVisible:{type:Boolean,default:!0},error:{type:String,default:""},responsiveClass:{type:String,default:""}},emits:["addPeriod"],setup(n,{emit:a}){const e=n;let s=De(),l=R("amLabels"),i=_(()=>s.getters["entities/getLocations"]),o=_(()=>s.getters["entities/getServices"]),r=_(()=>So(s)),u=_(()=>{let S=s.getters["employee/getEmployee"];switch(e.type){case"weekDayList":return S.weekDayList[e.index].periodList;case"specialDayList":return S.specialDayList[e.index].periodList}return[]}),d=_(()=>{let S=s.getters["employee/getEmployee"];return e.type==="weekDayList"?S.weekDayList[e.index].timeOutList:[]}),f=F(null),v=F(null),g=F(null);function k(){u.value.push({id:null,locationId:null,startTime:"",endTime:"",periodLocationList:[],periodServiceList:[],editing:!0}),g.value=!0,f.value=u.value.length-1,a("addPeriod")}function N(){let S=[];s.getters["employee/getEmployee"].weekDayList[e.index].periodList.forEach(P=>{S.push({id:null,locationId:null,startTime:P.startTime,endTime:P.endTime,periodLocationList:[...P.periodLocationList],periodServiceList:[...P.periodServiceList],editing:!1})}),s.getters["employee/getEmployee"].weekDayList.forEach((P,h)=>{h!==e.index&&(P.periodList=JSON.parse(JSON.stringify(S)))})}function E(){return!u.value.length||!u.value.filter(S=>S.startTime&&S.endTime).length||u.value[u.value.length-1].endTime!=="00:00"}let b=R("amColors"),A=_(()=>({"--am-c-caeper-bgr":b.value.colorMainBgr,"--am-c-caeper-text":b.value.colorMainText,"--am-c-caeper-text-op80":H(b.value.colorMainText,.8)}));return(S,P)=>zt((c(),y("div",{class:"am-caeper",style:be(t(A))},[t(e).headerVisible&&t(u).length?(c(),y("div",{key:0,class:q(["am-caeper__heading",t(e).responsiveClass])},[m("div",nf,C(t(l).time),1),m("div",of,C(t(l).service_colon),1),m("div",rf,C(t(l).location),1)],2)):O("",!0),(c(!0),y(ee,null,fe(t(u),(h,I)=>(c(),y("div",{key:I,class:"am-caeper__content"},[m("div",{class:q(["am-caeper__content-item am-w-20",t(e).responsiveClass])},C(h.startTime?h.startTime.substring(0,5):"")+" - "+C(h.endTime?h.endTime.substring(0,5):""),3),m("div",{class:q(["am-caeper__content-item am-w-40",[t(e).responsiveClass,{"am-cabinet-empty":!h.periodServiceList.length}]])},C(h.periodServiceList.filter(L=>t(r).map(T=>T.id).indexOf(L)!==-1).map(L=>t(o).find(T=>T.id===L).name).join(", ")),3),m("div",{class:q(["am-caeper__content-item am-w-40",[t(e).responsiveClass,{"am-cabinet-empty":!h.periodLocationList.length}]])},C(h.periodLocationList.map(L=>t(i).find(T=>T.id===L).name).join(", ")),3),t(e).editVisible?(c(),U(ha,{key:0,index:I,onRemove:L=>t(u).splice(I,1),onEdit:L=>we(f)?f.value=I:f=I},null,8,["index","onRemove","onEdit"])):O("",!0)]))),128)),t(d).length?(c(),y("span",cf,C(t(l).breaks),1)):O("",!0),t(e).headerVisible&&t(d).length?(c(),y("div",{key:2,class:q(["am-caeper__heading",t(e).responsiveClass])},[m("div",uf,C(t(l).time),1)],2)):O("",!0),(c(!0),y(ee,null,fe(t(d),(h,I)=>(c(),y("div",{key:I,class:"am-caeper__content"},[m("div",{class:q(["am-caeper__content-item am-w-20",t(e).responsiveClass])},C(h.startTime?h.startTime.substring(0,5):"")+" - "+C(h.endTime?h.endTime.substring(0,5):""),3),t(e).editVisible?(c(),U(ha,{key:0,index:I,onRemove:L=>t(d).splice(I,1),onEdit:L=>we(v)?v.value=I:v=I},null,8,["index","onRemove","onEdit"])):O("",!0)]))),128)),t(e).footerVisible?(c(),y("div",{key:3,class:q(["am-caeper__footer",[{"am-error":t(e).error},t(e).responsiveClass]])},[t(e).error?(c(),y("div",df,C(t(e).error),1)):O("",!0),E()?(c(),U(Se,{key:1,prefix:"plus",size:"small",onClick:P[0]||(P[0]=h=>k())},{default:x(()=>[ce(C(t(l).add_period),1)]),_:1})):O("",!0),t(e).applyToAllDaysVisible?(c(),U(Se,{key:2,size:"small",category:"secondary",type:"plain",onClick:N},{default:x(()=>[ce(C(t(l).apply_to_all_days),1)]),_:1})):O("",!0)],2)):O("",!0),$(zg,{title:t(e).title,visibility:t(f)!==null,origin:t(e).type,"period-index":t(f),"origin-index":n.index,"is-new":t(g),onClose:P[1]||(P[1]=()=>{we(f)?f.value=null:f=null,we(g)?g.value=null:g=null})},null,8,["title","visibility","origin","period-index","origin-index","is-new"]),$(Zg,{title:t(l).break_hours,visibility:t(v)!==null,origin:t(e).type,"time-out-index":t(v),"origin-index":n.index,"is-new":!1,"is-break":!0,onClose:P[2]||(P[2]=()=>{we(v)?v.value=null:v=null})},null,8,["title","visibility","origin","time-out-index","origin-index"])],4)),[[Lo,t(e).enabled]])}});const pf={class:"am-caewh__header"},gf={class:"am-caewh__header-text"},ff={class:"am-caewh__content"},hf={name:"WeekDays"},vf=Object.assign(hf,{props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=De(),s=R("amLabels"),l=_(()=>e.getters["employee/getEmployee"]),i=F([{label:s.weekday_monday,value:"monday"},{label:s.weekday_tuesday,value:"tuesday"},{label:s.weekday_wednesday,value:"wednesday"},{label:s.weekday_thursday,value:"thursday"},{label:s.weekday_friday,value:"friday"},{label:s.weekday_saturday,value:"saturday"},{label:s.weekday_sunday,value:"sunday"}]),o=R("amColors"),r=_(()=>({"--am-c-caewh-primary":o.value.colorPrimary,"--am-c-caewh-bgr":o.value.colorMainBgr,"--am-c-caewh-text":o.value.colorMainText,"--am-c-caewh-text-op03":H(o.value.colorMainText,.03),"--am-c-caewh-bgr-op03":H(o.value.colorInpBgr,.03)}));return(u,d)=>(c(),y("div",{class:"am-caewh",style:be(t(r))},[(c(!0),y(ee,null,fe(t(l).weekDayList,(f,v)=>(c(),y("div",{key:v,class:"am-caewh__item"},[m("div",pf,[m("div",gf,C(t(i)[v].label),1),$(lt,{modelValue:f.enabled,"onUpdate:modelValue":g=>f.enabled=g,size:"small","aria-label":t(i)[v].label},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),m("div",ff,[$(fr,{title:t(s).working_hours,enabled:f.enabled,index:v,type:"weekDayList","responsive-class":t(a).responsiveClass},null,8,["title","enabled","index","responsive-class"])])]))),128))],4))}});const _f={class:"am-caesd__item"},yf={class:"am-caesd__item-header"},bf={key:2},kf={key:0,class:"am-caesd__footer"},Cf={name:"SpecialDays"},xf=Object.assign(Cf,{props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=De(),s=R("amLabels"),l=R("localLanguage"),i=_(()=>e.getters["employee/getEmployee"].specialDayList),o=Qe({data:null,index:null}),r=F({range:_({get:()=>e.getters["employee/getEmployee"].specialDayList[o.index].range,set:h=>{e.getters["employee/getEmployee"].specialDayList[o.index].range=h}})}),u=F([]),d=_(()=>({range:[{required:!0,message:s.select_date_warning,trigger:["submit","change"]}]}));function f(h){i.value.splice(h,1)}function v(h){o.index=h,o.data=JSON.parse(JSON.stringify(i.value[h]))}function g(h){let I=[];i.value[h].periodList.forEach(L=>{I.push({id:null,locationId:null,startTime:L.startTime,endTime:L.endTime,periodLocationList:[...L.periodLocationList],periodServiceList:[...L.periodServiceList],editing:!1})}),e.getters["employee/getEmployee"].specialDayList.push({id:null,range:[],periodList:I}),o.index=i.value.length-1,o.data={}}let k=F("");function N(h){let I=e.getters["employee/getEmployee"].specialDayList[h].periodList;u.value[h].validate(L=>{L&&I.length>0?(k.value="",o.index=null,o.data=null):k.value="Please add period to special day"})}function E(h){Object.keys(o.data).length===0?i.value.pop():i.value[h]=o.data,o.index=null,o.data=null,k.value=""}function b(){i.value.push({id:null,range:[],periodList:[]}),o.index=i.value.length-1,o.data={}}function A(h,I){h?u.value[I]=h:u.value.splice(I,1)}let S=R("amColors"),P=_(()=>({"--am-c-caesd-bgr":S.value.colorMainBgr,"--am-c-caesd-text":S.value.colorMainText,"--am-c-caesd-text-op03":H(S.value.colorMainText,.03),"--am-c-caesd-text-op80":H(S.value.colorMainText,.8)}));return(h,I)=>{const L=yt,T=et;return c(),y("div",{class:"am-caesd",style:be(t(P))},[(c(!0),y(ee,null,fe(t(i),(w,B)=>(c(),y("div",{key:B,class:"am-caesd__content"},[m("div",_f,[m("div",yf,[t(o).index!==B?(c(),y(ee,{key:0},[m("div",null,C(w.range[0]?t(nt)(t(he)(w.range[0]).format("YYYY-MM-DD")):"")+" - "+C(w.range[1]?t(nt)(t(he)(w.range[1]).format("YYYY-MM-DD")):""),1),$(ha,{index:B,"have-duplicate":!0,onRemove:z=>f(B),onEdit:z=>v(B),onDuplicate:z=>g(B)},null,8,["index","onRemove","onEdit","onDuplicate"])],64)):O("",!0),t(o).index===B?(c(),U(T,{key:1,ref_for:!0,ref:z=>A(z,B),class:"am-caesd__form",rules:t(d),model:t(r),"label-position":"top"},{default:x(()=>[$(L,{prop:"range"},{default:x(()=>[$(Yt,{modelValue:t(r).range,"onUpdate:modelValue":I[0]||(I[0]=z=>t(r).range=z),type:"daterange",size:"small","popper-class":"am-cap__datepicker-popper","prefix-icon":Ge({components:{IconComponent:We},template:"<IconComponent icon='calendar'/>"}),format:t(jt)(),placeholder:t(s).select_date,lang:t(l)},null,8,["modelValue","prefix-icon","format","placeholder","lang"])]),_:1})]),_:2},1032,["rules","model"])):O("",!0),t(k)?(c(),y("div",bf)):O("",!0)]),m("div",{class:q(["am-caesd__item-inner",{"am-editable":t(o).index===B}])},[$(fr,{title:t(s).special_days,enabled:!0,index:B,type:"specialDayList","apply-to-all-days-visible":!1,"header-visible":t(o).index===B,"edit-visible":t(o).index===B,"footer-visible":t(o).index===B,error:t(o).index===B?t(k):"","responsive-class":t(a).responsiveClass,onAddPeriod:I[1]||(I[1]=()=>{we(k)?k.value="":k=""})},null,8,["title","index","header-visible","edit-visible","footer-visible","error","responsive-class"])],2)]),t(o).index===B?(c(),y("div",kf,[$(Se,{category:"secondary",type:"plain",size:"small",onClick:z=>E(B)},{default:x(()=>[ce(C(t(s).cancel),1)]),_:2},1032,["onClick"]),$(Se,{size:"small",onClick:z=>N(B)},{default:x(()=>[ce(C(t(s).save),1)]),_:2},1032,["onClick"])])):O("",!0)]))),128)),t(i).length===0?(c(),U(Ia,{key:0,heading:t(s).no_special_days_yet},null,8,["heading"])):O("",!0),t(o).index===null?(c(),y("div",{key:1,class:q(t(i).length===0?"add-btn":"")},[$(Se,{size:"small",onClick:I[2]||(I[2]=w=>b())},{default:x(()=>[ce(C(t(s).add_special_day),1)]),_:1})],2)):O("",!0)],4)}}});const wf={key:0,class:"am-caedo__title_emp"},Tf={class:"am-caedo__heading-item am-w-50"},Sf={class:"am-caedo__heading-item am-w-30"},Ef={class:"am-caedo__heading-item am-w-20"},Lf={class:"am-caedo__content-item"},Af={key:0,class:"am-caedo__wrapper"},If={class:"am-caedo__footer"},$f={key:4,class:"am-caedo__title_global"},Pf={class:"am-caedo__heading-item am-w-50"},Df={class:"am-caedo__heading-item am-w-30"},Nf={class:"am-caedo__heading-item am-w-20"},Of={class:"am-caedo__content-item"},Mf={name:"DaysOff"},Ff=Object.assign(Mf,{props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=De(),s=R("amLabels"),l=R("localLanguage");const i=R("settings");let o=_(()=>e.getters["employee/getEmployee"].dayOffList),r=F([]),u=Qe({data:null,index:null}),d=F({range:_({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].range,set:I=>{e.getters["employee/getEmployee"].dayOffList[u.index].range=I}}),name:_({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].name,set:I=>{e.getters["employee/getEmployee"].dayOffList[u.index].name=I}}),repeat:_({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].repeat,set:I=>{e.getters["employee/getEmployee"].dayOffList[u.index].repeat=I}})}),f=F([]),v=_(()=>({range:[{required:!0,message:s.select_date_warning,trigger:["submit","change"]}],name:[{required:!0,message:s.days_off_name_warning,trigger:["submit","change"]}]}));function g(I){o.value.splice(I,1)}function k(I){u.index=I,u.data=JSON.parse(JSON.stringify(o.value[I]))}function N(I){f.value[I].validate(L=>{L&&(u.index=null,u.data=null)})}function E(I){Object.keys(u.data).length===0?o.value.pop():o.value[I]=u.data,u.index=null,u.data=null}function b(){o.value.push({id:null,name:"",repeat:!1,range:[]}),u.index=o.value.length-1,u.data={}}function A(I){let L=I.range[0]?nt(he(I.range[0]).format("YYYY-MM-DD")):"",T=I.range[1]?nt(he(I.range[1]).format("YYYY-MM-DD")):"";return`${L} - ${T}`}function S(I,L){I?f.value[L]=I:f.value.splice(L,1)}Je(()=>{r.value=i.daysOff.map(I=>new Object({range:[I.startDate,I.endDate],name:I.name,repeat:I.repeat}))});let P=R("amColors"),h=_(()=>({"--am-c-caedo-bgr":P.value.colorMainBgr,"--am-c-caedo-text":P.value.colorMainText,"--am-c-caedo-text-op80":H(P.value.colorMainText,.8),"--am-c-caedo-text-op03":H(P.value.colorMainText,.03)}));return(I,L)=>{const T=yt,w=et;return c(),y("div",{class:"am-caedo",style:be(t(h))},[t(r).length?(c(),y("span",wf,C(t(s).employee_days_off),1)):O("",!0),t(o).length||t(r).length?(c(),y("div",{key:1,class:q(["am-caedo__heading",t(a).responsiveClass])},[m("div",Tf,C(t(s).date),1),m("div",Sf,C(t(s).name),1),m("div",Ef,C(t(s).days_off_repeat_yearly),1)],2)):O("",!0),(c(!0),y(ee,null,fe(t(o),(B,z)=>(c(),y("div",{key:z,class:"am-caedo__content"},[m("div",Lf,[m("div",{class:q(["am-caedo__content-item__inner am-w-50",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},C(t(s).date),3),ce(" "+C(A(B)),1)],2),m("div",{class:q(["am-caedo__content-item__inner am-w-30",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},C(t(s).name),3),ce(" "+C(B.name),1)],2),m("div",{class:q(["am-caedo__content-item__inner am-w-20",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},C(t(s).days_off_repeat_yearly),3),ce(" "+C(B.repeat?t(s).yes:t(s).no),1)],2),t(u).index===null?(c(),U(ha,{key:0,index:z,onRemove:D=>g(z),onEdit:D=>k(z)},null,8,["index","onRemove","onEdit"])):O("",!0)]),t(u).index===z?(c(),y("div",Af,[$(w,{ref_for:!0,ref:D=>S(D,z),class:"am-caedo__form",rules:t(v),model:t(d),"label-position":"top"},{default:x(()=>[$(T,{label:`${t(s).date}:`,prop:"range"},{default:x(()=>[$(Yt,{modelValue:t(d).range,"onUpdate:modelValue":L[0]||(L[0]=D=>t(d).range=D),type:"daterange","popper-class":"am-cap__datepicker-popper",format:t(jt)(),placeholder:t(s).select_date,lang:t(l)},null,8,["modelValue","format","placeholder","lang"])]),_:1},8,["label"]),$(T,{label:`${t(s).name}:`,prop:"name"},{default:x(()=>[$(it,{modelValue:t(d).name,"onUpdate:modelValue":L[1]||(L[1]=D=>t(d).name=D)},null,8,["modelValue"])]),_:1},8,["label"]),$(T,{prop:"repeat"},{default:x(()=>[$(mt,{modelValue:t(d).repeat,"onUpdate:modelValue":L[2]||(L[2]=D=>t(d).repeat=D),label:t(s).days_off_repeat_yearly},null,8,["modelValue","label"])]),_:1})]),_:2},1032,["rules","model"]),m("div",If,[$(Se,{category:"secondary",size:"small",type:"plain",onClick:D=>E(z)},{default:x(()=>[ce(C(t(s).cancel),1)]),_:2},1032,["onClick"]),$(Se,{size:"small",onClick:D=>N(z)},{default:x(()=>[ce(C(t(s).save),1)]),_:2},1032,["onClick"])])])):O("",!0)]))),128)),t(o).length===0&&t(r).length===0?(c(),U(Ia,{key:2,heading:t(s).no_days_off_yet},null,8,["heading"])):O("",!0),t(u).index===null?(c(),y("div",{key:3,class:q(t(o).length===0&&t(r).length===0?"add-btn":"")},[$(Se,{size:"small",onClick:L[3]||(L[3]=B=>b())},{default:x(()=>[ce(C(t(s).add_day_off),1)]),_:1})],2)):O("",!0),t(r).length?(c(),y("span",$f,C(t(s).company_days_off),1)):O("",!0),t(r).length?(c(),y("div",{key:5,class:q(["am-caedo__heading",t(a).responsiveClass])},[m("div",Pf,C(t(s).date),1),m("div",Df,C(t(s).name),1),m("div",Nf,C(t(s).days_off_repeat_yearly),1)],2)):O("",!0),(c(!0),y(ee,null,fe(t(r),(B,z)=>(c(),y("div",{key:z,class:"am-caedo__content"},[m("div",Of,[m("div",{class:q(["am-caedo__content-item__inner am-w-50",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},C(t(s).date),3),ce(" "+C(A(B)),1)],2),m("div",{class:q(["am-caedo__content-item__inner am-w-30",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},C(t(s).name),3),ce(" "+C(B.name),1)],2),m("div",{class:q(["am-caedo__content-item__inner am-w-20",t(a).responsiveClass])},[m("div",{class:q(["am-caedo__content-item__label",t(a).responsiveClass])},C(t(s).days_off_repeat_yearly),3),ce(" "+C(B.repeat?t(s).yes:t(s).no),1)],2)])]))),128))],4)}}});const Vf={class:"am-cc__edit"},Bf={class:"am-cc__edit-text"},Rf={class:"am-cc__edit-text"},qf={class:"am-cc__edit"},Uf={class:"am-cc__edit-text"},zf={class:"am-cc__edit-text"},jf={class:"am-cc__edit"},Yf={class:"am-cc__edit-text"},Wf={class:"am-cc__edit-text"},Hf={name:"StripeConnect"},Zf=Object.assign(Hf,{setup(n){let a=De(),e=R("amLabels"),s=_(()=>a.getters["auth/getStripeProvider"]),l=F(!1);function i(k){k.stopPropagation(),l.value=!l.value}function o(k){fu(a,k),d()}function r(){vu(a),d()}function u(){hu(a),d()}function d(){l.value=!1}let f=R("amFonts"),v=R("amColors"),g=_(()=>({"--am-c-cc-error":v.value.colorError,"--am-c-cc-error-op15":H(v.value.colorError,.15),"--am-c-cc-bgr":v.value.colorMainBgr,"--am-c-cc-text":v.value.colorMainText,"--am-c-cc-text-op10":H(v.value.colorMainText,.1),"--am-c-cc-text-op15":H(v.value.colorMainText,.15),"--am-font-family":f.value.fontFamily}));return(k,N)=>{const E=Gs;return t(s)&&t(s).id&&t(s).completed?(c(),U(E,{key:0,ref:"stripeConnectRef",visible:t(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(g),trigger:"click"},{reference:x(()=>[$(Se,{onClick:i},{default:x(()=>[ce(C(t(e).stripe_connect)+" "+C("("+(t(s).email?t(s).email:t(s).id)+")"),1)]),_:1})]),default:x(()=>[zt((c(),y("div",Vf,[m("div",{class:"am-cc__edit-item",onClick:N[0]||(N[0]=b=>r())},[m("span",Bf,C(t(e).stripe_preview),1)]),m("div",{class:"am-cc__edit-item",onClick:N[1]||(N[1]=b=>u())},[m("span",Rf,C(t(e).disconnect),1)])])),[[t(ia),d]])]),_:1},8,["visible","popper-style"])):t(s)&&t(s).id&&!t(s).completed?(c(),U(E,{key:1,ref:"stripeConnectRef",visible:t(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(g),trigger:"click"},{reference:x(()=>[$(Se,{onClick:i},{default:x(()=>[ce(C(t(e).stripe_connect)+" "+C("("+(t(s).email?t(s).email:t(s).id)+")"),1)]),_:1})]),default:x(()=>[zt((c(),y("div",qf,[m("div",{class:"am-cc__edit-item",onClick:N[2]||(N[2]=b=>o(t(s).type))},[m("span",Uf,C(t(e).stripe_onboard),1)]),m("div",{class:"am-cc__edit-item",onClick:N[3]||(N[3]=b=>u())},[m("span",zf,C(t(e).disconnect),1)])])),[[t(ia),d]])]),_:1},8,["visible","popper-style"])):(c(),U(E,{key:2,ref:"stripeConnectRef",visible:t(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(g),trigger:"click"},{reference:x(()=>[$(Se,{onClick:i},{default:x(()=>[ce(C(t(e).stripe_connect),1)]),_:1})]),default:x(()=>[zt((c(),y("div",jf,[m("div",{class:"am-cc__edit-item",onClick:N[4]||(N[4]=b=>o("standard"))},[m("span",Yf,C(t(e).stripe_account_standard),1)]),m("div",{class:"am-cc__edit-item",onClick:N[5]||(N[5]=b=>o("express"))},[m("span",Wf,C(t(e).stripe_account_express),1)])])),[[t(ia),d]])]),_:1},8,["visible","popper-style"]))}}});const Gf=["innerHTML"],Jf={key:2,class:"am-caedo__apple"},Xf={class:"am-caedo__apple__connect"},Qf={props:{responsiveClass:{type:String,default:""}},setup(n){const a=n;let e=F(""),s=F("error"),l=F(!1);function i(){l.value=!1,e.value=""}const o=De(),r=R("baseUrls"),u=R("settings");let d=R("amLabels"),f=_(()=>o.getters["auth/getGoogleLoading"]||o.getters["auth/getOutlookLoading"]||o.getters["auth/getAppleLoading"]||o.getters["auth/getStripeLoading"]||o.getters["auth/getZoomLoading"]),v=_(()=>{let T=o.getters["auth/getZoomUsers"];return T.length?T.map(w=>({value:w.id,label:`${w.first_name} ${w.last_name} (${w.email})`})):[]}),g=_(()=>{let T=o.getters["auth/getGoogleCalendars"];return T.length?T.map(w=>({value:w.calendarId,label:w.summary})):[]}),k=_(()=>{let T=o.getters["auth/getOutlookCalendars"];return T.length?T.map(w=>({value:w.id,label:w.name})):[]}),N=_(()=>{let T=o.getters["auth/getAppleCalendars"];return T.length?T.map(w=>({value:w.id,label:w.name})):[]}),E=F(null),b=F({iCloudId:_({get:()=>o.getters["employee/getEmployeeAppleCalendarICloudId"],set:T=>{o.commit("employee/setEmployeeAppleCalendarICloudId",T||"")}}),appSpecificPassword:_({get:()=>o.getters["employee/getEmployeeAppleCalendarAppSpecificPassword"],set:T=>{o.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",T||null)}})}),A=_(()=>o.getters["employee/getGoogleToken"]?d.google_sign_out:d.google_sign_in),S=_(()=>o.getters["employee/getOutlookToken"]?d.outlook_sign_out:d.outlook_sign_in),P=F({googleId:_({get:()=>o.getters["employee/getGoogleCalendarId"],set:T=>{o.commit("employee/setGoogleCalendarId",T||"")}}),googleBtn:"",outlookId:_({get:()=>o.getters["employee/getOutlookCalendarId"],set:T=>{o.commit("employee/setOutlookCalendarId",T||"")}}),outlookBtn:"",zoomUserId:_({get:()=>o.getters["employee/getZoomUserId"],set:T=>{o.commit("employee/setZoomUserId",T||"")}}),appleId:_({get:()=>o.getters["employee/getAppleCalendarId"],set:T=>{o.commit("employee/setAppleCalendarId",T||"")}})}),h=F({googleId:{template:Ye.select,props:{itemName:"googleId",label:d.google_calendar,placeholder:"",class:_(()=>`am-caepif__item ${a.responsiveClass}`),disabled:_(()=>!o.getters["employee/getGoogleToken"]),clearable:!1,options:g.value,loading:_(()=>o.getters["auth/getGoogleLoading"]),loadingIcon:"loading"}},googleBtn:{template:Ge(Se),props:{class:_(()=>`am-caepif__item am-google-calendar-button ${a.responsiveClass}`),category:_(()=>"primary")},slots:{default:_(()=>`<img src="${r.wpAmeliaPluginURL}/v3/src/assets/img/cabinet/google-button.svg" alt="Google" />${A.value}`)},handlers:{click:()=>{o.getters["employee/getGoogleToken"]?cu(o):ru(o)}}},outlookId:{template:Ye.select,props:{itemName:"outlookId",label:d.outlook_calendar,placeholder:"",class:_(()=>`am-caepif__item ${a.responsiveClass}`),disabled:_(()=>!o.getters["employee/getOutlookToken"]),clearable:!1,options:k.value,loading:_(()=>o.getters["auth/getOutlookLoading"]),loadingIcon:"loading"}},outlookBtn:{template:Ge(Se),props:{class:_(()=>`am-caepif__item am-outlook-button ${a.responsiveClass}`),category:_(()=>"primary")},slots:{default:_(()=>`<div class="am-outlook-img"><img src="${r.wpAmeliaPluginURL}/v3/src/assets/img/cabinet/outlook-calendar.png" alt="Outlook"/></div>${S.value}`)},handlers:{click:()=>{o.getters["employee/getOutlookToken"]?mu(o):du(o)}}},zoomUserId:{template:Ye.select,props:{itemName:"zoomUserId",label:d.zoom_user,placeholder:d.zoom_user_placeholder,class:_(()=>`am-caepif__item ${a.responsiveClass}`),options:v.value}},appleId:{template:Ye.select,props:{itemName:"appleId",label:d.apple_calendar,placeholder:d.apple_calendar_placeholder,class:_(()=>`am-caepif__item ${a.responsiveClass}`),disabled:!1,clearable:_(()=>!xa.value),options:_(()=>N.value),loading:_(()=>o.getters["auth/getAppleLoading"]),loadingText:"Loading..."}}});Je(()=>{u.appleCalendar&&E.value&&(E.value.contentVisibility=xa.value)}),Zs(()=>{u.zoom.enabled||delete h.value.zoomUserId,u.googleCalendar.enabled||(delete h.value.googleId,delete h.value.googleBtn),u.outlookCalendar.enabled||(delete h.value.outlookId,delete h.value.outlookBtn),u.appleCalendar||delete h.value.appleId});function I(T){const w={iCloudId:T.getters["employee/getEmployeeAppleCalendarICloudId"],appSpecificPassword:T.getters["employee/getEmployeeAppleCalendarAppSpecificPassword"]};Ne.post("/apple/connect/"+T.getters["employee/getId"],{employeeAppleCalendar:w}).then(()=>{T.commit("employee/setEmployeeAppleCalendarICloudId",w.iCloudId),T.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",w.appSpecificPassword),Wn(T)}).catch(B=>{l.value=!0,e.value=B.response.data.message,s.value="error"}).finally(()=>{l.value=!0})}function L(T){T.commit("auth/setAppleLoading",!0),Ne.post("/apple/disconnect-employee/"+T.getters["employee/getId"]).then(()=>{T.commit("employee/setEmployeeAppleCalendarICloudId",null),T.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",null),xa.value=!1,Wn(T),N.value=T.getters["auth/getAppleCalendars"]}).catch(w=>{console.log(w)}).finally(()=>{T.commit("auth/setAppleLoading",!1)})}return(T,w)=>{const B=yt,z=et;return t(f)?(c(),U(Wt,{key:1})):(c(),U(z,{key:0,ref:"employeeFormRef",model:t(P),"label-position":"top",class:q(["am-caedo",a.responsiveClass])},{default:x(()=>[t(u).payments.stripe.enabled&&t(u).payments.stripe.connect.enabled?(c(),U(Zf,{key:0})):O("",!0),m("div",{class:q(["am-caepif__block",a.responsiveClass])},[(c(!0),y(ee,null,fe(t(h),(D,G)=>(c(),U(pt(D.template),Lt({key:G,ref_for:!0,ref:"customerCollectorRef",modelValue:t(P)[G],"onUpdate:modelValue":se=>t(P)[G]=se},D.props,ui(D.handlers?D.handlers:{})),{default:x(()=>[D.slots&&D.slots.default?(c(),y("div",{key:0,innerHTML:D.slots.default},null,8,Gf)):O("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue"]))),128))],2),t(l)?(c(),U(_t,{key:1,type:"error","show-border":!0,"close-after":5e3,onClose:i,onTriggerClose:i},{default:x(()=>[ce(C(t(e)),1)]),_:1})):O("",!0),t(u).appleCalendar?(c(),y("div",Jf,[$(Io,null,{default:x(()=>[$(Ao,{ref_key:"appleVisibility",ref:E,side:!0,delay:500},{heading:x(()=>[ce(C(t(d).apple_calendar_personal),1)]),default:x(()=>[m("div",Xf,[$(B,{label:t(d).apple_icloud_id,class:"am-caedo__apple__connect__item"},{default:x(()=>[$(it,{modelValue:t(b).iCloudId,"onUpdate:modelValue":w[0]||(w[0]=D=>t(b).iCloudId=D),disabled:t(xa),placeholder:t(d).apple_icloud_id},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),$(B,{label:t(d).apple_app_specific_password,class:"am-caedo__apple__connect__item"},{default:x(()=>[$(it,{modelValue:t(b).appSpecificPassword,"onUpdate:modelValue":w[1]||(w[1]=D=>t(b).appSpecificPassword=D),type:"password","show-password":!0,disabled:t(xa),placeholder:t(d).apple_app_specific_password},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),$(Se,{onClick:w[2]||(w[2]=D=>t(xa)?L(t(o)):I(t(o)))},{default:x(()=>[ce(C(t(xa)?t(d).apple_disconnect:t(d).apple_connect),1)]),_:1})])]),_:1},512)]),_:1})])):O("",!0)]),_:1},8,["model","class"]))}}};const Kf={props:{tabActive:{type:String,required:!0},passwordActive:{type:Boolean,default:!1}},emits:["changePassword","savePassword","saveChanges"],setup(n,{emit:a}){const e=n;let s=R("amLabels");function l(){e.tabActive==="password"?a("savePassword"):a("saveChanges")}let i=R("amColors"),o=_(()=>({"--am-c-caepf-text-op15":H(i.value.colorMainText,.15)}));return(r,u)=>(c(),y("div",{class:q(["am-caepf",{"am-single-btn":e.tabActive!=="details"||e.passwordActive}]),style:be(t(o))},[e.tabActive==="details"&&!e.passwordActive?(c(),U(Se,{key:0,size:"medium",category:"secondary",type:"plain",onClick:u[0]||(u[0]=d=>a("changePassword"))},{default:x(()=>[ce(C(t(s).change_password),1)]),_:1})):O("",!0),$(Se,{size:"medium",onClick:l},{default:x(()=>[ce(C(e.tabActive!=="password"?t(s).save:t(s).change_password),1)]),_:1})],6))}},eh={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:a}){const e=n,s=De();let l=R("amLabels"),i=F(null),o=F({newPass:_({get:()=>s.getters["auth/getNewPassword"],set:d=>{s.commit("auth/setNewPassword",d||"")}}),confirmPass:_({get:()=>s.getters["auth/getConfirmPassword"],set:d=>{s.commit("auth/setConfirmPassword",d||"")}})}),r=F({newPass:{template:Ye.text,props:{itemName:"newPass",itemType:"password",showPassword:!0,label:l.new_password_colon,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${e.responsiveClass}`)}},confirmPass:{template:Ye.text,props:{itemName:"confirmPass",itemType:"password",showPassword:!0,label:l.new_password_colon_retype,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${e.responsiveClass}`)}}}),u=F({newPass:[{required:!0,message:l.new_password_required,trigger:"submit"},{min:4,message:l.new_password_length,trigger:"submit"}],confirmPass:[{required:!0,message:l.new_password_required,trigger:"submit"},{min:4,message:l.new_password_length,trigger:"submit"},{validator:()=>s.getters["auth/getNewPassword"]===s.getters["auth/getConfirmPassword"],message:l.passwords_not_match,trigger:"submit"}]});return a({passFormRef:i}),(d,f)=>{const v=et;return c(),U(v,{ref_key:"passFormRef",ref:i,model:t(o),rules:t(u),"label-position":"top",class:q(["am-capi__form",n.responsiveClass])},{default:x(()=>[(c(!0),y(ee,null,fe(t(r),(g,k)=>(c(),U(pt(g.template),Lt({key:g.props.itemName,ref_for:!0,ref:"customerPassCollectorRef",modelValue:t(o)[k],"onUpdate:modelValue":N=>t(o)[k]=N},g.props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"])}}};const th=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),ah={name:"CabinetEmployeeProfile"},sh=Object.assign(ah,{setup(n){let a=De();const e=R("settings");let s=R("amLabels"),l=F(null);const{width:i}=ja(l);let o=_(()=>st(i.value));Be("pageWidth",i);let r=_(()=>a.getters["entities/getReady"]);const u=F("details");let d=F(""),f=F("success"),v=F(!1);function g(){v.value=!1}function k(){v.value=!1,d.value=""}let N=F(null),E=_(()=>a.getters["employee/getEmployee"]),b=_(()=>a.getters["auth/getGoogleLoading"]||a.getters["auth/getOutlookLoading"]||a.getters["auth/getAppleLoading"]||a.getters["auth/getStripeLoading"]||a.getters["auth/getZoomLoading"]),A=F(!1),S=R("timeZone");function P(){N.value.employeeFormRef.validate(z=>{!z||(A.value=!0,Ne.post("/users/providers/"+E.value.id,Wr(a,S.value),Object.assign(ze(a),{params:{source:"cabinet-provider"}})).then(()=>{d.value=s.profile_data_success,f.value="success"}).catch(D=>{d.value=D.response.data.message,f.value="error"}).finally(()=>{v.value=!0,A.value=!1}))})}let h=F(null),I=F(!1);function L(){I.value=!0,u.value="password"}function T(){h.value.passFormRef.validate(z=>{if(z){let D=a.getters["auth/getProfile"];A.value=!0,Ne.post("/users/providers/"+D.id,{password:a.getters["auth/getNewPassword"]},ze(a)).then(()=>{d.value=s.password_success,I.value=!1,u.value="details",a.commit("auth/setNewPassword",""),a.commit("auth/setConfirmPassword","")}).catch(()=>{v.value=!0}).finally(()=>{A.value=!1})}})}let w=R("amColors"),B=_(()=>({"--am-c-caep-primary":w.value.colorPrimary,"--am-c-caep-text":w.value.colorMainText,"--am-c-caep-text-op10":H(w.value.colorMainText,.1)}));return(z,D)=>{const G=va,se=_a;return c(),y("div",{ref_key:"pageContainer",ref:l,class:"am-caep",style:be(t(B))},[t(r)&&!t(A)&&!t(b)?(c(),y("div",{key:0,class:q(["am-caep__inner",t(o)])},[t(v)?(c(),U(_t,{key:0,type:t(f),"show-border":!0,"close-after":5e3,"custom-class":"am-capi__alert",onClose:k,onTriggerClose:k},{title:x(()=>[th,ce(" "+C(t(d)),1)]),_:1},8,["type"])):O("",!0),$(se,{modelValue:u.value,"onUpdate:modelValue":D[0]||(D[0]=j=>u.value=j)},{default:x(()=>[$(G,{label:t(s).details,name:"details",onClick:g},{default:x(()=>[$(dg,{ref_key:"detailsRef",ref:N,"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"]),t(e).roles.allowConfigureServices?(c(),U(G,{key:0,label:t(s).heading_services,name:"services"},{default:x(()=>[$(Vg,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):O("",!0),t(e).roles.allowConfigureSchedule?(c(),U(G,{key:1,label:t(s).working_hours,name:"workingHours"},{default:x(()=>[$(vf,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):O("",!0),t(e).roles.allowConfigureSpecialDays?(c(),U(G,{key:2,label:t(s).special_days,name:"specialDays"},{default:x(()=>[$(xf,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):O("",!0),t(e).roles.allowConfigureDaysOff?(c(),U(G,{key:3,label:t(s).days_off,name:"daysOff"},{default:x(()=>[$(Ff,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):O("",!0),t(I)?(c(),U(G,{key:4,label:t(s).password,name:"password"},{default:x(()=>[t(A)?(c(),U(wl,{key:1,"item-direction":"column",count:2})):(c(),U(eh,{key:0,ref_key:"changePassRef",ref:h},null,512))]),_:1},8,["label"])):O("",!0),t(e).zoom.enabled||t(e).googleCalendar.enabled||t(e).outlookCalendar.enabled||t(e).appleCalendar||t(e).payments.stripe.enabled&&t(e).payments.stripe.connect.enabled?(c(),U(G,{key:5,label:t(s).integrations_settings,name:"integrations"},{default:x(()=>[$(Qf,{"responsive-class":t(o)},null,8,["responsive-class"])]),_:1},8,["label"])):O("",!0)]),_:1},8,["modelValue"]),$(Kf,{"tab-active":u.value,"password-active":t(I),onChangePassword:L,onSavePassword:T,onSaveChanges:P},null,8,["tab-active","password-active"])],2)):(c(),U(Wt,{key:1}))],4)}}});function hr(n,a){Ne.get("/users/customers",{params:Js(n)}).then(e=>{a(e.data.data.users)}).catch(()=>{a([])})}function Hs(n,a="",e={},s=()=>{}){n.commit("customerInfo/setLoading",!0),setTimeout(()=>{hr(Object.assign({search:a,page:1,limit:at.general.customersFilterLimit,skipCount:1},e),l=>{n.commit("customerInfo/setCustomers",l),n.commit("customerInfo/setLoading",!1),s()})},500)}function Ii(n){n.getters["customerInfo/getCustomers"].length||Hs(n)}const lh={key:0,class:"am-capf__zone"},nh={class:"am-capf__menu"},ih=m("span",{class:"am-icon-filter"},null,-1),oh={key:0},rh={key:0,class:"am-capf__list"},ch={name:"CabinetFilters"},$i=Object.assign(ch,{props:{paramList:{type:[Object,Array],default:()=>[]},stepKey:{type:String,default:""},responsiveClass:{type:String,default:""},empty:{type:Boolean,default:!1}},emits:["changeFilters","addAppointment"],setup(n,{emit:a}){const e=n;let s=De(),l=_(()=>s.getters["entities/getReady"]),i=_(()=>s.getters.getLoading),o=F({customers:!1,events:!1}),r=_(()=>e.stepKey==="packages"?"packagesList":e.stepKey);const u=R("shortcodeData"),d=R("settings");let f=R("amCustomize");const v=R("labels"),g=R("localLanguage");let k=_(()=>d.general.usedLanguages.includes(g.value)),N=_(()=>{let te=Qe({...v});if(e.stepKey){let oe=f.value[r.value].translations;oe&&Object.keys(oe).forEach(ie=>{oe[ie][g.value]&&k.value?te[ie]=oe[ie][g.value]:oe[ie].default&&(te[ie]=oe[ie].default)})}return te});function E(te){return te==="customers"?"user":te==="services"?"service":te==="providers"?"employee":te==="locations"?"locations":te==="packages"?"shipment":te==="events"?"star-outline":""}function b(){a("changeFilters")}let A=R("containerWidth"),S={components:{IconComponent:We},template:'<IconComponent icon="filter"/>'},P=F(!1),h=F({dates:_({get:()=>s.getters["cabinetFilters/getDates"],set:te=>{Hr(te[0],te[1]),s.commit("cabinetFilters/setDates",te),a("changeFilters")}}),customers:_({get:()=>s.getters["cabinetFilters/getCustomers"],set:te=>{s.commit("cabinetFilters/setCustomers",te||[])}}),services:_({get:()=>s.getters["cabinetFilters/getServices"],set:te=>{s.commit("cabinetFilters/setServices",te)}}),providers:_({get:()=>s.getters["cabinetFilters/getProviders"],set:te=>{s.commit("cabinetFilters/setProviders",te)}}),locations:_({get:()=>s.getters["cabinetFilters/getLocations"],set:te=>{s.commit("cabinetFilters/setLocations",te)}}),packages:_({get:()=>s.getters["cabinetFilters/getPackages"],set:te=>{s.commit("cabinetFilters/setPackages",te)}}),events:_({get:()=>s.getters["cabinetFilters/getEvents"],set:te=>{s.commit("cabinetFilters/setEvents",te||[])}})}),I=_(()=>e.stepKey==="events"?s.getters["cabinetFilters/getEventFiltersOption"](u.value.cabinetType):e.stepKey==="packages"?s.getters["cabinetFilters/getPackageFilterOptions"]:s.getters["cabinetFilters/getAppointmentFilterOptions"](u.value.cabinetType)),L=_(()=>{let te=0;return Object.keys(I.value).forEach(oe=>{f.value[r.value].options[`${oe}Filter`].visibility&&(oe==="customers"||oe==="events"||I.value[oe].length>0)&&te++}),te});function T(te,oe){switch(te){case"customers":B(oe);break;case"events":z(oe);break}}function w(){u.value.cabinetType==="employee"&&B("",s.getters["auth/getPreloadedCustomers"])}function B(te="",oe=[]){if(o.value.customers=!0,oe.length){s.dispatch("cabinetFilters/injectCustomerOptions",oe),o.value.customers=!1;return}setTimeout(()=>{hr({search:te,page:1,limit:at.general.customersFilterLimit,skipCount:1},ie=>{s.dispatch("cabinetFilters/injectCustomerOptions",ie),s.getters["auth/getPreloadedCustomers"].length===0&&s.commit("auth/setPreloadedCustomers",ie),o.value.customers=!1})},500)}function z(te="",oe=[]){if(o.value.events=!0,oe.length){s.dispatch("cabinetFilters/injectEventsOptions",oe),o.value.events=!1;return}setTimeout(()=>{cc({dates:[he().format("YYYY-MM-DD")],timeZone:s.getters["cabinet/getTimeZone"],group:!0,page:1,limit:d.general.itemsPerPageBackEnd,search:te},ie=>{s.dispatch("cabinetFilters/injectEventsOptions",ie),o.value.events=!1})},500)}let D=_(()=>f.value[r.value].options),G=_(()=>e.stepKey==="appointments"?u.value.cabinetType==="employee"?D.value.servicesFilter.visibility||D.value.customersFilter.visibility||D.value.locationsFilter.visibility:D.value.servicesFilter.visibility||D.value.providersFilter.visibility||D.value.locationsFilter.visibility:e.stepKey==="events"?u.value.cabinetType==="employee"?D.value.eventsFilter.visibility||D.value.customersFilter.visibility||D.value.locationsFilter.visibility:D.value.eventsFilter.visibility||D.value.providersFilter.visibility||D.value.locationsFilter.visibility:D.value.packagesFilter.visibility||D.value.servicesFilter.visibility||D.value.providersFilter.visibility||D.value.locationsFilter.visibility),se=_(()=>e.stepKey==="appointments"?u.value.cabinetType==="employee"?!!(I.value.services.length||I.value.customers.length||I.value.locations.length):!!(I.value.services.length||I.value.providers.length||I.value.locations.length):e.stepKey==="events"?u.value.cabinetType==="employee"?!!(I.value.events.length||I.value.customers.length||I.value.locations.length):!!(I.value.events.length||I.value.providers.length||I.value.locations.length):!!(I.value.packages.length||I.value.services.length||I.value.providers.length||I.value.locations.length));Je(()=>{w()});let j=R("amColors"),ne=_(()=>({"--am-c-capf-heading-text":j.value.colorMainText,"--am-c-capf-text":j.value.colorInpText,"--am-c-capf-text-op10":H(j.value.colorInpText,.1),"--am-c-select-border":j.value.colorInpBorder,"--am-c-select-bgr":j.value.colorInpBgr}));return(te,oe)=>!t(i)&&t(l)?(c(),y("div",{key:0,class:"am-capf",style:be(t(ne))},[t(A)<=480&&t(D).timeZone.visibility&&t(e).stepKey!=="packages"?(c(),y("div",lh,[$(Yn,{size:"small"})])):O("",!0),m("div",nh,[t(A)<=480&&t(D).timeZone.visibility&&t(e).stepKey==="packages"?(c(),U(Yn,{key:0,size:"small"})):O("",!0),t(e).stepKey!=="packages"?(c(),U(Yt,{key:1,modelValue:t(h).dates,"onUpdate:modelValue":oe[0]||(oe[0]=ie=>t(h).dates=ie),type:"daterange",editable:!1,size:"small",clearable:!1,format:t(jt)(),style:be(t(ne)),lang:t(g),class:q(["am-capf__menu-datepicker",t(e).responsiveClass]),"popper-class":"am-capf__menu-datepicker-popper","start-placeholder":t(N).start_date,"end-placeholder":t(N).end_date},null,8,["modelValue","format","style","lang","class","start-placeholder","end-placeholder"])):O("",!0),!t(e).empty&&t(G)&&t(se)?(c(),U(Se,{key:2,icon:t(S),"icon-only":t(A)<=700,"custom-class":"am-capf__menu-btn",size:"small",category:"primary","aria-label":t(N).filters,type:t(D).filterBtn?t(D).filterBtn.buttonType:"filled",onClick:oe[1]||(oe[1]=ie=>we(P)?P.value=!t(P):P=!t(P))},{default:x(()=>[ih,t(A)>700?(c(),y("span",oh,C(t(N).filters),1)):O("",!0)]),_:1},8,["icon","icon-only","aria-label","type"])):O("",!0)]),$(ga,{name:"am-slide-fade"},{default:x(()=>[t(P)&&!t(e).empty?(c(),y("div",rh,[(c(!0),y(ee,null,fe(Object.keys(t(I)),ie=>(c(),y(ee,{key:ie},[(t(I)[ie].length>0||ie==="customers"||ie==="events")&&t(f)[t(r)].options[`${ie}Filter`].visibility?(c(),y("span",{key:0,class:q(["am-capf__list-item",[{"am-selected":t(h)[ie].length>0},`am-capf__list-item-${t(L)}`,t(e).responsiveClass]])},[$(He,{id:`am-select-${ie}`,modelValue:t(h)[ie],"onUpdate:modelValue":K=>t(h)[ie]=K,multiple:ie!=="customers"&&ie!=="events",loading:ie!=="customers"&&ie!=="events"?!1:t(o)[ie],remote:"",clearable:"",filterable:ie==="customers"||ie==="events",placeholder:t(N)[ie+(ie==="customers"?"":"_dropdown")],"prefix-icon":E(ie),"collapse-tags":!0,size:"small","popper-class":"am-filter-select-popper","remote-method":K=>{T(ie,K)},onChange:b,onClear:w},{default:x(()=>[(c(!0),y(ee,null,fe(t(I)[ie],K=>(c(),U(qe,{key:K.id,value:K.id,label:K.firstName?K.firstName+" "+K.lastName:K.name},null,8,["value","label"]))),128))]),_:2},1032,["id","modelValue","onUpdate:modelValue","multiple","loading","filterable","placeholder","prefix-icon","remote-method"])],2)):O("",!0)],64))),128))])):O("",!0)]),_:1})],4)):O("",!0)}});function uh(n,a){let e=n.getters["entities/getService"](a.serviceId),s=0,l=0;return a.bookings.forEach(i=>{if(["approved","pending"].includes(i.status)){let o=i.duration?i.duration:e.duration;o>s&&(s=o);let r=0;i.extras.forEach(u=>{r+=e.extras.find(f=>f.id===u.extraId).duration*u.quantity}),r>l&&(l=r)}}),s+l}function vr(n,a,e){for(let s in n)n[s].appointments.forEach(l=>{let i={};l.bookings.forEach(r=>{r.customerId in i||(i[r.customerId]=[]),i[r.customerId][r.id]=r.status});let o={};for(let r in i)for(let u in i[r])(!(r in o)||i[r][u]==="approved"||i[r][u]==="pending")&&(o[r]=u);l.bookings.forEach(r=>{r.customerId in o&&parseInt(r.id)!==parseInt(o[r.customerId])||(a===""&&(l.bookingStart=Tl(l.bookingStart),l.bookingEnd=Tl(l.bookingEnd)),e||(l.bookings=[r]))})});if(a===""){let s={};for(let l in n)n[l].appointments.forEach(i=>{let o=i.bookingStart.split(" ")[0];o in s?s[o].appointments.push(i):s[o]={appointments:[i],date:o}});return s}return n}function _r(n,a){let e=[];return n.forEach(s=>{if(["approved","pending"].includes(s.status)&&s.customFields){let l=JSON.parse(s.customFields);Object.keys(l).forEach(i=>{if(l[i]){let o=l[i].type==="file"?l[i]?.value?l[i].value:"":l[i].value;(Array.isArray(o)?o.length:o)&&e.push({label:l[i].label,value:o})}})}}),a==="customer"?e:[...new Set(e.filter(s=>s.value).map(s=>s.label))].map(s=>new Object({label:s}))}function dh(n,a){let e={};return n.forEach(s=>{["approved","pending"].includes(s.status)&&s.extras.forEach(l=>{l.extraId in e||(e[l.extraId]={quantity:0,price:l.price,name:a.extras.find(i=>i.id===l.extraId).name}),e[l.extraId].quantity=e[l.extraId].quantity+l.quantity})}),e}const mh={class:"am-cc__periods-date"},ph={class:"am-cc__periods-time"},gh={key:0,class:"am-cc__periods-link__list"},fh=["href"],hh=m("span",{class:"am-icon-link"},null,-1),vh=["href"],_h=m("span",{class:"am-icon-link"},null,-1),yh=["href"],bh=m("span",{class:"am-icon-link"},null,-1),kh=["href"],Ch=m("span",{class:"am-icon-link"},null,-1),xh={name:"TemplatePeriods"},wh=Object.assign(xh,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n,e=R("amLabels");let s=R("containerWidth"),l=_(()=>st(s.value));return(i,o)=>(c(),y("div",{class:q(["am-cc__periods",t(l)])},[(c(!0),y(ee,null,fe(t(a).data,(r,u)=>(c(),y("div",{key:u,class:"am-cc__periods-item"},[m("span",mh,C(t(nt)(r.date)),1),m("span",ph,C(`${t(vs)(r.startTime)} - ${t(vs)(r.endTime)}`),1),r.googleMeetLink||r.zoomLink||r.lessonSpaceLink||r.microsoftTeamsLink?(c(),y("div",gh,[r.googleMeetLink?(c(),y("a",{key:0,class:"am-cc__periods-link",href:r.googleMeetLink,target:"_blank"},[hh,ce(" "+C(t(e).google_meet_link),1)],8,fh)):O("",!0),r.microsoftTeamsLink?(c(),y("a",{key:1,class:"am-cc__periods-link",href:r.microsoftTeamsLink,target:"_blank"},[_h,ce(" "+C(t(e).microsoft_teams_link),1)],8,vh)):O("",!0),r.zoomLink?(c(),y("a",{key:2,class:"am-cc__periods-link",href:r.zoomLink,target:"_blank"},[bh,ce(" "+C(t(e).zoom_link),1)],8,yh)):O("",!0),r.lessonSpaceLink?(c(),y("a",{key:3,class:"am-cc__periods-link",href:r.lessonSpaceLink,target:"_blank"},[Ch,ce(" "+C(t(e).lesson_space_link),1)],8,kh)):O("",!0)])):O("",!0)]))),128))],2))}});const Th={class:"am-cc__extras-name"},Sh={key:0,class:"am-cc__extras-duration"},Eh={key:1,class:"am-cc__extras-price"},Lh={key:2,class:"am-cc__extras-quantity"},Ah={name:"TemplateExtras"},Ih=Object.assign(Ah,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n,e=R("amLabels"),s=R("shortcodeData");let l=R("containerWidth"),i=_(()=>st(l.value));return(o,r)=>(c(),y("div",{class:q(["am-cc__extras",t(i)])},[(c(!0),y(ee,null,fe(t(a).data,(u,d)=>(c(),y("div",{key:d,class:"am-cc__extras-item"},[m("span",Th,C(u.name),1),u.duration||u.price||u.quantity?(c(),y("div",{key:0,class:q(["am-cc__extras-item__inner",[{"am-flex-space":!u.price&&u.duration},{"am-flex-end":!u.duration}]])},[u.duration?(c(),y("span",Sh,C(t(hs)(u.duration,t(e).h,t(e).min)),1)):O("",!0),t(s).cabinetType==="customer"&&u.price?(c(),y("span",Eh,C(t(tt)(u.price)),1)):O("",!0),u.quantity?(c(),y("span",Lh," x"+C(u.quantity),1)):O("",!0)],2)):O("",!0)]))),128))],2))}});const $h={class:"am-cc__tickets-item_inner"},Ph={class:"am-cc__tickets-name"},Dh={class:"am-cc__tickets-calc"},Nh={key:0,class:"am-cc__tickets-price"},Oh={name:"TemplateTickets"},Mh=Object.assign(Oh,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n,e=R("amLabels"),s=R("shortcodeData");let l=R("containerWidth"),i=_(()=>st(l.value));return(o,r)=>(c(),y("div",{class:q(["am-cc__tickets",t(i)])},[(c(!0),y(ee,null,fe(t(a).data,(u,d)=>(c(),y("div",{key:d,class:"am-cc__tickets-item"},[m("div",$h,[m("span",Ph,C(u.name),1),m("span",Dh,C(`${u.persons} ${u.persons>1?t(e).event_tickets:t(e).event_ticket}${t(s).cabinetType==="customer"?" x "+t(tt)(u.price):""}`),1)]),t(s).cabinetType==="customer"?(c(),y("div",Nh,C(t(tt)(u.persons*u.price)),1)):O("",!0)]))),128))],2))}});const Fh=["innerHTML"],Vh={key:0,class:"am-cc__cf-value"},Bh={class:"am-cc__cf-value__inner"},Rh={name:"TemplateCustomFields"},qh=Object.assign(Rh,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n;let e=R("containerWidth"),s=_(()=>st(e.value));function l(i){return i?Array.isArray(i)?i.length===0?"/":i.map(o=>typeof o=="object"&&o!==null&&!Array.isArray(o)?o.name||"/":o||"/").join(", "):i:"/"}return(i,o)=>(c(),y("div",{class:q(["am-cc__cf",t(s)])},[(c(!0),y(ee,null,fe(t(a).data,(r,u)=>(c(),y("div",{key:u,class:"am-cc__cf-item"},[m("span",{class:"am-cc__cf-name",innerHTML:r.label},null,8,Fh),"value"in r?(c(),y("div",Vh,[m("span",Bh,C(l(r.value)),1)])):O("",!0)]))),128))],2))}});const Uh={class:"am-cc__employee-heading"},zh={class:"am-cc__employee-heading__inner"},jh={class:"am-cc__employee-name"},Yh=["innerHTML"],Wh={key:1,class:"am-cc__employee-wrapper"},Hh={class:"am-cc__employee-heading"},Zh={class:"am-cc__employee-heading__inner"},Gh={class:"am-cc__employee-name"},Jh=["innerHTML"],Xh={name:"TemplateEmployee"},Qh=Object.assign(Xh,{props:{data:{type:[Object,Array]}},setup(n){const a=n;let e=_(()=>!Array.isArray(a.data)),s=R("containerWidth"),l=_(()=>st(s.value));function i(u){let d=u.firstName.charAt(0).toUpperCase(),f=u.lastName.charAt(0).toUpperCase();return`${d}${f}`}function o(u){return u.pictureThumbPath?{backgroundImage:`url(${u.pictureThumbPath})`}:{}}function r(u){return u&&u.includes("<!-- Content -->")?u.slice(16).length:u?u.length:!1}return(u,d)=>(c(),y("div",{class:q(["am-cc__employee",t(l)])},[t(e)?(c(),y(ee,{key:0},[m("div",Uh,[m("span",{class:"am-cc__employee-img",style:be(o(t(a).data))},[t(a).data.pictureThumbPath?O("",!0):(c(),y(ee,{key:0},[ce(C(i(t(a).data)),1)],64))],4),m("div",zh,[m("span",jh,C(`${t(a).data.firstName} ${t(a).data.lastName}`),1),t(a).data.badge?(c(),y("span",{key:0,class:"am-cc__employee-badge",style:be({background:t(a).data.badge.color})},C(t(a).data.badge.content),5)):O("",!0)])]),t(a).data.description?(c(),y("div",{key:0,class:q(["am-cc__employee-desc",{"ql-description":t(a).data.description.includes("<!-- Content -->")}]),innerHTML:t(a).data.description},null,10,Yh)):O("",!0)],64)):(c(),y("div",Wh,[(c(!0),y(ee,null,fe(t(a).data,f=>(c(),y(ee,{key:f.id},[m("div",Hh,[m("span",{class:"am-cc__employee-img",style:be(o(f))},[f.pictureThumbPath?O("",!0):(c(),y(ee,{key:0},[ce(C(i(f)),1)],64))],4),m("div",Zh,[m("span",Gh,C(`${f.firstName} ${f.lastName}`),1),f.badge?(c(),y("span",{key:0,class:"am-cc__employee-badge",style:be({background:f.badge.color})},C(f.badge.content),5)):O("",!0)])]),r(f.description)?(c(),y("div",{key:0,class:q(["am-cc__employee-desc",{"ql-description":f.description.includes("<!-- Content -->")}]),innerHTML:f.description},null,10,Jh)):O("",!0)],64))),128))]))],2))}});const Kh={class:"am-cc__customers-item_inner"},ev={class:"am-cc__customers-name"},tv={class:"am-cc__customers-info"},av={class:"am-cc__customers-info"},sv={name:"TemplateCustomers"},lv=Object.assign(sv,{props:{data:{type:[Array,Object,String]}},setup(n){const a=n;let e=R("containerWidth"),s=_(()=>st(e.value));return(l,i)=>(c(),y("div",{class:q(["am-cc__customers",t(s)])},[(c(!0),y(ee,null,fe(t(a).data,(o,r)=>(c(),y("div",{key:r,class:"am-cc__customers-item"},[m("div",Kh,[m("span",ev,C(o.firstName)+" "+C(o.lastName),1),m("span",tv,C(o.email),1),m("span",av,C(o.phone),1)])]))),128))],2))}});const nv={class:"am-cc__popover-inner"},iv={key:0,class:"am-cc__popover-heading"},ov={name:"CollapseCardPopoverTemplate"},ss=Object.assign(ov,{props:{headerText:{type:String,default:""},type:{type:String,required:!0},contentData:{type:[Array,Object,String],default:""}},setup(n){const a=n;let e=F({period:Ge(wh),extras:Ge(Ih),ticket:Ge(Mh),customField:Ge(qh),employee:Ge(Qh),customers:Ge(lv)}),s=R("amFonts"),l=R("amColors"),i=_(()=>({"--am-c-cc-primary":l.value.colorPrimary,"--am-c-cc-primary-op70":H(l.value.colorPrimary,.7),"--am-c-cc-success":l.value.colorSuccess,"--am-c-cc-success-op15":H(l.value.colorSuccess,.15),"--am-c-cc-bgr":l.value.colorMainBgr,"--am-c-cc-text":l.value.colorMainText,"--am-c-cc-text-op10":H(l.value.colorMainText,.1),"--am-c-cc-text-op15":H(l.value.colorMainText,.15),"--am-c-cc-text-op70":H(l.value.colorMainText,.7),"--am-c-cc-text-op80":H(l.value.colorMainText,.8),"--am-c-cc-text-op90":H(l.value.colorMainText,.9),"--am-c-scroll-op30":H(l.value.colorPrimary,.3),"--am-c-scroll-op10":H(l.value.colorPrimary,.1),"--am-font-family":s.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(o,r)=>{const u=Gs;return c(),U(u,{"show-arrow":!1,persistent:!1,width:"auto","popper-class":"am-cc__popover","popper-style":t(i),trigger:"click"},{reference:x(()=>[ko(o.$slots,"default")]),default:x(()=>[m("div",nv,[t(a).headerText?(c(),y("div",iv,C(t(a).headerText),1)):O("",!0),(c(),U(pt(t(e)[t(a).type]),{class:"am-cc__popover-content",data:t(a).contentData},null,8,["data"]))])]),_:3},8,["popper-style"])}}});function rv(n){let a=oi(null,n.coupon,n.tax?n.tax[0]:null,n.price-n.price/100*n.discount,!1);return a.price-a.discount+a.tax}const ls=Qe(window.wpAmeliaLabels);function vo(n,a,e,s=null){e.type==="package"&&n.commit("cabinet/setPackageLoading",!0),e.type==="appointment"&&n.commit("cabinet/setAppointmentsLoading",!0),e.type==="event"&&n.commit("cabinet/setEventsLoading",!0),n.commit("cabinet/setPaymentLinkLoader",e.bookings?e.bookings[0].id:e.id);let l=JSON.parse(JSON.stringify(e)),i=JSON.parse(JSON.stringify(n.getters["auth/getProfile"]));i.birthday=null,l.customer=i,l.type!=="package"?(l[l.type]=e,l.booking=e.bookings[0],l.paymentId=e.bookings[0].payments[0].id):l=Object.assign(l,l.package),Ne.post("/payments/link",{data:l,paymentMethod:a}).then(o=>{!o.data.data.error&&o.data.data.paymentLink?window.location.href=o.data.data.paymentLink:n.commit("cabinet/setPaymentLinkError",{value:!0,type:e.type})}).catch(o=>{n.commit("cabinet/setPaymentLinkError",{value:!0,type:e.type})}).finally(()=>{n.commit("cabinet/setPaymentLinkLoader",null),e.type==="package"&&n.commit("cabinet/setPackageLoading",!1),e.type==="appointment"&&n.commit("cabinet/setAppointmentsLoading",!1),e.type==="event"&&n.commit("cabinet/setEventsLoading",!1)})}function si(n,a){if(n.type!=="package"&&(!n.bookings||n.bookings.length===0))return!1;a=JSON.parse(a);let e=a&&"payments"in a&&a.payments&&"paymentLinks"in a.payments&&a.payments.paymentLinks?a.payments.paymentLinks:at.payments.paymentLinks,s=!1;switch(n.type){case"package":s=!n.end||he(n.end,"YYYY-MM-DD HH:mm").isAfter(he());break;case"appointment":s=he(n.bookingStart,"YYYY-MM-DD HH:mm:ss").isAfter(he())&&n.bookings[0].payments.length>0;break;case"event":s=he(n.periods[n.periods.length-1].periodEnd,"YYYY-MM-DD HH:mm:ss").isAfter(he())&&n.bookings[0].payments.length>0;break}return li(at).length&&at&&e&&e.enabled&&s}function li(n){typeof n=="string"&&(n=JSON.parse(n));let a=[];return n=n.payments,at.payments.wc.enabled?a.push({value:"wc",label:ls.wc}):at.payments.mollie.enabled&&(!("mollie"in n)||n.mollie.enabled)?a.push({value:"mollie",label:ls.on_line}):(at.payments.payPal.enabled&&(!("payPal"in n)||n.payPal.enabled)&&a.push({value:"payPal",label:ls.pay_pal}),at.payments.stripe.enabled&&(!("stripe"in n)||n.stripe.enabled)&&a.push({value:"stripe",label:ls.credit_card}),at.payments.razorpay.enabled&&(!("razorpay"in n)||n.razorpay.enabled)&&a.push({value:"razorpay",label:ls.razorpay}),at.payments.square.enabled&&(!("square"in n)||n.square.enabled)&&a.push({value:"square",label:ls.square})),a}function Cl(n,a){switch(a.type){case"appointment":{let e=di(n,{price:a.bookings[0].price,persons:a.bookings[0].persons,aggregatedPrice:a.bookings[0].aggregatedPrice,extras:a.bookings[0].extras,serviceId:null,tax:a.bookings[0].tax,coupon:a.bookings[0].coupon},!1);return e.total-e.discount+e.tax>a.bookings[0].payments.filter(s=>s.status!=="refunded"&&s.status!=="pending").reduce((s,l)=>s+l.amount,0)}case"event":return Po(a)>a.bookings[0].payments.filter(e=>e.status!=="refunded"&&e.status!=="pending").reduce((e,s)=>e+s.amount,0);case"package":return rv(a)>a.payments.filter(e=>e.status!=="refunded"&&e.status!=="pending").reduce((e,s)=>e+s.amount,0)}}const cv={class:"am-cc__edit"},uv=["onClick"],dv={class:"am-cc__edit-text"},mv={name:"PaymentButton"},yr=Object.assign(mv,{props:{reservation:{type:Object,default:()=>{}},bookable:{type:Object,default:()=>{}},type:{type:String},btnSize:{type:String,default:"mini"},class:{type:String,default:""}},setup(n){const a=n;let e=De();const s=R("amLabels");let l=_(()=>li(a.bookable.settings)),i=_(()=>e.getters["cabinet/getPaymentLinkLoader"]),o={components:{IconComponent:We},template:'<IconComponent icon="arrow-down"></IconComponent>'},r=F(!1);function u(E){E.stopPropagation(),l.value.length===1?vo(e,l.value[0].value,a.reservation):r.value=!r.value}function d(){r.value=!1}let f=F(!1);function v(){f.value=!1}let g=R("amFonts"),k=R("amColors"),N=_(()=>({"--am-c-cc-primary":k.value.colorPrimary,"--am-c-cc-primary-op70":H(k.value.colorPrimary,.7),"--am-c-cc-error":k.value.colorError,"--am-c-cc-error-op15":H(k.value.colorError,.15),"--am-c-cc-warning":k.value.colorWarning,"--am-c-cc-warning-op15":H(k.value.colorWarning,.15),"--am-c-cc-success":k.value.colorSuccess,"--am-c-cc-success-op15":H(k.value.colorSuccess,.15),"--am-c-cc-bgr":k.value.colorMainBgr,"--am-c-cc-text":k.value.colorMainText,"--am-c-cc-text-op10":H(k.value.colorMainText,.1),"--am-c-cc-text-op15":H(k.value.colorMainText,.15),"--am-c-cc-text-op70":H(k.value.colorMainText,.7),"--am-c-cc-text-op90":H(k.value.colorMainText,.9),"--am-font-family":g.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(E,b)=>{const A=Gs;return t(si)(t(a).reservation,t(a).bookable.settings)?(c(),U(A,{key:0,ref:"payRef",visible:t(r),persistent:!1,"show-arrow":!1,"popper-class":"am-cc__popper","popper-style":t(N),trigger:"click"},{reference:x(()=>[$(Se,{size:t(a).btnSize,type:t(a).type,suffix:t(l).length>1&&t(Cl)(t(e),t(a).reservation)?t(o):"",class:q([{"am-button-single":t(l).length===1||!t(Cl)(t(e),t(a).reservation)},t(a).class]),loading:!!t(i),"loading-icon":"loading",disabled:!t(Cl)(t(e),t(a).reservation),onClick:u},{default:x(()=>[ce(C(t(Cl)(t(e),t(a).reservation)?t(s).pay_now_btn:t(s).paid),1)]),_:1},8,["size","type","suffix","class","loading","disabled"])]),default:x(()=>[zt((c(),y("div",cv,[(c(!0),y(ee,null,fe(t(li)(t(a).bookable.settings),S=>zt((c(),y("div",{key:S.value,class:"am-cc__edit-item",onClick:P=>t(vo)(t(e),S.value,t(a).reservation)},[m("span",dv,C(S.label),1)],8,uv)),[[t(ia),d]])),128))])),[[t(ia),v]])]),_:1},8,["visible","popper-style"])):O("",!0)}}}),ns=Qe(window.wpAmeliaLabels);function br(){return[{value:"approved",label:ns.approved,icon:"check",color:"var(--am-c-success)"},{value:"pending",label:ns.pending,icon:"refresh",color:"var(--am-c-warning)"},{value:"canceled",label:ns.canceled,icon:"close",color:"var(--am-c-error)"},{value:"rejected",label:ns.rejected,icon:"info-reverse",color:"var(--am-c-main-text)"},{value:"waiting",label:ns.waiting,icon:"clock",color:"var(--am-c-warning)"},{value:"no-show",label:ns["no-show"],icon:"clock",color:"var(--am-c-warning)"}]}const pv={name:"CollapseCard"},_o=Object.assign(pv,{props:{id:{type:[Number],default:0},status:{type:String,default:""}},emits:["statusChange"],setup(n,{emit:a}){const e=n,s=R("shortcodeData");let l=R("amLabels"),i=De(),o=_(()=>br().filter(f=>f.value!=="waiting"));function r(){u.value=!0,Ne.post("/appointments/status/"+e.id,{status:d.value},Object.assign(ze(i),{params:{source:"cabinet-provider"}})).then(f=>{let v=l.value.appointment_status_changed+l.value[f.data.data.status].toLowerCase(),g="success";"maximumCapacityReached"in f.data.data&&f.data.data.maximumCapacityReached===!0&&(v=l.value.maximum_capacity_reached,g="error",d.value=e.status),a("statusChange",v,g),u.value=!1}).catch(f=>{let v=l.value.error,g="error";"response"in f&&"data"in f.response&&"data"in f.response.data&&"timeSlotUnavailable"in f.response.data.data&&f.response.data.data.timeSlotUnavailable===!0&&(v=l.value.time_slot_unavailable),d.value=e.status,a("statusChange",v,g),u.value=!1})}let u=F(!1),d=F("");return Je(()=>{d.value=e.status}),(f,v)=>(c(),y("div",null,[t(d)&&t(s).cabinetType==="employee"?(c(),U(He,{key:0,modelValue:t(d),"onUpdate:modelValue":v[0]||(v[0]=g=>we(d)?d.value=g:d=g),"prefix-icon":t(o).find(g=>g.value===t(d)).icon,"prefix-icon-color":t(o).find(g=>g.value===t(d)).color,disabled:t(u),size:"small",onClick:v[1]||(v[1]=g=>g.stopPropagation()),onChange:r},{default:x(()=>[(c(!0),y(ee,null,fe(t(o),g=>(c(),U(qe,{key:g.value,value:g.value,label:g.label},{default:x(()=>[m("span",{class:q(`am-icon-${g.icon}`),style:be(`color: ${g.color}`)},null,6),ce(" "+C(g.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","prefix-icon","prefix-icon-color","disabled"])):O("",!0)]))}});const gv={class:"am-cc__time"},fv={key:0,class:"am-cc__name"},hv={key:0,class:"am-cc__name"},vv={key:1,class:"am-cc__places"},_v={key:2,class:"am-cc__customer"},yv={key:0,class:"am-cc__edit"},bv=m("span",{class:"am-icon-edit"},null,-1),kv={class:"am-cc__edit-text"},Cv={key:0,class:"am-cc__edit"},xv=m("span",{class:"am-icon-users-plus"},null,-1),wv={class:"am-cc__edit-text"},Tv={class:"am-cc__edit"},Sv=m("span",{class:"am-icon-user"},null,-1),Ev={class:"am-cc__edit-text"},Lv={class:"am-cc__edit"},Av=m("span",{class:"am-icon-date-time"},null,-1),Iv={class:"am-cc__edit-text"},$v=m("span",{class:"am-icon-clearable"},null,-1),Pv={class:"am-cc__edit-text"},Dv={class:"am-cc__content-inner"},Nv={class:"am-cc__data"},Ov=m("span",{class:"am-icon-user"},null,-1),Mv={class:"am-cc__data-text"},Fv={class:"am-cc__data"},Vv=m("span",{class:"am-icon-user"},null,-1),Bv={class:"am-cc__data-text"},Rv={key:2,class:"am-cc__data"},qv=m("span",{class:"am-icon-payments"},null,-1),Uv={class:"am-cc__data-text"},zv={key:3,class:"am-cc__data"},jv=m("span",{class:"am-icon-clock"},null,-1),Yv={class:"am-cc__data-text"},Wv={class:"am-cc__data"},Hv=m("span",{class:"am-icon-clock"},null,-1),Zv={class:"am-cc__data-text"},Gv={key:5,class:"am-cc__data link"},Jv=m("span",{class:"am-icon-link"},null,-1),Xv=["href"],Qv={key:6,class:"am-cc__data link"},Kv=m("span",{class:"am-icon-link"},null,-1),e_=["href"],t_={key:7,class:"am-cc__data link"},a_=m("span",{class:"am-icon-link"},null,-1),s_=["href"],l_={key:8,class:"am-cc__data link"},n_=m("span",{class:"am-icon-link"},null,-1),i_=["href"],o_={class:"am-cc__data"},r_=m("span",{class:"am-icon-border-plus"},null,-1),c_={class:"am-cc__data-text"},u_={class:"am-cc__data"},d_=m("span",{class:"am-icon-file-text"},null,-1),m_={class:"am-cc__data-text"},p_={class:"am-cc__data"},g_=m("span",{class:"am-icon-tickets"},null,-1),f_={class:"am-cc__data-text"},h_=m("span",{class:"am-icon-locations"},null,-1),v_=["href"],__={key:1,class:"am-cc__data-text"},y_={name:"CollapseCard"},kr=Object.assign(y_,{props:{id:{type:Number,default:0},start:{type:[String,Object,Array,Function],required:!0},name:{type:String,default:""},employee:{type:[Object,Array],default:()=>{}},customers:{type:[Array],default:()=>{}},location:{type:[String,Object],default:""},price:{type:Number,default:0},duration:{type:Number,default:0},periods:{type:Array,default:()=>{}},extras:{type:Object,default:()=>{}},tickets:{type:Object,default:()=>{}},customFields:{type:Array,default:()=>[]},googleMeetLink:{type:String,default:""},microsoftTeamsLink:{type:String,default:""},zoomLink:{type:String,default:""},lessonSpaceLink:{type:String,default:""},reservation:{type:Object,default:()=>{}},bookable:{type:Object,default:()=>{}},booking:{type:Object,default:()=>{}},isPackageBooking:{type:Boolean,default:!1},responsiveClass:{type:String,default:""},parentWidth:{type:Number,default:1200},customizedOptions:{type:Object,required:!0}},emits:["cancelBooking","rescheduling","editAppointment","editEvent","addEventAttendee","listEventAttendees","statusChange"],setup(n,{emit:a}){const e=n,s=R("shortcodeData"),l=R("settings");let i=R("originKey");const o=R("amLabels");let r=F(!1);function u(L){L.stopPropagation(),r.value=!r.value}function d(){r.value=!1}function f(){a("cancelBooking",e.booking),r.value=!1}function v(L){a("edit"+L.charAt(0).toUpperCase()+L.slice(1),e.reservation),r.value=!1}function g(L){a("addEventAttendee",L),r.value=!1}function k(L){a("listEventAttendees",L),r.value=!1}function N(){a("rescheduling",e.reservation,e.booking),r.value=!1}function E(L){return Array.isArray(L)?o.value.event_staff:!Array.isArray(L)&&L.rank&&L.rank==="organizer"?o.value.event_organizer:`${e.employee.firstName} ${e.employee.lastName}`}let b=_(()=>e.reservation.type==="event"?e.reservation.maxCapacity-e.reservation.places+"/"+e.reservation.maxCapacity:""),A=_(()=>{if(e.reservation.type==="appointment")return{label:o.value[s.value.cabinetType==="employee"||e.booking.status==="approved"?e.reservation.status:e.booking.status],class:s.value.cabinetType==="employee"||e.booking.status==="approved"?e.reservation.status:e.booking.status};if(e.reservation.type==="event"){if(s.value.cabinetType==="customer")return{label:o.value[e.booking.status],class:e.booking.status};switch(e.reservation.status){case"rejected":case"canceled":return{label:o.value.canceled,class:"canceled"};case"full":return{label:o.value.full,class:"full"};case"waiting":return{label:o.value.waiting_list,class:"waiting"};case"upcoming":return{label:o.value.upcoming,class:"upcoming"};case"approved":if(e.reservation.closed)return{label:o.value.closed,class:"closed"};if(e.reservation.opened&&e.reservation.places>0)return{label:o.value.opened,class:"opened"}}}return{label:"",class:""}}),S=_(()=>e.reservation&&e.reservation.type==="appointment"&&s.value.cabinetType==="employee"&&l.roles.allowWriteAppointments?e.parentWidth<=440?"70px":e.parentWidth<=690?"130px":"160px":"auto"),P=R("amFonts"),h=R("amColors"),I=_(()=>({"--am-c-cc-primary":h.value.colorPrimary,"--am-c-cc-primary-op15":H(h.value.colorPrimary,.15),"--am-c-cc-primary-op70":H(h.value.colorPrimary,.7),"--am-c-cc-error":h.value.colorError,"--am-c-cc-error-op15":H(h.value.colorError,.15),"--am-c-cc-warning":h.value.colorWarning,"--am-c-cc-warning-op15":H(h.value.colorWarning,.15),"--am-c-cc-success":h.value.colorSuccess,"--am-c-cc-success-op15":H(h.value.colorSuccess,.15),"--am-c-cc-bgr":h.value.colorMainBgr,"--am-c-cc-text":h.value.colorMainText,"--am-c-cc-text-op03":H(h.value.colorMainText,.03),"--am-c-cc-text-op10":H(h.value.colorMainText,.1),"--am-c-cc-text-op15":H(h.value.colorMainText,.15),"--am-c-cc-text-op70":H(h.value.colorMainText,.7),"--am-c-cc-text-op90":H(h.value.colorMainText,.9),"--am-font-family":P.value.fontFamily,"--am-status-width":S.value,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(L,T)=>{const w=Gs;return c(),y("div",{class:"am-cc",style:be(t(I))},[$(Io,null,{default:x(()=>[$(Ao,{"heading-class":"am-cc__heading-wrapper",side:t(e).parentWidth>500},{heading:x(()=>[m("div",{class:q(["am-cc__heading",t(e).responsiveClass])},[m("div",{class:q(["am-cc__heading-info",t(e).responsiveClass])},[m("div",{class:q(["am-cc__heading-info__part",t(e).responsiveClass])},[m("div",gv,C(t(e).start),1),t(e).parentWidth>650?(c(),y("div",fv,C(t(e).name),1)):O("",!0),t(e).reservation.type==="event"&&t(s).cabinetType==="employee"&&t(e).parentWidth<=650?(c(),y("div",{key:1,class:q(["am-cc__places",t(e).responsiveClass])},C(t(b)),3)):O("",!0),t(e).reservation.type==="appointment"&&t(s).cabinetType==="employee"&&t(e).customers.length===1&&t(e).customizedOptions.customer.visibility&&t(e).parentWidth<=650?(c(),y("div",{key:2,class:q(["am-cc__customer",t(e).responsiveClass])},C(`${t(e).customers[0].firstName} ${t(e).customers[0].lastName}`),3)):O("",!0),t(e).reservation&&t(e).reservation.type==="appointment"&&t(s).cabinetType==="employee"&&t(l).roles.allowWriteAppointments&&t(e).parentWidth<=650?(c(),U(_o,{key:3,id:t(e).reservation.id,status:t(e).reservation.status,class:"am-cc__status am-cc__status--dropdown",onStatusChange:T[0]||(T[0]=(B,z)=>t(a)("statusChange",B,z))},null,8,["id","status"])):t(e).booking&&t(e).parentWidth<=650?(c(),y("div",{key:4,class:q(["am-cc__status",`am-cc__status-${t(A).class}`])},C(t(A).label),3)):O("",!0)],2),m("div",{class:q(["am-cc__heading-info__part",t(e).responsiveClass])},[t(e).parentWidth<=650?(c(),y("div",hv,C(t(e).name),1)):O("",!0),t(e).reservation.type==="event"&&t(s).cabinetType==="employee"&&t(e).parentWidth>650?(c(),y("div",vv,C(t(b)),1)):O("",!0),t(e).reservation.type==="appointment"&&t(s).cabinetType==="employee"&&t(e).customers.length===1&&t(e).customizedOptions.customer.visibility&&t(e).parentWidth>650?(c(),y("div",_v,C(`${t(e).customers[0].firstName} ${t(e).customers[0].lastName}`),1)):O("",!0),t(e).reservation&&t(e).reservation.type==="appointment"&&t(s).cabinetType==="employee"&&t(l).roles.allowWriteAppointments&&t(e).parentWidth>650?(c(),U(_o,{key:3,id:t(e).reservation.id,status:t(e).reservation.status,class:"am-cc__status am-cc__status--dropdown",onStatusChange:T[1]||(T[1]=(B,z)=>t(a)("statusChange",B,z))},null,8,["id","status"])):t(e).booking&&t(e).parentWidth>650?(c(),y("div",{key:4,class:q(["am-cc__status",`am-cc__status-${t(A).class}`])},C(t(A).label),3)):O("",!0)],2)],2),t(s).cabinetType==="employee"?(c(),y("div",{key:0,class:q(["am-cc__heading-actions",t(e).responsiveClass])},[t(e).reservation.type!=="appointment"||t(l).roles.allowWriteAppointments?(c(),U(w,{key:0,ref:"editRef",visible:t(r),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(I),trigger:"click"},{reference:x(()=>[t(e).reservation?(c(),y("span",{key:0,class:"am-cc__edit-btn am-icon-dots-vertical",onClick:u})):O("",!0)]),default:x(()=>[t(e).reservation.type==="appointment"&&t(l).roles.allowWriteAppointments||t(e).reservation.type==="event"&&t(l).roles.allowWriteEvents?zt((c(),y("div",yv,[m("div",{class:"am-cc__edit-item am-edit",onClick:T[2]||(T[2]=B=>v(t(e).reservation.type))},[bv,m("span",kv,C(t(o).edit),1)])])),[[t(ia),d]]):O("",!0),t(e).reservation.type==="event"?(c(),y(ee,{key:1},[t(l).roles.allowWriteEvents?zt((c(),y("div",Cv,[m("div",{class:"am-cc__edit-item am-edit",onClick:T[3]||(T[3]=B=>g(t(e).reservation))},[xv,m("span",wv,C(t(o).event_add_attendee),1)])])),[[t(ia),d]]):O("",!0),zt((c(),y("div",Tv,[m("div",{class:"am-cc__edit-item am-edit",onClick:T[4]||(T[4]=B=>k(t(e).reservation))},[Sv,m("span",Ev,C(t(o).attendees),1)])])),[[t(ia),d]])],64)):O("",!0)]),_:1},8,["visible","popper-style"])):O("",!0)],2)):(t(e).booking&&t(e).booking.status==="approved"||t(e).booking.status==="pending"||t(e).booking.status==="waiting")&&(!t(e).isPackageBooking&&t(e).booking.price>0&&t(si)(t(e).reservation,t(e).bookable.settings)||!!(t(e).reservation.cancelable||t(l).roles.allowCustomerReschedule&&t(e).reservation.reschedulable))?(c(),y("div",{key:1,class:q(["am-cc__heading-actions",t(e).responsiveClass])},[t(e).booking.status!=="waiting"&&!t(e).isPackageBooking&&t(e).booking.price>0&&t(si)(t(e).reservation,t(e).bookable.settings)?(c(),U(yr,{key:0,reservation:t(e).reservation,bookable:t(e).bookable},null,8,["reservation","bookable"])):O("",!0),t(e).reservation.cancelable||t(l).roles.allowCustomerReschedule&&t(e).reservation.reschedulable?(c(),U(w,{key:1,ref:"editRef",visible:t(r),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":t(I),trigger:"click"},{reference:x(()=>[t(e).booking?(c(),y("span",{key:0,class:"am-cc__edit-btn am-icon-dots-vertical",onClick:u})):O("",!0)]),default:x(()=>[zt((c(),y("div",Lv,[t(e).reservation.type==="appointment"&&t(l).roles.allowCustomerReschedule&&t(e).reservation.reschedulable?(c(),y("div",{key:0,class:"am-cc__edit-item",onClick:N},[Av,m("span",Iv,C(t(o).reschedule),1)])):O("",!0),t(e).reservation.cancelable?(c(),y("div",{key:1,class:"am-cc__edit-item am-delete",onClick:f},[$v,m("span",Pv,C(t(o).cancel),1)])):O("",!0)])),[[t(ia),d]])]),_:1},8,["visible","popper-style"])):O("",!0)],2)):O("",!0)],2)]),default:x(()=>[m("div",{class:q(["am-cc__content",t(e).responsiveClass])},[m("div",Dv,[t(i)==="capc"&&n.customizedOptions.employee.visibility?(c(),y(ee,{key:0},[(Array.isArray(t(e).employee)?t(e).employee.length:Object.keys(t(e).employee).length)?(c(),U(ss,{key:0,"header-text":Array.isArray(t(e).employee)?t(o).view_employees:t(o).provider_profile,type:"employee","content-data":t(e).employee},{default:x(()=>[m("div",Nv,[Ov,m("span",Mv,C(E(t(e).employee)),1)])]),_:1},8,["header-text","content-data"])):O("",!0)],64)):O("",!0),t(i)==="cape"&&t(e).reservation.type==="appointment"&&t(e).customers.length>1&&t(e).customizedOptions.customer.visibility?(c(),y(ee,{key:1},[t(e).customers.length?(c(),U(ss,{key:0,"header-text":t(o).customers,type:"customers","content-data":t(e).customers},{default:x(()=>[m("div",Fv,[Vv,m("span",Bv,C(t(o).customers),1)])]),_:1},8,["header-text","content-data"])):O("",!0)],64)):O("",!0),t(e).price&&t(e).customizedOptions.price.visibility?(c(),y("div",Rv,[qv,m("span",Uv,C(t(tt)(t(e).price)),1)])):O("",!0),t(e).duration?(c(),y("div",zv,[jv,m("span",Yv,C(t(hs)(t(e).duration,t(o).h,t(o).min)),1)])):O("",!0),n.periods.length?(c(),U(ss,{key:4,"header-text":t(o).event_timetable,type:"period","content-data":t(e).periods},{default:x(()=>[m("div",Wv,[Hv,m("span",Zv,C(t(o).event_timetable),1)])]),_:1},8,["header-text","content-data"])):O("",!0),t(e).googleMeetLink?(c(),y("div",Gv,[Jv,m("a",{class:"am-cc__data-text link",href:t(e).googleMeetLink,target:"_blank",tabindex:"-1"},C(t(o).google_meet_link),9,Xv)])):O("",!0),t(e).microsoftTeamsLink?(c(),y("div",Qv,[Kv,m("a",{class:"am-cc__data-text link",href:t(e).microsoftTeamsLink,target:"_blank",tabindex:"-1"},C(t(o).microsoft_teams_link),9,e_)])):O("",!0),t(e).zoomLink?(c(),y("div",t_,[a_,m("a",{class:"am-cc__data-text link",href:t(e).zoomLink,target:"_blank",tabindex:"-1"},C(t(o).zoom_link),9,s_)])):O("",!0),t(e).lessonSpaceLink?(c(),y("div",l_,[n_,m("a",{class:"am-cc__data-text link",href:t(e).lessonSpaceLink,target:"_blank",tabindex:"-1"},C(t(o).lesson_space_link),9,i_)])):O("",!0),Object.keys(t(e).extras).length?(c(),U(ss,{key:9,"header-text":`${Object.keys(t(e).extras).length} ${t(o).extras}`,type:"extras","content-data":t(e).extras},{default:x(()=>[m("div",o_,[r_,m("span",c_,C(`${Object.keys(t(e).extras).length} ${t(o).extras}`),1)])]),_:1},8,["header-text","content-data"])):O("",!0),t(e).customFields.length?(c(),U(ss,{key:10,"header-text":t(o).custom_fields,type:"customField","content-data":t(e).customFields},{default:x(()=>[m("div",u_,[d_,m("span",m_,C(t(o).custom_fields),1)])]),_:1},8,["header-text","content-data"])):O("",!0),Object.keys(t(e).tickets).length?(c(),U(ss,{key:11,"header-text":t(o).event_tickets,type:"ticket","content-data":t(e).tickets},{default:x(()=>[m("div",p_,[g_,m("span",f_,C(t(o).event_tickets),1)])]),_:1},8,["header-text","content-data"])):O("",!0),t(e).location?(c(),y("div",{key:12,class:q(["am-cc__data",{link:t(e).location.address}])},[h_,t(e).location.address?(c(),y("a",{key:0,class:"am-cc__data-text",href:`https://maps.google.com/?q=${t(e).location.address}`,target:"_blank",tabindex:"-1"},C(t(e).location.name),9,v_)):(c(),y("span",__,C(t(e).location.name),1))],2)):O("",!0)])],2)]),_:1},8,["side"])]),_:1})],4)}}});const b_={class:"am-csd__header"},k_={class:"am-csd__header-text"},C_=m("span",{class:"am-icon-clearable"},null,-1),x_={class:"am-csd__footer"},w_={name:"AppointmentBooking"},Cr=Object.assign(w_,{props:{visibility:{type:Boolean,default:!1},appointment:{type:Object,default:null},employees:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},slotsParams:{type:Object,default:()=>{}},isPackage:{type:Boolean,default:!1},labels:{type:Object,required:!0},customizedOptions:{type:Object,required:!0}},emits:["close","success","error","employee-selection","location-selection"],setup(n,{emit:a}){const e=n;let s=De();const l=R("settings");let i=F("");function o(J){i.value=J.toLowerCase()}let r=_(()=>i.value?e.employees.filter(J=>`${J.firstName} ${J.lastName}`.toLowerCase().includes(i.value)&&J.show):e.employees.filter(J=>J.show)),u=F("");function d(J){u.value=J.toLowerCase()}let f=_(()=>u.value?e.locations.filter(J=>J.name.toLowerCase().includes(u.value)):e.locations),v=R("amLabels"),g=F(null),k=F(null);rt(()=>e.appointment,J=>{setTimeout(()=>{G.value++},200);let ve=JSON.parse(JSON.stringify(J));ve&&ve.bookingStart&&(g.value=ve.bookingStart.split(" ")[0],k.value=ve.bookingStart.split(" ")[1].substring(0,5))});let N=F(null),E=F(0),b=R("sidebarCollapsed");window.addEventListener("resize",A);function A(){N.value&&(E.value=N.value.offsetWidth)}rt(b,J=>{J?setTimeout(()=>{S()},1500):setTimeout(()=>{S()},500)});function S(){E.value=N.value.offsetWidth}Je(()=>{ri(()=>{E.value=N.value.offsetWidth})});let P=_(()=>e.visibility);rt(P,J=>{J&&setTimeout(()=>{E.value=N.value.offsetWidth},300)});let h=_(()=>st(E.value)),I=F(!1),L=F(null),T=F("");function w(){I.value=!1,T.value=""}let B=F(null),z=_(()=>B.value?B.value.calendarSlotsLoading:!0),D=R("cabinetType"),G=F(0),se=F(!1),j=F({employee:null,location:null}),ne=F(!0),te=F(!0),oe=_(()=>e.appointment&&!e.appointment.id&&(e.employees.length||e.locations.length)&&(e.customizedOptions.employee.visibility||e.customizedOptions.location.visibility)&&(ne.value||te.value)),ie=F(null),K=_(()=>oe.value?{employee:[{required:"employee"in e.customizedOptions?e.customizedOptions.employee.required:!1,message:v.value.please_select_employee,trigger:"submit"}],location:[{required:"location"in e.customizedOptions?e.customizedOptions.location.required:!1,message:v.value.please_select_location,trigger:"submit"}]}:{}),me=_(()=>{let J={};return j.value.employee?J.providerIds=[j.value.employee]:"providerIds"in e.slotsParams&&e.slotsParams.providerIds.length&&(J.providerIds=e.slotsParams.providerIds),j.value.location?J.locationId=j.value.location:"locationId"in e.slotsParams&&e.slotsParams.locationId?J.locationId=e.slotsParams.locationId:J.locationId=null,Object.assign({},e.slotsParams,J)});function Ae(){ie.value&&ie.value.clearValidate(),se.value=!0,G.value++,a("employee-selection",j.value.employee),a("location-selection",j.value.location)}function Ve(J){j.value.employee=J,Ae()}function Q(){oe.value&&(j.value.employee=null,j.value.location=null,ne.value=!0,te.value=!0,Ae()),a("close")}rt(P,J=>{J&&e.employees.length===1&&(j.value.employee=e.employees[0].id,ne.value=!1),J&&e.locations.length===1&&(j.value.location=e.locations[0].id,te.value=!1),J&&(e.locations.length===1||e.employees.length===1)&&Ae()});let _e=F();Be("formWrapper",_e);let X=_(()=>s.getters["entities/getService"](e.appointment.serviceId).duration);Be("calendarSlotDuration",X);let M=F(!0);Be("calendarChangeSideBar",M);let Z=F(0);Be("calendarServiceDuration",Z);function W(){"id"in e.appointment?de():xe()}function le(J){let ve=J?"UTC":s.getters["cabinet/getTimeZone"],ge=g.value+" "+k.value,Me=null,Ce=null;if(J){let ba=Vi(ge);Ce=Fi(ba),Me=ba}else Me=ge;return{utcOffset:Ce,bookingStart:Me,timeZone:ve}}function de(){B.value.calendarSlotsLoading=!0;let J=le(!1);Us()===s.getters["cabinet/getTimeZone"]&&l.general.showClientTimeZone&&(J.utcOffset=Fi(Vi(g.value+" "+k.value))),Ne.post("/bookings/reassign/"+e.appointment.bookings.filter(ve=>ve.status==="approved"||ve.status==="pending")[0].id,J,Object.assign(ze(s),{params:{source:"cabinet-"+D.value}})).then(()=>{B.value.calendarSlotsLoading=!1,a("success",{message:v.value.appointment_rescheduled})}).catch(ve=>{B.value.calendarSlotsLoading=!1,ve.response&&(!("data"in ve.response.data)&&"message"in ve.response.data&&(I.value=!0,T.value=ve.response.data.message,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500)),"data"in ve.response&&"data"in ve.response.data&&"customerAlreadyBooked"in ve.response.data.data&&(I.value=!0,T.value=e.labels.customer_already_booked_app,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500)),"data"in ve.response&&"data"in ve.response.data&&"cancelBookingUnavailable"in ve.response.data.data&&(I.value=!0,T.value=e.labels.booking_cancel_exception,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500)),"data"in ve.response&&"data"in ve.response.data&&"timeSlotUnavailable"in ve.response.data.data&&ve.response.data.data.timeSlotUnavailable===!0&&(I.value=!0,T.value=e.labels.time_slot_unavailable,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500)),"data"in ve.response&&"data"in ve.response.data&&"rescheduleBookingUnavailable"in ve.response.data.data&&ve.response.data.data.rescheduleBookingUnavailable===!0&&(I.value=!0,T.value=e.labels.booking_reschedule_exception,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500))),a("error")})}function ae(){B.value.calendarSlotsLoading=!0;let J=le(l.general.showClientTimeZone&&s.getters["cabinet/getTimeZone"]===Us()),ve=JSON.parse(JSON.stringify(e.appointment));ve.bookingStart=J.bookingStart,ve.bookings[0].utcOffset=J.utcOffset,ve.bookings[0].timeZone=J.timeZone,ve.providerId=parseInt(ye.value),ve.locationId=parseInt(pe.value),Ne.post("/bookings",ve,ze(s)).then(ge=>{B.value.calendarSlotsLoading=!1,Gr(s,ge),a("success",{message:v.value.booking_added_success})}).catch(ge=>{B.value.calendarSlotsLoading=!1,ge.response&&("customerAlreadyBooked"in ge.response.data.data&&ge.response.data.data.customerAlreadyBooked===!0&&(I.value=!0,T.value=e.labels.customer_already_booked_app,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500)),"timeSlotUnavailable"in ge.response.data.data&&ge.response.data.data.timeSlotUnavailable===!0&&(I.value=!0,T.value=e.labels.time_slot_unavailable,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500)),"packageBookingUnavailable"in ge.response.data.data&&ge.response.data.data.packageBookingUnavailable===!0&&(I.value=!0,T.value=e.labels.package_booking_unavailable,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500)),"customerBlocked"in ge.response.data.data&&ge.response.data.data.customerBlocked===!0&&(I.value=!0,T.value=e.labels.customer_blocked,setTimeout(function(){dt(_e.value,L.value.$el,0,300)},500))),a("error",ge)})}function xe(){oe.value?ie.value.validate(J=>{J?ae():setTimeout(()=>{dt(_e.value,ie.value.$el,0,300)},200)}):ae()}let ye=F(null),pe=F(null),Te=F(null);function Pe(J,ve){if(Te.value=ve,se.value=!1,!e.appointment.bookingStart){let Me=Ll(Object.keys(ve));return{calendarStartDate:Me[0],calendarEventSlots:[],calendarEventDate:Me[0],calendarEventSlot:null}}let ge=e.appointment.bookingStart.split(" ");return{calendarStartDate:ge[0],calendarEventSlots:ge[0]in ve?Object.keys(ve[ge[0]]):[],calendarEventDate:ge[0],calendarEventSlot:ge[1].slice(0,5)}}Be("useSlotsCallback",Pe),Be("useRange",()=>{if(!e.appointment.bookingStart)return{start:null,end:null};let J=e.appointment.bookingStart.split(" ")[0];return{start:he(J,"YYYY-MM-DD").startOf("month").subtract(6,"days").format("YYYY-MM-DD"),end:he(J,"YYYY-MM-DD").endOf("month").add(12,"days").format("YYYY-MM-DD")}}),Be("useSelectedDuration",()=>{});function Oe(){let J=Object.keys(Te.value[g.value]);J.length&&(ye.value=k.value&&Te.value[g.value][k.value]?Te.value[g.value][k.value][0].e:Te.value[g.value][J[0]][0].e,pe.value=k.value&&Te.value[g.value][k.value]?Te.value[g.value][k.value][0].l:Te.value[g.value][J[0]][0].l)}Be("useBusySlots",()=>[]),Be("useSelectedDate",(J,ve)=>(g.value=ve,e.appointment&&e.appointment.bookingStart&&(k.value=e.appointment.bookingStart.split(" ")[1].substring(0,5)),Oe(),Object.keys(Te.value[ve]))),Be("useSelectedTime",(J,ve)=>{k.value=ve.substring(0,5),g.value?Oe():e.appointment&&(g.value=e.appointment.bookingStart.split(" ")[0],Oe())}),Be("useDeselectedDate",()=>{g.value="",k.value="",ye.value=null,pe.value=null});let Re=R("amFonts"),ke=R("amColors"),Ue=_(()=>({"--am-c-csd-text":ke.value.colorMainText,"--am-c-csd-bgr":ke.value.colorMainBgr,"--am-c-csd-text-op10":H(ke.value.colorMainText,.1),"--am-c-scroll-op30":H(ke.value.colorPrimary,.3),"--am-c-scroll-op10":H(ke.value.colorPrimary,.1),"--am-font-family":Re.value.fontFamily}));return(J,ve)=>{const ge=yt,Me=et;return c(),U(za,{visibility:t(e).visibility,"custom-class":"am-csd am-csd__reschedule",style:be(t(Ue)),position:"center"},{footer:x(()=>[m("div",x_,[$(Se,{category:"secondary",size:t(E)<=360?"small":"default",type:t(e).customizedOptions.cancelBtn.buttonType,disabled:t(se)||t(z),onClick:Q},{default:x(()=>[ce(C(n.labels.cancel),1)]),_:1},8,["size","type","disabled"]),$(Se,{size:t(E)<=360?"small":"default",type:t(e).customizedOptions.continueBtn.buttonType,disabled:!!(t(se)||t(z)||!t(g)||!t(k)),onClick:W},{default:x(()=>[ce(C(n.labels.continue),1)]),_:1},8,["size","type","disabled"])])]),default:x(()=>[m("div",{ref_key:"popupInnerRef",ref:N,class:"am-csd__inner"},[m("div",b_,[m("div",k_,C(n.labels.no_selected_slot_requirements),1),m("div",{class:"am-csd__header-btn",onClick:Q},[$(We,{icon:"close"})])]),m("div",{ref_key:"rescheduleRef",ref:_e,class:"am-csd__content"},[t(I)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:L,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:w,onTriggerClose:w},{title:x(()=>[C_,ce(" "+C(t(T)),1)]),_:1},512)):O("",!0),t(oe)?(c(),U(Me,{key:1,ref_key:"packageFormRef",ref:ie,class:"am-csd__filter-wrapper",rules:t(K),model:t(j),"label-position":"top"},{default:x(()=>[m("div",{class:q(["am-csd__filter am-csd__filter-employee",t(h)])},[t(e).employees.length&&t(ne)&&t(e).customizedOptions.employee.visibility?(c(),U(ge,{key:0,class:q([{"am-csd__filter-full":!(t(e).locations.length&&t(te)&&t(e).customizedOptions.location.visibility)},t(h)]),label:`${t(v).package_appointment_employee}:`,prop:"employee"},{default:x(()=>[$(He,{modelValue:t(j).employee,"onUpdate:modelValue":ve[0]||(ve[0]=Ce=>t(j).employee=Ce),clearable:"",filterable:t(e).customizedOptions.employee.filterable,placeholder:`${t(v).package_select_employee}...`,"fit-input-width":!0,"popper-class":"am-csd__filter-employees",disabled:t(se),"filter-method":o,onChange:Ae},{default:x(()=>[(c(!0),y(ee,null,fe(t(r),Ce=>(c(),U(qe,{key:Ce.id,value:Ce.id,label:`${Ce.firstName} ${Ce.lastName}`},{default:x(()=>[$(Nc,{identifier:Ce.id,label:`${Ce.firstName} ${Ce.lastName}`,price:0,"image-thumb":Ce.pictureThumbPath,description:Ce.description,"dialog-title":t(v).employee_information_package,"dialog-button-text":t(v).select_this_employee_package,badge:Ce.badge,onClick:Ve},null,8,["identifier","label","image-thumb","description","dialog-title","dialog-button-text","badge"])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","filterable","placeholder","disabled"])]),_:1},8,["class","label"])):O("",!0),t(e).locations.length&&t(te)&&t(e).customizedOptions.location.visibility?(c(),U(ge,{key:1,class:q([{"am-csd__filter-full":!(t(e).employees.length&&t(ne)&&t(e).customizedOptions.employee.visibility)},t(h)]),label:`${t(v).package_appointment_location}:`,prop:"location"},{default:x(()=>[$(He,{modelValue:t(j).location,"onUpdate:modelValue":ve[1]||(ve[1]=Ce=>t(j).location=Ce),clearable:"",filterable:t(e).customizedOptions.location.filterable,placeholder:`${t(v).package_select_location}...`,"fit-input-width":!0,disabled:t(se),"filter-method":d,onChange:Ae},{default:x(()=>[(c(!0),y(ee,null,fe(t(f),Ce=>(c(),U(qe,{key:Ce.id,value:Ce.id,label:Ce.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","filterable","placeholder","disabled"])]),_:1},8,["class","label"])):O("",!0)],2)]),_:1},8,["rules","model"])):O("",!0),t(e).appointment!==null?(c(),U(Zr,{key:2,id:0,ref_key:"calendarRef",ref:B,"preselect-slot":!1,"load-counter":t(G),"end-time":t(e).customizedOptions.endTimeVisibility.visibility,"time-zone":t(e).customizedOptions.timeZoneVisibility.visibility,"show-estimated-pricing":t(e).appointment.id&&"estimatedPricingVisibility"in t(e).customizedOptions?t(e).customizedOptions.estimatedPricingVisibility.visibility:!1,"show-indicator-pricing":t(e).appointment.id&&"indicatorPricingVisibility"in t(e).customizedOptions?t(e).customizedOptions.indicatorPricingVisibility.visibility:!1,"show-slot-pricing":t(e).appointment.id&&"slotPricingVisibility"in t(e).customizedOptions?t(e).customizedOptions.slotPricingVisibility.visibility:!1,"label-slots-selected":n.labels.date_time_slots_selected,"fetched-slots":null,"service-id":parseInt(t(e).appointment.serviceId),"is-package":t(e).appointment.bookings[0].packageCustomerService!==null,date:t(e).appointment&&t(e).appointment.bookingStart?t(e).appointment.bookingStart.split(" ")[0]:"","slots-params":t(me)},null,8,["load-counter","end-time","time-zone","show-estimated-pricing","show-indicator-pricing","show-slot-pricing","label-slots-selected","service-id","is-package","date","slots-params"])):O("",!0)],512)],512)]),_:1},8,["visibility","style"])}}});const T_={class:"am-csd__inner"},S_={class:"am-csd__header"},E_={class:"am-csd__header-text"},L_={class:"am-csd__content"},A_={class:"am-ccpss__heading"},I_={class:"am-csd__footer"},$_={name:"CancelBooking"},Ua=Object.assign($_,{props:{visibility:{type:Boolean,required:!0},title:{type:String,default:""},description:{type:String,default:""},closeBtnText:{type:String,required:!0},confirmBtnText:{type:String,required:!0},loading:{type:Boolean,default:!1},count:{type:Number,default:1},customizedOptions:{type:Object,required:!0}},emits:["close","confirm","decline"],setup(n,{emit:a}){const e=n;let s=R("containerWidth"),l=R("amFonts"),i=R("amColors"),o=_(()=>({"--am-c-csd-text":i.value.colorMainText,"--am-c-csd-bgr":i.value.colorMainBgr,"--am-font-family":l.value.fontFamily}));return(r,u)=>{const d=Ml,f=Fl;return c(),U(za,{visibility:t(e).visibility,"custom-class":"am-csd am-csd__cancel",style:be(t(o)),position:"center"},{footer:x(()=>[m("div",I_,[$(Se,{category:"secondary",size:t(s)<=360?"small":"default",type:n.customizedOptions.cancelBtn.buttonType,disabled:n.loading,onClick:u[1]||(u[1]=()=>{a("decline")})},{default:x(()=>[ce(C(t(e).closeBtnText),1)]),_:1},8,["size","type","disabled"]),$(Se,{category:"danger",size:t(s)<=360?"small":"default",type:n.customizedOptions.confirmBtn.buttonType,disabled:n.loading,onClick:u[2]||(u[2]=()=>{a("confirm")})},{default:x(()=>[ce(C(t(e).confirmBtnText),1)]),_:1},8,["size","type","disabled"])])]),default:x(()=>[m("div",T_,[n.loading?(c(),U(f,{key:1,animated:"",class:"am-ccpss"},{template:x(()=>[m("div",A_,[$(d,{variant:"rect"})]),(c(!0),y(ee,null,fe(new Array(t(e).count),v=>(c(),y("div",{key:v,class:"am-ccpss__text"},[$(d,{variant:"rect"})]))),128))]),_:1})):(c(),y(ee,{key:0},[m("div",S_,[m("div",E_,C(t(e).title),1),m("div",{class:"am-csd__header-btn",onClick:u[0]||(u[0]=()=>{a("close")})},[$(We,{icon:"close"})])]),m("div",L_,[m("p",null,C(t(e).description),1)])],64))])]),_:1},8,["visibility","style"])}}});const P_={name:"CabinetAppointmentsList"},xr=Object.assign(P_,{props:{groupedAppointments:{type:Object,default:null},responsiveClass:{type:String,default:""},pageWidth:{type:Number},isPackageBooking:{type:Boolean,default:!1},stepKey:{type:String,required:!0}},emits:["booked","canceled","editAppointment","statusChange"],setup(n,{emit:a}){const e=n;let s=De(),l=R("originKey");const i=R("settings");let o=R("amLabels"),r=R("cabinetType"),u=F(null),d=F(null),f=F(null);function v(z=null){d.value=null,a("booked",z)}let g=F(!1);function k(){g.value=!0,Ne.post("/bookings/cancel/"+u.value.id,{type:"appointment"},Object.assign(ze(s),{params:{source:"cabinet-"+r.value}})).then(()=>{u.value=null,a("canceled",{message:o.value.appointment_canceled})}).catch(z=>{console.log(z)}).finally(()=>{g.value=!1})}function N(z){let D={total:0,bookable:0,discount:0,tax:0};return z.bookings.forEach(G=>{if(G.status==="approved"||G.status==="pending"){let se=di(s,{price:G.price,persons:G.persons,aggregatedPrice:G.aggregatedPrice,extras:G.extras,tax:G.tax,coupon:G.coupon},!1);D.total+=se.total,D.bookable+=se.bookable,D.discount+=se.discount,D.tax+=se.tax}}),D.total-D.discount+D.tax}function E(z){let D=[],G=0,se=z;se.bookings.forEach(ne=>{ne.extras.forEach(te=>{D.push({id:te.extraId,quantity:te.quantity})}),"duration"in ne&&ne.duration&&ne.duration>G&&(ne.status==="approved"||ne.status==="pending")&&(G=ne.duration)});let j={serviceId:se.serviceId,serviceDuration:G||null,locationId:se.locationId,providerIds:[se.providerId],extras:JSON.stringify(D),excludeAppointmentId:se.isGroup?null:se.id,group:1,timeZone:s.getters["cabinet/getTimeZone"],page:"cabinet",structured:!0};d.value=z,f.value=j}function b(z){return s.getters["entities/getEmployee"](z)}function A(z){return z.bookings.filter(D=>D.status!=="rejected"&&D.status!=="canceled").map(D=>{if("info"in D&&D.info){let G="customer"in D?D.customer:{};return Object.assign(G,JSON.parse(D.info))}else return D.customer})}let S=R("amCustomize");const P=R("labels"),h=R("localLanguage");let I=_(()=>i.general.usedLanguages.includes(h.value));function L(z){let D=Qe({...P}),G=S.value[z].translations;return G&&Object.keys(G).forEach(se=>{G[se][h.value]&&I.value?D[se]=G[se][h.value]:G[se].default&&(D[se]=G[se].default)}),D}function T(z){return S.value[z].options}let w=R("amColors"),B=_(()=>({"--am-c-capa-bgr":w.value.colorMainBgr,"--am-c-capa-text":w.value.colorMainText,"--am-c-capa-text-op70":H(w.value.colorMainText,.7),"--am-c-capa-text-op25":H(w.value.colorMainText,.25),"--am-c-capa-primary":w.value.colorPrimary}));return(z,D)=>(c(),y(ee,null,[m("div",{class:q(["am-capa__wrapper",[{"am-no-border":t(e).groupedAppointments&&Object.keys(t(e).groupedAppointments).length===1},t(e).responsiveClass]]),style:be(t(B))},[(c(!0),y(ee,null,fe(t(e).groupedAppointments,(G,se)=>(c(),y("div",{key:se,class:"am-capa"},[m("div",{class:q(["am-capa__date",[{"am-today":t(nt)(se)===t(nt)(t(Ke)().format("YYYY-MM-DD"))},{"am-no-flag":t(e).groupedAppointments&&Object.keys(t(e).groupedAppointments).length===1},t(e).responsiveClass]])},C(t(nt)(se)),3),(c(!0),y(ee,null,fe(G.appointments,(j,ne)=>(c(),y(ee,{key:ne},[t(s).getters["entities/getService"](j.serviceId)?(c(),U(kr,{key:0,start:t(vs)(j.bookingStart.split(" ")[1].slice(0,5)),name:t(s).getters["entities/getService"](j.serviceId).name,employee:b(j.provider.id),customers:A(j),price:N(j),duration:t(uh)(t(s),j),periods:[],extras:t(dh)(j.bookings,t(s).getters["entities/getService"](j.serviceId)),tickets:[],"custom-fields":t(_r)(j.bookings,t(r)),location:j.locationId?t(s).getters["entities/getLocation"](j.locationId):null,"google-meet-link":j.googleMeetUrl,"microsoft-teams-link":j.microsoftTeamsUrl,"zoom-link":j.zoomMeeting?j.zoomMeeting.joinUrl:"","lesson-space-link":j.lessonSpace,bookable:j.service,reservation:j,booking:j.bookings[0],"is-package-booking":t(e).isPackageBooking,"responsive-class":t(e).responsiveClass,"parent-width":t(e).pageWidth,"customized-options":T(t(e).stepKey),onCancelBooking:D[0]||(D[0]=te=>{we(u)?u.value=te:u=te}),onRescheduling:E,onEditAppointment:D[1]||(D[1]=te=>{t(a)("editAppointment",te)}),onStatusChange:D[2]||(D[2]=(te,oe)=>t(a)("statusChange",te,oe))},null,8,["start","name","employee","customers","price","duration","extras","custom-fields","location","google-meet-link","microsoft-teams-link","zoom-link","lesson-space-link","bookable","reservation","booking","is-package-booking","responsive-class","parent-width","customized-options"])):O("",!0)],64))),128))]))),128))],6),t(l)==="capc"?(c(),U(Ua,{key:0,visibility:t(u)!==null,title:L("cancelAppointment").cancel_appointment,description:L("cancelAppointment").confirm_cancel_appointment,"close-btn-text":L("cancelAppointment").close,"confirm-btn-text":L("cancelAppointment").confirm,"customized-options":T("cancelAppointment"),loading:t(g),onClose:D[3]||(D[3]=G=>we(u)?u.value=null:u=null),onDecline:D[4]||(D[4]=G=>we(u)?u.value=null:u=null),onConfirm:k},null,8,["visibility","title","description","close-btn-text","confirm-btn-text","customized-options","loading"])):O("",!0),t(l)==="capc"?(c(),U(Cr,{key:1,visibility:t(d)!==null,appointment:t(d),"slots-params":t(f),labels:L("rescheduleAppointment"),"customized-options":T("rescheduleAppointment"),onClose:D[5]||(D[5]=G=>we(d)?d.value=null:d=null),onSuccess:v,onError:D[6]||(D[6]=()=>{})},null,8,["visibility","appointment","slots-params","labels","customized-options"])):O("",!0)],64))}});const D_={style:{float:"right"}},N_={class:"am-capai-def__notify"},O_=["innerHTML"],M_={class:"am-capai-def__notify"},F_=["innerHTML"],V_={props:{slotsProps:{type:Object,required:!0},slotsLoading:{type:Boolean,required:!0},isDisabledDate:{type:Function,required:!0},freeSlots:{type:Object,required:!0},times:{type:Array,required:!0},getFreeTimes:{type:Function,required:!0}},emits:["removeSlots","fetchSlots","changedSlotCondition","getSelectedDatesTimes","filterOut","getFreeTimes","selectDate","selectTime"],setup(n,{expose:a,emit:e}){const s=n;let l=De(),i=R("amLabels"),o=R("localLanguage");const r=R("settings");let u=R("licence"),d=R("slotsPricing");function f(M){return""}let v=M=>{let Z=he(M).format("YYYY-MM-DD");return Z in d.value?"am-slots-"+d.value[Z].type:""};const g=F(null);let{width:k}=ja(g),N=_(()=>st(k.value)),E=F({categoryId:_({get:()=>l.getters["appointment/getCategoryId"],set:M=>{l.commit("appointment/setCategoryId",M||null)}}),serviceId:_({get:()=>l.getters["appointment/getServiceId"],set:M=>{l.commit("appointment/setServiceId",M||null)}}),providerId:_({get:()=>l.getters["appointment/getProviderId"],set:M=>{l.commit("appointment/setProviderId",M||null)}}),locationId:_({get:()=>l.getters["appointment/getLocationId"],set:M=>{l.commit("appointment/setLocationId",M||null)}}),lessonSpace:_({get:()=>l.getters["appointment/getLessonSpace"],set:M=>{l.commit("appointment/setLessonSpace",M||"")}}),startDate:_({get:()=>l.getters["appointment/getStartDate"],set:M=>{l.commit("appointment/setStartDate",M||"")}}),startTime:_({get:()=>l.getters["appointment/getStartTime"],set:M=>{l.commit("appointment/setStartTime",M||"")}}),notifyParticipants:_({get:()=>l.getters["appointment/getNotifyParticipants"],set:M=>{l.commit("appointment/setNotifyParticipants",M)}}),createPaymentLinks:_({get:()=>l.getters["appointment/getCreatePaymentLinks"],set:M=>{l.commit("appointment/setCreatePaymentLinks",M)}}),internalNotes:_({get:()=>l.getters["appointment/getInternalNotes"],set:M=>{l.commit("appointment/setInternalNotes",M||"")}})}),b=_(()=>({serviceId:[{required:!0,message:i.value.please_select_service,trigger:["submit","change"]}],startDate:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}],startTime:[{required:!0,message:i.value.select_time_warning,trigger:["submit","change"]}]})),A=_(()=>l.getters["entities/filteredCategories"](l.getters["appointment/getSelection"])),S=F(l.getters["entities/filteredCategories"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),P=F("");function h(M){P.value=M.toLowerCase()}let I=_(()=>P.value?S.value.filter(M=>M.name.toLowerCase().includes(P.value)):S.value),L=_(()=>l.getters["entities/filteredServices"](l.getters["appointment/getSelection"])),T=F(l.getters["entities/filteredServices"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null}));function w(M){let Z=l.getters["entities/getService"](M),W=Z&&Z.settings?JSON.parse(Z.settings):null,le=W&&"payments"in W&&W.payments&&"paymentLinks"in W.payments&&W.payments.paymentLinks?W.payments.paymentLinks:r.payments.paymentLinks;return le&&le.enabled}let B=F("");function z(M){B.value=M.toLowerCase()}let D=_(()=>B.value?T.value.filter(M=>M.name.toLowerCase().includes(B.value)):T.value),G=_(()=>l.getters["appointment/getId"]&&l.getters["appointment/getServiceId"]&&T.value.map(M=>M.id).indexOf(l.getters["appointment/getServiceId"])===-1?l.getters["entities/getService"](l.getters["appointment/getServiceId"]):null),se=_(()=>l.getters["entities/filteredLocations"](l.getters["appointment/getSelection"])),j=F(l.getters["entities/filteredLocations"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),ne=F("");function te(M){ne.value=M.toLowerCase()}let oe=_(()=>ne.value?j.value.filter(M=>M.name.toLowerCase().includes(ne.value)):j.value),ie=_(()=>l.getters["appointment/getId"]&&l.getters["appointment/getLocationId"]&&j.value.map(M=>M.id).indexOf(l.getters["appointment/getLocationId"])===-1?l.getters["entities/getLocation"](l.getters["appointment/getLocationId"]):null),K=F(l.getters["entities/getSpaces"]);function me(){l.commit("appointment/setTargetedDate",null),l.commit("appointment/setStartDate",null),l.commit("appointment/setStartTime",null),e("removeSlots")}function Ae(M,Z=null,W=!1){let le=l.getters["appointment/getTargetedDate"];!M&&!le?M=he().toDate():!M&&le&&(M=le),l.commit("appointment/setTargetedDate",M&&W?M:le),E.value.serviceId&&e("fetchSlots",M,Z,W)}function Ve(){E.value.startDate&&Ae(E.value.startDate)}function Q(M){e("selectTime",M)}function _e(M){M?e("selectDate",M):me()}function X(M){M?(clearTimeout(this.searchSpacesTimer),l.commit("auth/setSpacesLoading",!0),Ne.get("/entities",{params:{types:["spaces"],lessonSpaceSearch:M}}).then(Z=>{K.value=Z.data.data.spaces}).catch(Z=>{console.log(Z)}).finally(()=>{l.commit("auth/setSpacesLoading",!1)})):K.value=l.getters["entities/getSpaces"]}return rt(()=>E.value.serviceId,M=>{l.dispatch("appointment/updateEmployeeService",M||null),M&&(l.dispatch("appointment/recreateAllBookingCustomFields",{label:i.value.required_field}),Ve())}),Je(()=>{T.value.length===1&&!l.getters["appointment/getId"]&&l.commit("appointment/setServiceId",T.value[0].id),j.value.length===1&&!l.getters["appointment/getId"]&&l.commit("appointment/setLocationId",j.value[0].id)}),a({detailsFormRef:g}),(M,Z)=>{const W=yt,le=Vl,de=et;return c(),U(de,{ref_key:"detailsFormRef",ref:g,model:t(E),rules:t(b),class:"am-capai-def"},{default:x(()=>[t(S).length>1?(c(),U(W,{key:0,label:`${t(i).category}`,class:"am-capai-def__item"},{default:x(()=>[$(He,{modelValue:t(E).categoryId,"onUpdate:modelValue":Z[0]||(Z[0]=ae=>t(E).categoryId=ae),clearable:"",filterable:"",placeholder:`${t(i).select_service_category}`,"filter-method":h},{default:x(()=>[(c(!0),y(ee,null,fe(t(I),ae=>(c(),U(qe,{key:ae.id,value:ae.id,label:ae.name,disabled:t(E).serviceId&&typeof t(A).find(xe=>xe.id===ae.id)>"u"},null,8,["value","label","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):O("",!0),$(W,{label:`${t(i).services_dropdown}`,prop:"serviceId",class:"am-capai-def__item"},{default:x(()=>[$(He,{modelValue:t(E).serviceId,"onUpdate:modelValue":Z[1]||(Z[1]=ae=>t(E).serviceId=ae),disabled:t(T).length===1,clearable:"",filterable:"",placeholder:`${t(i).select_service}`,"filter-method":z},{default:x(()=>[(c(!0),y(ee,null,fe(t(D),ae=>(c(),U(qe,{key:ae.id,value:ae.id,label:ae.name,disabled:typeof t(L).find(xe=>xe.id===ae.id)>"u"},null,8,["value","label","disabled"]))),128)),t(G)?(c(),U(qe,{key:t(G).id,value:t(G).id,label:t(G).name},null,8,["value","label"])):O("",!0)]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),!t(u).isStarter&&t(j).length>1?(c(),U(W,{key:1,label:`${t(i).location}`,class:"am-capai-def__item"},{default:x(()=>[$(He,{modelValue:t(E).locationId,"onUpdate:modelValue":Z[2]||(Z[2]=ae=>t(E).locationId=ae),disabled:t(j).length===1,clearable:"",filterable:"",placeholder:`${t(i).select_location}`,"filter-method":te,onChange:Ve},{default:x(()=>[(c(!0),y(ee,null,fe(t(oe),ae=>(c(),U(qe,{key:ae.id,value:ae.id,label:ae.name,disabled:t(ie)===null&&typeof t(se).find(xe=>xe.id===ae.id)>"u"},null,8,["value","label","disabled"]))),128)),t(ie)?(c(),U(qe,{key:t(ie).id,value:t(ie).id,label:t(ie).name},null,8,["value","label"])):O("",!0)]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])):O("",!0),t(r).lessonSpace.enabled?(c(),U(W,{key:2,label:`${t(i).lesson_space}`,class:"am-capai-def__item"},{default:x(()=>[$(He,{modelValue:t(E).lessonSpace,"onUpdate:modelValue":Z[3]||(Z[3]=ae=>t(E).lessonSpace=ae),filterable:"",clearable:"",remote:"","remote-method":X,placeholder:`${t(i).select}`},{default:x(()=>[(c(),U(qe,{key:0,value:0,label:t(i).lesson_space_new_space},null,8,["label"])),(c(!0),y(ee,null,fe(t(K),ae=>(c(),U(qe,{key:ae.id,value:ae.id,label:ae.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):O("",!0),$(W,{label:`${t(i).date}`,prop:"startDate",class:q(["am-capai-def__item am-w-50",t(N)])},{default:x(()=>[$(Yt,{modelValue:t(E).startDate,"onUpdate:modelValue":Z[4]||(Z[4]=ae=>t(E).startDate=ae),type:"date",format:t(jt)(),placeholder:t(i).select_date,clearable:!0,lang:t(o),disabled:!t(E).serviceId,"disabled-date":(ae,xe)=>t(s).isDisabledDate(ae,null,!0,xe),"popper-class":n.slotsLoading?"am-slots-loader":"","cell-class-name":t(v),onPanelChange:Z[5]||(Z[5]=ae=>{Ae(ae,null,!0)}),onChange:_e,onFocus:Z[6]||(Z[6]=ae=>t(E).serviceId&&!t(E).startDate?Ae(null,null,!0):!1)},null,8,["modelValue","format","placeholder","lang","disabled","disabled-date","popper-class","cell-class-name"])]),_:1},8,["label","class"]),$(W,{label:`${t(i).time}`,prop:"startTime",class:q(["am-capai-def__item am-w-50",t(N)])},{default:x(()=>[$(He,{modelValue:t(E).startTime,"onUpdate:modelValue":Z[7]||(Z[7]=ae=>t(E).startTime=ae),placeholder:`${t(i).select_time}`,disabled:!t(E).startDate,"prefix-icon":"clock",onChange:Q},{default:x(()=>[(c(!0),y(ee,null,fe(t(s).getFreeTimes(null,{date:t(E).startDate,times:t(s).times,time:t(E).startTime},!0),ae=>(c(),U(qe,{key:ae,value:ae,label:ae},{default:x(()=>[ce(C(t(vs)(ae))+" ",1),m("span",D_,C(f()),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label","class"]),$(W,{class:"am-capai-def__item"},{default:x(()=>[m("div",N_,[$(mt,{modelValue:t(E).notifyParticipants,"onUpdate:modelValue":Z[8]||(Z[8]=ae=>t(E).notifyParticipants=ae),label:t(i).notify_customers},null,8,["modelValue","label"]),$(le,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(i).notify_customers_tooltip},null,8,O_)]),default:x(()=>[$(We,{icon:"info-reverse"})]),_:1})])]),_:1}),t(E).notifyParticipants&&t(E).serviceId&&w(t(E).serviceId)?(c(),U(W,{key:3,class:"am-capai-def__item"},{default:x(()=>[m("div",M_,[$(mt,{modelValue:t(E).createPaymentLinks,"onUpdate:modelValue":Z[9]||(Z[9]=ae=>t(E).createPaymentLinks=ae),label:t(i).generate_payment_links},null,8,["modelValue","label"]),$(le,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(i).generate_payment_links_tooltip},null,8,F_)]),default:x(()=>[$(We,{icon:"info-reverse"})]),_:1})])]),_:1})):O("",!0),$(W,{label:`${t(i).note_internal}`,class:"am-capai-def__item"},{default:x(()=>[$(it,{modelValue:t(E).internalNotes,"onUpdate:modelValue":Z[10]||(Z[10]=ae=>t(E).internalNotes=ae),type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])}}};function wr(n,a){return Object.assign({},a,{gender:a.gender?a.gender:"",note:a.note?a.note:"",phone:a.phone?a.phone:"",birthday:a.birthday?he(a.birthday.date.split(" ")[0]).toDate():null,translations:a.translations?JSON.parse(a.translations):{defaultLanguage:""}})}function B_(n){let a=n.getters["customerInfo/getCustomer"];return Object.assign({},a,{birthday:a.birthday?he(a.birthday).format("YYYY-MM-DD"):null,translations:a.translations.defaultLanguage?JSON.stringify(a.translations):null})}const R_=m("span",{class:"am-icon-triangle-info"},null,-1),q_={key:0,class:"am-capai-warn__content"},U_={key:0,class:"am-capai-warn__heading"},z_={key:1,class:"am-capai-warn__text"},Tr={props:{heading:{type:String,default:""},text:{type:String,default:""}},setup(n){const a=n;let e=R("amColors"),s=_(()=>({"--am-c-warning":e.value.colorWarning,"--am-c-warning-op10":H(e.value.colorWarning,.1),"--am-c-main-text":e.value.colorMainText,"--am-c-main-text-op10":H(e.value.colorMainText,.1)}));return(l,i)=>(c(),y("div",{class:"am-capai-warn",style:be(t(s))},[R_,a.heading||a.text?(c(),y("div",q_,[a.heading?(c(),y("div",U_,C(a.heading),1)):O("",!0),a.text?(c(),y("div",z_,C(a.text),1)):O("",!0)])):O("",!0)],4))}};const j_={class:"am-cap-aec__header"},Y_=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),Sr={props:{visibility:{type:Boolean,required:!0},customCss:{type:Object,default:()=>{}},responsiveClass:{type:String,default:""}},emits:["update:visibility","addedCustomer"],setup(n,{emit:a}){const e=n,s=R("settings");let l=R("amLabels");const i=De();let o=F("details"),r=F(null),u=F(!1),d=F("success"),f=F("");function v(){u.value=!1,i.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}let g=_(()=>i.getters["customerInfo/getCustomerId"]),k=_(()=>{let j=[];return s.wordpress.locale in i.getters["entities/getSettings"].languages&&j.push({value:i.getters["entities/getSettings"].languages[s.wordpress.locale].wp_locale,label:i.getters["entities/getSettings"].languages[s.wordpress.locale].name}),s.general.usedLanguages.forEach(ne=>{ne in i.getters["entities/getSettings"].languages&&j.push({value:i.getters["entities/getSettings"].languages[ne].wp_locale,label:i.getters["entities/getSettings"].languages[ne].name})}),j}),N=F(null),E=F(!1),b=F({firstName:_({get:()=>i.getters["customerInfo/getCustomerFirstName"],set:j=>{i.commit("customerInfo/setCustomerFirstName",j||"")}}),lastName:_({get:()=>i.getters["customerInfo/getCustomerLastName"],set:j=>{i.commit("customerInfo/setCustomerLastName",j||"")}}),email:_({get:()=>i.getters["customerInfo/getCustomerEmail"],set:j=>{i.commit("customerInfo/setCustomerEmail",j||"")}}),phone:_({get:()=>i.getters["customerInfo/getCustomerPhone"],set:j=>{i.commit("customerInfo/setCustomerPhone",j||"")}}),language:_({get:()=>i.getters["customerInfo/getCustomerLanguage"],set:j=>{i.commit("customerInfo/setCustomerLanguage",j||"")}}),gender:_({get:()=>i.getters["customerInfo/getCustomerGender"],set:j=>{i.commit("customerInfo/setCustomerGender",j||"")}}),birthday:_({get:()=>i.getters["customerInfo/getCustomerBirthday"]||"",set:j=>{i.commit("customerInfo/setCustomerBirthday",j?he(j).format("YYYY-MM-DD"):"")}}),note:_({get:()=>i.getters["customerInfo/getCustomerNote"],set:j=>{i.commit("customerInfo/setCustomerNote",j||"")}})}),A=F({firstName:[{required:!0,message:l.value.enter_first_name_warning,trigger:["submit","blur"]}],lastName:[{required:!0,message:l.value.enter_last_name_warning,trigger:["submit","blur"]}]}),S=F({firstName:{template:Ye.text,props:{itemName:"firstName",label:l.value.first_name_colon,placeholder:l.value.enter_first_name,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="user"/>'})}},lastName:{template:Ye.text,props:{itemName:"lastName",label:l.value.last_name_colon,placeholder:l.value.enter_last_name,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="user"/>'})}},email:{template:Ye.text,props:{itemName:"email",label:l.value.email_colon,placeholder:l.value.enter_email,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="email"/>'})}},phone:{countryPhoneIso:_({get:()=>i.getters["customerInfo/getCustomerCountryPhoneIso"]||"",set:j=>{i.commit("customerInfo/setCustomerCountryPhoneIso",j?j.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:l.value.phone_colon,placeholder:l.value.enter_phone,defaultCode:_(()=>i.getters["customerInfo/getCustomerCountryPhoneIso"]?i.getters["customerInfo/getCustomerCountryPhoneIso"]:s.general.phoneDefaultCountryCode&&s.general.phoneDefaultCountryCode!=="auto"?s.general.phoneDefaultCountryCode:""),phoneError:_(()=>E.value),whatsAppLabel:l.value.whatsapp_opt_in_text,isWhatsApp:s.notifications.whatsAppEnabled&&s.notifications.whatsAppAccessToken&&s.notifications.whatsAppBusinessID&&s.notifications.whatsAppPhoneID,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}},language:{template:Ye.select,props:{itemName:"language",label:l.value.notification_language,placeholder:l.value.language,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:`
          <IconComponent icon="pennant"/>`}),options:k.value}},gender:{template:Ye.select,props:{itemName:"gender",label:l.value.gender,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:`
          <IconComponent icon="gender"/>`}),options:[{label:l.value.female,value:"female"},{label:l.value.male,value:"male"}]}},birthday:{template:Ye.datepicker,props:{itemName:"birthday",label:l.value.date_of_birth,placeholder:l.value.enter_date_of_birth,clearable:!0,readonly:!1,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}},note:{template:Ye["text-area"],props:{itemName:"note",label:l.value.note_internal,itemType:"textarea",class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}}});function P(){i.dispatch("customerInfo/resetCustomer"),a("update:visibility",!1)}let h=_(()=>i.getters["customerInfo/getLoading"]);function I(){N.value.validate(j=>{if(!j){o.value="details";return}i.commit("customerInfo/setLoading",!0);let ne=B_(i);const te={};for(const oe in B){const ie=B[oe],K=T[oe];te[oe]={label:ie.label,type:ie.type,value:typeof K=="string"?K.trim():K}}ne.customFields=JSON.stringify(te),Ne.post("/users/customers"+(ne.id?"/"+ne.id:""),ne,Object.assign(ze(i),{params:{source:"cabinet-provider"}})).then(oe=>{i.commit("auth/setPreloadedCustomers",i.getters["auth/getPreloadedCustomers"].concat([oe.data.data.user]).sort((ie,K)=>ie.id-K.id)),a("addedCustomer",oe.data.data.user),P()}).catch(oe=>{"response"in oe&&oe.response&&(f.value=oe.response.data.message,u.value=!0)}).finally(()=>{i.commit("customerInfo/setLoading",!1)})})}Jr(()=>{g.value!==null&&D()});const L=F(null),T=Qe({}),w=Qe({}),B=Qe({});function z(j,ne){if(w[ne]={template:Ye[j.type],props:{id:ne,itemName:ne.toString(),label:j.label,options:j.options,class:`am-cap-aec-cf__item am-cf-width-${j.width}`}},j.type==="text-area"&&(w[ne].props.itemType="textarea"),j.type==="datepicker"&&(w[ne].props.weekStartsFromDay=s.wordpress.startOfWeek),j.type==="file"){let te=i.getters["auth/getProfile"]?i.getters["auth/getProfile"].id:null;w[ne].props={...w[ne].props,btnLabel:l.value.upload_file_here,isUpload:!0,bookingId:te,source:"cabinet-customer"}}}function D(){const j=i.getters["entities/getCustomFields"],ne=_(()=>{const te=i.getters["customerInfo/getCustomerCustomFields"];return te?JSON.parse(te):null});j.filter(te=>te.saveType==="customer"&&te.type!=="content").forEach(te=>{const{id:oe}=te,ie=g.value&&ne.value?ne.value[oe]?.value:null;B[oe]={...te,value:ie??(te.type==="checkbox"||te.type==="file"?[]:"")},T[oe]=B[oe].value??"",z(te,oe)})}let G=R("amColors"),se=_(()=>({"--am-c-aec-text":G.value.colorMainText}));return(j,ne)=>{const te=et,oe=va,ie=_a;return c(),U(za,{visibility:e.visibility,position:"center","custom-class":"am-slide-popup-aec","custom-css":{...n.customCss,...t(se)},"onUpdate:visibility":P},{header:x(()=>[m("div",j_,[t(g)?(c(),y(ee,{key:0},[ce(C(t(l).edit_customer),1)],64)):(c(),y(ee,{key:1},[ce(C(t(l).add_customer),1)],64))])]),footer:x(()=>[$(Se,{type:"plain",category:"secondary",onClick:P},{default:x(()=>[ce(C(t(l).cancel),1)]),_:1}),$(Se,{onClick:I},{default:x(()=>[ce(C(t(l).save),1)]),_:1})]),default:x(()=>[t(u)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:r,type:t(d),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:v,onTriggerClose:v},{title:x(()=>[Y_,ce(" "+C(t(f)),1)]),_:1},8,["type"])):O("",!0),t(h)?(c(),U(Wt,{key:2})):(c(),U(ie,{key:1,modelValue:t(o),"onUpdate:modelValue":ne[0]||(ne[0]=K=>we(o)?o.value=K:o=K)},{default:x(()=>[$(oe,{class:"am-cap__tabs-item",label:t(l).details,name:"details"},{default:x(()=>[$(te,{ref_key:"customerFormRef",ref:N,model:t(b),rules:t(A),"label-position":"top",class:"am-cap-aec__form"},{default:x(()=>[(c(!0),y(ee,null,fe(t(S),(K,me)=>(c(),U(pt(K.template),Lt({key:me},K.props,{modelValue:t(b)[me],"onUpdate:modelValue":Ae=>t(b)[me]=Ae,countryPhoneIso:K.countryPhoneIso,"onUpdate:countryPhoneIso":Ae=>K.countryPhoneIso=Ae}),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"]))),128))]),_:1},8,["model","rules"])]),_:1},8,["label"]),Object.keys(t(B)).length?(c(),U(oe,{key:0,class:"am-cap__tabs-item",label:t(l).custom_fields,name:"customFields"},{default:x(()=>[t(h)?O("",!0):(c(),U(te,{key:0,ref_key:"customFieldsFormRef",ref:L,model:t(T),"label-position":"top",class:q(["am-cap-aec__form",n.responsiveClass])},{default:x(()=>[(c(!0),y(ee,null,fe(Object.keys(t(B)),K=>(c(),y(ee,{key:K},[K in t(T)?(c(),U(pt(t(w)[K]?.template),Lt({key:0,modelValue:t(T)[K],"onUpdate:modelValue":me=>t(T)[K]=me},t(w)[K]?.props),null,16,["modelValue","onUpdate:modelValue"])):O("",!0)],64))),128))]),_:1},8,["model","class"]))]),_:1},8,["label"])):O("",!0)]),_:1},8,["modelValue"]))]),_:1},8,["visibility","custom-css"])}}};const W_={class:"am-cap__cust-option"},H_={class:"am-cap__cust-option__heading"},Z_={key:0,class:"am-cap__cust-option__inner"},G_={key:1,class:"am-cap__cust-option__inner"},J_={class:"am-capai-cuf__content"},X_={class:"am-capai-cuf__bulk-label"},Q_={key:0,class:"am-capai-customer__data"},K_=m("span",{class:"am-icon-phone"},null,-1),ey=["href"],ty={key:1,class:"am-capai-customer__data"},ay=m("span",{class:"am-icon-email"},null,-1),sy=["href"],ly={props:{responsiveClass:{type:String,default:""},capacityWarning:{type:String,default:""},appointmentCapacity:{type:Number,default:0},savedAppointment:{type:Object,default:()=>{}}},emits:["changedSlotCondition"],setup(n,{expose:a,emit:e}){const s=n;let l=De();const i=R("shortcodeData"),o=R("settings");let r=R("amCustomize"),u=R("amLabels"),d=R("pageWidth"),f=_(()=>l.getters["appointment/getEmployeeService"]),v=F(null),g=F({customersIds:_({get:()=>l.getters["customerInfo/getCustomersIds"],set:K=>l.commit("customerInfo/setCustomersIds",K)})}),k=F({customersIds:[{required:!0,message:u.value.select_customers,trigger:["submit","change"]}]}),N=_(()=>l.getters["customerInfo/getLoading"]),E=_(()=>l.getters["customerInfo/getCustomers"]),b=F(o.general.defaultAppointmentStatus),A=_(()=>br().filter(K=>l.getters["appointment/getId"]?K.value!=="waiting":(K.value==="approved"||K.value==="pending")&&K.value!=="no-show")),S=_(()=>l.getters["appointment/getBookings"]?l.getters["appointment/getBookings"]:[]),P=F(!1);function h(K){l.commit("customerInfo/setCustomersIds",[K.id].concat(l.getters["customerInfo/getCustomersIds"])),l.commit("customerInfo/setCustomers",[K].concat(l.getters["customerInfo/getCustomers"])),I()}function I(){let K=l.getters["appointment/getBookings"].map(X=>parseInt(X.customer.id)),me=!1,Ae=f.value.settings?JSON.parse(f.value.settings):null;g.value.customersIds.filter(X=>!K.includes(X)).forEach(X=>{let M={};s.savedAppointment&&s.savedAppointment.bookings.forEach(Z=>{parseInt(Z.customer.id)===parseInt(X)&&(M=Z)}),me=l.getters["appointment/getBookings"].length>1,l.getters["appointment/getBookings"].push(Object.assign({id:null,customer:E.value.find(Z=>Z.id===parseInt(X)),persons:1,status:Ae&&"general"in Ae&&"defaultAppointmentStatus"in Ae.general?Ae.general.defaultAppointmentStatus:o.general.defaultAppointmentStatus,duration:Object.keys(f.value.customPricing.durations)[0],extras:f.value.extras.map(Z=>new Object({extraId:Z.id,quantity:0})),customFields:{}},M)),l.dispatch("appointment/resetBookingCustomFields",l.getters["appointment/getBookings"].length-1),l.dispatch("appointment/addCustomFieldsFormRules",{key:l.getters["appointment/getBookings"].length-1,label:u.value.required_field}),l.commit("appointment/setBooking",{index:l.getters["appointment/getBookings"].length-1,value:l.getters["appointment/getBookings"][l.getters["appointment/getBookings"].length-1]})});let Ve=K.filter(X=>!g.value.customersIds.includes(X)),Q=[];l.getters["appointment/getBookings"].forEach((X,M)=>{Ve.indexOf(X.customer.id)!==-1&&Q.push(M)});let _e=l.getters["appointment/getBookings"].length;for(let X=_e-1;X>=0;X--)Q.indexOf(X)!==-1&&(me=!0,l.dispatch("appointment/removeBooking",X));me&&e("changedSlotCondition")}function L(){l.dispatch("customerInfo/resetCustomer"),P.value=!0}function T(K){l.dispatch("customerInfo/resetCustomer"),l.commit("customerInfo/setLoading",!0),P.value=!0,Ne.get("/users/customers/"+K,Object.assign({params:{source:"cabinet-provider"}},ze(l))).then(me=>{l.commit("customerInfo/setCustomer",wr(l,me.data.data.user))}).catch(me=>{console.log(me)}).finally(()=>{l.commit("customerInfo/setLoading",!1)})}function w(K){l.dispatch("appointment/removeBooking",K),l.dispatch("appointment/deleteAllCustomFieldsFormRules"),l.dispatch("appointment/addAllCustomFieldsFormRules",{label:u.value.required_field}),e("changedSlotCondition")}const{noShowData:B}=R("noShowData");function z(K,me){return K&&me?"am-w-50":""}function D(K){K&&l.commit("appointment/setAllBookingsStatus",K)}function G(K,me){l.commit("appointment/setBookingStatus",{index:K,value:me})}function se(K,me){l.commit("appointment/setBookingPersons",{index:K,value:me}),e("changedSlotCondition")}function j(K,me){l.commit("appointment/setBookingDuration",{index:K,value:me}),e("changedSlotCondition")}let ne=_(()=>i.value.cabinetType==="employee"?r.value.appointments.options.customerPhone.visibility:!0),te=_(()=>i.value.cabinetType==="employee"?r.value.appointments.options.customerEmail.visibility:!0),oe=R("amColors"),ie=_(()=>({"--am-c-card-text":oe.value.colorMainText}));return Je(()=>{if(l.getters["appointment/getId"]){let K=l.getters["appointment/getBookings"].map(me=>me.customer.id);l.commit("customerInfo/setCustomersIds",K),Hs(l,"",{limit:K.length,customers:K},()=>{l.commit("customerInfo/setCustomers",l.getters["customerInfo/getCustomers"].concat(l.getters["auth/getPreloadedCustomers"].filter(me=>l.getters["customerInfo/getCustomers"].map(Ae=>Ae.id).indexOf(me.id)===-1)).sort((me,Ae)=>me.id-Ae.id))})}else l.commit("customerInfo/setCustomers",l.getters["auth/getPreloadedCustomers"])}),a({customersFormRef:v}),(K,me)=>{const Ae=yt,Ve=et;return c(),y("div",{class:"am-capai-cuf",style:be(t(ie))},[s.capacityWarning?(c(),U(Tr,{key:0,heading:s.capacityWarning},null,8,["heading"])):O("",!0),m("div",{class:q(["am-capai-cuf__heading",s.responsiveClass])},[$(Ve,{ref_key:"customersFormRef",ref:v,model:t(g),rules:t(k),class:q(["am-capai-cuf__heading-form",s.responsiveClass])},{default:x(()=>[$(Ae,{prop:"customersIds",class:"am-capai-cuf__heading-form__item"},{default:x(()=>[$(He,{modelValue:t(g).customersIds,"onUpdate:modelValue":me[0]||(me[0]=Q=>t(g).customersIds=Q),filterable:"",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","popper-class":"am-capai-cuf__popper-customer",placeholder:`${t(u).select_customers}`,"remote-method":Q=>{t(Hs)(t(l),Q)},loading:t(N),onChange:I,onFocus:me[1]||(me[1]=Q=>t(Ii)(t(l)))},{default:x(()=>[(c(!0),y(ee,null,fe(t(E),Q=>(c(),U(qe,{key:Q.id,disabled:t(f)?.maxCapacity===n.appointmentCapacity&&t(g).customersIds.indexOf(Q.id)===-1,value:Q.id,label:Q.email&&t(te)?Q.email:Q.firstName+" "+Q.lastName},{default:x(()=>[m("div",W_,[m("div",H_,C(Q.firstName+" "+Q.lastName),1),t(te)&&Q.email?(c(),y("div",Z_,C(Q.email),1)):O("",!0),t(ne)&&Q.phone?(c(),y("div",G_,C(Q.phone),1)):O("",!0)])]),_:2},1032,["disabled","value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"])]),_:1})]),_:1},8,["model","rules","class"]),t(o).roles.allowWriteCustomers?(c(),U(Se,{key:0,class:q(["am-capai-cuf__heading-add",s.responsiveClass]),size:"default",prefix:"plus",icon:"plus","icon-only":t(d)<=540,disabled:t(f)?.maxCapacity===n.appointmentCapacity,onClick:L},{default:x(()=>[ce(C(t(u).new_customer),1)]),_:1},8,["class","icon-only","disabled"])):O("",!0)],2),m("div",J_,[t(l).getters["appointment/getBookings"].length>1?(c(),y("div",{key:0,class:q(["am-capai-cuf__bulk",s.responsiveClass])},[m("div",X_,C(t(u).change_group_status),1),$(He,{modelValue:t(b),"onUpdate:modelValue":me[2]||(me[2]=Q=>we(b)?b.value=Q:b=Q),clearable:"",size:"small",placeholder:"Group Status","popper-class":"am-capai-cuf__popper","parent-class":`am-capai-cuf__bulk-status ${s.responsiveClass}`,"prefix-icon":t(b)?t(A).find(Q=>Q.value===t(b)).icon:"circle-empty","prefix-icon-color":t(b)?t(A).find(Q=>Q.value===t(b)).color:"var(--am-c-select-text-op40)",onChange:D},{default:x(()=>[(c(!0),y(ee,null,fe(t(A),Q=>(c(),U(qe,{key:Q.value,value:Q.value,label:Q.label},{default:x(()=>[m("span",{class:q(`am-icon-${Q.icon}`),style:be(`color: ${Q.color}`)},null,6),ce(" "+C(Q.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","parent-class","prefix-icon","prefix-icon-color"])],2)):O("",!0),(c(!0),y(ee,null,fe(t(S),(Q,_e)=>(c(),y("div",{key:_e,class:q(["am-capai-cuf__card",s.responsiveClass])},[m("div",{class:q(["am-capai-cuf__card-info",s.responsiveClass])},[m("div",{class:q(["am-capai-customer__name",t(B)(Q.customer.noShowCount).class])},[t(B)(Q.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(B)(Q.customer.noShowCount).icon}`)},null,2)):O("",!0),ce(" "+C(Q.customer.firstName+" "+Q.customer.lastName),1)],2),Q.customer.phone&&t(ne)?(c(),y("div",Q_,[K_,m("a",{href:`tel:${Q.customer.phone}`},C(Q.customer.phone),9,ey)])):O("",!0),Q.customer.email&&t(te)?(c(),y("div",ty,[ay,m("a",{href:`mailto:${Q.customer.email}`},C(Q.customer.email),9,sy)])):O("",!0)],2),m("div",{class:q(["am-capai-cuf__card-booking",s.responsiveClass])},[$(He,{modelValue:Q.status,"onUpdate:modelValue":X=>Q.status=X,"prefix-icon":t(A).find(X=>X.value===Q.status).icon,"prefix-icon-color":t(A).find(X=>X.value===Q.status).color,"popper-class":"am-capai-cuf__popper",size:"small",onChange:X=>G(_e,X)},{default:x(()=>[(c(!0),y(ee,null,fe(t(A),X=>(c(),U(qe,{key:X.value,value:X.value,label:t(A).find(M=>M.value===Q.status).label},{default:x(()=>[m("span",{class:q(`am-icon-${X.icon}`),style:be(`color: ${X.color}`)},null,6),ce(" "+C(X.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","prefix-icon","prefix-icon-color","onChange"]),t(f).maxCapacity>1?(c(),U(He,{key:0,modelValue:Q.persons,"onUpdate:modelValue":X=>Q.persons=X,"parent-class":`${z(t(f).maxCapacity>1,t(f).customPricing.enabled==="duration")} ${s.responsiveClass}`,placeholder:t(u).persons,"prefix-icon":"users","prefix-icon-color":"var(--am-c-card-text)",size:"small",onChange:X=>se(_e,X)},{default:x(()=>[(c(!0),y(ee,null,fe(t(f)?.maxCapacity,X=>(c(),U(qe,{key:X,disabled:n.appointmentCapacity-Q.persons+X>t(f)?.maxCapacity,value:X,label:X},null,8,["disabled","value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","parent-class","placeholder","onChange"])):O("",!0),t(f).customPricing.durations.enabled==="duration"?(c(),U(He,{key:1,modelValue:Q.duration,"onUpdate:modelValue":X=>Q.duration=X,"parent-class":`${z(t(f).maxCapacity>1,t(f).customPricing.durations.enabled==="duration")} ${s.responsiveClass}`,placeholder:t(u).duration,"prefix-icon":"clock","prefix-icon-color":"var(--am-c-card-text)",size:"small",onChange:X=>j(_e,X)},{default:x(()=>[(c(!0),y(ee,null,fe(Object.keys(t(f).customPricing.durations),X=>(c(),U(qe,{key:X,value:X,label:t(hs)(X,t(u).h,t(u).min)},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","parent-class","placeholder","onChange"])):O("",!0)],2),$(ha,{index:_e,"reference-class":s.responsiveClass,"have-edit":t(o).roles.allowWriteCustomers,onRemove:w,onEdit:X=>T(Q.customer.id)},null,8,["index","reference-class","have-edit","onEdit"])],2))),128))]),t(P)?(c(),U(Sr,{key:1,visibility:t(P),"responsive-class":s.responsiveClass,"onUpdate:visibility":me[3]||(me[3]=Q=>we(P)?P.value=Q:P=Q),onAddedCustomer:h},null,8,["visibility","responsive-class"])):O("",!0)],4)}}};const ny=m("span",{class:"am-icon-email"},null,-1),iy=["href"],oy=m("span",{class:"am-icon-phone"},null,-1),ry=["href"],cy={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:a}){const e=n;let s=De();const l=R("shortcodeData");let i=R("amCustomize");const o=R("settings");let r=R("amLabels"),u=F(null),d=F({}),f=_(()=>s.getters["appointment/getCustomFieldsRules"]),v=F({}),g=_(()=>s.getters["appointment/getCustomFields"]),k=_(()=>s.getters["appointment/getServiceId"]),N=_(()=>s.getters["customerInfo/getCustomersIds"]),E=F(null);function b(L,T){let w=s.getters["appointment/getBookings"][L].id;(T.type!=="file"||w)&&(d.value[`${L}cf${T.id}`]=_({get:()=>{let B=s.getters["appointment/getBookings"][L].customFields[T.id]?.value;return B||""},set:B=>s.dispatch("appointment/updateBookingCustomField",{bookingKey:L,fieldId:T.id,value:B})}))}function A(L,T){let w=s.getters["appointment/getBookings"][L].id;(T.type!=="file"||w)&&(v.value[L][T.id]={template:Ye[T.type],props:{id:T.id,itemName:`${L}cf${T.id}`,label:T.label,options:T.options,class:`am-capai-cfields__item am-cf-width-${T.width}`}}),(T.type==="checkbox"||T.type==="radio")&&(v.value[L][T.id].props.options=v.value[L][T.id].props.options.map(B=>({...B,value:B.label}))),T.type==="text-area"&&(v.value[L][T.id].props={...v.value[L][T.id].props,itemType:"textarea"}),T.type==="file"&&w&&(v.value[L][T.id].props={...v.value[L][T.id].props,btnLabel:r.value.upload_file_here,isUpload:!1,bookingId:w}),T.type==="datepicker"&&(v.value[L][T.id].props={...v.value[L][T.id].props,weekStartsFromDay:o.wordpress.startOfWeek})}function S(){d.value={},s.getters["appointment/getBookings"].forEach((L,T)=>{v.value[T]={},s.getters["appointment/getCustomFields"].forEach(w=>{b(T,w),A(T,w)})})}const{noShowData:P}=R("noShowData");let h=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),I=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0);return rt([k,N],()=>{S()}),Zs(()=>{S()}),Je(()=>{s.getters["appointment/getBookings"].filter(L=>L.status!=="canceled"&&L.status!=="rejected").length<2&&(E.value=0)}),a({customFieldsFormRef:u}),(L,T)=>{const w=bs,B=ks,z=et;return c(),U(z,{ref_key:"customFieldsFormRef",ref:u,model:t(d),rules:t(f),"label-position":"top",class:q(["am-capai-cfields am-capai-cfields__form",e.responsiveClass])},{default:x(()=>[$(B,{modelValue:t(E),"onUpdate:modelValue":T[0]||(T[0]=D=>we(E)?E.value=D:E=D),class:"am-capai-collapse",accordion:""},{default:x(()=>[(c(!0),y(ee,null,fe(t(s).getters["appointment/getBookings"].filter(D=>D.status!=="canceled"&&D.status!=="rejected"),(D,G)=>(c(),U(w,{key:G,name:G,class:"am-capai-collapse__item"},{title:x(()=>[m("div",{class:q(["am-capai-customer__name",[{"am-pb-16":!(D.customer.email&&t(I)||D.customer.phone&&t(h))},t(P)(D.customer.noShowCount).class]])},[t(P)(D.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(P)(D.customer.noShowCount).icon}`)},null,2)):O("",!0),ce(" "+C(D.customer.firstName+" "+D.customer.lastName),1)],2)]),default:x(()=>[D.customer.email&&t(I)||D.customer.phone&&t(h)?(c(),y("div",{key:0,class:q(["am-capai-customer__data-wrapper",e.responsiveClass])},[D.customer.email&&t(I)?(c(),y("div",{key:0,class:q(["am-capai-customer__data",e.responsiveClass])},[ny,m("a",{href:`mailto:${D.customer.email}`},C(D.customer.email),9,iy)],2)):O("",!0),D.customer.phone&&t(h)?(c(),y("div",{key:1,class:q(["am-capai-customer__data",e.responsiveClass])},[oy,m("a",{href:`tel:${D.customer.phone}`},C(D.customer.phone),9,ry)],2)):O("",!0)],2)):O("",!0),(c(!0),y(ee,null,fe(t(g),se=>(c(),y(ee,{key:G+"_"+se.id},[G in t(v)&&`${G}cf${se.id}`in t(d)?(c(),U(pt(t(v)[G][se.id].template),Lt({key:0,modelValue:t(d)[`${G}cf${se.id}`],"onUpdate:modelValue":j=>t(d)[`${G}cf${se.id}`]=j},t(v)[G][se.id].props),null,16,["modelValue","onUpdate:modelValue"])):O("",!0)],64))),128))]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["model","rules","class"])}}};const uy={key:0,class:"am-capai-ext__heading-extra"},dy=m("span",{class:"am-icon-email"},null,-1),my=["href"],py=m("span",{class:"am-icon-phone"},null,-1),gy=["href"],fy={class:"am-capai-ext__wrapper"},hy={class:"am-capai-ext__inner-info"},vy={class:"am-capai-ext__inner-name"},_y={key:0,class:"am-capai-ext__inner-duration"},yy={class:"am-capai-ext__total"},by={props:{responsiveClass:{type:String,default:""}},emits:["changedSlotCondition"],setup(n,{emit:a}){const e=n,s=De(),l=R("shortcodeData");let i=R("amCustomize"),o=R("amLabels"),r=_(()=>s.getters["appointment/getEmployeeService"]),u=_(()=>s.getters["appointment/getBookings"]),d=F(null);function f(S,P,h){S.duration&&(h.extras[P].quantity===0||h.extras[P].quantity===1)&&a("changedSlotCondition")}function v(S){return S.extras.length?S.extras.reduce((P,h)=>P+("price"in h?h.price:r.value.extras.find(I=>I.id===h.extraId).price)*h.quantity,0):0}function g(S){return S.filter(P=>P.quantity>0).length}const{noShowData:k}=R("noShowData");let N=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),E=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0),b=R("amColors"),A=_(()=>({"--am-c-ext-text-op60":H(b.value.colorMainText,.6)}));return Je(()=>{u.value.filter(S=>S.status!=="canceled"&&S.status!=="rejected").length<2&&(d.value=0)}),(S,P)=>{const h=bs,I=ks;return c(),U(I,{modelValue:t(d),"onUpdate:modelValue":P[0]||(P[0]=L=>we(d)?d.value=L:d=L),class:"am-capai-ext am-capai-collapse",accordion:"",style:be(t(A))},{default:x(()=>[(c(!0),y(ee,null,fe(t(u).filter(L=>L.status!=="canceled"&&L.status!=="rejected"),(L,T)=>(c(),U(h,{key:T,name:T,class:"am-capai-ext__item am-capai-collapse__item"},{title:x(()=>[m("div",{class:q(["am-capai-ext__heading",{"am-pb-16":!(L.customer.email&&t(E)||L.customer.phone&&t(N))}])},[m("div",{class:q(["am-capai-customer__name",t(k)(L.customer.noShowCount).class])},[t(k)(L.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(k)(L.customer.noShowCount).icon}`)},null,2)):O("",!0),ce(" "+C(L.customer.firstName+" "+L.customer.lastName),1)],2),g(L.extras)>0?(c(),y("div",uy,C(`${t(o).extras}: ${g(L.extras)}`),1)):O("",!0)],2)]),default:x(()=>[L.customer.email&&t(E)||L.customer.phone&&t(N)?(c(),y("div",{key:0,class:q(["am-capai-customer__data-wrapper",e.responsiveClass])},[L.customer.email&&t(E)?(c(),y("div",{key:0,class:q(["am-capai-customer__data",e.responsiveClass])},[dy,m("a",{href:`mailto:${L.customer.email}`},C(L.customer.email),9,my)],2)):O("",!0),L.customer.phone&&t(N)?(c(),y("div",{key:1,class:q(["am-capai-customer__data",e.responsiveClass])},[py,m("a",{href:`tel:${L.customer.phone}`},C(L.customer.phone),9,gy)],2)):O("",!0)],2)):O("",!0),m("div",fy,[(c(!0),y(ee,null,fe(t(r).extras,(w,B)=>(c(),y("div",{key:B,class:q(["am-capai-ext__inner",[{"am-border-bottom":B!==t(r).extras.length-1},e.responsiveClass]])},[m("div",hy,[m("div",vy,C(w.name),1),w.duration?(c(),y("div",_y,C(`${t(o).duration}: ${t(hs)(w.duration,t(o).h,t(o).min)}`),1)):O("",!0)]),m("div",{class:q(["am-capai-ext__inner-selection",e.responsiveClass])},[m("div",{class:q(["am-capai-ext__inner-price",e.responsiveClass])},[w.price?(c(),y(ee,{key:0},[ce(C(t(tt)("price"in L.extras[B]?L.extras[B].price:w.price)),1)],64)):(c(),y(ee,{key:1},[ce(C(t(o).free),1)],64))],2),$(ht,{modelValue:L.extras[B].quantity,"onUpdate:modelValue":z=>L.extras[B].quantity=z,class:q(e.responsiveClass),size:"small",min:0,max:w.maxQuantity,onChange:z=>f(w,B,L)},null,8,["modelValue","onUpdate:modelValue","class","max","onChange"])],2)],2))),128)),m("div",yy,C(`${t(o).subtotal}: ${t(tt)(v(L))}`),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])}}};function yo(n,a){let e=he(n,"YYYY-MM-DD"),s=he(e).add(a,"M"),l=he(s).startOf("month");return e.date()!==s.date()&&s.isSame(l.format("YYYY-MM-DD"))&&s.subtract(1,"d"),s}function ky(n,a,e){let s=he(n,"YYYY-MM-DD").startOf("month").day(e);s.format("M")!==n.format("M")&&s.add(7,"days");let l=s.add(7*(a-1),"days");return n.format("M")!==l.format("M")&&l.subtract(7,"days"),l}function Cy(n,a,e,s,l,i,o,r){let u=e?he(e):he().add(s,"days"),d=he(a,"YYYY-MM-DD"),f={},v=[];switch(l){case"daily":v.push(he(a,"YYYY-MM-DD"));break;case"weekly":let k=he(a,"YYYY-MM-DD").isoWeekday();o.forEach((N,E)=>{if(N.selected){let b=E+1,A=he(a,"YYYY-MM-DD");k<b?v.push(A.add(b-k,"days")):k===b?v.push(A):k>b&&v.push(A.subtract(k-b,"days"));let S=u||n;A.isSameOrBefore(S)&&A.isAfter(d)&&(f[A.format("YYYY-MM-DD")]=A)}});break;case"monthly":v.push(he(a,"YYYY-MM-DD"));break}let g=v.length>0;for(;g;)for(let k=0;k<v.length;k++){switch(l){case"daily":v[k].add(i,"days");break;case"weekly":v[k].add(i*7,"days");break;case"monthly":let N=v[k].isoWeekday();v[k]=r===0?yo(v[k].format("YYYY-MM-DD"),i):ky(yo(v[k].startOf("month").format("YYYY-MM-DD"),i),r,N);break}g=v[k].isSameOrBefore(u),g&&(f[he(v[k]).format("YYYY-MM-DD")]=he(v[k]))}return f}function xy(n,a,e,s,l,i,o){let r=he(s,"YYYY-MM-DD"),u=i?he(i,"YYYY-MM-DD"):null,d={},f={};Ll(Object.keys(a)).forEach(g=>{f[g]=he(g+" 00:00:00")});let v=he(s,"YYYY-MM-DD").format("YYYY-MM-DD");for(let g in e){let k=he(g,"YYYY-MM-DD"),N=u?k.isSameOrBefore(u):!0;if(g in a&&Object.keys(a[g]).length&&!(g in d)&&N){let E=l in a[g],b=E?l:Object.keys(a[g])[0];d[g]={isSubstituteDate:!1,isSubstituteTime:!E,time:b,times:Object.keys(a[g]),slot:a[g][b]}}else if(g!==v&&!(g in d)&&N){let E=null,b=null;for(let h in f)if((n.recurringSub==="past"||n.recurringSub==="both")&&f[h].isBefore(e[g])&&f[h].isAfter(r)&&h!==g&&!(h in d)&&(E=f[h]),(n.recurringSub==="future"||n.recurringSub==="both")&&f[h].isAfter(e[g])&&h!==g&&!(h in d)){b=f[h];break}let A=E!==null?he(e[g]).diff(E,"days"):null,S=b!==null?he(b).diff(e[g],"days"):null,P=null;if(A&&S?P=A<S?E:b:A?P=E:S&&(P=b),P!==null&&(u?he(P).isSameOrBefore(u):!0)){let h=he(P).format("YYYY-MM-DD");if(h in a&&!(g in d)&&!(h in e)){let I=l in a[h],L=I?l:Object.keys(a[h])[0];d[h]={isSubstituteDate:!0,isSubstituteTime:!I,time:L,times:Object.keys(a[h]),slot:a[h][L]}}}}if(u?!N:Ll(Object.keys(d)).length>=o)break}return d}const wy={class:"am-fs__rs-every"},Ty={key:1},Sy={class:"am-fs__rs-on-week"},Ey=["onClick"],Ly={key:2},Ay={class:"am-fs__rs-on-month"},Iy={class:"am-fs__rs-ends"},$y={class:"am-fs__rs-ends-choose"},Py={class:"am-fs__rs-ends-options"},Dy={class:"am-fs__rs-ends-after"},Ny={class:"am-fs__rs-summary"},Oy={key:0},My={key:1},Fy={key:0},Vy=ce(", "),By={key:0},Ry={key:1},qy={name:"RecurringSetup"},Uy=Object.assign(qy,{props:{service:{type:Object,default:()=>{}},startDate:{type:String,default:""},startTime:{type:String,default:""},maxDate:{type:String,default:""},globalClass:{type:String,default:""}},setup(n){const a=n;let e=R("amLabels"),s=R("amCustomize"),l=De(),i=R("containerWidth",0),o=_(()=>i.value<560||i.value-240<520),r=_({get:()=>l.getters["recurring/getRepeatType"],set:L=>{l.commit("recurring/setRepeatType",L)}}),u=_({get:()=>l.getters["recurring/getRepeatInterval"],set:L=>{l.commit("recurring/setRepeatInterval",L)}}),d=_({get:()=>l.getters["recurring/getOccurrenceType"],set:L=>{l.commit("recurring/setOccurrenceType",L)}}),f=_({get:()=>l.getters["recurring/getOccurrenceDate"]?l.getters["recurring/getOccurrenceDate"]:new Date(a.startDate),set:L=>{l.commit("recurring/setOccurrenceDate",L)}}),v=_({get:()=>l.getters["recurring/getOccurrenceCount"],set:L=>{l.commit("recurring/setOccurrenceCount",L)}}),g=_({get:()=>l.getters["recurring/getMonthly"],set:L=>{l.commit("recurring/setMonthly",L)}});const k=F([{label:e.value.recurrence_day,labelPlural:e.value.recurrence_days,value:"daily"},{label:e.value.recurrence_week,labelPlural:e.value.recurrence_weeks,value:"weekly"},{label:e.value.recurrence_month,labelPlural:e.value.recurrence_months,value:"monthly"}]),N=F([{label:e.value.recurrence_specific_date,value:0},{label:e.value.recurrence_first,value:1},{label:e.value.recurrence_second,value:2},{label:e.value.recurrence_third,value:3},{label:e.value.recurrence_fourth,value:4},{label:e.value.recurrence_last,value:5}]);let E=F(he(a.startDate).format("dddd").toLowerCase()),b=F([{label:"Mon",labelFull:"Monday",value:"monday",selected:!1},{label:"Tue",labelFull:"Tuesday",value:"tuesday",selected:!1},{label:"Wed",labelFull:"Wednesday",value:"wednesday",selected:!1},{label:"Thu",labelFull:"Thursday",value:"thursday",selected:!1},{label:"Fri",labelFull:"Friday",value:"friday",selected:!1},{label:"Sat",labelFull:"Saturday",value:"saturday",selected:!1},{label:"Sun",labelFull:"Sunday",value:"sunday",selected:!1}]),A=_(()=>b.value.find(L=>L.value===he(a.startDate,"YYYY-MM-DD").format("dddd").toLowerCase()).labelFull);function S(L){f.value=he(L,"YYYY-MM-DD").toDate()}function P(L,T=!1){let w=b.value.find(B=>B.value===L);w.selected=T?!0:!w.selected,l.commit("recurring/setDays",{value:L,selected:w.selected})}Je(()=>{Rs&&(b.value=b.value.map((T,w)=>({...T,label:wo[w],labelFull:To[w]})));let L=l.getters["recurring/getDays"].filter(T=>T.selected);L.length===0?P(b.value.find(T=>E.value&&T.value===E.value).value,!0):L.forEach(T=>{P(T.value,!0)}),a.service.recurringCycle!=="all"&&l.commit("recurring/setRepeatType",a.service.recurringCycle)});let h=R("amColors"),I=_(()=>({"--am-c-rs-text":h.value.colorMainText,"--am-c-rs-text-op60":H(h.value.colorMainText,.6),"--am-c-rs-bgr":h.value.colorMainBgr,"--am-c-rs-primary":h.value.colorPrimary,"--am-c-rs-inp-border":h.value.colorInpBorder}));return(L,T)=>(c(),y("div",{class:q(["am-fs__rs",[{"am-fs__rs-mobile":t(o)},t(a).globalClass]]),style:be(t(I))},[t(s)&&t(s).recurringStep&&t(s).recurringStep.options.heading.visibility?(c(),y(ee,{key:0},[m("p",null,C(t(e).recurrence),1),m("span",null,C(t(e).recurrence_choosing_time),1)],64)):O("",!0),m("p",null,C(t(e).repeat_every)+":",1),m("div",wy,[$(t(ht),{modelValue:t(u),"onUpdate:modelValue":T[0]||(T[0]=w=>we(u)?u.value=w:u=w),min:1,max:100},null,8,["modelValue"]),$(t(He),{modelValue:t(r),"onUpdate:modelValue":T[1]||(T[1]=w=>we(r)?r.value=w:r=w),disabled:t(a).service.recurringCycle!=="all"},{default:x(()=>[(c(!0),y(ee,null,fe(k.value,(w,B)=>(c(),U(t(qe),{key:B,label:w.label,value:w.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),t(r)==="weekly"?(c(),y("div",Ty,[m("p",null,C(`${t(e).recurrence_repeat_on}:`),1),m("div",Sy,[(c(!0),y(ee,null,fe(t(b),(w,B)=>(c(),y("div",{key:B,class:q({"am-fs__rs-on-week-selected":t(b).find(z=>z.value===w.value).selected}),onClick:z=>P(w.value)},C(w.label),11,Ey))),128))])])):O("",!0),t(r)==="monthly"?(c(),y("div",Ly,[m("p",null,C(`${t(e).recurrence_repeat_on}:`),1),m("div",Ay,[$(t(He),{modelValue:t(g),"onUpdate:modelValue":T[2]||(T[2]=w=>we(g)?g.value=w:g=w)},{default:x(()=>[(c(!0),y(ee,null,fe(N.value,(w,B)=>(c(),U(t(qe),{key:B,label:w.label+(B!==0?" "+t(A):""),value:w.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])):O("",!0),m("p",null,C(`${t(e).recurrence_ends}:`),1),m("span",null,C(t(e).recurrence_choose_ends),1),m("div",Iy,[m("div",$y,[$(t(Bl),{modelValue:t(d),"onUpdate:modelValue":T[3]||(T[3]=w=>we(d)?d.value=w:d=w)},{default:x(()=>[$(t($a),{value:"On"},{default:x(()=>[ce(C(t(e).recurrence_on),1)]),_:1}),$(t($a),{value:"After"},{default:x(()=>[ce(C(t(e).recurrence_after),1)]),_:1})]),_:1},8,["modelValue"])]),m("div",Py,[$(t(Xr),{"calendar-minimum-date":t(a).startDate,disabled:t(d)!=="On","input-placeholder":t(e).recurrence_select_date,"calendar-maximum-date":t(a).maxDate,onSelectedDate:S},null,8,["calendar-minimum-date","disabled","input-placeholder","calendar-maximum-date"]),m("div",Dy,[$(t(ht),{modelValue:t(v),"onUpdate:modelValue":T[4]||(T[4]=w=>we(v)?v.value=w:v=w),disabled:t(d)!=="After",min:1,max:100},null,8,["modelValue","disabled"]),m("span",null,C(` ${t(e).occurrences}`),1)])])]),m("div",Ny,[m("p",null,C(`${t(e).appointment_repeats}:`),1),m("p",null,[ce(C(`${t(e).recurrence_every} ${t(u)>1?t(u):""} ${k.value.find(w=>w.value===t(r))?k.value.find(w=>w.value===t(r)).label:""}`)+" ",1),t(r)==="weekly"?(c(),y("span",Oy,C(`${t(e).repeats_on} ${t(b).filter(w=>w.selected).map(w=>w.labelFull).join(", ")}`),1)):O("",!0),t(r)==="monthly"?(c(),y("span",My,[ce(C(` ${t(e).repeats_on} ${N.value[t(g)].label}`)+" ",1),t(g)!==0?(c(),y("span",Fy,C(` ${t(A)}`),1)):O("",!0),Vy])):O("",!0),m("span",null,C(` ${t(e).repeats_from} ${t(nt)(t(a).startDate)} ${t(e).repeats_at} ${t(vs)(t(a).startTime)}`),1)]),m("p",null,[t(d)==="After"?(c(),y("span",By,C(t(e).number_of_recurrences)+" "+C(` ${t(v)}`),1)):t(f)?(c(),y("span",Ry,C(t(e).ends_on)+" "+C(` ${t(nt)(t(Qr)(t(f)))}`),1)):O("",!0)])])],6))}});const zy={class:"am-capai-recurr__enable"},jy={key:0,class:"am-capai-recurr__content"},Yy={key:1,class:"am-capai-recurr__list"},Wy={class:"am-capai-recurr__list-heading"},Hy={class:"am-capai-recurr__list-heading__text"},Zy=m("span",{class:"am-icon-refresh"},null,-1),Gy={class:"am-capai-recurr__table"},Jy={key:2,class:"am-capai-recurr__actions"},Xy={props:{responsiveClass:{type:String,default:""},maximumBookingStartDate:{type:String,required:!0},slotsLoading:{type:Boolean,required:!0},slotsProps:{type:Object,required:!0},freeSlots:{type:Object,required:!0},getFreeTimes:{type:Function,required:!0},isDisabledDate:{type:Function,required:!0},getSelectedDatesTimes:{type:Function,required:!0}},emits:["fetchSlots"],setup(n,{emit:a}){const e=n,s=De(),l=R("settings");let i=R("amLabels"),o=R("localLanguage"),r=_(()=>s.getters["appointment/getEmployeeService"]),u=F(!1),d=F(2),f=F(!1),v=R("recurringList"),g=F(!0);function k(){let T=s.getters["recurring/getOccurrenceType"]==="On"?Ke(s.getters["recurring/getOccurrenceDate"]).format("YYYY-MM-DD"):null,w=Cy(e.maximumBookingStartDate,Ke(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),T,l.general.numberOfDaysAvailableForBooking,s.getters["recurring/getRepeatType"],s.getters["recurring/getRepeatInterval"],s.getters["recurring/getDays"],s.getters["recurring/getMonthly"]);d.value=s.getters["recurring/getOccurrenceType"]==="On"?Object.keys(w).length:s.getters["recurring/getOccurrenceCount"],f.value=!0;let B=Ll(Object.keys(w));$o(Object.assign({startDateTime:Ke(s.getters["appointment/getStartDate"]).startOf("month").subtract(6,"days").format("YYYY-MM-DD"),endDateTime:B.length?Ke(B[B.length-1]).endOf("month").add(11,"days").format("YYYY-MM-DD"):Ke().add(l.general.numberOfDaysAvailableForBooking,"days").format("YYYY-MM-DD")},e.slotsProps),null,z=>{let D=xy(r.value,z,w,Ke(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),s.getters["appointment/getStartTime"],T,s.getters["recurring/getOccurrenceType"]==="After"?s.getters["recurring/getOccurrenceCount"]:null);v.value=[],Object.keys(D).forEach(G=>{v.value.push(Object.assign({date:Ke(G).toDate(),editing:!1},D[G]))}),f.value=!1})}function N(){v.value=null}function E(T){let w=Ke(v.value[T].date).format("YYYY-MM-DD");v.value[T].times=Object.keys(e.freeSlots[w]);let B=e.getSelectedDatesTimes(T,!1);w in B&&v.value[T].time in B[w]&&(v.value[T].time="")}function b(T){v.value.splice(T,1)}function A(T){v.value[T].editing=!0}function S(T){v.value[T].editing=!1}let P=F(null);function h(T,w,B=!1){!T&&!P.value?T=Ke().toDate():!T&&P.value&&(T=P.value),P.value=T&&B?T:P.value,a("fetchSlots",T,w,B)}let I=R("amColors"),L=_(()=>({"--am-c-recurr-bgr-op05":H(I.value.colorPrimary,.05),"--am-c-warning-op10":H(I.value.colorWarning,.1),"--am-c-main-text-op10":H(I.value.colorMainText,.1)}));return rt(u,T=>{T||(v.value=null)}),(T,w)=>(c(),y("div",{class:"am-capai-recurr",style:be(t(L))},[m("div",zy,[$(mt,{modelValue:t(u),"onUpdate:modelValue":w[0]||(w[0]=B=>we(u)?u.value=B:u=B),label:"Enable Recurring appointment"},null,8,["modelValue"])]),t(u)?(c(),y("div",jy,[!t(f)&&!t(v)?(c(),U(Uy,{key:0,"start-date":t(Ke)(t(s).getters["appointment/getStartDate"]).format("YYYY-MM-DD"),"start-time":t(s).getters["appointment/getStartTime"],"max-date":t(e).maximumBookingStartDate,service:t(r)},null,8,["start-date","start-time","max-date","service"])):(c(),y(ee,{key:1},[t(v)?(c(),y("div",Yy,[m("div",Wy,[m("div",Hy,[Zy,m("div",null,C(`${t(v).length} appointments total`),1)]),m("div",{class:"am-capai-recurr__list-heading__action",onClick:w[1]||(w[1]=()=>{we(g)?g.value=!t(g):g=!t(g)})},C(t(g)?t(i).show_less:t(i).show_more),1)]),t(g)?(c(),y(ee,{key:0},[t(v).filter(B=>B.isSubstituteDate||B.isSubstituteTime).length?(c(),U(Tr,{key:0,heading:t(i).recurring_unavailable_slots,text:t(i).recurring_sub_message1},null,8,["heading","text"])):O("",!0),m("div",Gy,[(c(!0),y(ee,null,fe(t(v),(B,z)=>(c(),y("div",{key:z,class:q(["am-capai-recurr__row",[{"am-warn":B.isSubstituteDate||B.isSubstituteTime},t(e).responsiveClass]])},[m("div",{class:q(["am-capai-recurr__row-num",t(e).responsiveClass])},C(z+1),3),m("div",{class:q(["am-capai-recurr__row-date",[{"am-disable":!B.editing},t(e).responsiveClass]])},[$(Yt,{modelValue:B.date,"onUpdate:modelValue":D=>B.date=D,type:"date",format:t(jt)(),placeholder:"Pick a day",size:"small",lang:t(o),"disabled-date":(D,G)=>t(e).isDisabledDate(D,B.editing,!1,G),"popper-class":t(e).slotsLoading?"slots-loader":"",onPanelChange:D=>{h(D,z,!0)},onChange:D=>E(z),onFocus:D=>h(B.date,z,!0)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date","popper-class","onPanelChange","onChange","onFocus"])],2),m("div",{class:q(["am-capai-recurr__row-time",[{"am-disable":!B.editing},t(e).responsiveClass]])},[$(He,{modelValue:B.time,"onUpdate:modelValue":D=>B.time=D,size:"small",placeholder:`${t(i).select_time}`,disabled:!B.date},{default:x(()=>[(c(!0),y(ee,null,fe(B.editing?t(e).getFreeTimes(z,t(v)[z],!1):t(v)[z].times,D=>(c(),U(qe,{key:D,value:D,label:D},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])],2),m("div",{class:q(["am-capai-recurr__row-actions",t(e).responsiveClass])},[B.editing?(c(),U(Se,{key:1,category:"primary",size:"small",onClick:D=>S(z)},{default:x(()=>[ce(C(t(i).save),1)]),_:2},1032,["onClick"])):(c(),U(ha,{key:0,index:z,onRemove:b,onEdit:A},null,8,["index"]))],2)],2))),128))])],64)):O("",!0)])):(c(),U(Wt,{key:0,count:t(d)},null,8,["count"]))],64)),t(f)?O("",!0):(c(),y("div",Jy,[t(v)?O("",!0):(c(),U(Se,{key:0,category:"primary",size:"medium",onClick:w[2]||(w[2]=B=>k())},{default:x(()=>[ce(C(t(i).recurring_list),1)]),_:1})),t(v)?(c(),U(Se,{key:1,category:"secondary",type:"plain",size:"medium",onClick:w[3]||(w[3]=B=>N())},{default:x(()=>[ce(C(t(i).recurring_settings),1)]),_:1})):O("",!0)]))])):O("",!0)],4))}};const Qy=m("span",{class:"am-icon-email"},null,-1),Ky=["href"],eb=m("span",{class:"am-icon-phone"},null,-1),tb=["href"],ab={class:"am-capai-linked__list"},sb={class:"am-capai-linked__list-index"},lb={class:"am-capai-linked__list-date"},nb=m("span",{class:"am-icon-calendar"},null,-1),ib={class:"am-capai-linked__list-action"},ob={props:{responsiveClass:{type:String,default:""},linkedAppointments:{type:Array,required:!0}},emits:["editLinkedAppointment"],setup(n,{emit:a}){const e=n;let s=De();const l=R("shortcodeData");let i=R("amCustomize"),o=F(null);function r(E){return e.linkedAppointments.filter(b=>b.bookings.filter(A=>parseInt(A.customer.id)===parseInt(E.customer.id)).length)}const{noShowData:u}=R("noShowData");let d=R("amLabels");function f(E){s.commit("appointment/resetAppointment",{providerId:s.getters["auth/getProfile"].id}),s.commit("customerInfo/setCustomers",[]),s.commit("customerInfo/setCustomersIds",[]),a("editLinkedAppointment",E)}let v=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),g=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0),k=R("amColors"),N=_(()=>({"--am-c-linked-bgr-op05":H(k.value.colorMainText,.05)}));return Je(()=>{s.getters["appointment/getBookings"].filter(E=>E.status!=="canceled"&&E.status!=="rejected").length<2&&(o.value=0)}),(E,b)=>{const A=bs,S=ks;return c(),U(S,{modelValue:t(o),"onUpdate:modelValue":b[0]||(b[0]=P=>we(o)?o.value=P:o=P),class:"am-capai-collapse am-capai-linked",accordion:"",style:be(t(N))},{default:x(()=>[(c(!0),y(ee,null,fe(t(s).getters["appointment/getBookings"],(P,h)=>(c(),y(ee,{key:h},[r(P).length?(c(),U(A,{key:0,name:h,class:"am-capai-collapse__item"},{title:x(()=>[m("div",{class:q(["am-capai-customer__name",[{"am-pb-16":!(P.customer.email&&t(g)||P.customer.phone&&t(v))},t(u)(P.customer.noShowCount).class]])},[t(u)(P.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(u)(P.customer.noShowCount).icon}`)},null,2)):O("",!0),ce(" "+C(P.customer.firstName+" "+P.customer.lastName),1)],2)]),default:x(()=>[P.customer.email&&t(g)||P.customer.phone&&t(v)?(c(),y("div",{key:0,class:q(["am-capai-customer__data-wrapper",t(e).responsiveClass])},[P.customer.email&&t(g)?(c(),y("div",{key:0,class:q(["am-capai-customer__data",t(e).responsiveClass])},[Qy,m("a",{href:`mailto:${P.customer.email}`},C(P.customer.email),9,Ky)],2)):O("",!0),P.customer.phone&&t(v)?(c(),y("div",{key:1,class:q(["am-capai-customer__data",t(e).responsiveClass])},[eb,m("a",{href:`tel:${P.customer.phone}`},C(P.customer.phone),9,tb)],2)):O("",!0)],2)):O("",!0),m("div",ab,[(c(!0),y(ee,null,fe(r(P),(I,L)=>(c(),y("div",{key:P.id+"-"+L,class:q(["am-capai-linked__list-item",t(e).responsiveClass])},[m("div",sb,C(L+1),1),m("div",lb,[nb,ce(" "+C(t(Kr)(I.bookingStart)),1)]),m("div",ib,[$(Se,{category:"primary",size:"small",onClick:T=>f(I)},{default:x(()=>[ce(C(t(d).edit),1)]),_:2},1032,["onClick"])])],2))),128))])]),_:2},1032,["name"])):O("",!0)],64))),128))]),_:1},8,["modelValue","style"])}}},Bs=Qe(window.wpAmeliaLabels);function Er(n){if(n.gateway==="onSite")return Bs.on_site;if(n.gateway==="wc")return n.gatewayTitle;if(n.gateway)return n.gateway.charAt(0).toUpperCase()+n.gateway.slice(1)}function ni(n){switch(n){case"paid":return Bs.paid;case"pending":return Bs.pending;case"partiallyPaid":return Bs.partially_paid;case"refunded":return Bs.refunded}}function ds(n,a){switch(n){case"paid":return{icon:"am-icon-checkmark-circle",color:a.colorSuccess};case"pending":return{icon:"am-icon-refresh",color:a.colorWarning};case"partiallyPaid":return{icon:"am-icon-prepaid",color:a.colorPrimary};case"refunded":return{icon:"am-icon-refund",color:a.colorError}}}const rb={class:"am-capai-pay__heading-status"},cb={class:"am-capai-pay__heading-status__text"},ub=m("span",{class:"am-icon-email"},null,-1),db=["href"],mb=m("span",{class:"am-icon-phone"},null,-1),pb=["href"],gb={class:"am-capai-pay__row-label"},fb={class:"am-capai-pay__row-value"},hb={class:"am-capai-pay__row-label"},vb={class:"am-capai-pay__row-value"},_b={class:"am-capai-pay__row-label"},yb={class:"am-capai-pay__row-value"},bb={key:0,class:"am-divider"},kb={class:"am-capai-pay__row-label"},Cb={class:"am-capai-pay__row-label"},xb={class:"am-capai-pay__row-label"},wb={class:"am-capai-pay__row-label"},Tb={class:"am-capai-pay__row-label"},Sb={class:"am-capai-pay__row-label"},Eb={class:"am-capai-pay__row-label"},Lb={class:"am-capai-pay__row-label"},Ab={class:"am-capai-pay__row-label"},Ib={class:"am-capai-pay__row-label"},$b={class:"am-capai-pay__row-label"},Pb={props:{responsiveClass:{type:String,default:""},savedAppointment:{type:Object,default:()=>{}}},setup(n){const a=n;let e=De();const s=R("shortcodeData");let l=R("amCustomize"),i=R("pageWidth"),o=R("amLabels"),r=_(()=>s.value.cabinetType==="employee"?l.value.appointments.options.customerPhone.visibility:!0),u=_(()=>s.value.cabinetType==="employee"?l.value.appointments.options.customerEmail.visibility:!0),d=F(null),f=_(()=>e.getters["appointment/getEmployeeService"]),v=_(()=>e.getters["appointment/getBookings"].filter(b=>"id"in b&&b.id&&b.status!=="canceled"&&b.status!=="rejected")),g=_(()=>{let b=[];return v.value.forEach((A,S)=>{let P=ec(e.getters["appointment/getAppointmentData"],a.savedAppointment,A,f.value);b.push(di(e,{price:P?tc(f.value,A.persons,A.duration):A.price,persons:A.persons,aggregatedPrice:A.aggregatedPrice,extras:A.extras.filter(h=>"id"in h&&h.id),serviceId:e.getters["appointment/getServiceId"],tax:A.tax,coupon:A.coupon,wcTax:A.payments.filter(h=>h.wcOrderId&&h.wcItemTaxValue).reduce((h,I)=>h+I.wcItemTaxValue,0)},!1)),b[S].deposit=A.payments.length&&(A.payments[0].status==="paid"||A.payments[0].status==="partiallyPaid")?A.payments[0].amount:0,b[S].paid=A.payments.filter(h=>h.status==="paid"||h.status==="partiallyPaid").reduce((h,I)=>h+I.amount,0),b[S].refunded=A.payments.filter(h=>h.status==="refunded").reduce((h,I)=>h+I.amount,0),b[S].status=A.payments.reduce((h,I)=>h+I.amount,0),A.payments.filter(h=>h.status!=="refunded").length===0?b[S].status="refunded":b[S].paid-(b[S].total-b[S].discount+b[S].tax+b[S].wcTax)===0?b[S].status="paid":b[S].paid?b[S].status="partiallyPaid":b[S].status="pending"}),b});const{noShowData:k}=R("noShowData");let N=R("amColors"),E=_(()=>({"--am-c-pay-text-op03":H(N.value.colorMainText,.03)}));return Je(()=>{e.getters["appointment/getBookings"].filter(b=>b.status!=="canceled"&&b.status!=="rejected").length<2&&(d.value=0)}),(b,A)=>{const S=bs,P=ks;return c(),U(P,{modelValue:t(d),"onUpdate:modelValue":A[0]||(A[0]=h=>we(d)?d.value=h:d=h),class:"am-capai-collapse am-capai-pay",accordion:"",style:be(t(E))},{default:x(()=>[(c(!0),y(ee,null,fe(t(v),(h,I)=>(c(),U(S,{key:I,name:I,class:"am-capai-collapse__item"},{title:x(()=>[m("div",{class:q(["am-capai-pay__heading",{"am-pb-16":!(h.customer.email&&t(u)||h.customer.phone&&t(r))}])},[m("div",{class:q(["am-capai-customer__name",t(k)(h.customer.noShowCount).class])},[t(k)(h.customer.noShowCount).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(k)(h.customer.noShowCount).icon}`)},null,2)):O("",!0),ce(" "+C(h.customer.firstName+" "+h.customer.lastName),1)],2),m("div",rb,[m("span",{class:q(t(ds)(t(g)[I].status,t(N)).icon),style:be({color:t(ds)(t(g)[I].status,t(N)).color})},null,6),m("div",cb,C(t(ni)(t(g)[I].status)),1)])],2)]),default:x(()=>[h.customer.email&&t(u)||h.customer.phone&&t(r)?(c(),y("div",{key:0,class:q(["am-capai-customer__data-wrapper",t(a).responsiveClass])},[h.customer.email&&t(u)?(c(),y("div",{key:0,class:q(["am-capai-customer__data",t(a).responsiveClass])},[ub,m("a",{href:`mailto:${h.customer.email}`},C(h.customer.email),9,db)],2)):O("",!0),h.customer.phone&&t(r)?(c(),y("div",{key:1,class:q(["am-capai-customer__data",t(a).responsiveClass])},[mb,m("a",{href:`tel:${h.customer.phone}`},C(h.customer.phone),9,pb)],2)):O("",!0)],2)):O("",!0),m("div",{class:q(["am-capai-pay__content",t(a).responsiveClass])},[(c(!0),y(ee,null,fe(h.payments,(L,T)=>(c(),y(ee,{key:T},[m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",gb,C(t(o).date),1),m("div",fb,C(t(nt)(L.dateTime.split(" ")[0])),1)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",hb,C(t(o).payment_method),1),m("div",vb,C(t(Er)(L)),1)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",_b,C(t(o).status),1),m("div",yb,[m("span",{class:q(t(ds)(L.status,t(N)).icon),style:be({color:t(ds)(L.status,t(N)).color})},null,6),ce(" "+C(t(ni)(L.status)),1)])],2)],64))),128)),t(i)>480?(c(),y("div",bb)):O("",!0),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",kb,C(t(o).price),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].bookable)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Cb,C(t(o).extras),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].total-t(g)[I].bookable)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",xb,C(t(o).subtotal),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].total)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",wb,C(t(o).discount_amount),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].discount)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Tb,C(t(o).tax),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].tax)),3)],2),t(g)[I].wcTax?(c(),y("div",{key:1,class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Sb,C(t(o).tax)+" (Woo) ",1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].wcTax)),3)],2)):O("",!0),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Eb,C(t(o).paid_deposit),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].deposit)),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Lb,C(t(o).paid_remaining_amount),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].paid?t(g)[I].paid-t(g)[I].deposit:0)),3)],2),t(g)[I].refunded?(c(),y("div",{key:2,class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Ab,C(t(o).refunded),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].refunded)),3)],2)):O("",!0),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",Ib,C(t(o).due),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].paid-(t(g)[I].total-t(g)[I].discount+t(g)[I].tax+t(g)[I].wcTax))),3)],2),m("div",{class:q(["am-capai-pay__row",t(a).responsiveClass])},[m("div",$b,C(t(o).total),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":t(i)>480}])},C(t(tt)(t(g)[I].total-t(g)[I].discount+t(g)[I].tax+t(g)[I].wcTax)),3)],2)],2)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])}}};const Db={class:"am-capai__footer"},Nb={name:"CabinetAppointment"},Ob=Object.assign(Nb,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number},linkedAppointments:{type:Array,default:()=>[]}},emits:["close","save","editLinkedAppointment"],setup(n,{emit:a}){const e=n;let s=De(),l=R("amLabels");R("settings");let i=R("licence");const o=F("details"),r=F(null);let u=_(()=>s.getters["appointment/getEmployeeService"]),d=F(null),f=F(""),v=_(()=>s.getters["appointment/getBookings"].length?s.getters["appointment/getBookings"].filter(X=>X.status==="approved"||X.status==="pending").map(X=>X.persons).reduce((X,M)=>X+M,0):0),g=F(null),k=_(()=>s.getters["appointment/getCustomFields"]),N=F(null);Be("recurringList",N);function E(X,M){let Z=he(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),W={};return s.getters["appointment/getStartDate"]&&s.getters["appointment/getStartTime"]&&!M&&(W[Z]={},W[Z][s.getters["appointment/getStartTime"]]=!0),N.value&&N.value.forEach((le,de)=>{if(le.time&&(X!==null?de!==X:!0)){let ae=he(le.date).format("YYYY-MM-DD");ae in W||(W[ae]={}),W[ae][le.time]=!0}}),W}function b(X,M,Z){if(M.date===null)return[];let W=he(M.date).format("YYYY-MM-DD"),le=E(X,Z),de=M.time?Bt(M.time):null;if(W in le){let ae=M.times.filter(ye=>!Object.keys(le[W]).includes(ye)),xe=[];return ae.forEach(ye=>{let pe=Bt(ye),Te=!0;Object.keys(le[W]).map(Pe=>Bt(Pe)).sort((Pe,Oe)=>Pe-Oe).forEach(Pe=>{pe<Pe?pe+u.value.duration+u.value.timeAfter>Pe&&(Te=!1):Pe+u.value.duration+u.value.timeAfter>pe&&(Te=!1)}),Te&&(de!==null&&pe>de&&xe.indexOf(M.time)===-1&&xe.push(M.time),xe.push(ye))}),A(W,le,xe)}return A(W,le,M.times)}function A(X,M,Z){let W=[],le=!1,de=he(X,"YYYY-MM-DD").subtract(1,"days").format("YYYY-MM-DD");if(de in M){let xe=Object.keys(M[de]).map(pe=>Bt(pe)).sort((pe,Te)=>pe-Te),ye=xe[xe.length-1]+u.value.duration+u.value.timeAfter;ye>86400&&(Z.forEach(pe=>{ye-86400<=Bt(pe)&&W.push(pe)}),Z=W,le=!0)}let ae=he(X,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD");if(ae in M){let xe=Object.keys(M[ae]).map(ye=>Bt(ye)).sort((ye,pe)=>ye-pe);xe[0]-u.value.duration-u.value.timeAfter<0&&(Z.forEach(ye=>{let pe=Bt(ye);(pe+u.value.duration+u.value.timeAfter<=86400||xe[0]>=pe+u.value.duration+u.value.timeAfter-86400)&&W.push(ye)}),le=!0)}return le?W:Z}let S=F({});Be("slotsPricing",S);let P=F(""),h=F({}),I=F([]);function L(X){I.value=Object.keys(h.value[he(X).format("YYYY-MM-DD")])}function T(X){let M=h.value[he(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD")][X][0].l;M&&s.commit("appointment/setLocationId",M)}function w(X,M,Z,W){let le=he(X).format("YYYY-MM-DD");return typeof W>"u"&&!(le in h.value&&(M?b(null,{date:X,times:Object.keys(h.value[le])},Z).length:!0))}let B=F(!1),z=_(()=>{let X={};return s.getters["appointment/getBookings"].filter(M=>M.status==="pending"||M.status==="approved").forEach(M=>{M.extras.forEach(Z=>{Z.quantity&&!(Z.extraId in X)&&(X[Z.extraId]={id:Z.extraId,quantity:Z.quantity})})}),{serviceId:s.getters["appointment/getServiceId"],serviceDuration:Math.max.apply(Math,s.getters["appointment/getBookings"].filter(M=>M.status!=="canceled"&&M.status!=="rejected").map(M=>M.duration)),providerIds:s.getters["appointment/getProviderId"]?[s.getters["appointment/getProviderId"]]:[],locationId:s.getters["appointment/getLocationId"],extras:JSON.stringify(Object.values(X)),persons:v.value?v.value:1,excludeAppointmentId:s.getters["appointment/getId"],group:s.getters["appointment/getId"]?0:1,timeZone:s.getters["cabinet/getTimeZone"],monthsLoad:1,page:"appointments",structured:!0}});function D(X=!1){s.getters["appointment/getStartDate"]&&G(s.getters["appointment/getStartDate"],null,!1,X)}function G(X,M=null,Z=!1,W=!1){s.getters["appointment/getServiceId"]&&(B.value=!0,$o(Object.assign({startDateTime:X?he(X).startOf("month").subtract(6,"days").format("YYYY-MM-DD"):null,endDateTime:X?he(X).endOf("month").add(6,"days").format("YYYY-MM-DD"):null},z.value),{},(le,de,ae,xe)=>{if(P.value=xe,s.getters["appointment/getStartDate"]&&M===null&&!Z){let pe=he(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD");pe in le?(s.getters["appointment/getStartTime"]&&!(s.getters["appointment/getStartTime"]in le[pe])&&!W&&s.commit("appointment/setStartTime",null),I.value=Object.keys(le[pe]),h.value=le):W||(h.value={},s.commit("appointment/setStartTime",null),s.commit("appointment/setStartDate",null),s.commit("appointment/setTargetedDate",null),I.value=[])}else h.value=le;let ye=!i.isLite&&!i.isStarter&&!i.isBasic?ac(s,le,s.getters["appointment/getServiceId"]):null;S.value=ye?ye.dates:{},B.value=!1},()=>{}))}function se(){h.value={},P.value=null,N.value=null}function j(X){if(X){if(X===1)return{class:"am-no-show-1",icon:"no-show-1"};if(X===2)return{class:"am-no-show-2",icon:"no-show-2"};if(X>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}Be("noShowData",{noShowData:j});let ne=F(!1),te=F("");function oe(){ne.value=!1,te.value=""}let ie=F(!1),K=F(null);function me(){const X=new Promise(W=>{g.value?.customFieldsFormRef?g.value.customFieldsFormRef.validate(le=>{le?W(!0):(o.value="customFields",W(!1))}):W(!0)}),M=new Promise(W=>{d.value?.customersFormRef?d.value.customersFormRef.validate(le=>{!le||!s.getters["customerInfo/getCustomersIds"].length?(o.value="customers",W(!1)):W(!0)}):W(!0)}),Z=new Promise(W=>{r.value?.detailsFormRef?r.value.detailsFormRef.validate(le=>{!le||!s.getters["appointment/getServiceId"]||!s.getters["appointment/getStartDate"]||!s.getters["appointment/getStartTime"]?(o.value="details",W(!1)):W(!0)}):W(!0)});Promise.all([X,M,Z]).then(W=>{if(!W.includes(!1)){if(f.value=s.getters["appointment/getBookings"].filter(le=>le.status!=="canceled"&&le.status!=="rejected").map(le=>le.persons).reduce((le,de)=>le+de,0)>u.value.maxCapacity?l.value.select_max_customer_count_warning+" "+u.value.maxCapacity:"",f.value){o.value="customers";return}Ae()}})}function Ae(){let X=[];s.getters["appointment/getBookings"].forEach(le=>{let de={};Object.keys(le.customFields).forEach(ae=>{de[ae]=Object.assign({},le.customFields[ae],{value:le.customFields[ae].type==="datepicker"?le.customFields[ae].value?he(le.customFields[ae].value).format("YYYY-MM-DD"):null:le.customFields[ae].value})}),X.push(Object.assign({},le,{customerId:le.customer.id,extras:le.extras.filter(ae=>ae.quantity),customFields:de}))});let M=[];if(K.value){let le=K.value.bookings.map(ae=>"id"in ae&&ae.id),de=X.map(ae=>"id"in ae&&ae.id);M=K.value.bookings.filter(ae=>le.filter(xe=>!de.includes(xe)).includes(ae.id)).map(ae=>new Object({id:ae.id}))}let Z=s.getters["cabinet/getTimeZone"],W={serviceId:s.getters["appointment/getServiceId"],providerId:s.getters["appointment/getProviderId"],locationId:s.getters["appointment/getLocationId"],bookings:X,removedBookings:M,bookingStart:he(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD")+" "+s.getters["appointment/getStartTime"],utc:Z==="UTC",timeZone:Z==="UTC"?null:Z,notifyParticipants:s.getters["appointment/getNotifyParticipants"]?1:0,internalNotes:s.getters["appointment/getInternalNotes"],id:s.getters["appointment/getId"],payment:{gateway:"onSite"},recurring:N.value?N.value.map(le=>new Object({bookingStart:he(le.date).format("YYYY-MM-DD")+" "+le.time,providerId:le.slot[0][0],locationId:le.slot[0][1]})):[],lessonSpace:s.getters["appointment/getLessonSpace"]?"https://www.thelessonspace.com/space/"+s.getters["appointment/getLessonSpace"]:null,createPaymentLinks:s.getters["appointment/getCreatePaymentLinks"]?1:0};ie.value=!0,Ne.post("/appointments"+(s.getters["appointment/getId"]?"/"+s.getters["appointment/getId"]:""),W,Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(le=>{le.data.data.appointment.id&&Ve("save")}).catch(le=>{te.value=l.value.error,"response"in le&&"data"in le.response&&"data"in le.response.data&&("timeSlotUnavailable"in le.response.data.data&&le.response.data.data.timeSlotUnavailable===!0&&(te.value=l.value.time_slot_unavailable,o.value="details"),"customerAlreadyBooked"in le.response.data.data&&le.response.data.data.customerAlreadyBooked===!0&&(te.value=l.value.customer_already_booked,o.value="customers")),ne.value=!0}).finally(()=>{ie.value=!1})}function Ve(X){s.commit("appointment/setActive",!1),a(X)}Je(()=>{if(s.commit("appointment/setActive",!0),s.getters["appointment/getId"]){K.value=JSON.parse(JSON.stringify(s.getters["appointment/getAppointmentData"]));let X=s.getters["entities/filteredLocations"]({categoryId:null,serviceId:null,providerId:s.getters["appointment/getProviderId"],locationId:null}),M=s.getters["entities/filteredServices"]({categoryId:null,serviceId:null,providerId:s.getters["appointment/getProviderId"],locationId:null});s.getters["appointment/getId"]&&s.getters["appointment/getServiceId"]&&M.map(W=>W.id).indexOf(s.getters["appointment/getServiceId"])===-1||s.getters["appointment/getId"]&&s.getters["appointment/getLocationId"]&&X.map(W=>W.id).indexOf(s.getters["appointment/getLocationId"])===-1||D(!0)}s.getters["appointment/getServiceId"]&&(s.dispatch("appointment/updateEmployeeService",s.getters["appointment/getServiceId"]),s.dispatch("appointment/addAllCustomFieldsFormRules",{label:l.value.required_field}))});let Q=R("amColors"),_e=_(()=>({"--am-c-capai-text":Q.value.colorMainText,"--am-c-capai-text-op10":H(Q.value.colorMainText,.1),"--am-c-capai-primary":Q.value.colorPrimary,"--am-c-cust-no1":Q.value.colorMainText,"--am-c-cust-no1-bgr":H(Q.value.colorMainText,.1),"--am-c-cust-no2":Q.value.colorWarning,"--am-c-cust-no2-bgr":H(Q.value.colorWarning,.1),"--am-c-cust-no3":Q.value.colorError,"--am-c-cust-no3-bgr":H(Q.value.colorError,.1),"--am-c-cust-link":H(Q.value.colorMainText,.5),"--am-c-cust-text":Q.value.colorMainText}));return(X,M)=>{const Z=va,W=_a;return t(ie)?(c(),U(Wt,{key:1})):(c(),y("div",{key:0,class:q(["am-capai",[{"am-no-border":!0},t(e).responsiveClass]]),style:be(t(_e))},[t(ne)?(c(),U(_t,{key:0,class:"am-asi__top-message am-asi__top-message-error",type:"error","show-icon":!0,"show-border":!0,"close-after":5e3,onClose:oe,onTriggerClose:oe},{title:x(()=>[ce(C(t(te)),1)]),_:1})):O("",!0),$(W,{modelValue:o.value,"onUpdate:modelValue":M[1]||(M[1]=le=>o.value=le)},{default:x(()=>[$(Z,{label:t(l).details,name:"details"},{default:x(()=>[$(V_,{ref_key:"appointmentDetailsRef",ref:r,"slots-props":t(z),"slots-loading":t(B),"free-slots":t(h),"is-disabled-date":w,times:t(I),"get-free-times":b,onRemoveSlots:se,onFetchSlots:G,onSelectDate:L,onSelectTime:T},null,8,["slots-props","slots-loading","free-slots","times"])]),_:1},8,["label"]),t(u)?(c(),U(Z,{key:0,label:t(l).customers,name:"customers"},{default:x(()=>[$(ly,{ref_key:"appointmentCustomersRef",ref:d,"responsive-class":t(e).responsiveClass,"capacity-warning":t(f),"appointment-capacity":t(v),"saved-appointment":t(K),onChangedSlotCondition:D},null,8,["responsive-class","capacity-warning","appointment-capacity","saved-appointment"])]),_:1},8,["label"])):O("",!0),t(u)&&t(u).extras.length&&t(s).getters["appointment/getBookings"].length?(c(),U(Z,{key:1,label:t(l).extras,name:"extras"},{default:x(()=>[$(by,{"responsive-class":t(e).responsiveClass,onChangedSlotCondition:D},null,8,["responsive-class"])]),_:1},8,["label"])):O("",!0),t(u)&&t(k).length&&t(s).getters["appointment/getBookings"].length?(c(),U(Z,{key:2,label:t(l).custom_fields,name:"customFields"},{default:x(()=>[$(cy,{ref_key:"appointmentCustomFieldsRef",ref:g,"responsive-class":t(e).responsiveClass},null,8,["responsive-class"])]),_:1},8,["label"])):O("",!0),t(s).getters["appointment/getId"]&&n.linkedAppointments.length?(c(),U(Z,{key:3,label:t(l).linked,name:"linked"},{default:x(()=>[$(ob,{"linked-appointments":n.linkedAppointments,"responsive-class":t(e).responsiveClass,onEditLinkedAppointment:M[0]||(M[0]=le=>t(a)("editLinkedAppointment",le))},null,8,["linked-appointments","responsive-class"])]),_:1},8,["label"])):O("",!0),t(u)&&t(u).recurringCycle!=="disabled"&&t(s).getters["appointment/getStartDate"]&&t(s).getters["appointment/getStartTime"]&&!t(s).getters["appointment/getId"]&&!!t(s).getters["customerInfo/getCustomersIds"].length?(c(),U(Z,{key:4,label:t(l).recurring,name:"recurring"},{default:x(()=>[$(Xy,{"free-slots":t(h),"slots-props":t(z),"maximum-booking-start-date":t(P),"get-free-times":b,"get-selected-dates-times":E,"is-disabled-date":w,"slots-loading":t(B),"responsive-class":t(e).responsiveClass,onFetchSlots:G},null,8,["free-slots","slots-props","maximum-booking-start-date","slots-loading","responsive-class"])]),_:1},8,["label"])):O("",!0),t(s).getters["appointment/getId"]?(c(),U(Z,{key:5,label:t(l).payment,name:"payment"},{default:x(()=>[$(Pb,{"responsive-class":t(e).responsiveClass,"saved-appointment":t(K)},null,8,["responsive-class","saved-appointment"])]),_:1},8,["label"])):O("",!0)]),_:1},8,["modelValue"]),m("div",Db,[$(Se,{category:"secondary",size:"default",type:"plain",onClick:M[2]||(M[2]=()=>{t(a)("close")})},{default:x(()=>[ce(C(t(l).cancel),1)]),_:1}),$(Se,{size:"default",onClick:me},{default:x(()=>[ce(C(t(l).save),1)]),_:1})])],6))}}});const Mb={key:0,class:"el-skeleton-item-wrapper-title"},Fb={name:"AuthSkeleton"},Pi=Object.assign(Fb,{props:{centerFirst:{type:Boolean,default:!1},count:{type:Number,default:3},mainClass:{type:String,default:""}},setup(n){const a=n;return(e,s)=>{const l=Ml,i=Fl;return c(),U(i,{animated:"",class:q(["am-asi-el-skeleton",[{"am-asi":t(a).mainClass}]])},{template:x(()=>[t(a).centerFirst?(c(),y("div",Mb,[$(l,{variant:"rect"})])):O("",!0),(c(!0),y(ee,null,fe(new Array(t(a).count),o=>(c(),y("div",{key:o,class:"el-skeleton-item-wrapper"},[$(l,{variant:"rect"})]))),128))]),_:1},8,["class"])}}});const Vb={key:0,class:"am-icon-checkmark-circle-full"},Bb={key:1,class:"am-icon-clearable"},Rb={key:2,class:"am-cap__actions"},qb={name:"CabinetAppointments",key:"appointments"},Ub=Object.assign(qb,{props:{loadBookingsCounter:{type:Number,default:0},appointments:{type:Object,default:null}},setup(n){const a=n;let e=De();const s=R("settings");let l=R("amCustomize");const i=R("shortcodeData"),o=R("labels"),r=R("localLanguage");let u=_(()=>s.general.usedLanguages.includes(r.value)),d=_(()=>{let ie=Qe({...o}),K=l.value.appointments.translations;return K&&Object.keys(K).forEach(me=>{K[me][r.value]&&u.value?ie[me]=K[me][r.value]:K[me].default&&(ie[me]=K[me].default)}),ie});Be("amLabels",d);const f=F(null),{width:v}=ja(f);let g=_(()=>st(v.value));Be("pageWidth",v);let k=F(null),N=F(!1),E=F("success"),b=F("");function A(){N.value=!1,e.commit("cabinet/setPaymentLinkError",{value:!1,type:"appointment"})}let S=R("cabinetType");e.commit("cabinetFilters/setDates",mi(S.value));let P=_(()=>e.getters["cabinet/getAppointmentsLoading"]),h=_(()=>e.getters["entities/getReady"]),I=F(null),L=F(0),T=F(1);function w(ie){T.value=ie,B(null,ie)}function B(ie=null,K=1){e.commit("cabinet/setAppointmentsLoading",!0);let me=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getAppointmentsFilters"])),Ae=e.getters["cabinet/getTimeZone"];me.dates=me.dates.map(Q=>he(Q).format("YYYY-MM-DD")),me.timeZone=Ae,me.source="cabinet-"+S.value,me.page=K,e.commit("auth/setLoadingAppointmentsCounter",e.getters["auth/getLoadingAppointmentsCounter"]+1);let Ve=e.getters["auth/getLoadingAppointmentsCounter"];Ne.get("/appointments",Object.assign(ze(e),{params:Js(me)})).then(Q=>{Ve===e.getters["auth/getLoadingAppointmentsCounter"]&&(L.value=Q.data.data.total,I.value=vr(Q.data.data.appointments,Ae,S.value==="provider"))}).catch(Q=>{Q?.response?.data?.data?.reauthorize!==void 0&&Q.response.data.data.reauthorize&&e.dispatch("auth/logout"),console.log(Q)}).finally(()=>{Ve===e.getters["auth/getLoadingAppointmentsCounter"]&&(e.commit("cabinet/setAppointmentsLoading",!1),ie&&"message"in ie&&(N.value=!0,b.value=ie.message,E.value="success",f.value&&k.value&&setTimeout(function(){dt(f.value,k.value.$el,0,300)},500)))})}let z=F([]);function D(ie){e.commit("cabinet/setAppointmentsLoading",!0),Ne.get("/appointments/"+ie.id,Object.assign({params:{source:"cabinet-"+S.value,timeZone:e.getters["cabinet/getTimeZone"]}},ze(e))).then(K=>{let me=K.data.data.appointment.bookingStart.split(" "),Ae=e.getters["entities/getService"](K.data.data.appointment.serviceId),Ve=[];K.data.data.appointment.bookings.forEach(Q=>{let _e=[];Ae.extras.sort((M,Z)=>M.position-Z.position).forEach(M=>{_e.push({extraId:M.id,quantity:0});let Z=Q.extras.find(W=>W.extraId===M.id);typeof Z<"u"&&(_e[_e.length-1]=Z)});let X=Q.customFields?JSON.parse(Q.customFields):{};Object.keys(X).forEach(M=>{X[M]=Object.assign({},X[M],{value:X[M].type==="datepicker"?X[M].value?he(X[M].value).toDate():"":X[M].value})}),Ve.push({id:Q.id,customer:ie.bookings.find(M=>M.id===Q.id).customer,persons:Q.persons,status:Q.status,duration:Q.duration?Q.duration.toString():null,extras:_e,customFields:X,payments:Q.payments,price:Q.price,aggregatedPrice:Q.aggregatedPrice,tax:Q.tax,coupon:Q.coupon})}),e.commit("appointment/setAppointment",{id:K.data.data.appointment.id,categoryId:Ae.categoryId,serviceId:K.data.data.appointment.serviceId,providerId:K.data.data.appointment.providerId,locationId:K.data.data.appointment.locationId,internalNotes:K.data.data.appointment.internalNotes,lessonSpace:K.data.data.appointment.lessonSpace!==null?K.data.data.appointment.lessonSpace.split("https://www.thelessonspace.com/space/")[1]:null,startDate:he(me[0]).toDate(),startTime:me[1].substring(0,5),bookings:Ve,notifyParticipants:!!K.data.data.appointment.notifyParticipants,createPaymentLinks:!!K.data.data.appointment.createPaymentLinks}),z.value=K.data.data.recurring,G.value=!0}).catch(K=>{console.log(K)}).finally(()=>{e.commit("cabinet/setAppointmentsLoading",!1)})}let G=F(!1);function se(){N.value=!0,b.value=d.value.appointment_saved,E.value="success",f.value&&k.value&&setTimeout(function(){dt(f.value,k.value.$el,0,300)},500),B(),te()}function j(ie,K){b.value=ie,E.value=K,N.value=!0}function ne(){oe(),G.value=!0}function te(){G.value=!1,oe()}function oe(){e.commit("appointment/resetAppointment",{providerId:e.getters["auth/getProfile"].id}),e.commit("customerInfo/setCustomers",[]),e.commit("customerInfo/setCustomersIds",[])}return rt(()=>a.loadBookingsCounter,()=>{B()}),Je(()=>{B()}),(ie,K)=>(c(),y("div",{ref_key:"pageContainer",ref:f,class:q(["am-cap am-capa-main",{"am-capai-main":t(G)}])},[m("div",{class:q(["am-capa-main__inner",t(g)])},[t(N)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:k,type:t(E),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:A,onTriggerClose:A},{title:x(()=>[t(E)==="success"?(c(),y("span",Vb)):O("",!0),t(E)==="error"?(c(),y("span",Bb)):O("",!0),ce(" "+C(t(b)),1)]),_:1},8,["type"])):O("",!0),!t(G)&&t(h)?(c(),U($i,{key:1,"step-key":"appointments","responsive-class":t(g),empty:!1,onAddAppointment:ne,onChangeFilters:B},null,8,["responsive-class"])):O("",!0),t(i).cabinetType==="employee"&&t(s).roles.allowWriteAppointments&&!t(G)&&t(h)?(c(),y("div",Rb,[$(Se,{prefix:"plus",size:"small",category:"primary",type:t(l).appointments.options.newAppBtn.buttonType,onClick:ne},{default:x(()=>[m("span",null,C(t(d).new_appointment),1)]),_:1},8,["type"])])):O("",!0),!t(P)&&t(h)?(c(),y(ee,{key:3},[!t(G)&&t(I)&&Object.keys(t(I)).length>0?(c(),U(xr,{key:0,"grouped-appointments":t(I),"page-width":t(v),"responsive-class":t(g),"step-key":"appointments",onCanceled:B,onBooked:B,onEditAppointment:D,onStatusChange:j},null,8,["grouped-appointments","page-width","responsive-class"])):t(G)?O("",!0):(c(),U(Ia,{key:1,heading:t(d).no_app_found,text:t(d).have_no_app},null,8,["heading","text"])),!t(G)&&t(I)&&Object.keys(t(I)).length>0&&t(L)>t(s).general.itemsPerPageBackEnd?(c(),U(Al,{key:2,"page-size":t(s).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:t(L),"current-page":t(T),onCurrentChange:w},null,8,["page-size","total","current-page"])):O("",!0),t(G)?(c(),U(Ob,{key:3,"page-width":t(v),"responsive-class":t(g),"linked-appointments":t(z),onEditLinkedAppointment:D,onClose:te,onSave:se},null,8,["page-width","responsive-class","linked-appointments"])):O("",!0)],64)):(c(),U(Pi,{key:4}))],2)],2))}});function ys(n,a,e={},s={}){for(let l in a)l in n&&a[l]&&typeof a[l]=="object"?(l in s||(s[l]={}),ys(n[l],a[l],l in e?e[l]:n[l],s[l]),Object.keys(s[l]).length===0&&delete s[l]):l in e?s[l]=e[l]:l in n?s[l]=n[l]:s[l]=a[l];return s}function zb(n){at.activation.stash&&Ne.post("/stash",{},Object.assign(ze(n),{params:{source:"cabinet-provider"}})).then(()=>{}).catch(()=>{})}function jb(n,a){let e=n.getters["event/getDefaultEvent"],s=[],l={};a.customTickets.length&&a.bookings.forEach(r=>{r.ticketsData.forEach(u=>{l[u.eventTicketId]=!0})}),a.customTickets.forEach(r=>{JSON.parse(r.dateRanges).forEach((u,d)=>{d in s||s.push({enabled:u.enabled,range:[he(u.startDate,"YYYY-MM-DD").toDate(),he(u.endDate,"YYYY-MM-DD").toDate()],tickets:[]}),s[d].tickets.push({price:u.price})}),r.booked=r.id in l});let i=!a.description||a.description.startsWith("<!-- Content -->")?"text":"html",o=a.description?a.description.replace("<!-- Content -->",""):"";return Object.assign({},a,{description:o,descriptionMode:i,tags:a.tags.map(r=>r.name),organizerId:a.organizerId,periods:a.periods.map(r=>new Object({id:r.id,eventId:r.eventId,appleCalendarEventId:r.appleCalendarEventId,googleCalendarEventId:r.googleCalendarEventId,googleMeetUrl:r.googleMeetUrl,outlookCalendarEventId:r.outlookCalendarEventId,startDate:he(r.periodStart.split(" ")[0],"YYYY-MM-DD").toDate(),endDate:he(r.periodEnd.split(" ")[0],"YYYY-MM-DD").toDate(),startTime:r.periodStart.split(" ")[1].substring(0,5),endTime:r.periodEnd.split(" ")[1].substring(0,5)})),bookingOpens:{disabled:a.bookingOpens===null,date:a.bookingOpens?he(a.bookingOpens.split(" ")[0],"YYYY-MM-DD").toDate():null,time:a.bookingOpens?a.bookingOpens.split(" ")[1].substring(0,5):null},bookingOpensRec:a.bookingOpensRec==="same",bookingCloses:{disabled:a.bookingCloses===null,date:a.bookingCloses?he(a.bookingCloses.split(" ")[0],"YYYY-MM-DD").toDate():null,time:a.bookingCloses?a.bookingCloses.split(" ")[1].substring(0,5):null},bookingClosesRec:a.bookingClosesRec==="same",recurringEnabled:a.recurring&&a.recurring.cycle!==null,recurring:a.recurring!==null?Object.assign({},a.recurring,{until:a.recurring.until?he(a.recurring.until.split(" ")[0],"YYYY-MM-DD").toDate():null,monthDate:a.recurring.monthDate?he(a.recurring.monthDate.split(" ")[0],"YYYY-MM-DD").toDate():null}):e.recurring,depositEnabled:a.depositPayment!=="disabled",depositPayment:a.depositPayment!=="disabled"?a.depositPayment:"percentage",customTicketsRangesEnabled:s.length>0,customTicketsRanges:s,maxCustomCapacity:a.maxCustomCapacity===null?1:a.maxCustomCapacity,maxCustomCapacityEnabled:a.maxCustomCapacity!==null,closeAfterMinEnabled:a.closeAfterMin!==null,closeAfterMinBookings:a.closeAfterMinBookings,closeAfterMin:a.closeAfterMin===null?1:a.closeAfterMin,maxExtraPeopleEnabled:a.maxExtraPeople!==null,maxExtraPeople:a.maxExtraPeople===null?0:a.maxExtraPeople,locationId:a.locationId===null&&a.customLocation?0:a.locationId,settings:ys(at,e.settings,a.settings?JSON.parse(a.settings):{},{})})}function Yb(n){let a=n.getters["event/getDefaultEvent"],e=[];n.getters["event/getCustomTickets"].forEach((l,i)=>{let o=[];n.getters["event/getCustomTicketsRanges"].filter(r=>r.range[0]&&r.range[1]).forEach(r=>{o.push({startDate:he(r.range[0]).format("YYYY-MM-DD"),endDate:he(r.range[1]).format("YYYY-MM-DD"),price:r.tickets[i].price})}),e.push(Object.assign({},l,{dateRanges:JSON.stringify(o)}))});let s=ys(ys(at,a.settings,{},{}),a.settings,n.getters["event/getSettings"],{});return Object.keys(n.getters["event/getSettings"]).forEach(l=>{Object.keys(n.getters["event/getSettings"][l]).forEach(i=>{n.getters["event/getSettings"][l][i]!==null&&typeof n.getters["event/getSettings"][l][i]=="object"?(Object.keys(n.getters["event/getSettings"][l][i]).forEach(o=>{(n.getters["event/getSettings"][l][i][o]===at[l][i][o]||at[l][i][o]&&(n.getters["event/getSettings"][l][i][o]===""||n.getters["event/getSettings"][l][i][o]===null))&&delete s[l][i][o]}),typeof s[l][i]=="object"&&Object.keys(s[l][i]).length===0&&delete s[l][i]):l in at&&i in at[l]&&(s[l][i]===at[l][i]||at[l][i]&&(n.getters["event/getSettings"][l][i]===""||n.getters["event/getSettings"][l][i]===null))&&delete s[l][i]}),Object.keys(s[l]).length===0&&delete s[l]}),{aggregatedPrice:n.getters["event/getAggregatedPrice"],bookMultipleTimes:n.getters["event/getBookMultipleTimes"],bookingCloses:!n.getters["event/getBookingClosesDisabled"]&&n.getters["event/getBookingClosesDate"]&&n.getters["event/getBookingClosesTime"]?he(n.getters["event/getBookingClosesDate"]).format("YYYY-MM-DD")+" "+n.getters["event/getBookingClosesTime"]+":00":null,bookingClosesRec:n.getters["event/getBookingClosesRec"]?"same":"calculate",bookingOpens:!n.getters["event/getBookingOpensDisabled"]&&n.getters["event/getBookingOpensDate"]&&n.getters["event/getBookingOpensTime"]?he(n.getters["event/getBookingOpensDate"]).format("YYYY-MM-DD")+" "+n.getters["event/getBookingOpensTime"]+":00":null,bookingOpensRec:n.getters["event/getBookingOpensRec"]?"same":"calculate",bringingAnyone:n.getters["event/getBringingAnyone"],closeAfterMin:n.getters["event/getCloseAfterMinEnabled"]?n.getters["event/getCloseAfterMin"]:null,closeAfterMinBookings:n.getters["event/getCloseAfterMinBookings"],color:n.getters["event/getColor"],customLocation:n.getters["event/getCustomLocation"],customPricing:n.getters["event/getCustomPricing"],customTickets:e,deposit:n.getters["event/getDeposit"],depositPayment:n.getters["event/getDepositEnabled"]?n.getters["event/getDepositPayment"]:"disabled",depositPerPerson:n.getters["event/getDepositPerPerson"],description:n.getters["event/getDescription"]&&n.getters["event/getDescriptionMode"]==="text"?"<!-- Content -->"+n.getters["event/getDescription"]:n.getters["event/getDescription"],fullPayment:n.getters["event/getFullPayment"],gallery:n.getters["event/getGallery"],id:n.getters["event/getId"],locationId:n.getters["event/getLocationId"]===0?null:n.getters["event/getLocationId"],maxCapacity:n.getters["event/getMaxCapacity"],maxCustomCapacity:n.getters["event/getMaxCustomCapacityEnabled"]?n.getters["event/getMaxCustomCapacity"]:null,maxExtraPeople:n.getters["event/getMaxExtraPeopleEnabled"]?n.getters["event/getMaxExtraPeople"]:null,name:n.getters["event/getName"],notifyParticipants:n.getters["event/getNotifyParticipants"],organizerId:n.getters["event/getOrganizerId"],parentId:n.getters["event/getParentId"],periods:Lr(n),price:n.getters["event/getPrice"],providers:n.getters["event/getId"]?n.getters["event/getProviders"]:[{id:n.getters["auth/getProfile"].id,firstName:n.getters["auth/getProfile"].firstName,lastName:n.getters["auth/getProfile"].lastName,email:n.getters["auth/getProfile"].email,type:"provider"}],recurring:n.getters["event/getRecurringEnabled"]?Object.assign({},n.getters["event/getRecurring"],{until:he(n.getters["event/getRecurringUntil"]).format("YYYY-MM-DD"),monthDate:n.getters["event/getRecurringMonthDate"]?he(n.getters["event/getRecurringMonthDate"]).format("YYYY-MM-DD"):null}):null,settings:Object.keys(s).length?JSON.stringify(s):null,show:n.getters["event/getShow"],tags:n.getters["event/getTags"].map(l=>new Object({name:l})),timeZone:n.getters["cabinet/getTimeZone"],translations:n.getters["event/getTranslations"],utc:n.getters["cabinet/getTimeZone"]==="UTC",zoomUserId:n.getters["event/getZoomUserId"]}}function Lr(n){return n.getters["event/getPeriods"].map(a=>new Object({id:a.id,eventId:a.eventId,appleCalendarEventId:a.appleCalendarEventId,googleCalendarEventId:a.googleCalendarEventId,googleMeetUrl:a.googleMeetUrl,outlookCalendarEventId:a.outlookCalendarEventId,microsoftTeamsUrl:a.microsoftTeamsUrl,periodStart:n.getters["cabinet/getTimeZone"]==="UTC"?he(a.startDate).utc().format("YYYY-MM-DD")+" "+a.startTime+":00":he(a.startDate).format("YYYY-MM-DD")+" "+a.startTime+":00",periodEnd:n.getters["cabinet/getTimeZone"]==="UTC"?he(a.endDate).utc().format("YYYY-MM-DD")+" "+a.endTime+":00":he(a.endDate).format("YYYY-MM-DD")+" "+a.endTime+":00"}))}const xl=Qe(window.wpAmeliaLabels);function bo(n,a={}){return Object.assign(a,{id:n.id,eventId:n.event.id,customer:n.customer,customerId:n.customer.id,persons:n.persons,customFields:n.customFields?JSON.parse(n.customFields):{},ticketsData:n.ticketsData,status:n.status,tax:n.tax,price:n.price,coupon:n.coupon,payments:n.payments})}function Ar(n){let a={};return Object.keys(n.getters["attendee/getCustomFields"]).forEach(e=>{a[e]={label:n.getters["attendee/getCustomFields"][e].label,type:n.getters["attendee/getCustomFields"][e].type,value:n.getters["attendee/getCustomFields"][e].type==="datepicker"?n.getters["attendee/getCustomFields"][e].value?he(n.getters["attendee/getCustomFields"][e].value).format("YYYY-MM-DD"):null:n.getters["attendee/getCustomFields"][e].value}}),{id:n.getters["attendee/getId"],type:"event",eventId:n.getters["attendee/getEventId"],bookings:[{customerId:n.getters["attendee/getCustomerId"],persons:n.getters["attendee/getPersons"],customFields:a,ticketsData:n.getters["attendee/getTickets"],status:n.getters["attendee/getStatus"],coupon:n.getters["attendee/getCoupon"]}],status:n.getters["attendee/getStatus"],validateCoupon:!1,isBackendOrCabinet:!0,createPaymentLinks:!1,payment:{gateway:"onSite"}}}function fs(n,a,e=null){let s=a.customFields,l=e&&e.customPricing?e.customTickets.map((i,o)=>new Object({eventTicketId:i.id,persons:o===0&&!Object.keys(a.ticketsData).length?1:0,price:i.price})):[];return e&&(n.getters["entities/getCustomFields"].filter(i=>i.allEvents||i.events.map(o=>o.id).indexOf(e.id)!==-1&&i.type!=="content"&&i.type!=="file").forEach(i=>{s[i.id]={type:i.type,label:i.label,value:i.id in s?s[i.id].value:i.type==="checkbox"||i.type==="file"?[]:"",width:i.width,options:i.options,id:i.id,required:i.required}}),e.customPricing&&Object.keys(a.ticketsData).forEach(i=>{let o=l.find(r=>r.eventTicketId===a.ticketsData[i].eventTicketId);o.id=a.ticketsData[i].id,o.persons=a.ticketsData[i].persons,o.price=a.ticketsData[i].price,o.customerBookingId=a.ticketsData[i].customerBookingId})),Object.assign({},a,{eventId:e?e.id:null,customFields:s,ticketsData:l})}function Ir(){return[{label:xl.approved,value:"approved",icon:"check",color:"var(--am-c-success)"},{label:xl.waiting,value:"waiting",icon:"clock",color:"var(--am-c-warning)"},{label:xl.canceled,value:"canceled",icon:"close",color:"var(--am-c-error)"},{label:xl["no-show"],value:"no-show",icon:"clock",color:"var(--am-c-warning)"}]}function $r(n){let a=0;return n.getters["attendee/getTickets"].length?n.getters["attendee/getTickets"].forEach(e=>{e.persons&&(a+=n.getters["attendee/getAggregatedPrice"]?e.price*e.persons:e.price)}):a=n.getters["attendee/getAggregatedPrice"]?n.getters["attendee/getPrice"]*n.getters["attendee/getPersons"]:n.getters["attendee/getPrice"],oi(null,n.getters["attendee/getCoupon"],n.getters["attendee/getTax"]&&n.getters["attendee/getTax"].length?n.getters["attendee/getTax"][0]:null,a,!1)}const Wb=["innerHTML"],Hb=["innerHTML"],Zb={setup(n,{expose:a}){let e=De(),s=R("amLabels"),l=R("licence");const i=R("settings");let o=F(e.getters["entities/getLocations"]),r=F(e.getters["entities/getTags"]),u=F("");function d(A){u.value=A.toLowerCase()}let f=_(()=>u.value?r.value.filter(A=>A.name.toLowerCase().includes(u.value)):r.value),v=F(null),g=F({name:_({get:()=>e.getters["event/getName"],set:A=>{e.commit("event/setName",A)}}),locationId:_({get:()=>e.getters["event/getLocationId"],set:A=>{e.commit("event/setLocationId",A)}}),customLocation:_({get:()=>e.getters["event/getCustomLocation"],set:A=>{e.commit("event/setCustomLocation",A)}}),organizerId:_({get:()=>e.getters["event/getOrganizerId"],set:A=>{e.commit("event/setOrganizerId",A)}}),zoomUserId:_({get:()=>e.getters["event/getZoomUserId"],set:A=>{e.commit("event/setZoomUserId",A)}}),tags:_({get:()=>e.getters["event/getTags"],set:A=>{e.commit("event/setTags",A)}}),notifyParticipants:_({get:()=>e.getters["event/getNotifyParticipants"],set:A=>{e.commit("event/setNotifyParticipants",A)}}),description:_({get:()=>e.getters["event/getDescription"],set:A=>{e.commit("event/setDescription",A||"")}})}),k=_(()=>g.value.organizerId!==null);function N(A){e.commit("event/setOrganizerId",A?e.getters["auth/getProfile"].id:null)}let E=_(()=>({name:[{required:!0,message:s.value.please_enter_name,trigger:["submit","change"]}]})),b=_(()=>{let A=e.getters["auth/getZoomUsers"];return A.length?A.map(S=>({value:S.id,label:`${S.first_name} ${S.last_name} (${S.email})`})):[]});return a({detailsFormRef:v}),(A,S)=>{const P=yt,h=Vl,I=et;return c(),U(I,{ref_key:"detailsFormRef",ref:v,model:t(g),rules:t(E),class:"am-capei-def"},{default:x(()=>[$(P,{prop:"name",label:`${t(s).name}:`,class:"am-capei-def__item"},{default:x(()=>[$(it,{modelValue:t(g).name,"onUpdate:modelValue":S[0]||(S[0]=L=>t(g).name=L),placeholder:t(s).enter_event_name},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),!t(l).isStarter&&t(o).length>1?(c(),U(P,{key:0,label:`${t(s).event_select_address}:`,class:"am-capei-def__item"},{default:x(()=>[$(He,{modelValue:t(g).locationId,"onUpdate:modelValue":S[1]||(S[1]=L=>t(g).locationId=L),placeholder:t(s).select},{default:x(()=>[(c(),U(qe,{key:0,value:0,label:t(s).event_custom_address},null,8,["label"])),(c(!0),y(ee,null,fe(t(o),L=>(c(),U(qe,{key:L.id,value:L.id,label:L.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):O("",!0),t(g).locationId?O("",!0):(c(),U(P,{key:1,label:`${t(s).event_custom_address}:`,class:"am-capei-def__item"},{default:x(()=>[$(it,{modelValue:t(g).customLocation,"onUpdate:modelValue":S[2]||(S[2]=L=>t(g).customLocation=L)},null,8,["modelValue"])]),_:1},8,["label"])),t(i).zoom.enabled?(c(),U(P,{key:2,label:`${t(s).zoom_user}:`,class:"am-capei-def__item"},{default:x(()=>[$(He,{modelValue:t(g).zoomUserId,"onUpdate:modelValue":S[3]||(S[3]=L=>t(g).zoomUserId=L),clearable:"",placeholder:t(s).zoom_user_placeholder},{default:x(()=>[(c(!0),y(ee,null,fe(t(b),L=>(c(),U(qe,{key:L.value,value:L.value,label:L.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):O("",!0),!t(l).isStarter&&(t(i).googleCalendar.enabled||t(i).outlookCalendar.enabled||t(i).appleCalendar)&&(t(e).getters["employee/getGoogleCalendarId"]||t(e).getters["employee/getOutlookCalendarId"]||t(e).getters["employee/getAppleCalendarId"])?(c(),U(P,{key:3,class:"am-capei-def__item am-capei-def__item-tool"},{default:x(()=>[$(lt,{modelValue:t(k),"onUpdate:modelValue":S[4]||(S[4]=L=>we(k)?k.value=L:k=L),disabled:t(g).organizerId&&t(g).organizerId!==t(e).getters["auth/getProfile"].id,"active-text":t(s).event_organizer,"aria-label":t(s).event_organizer,onChange:N},null,8,["modelValue","disabled","active-text","aria-label"]),$(h,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).event_organizer_tooltip},null,8,Wb)]),default:x(()=>[$(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1})):O("",!0),$(P,{label:`${t(s).event_tags}:`,class:"am-capei-def__item"},{default:x(()=>[$(He,{modelValue:t(g).tags,"onUpdate:modelValue":S[5]||(S[5]=L=>t(g).tags=L),clearable:"",filterable:"",multiple:"","allow-create":!0,placeholder:t(s).event_tags_select_or_create,"filter-method":d},{default:x(()=>[(c(!0),y(ee,null,fe(t(f),(L,T)=>(c(),U(qe,{key:T,value:L.name,label:L.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),$(P,{class:"am-capei-def__item am-capei-def__item-tool"},{default:x(()=>[$(lt,{modelValue:t(g).notifyParticipants,"onUpdate:modelValue":S[6]||(S[6]=L=>t(g).notifyParticipants=L),"active-text":t(s).notify_attendees,"aria-label":t(s).notify_attendees},null,8,["modelValue","active-text","aria-label"]),$(h,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).notify_attendees_tooltip},null,8,Hb)]),default:x(()=>[$(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1}),$(P,{prop:"description",label:t(s).description_colon,class:"am-capei-def__item"},{default:x(()=>[$(gr,{modelValue:t(g).description,"onUpdate:modelValue":S[7]||(S[7]=L=>t(g).description=L),mode:t(e).getters["event/getDescriptionMode"],onSetMode:S[8]||(S[8]=L=>t(e).commit("event/setDescriptionMode",L))},null,8,["modelValue","mode"])]),_:1},8,["label"])]),_:1},8,["model","rules"])}}};const Gb={class:"am-capei-per__segment"},Jb={key:0,class:"am-capei-per__delete"},Xb={class:"am-capei-per__segment"},Qb=["innerHTML"],Kb={class:"am-capei-per__segment"},e1=["innerHTML"],t1={props:{pageWidth:{type:Number,default:0}},setup(n,{expose:a}){const e=n;let s=_(()=>st(e.pageWidth));const l=De(),i=R("settings");let o=R("amLabels"),r=R("localLanguage"),u=F(Ke());function d(P){let h=b.value.periods.map(I=>I.endDate).filter(I=>I instanceof Date&&!isNaN(I));return Ke(P)<u.value||Ke(P)>Ke(new Date(Math.max(...h)))}function f(P,h){const I=Ke(P)<u.value;return(h?Ke(P)>Ke(h):!1)||I}function v(P,h){return h?Ke(P)<Ke(h):Ke(P)<u.value}function g(){let P=!0;E.value.validate(h=>{h||(P=!1)}),P&&b.value.periods.push({eventId:l.getters["event/getId"]?l.getters["event/getId"]:null,startDate:null,endDate:null,startTime:null,endTime:null})}function k(P){l.getters["event/getId"]&&b.value.periods[P]?.id&&b.value.periods[P].id&&b.value.periods.forEach((h,I)=>{I!==P&&!h?.id&&(b.value.periods[I].id=b.value.periods[P].id,b.value.periods[I].eventId=b.value.periods[P].eventId,b.value.periods[I].appleCalendarEventId=b.value.periods[P].appleCalendarEventId,b.value.periods[I].googleCalendarEventId=b.value.periods[P].googleCalendarEventId,b.value.periods[I].googleMeetUrl=b.value.periods[P].googleMeetUrl,b.value.periods[I].outlookCalendarEventId=b.value.periods[P].outlookCalendarEventId,b.value.periods[I].microsoftTeamsUrl=b.value.periods[P].microsoftTeamsUrl)}),b.value.periods.splice(P,1)}let N=_(()=>l.getters["event/getRecurringEnabled"]),E=F(null),b=F({periods:_({get:()=>l.getters["event/getPeriods"],set:P=>{l.commit("event/setPeriods",P)}}),bookingOpensDisabled:_({get:()=>l.getters["event/getBookingOpensDisabled"],set:P=>{l.commit("event/setBookingOpensDisabled",P)}}),bookingOpensDate:_({get:()=>l.getters["event/getBookingOpensDate"],set:P=>{l.commit("event/setBookingOpensDate",P)}}),bookingOpensTime:_({get:()=>l.getters["event/getBookingOpensTime"],set:P=>{l.commit("event/setBookingOpensTime",P)}}),bookingOpensRec:_({get:()=>l.getters["event/getBookingOpensRec"],set:P=>{l.commit("event/setBookingOpensRec",P)}}),bookingClosesDisabled:_({get:()=>l.getters["event/getBookingClosesDisabled"],set:P=>{l.commit("event/setBookingClosesDisabled",P)}}),bookingClosesDate:_({get:()=>l.getters["event/getBookingClosesDate"],set:P=>{l.commit("event/setBookingClosesDate",P)}}),bookingClosesTime:_({get:()=>l.getters["event/getBookingClosesTime"],set:P=>{l.commit("event/setBookingClosesTime",P)}}),bookingClosesRec:_({get:()=>l.getters["event/getBookingClosesRec"],set:P=>{l.commit("event/setBookingClosesRec",P)}})});a({periodsFormRef:E});let A=R("amColors"),S=_(()=>({"--am-c-capei-per-text":A.value.colorMainText,"--am-c-capei-per-text-op03":H(A.value.colorMainText,.03),"--am-c-capei-per-inp-bgr-op03":H(A.value.colorInpBgr,.03)}));return(P,h)=>{const I=yt,L=Vl,T=et;return c(),U(T,{ref_key:"periodsFormRef",ref:E,model:t(b),"label-position":"top",class:"am-capei-per",style:be(t(S))},{default:x(()=>[m("div",Gb,[(c(!0),y(ee,null,fe(t(b).periods,(w,B)=>(c(),y(ee,{key:B},[$(I,{prop:"periods."+B+".startDate",rules:{required:!0,message:t(o).select_date_warning,trigger:["blur","change"]},label:`${t(o).start_date}:`,class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[$(Yt,{modelValue:w.startDate,"onUpdate:modelValue":z=>w.startDate=z,format:t(jt)(),lang:t(r),"disabled-date":z=>f(z,w.endDate)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date"])]),_:2},1032,["prop","rules","label","class"]),$(I,{prop:"periods."+B+".endDate",rules:{required:!0,message:t(o).select_date_warning,trigger:["blur","change"]},label:`${t(o).end_date}:`,class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[$(Yt,{modelValue:w.endDate,"onUpdate:modelValue":z=>w.endDate=z,format:t(jt)(),lang:t(r),"disabled-date":z=>v(z,w.startDate)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date"])]),_:2},1032,["prop","rules","label","class"]),$(I,{prop:"periods."+B+".startTime",rules:{required:!0,message:t(o).select_time_warning,trigger:["blur","change"]},label:`${t(o).start_time}:`,class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[$(Ea,{modelValue:w.startTime,"onUpdate:modelValue":z=>w.startTime=z,start:"00:00",end:t(Nt)(t(Bt)("24:00")-t(i).general.timeSlotLength),"min-time":null,"max-time":w.endTime,step:t(Nt)(t(i).general.timeSlotLength),clearable:!1,placeholder:t(o).select_time},null,8,["modelValue","onUpdate:modelValue","end","max-time","step","placeholder"])]),_:2},1032,["prop","rules","label","class"]),$(I,{prop:"periods."+B+".endTime",rules:{required:!0,message:t(o).select_time_warning,trigger:["blur","change"]},label:`${t(o).end_time}:`,class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[$(Ea,{modelValue:w.endTime,"onUpdate:modelValue":z=>w.endTime=z,disabled:!w.startTime,start:"00:00",end:"24:00","min-time":w.startTime,"max-time":null,step:t(Nt)(t(i).general.timeSlotLength),clearable:!1,placeholder:t(o).select_time},null,8,["modelValue","onUpdate:modelValue","disabled","min-time","step","placeholder"])]),_:2},1032,["prop","rules","label","class"]),t(b).periods.length>1?(c(),y("div",Jb,[$(Se,{size:"default",category:"danger",onClick:z=>k(B)},{default:x(()=>[ce(C(t(o).delete_period),1)]),_:2},1032,["onClick"])])):O("",!0)],64))),128)),$(Se,{size:"default",onClick:h[0]||(h[0]=w=>g())},{default:x(()=>[ce(C(t(o).add_period),1)]),_:1})]),m("div",Xb,[$(mt,{modelValue:t(b).bookingOpensDisabled,"onUpdate:modelValue":h[1]||(h[1]=w=>t(b).bookingOpensDisabled=w),label:t(o).event_booking_opens_now},null,8,["modelValue","label"]),t(b).bookingOpensDisabled?O("",!0):(c(),y(ee,{key:0},[$(I,{label:`${t(o).date}:`,prop:"bookingOpensDate",rules:{required:!0,message:t(o).select_date_warning,trigger:["blur","change"]},class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[$(Yt,{modelValue:t(b).bookingOpensDate,"onUpdate:modelValue":h[2]||(h[2]=w=>t(b).bookingOpensDate=w),format:t(jt)(),lang:t(r),"disabled-date":d},null,8,["modelValue","format","lang"])]),_:1},8,["label","rules","class"]),$(I,{label:`${t(o).time}:`,prop:"bookingOpensTime",rules:{required:!0,message:t(o).select_time_warning,trigger:["blur","change"]},class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[$(Ea,{modelValue:t(b).bookingOpensTime,"onUpdate:modelValue":h[3]||(h[3]=w=>t(b).bookingOpensTime=w),placeholder:t(o).select_time,step:t(Nt)(t(i).general.timeSlotLength),start:"00:00",end:"24:00",clearable:!1},null,8,["modelValue","placeholder","step"])]),_:1},8,["label","rules","class"])],64)),t(N)?(c(),U(mt,{key:1,modelValue:t(b).bookingOpensRec,"onUpdate:modelValue":h[4]||(h[4]=w=>t(b).bookingOpensRec=w)},{default:x(()=>[ce(C(t(o).apply_to_all)+" ",1),$(L,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(o).event_booking_closes_apply},null,8,Qb)]),default:x(()=>[$(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1},8,["modelValue"])):O("",!0)]),m("div",Kb,[$(mt,{modelValue:t(b).bookingClosesDisabled,"onUpdate:modelValue":h[5]||(h[5]=w=>t(b).bookingClosesDisabled=w),label:t(o).event_booking_closes_after},null,8,["modelValue","label"]),t(b).bookingClosesDisabled?O("",!0):(c(),y(ee,{key:0},[$(I,{label:`${t(o).date}:`,prop:"bookingClosesDate",rules:{required:!0,message:t(o).select_date_warning,trigger:["blur","change"]},class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[$(Yt,{modelValue:t(b).bookingClosesDate,"onUpdate:modelValue":h[6]||(h[6]=w=>t(b).bookingClosesDate=w),format:t(jt)(),lang:t(r),"disabled-date":d},null,8,["modelValue","format","lang"])]),_:1},8,["label","rules","class"]),$(I,{label:`${t(o).time}:`,prop:"bookingClosesTime",rules:{required:!0,message:t(o).select_time_warning,trigger:["blur","change"]},class:q(["am-capei-per__item am-w-50",t(s)])},{default:x(()=>[$(Ea,{modelValue:t(b).bookingClosesTime,"onUpdate:modelValue":h[7]||(h[7]=w=>t(b).bookingClosesTime=w),step:t(Nt)(t(i).general.timeSlotLength),start:"00:00",end:"24:00",clearable:!1,placeholder:t(o).select_time},null,8,["modelValue","step","placeholder"])]),_:1},8,["label","rules","class"])],64)),t(N)?(c(),U(mt,{key:1,modelValue:t(b).bookingClosesRec,"onUpdate:modelValue":h[8]||(h[8]=w=>t(b).bookingClosesRec=w)},{default:x(()=>[ce(C(t(o).apply_to_all)+" ",1),$(L,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(o).event_booking_closes_apply},null,8,e1)]),default:x(()=>[$(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1},8,["modelValue"])):O("",!0)])]),_:1},8,["model","style"])}}};const a1={class:"am-capei-recurr__header"},s1={class:"am-capei-recurr__header-text"},l1={props:{pageWidth:{type:Number,default:0},recurringUntil:{type:Object,default:null}},setup(n,{expose:a}){const e=n;let s=_(()=>st(e.pageWidth));const l=De();let i=R("amLabels"),o=R("localLanguage"),r=F([{label:i.value.day,value:"daily"},{label:i.value.week,value:"weekly"},{label:i.value.month,value:"monthly"},{label:i.value.year,value:"yearly"}]),u=F([{label:i.value.recurring_date_first,value:"first"},{label:i.value.recurring_date_second,value:"second"},{label:i.value.recurring_date_third,value:"third"},{label:i.value.recurring_date_fourth,value:"fourth"},{label:i.value.recurring_date_fifth,value:"fifth"},{label:i.value.recurring_date_last,value:"last"}]),d=[{label:i.value.weekday_monday,value:"monday"},{label:i.value.weekday_tuesday,value:"tuesday"},{label:i.value.weekday_wednesday,value:"wednesday"},{label:i.value.weekday_thursday,value:"thursday"},{label:i.value.weekday_friday,value:"friday"},{label:i.value.weekday_saturday,value:"saturday"},{label:i.value.weekday_sunday,value:"sunday"}],f=F(null),v=F({enabled:_({get:()=>l.getters["event/getRecurringEnabled"],set:S=>{l.commit("event/setRecurringEnabled",S)}}),cycle:_({get:()=>l.getters["event/getRecurringCycle"],set:S=>{l.commit("event/setRecurringCycle",S)}}),cycleInterval:_({get:()=>l.getters["event/getRecurringCycleInterval"],set:S=>{l.commit("event/setRecurringCycleInterval",S)}}),monthDate:_({get:()=>l.getters["event/getRecurringMonthDate"],set:S=>{l.commit("event/setRecurringMonthDate",S)}}),monthlyOnDay:_({get:()=>l.getters["event/getRecurringMonthlyOnDay"],set:S=>{l.commit("event/setRecurringMonthlyOnDay",S)}}),monthlyOnRepeat:_({get:()=>l.getters["event/getRecurringMonthlyOnRepeat"],set:S=>{l.commit("event/setRecurringMonthlyOnRepeat",S)}}),monthlyRepeat:_({get:()=>l.getters["event/getRecurringMonthlyRepeat"],set:S=>{l.commit("event/setRecurringMonthlyRepeat",S)}}),order:_({get:()=>l.getters["event/getRecurringOrder"],set:S=>{l.commit("event/setRecurringOrder",S)}}),until:_({get:()=>l.getters["event/getRecurringUntil"],set:S=>{l.commit("event/setRecurringUntil",S)}})}),g=_(()=>({cycle:[{required:!0,message:i.value.select_cycle_warning,trigger:["submit","change"]}],until:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}],monthDate:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}]})),k=_(()=>l.getters["event/getPeriods"]),N=_(()=>e.recurringUntil!==null?e.recurringUntil:k.value.length?Ke(k.value[0].startDate,"YYYY-MM-DD"):Ke());function E(S){return Ke(S)<=N.value}a({recurringFormRef:f});let b=R("amColors"),A=_(()=>({"--am-c-capei-recurr-text":b.value.colorMainText,"--am-c-capei-recurr-text-op03":H(b.value.colorMainText,.03),"--am-c-capei-recurr-inp-bgr-op03":H(b.value.colorInpBgr,.03),"--am-c-capei-recurr-bgr-op03":H(b.value.colorMainText,.03)}));return(S,P)=>{const h=yt,I=et;return c(),y("div",{class:"am-capei-recurr",style:be(t(A))},[m("div",a1,[m("div",s1,C(t(i).event_recurring_check),1),$(lt,{modelValue:t(v).enabled,"onUpdate:modelValue":P[0]||(P[0]=L=>t(v).enabled=L),disabled:!t(k).length||!t(k)[0].startDate||!t(k)[0].endDate,"aria-label":t(i).event_recurring_check},null,8,["modelValue","disabled","aria-label"])]),t(v).enabled&&t(k).length&&t(k)[0].startDate&&t(k)[0].endDate?(c(),U(I,{key:0,ref_key:"recurringFormRef",ref:f,rules:t(g),model:t(v),"label-position":"top",class:"am-capei-recurr__form"},{default:x(()=>[$(h,{label:`${t(i).repeat_every}`,class:q(["am-capei-recurr__form-item am-ws-150",t(s)])},{default:x(()=>[$(ht,{modelValue:t(v).cycleInterval,"onUpdate:modelValue":P[1]||(P[1]=L=>t(v).cycleInterval=L),min:1,disabled:t(e).recurringUntil!==null},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),$(h,{prop:"cycle",class:q(["am-capei-recurr__form-item am-inline-ws-150 am-align-end",t(s)])},{default:x(()=>[$(He,{modelValue:t(v).cycle,"onUpdate:modelValue":P[2]||(P[2]=L=>t(v).cycle=L),clearable:"",placeholder:t(i).select_repeat_period,disabled:t(e).recurringUntil!==null},{default:x(()=>[(c(!0),y(ee,null,fe(t(r),(L,T)=>(c(),U(qe,{key:T,value:L.value,label:L.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["class"]),t(v).cycle==="monthly"?(c(),U(Bl,{key:0,modelValue:t(v).monthlyRepeat,"onUpdate:modelValue":P[6]||(P[6]=L=>t(v).monthlyRepeat=L),class:"am-w-100",disabled:t(e).recurringUntil!==null},{default:x(()=>[$(h,{class:"am-capei-recurr__form-item"},{default:x(()=>[$($a,{value:"each"},{default:x(()=>[ce(C(t(i).recurrence_each),1)]),_:1})]),_:1}),$(h,{prop:"monthDate",class:"am-capei-recurr__form-item"},{default:x(()=>[$(Yt,{modelValue:t(v).monthDate,"onUpdate:modelValue":P[3]||(P[3]=L=>t(v).monthDate=L),disabled:t(v).monthlyRepeat==="on"||t(e).recurringUntil!==null,format:t(jt)(),lang:t(o),placeholder:t(i).select_date},null,8,["modelValue","disabled","format","lang","placeholder"])]),_:1}),$(h,{prop:"on",class:"am-capei-recurr__form-item"},{default:x(()=>[$($a,{value:"on"},{default:x(()=>[ce(C(t(i).recurrence_on),1)]),_:1})]),_:1}),$(h,{class:q(["am-capei-recurr__form-item am-w-50",t(s)])},{default:x(()=>[$(He,{modelValue:t(v).monthlyOnRepeat,"onUpdate:modelValue":P[4]||(P[4]=L=>t(v).monthlyOnRepeat=L),disabled:t(v).monthlyRepeat==="each"||t(e).recurringUntil!==null,placeholder:t(i).select_repeat_period},{default:x(()=>[(c(!0),y(ee,null,fe(t(u),(L,T)=>(c(),U(qe,{key:T,value:L.value,label:L.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["class"]),$(h,{class:q(["am-capei-recurr__form-item am-w-50",t(s)])},{default:x(()=>[$(He,{modelValue:t(v).monthlyOnDay,"onUpdate:modelValue":P[5]||(P[5]=L=>t(v).monthlyOnDay=L),disabled:t(v).monthlyRepeat==="each",placeholder:t(i).select_repeat_period},{default:x(()=>[(c(!0),y(ee,null,fe(t(d),(L,T)=>(c(),U(qe,{key:T,value:L.value,label:L.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["class"])]),_:1},8,["modelValue","disabled"])):O("",!0),$(h,{label:t(i).event_recurring_until,prop:"until",class:"am-capei-recurr__form-item"},{default:x(()=>[$(Yt,{modelValue:t(v).until,"onUpdate:modelValue":P[7]||(P[7]=L=>t(v).until=L),format:t(jt)(),lang:t(o),"disabled-date":E,placeholder:t(i).select_date},null,8,["modelValue","format","lang","placeholder"])]),_:1},8,["label"])]),_:1},8,["rules","model"])):O("",!0)],4)}}};const n1={class:"am-capei-price__heading"},i1={key:0,class:"am-capei-price__segment"},o1={key:0,class:"am-capei-price__block"},r1={class:"am-capei-price__block-header"},c1={class:"am-capei-price__block-header__text"},u1={key:1,class:"am-capei-price__segment"},d1={key:1,class:"am-capei-price__block"},m1={class:"am-capei-price__block-header"},p1={class:"am-capei-price__block-header__text"},g1={key:0,class:"am-capei-price__block-heading am-pl-32 am-pr-44"},f1={class:"am-capei-price__block-heading__item am-custom-pricing am-w-40"},h1={class:"am-capei-price__block-heading__item am-custom-pricing am-w-30"},v1={class:"am-capei-price__block-heading__item am-custom-pricing am-w-30"},_1={key:1,class:"am-separator am-order-6"},y1=m("div",{class:"am-separator"},null,-1),b1={class:"am-capei-price__part"},k1=m("div",{class:"am-separator"},null,-1),C1={class:"am-capei-price__block-header"},x1={class:"am-capei-price__block-header__text"},w1={key:1,class:"am-capei-price__block-segment"},T1={key:0,class:"am-capei-price__block-heading"},S1={class:"am-capei-price__block-heading__item am-custom-date am-w-50"},E1={class:"am-capei-price__block-heading__item am-custom-date am-w-50"},L1=m("div",{class:"am-separator"},null,-1),A1={key:2,class:"am-capei-price__block"},I1={class:"am-capei-price__block-header"},$1={class:"am-capei-price__block-header__text"},P1={key:0,class:"am-capei-price__part"},D1={key:3,class:"am-capei-price__block"},N1={class:"am-capei-price__block-header"},O1={class:"am-capei-price__block-header__text"},M1={key:0,class:"am-capei-price__part"},F1={props:{pageWidth:{type:Number,default:0}},setup(n,{expose:a}){const e=n;let s=_(()=>st(e.pageWidth)),l=De(),i=R("amLabels"),o=R("localLanguage"),r=R("licence"),u={components:{IconComponent:We},template:'<IconComponent icon="plus"/>'};function d(T){let w=he(T),B=!1;if(h.value.customTicketsRanges.forEach(G=>{!B&&G.range[0]&&G.range[1]&&(B=he(G.range[0])<=w&&he(G.range[1])>=w)}),B)return!0;let z=l.getters["event/getBookingOpensDisabled"]?he():he(l.getters["event/getBookingOpensDate"]),D=l.getters["event/getBookingClosesDisabled"]?l.getters["event/getPeriods"][0].startDate?he(l.getters["event/getPeriods"][0].startDate,"YYYY-MM-DD"):he():he(l.getters["event/getBookingClosesDate"]);return w<z||w>D}let f=_(()=>l.getters["event/getEvent"]),v=_(()=>h.value.customPricing?h.value.customTickets.reduce((T,w)=>T+w.spots,0)>1:h.value.maxCapacity>1),g=_(()=>h.value.customPricing?h.value.customTickets.reduce((T,w)=>T+w.spots,0):0),k=_(()=>h.value.customPricing&&h.value.maxCustomCapacityEnabled?h.value.maxCustomCapacity:h.value.customPricing?g.value:h.value.maxCapacity);function N(){h.value.customPricing&&h.value.customTickets.length===0&&b()}function E(T){h.value.customTickets.splice(T,1)}function b(){h.value.customTickets.push({enabled:!0,name:"",spots:1,waitingListSpots:0,price:0}),h.value.customTicketsRanges.forEach(T=>{T.tickets.push(new Object({price:0}))})}function A(T){h.value.customTicketsRanges.splice(T,1)}function S(){h.value.customTicketsRanges.push({range:["",""],tickets:h.value.customTickets.map(T=>new Object({price:T.price}))})}const P=F(null);let h=F({price:_({get:()=>l.getters["event/getPrice"],set:T=>{l.commit("event/setPrice",T)}}),maxCapacity:_({get:()=>l.getters["event/getMaxCapacity"],set:T=>{l.commit("event/setMaxCapacity",T)}}),bringingAnyone:_({get:()=>l.getters["event/getBringingAnyone"],set:T=>{l.commit("event/setBringingAnyone",T)}}),aggregatedPrice:_({get:()=>l.getters["event/getAggregatedPrice"],set:T=>{l.commit("event/setAggregatedPrice",T)}}),bookMultipleTimes:_({get:()=>l.getters["event/getBookMultipleTimes"],set:T=>{l.commit("event/setBookMultipleTimes",T)}}),depositEnabled:_({get:()=>l.getters["event/getDepositEnabled"],set:T=>{l.commit("event/setDepositEnabled",T)}}),deposit:_({get:()=>l.getters["event/getDeposit"],set:T=>{l.commit("event/setDeposit",T)}}),depositPayment:_({get:()=>l.getters["event/getDepositPayment"],set:T=>{l.commit("event/setDepositPayment",T)}}),depositPerPerson:_({get:()=>l.getters["event/getDepositPerPerson"],set:T=>{l.commit("event/setDepositPerPerson",T)}}),fullPayment:_({get:()=>l.getters["event/getFullPayment"],set:T=>{l.commit("event/setFullPayment",T)}}),customPricing:_({get:()=>l.getters["event/getCustomPricing"],set:T=>{l.commit("event/setCustomPricing",T)}}),customTickets:_({get:()=>l.getters["event/getCustomTickets"],set:T=>{l.commit("event/setCustomTickets",T)}}),customTicketsRangesEnabled:_({get:()=>l.getters["event/getCustomTicketsRangesEnabled"],set:T=>{l.commit("event/setCustomTicketsRangesEnabled",T)}}),customTicketsRanges:_({get:()=>l.getters["event/getCustomTicketsRanges"],set:T=>{l.commit("event/setCustomTicketsRanges",T)}}),maxCustomCapacityEnabled:_({get:()=>l.getters["event/getMaxCustomCapacityEnabled"],set:T=>{l.commit("event/setMaxCustomCapacityEnabled",T)}}),maxCustomCapacity:_({get:()=>l.getters["event/getMaxCustomCapacity"],set:T=>{l.commit("event/setMaxCustomCapacity",T)}}),closeAfterMinEnabled:_({get:()=>l.getters["event/getCloseAfterMinEnabled"],set:T=>{l.commit("event/setCloseAfterMinEnabled",T)}}),closeAfterMin:_({get:()=>l.getters["event/getCloseAfterMin"],set:T=>{l.commit("event/setCloseAfterMin",T)}}),closeAfterMinBookings:_({get:()=>l.getters["event/getCloseAfterMinBookings"],set:T=>{l.commit("event/setCloseAfterMinBookings",T)}}),maxExtraPeopleEnabled:_({get:()=>l.getters["event/getMaxExtraPeopleEnabled"],set:T=>{l.commit("event/setMaxExtraPeopleEnabled",T)}}),maxExtraPeople:_({get:()=>l.getters["event/getMaxExtraPeople"],set:T=>{l.commit("event/setMaxExtraPeople",T)}})});a({pricingFormRef:P});let I=R("amColors"),L=_(()=>({"--am-c-capei-price-text":I.value.colorMainText,"--am-c-capei-price-text-op03":H(I.value.colorMainText,.03),"--am-c-capei-price-inp-bgr-op03":H(I.value.colorInpBgr,.03)}));return(T,w)=>{const B=yt,z=et;return c(),U(z,{ref_key:"pricingFormRef",ref:P,model:t(h),style:be(t(L)),class:"am-capei-price"},{default:x(()=>[m("div",n1,[$(B,{label:`${t(i).price}:`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[$(it,{modelValue:t(h).price,"onUpdate:modelValue":w[0]||(w[0]=D=>t(h).price=D),disabled:t(h).customPricing,"is-money":!0},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),$(B,{label:`${t(i).event_max_capacity}:`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[$(ht,{modelValue:t(h).maxCapacity,"onUpdate:modelValue":w[1]||(w[1]=D=>t(h).maxCapacity=D),disabled:t(h).customPricing,min:1},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),t(v)?(c(),y("div",i1,[$(mt,{modelValue:t(h).bringingAnyone,"onUpdate:modelValue":w[2]||(w[2]=D=>t(h).bringingAnyone=D),label:t(i).event_bringing_anyone},null,8,["modelValue","label"]),t(h).bringingAnyone?(c(),U(mt,{key:0,modelValue:t(h).aggregatedPrice,"onUpdate:modelValue":w[3]||(w[3]=D=>t(h).aggregatedPrice=D),label:t(i).event_aggregated_price},null,8,["modelValue","label"])):O("",!0),$(mt,{modelValue:t(h).bookMultipleTimes,"onUpdate:modelValue":w[4]||(w[4]=D=>t(h).bookMultipleTimes=D),label:t(i).event_book_more_than_once},null,8,["modelValue","label"])])):O("",!0)]),t(r).isStarter?O("",!0):(c(),y("div",o1,[m("div",r1,[m("div",c1,C(t(i).deposit_enabled),1),$(lt,{modelValue:t(h).depositEnabled,"onUpdate:modelValue":w[5]||(w[5]=D=>t(h).depositEnabled=D),"aria-label":t(i).deposit_enabled},null,8,["modelValue","aria-label"])]),t(h).depositEnabled?(c(),y(ee,{key:0},[$(B,{label:`${t(i).deposit_payment}:`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[$(He,{modelValue:t(h).depositPayment,"onUpdate:modelValue":w[6]||(w[6]=D=>t(h).depositPayment=D)},{default:x(()=>[$(qe,{value:"percentage",label:t(i).amount_percentage},null,8,["label"]),$(qe,{value:"fixed",label:t(i).amount_fixed},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label","class"]),t(h).depositPayment==="fixed"?(c(),U(B,{key:0,label:`${t(i).amount} (${t(sc)()}):`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[$(it,{modelValue:t(h).deposit,"onUpdate:modelValue":w[7]||(w[7]=D=>t(h).deposit=D),"is-money":!0},null,8,["modelValue"])]),_:1},8,["label","class"])):O("",!0),t(h).depositPayment==="percentage"?(c(),U(B,{key:1,label:`${t(i).amount} (%):`,class:q(["am-capei-price__item am-w-50",t(s)])},{default:x(()=>[$(ht,{modelValue:t(h).deposit,"onUpdate:modelValue":w[8]||(w[8]=D=>t(h).deposit=D),min:1,max:100},null,8,["modelValue"])]),_:1},8,["label","class"])):O("",!0)],64)):O("",!0),t(h).depositEnabled?(c(),y("div",u1,[$(mt,{modelValue:t(h).depositPerPerson,"onUpdate:modelValue":w[9]||(w[9]=D=>t(h).depositPerPerson=D),label:t(i).deposit_per_person},null,8,["modelValue","label"]),$(mt,{modelValue:t(h).fullPayment,"onUpdate:modelValue":w[10]||(w[10]=D=>t(h).fullPayment=D),label:t(i).allow_total_event_amount},null,8,["modelValue","label"])])):O("",!0)])),t(r).isStarter?O("",!0):(c(),y("div",d1,[m("div",m1,[m("div",p1,C(t(i).custom_pricing_enabled),1),$(lt,{modelValue:t(h).customPricing,"onUpdate:modelValue":w[11]||(w[11]=D=>t(h).customPricing=D),disabled:t(f).bookings&&t(f).bookings.length>0,"aria-label":t(i).custom_pricing_enabled,onChange:N},null,8,["modelValue","disabled","aria-label"])]),t(h).customPricing?(c(),y(ee,{key:0},[e.pageWidth>545?(c(),y("div",g1,[m("div",f1,C(t(i).name)+": ",1),m("div",h1,C(t(i).price)+": ",1),m("div",v1,C(t(i).spots)+": ",1)])):O("",!0),(c(!0),y(ee,null,fe(t(h).customTickets,(D,G)=>(c(),y("div",{key:G,class:"am-capei-price__block-segment am-custom-76"},[m("div",{class:q(["am-capei-price__block-inner am-ws-16",{"am-mt-22":e.pageWidth<546}])},[$(B,null,{default:x(()=>[$(mt,{modelValue:D.enabled,"onUpdate:modelValue":se=>D.enabled=se},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)],2),m("div",{class:q(["am-capei-price__block-inner",[{"am-we-40":e.pageWidth>545},{"am-we-100":e.pageWidth<546}]])},[$(B,{label:e.pageWidth<546?`${t(i).name}:`:""},{default:x(()=>[$(it,{modelValue:D.name,"onUpdate:modelValue":se=>D.name=se,disabled:!D.enabled,"aria-label":t(i).name},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),m("div",{class:q(["am-capei-price__block-inner",[{"am-we-30":e.pageWidth>545},{"am-w-50 am-order-2":e.pageWidth<546},{"am-w-100":e.pageWidth<401}]])},[$(B,{label:e.pageWidth<546?t(i).price:""},{default:x(()=>[$(it,{modelValue:D.price,"onUpdate:modelValue":se=>D.price=se,disabled:!D.enabled,"is-money":!0,"aria-label":t(i).price},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),m("div",{class:q(["am-capei-price__block-inner",[{"am-we-30":e.pageWidth>545},{"am-w-50 am-order-3":e.pageWidth<546},{"am-w-100":e.pageWidth<401}]])},[$(B,{label:e.pageWidth<546?`${t(i).spots}:`:""},{default:x(()=>[$(ht,{modelValue:D.spots,"onUpdate:modelValue":se=>D.spots=se,min:1,disabled:!D.enabled||t(h).maxCustomCapacityEnabled,"aria-label":t(i).spots},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),!D.booked&&t(h).customTickets.length>1?(c(),y("div",{key:0,class:q(["am-capei-price__block-delete",{"am-order-1 am-mt-22":e.pageWidth<546}])},[$(Se,{category:"secondary",type:"plain",size:"mini","icon-only":!0,icon:{components:{IconComponent:We},template:"<IconComponent icon='bucket'/>"},onClick:se=>E(G)},null,8,["icon","onClick"])],2)):O("",!0),e.pageWidth<546?(c(),y("div",_1)):O("",!0)]))),128)),$(Se,{icon:t(u),prefix:"plus",size:"default",category:"primary",type:"filled",onClick:b},{default:x(()=>[ce(C(t(i).add_ticket_category),1)]),_:1},8,["icon"]),y1,m("div",b1,[m("div",{class:q(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},[$(mt,{modelValue:t(h).maxCustomCapacityEnabled,"onUpdate:modelValue":w[12]||(w[12]=D=>t(h).maxCustomCapacityEnabled=D),label:`${t(i).event_max_capacity}:`},null,8,["modelValue","label"])],2),m("div",{class:q(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},[$(ht,{modelValue:t(h).maxCustomCapacity,"onUpdate:modelValue":w[13]||(w[13]=D=>t(h).maxCustomCapacity=D),min:1,disabled:!t(h).maxCustomCapacityEnabled},null,8,["modelValue","disabled"])],2)]),k1,m("div",C1,[m("div",x1,C(t(i).pricing_by_date_enabled),1),$(lt,{modelValue:t(h).customTicketsRangesEnabled,"onUpdate:modelValue":w[14]||(w[14]=D=>t(h).customTicketsRangesEnabled=D),"aria-label":t(i).pricing_by_date_enabled},null,8,["modelValue","aria-label"])]),t(h).customTicketsRangesEnabled?(c(),y("div",w1,[(c(!0),y(ee,null,fe(t(h).customTicketsRanges,(D,G)=>(c(),y(ee,{key:G},[$(B,{label:`${t(i).event_date_range}:`,class:"am-capei-price__date-range"},{default:x(()=>[$(Yt,{modelValue:D.range,"onUpdate:modelValue":se=>D.range=se,type:"daterange",format:t(jt)(),placeholder:"Pick a day",lang:t(o),"disabled-date":d,"start-placeholder":t(i).start_date,"end-placeholder":t(i).end_date},null,8,["modelValue","onUpdate:modelValue","format","lang","start-placeholder","end-placeholder"]),$(Se,{category:"secondary",type:"plain",size:"mini","icon-only":!0,icon:{components:{IconComponent:We},template:"<IconComponent icon='bucket'/>"},"aria-label":t(i).delete,onClick:se=>A(G)},null,8,["icon","aria-label","onClick"])]),_:2},1032,["label"]),e.pageWidth>545?(c(),y("div",T1,[m("div",S1,C(t(i).name)+": ",1),m("div",E1,C(t(i).price)+": ",1)])):O("",!0),(c(!0),y(ee,null,fe(t(h).customTickets,(se,j)=>(c(),y(ee,{key:j},[m("div",{class:q(["am-capei-price__block-inner",[{"am-w-50":e.pageWidth>545},{"am-w-100":e.pageWidth<546}]])},[$(B,{label:e.pageWidth<546?`${t(i).name}:`:""},{default:x(()=>[$(it,{modelValue:se.name,"onUpdate:modelValue":ne=>se.name=ne,disabled:!0,"aria-label":t(i).name},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),_:2},1032,["label"])],2),m("div",{class:q(["am-capei-price__block-inner",[{"am-w-50":e.pageWidth>545},{"am-w-100":e.pageWidth<546}]])},[$(B,{label:e.pageWidth<546?`${t(i).price}:`:""},{default:x(()=>[$(it,{modelValue:D.tickets[j].price,"onUpdate:modelValue":ne=>D.tickets[j].price=ne,"is-money":!0,"aria-label":t(i).price},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),_:2},1032,["label"])],2)],64))),128)),L1],64))),128)),$(Se,{icon:t(u),prefix:"plus",size:"default",category:"primary",type:"filled",onClick:S},{default:x(()=>[ce(C(t(i).event_add_date_range),1)]),_:1},8,["icon"])])):O("",!0)],64)):O("",!0)])),t(h).maxCapacity>1||t(h).maxCustomCapacity>1||t(g)>1?(c(),y("div",A1,[m("div",I1,[m("div",$1,C(t(i).event_close_after_min),1),$(lt,{modelValue:t(h).closeAfterMinEnabled,"onUpdate:modelValue":w[15]||(w[15]=D=>t(h).closeAfterMinEnabled=D),"aria-label":t(i).event_close_after_min},null,8,["modelValue","aria-label"])]),t(h).closeAfterMinEnabled&&(t(h).maxCapacity>1||t(h).maxCustomCapacity>1||t(g)>1)?(c(),y("div",P1,[$(Bl,{modelValue:t(h).closeAfterMinBookings,"onUpdate:modelValue":w[16]||(w[16]=D=>t(h).closeAfterMinBookings=D),class:q(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},{default:x(()=>[$($a,{value:!1},{default:x(()=>[ce(C(t(i).event_close_min_total),1)]),_:1}),$($a,{value:!0},{default:x(()=>[ce(C(t(i).event_close_min_bookings),1)]),_:1})]),_:1},8,["modelValue","class"]),$(B,{class:q(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},{default:x(()=>[$(ht,{modelValue:t(h).closeAfterMin,"onUpdate:modelValue":w[17]||(w[17]=D=>t(h).closeAfterMin=D),min:1,max:t(k)},null,8,["modelValue","max"])]),_:1},8,["class"])])):O("",!0)])):O("",!0),t(h).maxCapacity>1||t(h).maxCustomCapacity>1||t(g)>1?(c(),y("div",D1,[m("div",N1,[m("div",O1,C(t(i).limit_extra_people),1),$(lt,{modelValue:t(h).maxExtraPeopleEnabled,"onUpdate:modelValue":w[18]||(w[18]=D=>t(h).maxExtraPeopleEnabled=D),"aria-label":t(i).limit_extra_people},null,8,["modelValue","aria-label"])]),t(h).maxExtraPeopleEnabled&&(t(h).maxCapacity>1||t(h).maxCustomCapacity>1||t(g)>1)?(c(),y("div",M1,[$(B,{label:`${t(i).limit_extra_people_set}:`,class:"am-capei-price__part-item am-w-100"},{default:x(()=>[$(ht,{modelValue:t(h).maxExtraPeople,"onUpdate:modelValue":w[19]||(w[19]=D=>t(h).maxExtraPeople=D),min:0,max:t(k)-1},null,8,["modelValue","max"])]),_:1},8,["label"])])):O("",!0)])):O("",!0)]),_:1},8,["model","style"])}}};const V1={class:"am-capei-custef__heading"},B1={class:"am-capei-custef__colors"},R1=["onClick"],q1={key:0,class:"am-icon-check"},U1={setup(n){let a=De(),e=R("amLabels");const s=F(null);let l=F(1),i=F(["#1788FB","#4BBEC6","#FBC22D","#FA3C52","#D696B8","#689BCA","#26CC2B","#FD7E35","#E38587","#774DFB"]),o=F({color:_({get:()=>a.getters["event/getColor"],set:r=>{a.commit("event/setColor",r)}}),show:_({get:()=>a.getters["event/getShow"],set:r=>{a.commit("event/setShow",r)}})});return Je(()=>{let r=a.getters["event/getColor"];i.value.filter(d=>d===r).length>0?l.value=1:l.value=2}),(r,u)=>{const d=yt,f=lc,v=et;return c(),U(v,{ref_key:"customizeFormRef",ref:s,model:t(o),class:"am-capei-custef"},{default:x(()=>[m("div",V1,C(t(e).event_colors),1),$(Bl,{modelValue:t(l),"onUpdate:modelValue":u[2]||(u[2]=g=>we(l)?l.value=g:l=g)},{default:x(()=>[$(d,{class:"am-capei-custef__item"},{default:x(()=>[$($a,{value:1},{default:x(()=>[ce(C(t(e).event_colors_preset)+": ",1)]),_:1}),m("div",B1,[(c(!0),y(ee,null,fe(t(i),g=>(c(),y("div",{key:g,class:q(["am-capei-custef__colors-item",{"am-disabled":t(l)===2}]),onClick:k=>t(a).commit("event/setColor",g)},[m("div",{class:"am-capei-custef__colors-item__inner",style:be({backgroundColor:g})},[g===t(o).color?(c(),y("span",q1)):O("",!0)],4)],10,R1))),128))])]),_:1}),$(d,{class:"am-capei-custef__item"},{default:x(()=>[$($a,{value:2},{default:x(()=>[ce(C(t(e).event_colors_custom)+": ",1)]),_:1}),$(f,{modelValue:t(o).color,"onUpdate:modelValue":u[0]||(u[0]=g=>t(o).color=g),disabled:t(l)===1,"aria-label":t(e).event_colors_custom},null,8,["modelValue","disabled","aria-label"])]),_:1}),$(d,{class:"am-capei-custef__item"},{default:x(()=>[$(mt,{modelValue:t(o).show,"onUpdate:modelValue":u[1]||(u[1]=g=>t(o).show=g),label:t(e).event_show_on_site},null,8,["modelValue","label"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])}}};const z1={class:"am-capei-waiting__header"},j1={class:"am-capei-waiting__header-text"},Y1={class:"am-capei-waiting__header"},W1={class:"am-capei-waiting__header-text"},H1={props:{pageWidth:{type:Number,default:0},waitingListUntil:{type:Object,default:null}},setup(n,{expose:a}){const e=n;let s=_(()=>st(e.pageWidth));const l=De();let i=R("amLabels"),o=F(null),r=F({enabled:_({get:()=>l.getters["event/getWaitingListEnabled"],set:k=>{l.commit("event/setWaitingListEnabled",k)}}),maxCapacity:_({get:()=>l.getters["event/getWaitingListMaxCapacity"],set:k=>{l.commit("event/setWaitingListMaxCapacity",k)}}),maxExtraPeopleEnabled:_({get:()=>l.getters["event/getWaitingListMaxExtraPeopleEnabled"],set:k=>{l.commit("event/setWaitingListMaxExtraPeopleEnabled",k)}}),maxExtraPeople:_({get:()=>l.getters["event/getWaitingListMaxExtraPeople"],set:k=>{l.commit("event/setWaitingListMaxExtraPeople",k)}})}),u=_(()=>l.getters["event/getCustomTickets"]),d=_(()=>l.getters["event/getCustomPricing"]),f=_(()=>l.getters["event/getMaxCustomCapacityEnabled"]);a({waitingListFormRef:o});let v=R("amColors"),g=_(()=>({"--am-c-capei-waiting-text":v.value.colorMainText,"--am-c-capei-waiting-text-op03":H(v.value.colorMainText,.03),"--am-c-capei-waiting-inp-bgr-op03":H(v.value.colorInpBgr,.03),"--am-c-capei-waiting-bgr-op05":H(v.value.colorPrimary,.05)}));return(k,N)=>{const E=yt,b=et;return c(),y("div",{class:"am-capei-waiting",style:be(t(g))},[m("div",z1,[m("div",j1,C(t(i).events_show_waiting_list_booking_full),1),$(lt,{modelValue:t(r).enabled,"onUpdate:modelValue":N[0]||(N[0]=A=>t(r).enabled=A),"aria-label":t(i).events_show_waiting_list_booking_full},null,8,["modelValue","aria-label"])]),t(r).enabled?(c(),U(b,{key:0,ref_key:"waitingListFormRef",ref:o,model:t(r),"label-position":"top"},{default:x(()=>[!t(d)||t(f)?(c(),U(E,{key:0,label:`${t(i).maximum_capacity}`,class:q(["am-capei-waiting__item",t(s)])},{default:x(()=>[$(ht,{modelValue:t(r).maxCapacity,"onUpdate:modelValue":N[1]||(N[1]=A=>t(r).maxCapacity=A),min:1},null,8,["modelValue"])]),_:1},8,["label","class"])):O("",!0),t(d)?(c(!0),y(ee,{key:1},fe(t(u),(A,S)=>(c(),U(E,{key:S,label:A.name,class:q(["am-capei-waiting__item",t(s)])},{default:x(()=>[$(ht,{modelValue:A.waitingListSpots,"onUpdate:modelValue":P=>A.waitingListSpots=P,min:1,disabled:t(f)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","class"]))),128)):O("",!0),m("div",Y1,[m("div",W1,C(t(i).limit_extra_people),1),$(lt,{modelValue:t(r).maxExtraPeopleEnabled,"onUpdate:modelValue":N[2]||(N[2]=A=>t(r).maxExtraPeopleEnabled=A),"aria-label":t(i).limit_extra_people},null,8,["modelValue","aria-label"])]),t(r).maxExtraPeopleEnabled?(c(),U(E,{key:2,class:q(t(s))},{default:x(()=>[$(ht,{modelValue:t(r).maxExtraPeople,"onUpdate:modelValue":N[3]||(N[3]=A=>t(r).maxExtraPeople=A),min:0,disabled:!t(r).maxExtraPeopleEnabled},null,8,["modelValue","disabled"])]),_:1},8,["class"])):O("",!0)]),_:1},8,["model"])):O("",!0)],4)}}};const Z1={class:"am-capei-sef__header"},G1=m("span",{class:"am-icon-options"},null,-1),J1={class:"am-capei-sef__header-text"},X1={class:"am-capei-sef__content"},Q1=["innerHTML"],K1=["innerHTML"],e0={class:"am-capei-sef__header"},t0=m("span",{class:"am-icon-payments"},null,-1),a0={class:"am-capei-sef__header-text"},s0={class:"am-capei-sef__content"},l0={class:"am-capei-sef__segment"},n0={key:0,class:"am-capei-sef__heading"},i0={class:"am-capei-sef__heading-text"},o0=["innerHTML"],r0=["innerHTML"],c0={key:0,class:"am-capei-sef__heading"},u0={class:"am-capei-sef__heading-text"},d0={class:"am-capei-sef__segment"},m0={key:0,class:"am-capei-sef__heading"},p0={class:"am-capei-sef__heading-text"},g0={key:1,class:"am-capei-sef__heading"},f0=["src"],h0={key:2,class:"am-capei-sef__heading"},v0=["src"],_0={key:3,class:"am-capei-sef__heading"},y0=["src"],b0={key:4,class:"am-capei-sef__heading"},k0=["src"],C0={key:5,class:"am-capei-sef__heading"},x0=["src"],w0={class:"am-capei-sef__header"},T0=m("span",{class:"am-icon-options"},null,-1),S0={class:"am-capei-sef__header-text"},E0={key:0,class:"am-capei-sef__heading"},L0={class:"am-capei-sef__heading-text"},A0={key:1,class:"am-capei-sef__heading"},I0={class:"am-capei-sef__heading-text"},$0={key:2,class:"am-capei-sef__heading"},P0={class:"am-capei-sef__heading-text"},D0={setup(n){let a=De(),e=R("licence"),s=R("amLabels");const l=R("settings"),i=R("baseUrls");let o=F([{label:s.value.disabled,value:0},{label:s.value.min10,value:600},{label:s.value.min12,value:720},{label:s.value.min15,value:900},{label:s.value.min30,value:1800},{label:s.value.min45,value:2700},{label:s.value.h1,value:3600},{label:s.value.h1min30,value:5400},{label:s.value.h2,value:7200},{label:s.value.h3,value:10800},{label:s.value.h4,value:14400},{label:s.value.h6,value:21600},{label:s.value.h8,value:28800},{label:s.value.h9,value:32400},{label:s.value.h10,value:36e3},{label:s.value.h11,value:39600},{label:s.value.h12,value:43200},{label:s.value.day1,value:86400},{label:s.value.days2,value:172800},{label:s.value.days3,value:259200},{label:s.value.days4,value:345600},{label:s.value.days5,value:432e3},{label:s.value.days6,value:518400},{label:s.value.week1,value:604800},{label:s.value.weeks2,value:1209600},{label:s.value.weeks3,value:1814400},{label:s.value.weeks4,value:2419200},{label:s.value.months3,value:7884e3},{label:s.value.months6,value:15768e3}]),r=F([]),u=F(!1),d=F(0),f=F(null),v=_(()=>{if(r.value.length){let h=r.value.find(I=>I.id===l.payments.wc.productId);return typeof h<"u"?h.name:s.value.select}return""});function g(){l.payments.wc.enabled&&k({id:A.value.paymentsWcProductId},h=>{r.value=h.length?h:[]})}function k(h,I){clearTimeout(f.value),u.value=!0,d.value++,f.value=setTimeout(()=>{let L=d.value;Ne.get("/payment/wc/products",{params:h}).then(T=>{L>=d.value&&I(T.data.data.products.sort((w,B)=>w.name.toLowerCase()>B.name.toLowerCase()?1:-1))}).finally(()=>{u.value=!1})},500)}function N(h){h&&k({name:h},I=>{r.value=I})}let E=F("");const b=F(null);let A=F({generalMinimumTimeRequirementPriorToCanceling:_({get:()=>a.getters["event/getSettingsGeneralMinimumTimeRequirementPriorToCanceling"],set:h=>{a.commit("event/setSettingsGeneralMinimumTimeRequirementPriorToCanceling",h)}}),generalRedirectUrlAfterAppointment:_({get:()=>a.getters["event/getSettingsGeneralRedirectUrlAfterAppointment"],set:h=>{a.commit("event/setSettingsGeneralRedirectUrlAfterAppointment",h)}}),paymentsPaymentLinksEnabled:_({get:()=>a.getters["event/getSettingsPaymentsPaymentLinksEnabled"],set:h=>{a.commit("event/setSettingsPaymentsPaymentLinksEnabled",h)}}),paymentsPaymentLinksRedirectUrl:_({get:()=>a.getters["event/getSettingsPaymentsPaymentLinksRedirectUrl"],set:h=>{a.commit("event/setSettingsPaymentsPaymentLinksRedirectUrl",h)}}),paymentsOnSite:_({get:()=>a.getters["event/getSettingsPaymentsOnSite"],set:h=>{a.commit("event/setSettingsPaymentsOnSite",h)}}),paymentsWcEnabled:_({get:()=>a.getters["event/getSettingsPaymentsWcEnabled"],set:h=>{a.commit("event/setSettingsPaymentsWcEnabled",h)}}),paymentsWcProductId:_({get:()=>a.getters["event/getSettingsPaymentsWcProductId"],set:h=>{a.commit("event/setSettingsPaymentsWcProductId",h)}}),paymentsStripeEnabled:_({get:()=>a.getters["event/getSettingsPaymentsStripeEnabled"],set:h=>{a.commit("event/setSettingsPaymentsStripeEnabled",h)}}),paymentsPayPalEnabled:_({get:()=>a.getters["event/getSettingsPaymentsPayPalEnabled"],set:h=>{a.commit("event/setSettingsPaymentsPayPalEnabled",h)}}),paymentsMollieEnabled:_({get:()=>a.getters["event/getSettingsPaymentsMollieEnabled"],set:h=>{a.commit("event/setSettingsPaymentsMollieEnabled",h)}}),paymentsRazorpayEnabled:_({get:()=>a.getters["event/getSettingsPaymentsRazorpayEnabled"],set:h=>{a.commit("event/setSettingsPaymentsRazorpayEnabled",h)}}),paymentsSquareEnabled:_({get:()=>a.getters["event/getSettingsPaymentsSquareEnabled"],set:h=>{a.commit("event/setSettingsPaymentsSquareEnabled",h)}}),integrationsGoogleMeetEnabled:_({get:()=>a.getters["event/getSettingsIntegrationsGoogleMeetEnabled"],set:h=>{a.commit("event/setSettingsIntegrationsGoogleMeetEnabled",h)}}),integrationsMicrosoftTeamsEnabled:_({get:()=>a.getters["event/getSettingsIntegrationsMicrosoftTeamsEnabled"],set:h=>{a.commit("event/setSettingsIntegrationsMicrosoftTeamsEnabled",h)}}),integrationsLessonSpaceEnabled:_({get:()=>a.getters["event/getSettingsIntegrationsLessonSpaceEnabled"],set:h=>{a.commit("event/setSettingsIntegrationsLessonSpaceEnabled",h)}})});Je(()=>{A.value.generalMinimumTimeRequirementPriorToCanceling===l.general.minimumTimeRequirementPriorToCanceling&&a.commit("event/setSettingsGeneralMinimumTimeRequirementPriorToCanceling",""),A.value.generalRedirectUrlAfterAppointment===l.general.redirectUrlAfterAppointment&&a.commit("event/setSettingsGeneralRedirectUrlAfterAppointment",""),A.value.paymentsPaymentLinksRedirectUrl===l.payments.paymentLinks.redirectUrl&&a.commit("event/setSettingsPaymentsPaymentLinksRedirectUrl",""),g()});let S=R("amColors"),P=_(()=>({"--am-c-capei-sef-primary":S.value.colorPrimary,"--am-c-capei-sef-text":S.value.colorMainText,"--am-c-capei-sef-text-op03":H(S.value.colorMainText,.03),"--am-c-capei-sef-bgr":S.value.colorMainBgr}));return(h,I)=>{const L=Vl,T=yt,w=bs,B=ks,z=et;return c(),U(z,{ref_key:"settingsFormRef",ref:b,model:t(A),class:"am-capei-sef",style:be(t(P))},{default:x(()=>[$(B,{modelValue:t(E),"onUpdate:modelValue":I[15]||(I[15]=D=>we(E)?E.value=D:E=D),accordion:"",class:"am-capei-sef__collapse"},{default:x(()=>[$(w,{name:"general",class:"am-capei-sef__collapse-item"},{title:x(()=>[m("div",Z1,[G1,m("div",J1,C(t(s).general),1)])]),default:x(()=>[m("div",X1,[$(T,null,{label:x(()=>[ce(C(t(s).minimum_time_before_canceling)+" ",1),$(L,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).minimum_time_before_canceling_tooltip},null,8,Q1)]),default:x(()=>[$(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:x(()=>[$(He,{modelValue:t(A).generalMinimumTimeRequirementPriorToCanceling,"onUpdate:modelValue":I[0]||(I[0]=D=>t(A).generalMinimumTimeRequirementPriorToCanceling=D),placeholder:t(o).find(D=>D.value===t(l).general.minimumTimeRequirementPriorToCanceling).label,clearable:""},{default:x(()=>[(c(!0),y(ee,null,fe(t(o),(D,G)=>(c(),U(qe,{key:G,value:D.value,label:D.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),$(T,null,{label:x(()=>[ce(C(t(s).redirect_url_after_appointment)+" ",1),$(L,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).redirect_url_after_appointment_tooltip},null,8,K1)]),default:x(()=>[$(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:x(()=>[$(it,{modelValue:t(A).generalRedirectUrlAfterAppointment,"onUpdate:modelValue":I[1]||(I[1]=D=>t(A).generalRedirectUrlAfterAppointment=D),placeholder:t(l).general.redirectUrlAfterAppointment},null,8,["modelValue","placeholder"])]),_:1})])]),_:1}),$(w,{name:"payment",class:"am-capei-sef__collapse-item"},{title:x(()=>[m("div",e0,[t0,m("div",a0,C(t(s).payments),1)])]),default:x(()=>[m("div",s0,[m("div",l0,[t(e).isStarter?O("",!0):(c(),y("div",n0,[m("div",i0,[ce(C(t(s).payment_links_enable)+" ",1),$(L,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(s).payment_links_enable_tooltip},null,8,o0)]),default:x(()=>[$(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),$(lt,{modelValue:t(A).paymentsPaymentLinksEnabled,"onUpdate:modelValue":I[2]||(I[2]=D=>t(A).paymentsPaymentLinksEnabled=D)},null,8,["modelValue"])])),t(A).paymentsPaymentLinksEnabled&&!t(e).isStarter?(c(),U(T,{key:1,label:t(s).redirect_url_after_appointment},{label:x(()=>[ce(C(t(s).redirect_url_after_appointment)+" ",1),$(L,{effect:"dark",placement:"top"},{content:x(()=>[m("div",{innerHTML:t(e).isPro||t(e).isDeveloper?t(s).redirect_url_after_app_or_package_tt:t(s).redirect_url_after_appointment_tooltip},null,8,r0)]),default:x(()=>[$(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:x(()=>[$(it,{modelValue:t(A).paymentsPaymentLinksRedirectUrl,"onUpdate:modelValue":I[3]||(I[3]=D=>t(A).paymentsPaymentLinksRedirectUrl=D),placeholder:t(l).payments.paymentLinks.redirectUrl},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):O("",!0)]),t(l).payments.onSite?(c(),y("div",c0,[m("div",u0,C(t(s).on_site),1),$(lt,{modelValue:t(A).paymentsOnSite,"onUpdate:modelValue":I[4]||(I[4]=D=>t(A).paymentsOnSite=D)},null,8,["modelValue"])])):O("",!0),m("div",d0,[t(l).payments.wc.enabled?(c(),y("div",m0,[m("div",p0,C(t(s).wc_service),1),$(lt,{modelValue:t(A).paymentsWcEnabled,"onUpdate:modelValue":I[5]||(I[5]=D=>t(A).paymentsWcEnabled=D)},null,8,["modelValue"])])):O("",!0),t(A).paymentsWcEnabled?(c(),U(T,{key:1},{default:x(()=>[$(He,{modelValue:t(A).paymentsWcProductId,"onUpdate:modelValue":I[6]||(I[6]=D=>t(A).paymentsWcProductId=D),clearable:"",filterable:"",remote:"",placeholder:t(v),loading:t(u),"remote-method":N},{default:x(()=>[(c(!0),y(ee,null,fe(t(r),(D,G)=>(c(),U(qe,{key:G,value:D.id,label:D.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","loading"])]),_:1})):O("",!0)]),t(l).payments.payPal.enabled?(c(),y("div",g0,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/paypal-light.svg",alt:"PayPal"},null,8,f0),$(lt,{modelValue:t(A).paymentsPayPalEnabled,"onUpdate:modelValue":I[7]||(I[7]=D=>t(A).paymentsPayPalEnabled=D)},null,8,["modelValue"])])):O("",!0),t(l).payments.stripe.enabled?(c(),y("div",h0,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/stripe.svg",alt:"Stripe"},null,8,v0),$(lt,{modelValue:t(A).paymentsStripeEnabled,"onUpdate:modelValue":I[8]||(I[8]=D=>t(A).paymentsStripeEnabled=D)},null,8,["modelValue"])])):O("",!0),t(l).payments.mollie.enabled?(c(),y("div",_0,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/mollie.svg",alt:"Mollie"},null,8,y0),$(lt,{modelValue:t(A).paymentsMollieEnabled,"onUpdate:modelValue":I[9]||(I[9]=D=>t(A).paymentsMollieEnabled=D)},null,8,["modelValue"])])):O("",!0),t(l).payments.square.enabled?(c(),y("div",b0,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/square.svg",alt:"Square"},null,8,k0),$(lt,{modelValue:t(A).paymentsSquareEnabled,"onUpdate:modelValue":I[10]||(I[10]=D=>t(A).paymentsSquareEnabled=D)},null,8,["modelValue"])])):O("",!0),t(l).payments.razorpay.enabled?(c(),y("div",C0,[m("img",{style:{width:"60px"},src:t(i).wpAmeliaPluginURL+"public/img/payments/razorpay.svg",alt:"Razorpay"},null,8,x0),$(lt,{modelValue:t(A).paymentsRazorpayEnabled,"onUpdate:modelValue":I[11]||(I[11]=D=>t(A).paymentsRazorpayEnabled=D)},null,8,["modelValue"])])):O("",!0)])]),_:1}),t(l).googleCalendar.enabled&&t(l).googleMeet.enabled||t(l).outlookCalendar.enabled&&t(l).microsoftTeams.enabled||t(l).lessonSpace.enabled?(c(),U(w,{key:0,name:"integrations",class:"am-capei-sef__collapse-item"},{title:x(()=>[m("div",w0,[T0,m("div",S0,C(t(s).integrations_settings),1)])]),default:x(()=>[t(l).googleCalendar.enabled&&t(l).googleMeet.enabled?(c(),y("div",E0,[m("div",L0,C(t(s).enable_google_meet),1),$(lt,{modelValue:t(A).integrationsGoogleMeetEnabled,"onUpdate:modelValue":I[12]||(I[12]=D=>t(A).integrationsGoogleMeetEnabled=D)},null,8,["modelValue"])])):O("",!0),t(l).outlookCalendar.enabled&&t(l).microsoftTeams.enabled?(c(),y("div",A0,[m("div",I0,C(t(s).enable_microsoft_teams),1),$(lt,{modelValue:t(A).integrationsMicrosoftTeamsEnabled,"onUpdate:modelValue":I[13]||(I[13]=D=>t(A).integrationsMicrosoftTeamsEnabled=D)},null,8,["modelValue"])])):O("",!0),t(l).lessonSpace.enabled?(c(),y("div",$0,[m("div",P0,C(t(s).lesson_space),1),$(lt,{modelValue:t(A).integrationsLessonSpaceEnabled,"onUpdate:modelValue":I[14]||(I[14]=D=>t(A).integrationsLessonSpaceEnabled=D)},null,8,["modelValue"])])):O("",!0)]),_:1})):O("",!0)]),_:1},8,["modelValue"])]),_:1},8,["model","style"])}}};const N0={class:"am-capei__footer-actions"},O0={name:"CabinetEvent"},M0=Object.assign(O0,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number}},emits:["close","save","duplicate"],setup(n,{emit:a}){const e=n;let s=De(),l=R("amLabels");const i=R("settings");let o=R("licence");const r=F("details");let u=F(null),d=F(null),f=F(null),v=F(null),g=F(null),k=F(!0),N=F(!1),E=F(!1);function b(){a("duplicate",Object.assign(JSON.parse(JSON.stringify(s.getters["event/getEvent"])),{id:null,bookings:[]}))}async function A(){let w=!0;await new Promise(B=>{u.value?.detailsFormRef.validate(z=>{z||(r.value="details",w=!1),B()})}),w&&(await new Promise(B=>{d.value?.periodsFormRef.validate(z=>{z||(r.value="periods",w=!1),B()})}),w&&(s.getters["event/getRecurringEnabled"]&&(await new Promise(B=>{f.value?.recurringFormRef.validate(z=>{z||(r.value="recurring",w=!1),B()})}),!w)||h(B=>{B?E.value=!0:P()})))}function S(w){k.value=!0,Ne.post("/events"+(s.getters["event/getId"]?"/"+s.getters["event/getId"]:""),Object.assign(Yb(s),{applyGlobally:w}),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{zb(s),I("save")}).catch(B=>{console.log(B)}).finally(()=>{k.value=!1})}function P(){g.value?(k.value=!1,E.value=!1,N.value=!0):S(!1)}function h(w){let B=s.getters["event/getOrganizerId"]?s.getters["employee/getEmployee"]:null;if(B&&(B.googleCalendar||B.outlookCalendar)){k.value=!0;let z=s.getters["event/getProviders"].map(D=>new Object({id:D.id}));Ne.post("/events/calendar",{providers:s.getters["event/getProviders"].map(D=>D.id).indexOf(B.id)===-1?z.concat([{id:B.id}]):z,periods:Lr(s),eventIds:[s.getters["event/getId"],s.getters["event/getParentId"]],recurring:s.getters["event/getRecurring"]},Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{w(!1)}).catch(()=>{w(!0),k.value=!1})}else w(!1)}function I(w){s.commit("event/setActive",!1),a(w)}Je(()=>{s.getters["event/getId"]&&s.getters["event/getRecurringUntil"]&&(g.value=Ke(s.getters["event/getRecurringUntil"].toISOString().split("T")[0])),s.commit("event/setActive",!0),k.value=!1});let L=R("amColors"),T=_(()=>({"--am-c-capei-text":L.value.colorMainText,"--am-c-capei-text-op10":H(L.value.colorMainText,.1),"--am-c-capei-primary":L.value.colorPrimary,"--am-c-cust-no1":L.value.colorMainText,"--am-c-cust-no1-bgr":H(L.value.colorMainText,.1),"--am-c-cust-no2":L.value.colorWarning,"--am-c-cust-no2-bgr":H(L.value.colorWarning,.1),"--am-c-cust-no3":L.value.colorError,"--am-c-cust-no3-bgr":H(L.value.colorError,.1),"--am-c-cust-link":H(L.value.colorMainText,.5),"--am-c-cust-text":L.value.colorMainText}));return(w,B)=>{const z=va,D=_a;return c(),y(ee,null,[t(k)?(c(),U(Wt,{key:1})):(c(),y("div",{key:0,class:q(["am-capei",t(e).responsiveClass]),style:be(t(T))},[$(D,{modelValue:r.value,"onUpdate:modelValue":B[0]||(B[0]=G=>r.value=G),class:"am-ap__tabs"},{default:x(()=>[$(z,{label:t(l).details,name:"details"},{default:x(()=>[$(Zb,{ref_key:"eventDetailsRef",ref:u},null,512)]),_:1},8,["label"]),$(z,{label:t(l).periods,name:"periods"},{default:x(()=>[$(t1,{ref_key:"eventPeriodsRef",ref:d,"page-width":t(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"]),t(o).isStarter?O("",!0):(c(),U(z,{key:0,label:t(l).recurring,name:"recurring"},{default:x(()=>[$(l1,{ref_key:"eventRecurringRef",ref:f,"page-width":t(e).pageWidth,"recurring-until":t(g)},null,8,["page-width","recurring-until"])]),_:1},8,["label"])),$(z,{label:t(l).pricing,name:"pricing"},{default:x(()=>[$(F1,{ref_key:"eventPricingRef",ref:v,"page-width":t(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"]),$(z,{label:t(l).customize,name:"customize"},{default:x(()=>[$(U1)]),_:1},8,["label"]),t(i).appointments.waitingListEvents.enabled&&!t(o).isStarter&&!t(o).isBasic?(c(),U(z,{key:1,label:t(l).waiting_list,name:"waitingList"},{default:x(()=>[$(H1,{"page-width":t(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"])):O("",!0),$(z,{label:t(l).settings,name:"settings"},{default:x(()=>[$(D0)]),_:1},8,["label"])]),_:1},8,["modelValue"]),m("div",{class:q(["am-capei__footer",[{"am-capei__footer_new":!t(s).getters["event/getId"]},t(e).responsiveClass]])},[t(s).getters["event/getId"]?(c(),U(Se,{key:0,class:"am-capei__footer-duplicate","icon-only":!0,icon:"duplicate",type:"plain",category:"secondary",onClick:b})):O("",!0),m("div",N0,[$(Se,{category:"secondary",size:"default",type:"plain",onClick:B[1]||(B[1]=()=>{t(a)("close")})},{default:x(()=>[ce(C(t(l).cancel),1)]),_:1}),$(Se,{size:"default",onClick:A},{default:x(()=>[ce(C(t(l).save),1)]),_:1})])],2)],6)),$(Ua,{visibility:t(N)&&t(g)!==null,title:t(l).confirm,description:t(l).confirm_save_following,"close-btn-text":t(l).save_single,"confirm-btn-text":t(l).update_following,"customized-options":{cancelBtn:{type:"plain"},confirmBtn:{type:""}},onDecline:B[2]||(B[2]=G=>S(!1)),onConfirm:B[3]||(B[3]=G=>S(!0)),onClose:B[4]||(B[4]=G=>we(N)?N.value=!1:N=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"]),$(Ua,{visibility:t(E),title:t(l).confirm,description:t(l).confirm_save_conflict,"close-btn-text":t(l).cancel,"confirm-btn-text":t(l).confirm,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:B[5]||(B[5]=G=>we(E)?E.value=!1:E=!1),onConfirm:P,onClose:B[6]||(B[6]=G=>we(E)?E.value=!1:E=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],64)}}});const F0={class:"am-cap__att"},V0={class:"am-cap-customers"},B0={class:"am-cap__cust-option"},R0={class:"am-cap__cust-option__heading"},q0={key:0,class:"am-cap__cust-option__inner"},U0={key:1,class:"am-cap__cust-option__inner"},z0={key:0,class:"am-cap-cust__data-wrapper"},j0={key:0,class:"am-cap-cust__data"},Y0=m("span",{class:"am-icon-phone"},null,-1),W0=["href"],H0={key:1,class:"am-cap-cust__data"},Z0=m("span",{class:"am-icon-email"},null,-1),G0=["href"],J0={class:"am-cap__att-heading"},X0={props:{event:{type:Object,default:()=>{}},isNew:{type:Boolean,default:!1},pageWidth:{type:Number,required:!0}},setup(n,{expose:a}){const e=n;let s=_(()=>st(e.pageWidth)),l=De(),i=R("amLabels");const o=R("settings"),r=R("shortcodeData");let u=R("amCustomize"),d=_(()=>r.value.cabinetType==="employee"?u.value.events.options.customerPhone.visibility:!0),f=_(()=>r.value.cabinetType==="employee"?u.value.events.options.customerEmail.visibility:!0),v=F(null),g=F({customerId:_({get:()=>l.getters["attendee/getCustomerId"],set:z=>l.commit("attendee/setCustomerId",z)}),status:_({get:()=>l.getters["attendee/getStatus"],set:z=>l.commit("attendee/setStatus",z)}),persons:_({get:()=>l.getters["attendee/getPersons"],set:z=>l.commit("attendee/setPersons",z)}),tickets:_({get:()=>l.getters["attendee/getTickets"],set:z=>l.commit("attendee/setTickets",z)})}),k=F({customerId:[{required:!0,message:i.value.select_customer,trigger:["submit","change"]}]}),N=_(()=>e.event.settings?JSON.parse(e.event.settings):null),E=F(Ir().filter(z=>z.value!=="canceled"&&(!o.appointments.waitingListEvents.enabled||(N.value?"waitingList"in N.value&&!N.value.waitingList.enabled:!0)?z.value!=="waiting":!0)&&z.value!=="no-show")),b=_(()=>l.getters["customerInfo/getLoading"]),A=_(()=>l.getters["customerInfo/getCustomers"]),S=_(()=>g.value.customerId?A.value.find(z=>z.id===g.value.customerId):null);function P(z){l.dispatch("customerInfo/resetCustomer"),l.commit("customerInfo/setLoading",!0),h.value=!0,Ne.get("/users/customers/"+z,Object.assign({params:{source:"cabinet-provider"}},ze(l))).then(D=>{l.commit("customerInfo/setCustomer",wr(l,D.data.data.user))}).catch(D=>{console.log(D)}).finally(()=>{l.commit("customerInfo/setLoading",!1)})}let h=F(!1);function I(){l.dispatch("customerInfo/resetCustomer"),h.value=!0}function L(z){l.commit("customerInfo/setCustomers",[z]),l.commit("attendee/setCustomerId",z.id)}Je(()=>{l.getters["attendee/getId"]||l.commit("customerInfo/setCustomers",l.getters["auth/getPreloadedCustomers"])}),a({detailsFormRef:v});function T(z){if(z){if(z===1)return{class:"am-no-show-1",icon:"no-show-1"};if(z===2)return{class:"am-no-show-2",icon:"no-show-2"};if(z>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}let w=R("amColors"),B=_(()=>({"--am-c-cust-no1":w.value.colorMainText,"--am-c-cust-no1-bgr":H(w.value.colorMainText,.1),"--am-c-cust-no2":w.value.colorWarning,"--am-c-cust-no2-bgr":H(w.value.colorWarning,.1),"--am-c-cust-no3":w.value.colorError,"--am-c-cust-no3-bgr":H(w.value.colorError,.1),"--am-c-cust-text":w.value.colorMainText,"--am-c-cust-link":H(w.value.colorMainText,.5)}));return(z,D)=>{const G=yt,se=et;return c(),y("div",F0,[$(se,{ref_key:"detailsFormRef",ref:v,model:t(g),rules:t(k),class:"am-cap__att-form"},{default:x(()=>[m("div",V0,[e.isNew?(c(),U(G,{key:0,prop:"customerId",class:"am-cap__att-form__item am-w-100"},{default:x(()=>[$(He,{modelValue:t(g).customerId,"onUpdate:modelValue":D[0]||(D[0]=j=>t(g).customerId=j),filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","prefix-icon":"search","prefix-icon-color":"var(--am-c-inp-text)","popper-class":"am-cap-cust__popper",placeholder:t(i).event_attendees_search,"remote-method":j=>{t(Hs)(t(l),j)},loading:t(b),onFocus:D[1]||(D[1]=j=>t(Ii)(t(l)))},{default:x(()=>[(c(!0),y(ee,null,fe(t(A),j=>(c(),U(qe,{key:j.id,value:j.id,label:j.email?j.email:j.firstName+" "+j.lastName},{default:x(()=>[m("div",B0,[m("div",R0,C(j.firstName+" "+j.lastName),1),j.email&&t(f)?(c(),y("div",q0,C(j.email),1)):O("",!0),j.phone&&t(d)?(c(),y("div",U0,C(j.phone),1)):O("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"])]),_:1})):O("",!0),!t(l).getters["attendee/getId"]&&t(o).roles.allowWriteCustomers?(c(),U(Se,{key:1,class:q(["am-capai-cuf__heading-add",e.responsiveClass]),size:"default",disabled:!!t(g).customerId,prefix:"plus",icon:"plus","icon-only":e.pageWidth<=420,onClick:I},{default:x(()=>[ce(C(t(i).new_customer),1)]),_:1},8,["class","disabled","icon-only"])):O("",!0)]),t(S)?(c(),y("div",{key:0,class:q(["am-cap-attendee",t(s)])},[m("div",{class:q(["am-cap-cust",t(s)]),style:be(t(B))},[m("div",{class:q(["am-cap-cust__name",T(0).class])},[T(0).icon?(c(),y("span",{key:0,class:q(`am-icon-${T(0).icon}`)},null,2)):O("",!0),ce(" "+C(t(S).firstName+" "+t(S).lastName),1)],2),t(S).phone&&t(d)||t(S).email&&t(f)?(c(),y("div",z0,[t(S).phone&&t(d)?(c(),y("div",j0,[Y0,m("a",{href:`tel:${t(S).phone}`},C(t(S).phone),9,W0)])):O("",!0),t(S).email&&t(f)?(c(),y("div",H0,[Z0,m("a",{href:`mailto:${t(S).email}`},C(t(S).email),9,G0)])):O("",!0)])):O("",!0)],6),$(G,{prop:"status",class:q(["am-cap__att-form__item",t(s)])},{default:x(()=>[$(He,{modelValue:t(g).status,"onUpdate:modelValue":D[2]||(D[2]=j=>t(g).status=j),disabled:!e.isNew,placeholder:t(i).select,"prefix-icon":t(E).find(j=>j.value===t(g).status).icon,"prefix-icon-color":t(E).find(j=>j.value===t(g).status).color,"popper-class":"am-capei-att__popper"},{default:x(()=>[(c(!0),y(ee,null,fe(t(E),j=>(c(),U(qe,{key:j.value,value:j.value,label:j.label},{default:x(()=>[m("span",{class:q(`am-icon-${j.icon}`),style:be({color:j.color})},null,6),ce(" "+C(j.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder","prefix-icon","prefix-icon-color"])]),_:1},8,["class"]),t(o).roles.allowWriteCustomers?(c(),U(ha,{key:0,"have-delete":!1,"reference-class":t(s),onEdit:D[3]||(D[3]=j=>P(t(S).id))},null,8,["reference-class"])):O("",!0)],2)):O("",!0),t(S)?(c(),y(ee,{key:1},[e.event.customPricing?(c(),y(ee,{key:1},[m("div",J0,C(`${t(i).event_book_tickets}:`),1),(c(!0),y(ee,null,fe(t(g).tickets,(j,ne)=>(c(),U(G,{key:ne,label:e.event.customTickets.find(te=>te.id===j.eventTicketId).name,class:q(["am-cap__att-form__item",t(s)])},{default:x(()=>[$(ht,{modelValue:j.persons,"onUpdate:modelValue":te=>j.persons=te,min:0,disabled:!t(o).roles.allowWriteEvents},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","class"]))),128))],64)):(c(),U(G,{key:0,prop:"persons",label:`${t(i).event_book_persons}:`,class:q(["am-cap__att-form__item",t(s)])},{default:x(()=>[$(ht,{modelValue:t(g).persons,"onUpdate:modelValue":D[4]||(D[4]=j=>t(g).persons=j),min:1,disabled:!t(o).roles.allowWriteEvents},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]))],64)):O("",!0),t(S)?O("",!0):(c(),U(Ia,{key:2,heading:t(i).no_attendees_yet},null,8,["heading"]))]),_:1},8,["model","rules"]),t(h)?(c(),U(Sr,{key:0,visibility:t(h),"responsive-class":e.responsiveClass,"onUpdate:visibility":D[5]||(D[5]=j=>we(h)?h.value=j:h=j),onAddedCustomer:L},null,8,["visibility","responsive-class"])):O("",!0)])}}};const Q0={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:a}){const e=n;let s=De();const l=R("settings");let i=R("amLabels"),o=F(null),r=F({}),u=F({}),d=F({}),f=_(()=>s.getters["attendee/getCustomFields"]);function v(N,E){let b=s.getters["attendee/getId"];(N.type!=="file"||b)&&(r.value[E]=_({get:()=>{let A=s.getters["attendee/getCustomFields"][E]?.value;return A||""},set:A=>s.commit("attendee/setCustomFields",{id:E,value:A})}))}function g(N,E){let b=s.getters["attendee/getId"];(N.type!=="file"||b)&&(d.value[E]={template:Ye[N.type],props:{id:E,itemName:E.toString(),label:N.label,options:N.options,class:`am-capei-att-cf__item am-cf-width-${N.width}`}}),(N.type==="checkbox"||N.type==="radio")&&(d.value[E].props.options=d.value[E].props.options.map(A=>({...A,value:A.label}))),N.type==="text-area"&&(d.value[E].props={...d.value[E].props,itemType:"textarea"}),N.type==="file"&&b&&(d.value[E].props={...d.value[E].props,btnLabel:i.value.upload_file_here,isUpload:!1,bookingId:b,source:"cabinet-provider"}),N.type==="datepicker"&&(d.value[E].props={...d.value[E].props,weekStartsFromDay:l.wordpress.startOfWeek})}function k(N){let E=s.getters["attendee/getId"];(N.type!=="file"||E)&&(u.value[N.id]=[{message:i.value.required_field,required:N.required,trigger:["submit","change"]}])}return Je(()=>{r.value={},d.value={};for(let N in f.value)v(f.value[N],N),g(f.value[N],N),k(f.value[N])}),a({customFieldsFormRef:o}),(N,E)=>{const b=et;return c(),U(b,{ref_key:"customFieldsFormRef",ref:o,model:t(r),rules:t(u),"label-position":"top",class:q(["am-capei-att-cf__form",e.responsiveClass])},{default:x(()=>[(c(!0),y(ee,null,fe(Object.keys(t(f)),A=>(c(),y(ee,{key:A},[A in t(r)?(c(),U(pt(t(d)[A].template),Lt({key:0,modelValue:t(r)[A],"onUpdate:modelValue":S=>t(r)[A]=S},t(d)[A].props),null,16,["modelValue","onUpdate:modelValue"])):O("",!0)],64))),128))]),_:1},8,["model","rules","class"])}}};const K0={class:"am-capai-pay__row-label"},ek={class:"am-capai-pay__row-value"},tk={class:"am-capai-pay__row-label"},ak={class:"am-capai-pay__row-value"},sk={class:"am-capai-pay__row-label"},lk={class:"am-capai-pay__row-value"},nk={key:0,class:"am-divider"},ik={class:"am-capai-pay__row-label"},ok={class:"am-capai-pay__row-label"},rk={class:"am-capai-pay__row-label"},ck={class:"am-capai-pay__row-label"},uk={class:"am-capai-pay__row-label"},dk={class:"am-capai-pay__row-label"},mk={class:"am-capai-pay__row-label"},pk={props:{event:{type:Object,default:()=>{}},pageWidth:{type:Number,default:0}},setup(n){const a=n;let e=De(),s=R("amLabels"),l=_(()=>e.getters["attendee/getPayments"]),i=_(()=>Object.assign($r(e),{deposit:l.value[0].amount,paid:l.value.reduce((u,d)=>u+d.amount,0)})),o=R("amColors"),r=_(()=>({"--am-c-pay-text-op03":H(o.value.colorMainText,.03)}));return(u,d)=>(c(),y("div",{class:q(["am-capai-pay__content",a.responsiveClass]),style:be(t(r))},[(c(!0),y(ee,null,fe(t(l),(f,v)=>(c(),y(ee,{key:v},[m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",K0,C(t(s).date),1),m("div",ek,C(t(nt)(f.dateTime.split(" ")[0])),1)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",tk,C(t(s).payment_method),1),m("div",ak,C(t(Er)(f)),1)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",sk,C(t(s).status),1),m("div",lk,[m("span",{class:q(t(ds)(f.status,t(o)).icon),style:be({color:t(ds)(f.status,t(o)).color})},null,6),ce(" "+C(t(ni)(f.status)),1)])],2)],64))),128)),a.pageWidth>480?(c(),y("div",nk)):O("",!0),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",ik,C(t(s).price),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},C(t(tt)(t(i).price)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",ok,C(t(s).discount_amount),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},C(t(tt)(t(i).discount)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",rk,C(t(s).tax),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},C(t(tt)(t(i).tax)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",ck,C(t(s).paid_deposit),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},C(t(tt)(t(i).deposit)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",uk,C(t(s).paid_remaining_amount),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},C(t(tt)(t(i).paid-t(i).deposit)),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",dk,C(t(s).due),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},C(t(tt)(t(i).paid-(t(i).price-t(i).discount+t(i).tax))),3)],2),m("div",{class:q(["am-capai-pay__row",a.responsiveClass])},[m("div",mk,C(t(s).total),1),m("div",{class:q(["am-capai-pay__row-value",{"am-pl-34":a.pageWidth>480}])},C(t(tt)(t(i).price-t(i).discount+t(i).tax)),3)],2)],6))}};const gk=m("span",{class:"am-icon-clearable"},null,-1),fk={class:"am-capei-atti__footer"},hk={name:"CabinetEventAttendee"},Pr=Object.assign(hk,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},isNew:{type:Boolean,default:!1},event:{type:Object,default:()=>{}},pageWidth:{type:Number,default:0}},emits:["close","save"],setup(n,{emit:a}){const e=n;let s=De(),l=R("amLabels");const i=R("settings");let o=F(!1),r=_(()=>s.getters["attendee/getCustomFields"]);const u=F("details");let d=F(null),f=F(null),v=F(!1),g=F(null),k=F("");function N(){v.value=!1,k.value=""}let E=F(!1),b=F();Be("formWrapper",b);function A(){let w=$r(s);return w.price-w.discount+w.tax}function S(){let w=!0;if(f.value?.customFieldsFormRef.validate(D=>{D||(u.value="customFields",w=!1)}),d.value?.detailsFormRef.validate(D=>{D||(u.value="details",w=!1)}),!w)return;let B=i.payments.paymentLinks&&i.payments.paymentLinks.enabled,z=e.event.settings?JSON.parse(e.event.settings):null;z&&"payments"in z&&"paymentLinks"in z.payments&&(B=z.payments.paymentLinks.enabled),B&&s.getters["attendee/getId"]&&A()>h.value?E.value=!0:P(!1)}function P(w){o.value=!0,Ne.post(s.getters["attendee/getId"]?"/events/bookings/"+s.getters["attendee/getId"]:"/bookings",Object.assign(Ar(s),{runInstantPostBookingActions:!0,createPaymentLinks:w}),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{a("save"),s.commit("attendee/setActive",!1)}).catch(B=>{console.log(B)}).finally(()=>{o.value=!1})}let h=F(0);function I(){s.commit("attendee/setActive",!1),a("close")}Je(()=>{s.commit("attendee/setActive",!0),s.getters["attendee/getId"]&&(h.value=A())});let L=R("amColors"),T=_(()=>({"--am-c-capai-text":L.value.colorMainText,"--am-c-capai-text-op10":H(L.value.colorMainText,.1),"--am-c-capai-primary":L.value.colorPrimary,"--am-c-cust-no1":L.value.colorMainText,"--am-c-cust-no1-bgr":H(L.value.colorMainText,.1),"--am-c-cust-no2":L.value.colorWarning,"--am-c-cust-no2-bgr":H(L.value.colorWarning,.1),"--am-c-cust-no3":L.value.colorError,"--am-c-cust-no3-bgr":H(L.value.colorError,.1),"--am-c-cust-link":H(L.value.colorMainText,.5),"--am-c-cust-text":L.value.colorMainText}));return(w,B)=>{const z=va,D=_a;return t(o)?(c(),U(Wt,{key:1})):(c(),y("div",{key:0,class:q(["am-capei-atti",[{"am-no-border":!0},t(e).responsiveClass]]),style:be(t(T))},[t(v)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:N,onTriggerClose:N},{title:x(()=>[gk,ce(" "+C(t(k)),1)]),_:1},512)):O("",!0),$(D,{modelValue:u.value,"onUpdate:modelValue":B[0]||(B[0]=G=>u.value=G)},{default:x(()=>[$(z,{label:t(l).details,name:"details"},{default:x(()=>[$(t(X0),{ref_key:"attendeeDetailsRef",ref:d,event:t(e).event,"is-new":t(e).isNew,"page-width":t(e).pageWidth},null,8,["event","is-new","page-width"])]),_:1},8,["label"]),Object.keys(t(r)).length?(c(),U(z,{key:0,label:t(l).custom_fields,name:"customFields"},{default:x(()=>[$(t(Q0),{ref_key:"attendeeCustomFieldsRef",ref:f,event:t(e).event},null,8,["event"])]),_:1},8,["label"])):O("",!0),t(s).getters["attendee/getId"]?(c(),U(z,{key:1,label:t(l).payment,name:"payment"},{default:x(()=>[$(t(pk),{event:t(e).event,"page-width":t(e).pageWidth},null,8,["event","page-width"])]),_:1},8,["label"])):O("",!0)]),_:1},8,["modelValue"]),m("div",fk,[$(Se,{category:"secondary",size:"default",type:"plain",onClick:I},{default:x(()=>[ce(C(t(i).roles.allowWriteEvents?t(l).cancel:t(l).close),1)]),_:1}),t(i).roles.allowWriteEvents?(c(),U(Se,{key:0,size:"default",onClick:S},{default:x(()=>[ce(C(t(l).save),1)]),_:1})):O("",!0)]),$(Ua,{visibility:t(E),title:t(l).confirm,description:t(l).price_changed_message,"close-btn-text":t(l).no,"confirm-btn-text":t(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:B[1]||(B[1]=G=>P(!1)),onConfirm:B[2]||(B[2]=G=>P(!0)),onClose:B[3]||(B[3]=G=>we(E)?E.value=!1:E=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],6))}}});const vk=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),_k={key:1,class:"am-capei-att__top"},yk={class:"am-capei-att__top-heading"},bk={class:"am-capei-att__top-text"},kk={key:0,class:"am-capei-att__top-places"},Ck={class:"am-cap__cust-option"},xk={class:"am-cap__cust-option__heading"},wk={key:0,class:"am-cap__cust-option__inner"},Tk={key:1,class:"am-cap__cust-option__inner"},Sk={key:0,class:"am-capei-att__card-wrapper"},Ek={key:0,class:"am-capei-customer__data-wrapper"},Lk={key:0,class:"am-capei-customer__data"},Ak=m("span",{class:"am-icon-phone"},null,-1),Ik=["href"],$k={key:1,class:"am-capei-customer__data"},Pk=m("span",{class:"am-icon-email"},null,-1),Dk=["href"],Nk={key:0,class:"am-capei-att__card-tickets"},Ok={class:"am-capei-att__card-label"},Mk={class:"am-capei-att__card-tickets__inner"},Fk={key:1,class:"am-capei-att__card-persons"},Vk={class:"am-capei-att__card-label"},Bk={class:"am-capei-att__card-person"},Rk={key:0,class:"am-capei-att__card-wrapper"},qk={key:0,class:"am-capei-customer__data-wrapper"},Uk={key:0,class:"am-capei-customer__data"},zk=m("span",{class:"am-icon-phone"},null,-1),jk=["href"],Yk={key:1,class:"am-capei-customer__data"},Wk=m("span",{class:"am-icon-email"},null,-1),Hk=["href"],Zk={key:0,class:"am-capei-att__card-tickets"},Gk={class:"am-capei-att__card-label"},Jk={class:"am-capei-att__card-tickets__inner"},Xk={key:1,class:"am-capei-att__card-persons"},Qk={class:"am-capei-att__card-label"},Kk={class:"am-capei-att__card-person"},eC={name:"CabinetEventAttendees"},tC=Object.assign(eC,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number},event:{type:Object,default:()=>{}}},emits:["close","openAttendee"],setup(n,{emit:a}){const e=n;let s=De(),l=R("amLabels");const i=R("settings"),o=R("shortcodeData");let r=R("amCustomize"),u=_(()=>o.value.cabinetType==="employee"?r.value.events.options.customerPhone.visibility:!0),d=_(()=>o.value.cabinetType==="employee"?r.value.events.options.customerEmail.visibility:!0),f=F(null),v=F(!1),g=F("success"),k=F("");function N(){v.value=!1,s.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}let E=F(!1),b=F(!1),A=F(!1),S=F([]),P=F(0),h=F(1),I=F(!1),L=F([]),T=F(0),w=F(1),B=_(()=>e.event.settings?JSON.parse(e.event.settings):null);const{noShowData:z}=R("noShowData");let D=F(!1),G=F(null),se=F(!1);function j(){G.value=null,D.value=!1}function ne(Oe,Re){G.value=Oe,se.value=Re,D.value=!0}let te=F(null);function oe(){s.commit("attendee/setActive",!1),v.value=!0,k.value=l.value.event_attendee_saved,te.value&&f.value&&setTimeout(function(){dt(te.value,f.value.$el,0,300)},500),M(Ae.value==="approved"?["approved","canceled"]:["waiting"]),ie()}function ie(){E.value=!1,b.value=!1,a("openAttendee",!1)}function K(){s.commit("attendee/setAttendee",fs(s,s.getters["attendee/getDefaultAttendee"],e.event)),E.value=!0,a("openAttendee",!0)}function me(Oe){let Re=s.getters["customerInfo/getCustomers"],ke=s.getters["customerInfo/getCustomersIds"];Re.filter(Ue=>Ue.id===Oe.customer.id).length===0&&(Re.push(Oe.customer),s.commit("customerInfo/setCustomers",Re)),ke.indexOf(Oe.customer.id)===-1&&(ke.push(Oe.customer.id),s.commit("customerInfo/setCustomersIds",ke)),s.commit("attendee/setAttendee",fs(s,Oe,e.event)),b.value=!0,E.value=!0,a("openAttendee",!0)}const Ae=F("approved");function Ve(){switch(Ae.value){case"approved":h.value=1;break;case"waiting":w.value=1;break}M(Ae.value==="approved"?["approved","canceled"]:["waiting"])}let Q=F(null),_e=_(()=>s.getters["customerInfo/getLoading"]),X=_(()=>s.getters["customerInfo/getCustomers"]);function M(Oe,Re=1){Oe[0]==="approved"?A.value=!0:I.value=!0,Ne.get("/bookings/events",Object.assign(ze(s),{params:Js({source:"cabinet-provider",statuses:Oe,page:Re,limit:parseInt(i.general.itemsPerPageBackEnd),events:[e.event.id],customers:Q.value?[Q.value]:[]})})).then(ke=>{Oe[0]==="approved"?(ae.value=ke.data.data.attendeeCount,xe.value=ke.data.data.maxCapacity,S.value=ke.data.data.bookings.filter(Ue=>Ue.status==="approved"||Ue.status==="canceled").reduce((Ue,J)=>(Ue.push(fs(s,bo(J,s.getters["attendee/getAttendee"]),e.event)),Ue),[]),P.value=ke.data.data.filteredCount):(ae.value=ke.data.data.waitingCount,xe.value=ke.data.data.waitingCapacity,L.value=ke.data.data.bookings.filter(Ue=>Ue.status==="waiting").reduce((Ue,J)=>(Ue.push(bo(J)),Ue),[]),T.value=ke.data.data.filteredCount)}).catch(ke=>{console.log(ke)}).finally(()=>{A.value=!1,I.value=!1})}function Z(Oe,Re){Ne.post("/events/bookings/"+Oe,{status:Re,bookings:[{status:Re}]},Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{}).catch(ke=>{console.log(ke)}).finally(()=>{})}function W(Oe){let Re=Ae.value==="approved"?["approved","canceled"]:["waiting"];Re[0]==="approved"?h.value=Oe:w.value=Oe,M(Re,Oe)}function le(){D.value=!1,se.value?I.value=!0:A.value=!0,Ne.post("/events/bookings/delete/"+G.value.id,Ar(s),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{W(h.value)}).catch(()=>{I.value=!1,A.value=!1})}let de=F(Ir().filter(Oe=>(!i.appointments.waitingListEvents.enabled||(B.value?"waitingList"in B.value&&!B.value.waitingList.enabled:!0)?Oe.value!=="waiting":!0)&&(i.roles.enableNoShowTag?!0:Oe.value!=="no-show"))),ae=F(0),xe=F(0),ye=_(()=>`${ae.value}/${xe.value}`),pe=_(()=>ae.value===1?l.value.attendee:l.value.attendees);Je(()=>{M(["approved","canceled"]),s.commit("customerInfo/setCustomers",s.getters["auth/getPreloadedCustomers"])});let Te=R("amColors"),Pe=_(()=>({"--am-c-capei-att-primary":Te.value.colorPrimary,"--am-c-capei-att-text":Te.value.colorMainText,"--am-c-capei-att-text-op90":H(Te.value.colorMainText,.9),"--am-c-capei-att-text-op10":H(Te.value.colorMainText,.1)}));return(Oe,Re)=>{const ke=va,Ue=_a;return c(),y("div",{ref_key:"attendeesContainer",ref:te,class:"am-capei-att",style:be(t(Pe))},[t(v)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:f,type:t(g),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:N,onTriggerClose:N},{title:x(()=>[vk,ce(" "+C(t(k)),1)]),_:1},8,["type"])):O("",!0),t(E)?O("",!0):(c(),y("div",_k,[m("div",yk,[m("div",bk,C(t(e).event.name),1),t(xe)?(c(),y("div",kk,C(t(ye))+" "+C(t(pe)),1)):O("",!0)]),$(Se,{category:"secondary",type:"plain",size:"small",class:"am-capei-att__back",onClick:Re[0]||(Re[0]=J=>t(a)("close"))},{default:x(()=>[ce(C(t(l).back),1)]),_:1})])),t(E)?O("",!0):(c(),y("div",{key:2,class:q(["am-capei-att__header",t(e).responsiveClass])},[$(He,{modelValue:t(Q),"onUpdate:modelValue":Re[1]||(Re[1]=J=>we(Q)?Q.value=J:Q=J),filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","prefix-icon":"search","prefix-icon-color":"var(--am-c-capei-att-text)","popper-class":"am-cap-cust__popper",placeholder:t(l).event_attendees_search,"remote-method":J=>{t(Hs)(t(s),J)},loading:t(_e),onFocus:Re[2]||(Re[2]=J=>t(Ii)(t(s))),onChange:Re[3]||(Re[3]=J=>M(Ae.value==="approved"?["approved","canceled"]:["waiting"],1))},{default:x(()=>[(c(!0),y(ee,null,fe(t(X),J=>(c(),U(qe,{key:J.id,value:J.id,label:`${J.firstName} ${J.lastName}`},{default:x(()=>[m("div",Ck,[m("div",xk,C(J.firstName+" "+J.lastName),1),t(d)?(c(),y("div",wk,C(J.email),1)):O("",!0),t(u)?(c(),y("div",Tk,C(J.phone),1)):O("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"]),t(i).roles.allowWriteEvents?(c(),U(Se,{key:0,prefix:"plus",icon:"plus","icon-only":t(e).pageWidth<540,onClick:K},{default:x(()=>[ce(C(t(l).event_add_attendee),1)]),_:1},8,["icon-only"])):O("",!0)],2)),t(E)?O("",!0):(c(),U(Ue,{key:3,modelValue:Ae.value,"onUpdate:modelValue":Re[4]||(Re[4]=J=>Ae.value=J),onTabClick:Ve},{default:x(()=>[$(ke,{label:t(l).attendees,name:"approved"},{default:x(()=>[t(A)?(c(),U(Wt,{key:1})):(c(),y("div",Sk,[t(S).length?(c(),y(ee,{key:0},[(c(!0),y(ee,null,fe(t(S),(J,ve)=>(c(),y("div",{key:ve,class:q(["am-capei-att__card",t(e).responsiveClass])},[m("div",{class:q(["am-capei-att__card-inner",t(e).responsiveClass])},[m("div",{class:q(["am-capei-att__info",t(e).responsiveClass])},[m("div",{class:q(["am-capei-customer__name",t(z)(0).class])},[t(z)(0).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(z)(0).icon}`)},null,2)):O("",!0),ce(" "+C(J.customer.firstName+" "+J.customer.lastName),1)],2),J.customer.phone&&t(u)||J.customer.email&&t(d)?(c(),y("div",Ek,[J.customer.phone&&t(u)?(c(),y("div",Lk,[Ak,m("a",{href:`tel:${J.customer.phone}`},C(J.customer.phone),9,Ik)])):O("",!0),J.customer.email&&t(d)?(c(),y("div",$k,[Pk,m("a",{href:`mailto:${J.customer.email}`},C(J.customer.email),9,Dk)])):O("",!0)])):O("",!0)],2),$(He,{modelValue:J.status,"onUpdate:modelValue":ge=>J.status=ge,placeholder:t(l).select,disabled:!t(i).roles.allowWriteEvents,"prefix-icon":t(de).find(ge=>ge.value===J.status).icon,"prefix-icon-color":t(de).find(ge=>ge.value===J.status).color,"popper-class":"am-capei-att__popper","parent-class":t(e).responsiveClass,onChange:ge=>{Z(J.id,ge)}},{default:x(()=>[(c(!0),y(ee,null,fe(t(de),ge=>(c(),U(qe,{key:ge.value,value:ge.value,label:ge.label},{default:x(()=>[m("span",{class:q(`am-icon-${ge.icon}`),style:be({color:ge.color})},null,6),ce(" "+C(ge.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","prefix-icon","prefix-icon-color","parent-class","onChange"])],2),J.ticketsData.length?(c(),y("div",Nk,[m("div",Ok,C(t(l).event_book_tickets)+": ",1),m("div",Mk,[(c(!0),y(ee,null,fe(J.ticketsData,(ge,Me)=>(c(),y("div",{key:Me,class:"am-capei-att__card-ticket"},C(ge.persons)+" x "+C(t(e).event.customTickets.find(Ce=>Ce.id===ge.eventTicketId).name),1))),128))])])):(c(),y("div",Fk,[m("div",Vk,C(t(l).event_book_persons)+": ",1),m("div",Bk,C(J.persons),1)])),t(i).roles.allowWriteEvents?(c(),U(ha,{key:2,index:ve,"reference-class":t(e).responsiveClass,onEdit:ge=>me(J),onRemove:ge=>ne(J,!1)},null,8,["index","reference-class","onEdit","onRemove"])):O("",!0)],2))),128)),t(P)>t(i).general.itemsPerPageBackEnd?(c(),U(Al,{key:0,"page-size":t(i).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:t(P),"current-page":t(h),onCurrentChange:W},null,8,["page-size","total","current-page"])):O("",!0)],64)):(c(),U(Ia,{key:1,heading:t(l).no_attendees_yet},null,8,["heading"]))]))]),_:1},8,["label"]),t(i).appointments.waitingListEvents.enabled&&t(B)!==null&&"waitingList"in t(B)&&t(B).waitingList.enabled?(c(),U(ke,{key:0,label:t(l).waiting_list,name:"waiting"},{default:x(()=>[t(I)?(c(),U(Wt,{key:1})):(c(),y("div",Rk,[t(L).length?(c(),y(ee,{key:0},[(c(!0),y(ee,null,fe(t(L),(J,ve)=>(c(),y("div",{key:ve,class:"am-capei-att__card"},[m("div",{class:q(["am-capei-att__card-inner",t(e).responsiveClass])},[m("div",{class:q(["am-capei-att__info",t(e).responsiveClass])},[m("div",{class:q(["am-capei-customer__name",t(z)(0).class])},[t(z)(0).icon?(c(),y("span",{key:0,class:q(`am-icon-${t(z)(0).icon}`)},null,2)):O("",!0),ce(" "+C(J.customer.firstName+" "+J.customer.lastName),1)],2),J.customer.phone&&t(u)||J.customer.email&&t(d)?(c(),y("div",qk,[J.customer.phone&&t(u)?(c(),y("div",Uk,[zk,m("a",{href:`tel:${J.customer.phone}`},C(J.customer.phone),9,jk)])):O("",!0),J.customer.email&&t(d)?(c(),y("div",Yk,[Wk,m("a",{href:`mailto:${J.customer.email}`},C(J.customer.email),9,Hk)])):O("",!0)])):O("",!0)],2),$(He,{modelValue:J.status,"onUpdate:modelValue":ge=>J.status=ge,placeholder:t(l).select,disabled:!t(i).roles.allowWriteEvents,"prefix-icon":t(de).find(ge=>ge.value===J.status).icon,"prefix-icon-color":t(de).find(ge=>ge.value===J.status).color,"popper-class":"am-capei-att__popper",onChange:ge=>{Z(J.id,ge)}},{default:x(()=>[(c(!0),y(ee,null,fe(t(de),ge=>(c(),U(qe,{key:ge.value,value:ge.value,label:ge.label},{default:x(()=>[m("span",{class:q(`am-icon-${ge.icon}`),style:be({color:ge.color})},null,6),ce(" "+C(ge.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","prefix-icon","prefix-icon-color","onChange"])],2),Object.keys(J.ticketsData).length?(c(),y("div",Zk,[m("div",Gk,C(t(l).event_book_tickets)+": ",1),m("div",Jk,[(c(!0),y(ee,null,fe(J.ticketsData,(ge,Me)=>(c(),y("div",{key:Me,class:"am-capei-att__card-ticket"},C(ge.persons)+" x "+C(t(e).event.customTickets.find(Ce=>Ce.id===ge.eventTicketId).name),1))),128))])])):(c(),y("div",Xk,[m("div",Qk,C(t(l).event_book_persons)+": ",1),m("div",Kk,C(J.persons),1)])),t(i).roles.allowWriteEvents?(c(),U(ha,{key:2,index:ve,"reference-class":t(e).responsiveClass,onEdit:ge=>me(J),onRemove:ge=>ne(J,!0)},null,8,["index","reference-class","onEdit","onRemove"])):O("",!0)]))),128)),t(T)>t(i).general.itemsPerPageBackEnd?(c(),U(Al,{key:0,"page-size":t(i).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:t(T),"current-page":t(w),onCurrentChange:W},null,8,["page-size","total","current-page"])):O("",!0)],64)):(c(),U(Ia,{key:1,heading:t(l).no_attendees_yet},null,8,["heading"]))]))]),_:1},8,["label"])):O("",!0)]),_:1},8,["modelValue"])),$(Ua,{visibility:t(D),title:t(l).confirm,description:t(l).event_attendee_remove,"close-btn-text":t(l).no,"confirm-btn-text":t(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:j,onConfirm:le,onClose:j},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"]),t(E)?(c(),U(Pr,{key:4,visibility:t(E),title:t(b)?t(l).event_edit_attendee:t(l).event_add_attendee,event:t(e).event,"page-width":t(e).pageWidth,"is-new":!t(b),onSave:oe,onClose:ie},null,8,["visibility","title","event","page-width","is-new"])):O("",!0)],4)}}});const aC=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),sC={key:2,class:"am-cap__actions"},lC={name:"CabinetEvents",key:"events"},nC=Object.assign(lC,{props:{loadBookingsCounter:{type:Number,default:0}},setup(n){const a=n;let e=De(),s=F(null),{width:l}=ja(s),i=_(()=>st(l.value)),o={components:{IconComponent:We},template:'<IconComponent icon="plus"/>'};const r=R("settings");let u=R("originKey"),d=R("amCustomize");const f=R("shortcodeData"),v=R("labels"),g=R("localLanguage");let k=_(()=>r.general.usedLanguages.includes(g.value)),N=_(()=>{let J=Qe({...v}),ve=d.value.events.translations;return ve&&Object.keys(ve).forEach(ge=>{ve[ge][g.value]&&k.value?J[ge]=ve[ge][g.value]:ve[ge].default&&(J[ge]=ve[ge].default)}),J});Be("amLabels",N);let E=F(null),b=F(!1),A=F("success"),S=F("");function P(){b.value=!1,e.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}function h(J){let ve=Qe({...v}),ge=d.value[J].translations;return ge&&Object.keys(ge).forEach(Me=>{ge[Me][g.value]&&k.value?ve[Me]=ge[Me][g.value]:ge[Me].default&&(ve[Me]=ge[Me].default)}),ve}function I(J){return d.value[J].options}let L=_(()=>e.getters["entities/getReady"]),T=R("cabinetType");e.commit("cabinetFilters/setDates",mi(T.value));let w=_(()=>e.getters["cabinet/getEventsLoading"]),B=F(!1),z=F(null),D=F(null),G=F(0),se=F(1);function j(J){se.value=J,ne(J)}function ne(J=1){z.value=null,e.commit("cabinet/setEventsLoading",!0);let ve=e.getters["cabinet/getTimeZone"],ge=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getEventsFilters"]));ge.dates=ge.dates.map(Ce=>he(Ce).format("YYYY-MM-DD")),ge.timeZone=ve,ge.source="cabinet-"+T.value,ge.id=ge.events,ge.group=!0,ge.page=J,ge.limit=r.general.itemsPerPageBackEnd,ge.customers&&(ge.customerId=ge.customers),e.commit("auth/setLoadingEventsCounter",e.getters["auth/getLoadingEventsCounter"]+1);let Me=e.getters["auth/getLoadingEventsCounter"];Ne.get("/events",Object.assign(ze(e),{params:Js(ge)})).then(Ce=>{Me===e.getters["auth/getLoadingEventsCounter"]&&(e.dispatch("cabinetFilters/injectEventsOptions",Ce.data.data.events),e.commit("auth/setPreloadedEvents",Ce.data.data.events),G.value=Ce.data.data.count,e.commit("eventEntities/setEvents",Ce.data.data.events),D.value=jc(Ce.data.data.events,e.getters["cabinet/getTimeZone"],e))}).catch(Ce=>{Ce?.response?.data?.data?.reauthorize!==void 0&&Ce.response.data.data.reauthorize&&e.dispatch("auth/logout"),console.log(Ce)}).finally(()=>{Me===e.getters["auth/getLoadingEventsCounter"]&&e.commit("cabinet/setEventsLoading",!1)})}function te(J){e.commit("cabinet/setEventsLoading",!0),Ne.get("/events/"+J.id,Object.assign({params:{source:"cabinet-"+T.value,timeZone:e.getters["cabinet/getTimeZone"]}},ze(e))).then(ve=>{e.commit("event/setEvent",jb(e,ve.data.data.event)),oe.value=!0}).catch(ve=>{console.log(ve)}).finally(()=>{e.commit("cabinet/setEventsLoading",!1)})}let oe=F(!1),ie=F(!1),K=F(!1),me=F(!1),Ae=F(!1),Ve=F(null);function Q(J){e.commit("cabinet/setEventsLoading",!0),oe.value=!1,setTimeout(()=>{e.commit("event/setEvent",J),oe.value=!0,e.commit("cabinet/setEventsLoading",!1)},500)}function _e(){b.value=!0,S.value=N.value.event_saved,s.value&&E.value&&setTimeout(function(){dt(s.value,E.value.$el,0,300)},500),ne(),ye()}function X(){pe(),oe.value=!0}function M(J){Ve.value=J,xe(fs(e,e.getters["attendee/getDefaultAttendee"],J)),K.value=!0}function Z(){ne(se.value),W()}function W(){K.value=!1,me.value=!1}function le(J){Ve.value=J,ie.value=!0}function de(){Ve.value=null,ne(se.value),xe(fs(e,e.getters["attendee/getDefaultAttendee"])),ie.value=!1,Ae.value=!1}function ae(J){Ae.value=J}function xe(J={}){e.commit("attendee/setAttendee",J)}function ye(){oe.value=!1,pe()}function pe(){e.commit("event/setEvent",{bookings:[],settings:ys(r,e.getters["event/getSettings"],{},{})})}let Te=F(!1);function Pe(){Te.value=!0,Ne.post("/bookings/cancel/"+z.value.id,{type:"event",source:"cabinet-"+T.value},Object.assign(ze(e),{params:{source:"cabinet-"+T.value}})).then(()=>{z.value=null,ne(),b.value=!0,S.value=N.value.event_canceled,s.value&&E.value&&setTimeout(function(){dt(s.value,E.value.$el,0,300)},500)}).catch(J=>{!("data"in J.response.data)&&"message"in J.response.data&&(b.value=!0,S.value=J.response.data.message,s.value&&E.value&&setTimeout(function(){dt(s.value,E.value.$el,0,300)},500))}).finally(()=>{Te.value=!1})}rt(()=>a.loadBookingsCounter,()=>{ne()}),Je(()=>{ne()});function Oe(J){let ve=[],ge=e.getters["entities/getEmployees"];if(J.organizerId&&ge.find(Me=>Me.id===J.organizerId)){let Me={...ge.find(Ce=>Ce.id===J.organizerId),rank:"organizer"};if(!J.providers.length)return Me;ve.push(Me)}return J.providers.length&&J.providers.forEach(Me=>{Me.id!==J.organizerId&&ge.find(Ce=>Ce.id===Me.id)&&ve.push(ge.find(Ce=>Ce.id===Me.id))}),ve}function Re(J){if(J){if(J===1)return{class:"am-no-show-1",icon:"no-show-1"};if(J===2)return{class:"am-no-show-2",icon:"no-show-2"};if(J>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}Be("noShowData",{noShowData:Re});let ke=R("amColors"),Ue=_(()=>({"--am-c-cape-bgr":ke.value.colorMainBgr,"--am-c-cape-text":ke.value.colorMainText,"--am-c-cape-text-op70":H(ke.value.colorMainText,.7),"--am-c-cape-text-op25":H(ke.value.colorMainText,.25),"--am-c-cape-primary":ke.value.colorPrimary,"--am-c-cust-no1":ke.value.colorMainText,"--am-c-cust-no1-bgr":H(ke.value.colorMainText,.1),"--am-c-cust-no2":ke.value.colorWarning,"--am-c-cust-no2-bgr":H(ke.value.colorWarning,.1),"--am-c-cust-no3":ke.value.colorError,"--am-c-cust-no3-bgr":H(ke.value.colorError,.1),"--am-c-cust-text":ke.value.colorMainText,"--am-c-cust-link":H(ke.value.colorMainText,.5)}));return(J,ve)=>(c(),y("div",{ref_key:"pageContainer",ref:s,class:q(["am-cap am-cape-main",{"am-capei-main":t(oe)||t(K)||t(Ae)}]),style:be(t(Ue))},[m("div",{class:q(["am-cape-main__inner",t(i)])},[t(b)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:E,type:t(A),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:P,onTriggerClose:P},{title:x(()=>[aC,ce(" "+C(t(S)),1)]),_:1},8,["type"])):O("",!0),!t(K)&&!t(oe)&&!t(ie)&&t(L)?(c(),U($i,{key:1,"step-key":"events",empty:t(B),"responsive-class":t(i),onChangeFilters:ne},null,8,["empty","responsive-class"])):O("",!0),t(f).cabinetType==="employee"&&t(r).roles.allowWriteEvents&&!t(K)&&!t(oe)&&!t(ie)&&t(L)?(c(),y("div",sC,[$(Se,{icon:t(o),prefix:"plus",size:"small",category:"primary",type:t(d).events.options.newEvtBtn.buttonType,onClick:X},{default:x(()=>[m("span",null,C(t(N).new_event),1)]),_:1},8,["icon","type"])])):O("",!0),!t(w)&&t(L)?(c(),y(ee,{key:3},[!t(K)&&!t(oe)&&!t(ie)&&t(D)&&Object.keys(t(D)).length>0?(c(),y("div",{key:0,class:q(["am-cape__wrapper",[{"am-no-border":t(D)&&Object.keys(t(D)).length===1},t(i)]])},[(c(!0),y(ee,null,fe(t(D),(ge,Me)=>(c(),y("div",{key:Me,class:"am-cape"},[m("div",{class:q(["am-cape__date",[{"am-today":t(nt)(Me)===t(nt)(t(he)().format("YYYY-MM-DD"))},{"am-no-flag":t(D)&&Object.keys(t(D)).length===1},t(i)]])},C(t(nt)(Me)),3),(c(!0),y(ee,null,fe(ge.events,(Ce,ba)=>(c(),U(kr,{key:ba,start:t(vs)(Ce.periods[0].periodStart.split(" ")[1].slice(0,5)),name:Ce.name,employee:Oe(Ce),customers:Ce.bookings.filter(wt=>wt.status!=="rejected"&&wt.status!=="canceled").map(wt=>wt.customer),price:t(Po)(Ce),duration:null,periods:(J.periods=t(Yc)(Ce.periods))?J.periods:[],extras:[],tickets:t(Wc)(Ce),"custom-fields":t(_r)(Ce.bookings,t(f).cabinetType),location:t(Hc)(t(e),Ce),"google-meet-link":Ce.periods.length===1&&Ce.periods[0].googleMeetUrl?Ce.periods[0].googleMeetUrl:"","microsoft-teams-link":Ce.periods.length===1&&Ce.periods[0].microsoftTeamsUrl?Ce.periods[0].microsoftTeamsUrl:"","zoom-link":Ce.periods.length===1&&Ce.periods[0].zoomMeeting?Ce.periods[0].zoomMeeting.joinUrl:"","lesson-space-link":Ce.periods.length===1&&Ce.periods[0].lessonSpace?Ce.periods[0].lessonSpace:"",bookable:Ce,reservation:Ce,booking:Ce.bookings[0],"responsive-class":t(i),"parent-width":t(l),"customized-options":I("events"),onEditEvent:te,onAddEventAttendee:M,onListEventAttendees:le,onCancelBooking:ve[0]||(ve[0]=wt=>{we(z)?z.value=wt:z=wt})},null,8,["start","name","employee","customers","price","periods","tickets","custom-fields","location","google-meet-link","microsoft-teams-link","zoom-link","lesson-space-link","bookable","reservation","booking","responsive-class","parent-width","customized-options"]))),128))]))),128))],2)):O("",!0),!t(K)&&!t(oe)&&!t(ie)&&(t(D)===null||Object.keys(t(D)).length===0)?(c(),U(Ia,{key:1,heading:t(N).no_evt_found,text:t(N).have_no_evt},null,8,["heading","text"])):O("",!0),!t(K)&&!t(oe)&&!t(ie)&&t(D)&&Object.keys(t(D)).length>0&&t(G)>t(r).general.itemsPerPageBackEnd?(c(),U(Al,{key:2,"page-size":t(r).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:t(G),"current-page":t(se),onCurrentChange:j},null,8,["page-size","total","current-page"])):O("",!0),t(oe)?(c(),U(M0,{key:3,"page-width":t(l),"responsive-class":t(i),onClose:ye,onSave:_e,onDuplicate:Q},null,8,["page-width","responsive-class"])):O("",!0),!t(K)&&t(ie)?(c(),U(tC,{key:4,event:t(Ve),"page-width":t(l),"responsive-class":t(i),onClose:de,onOpenAttendee:ae},null,8,["event","page-width","responsive-class"])):O("",!0),t(K)?(c(),U(Pr,{key:5,visibility:t(K),title:t(me)?t(N).event_edit_attendee:t(N).event_add_attendee,event:t(Ve),"page-width":t(l),"is-new":!t(me),onSave:Z,onClose:W},null,8,["visibility","title","event","page-width","is-new"])):O("",!0),t(u)==="capc"?(c(),U(Ua,{key:6,visibility:t(z)!==null,title:h("cancelEvent").cancel_event,description:h("cancelEvent").confirm_cancel_event,"close-btn-text":h("cancelEvent").close,"confirm-btn-text":h("cancelEvent").confirm,"customized-options":I("cancelEvent"),loading:t(Te),onClose:ve[1]||(ve[1]=ge=>we(z)?z.value=null:z=null),onDecline:ve[2]||(ve[2]=ge=>we(z)?z.value=null:z=null),onConfirm:Pe},null,8,["visibility","title","description","close-btn-text","confirm-btn-text","customized-options","loading"])):O("",!0)],64)):(c(),U(Pi,{key:4}))],2)],6))}});const iC={class:"am-sc__top-left"},oC={class:"am-sc__name"},rC={key:0,class:"am-sc__date"},cC={key:1,class:"am-sc__date"},uC=["onClick"],dC={class:"am-sc__capacity"},mC=m("div",{class:"am-sc__btn"},[m("span",{class:"am-icon-arrow-right"})],-1),pC={key:0,class:"am-sc__bottom"},gC={class:"am-sc__expiration"},fC=m("span",{class:"am-icon-triangle-info"},null,-1),hC={name:"CabinetPackagesList"},vC=Object.assign(hC,{props:{packages:{type:[Object,Array],default:()=>{}},responsiveClass:{type:String,default:""}},emits:["click"],setup(n,{emit:a}){const e=n;function s(b){return he(b,"YYYY-MM-DD").diff(he(),"days")}function l(b){a("click",b)}function i(b,A,S){let P=0;return Object.keys(b).forEach(h=>{(A===null||parseInt(A)===parseInt(h))&&(P+=b[h].purchaseData[S])}),P}function o(b){return b===1?k.value.appointment_booked:k.value.appointments_booked}function r(b){let A=b.packageData.sharedCapacity?b.packageData.sharedCount:i(b.services,null,"count"),S=b.packageData.sharedCapacity?b.packageData.sharedTotal:i(b.services,null,"total");return`${S-A}/${S} ${o(S-A)}`}const u=R("settings");let d=R("amCustomize");const f=R("labels"),v=R("localLanguage");let g=_(()=>u.general.usedLanguages.includes(v.value)),k=_(()=>{let b=Qe({...f}),A=d.value.packagesList.translations;return A&&Object.keys(A).forEach(S=>{A[S][v.value]&&g.value?b[S]=A[S][v.value]:A[S].default&&(b[S]=A[S].default)}),b}),N=R("amColors"),E=_(()=>({"--am-c-sc-bgr":N.value.colorMainBgr,"--am-c-sc-bgr-op15":H(N.value.colorMainText,.15),"--am-c-sc-text":N.value.colorMainText,"--am-c-sc-text-op80":H(N.value.colorMainText,.8),"--am-c-sc-text-op60":H(N.value.colorMainText,.6),"--am-c-sc-warning-op50":H(N.value.colorWarning,.5)}));return(b,A)=>t(e).packages.length?(c(!0),y(ee,{key:0},fe(t(e).packages,S=>(c(),y("div",{key:S[0],style:be(t(E)),class:q(["am-sc",{"am-sc__canceled":S[1].packageData.status==="canceled"}])},[m("div",{class:q(["am-sc__top",n.responsiveClass])},[m("div",iC,[m("div",oC,C(S[1].packageData.name),1),S[1].packageData.end?(c(),y("div",rC,C(t(k).package_book_expire)+" "+C(t(nt)(S[1].packageData.end.split(" ")[0])),1)):(c(),y("div",cC,C(`${t(k).package_book_expiration} ${t(k).package_book_unlimited}`),1))]),m("div",{class:q(["am-sc__top-right",n.responsiveClass]),onClick:P=>l(S[0])},[m("div",dC,C(r(S[1])),1),mC],10,uC)],2),S[1].packageData.end&&S[1].packageData.status!=="canceled"?(c(),y(ee,{key:0},[s(S[1].packageData.end.split(" ")[0])>0?(c(),y("div",pC,[m("span",gC,[fC,ce(" "+C(`${t(k).package_deal_expire_in} ${s(S[1].packageData.end.split(" ")[0])} ${t(k).expires_days}, ${t(k).appointments_deal_expire}`),1)])])):O("",!0)],64)):O("",!0)],6))),128)):(c(),U(Ia,{key:1,heading:t(k).no_pack_found,text:t(k).have_no_pack},null,8,["heading","text"]))}});const _C=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),yC={class:"am-cappa__back"},bC={class:"am-cappa__heading-left"},kC={key:0,class:"am-cappa__img-name"},CC={class:"am-cappa__info"},xC={class:"am-cappa__name"},wC={key:0,class:"am-cappa__date"},TC={key:1,class:"am-cappa__date"},SC={key:2,class:"am-cappa__capacity"},EC={class:"am-cappa__service-heading"},LC={class:"am-cappa__service-right"},AC={key:0,class:"am-cappa__service-img__name"},IC={class:"am-cappa__service-info"},$C={class:"am-cappa__service-name"},PC={key:0,class:"am-cappa__service-capacity"},DC={name:"CabinetPackageAppointmentsList",key:"packagesList"},NC=Object.assign(DC,{props:{data:{type:[Object,Array],default:()=>{}},responsiveClass:{type:String,default:""},pageWidth:{type:Number}},emits:["goBack","booked","canceled","cancelError"],setup(n,{emit:a}){const e=n;let s=De(),l=_(()=>s.getters.getSettings),i={components:{IconComponent:We},template:'<IconComponent icon="arrow-left"></IconComponent>'},{selectedPackageCustomerId:o}=R("packageSelection"),r=_(()=>s.getters["entities/getPackage"](e.data.packageData.id)),u=_(()=>r.value.bookable.filter(M=>e.data.services[M.service.id]).map(M=>M.service.id.toString())),d=_(()=>r.value.bookable.find(M=>parseInt(M.service.id)===parseInt(b.value))),f=F(null),v=F(null),g=_(()=>{let M=s.getters["entities/getEntitiesRelations"],Z=s.getters["entities/getUnfilteredEmployees"],W=[];if(d.value){if(v.value)Object.keys(M).forEach(de=>{A.value&&A.value.serviceId in M[de]&&M[de][parseInt(A.value.serviceId)].indexOf(v.value)!==-1&&W.push(parseInt(de))});else{let de=[];if(d.value.locations.length)de=d.value.locations.map(ae=>ae.id);else for(let ae in M)d.value.service.id in M[ae]&&(de=de.concat(M[ae][d.value.service.id]));for(let ae in M)d.value.service.id in M[ae]&&de.forEach(xe=>{M[ae][d.value.service.id].indexOf(xe)!==-1&&W.push(parseInt(ae))})}let le=d.value.providers.length?d.value.providers.map(de=>de.id):Z.map(de=>de.id);return Z.filter(de=>le.indexOf(de.id)!==-1&&W.indexOf(de.id)!==-1&&(s.getters["entities/getShowHidden"]||de.status==="visible"&&de.show))}return[]}),k=_(()=>{let M=s.getters["entities/getEntitiesRelations"],Z=s.getters["entities/getUnfilteredLocations"],W=[];if(d.value){if(f.value)W=M[f.value][d.value.service.id];else{let de=[];if(d.value.providers.length)de=d.value.providers.map(ae=>ae.id);else for(let ae in M)d.value.service.id in M[ae]&&de.push(parseInt(ae));for(let ae in M)d.value.service.id in M[ae]&&de.indexOf(parseInt(ae))!==-1&&(W=W.concat(M[ae][d.value.service.id]))}let le=d.value.locations.length?d.value.locations.map(de=>de.id):Z.map(de=>de.id);return Z.filter(de=>le.indexOf(de.id)!==-1&&W.indexOf(de.id)!==-1&&(s.getters["entities/getShowHidden"]||de.status==="visible"))}return[]}),N=_(()=>{let M=[];return Object.keys(e.data.services).forEach(Z=>{Object.keys(e.data.services[Z].appointments).forEach(W=>{e.data.services[Z].appointments[W].appointments.forEach(le=>{M.push(le)})})}),{type:"package",package:r.value,booking:null,bookable:r.value,paymentId:e.data.packageData.payments.length?e.data.packageData.payments[0].id:null,customer:s.getters["auth/getProfile"],packageCustomerId:parseInt(o.value),packageReservations:M,payments:e.data.packageData.payments,price:e.data.packageData.price,tax:e.data.packageData.tax,coupon:e.data.packageData.coupon,discount:e.data.packageData.discount,end:e.data.packageData.end}}),E=F(!1),b=F(null),A=F(null),S=F(null);Je(()=>{b.value=u.value[0]});function P(M,Z,W){let le=0;return Object.keys(M).forEach(de=>{(Z===null||parseInt(Z)===parseInt(de))&&(le+=M[de].purchaseData[W])}),le}function h(M){return M===1?oe.value.appointment_booked:oe.value.appointments_booked}function I(M,Z=null){let W=M.packageData.sharedCapacity?M.packageData.sharedCount:P(M.services,Z,"count"),le=M.packageData.sharedCapacity?M.packageData.sharedTotal:P(M.services,Z,"total");return`${le-W}/${le} ${h(le-W)}`}function L(M){b.value=M.paneName}function T(){let M=s.getters["auth/getProfile"],Z=s.getters["cabinet/getTimeZone"]?s.getters["cabinet/getTimeZone"]:"UTC",W={serviceId:parseInt(b.value),group:1,timeZone:s.getters["cabinet/getTimeZone"],structured:!0,page:"cabinet"},le=r.value.bookable.find(de=>parseInt(de.service.id)===parseInt(b.value)).providers.map(de=>de.id);le.length&&(W.providerIds=le),W.locationId=null,S.value=W,A.value={type:"appointment",bookings:[{packageCustomerService:{id:e.data.services[b.value].purchaseData.packageCustomerServiceId},customer:{id:M.id,firstName:M.firstName,lastName:M.lastName,email:M.email,phone:M.phone,countryPhoneIso:M.countryPhoneIso,externalId:M.externalId},customerId:M.id,customFields:null,persons:1,extras:[],deposit:0}],serviceId:b.value,locationId:e.data.services[b.value].purchaseData.locitionId,providerId:e.data.services[b.value].purchaseData.employeeId,isGroup:!0,notifyParticipants:l.value.notifications.notifyCustomers?1:0,payment:null,recurring:[],package:[],timeZone:Z===""?Intl.DateTimeFormat().resolvedOptions().timeZone:Z,utc:Z==="",locale:window.localeLanguage[0]}}function w(M){A.value=null,a("booked",M)}let B=F(!1);function z(){B.value=!0,Ne.post("/packages/customers/"+parseInt(o.value),{status:"canceled"},ze(s)).then(()=>{E.value=!1,a("canceled",{message:oe.value.package_purchase_canceled})}).catch(M=>{M.response&&a("cancelError",M.response.data)}).finally(()=>{B.value=!1})}function D(M){a("booked",M)}function G(){a("goBack")}let se=R("amCustomize");const j=R("labels"),ne=R("localLanguage");let te=_(()=>l.value.general.usedLanguages.includes(ne.value)),oe=_(()=>{let M=Qe({...j}),Z=se.value.packageAppointmentsList.translations;return Z&&Object.keys(Z).forEach(W=>{Z[W][ne.value]&&te.value?M[W]=Z[W][ne.value]:Z[W].default&&(M[W]=Z[W].default)}),M});Be("amLabels",oe);let ie=_(()=>s.getters["cabinet/getPaymentLinkError"].package),K=F("error"),me=F(oe.value.payment_link_error);function Ae(){ie.value=!1,s.commit("cabinet/setPaymentLinkError",{value:!1,type:"package"})}function Ve(M){let Z=Qe({...j}),W=se.value[M].translations;return W&&Object.keys(W).forEach(le=>{W[le][ne.value]&&te.value?Z[le]=W[le][ne.value]:W[le].default&&(Z[le]=W[le].default)}),Z}function Q(M){return se.value[M].options}let _e=R("amColors"),X=_(()=>({"--am-c-cappa-text":_e.value.colorMainText,"--am-c-cappa-bgr":_e.value.colorMainBgr,"--am-c-cappa-text-op80":H(_e.value.colorMainText,.8),"--am-c-cappa-text-op70":H(_e.value.colorMainText,.7),"--am-c-cappa-text-op20":H(_e.value.colorMainText,.2),"--am-c-cappa-primary":_e.value.colorPrimary}));return(M,Z)=>{const W=va,le=_a;return c(),y("div",{class:"am-cappa",style:be(t(X))},[t(ie)?(c(),U(_t,{key:0,ref:"alertContainer",type:t(K),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:Ae,onTriggerClose:Ae},{title:x(()=>[_C,ce(" "+C(t(me)),1)]),_:1},8,["type"])):O("",!0),m("div",yC,[$(Se,{"custom-class":"am-cappa__back-btn",icon:t(i),type:t(se).packageAppointmentsList.options.backBtn.buttonType,size:"micro",category:"secondary","icon-only":"","aria-label":t(oe).back_btn,onClick:G},null,8,["icon","type","aria-label"]),m("span",null,C(t(oe).back_btn),1)]),m("div",{class:q(["am-cappa__heading",n.responsiveClass])},[m("div",bC,[m("div",{class:"am-cappa__img",style:be(t(e).data.packageData.pictureThumbPath?{backgroundImage:`url(${t(e).data.packageData.pictureThumbPath})`}:{})},[t(e).data.packageData.pictureThumbPath?O("",!0):(c(),y("span",kC,C(t(Bi)(t(e).data.packageData.name)),1)),m("span",{class:"am-cappa__img-color",style:be({backgroundColor:t(e).data.packageData.color})},null,4)],4),m("div",CC,[m("div",xC,C(t(e).data.packageData.name),1),t(e).data.packageData.end?(c(),y("div",wC,C(t(oe).package_book_expire)+" "+C(t(nt)(t(e).data.packageData.end.split(" ")[0])),1)):(c(),y("div",TC,C(`${t(oe).package_book_expiration} ${t(oe).package_book_unlimited}`),1)),Object.keys(t(e).data.services).length>1?(c(),y("div",SC,C(I(t(e).data)),1)):O("",!0)])]),m("div",{class:q(["am-cappa__heading-right",n.responsiveClass])},[t(l).roles.allowCustomerCancelPackages&&t(e).data.packageData.status!=="canceled"?(c(),U(Se,{key:0,category:"danger",size:"small",class:q(["am-cappa__actions",n.responsiveClass]),type:t(se).packageAppointmentsList.options.cancelBtn.buttonType,onClick:Z[0]||(Z[0]=()=>{we(E)?E.value=!0:E=!0})},{default:x(()=>[ce(C(t(oe).cancel),1)]),_:1},8,["class","type"])):O("",!0),t(e).data.packageData.status==="approved"&&t(e).data.packageData.price>0?(c(),U(yr,{key:1,"btn-size":"small",class:q(`am-cappa__actions ${n.responsiveClass}`),type:t(se).packageAppointmentsList.options.payBtn.buttonType,reservation:t(N),bookable:t(r)},null,8,["class","type","reservation","bookable"])):O("",!0)],2)],2),$(le,{modelValue:t(b),"onUpdate:modelValue":Z[1]||(Z[1]=de=>we(b)?b.value=de:b=de),class:"am-cappa__service",onTabClick:L},{default:x(()=>[(c(!0),y(ee,null,fe(t(u),de=>(c(),U(W,{key:de,name:de},{label:x(()=>[m("div",EC,C(t(e).data.services[de].purchaseData.name),1)]),default:x(()=>[t(b)===de?(c(),y(ee,{key:0},[m("div",{class:q(["am-cappa__service-top",n.responsiveClass])},[m("div",LC,[m("div",{class:"am-cappa__service-img",style:be(t(e).data.services[t(b)].purchaseData.pictureThumbPath?{backgroundImage:`url(${t(e).data.services[t(b)].purchaseData.pictureThumbPath})`}:{})},[t(e).data.services[t(b)].purchaseData.pictureThumbPath?O("",!0):(c(),y("span",AC,C(t(Bi)(t(e).data.services[t(b)].purchaseData.name)),1)),m("span",{class:"am-cappa__service-img__color",style:be({backgroundColor:t(e).data.services[t(b)].purchaseData.color})},null,4)],4),m("div",IC,[m("div",$C,C(t(e).data.services[t(b)].purchaseData.name),1),t(e).data.packageData.sharedCapacity?O("",!0):(c(),y("div",PC,C(I(t(e).data,t(b))),1))])]),t(e).data.packageData.status!=="canceled"?(c(),U(Se,{key:0,class:q(["am-cappa__service-book",n.responsiveClass]),size:"small",type:t(se).packageAppointmentsList.options.bookBtn.buttonType,disabled:P(t(e).data.services,t(b),"count")===0,onClick:T},{default:x(()=>[ce(C(t(oe).book_now),1)]),_:1},8,["class","type","disabled"])):O("",!0)],2),$(xr,{"grouped-appointments":t(e).data.services[t(b)].appointments,"page-width":n.pageWidth,"responsive-class":n.responsiveClass,"is-package-booking":!0,"step-key":"packageAppointmentsList",onCanceled:D,onBooked:D},null,8,["grouped-appointments","page-width","responsive-class"])],64)):O("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),$(Ua,{loading:t(B),visibility:t(E),title:Ve("cancelPackage").cancel_package,description:Ve("cancelPackage").confirm_cancel_package,"close-btn-text":Ve("cancelPackage").close,"confirm-btn-text":Ve("cancelPackage").confirm,"customized-options":Q("cancelPackage"),onClose:Z[2]||(Z[2]=()=>{we(E)?E.value=!1:E=!1}),onDecline:Z[3]||(Z[3]=()=>{we(E)?E.value=!1:E=!1}),onConfirm:z},null,8,["loading","visibility","title","description","close-btn-text","confirm-btn-text","customized-options"]),$(Cr,{visibility:t(A)!==null&&!t(A).id,appointment:t(A),employees:t(g),locations:t(k),"slots-params":t(S),labels:Ve("bookAppointment"),"customized-options":Q("bookAppointment"),onClose:Z[4]||(Z[4]=de=>we(A)?A.value=null:A=null),onSuccess:w,onError:Z[5]||(Z[5]=()=>{}),onEmployeeSelection:Z[6]||(Z[6]=de=>we(f)?f.value=de:f=de),onLocationSelection:Z[7]||(Z[7]=de=>we(v)?v.value=de:v=de)},null,8,["visibility","appointment","employees","locations","slots-params","labels","customized-options"])],4)}}});const OC=m("span",{class:"am-icon-checkmark-circle-full"},null,-1),MC={name:"CabinetPackages",key:"packages"},FC=Object.assign(MC,{props:{loadBookingsCounter:{type:Number,default:0}},setup(n){const a=n;let e=De(),s=F(null),l=F(0),i=R("sidebarCollapsed");window.addEventListener("resize",o);function o(){s.value&&(l.value=s.value.offsetWidth)}rt(i,G=>{G?setTimeout(()=>{r()},1500):setTimeout(()=>{r()},500)});function r(){l.value=s.value.offsetWidth}Je(()=>{ri(()=>{l.value=s.value.offsetWidth})});let u=_(()=>st(l.value)),d=F(null),f=F(!1),v=F("success"),g=F("");function k(){f.value=!1,g.value=""}let N=R("cabinetType");e.commit("cabinetFilters/setDates",mi(N.value));let E=_(()=>e.getters["cabinet/getPackageLoading"]),b=F([]),A=F(null);function S(){let G=e.getters["cabinetFilters/getPackages"],se=e.getters["cabinetFilters/getServices"],j=e.getters["cabinetFilters/getProviders"],ne=e.getters["cabinetFilters/getLocations"];b.value=T.value.filter(te=>{let oe=e.getters["entities/getPackageEntities"](te[1].packageData.id);return(se.length===0||se.filter(ie=>oe.services.includes(ie)).length>0)&&(j.length===0||j.filter(ie=>oe.providers.includes(ie)).length>0)&&(ne.length===0||ne.filter(ie=>oe.locations.includes(ie)).length>0)&&(G.length===0||G.filter(ie=>oe.packages.includes(ie)).length>0)})}function P(G,se,j){let ne=0;return Object.keys(G).forEach(te=>{(se===null||parseInt(se)===parseInt(te))&&(ne+=G[te].purchaseData[j])}),ne}function h(G){let se=P(G.services,null,"count"),j=P(G.services,null,"total");return j-se===j}function I(G){e.commit("cabinet/setPackageLoading",!0);let se=e.getters["cabinet/getTimeZone"],j=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getPackagesFilters"]));j.timeZone=se,j.source="cabinet-"+N.value,j.activePackages=0,Ne.get("/appointments",Js(Object.assign(ze(e),{params:j}))).then(ne=>{let te={};ne.data.data.availablePackageBookings.forEach(Q=>{Q.packages.forEach(_e=>{_e.services.forEach(X=>{X.bookings.forEach(M=>{let Z=e.getters["entities/getPackage"](_e.packageId);if(Z&&(M.packageCustomerId in te||(te[M.packageCustomerId]={packageData:{id:Z.id,name:Z.name,start:M.start,end:M.end,price:M.price,tax:M.tax,coupon:M.coupon,status:M.status,type:"package",payments:M.payments,sharedCapacity:M.sharedCapacity,sharedTotal:M.total,sharedCount:M.count,discount:0,color:Z.color,pictureFullPath:Z.pictureFullPath,pictureThumbPath:Z.pictureThumbPath},services:{}}),!(X.serviceId in te[M.packageCustomerId].services))){let W=e.getters["entities/getService"](X.serviceId);te[M.packageCustomerId].services[X.serviceId]={appointments:{},purchaseData:{packageCustomerServiceId:M.id,total:M.total,count:M.count,employeeId:M.employeeId,locationId:M.locationId,name:W.name,color:W.color,pictureThumbPath:W.pictureThumbPath}}}})})})});let oe=vr(ne.data.data.appointments,se,N.value==="provider");Object.keys(oe).forEach(Q=>{oe[Q].appointments.forEach(_e=>{_e.bookings.forEach(X=>{let M=X.packageCustomerService.packageCustomer.id;M in te&&(Q in te[M].services[_e.serviceId].appointments||(te[M].services[_e.serviceId].appointments[Q]={date:Q,appointments:[]}),te[M].services[_e.serviceId].appointments[Q].appointments.push(_e))})})});let ie=Object.entries(te).filter(Q=>Q[1].packageData.status==="canceled"),K=Object.entries(te).filter(Q=>Q[1].packageData.status!=="canceled"&&h(Q[1])),me=Object.entries(te).filter(Q=>Q[1].packageData.status!=="canceled"&&!h(Q[1])&&Q[1].packageData.end===null),Ae=Object.entries(te).filter(Q=>Q[1].packageData.status!=="canceled"&&!h(Q[1])&&Q[1].packageData.end!==null).sort((Q,_e)=>he(Q[1].packageData.end,"YYYY-MM-DD HH:mm:ss").diff(he(_e[1].packageData.end,"YYYY-MM-DD HH:mm:ss"),"minutes"));if(b.value=[...Ae,...me,...K,...ie],T.value=[...Ae,...me,...K,...ie],!(j.packages.length||j.services.length||j.providers.length||j.locations.length)){let Q=[],_e=[],X=[],M=[];b.value.forEach(Z=>{let W=e.getters["entities/getPackageEntities"](Z[1].packageData.id);Q=Q.concat(W.services),_e=_e.concat(W.providers),X=X.concat(W.locations),M=M.concat(W.packages)}),e.dispatch("cabinetFilters/injectServiceOptions",Q.filter((Z,W,le)=>le.indexOf(Z)===W)),e.dispatch("cabinetFilters/injectProviderOptions",_e.filter((Z,W,le)=>le.indexOf(Z)===W)),e.dispatch("cabinetFilters/injectLocationOptions",X.filter((Z,W,le)=>le.indexOf(Z)===W)),e.dispatch("cabinetFilters/injectPackagesOptions",M.filter((Z,W,le)=>le.indexOf(Z)===W))}}).catch(ne=>{console.log(ne)}).finally(()=>{e.commit("cabinet/setPackageLoading",!1),G&&"message"in G&&(f.value=!0,g.value=G.message,s.value&&d.value&&setTimeout(function(){dt(s.value,d.value.$el,0,300)},500))})}function L(G){f.value=!0,g.value=G.message,v.value="error",s.value&&d.value&&setTimeout(function(){dt(s.value,d.value.$el,0,300)},500)}Be("packageSelection",{selectedPackageCustomerId:A});let T=F([]);rt(()=>a.loadBookingsCounter,()=>{I()}),Je(()=>{I()});let w=_(()=>({list:{template:Ge(vC),props:{packages:b.value,responsiveClass:u.value},handlers:{click:z}},item:{template:Ge(NC),props:{data:A.value?b.value.find(G=>G[0]===A.value)[1]:{},responsiveClass:u.value,pageWidth:l.value},handlers:{goBack:D,booked:I,canceled:I,cancelError:L}}})),B=F("list");function z(G){A.value=G,B.value="item"}function D(){A.value=null,B.value="list"}return(G,se)=>(c(),y("div",{ref_key:"pageContainer",ref:s,class:"am-cap"},[t(f)?(c(),U(_t,{key:0,ref_key:"alertContainer",ref:d,type:t(v),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:k,onTriggerClose:k},{title:x(()=>[OC,ce(" "+C(t(g)),1)]),_:1},8,["type"])):O("",!0),zt($($i,{"step-key":"packages","responsive-class":t(u),onChangeFilters:S},null,8,["responsive-class"]),[[Lo,t(B)==="list"]]),t(E)?(c(),U(Pi,{key:2})):(c(),U(pt(t(w)[t(B)].template),Lt({key:1},t(w)[t(B)].props,ui(t(w)[t(B)].handlers)),null,16))],512))}});const VC=m("link",{rel:"preconnect",href:"https://fonts.googleapis.com"},null,-1),BC=m("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},null,-1),RC=["href"],qC={class:"am-fs-sb__page-wrapper am-fs-sb__page-wrapper__cabinet"},UC=["onClick"],zC={class:"am-fs-sb__page-icon"},jC={key:1,class:"am-fs-sb__page-divider"},YC={class:"am-fs-sb__page-inner"},WC=m("div",{class:"am-fs-sb__page-icon"},[m("span",{class:"am-icon-dashboard"})],-1),HC=m("div",{class:"am-fs-sb__page-divider"},null,-1),ZC={class:"am-fs-sb__page-inner"},GC=m("div",{class:"am-fs-sb__page-icon"},[m("span",{class:"am-icon-logout"})],-1),JC={class:"am-caph"},XC={class:"am-caph__text"},QC=m("span",{class:"am-icon-menu"},null,-1),KC=[QC],ex={name:"CustomerPanel"},tx=Object.assign(ex,{setup(n){const a=Ol().cookies,e=De();let s=_(()=>e.getters.getIsRtl);const l=R("shortcodeData");let i=_(()=>e.getters["auth/getAuthenticated"]);rt(i,ae=>{ae&&(e.commit("auth/setNewPassword",""),e.commit("auth/setConfirmPassword",""))});let o=F(l.value.cabinetType==="employee"?"provider":"customer");Be("cabinetType",o);let r=R("licence"),u=_(()=>o.value==="provider"?"cape":"capc");Be("originKey",u);let d=F(null),{width:f}=ja(d);Be("containerWidth",f);const v=R("settings");let g=F(l.value.appointments||!l.value.events?"appointments":"events");const k=_(()=>v.customizedData&&u.value in v.customizedData?v.customizedData[u.value]:El[u.value]);Be("amCustomize",k);const N=F(v.customizedData?v.customizedData.fonts:El.fonts);Be("amFonts",N);const E=R("labels");Be("amLabels",E);const b=R("localLanguage");let A=_(()=>v.general.usedLanguages.includes(b.value)),S=_(()=>{let ae=Qe({...E});return v.customizedData&&Object.keys(k.value).forEach(xe=>{if(xe!=="colors"&&k.value[xe].translations){let ye=k.value[xe].translations;Object.keys(ye).forEach(pe=>{ye[pe][b.value]&&A.value?ae[pe]=ye[pe][b.value]:ye[pe].default&&(ae[pe]=ye[pe].default)})}}),ae});function P(){let ae=document.head||document.getElementsByTagName("head")[0];ae.querySelector("#amCustomFont")&&ae.querySelector("#amCustomFont").remove();let xe="@font-face {font-family: 'comic'; src: url(http://localhost/amelia-test/wp-content/uploads/amelia/fonts/comic.woff);}",ye=document.createElement("style");ae.appendChild(ye),ye.setAttribute("type","text/css"),ye.setAttribute("id","amCustomFont"),ye.appendChild(document.createTextNode(xe))}N.value.customFontSelected&&P();let h=_(()=>g.value==="packages"?k.value.packagesList.options:k.value[g.value].options),I=_(()=>{let ae=g.value;return o.value==="customer"?ae!=="profile"?h.value.timeZone.visibility:!0:ae==="appointments"||ae==="events"?h.value.timeZone.visibility:!0}),L=F(!1),T=F(!1);Be("sidebarCollapsed",nc(T));let w=F("");rt(T,ae=>{ae?setTimeout(()=>{w.value="am-collapsed"},1e3):w.value=""});let B=F(null),z=F(0),D=_(()=>f.value>480);Je(()=>{B.value&&setTimeout(()=>{z.value=B.value.offsetHeight},200),setTimeout(()=>{T.value=f.value<=600?!0:k.value.sidebar.options.toggle.visibility},1300)});const G=()=>{f.value<=600?T.value=!0:T.value=k.value.sidebar.options.toggle.visibility};window.addEventListener("resize",G),rt(f,ae=>{L.value=ae>481?!1:L.value});const se=_(()=>e.getters["entities/getReady"]);rt(se,ae=>{if(ae){if(l.value.cabinetType==="employee"&&e.getters["employee/getId"]){let xe=e.getters["employee/getEmployee"];e.commit("employee/setServiceList",xo(e,xe.serviceList)),e.commit("entities/setEmployees",[e.getters["entities/getEmployee"](e.getters["employee/getId"])])}e.dispatch("cabinetFilters/injectServiceOptions",e.getters["entities/getServices"].map(xe=>xe.id)),e.dispatch("cabinetFilters/injectProviderOptions",o.value==="customer"?e.getters["entities/getEmployees"].map(xe=>xe.id):[]),e.dispatch("cabinetFilters/injectLocationOptions",e.getters["entities/getLocations"].map(xe=>xe.id))}});const j=R("baseUrls");let ne=["employees","categories","locations","packages","entitiesRelations","customFields"];l.value.cabinetType==="employee"&&(ne=ne.concat(["taxes","spaces","tags","settings"])),e.dispatch("entities/getEntities",{types:ne,licence:"basic",loadEntities:!0,showHidden:!0,isPanel:!0});let te=_(()=>e.getters.getReady),oe=F({profile:Ge(l.value.cabinetType==="employee"?sh:gd)});(l.value.appointments||!l.value.events)&&(oe.value.appointments=Ge(Ub)),(l.value.events||!l.value.appointments)&&(oe.value.events=Ge(nC)),(l.value.appointments||!l.value.events)&&(r.isPro||r.isDeveloper)&&(oe.value.packages=Ge(FC));const ie=F([{key:"profile",icon:"user",pageLabel:S.value.my_profile,label:_(()=>u.value==="cape"?`${e.getters["auth/getProfile"].firstName} ${e.getters["auth/getProfile"].lastName}`:k.value.profile.options.lastName.visibility?`${e.getters["auth/getProfile"].firstName} ${e.getters["auth/getProfile"].lastName}`:`${e.getters["auth/getProfile"].firstName}`)}]);(l.value.appointments||!l.value.events)&&ie.value.push({key:"appointments",icon:"service",label:S.value.appointments}),(l.value.events||!l.value.appointments)&&ie.value.push({key:"events",icon:"star-outline",label:S.value.events}),l.value.cabinetType==="customer"&&(l.value.appointments||!l.value.events)&&(r.isPro||r.isDeveloper)&&ie.value.push({key:"packages",icon:"shipment",label:S.value.packages}),Be("sidebarSteps",ie),Je(()=>{K.value=ie.value.findIndex(ae=>ae.key===g.value)});let K=F(0);function me(ae,xe){l.value.cabinetType==="employee"&&(ae.key!=="appointments"&&(e.commit("appointment/resetAppointment",{providerId:e.getters["auth/getProfile"].id,categoryId:null,serviceId:null,locationId:null}),e.commit("customerInfo/setCustomers",[]),e.commit("customerInfo/setCustomersIds",[])),ae.key!=="events"&&(e.commit("event/setEvent",{settings:ys(v,e.getters["event/getSettings"],{},{})}),e.commit("attendee/setAttendee",fs(e,e.getters["attendee/getDefaultAttendee"])))),g.value=ae.key,K.value=xe,e.commit("cabinetFilters/setResetFilters")}function Ae(ae){l.value.cabinetType==="employee"&&l.value.profile&&ae.step.key==="profile"||(me(ae.step,ae.index),e.commit("cabinetFilters/setResetFilters"))}function Ve(){e.dispatch("auth/logout")}function Q(){L.value=!1,Ve()}let _e=F(0);function X(){_e.value++}let M=_(()=>{switch(ie.value[K.value].key){case"profile":return ie.value[K.value].pageLabel;case"appointments":return e.getters["appointment/getActive"]&&!e.getters["appointment/getId"]?S.value.new_appointment:e.getters["appointment/getActive"]&&e.getters["appointment/getId"]?S.value.edit_appointment:ie.value[K.value].label;case"events":return e.getters["attendee/getActive"]&&!e.getters["attendee/getId"]?S.value.event_add_attendee:e.getters["attendee/getActive"]&&e.getters["attendee/getId"]?S.value.event_edit_attendee:e.getters["event/getActive"]&&!e.getters["event/getId"]?S.value.new_event:e.getters["event/getActive"]&&e.getters["event/getId"]?S.value.edit_event:ie.value[K.value].label;default:return ie.value[K.value].label}});Be("bookingsCounterChanger",{bookingsCounterChanger:X});const Z=R("timeZone");Zs(()=>{if(!v.general.showClientTimeZone){let ae=Z.value;a.get("ameliaUserTimeZone")&&(ae=a.get("ameliaUserTimeZone")),e.commit("cabinet/setTimeZone",ae)}e.getters["cabinet/getTimeZone"]||e.commit("cabinet/setTimeZone",Us())});let W=_(()=>k.value.colors);Be("amColors",W);let le=_(()=>({"--am-c-primary":W.value.colorPrimary,"--am-c-success":W.value.colorSuccess,"--am-c-error":W.value.colorError,"--am-c-warning":W.value.colorWarning,"--am-c-main-bgr":W.value.colorMainBgr,"--am-c-main-heading-text":W.value.colorMainHeadingText,"--am-c-main-text":W.value.colorMainText,"--am-c-main-text-op10":H(W.value.colorMainText,.1),"--am-c-sb-bgr":W.value.colorSbBgr,"--am-c-sb-text":W.value.colorSbText,"--am-c-inp-bgr":W.value.colorInpBgr,"--am-c-inp-border":W.value.colorInpBorder,"--am-c-inp-text":W.value.colorInpText,"--am-c-inp-placeholder":W.value.colorInpPlaceHolder,"--am-c-drop-bgr":W.value.colorDropBgr,"--am-c-drop-text":W.value.colorDropText,"--am-c-btn-prim":W.value.colorBtnPrim,"--am-c-btn-prim-text":W.value.colorBtnPrimText,"--am-c-btn-sec":W.value.colorBtnSec,"--am-c-btn-sec-text":W.value.colorBtnSecText,"--am-c-btn-danger":W.value.colorBtnDanger,"--am-c-btn-danger-text":W.value.colorBtnDangerText,"--am-c-skeleton-op20":H(W.value.colorMainText,.2),"--am-c-skeleton-op60":H(W.value.colorMainText,.6),"--am-c-skeleton-sb-op20":H(W.value.colorSbText,.2),"--am-c-skeleton-sb-op60":H(W.value.colorSbText,.6),"--am-c-scroll-op30":H(W.value.colorPrimary,.3),"--am-c-scroll-op10":H(W.value.colorPrimary,.1),"--am-font-family":N.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px","--am-mw-main":D.value?T.value?"858px":"1024px":"520px","--am-brad-main":D.value?"0 0.5rem 0.5rem 0":"0.5rem"})),de=_(()=>({"--am-c-msd-bgr":W.value.colorSbBgr,"--am-c-msd-text":W.value.colorSbText,"--am-c-msd-text-op05":H(W.value.colorSbText,.05),"--am-c-msd-text-op10":H(W.value.colorSbText,.1),"--am-c-msd-text-op60":H(W.value.colorSbText,.6)}));return(ae,xe)=>(c(),y(ee,null,[N.value.customFontSelected?O("",!0):(c(),y(ee,{key:0},[VC,BC,m("link",{rel:"stylesheet",type:"text/css",href:`${t(j).wpAmeliaPluginURL}v3/src/assets/scss/common/fonts/font.css`,media:"all"},null,8,RC)],64)),m("div",{id:"amelia-container",ref_key:"ameliaContainer",ref:d,class:q(["am-cap__wrapper",[{"am-collapsed":t(T)},{"am-auth":!t(i)}]]),style:be(t(le))},[t(i)?O("",!0):(c(),U(sd,{key:0})),t(i)?(c(),y(ee,{key:1},[t(D)?(c(),U(ic,{key:0,class:q(["am-fs-sb",[{"am-collapsed":t(T)},{"am-rtl":t(s)}]]),style:be({width:t(T)?"72px":"240px",paddingBottom:`${t(z)+16}px`})},{"step-list":x(()=>[m("div",qC,[(c(!0),y(ee,null,fe(ie.value,(ye,pe)=>(c(),y(ee,{key:ye.key},[ye.key!=="packages"||t(e).getters["entities/getPackages"].length?(c(),y("div",{key:0,class:q(["am-fs-sb__page",{selected:t(g)===ye.key}]),style:be({"pointer-events":t(l).cabinetType==="employee"&&t(l).profile&&ye.key==="profile"?"none":""}),onClick:()=>{t(l).cabinetType==="employee"&&t(l).profile&&ye.key==="profile"||me(ye,pe)}},[m("div",{class:q(["am-fs-sb__page-inner",{"am-collapsed":t(T)}])},[m("div",zC,[m("span",{class:q(`am-icon-${ye.icon}`)},null,2)]),$(ga,{name:"fade"},{default:x(()=>[t(T)?O("",!0):(c(),y("p",{key:0,class:q(["am-fs-sb__page-heading",[t(w),{"am-rtl":t(s)}]])},C(ye.label),3))]),_:2},1024),$(ga,{name:"fade"},{default:x(()=>[t(T)?O("",!0):(c(),y("div",{key:0,class:q(["am-fs-sb__page-indicator",[t(w),{"am-rtl":t(s)}]])},[m("span",{class:q(t(s)?"am-icon-arrow-big-left":"am-icon-arrow-big-right")},null,2)],2))]),_:1})],2)],14,UC)):O("",!0),pe===0&&ie.value[0].key==="profile"?(c(),y("div",jC)):O("",!0)],64))),128))])]),"support-info":x(()=>[m("div",{ref_key:"sidebarFooterRef",ref:B,class:"am-fs-sb__footer"},[m("div",{class:"am-fs-sb__page",onClick:xe[0]||(xe[0]=ye=>we(T)?T.value=!t(T):T=!t(T))},[m("div",YC,[WC,$(ga,{name:"fade"},{default:x(()=>[t(T)?O("",!0):(c(),y("p",{key:0,class:q(["am-fs-sb__page-heading",t(w)])},C(t(S).toggle_sidebar),3))]),_:1})])]),HC,m("div",{class:"am-fs-sb__page",onClick:Ve},[m("div",ZC,[GC,$(ga,{name:"fade"},{default:x(()=>[t(T)?O("",!0):(c(),y("p",{key:0,class:q(["am-fs-sb__page-heading",t(w)])},C(t(S).log_out),3))]),_:1})])])],512)]),_:1},8,["class","style"])):O("",!0),$(oc,{"max-width":786,"old-responsive":!1},{header:x(()=>[$(Oc,{ready:t(te)},{default:x(()=>[m("div",JC,[m("div",XC,C(t(M)),1),t(D)?O("",!0):(c(),y("div",{key:0,class:"am-caph__menu",onClick:xe[1]||(xe[1]=()=>we(L)?L.value=!t(L):L=!t(L))},KC)),t(se)&&t(D)&&t(I)?(c(),U(Yn,{key:1})):O("",!0),$(lu,{"menu-items":ie.value,monitor:t(g),visibility:t(L),"custom-css":t(de),"customized-labels":t(S),position:"right",width:240,"onUpdate:visibility":xe[2]||(xe[2]=ye=>we(L)?L.value=ye:L=ye),onClick:Ae,onLogout:Q},null,8,["menu-items","monitor","visibility","custom-css","customized-labels"])])]),_:1},8,["ready"])]),step:x(()=>[(c(),U(pt(t(oe)[t(g)]),{class:"am-fs__main-content","load-bookings-counter":t(_e)},null,8,["load-bookings-counter"]))]),_:1})],64)):O("",!0)],6)],64))}});var dx=Object.freeze(Object.defineProperty({__proto__:null,default:tx},Symbol.toStringTag,{value:"Module"}));export{dx as C,lt as _,Nc as a,Rc as b,Yt as c,Yc as d,Oc as e,lu as f,ix as g,nx as h,Vt as i,na as j,dc as k,Po as u};
