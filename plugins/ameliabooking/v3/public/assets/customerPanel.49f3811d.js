import{bq as wl,br as Ir,t as ci,c as _,r as O,x as V,bs as $r,a as c,d as C,s as I,u as a,i as we,n as B,g as ke,y as W,f as Co,k as d,w as L,l as re,e as x,p as Te,q as N,M as Ge,_ as We,bt as Dr,bu as Pr,a$ as ot,aT as me,au as Nn,b as U,bv as Ll,bj as ui,j as De,ac as ga,z as pe,F as ae,b2 as za,bw as Ml,aq as Ue,bx as Rs,ao as Ze,aA as Fl,az as Vl,by as Ba,aH as Pe,aZ as El,D as Qe,b9 as Nr,ba as Or,a4 as Hs,o as Je,aW as st,bc as xt,aQ as at,bd as Mr,be as St,ai as pt,bz as Fr,bA as xo,bB as Vr,bb as et,bC as Fi,J as Re,K as Sl,L as it,B as di,b0 as Ia,b1 as $a,aD as xa,bD as Br,bE as mi,bF as ps,bG as La,bH as Vi,bI as Rr,bJ as qr,an as mt,bK as pi,aK as vt,bL as ys,bM as bs,aP as dt,m as Bi,a_ as ht,bN as Zs,bO as Ur,bP as ja,bQ as wo,ag as To,bR as Nt,bS as Bt,av as zt,bT as ia,bU as Gs,aw as Lo,bV as zr,bW as jt,at as Eo,ap as So,bX as jr,aI as Js,bY as Yr,bZ as qs,G as tt,b_ as gi,b$ as Wr,c0 as Ri,c1 as qi,bf as ut,c2 as Al,b8 as Hr,c3 as Bl,a9 as Zr,c4 as Gr,c5 as Jr,aN as Sa,aM as Rl,aS as Xr,c6 as Qr,c7 as Ao,c8 as Kr,c9 as ec,ca as tc,cb as fi,cc as ac,cd as sc,ce as lc,af as nc,ak as ic}from"./stepForm.3c2becda.js";import{e as oc,f as Ye,u as rc,m as Ke,_ as Il}from"./eventListForm.cf9e6a10.js";import{_ as cc}from"./catalogForm.5a79cd19.js";function Pt(n,t){let e=t!==""?JSON.parse(n.translations)[t]:JSON.parse(n.translations);if(wl in e)return e[wl];let s=Object.keys(e),l=Object.keys(e).map(o=>o.length>2?o.slice(0,2):o),i="";for(let o=0;o<l.length;o++){if(Ir===s[o]&&e[s[o]]){i=e[s[o]];break}l[o]===wl&&e[s[o]]&&(i=e[s[o]])}return i}function On(n,t){return n.translations&&JSON.parse(n.translations)[t]&&Pt(n,t)?Pt(n,t):n[t]}function Vt(n){return n.translations&&JSON.parse(n.translations).name&&Pt(n,"name")?Pt(n,"name"):n.name}function uc(n){return n.translations&&Pt(n,"")?Pt(n,""):n.name}function Lx(n){return n.translations&&Pt(n,"")?Pt(n,""):n.content}function dc(n){return n.translations&&Pt(n,"name")?Pt(n,"name"):n.label}function mc(n){return n.translations&&Pt(n,"")?Pt(n,""):n.label}function na(n){return n.translations&&JSON.parse(n.translations).description&&Pt(n,"description")?Pt(n,"description"):n.description}function Ex(n){n.services&&n.services.length&&n.services.forEach(t=>{t.name=Vt(t),t.description=na(t),t.extras.forEach(e=>{e.name=Vt(e),e.description=na(e)})}),n.locations&&n.locations.length&&n.locations.forEach(t=>{t.name=Vt(t),t.description=na(t)}),n.packages&&n.packages.length&&n.packages.forEach(t=>{t.name=Vt(t),t.description=na(t),t.bookable.forEach(e=>{e.service.name=Vt(e.service),e.service.description=na(e.service),"extras"in e.service&&e.service.extras.forEach(s=>{s.name=Vt(s),s.description=na(s)})})}),n.categories&&n.categories.length&&n.categories.forEach(t=>{t.name=Vt(t),t.serviceList.forEach(e=>{e.name=Vt(e),e.description=na(e),e.extras.forEach(s=>{s.name=Vt(s),s.description=na(s)})})}),n.events&&n.events.length&&n.events.forEach(t=>{t.name=Vt(t),t.description=na(t),t.extras.forEach(e=>{e.name=Vt(e),e.description=na(e)})}),n.customFields&&n.customFields.length&&n.customFields.forEach(t=>{t.label=dc(t),t.options.forEach(e=>{e.label=mc(e)})}),n.employees&&n.employees.length&&n.employees.forEach(t=>{t.firstName=On(t,"firstName"),t.lastName=On(t,"lastName"),t.description=On(t,"description")})}const lt={props:{modelValue:{type:[Boolean,String,Number],default:!1},id:{type:String},name:{type:String},width:{type:[Number,String]},size:{type:String,default:"default",validator(n){return["large","default","small"].includes(n)}},validateEvent:{type:Boolean,default:!0},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},activeColor:{type:String},inactiveColor:{type:String},activeText:{type:String},inactiveText:{type:String},activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeIconClass:{type:String},inactiveIconClass:{type:String},activeIcon:{type:String},inactiveIcon:{type:String},beforeChange:{type:[Function,Boolean],default:()=>{}},borderColor:{type:String},inlinePrompt:{type:Boolean,default:!1},parentClass:{type:String},class:{type:String},ariaLabel:{type:String}},emits:["update:modelValue","change"],setup(n,{emit:t}){const e=n,{modelValue:s}=ci(e),l=_({get:()=>s.value,set:u=>t("update:modelValue",u)}),i=O(null),o=V("amColors",O({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#1A2C37",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF",colorBtnWaiting:"#CCA20C",colorBtnWaitingText:"#FFFFFF",colorBtnDanger:"#B4190F",colorBtnDangerText:"#FFFFFF"})),r=_(()=>({"--am-c-switch-bgr-active":o.value.colorPrimary,"--am-c-switch-bgr-inactive":o.value.colorInpBorder,"--am-c-switch-action":o.value.colorMainBgr,"--am-c-switch-text":o.value.colorMainText}));return(u,m)=>{const h=$r;return c(),C("div",{class:B(["am-switch-wrapper",n.parentClass]),style:ke(a(r))},[I(h,{id:n.id,ref_key:"amSwitch",ref:i,modelValue:a(l),"onUpdate:modelValue":m[0]||(m[0]=v=>we(l)?l.value=v:null),class:B(["am-switch",e.class]),name:n.name,width:n.width,size:n.size,"validate-event":n.validateEvent,loading:n.loading,disabled:n.disabled,"active-color":n.activeColor,"inactive-color":n.inactiveColor,"active-text":n.activeText,"inactive-text":n.inactiveText,"active-value":n.activeValue,"inactive-value":n.inactiveValue,"active-icon-class":n.activeIconClass,"inactive-icon-class":n.inactiveIconClass,"active-icon":n.activeIcon,"inactive-icon":n.inactiveIcon,"before-change":n.beforeChange,"border-color":n.borderColor,"inline-prompt":n.inlinePrompt,"aria-label":n.ariaLabel,onChange:m[1]||(m[1]=v=>t("change",v))},null,8,["id","modelValue","class","name","width","size","validate-event","loading","disabled","active-color","inactive-color","active-text","inactive-text","active-value","inactive-value","active-icon-class","inactive-icon-class","active-icon","inactive-icon","before-change","border-color","inline-prompt","aria-label"])],6)}}};const pc={props:{ready:{type:Boolean,default:!0}},setup(n){let t=V("amColors",O({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#1A2C37",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),e=_(()=>({"--am-c-caph-text":t.value.colorMainText,"--am-c-caph-heading-text":t.value.colorMainHeadingText,"--am-c-caph-text-op15":W(t.value.colorMainText,.15)}));return(s,l)=>(c(),C("div",{class:"am-caph__main",style:ke(a(e))},[Co(s.$slots,"default")],4))}};const gc={key:0},fc={key:1},hc={key:2},_c={name:"MainProfileFooter"},vc=Object.assign(_c,{props:{parentWidth:{type:Number,default:1200},display:{type:String,default:"first"},loading:{type:Boolean,default:!1},customizedLabels:{type:Object,default:()=>({})},deleteFooterType:{type:String,default:"plain"},saveFooterButton:{type:String,default:"filled"},passFooterButton:{type:String,default:"filled"}},setup(n){const t=n,e=V("labels");function s(v){return Object.keys(t.customizedLabels).length&&t.customizedLabels[v]?t.customizedLabels[v]:e[v]}const l=V("settings");let i=V("deleteProfileDialog",O(!1)),o=V("saveProfileChanges",()=>{}),r=V("saveCustomerCustomFields",()=>{}),u=V("changeProfilePassword",()=>{}),m=V("amColors"),h=_(()=>({"--am-c-cappf-bgr":m.value.colorMainBgr,"--am-c-cappf-text":m.value.colorMainText,"--am-c-cappf-text-op15":W(m.value.colorMainText,.15)}));return(v,g)=>(c(),C("div",{class:"am-cappf",style:ke(a(h))},[d("div",{class:B(["am-cappf__options",{"am-only-one":n.display==="second"||!a(l).roles.allowCustomerDeleteProfile}])},[n.display==="first"&&a(l).roles.allowCustomerDeleteProfile?(c(),C("div",gc,[I(Te,{category:"danger",size:a(t).parentWidth<=360?"small":"default",type:a(t).deleteFooterType,class:"am-cappf__delete",disabled:n.loading,onClick:g[0]||(g[0]=b=>we(i)?i.value=!0:i=!0)},{default:L(()=>[re(x(s("delete_profile")),1)]),_:1},8,["size","type","disabled"])])):N("",!0),n.display==="first"||n.display==="third"?(c(),C("div",fc,[I(Te,{type:a(t).saveFooterButton,size:a(t).parentWidth<=360?"small":"default",disabled:n.loading,onClick:g[1]||(g[1]=b=>n.display==="first"?a(o)():a(r)())},{default:L(()=>[re(x(s("save_changes")),1)]),_:1},8,["type","size","disabled"])])):N("",!0),n.display==="second"?(c(),C("div",hc,[I(Te,{type:a(t).passFooterButton,size:a(t).parentWidth<=360?"small":"default",disabled:n.loading,onClick:g[2]||(g[2]=b=>a(u)())},{default:L(()=>[re(x(s("change_password")),1)]),_:1},8,["type","size","disabled"])])):N("",!0)],2)],4))}});const yc={key:0,class:"am-date-picker__input-date"},bc={key:1,class:"am-date-picker__input-start"},kc={key:2,class:"am-date-picker__input-end"},Yt={props:{modelValue:{type:[String,Array,Object,Number]},readonly:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},size:{type:String,default:"default",validator(n){return["default","medium","small","mini","micro"].includes(n)}},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!1},placeholder:{type:String,default:""},startPlaceholder:{type:String},endPlaceholder:{type:String},type:{type:String,default:"date",validator(n){return["year","years","month","months","date","dates","datetime","week","datetimerange","daterange","monthrange","yearrange"].includes(n)}},format:{type:String},popperClass:{type:String,default:""},popperOptions:{type:Object,default:()=>{}},rangeSeparator:{type:String,default:"-"},defaultValue:{type:[String,Array,Object,Number]},defaultTime:{type:[String,Array,Object,Number]},valueFormat:{type:String},id:{type:[String,Array]},name:{type:[String,Array]},unlinkPanels:{type:Boolean,default:!1},prefixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="calendar"/>'})},clearIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="close"/>'})},validateEvent:{type:Boolean,default:!0},disabledDate:{type:Function,default:()=>{}},shortcuts:{type:Array,default:()=>[]},cellClassName:{type:Function},teleported:{type:Boolean,default:!0},emptyValues:{type:[String,Array]},valueOnClear:{type:[String,Number,Boolean,Function],default:""},fallbackPlacements:{type:Array},placement:{type:String,default:"bottom",validator(n){return["top","top-start","top-end","bottom","bottom-start","bottom-end","left","left-start","left-end","right","right-start","right-end"].includes(n)}},lang:{type:String,default:""}},emits:["update:modelValue","change","blur","focus","clear","calendar-change","panel-change","visible-change"],setup(n,{emit:t}){const e=n;let{modelValue:s}=ci(e),l=_({get:()=>s.value,set:m=>{t("update:modelValue",m)}});const i=O(null);function o(){i.value&&i.value.focus()}let r=V("amColors"),u=_(()=>({"--am-c-primary":r.value.colorPrimary,"--am-c-inp-bgr":r.value.colorInpBgr,"--am-c-inp-border":r.value.colorInpBorder,"--am-c-inp-text":r.value.colorInpText,"--am-c-inp-text-op03":W(r.value.colorInpText,.03),"--am-c-inp-text-op05":W(r.value.colorInpText,.05),"--am-c-inp-text-op40":W(r.value.colorInpText,.4),"--am-c-inp-text-op60":W(r.value.colorInpText,.6),"--am-c-inp-placeholder":r.value.colorInpPlaceHolder,"--am-c-drop-bgr":r.value.colorDropBgr,"--am-c-drop-text":r.value.colorDropText,"--am-c-drop-text-op03":W(r.value.colorDropText,.03),"--am-c-drop-text-op10":W(r.value.colorDropText,.1),"--am-c-drop-text-op30":W(r.value.colorDropText,.3),"--am-c-drop-text-op50":W(r.value.colorDropText,.5),"--am-c-drop-text-op70":W(r.value.colorDropText,.7),"--am-c-drop-text-op80":W(r.value.colorDropText,.8),"--am-c-drop-border":r.value.colorDropBorder,"--am-c-skeleton-op20":W(r.value.colorMainText,.2),"--am-c-skeleton-op60":W(r.value.colorMainText,.6),"--am-c-skeleton-sb-op20":W(r.value.colorSbText,.2),"--am-c-skeleton-sb-op60":W(r.value.colorSbText,.6)}));return(m,h)=>{const v=Dr,g=Pr;return c(),C("div",{class:B(["am-date-picker__wrapper",{"is-disabled":e.disabled}]),style:ke(a(u))},[d("div",{class:B(["am-date-picker__input",[`am-${e.type}`,{"is-disabled":e.disabled}]]),onClick:o},[e.type==="date"&&a(l)?(c(),C("div",yc,x(a(ot)(a(me)(a(l)).format("YYYY-MM-DD"))),1)):N("",!0),e.type==="daterange"&&a(l)[0]?(c(),C("div",bc,x(a(ot)(a(me)(a(l)[0]).format("YYYY-MM-DD"))),1)):N("",!0),e.type==="daterange"&&a(l)[1]?(c(),C("div",kc,x(a(ot)(a(me)(a(l)[1]).format("YYYY-MM-DD"))),1)):N("",!0)],2),I(g,{locale:a(oc)(e.lang)},{default:L(()=>[I(v,{id:n.id,ref_key:"amDatePicker",ref:i,modelValue:a(l),"onUpdate:modelValue":h[0]||(h[0]=b=>we(l)?l.value=b:l=b),readonly:e.readonly,disabled:e.disabled,editable:e.editable,clearable:e.clearable,placeholder:e.placeholder,"start-placeholder":e.startPlaceholder,"end-placeholder":e.endPlaceholder,type:e.type,format:e.format,"popper-class":e.popperClass,"popper-options":e.popperOptions,"popper-style":a(u),"range-separator":e.rangeSeparator,"default-value":e.defaultValue,"default-time":e.defaultTime,"value-format":e.valueFormat,"unlink-panels":e.unlinkPanels,"prefix-icon":e.prefixIcon,"clear-icon":e.clearIcon,"validate-event":e.validateEvent,"disabled-date":n.disabledDate,shortcuts:e.shortcuts,"cell-class-name":e.cellClassName,teleported:e.teleported,"empty-values":e.emptyValues,"value-on-clear":e.valueOnClear,"fallback-placements":e.fallbackPlacements,placement:e.placement,class:B(["am-date-picker",[`am-date-picker--${n.size}`,{"am-date-picker--disabled":e.disabled}]]),onChange:h[1]||(h[1]=b=>m.$emit("change",b)),onBlur:h[2]||(h[2]=b=>m.$emit("blur",b)),onFocus:h[3]||(h[3]=b=>m.$emit("focus",b)),onClear:h[4]||(h[4]=b=>m.$emit("clear",b)),onCalendarChange:h[5]||(h[5]=b=>m.$emit("calendar-change",b)),onPanelChange:h[6]||(h[6]=b=>m.$emit("panel-change",b)),onVisibleChange:h[7]||(h[7]=b=>m.$emit("visible-change",b))},null,8,["id","modelValue","readonly","disabled","editable","clearable","placeholder","start-placeholder","end-placeholder","type","format","popper-class","popper-options","popper-style","range-separator","default-value","default-time","value-format","unlink-panels","prefix-icon","clear-icon","validate-event","disabled-date","shortcuts","cell-class-name","teleported","empty-values","value-on-clear","fallback-placements","placement","class"])]),_:1},8,["locale"])],6)}}};const Cc={class:"am-oit__wrapper"},xc={class:"am-oit"},wc={class:"am-oit__img"},Tc={key:0},Lc={class:"am-oit__content am-oit__content-short"},Ec={class:"am-oit__data"},Sc={class:"am-oit__data-label-name"},Ac=["innerHTML"],Ic={style:{display:"flex"}},$c=d("span",{class:"am-icon-circle-info"},null,-1),Dc=[$c],Pc={class:"am-dialog__title"},Nc={class:"am-dialog__body"},Oc={class:"am-dialog__body-heading"},Mc={class:"am-oit__img"},Fc={key:0},Vc={class:"am-dialog__body-heading__text"},Bc={class:"am-dialog__body-heading__text-name"},Rc=["innerHTML"],qc={inheritAttrs:!1},Uc=Object.assign(qc,{props:{identifier:{type:[String,Number],required:!0},imageThumb:{type:String,default:""},label:{type:[String,Number],default:""},description:{type:String,default:""},price:{type:[String,Number],default:""},dialogTitle:{type:String,default:""},dialogButtonText:{type:String,default:""},badge:{type:[String,Number,Object]}},emits:["click"],setup(n,{emit:t}){const e=n;let s=O(!1);const l=g=>{g.stopPropagation(),s.value=!0},i=()=>{s.value=!1,t("click",e.identifier)};function o(g){return g=g.replace(/<\/p>/g," </p>").replace(/<\/h1>/g," </h1>").replace(/<\/h2>/g," </h2>").replace(/<\/h3>/g," </h3>").replace(/<\/h4>/g," </h4>"),g=g.replace(/<\/li>/g," </li>"),g}function r(){if(e.label){let g="";return e.label.split(" ").forEach(b=>{g+=b.charAt(0).toUpperCase()}),g}}let u=V("primDescBtnType","filled"),m=V("amColors"),h=_(()=>({"--am-oit-c-main-bgr":m.value.colorMainBgr,"--am-oit-c-main-btn-color":m.value.colorBtnPrim,"--am-oit-c-main-btn-color-text":m.value.colorBtnPrimText,"--am-oit-c-main-heading-text":m.value.colorMainHeadingText,"--am-oit-c-main-heading-text-op90":W(m.value.colorMainHeadingText,.9),"--am-oit-c-main-text":m.value.colorMainText,"--am-c-option-img-text":m.value.colorMainBgr})),v=_(()=>({"--am-c-option-selected":m.value.colorPrimary}));return(g,b)=>(c(),C("span",Cc,[d("span",xc,[d("span",wc,[d("span",{class:"am-oit__img-placeholder",style:ke({backgroundImage:`url(${e.imageThumb})`})},[e.imageThumb?N("",!0):(c(),C("span",Tc,x(r()),1))],4)]),d("span",Lc,[d("span",Ec,[d("span",{class:B(`am-oit__data-label ${n.badge?"am-oit__data-label-wrap":""}`)},[d("span",Sc,x(n.label),1),n.badge?(c(),C("span",{key:0,class:"am-oit__data-label-badge",style:ke({background:n.badge.color})},x(n.badge.content),5)):N("",!0)],2),!n.badge&&a(Nn)(n.description)?(c(),C("span",{key:0,class:"am-oit__data-description",innerHTML:o(n.description)},null,8,Ac)):N("",!0)]),d("span",Ic,[e.price?(c(),C("span",{key:0,class:"am-oit__price",style:ke(a(v))},x(e.price),5)):N("",!0),a(Nn)(n.description)?(c(),C("span",{key:1,class:"am-oit__info-trigger",onClick:l},Dc)):N("",!0)])])]),a(Nn)(n.description)?(c(),U(cc,{key:0,modelValue:a(s),"onUpdate:modelValue":b[0]||(b[0]=D=>we(s)?s.value=D:s=D),"custom-class":"am-option-template-dialog am-dialog ql-description","append-to-body":!0,"custom-styles":a(h),"destroy-on-close":!0,"align-center":!0,"modal-class":"am-dialog-employee-description"},{title:L(()=>[d("span",Pc,x(n.dialogTitle),1)]),footer:L(()=>[I(Te,{type:a(u),category:"primary",onClick:i},{default:L(()=>[re(x(n.dialogButtonText),1)]),_:1},8,["type"])]),default:L(()=>[d("div",Nc,[d("div",Oc,[d("span",Mc,[d("span",{class:"am-oit__img-placeholder",style:ke({backgroundImage:`url(${e.imageThumb})`})},[e.imageThumb?N("",!0):(c(),C("span",Fc,x(r()),1))],4)]),d("div",Vc,[d("span",Bc,x(n.label),1),n.badge?(c(),C("span",{key:0,class:"am-dialog__body-heading__text-badge",style:ke({background:n.badge.color})},x(n.badge.content),5)):N("",!0)])]),d("div",{class:"am-dialog__body-content",innerHTML:n.description},null,8,Rc)])]),_:1},8,["modelValue","custom-styles"])):N("",!0)]))}});function zc(n,t,e){let s={};return n.forEach(l=>{t===""&&l.periods.forEach(h=>{h.periodStart=Ll(h.periodStart),h.periodEnd=Ll(h.periodEnd)});let o=me(l.periods[0].periodStart,"YYYY-MM-DD HH:mm:ss").format("YYYY-MM-DD"),r=e.getters.getSettings.general.usedLanguages.map(h=>h.length>2?h.slice(0,2):h);(e.getters.getSettings.general.usedLanguages.indexOf(e.getters.getLocalLanguage)!==-1||r.indexOf(e.getters.getLocalLanguage.split("_")[0])!==-1)&&(l.name=Vt(l),l.customTickets.forEach(h=>{h.name=uc(h)})),l.recurring&&l.recurring.until&&(l.recurring.until=l.recurring.until.split(" ")[0]),o in s||(s[o]={date:o,events:[]});let m=l.bookings.some(h=>h.status==="waiting");if(l.full&&l.status==="approved"?l.status="full":l.upcoming&&l.status==="approved"&&(l.status="upcoming"),m&&(l.status="waiting"),e.getters["auth/getProfile"].type==="provider"){let h=JSON.parse(JSON.stringify(l));s[o].events.push(h)}else l.bookings.forEach(h=>{let v=JSON.parse(JSON.stringify(l));v.bookings=[h],s[o].events.push(v)})}),s}function Io(n){let t=0;return n.bookings.forEach(e=>{if(["approved","pending"].includes(e.status)){let s=0;if(e.ticketsData.length>0)for(let i=0;i<e.ticketsData.length;i++)s+=e.ticketsData[i].persons*e.ticketsData[i].price;else s+=n.price;let l=ui(n,e.coupon,e.tax?e.tax[0]:null,s,!1);t+=l.price-l.discount+l.tax}}),t>=0?t:0}function jc(n){let t=[];return n.forEach(e=>{let s=me(e.periodStart.split(" ")[0],"YYYY-MM-DD"),l=me(e.periodEnd.split(" ")[0],"YYYY-MM-DD"),i=e.periodStart.split(" ")[1].slice(0,5),o=e.periodEnd.split(" ")[1].slice(0,5);o==="00:00"&&(o="24:00",l.subtract(1,"days"));let r=[];for(;s.isSameOrBefore(l);)r.push(s.format("YYYY-MM-DD")),s.add(1,"days");r.forEach(u=>{t.push({date:u,startTime:i,endTime:o,periodStart:u+" "+i,periodEnd:u+" "+o,zoomLink:n.length>1&&e.zoomMeeting?e.zoomMeeting.joinUrl:"",lessonSpaceLink:n.length>1&&e.lessonSpace?e.lessonSpace:"",googleMeetLink:n.length>1&&e.googleMeetUrl?e.googleMeetUrl:"",microsoftTeamsLink:n.length>1&&e.microsoftTeamsUrl?e.microsoftTeamsUrl:""})})}),t}function Yc(n){let t={};return n.bookings.forEach(e=>{["approved","pending"].includes(e.status)&&e.ticketsData&&e.ticketsData.length&&e.ticketsData.forEach(s=>{s.eventTicketId in t||(t[s.eventTicketId]={persons:0,price:s.price,name:n.customTickets.find(l=>l.id===s.eventTicketId).name}),t[s.eventTicketId].persons=t[s.eventTicketId].persons+s.persons})}),t}function Wc(n,t){let e=n.getters["entities/getLocations"];if(t.locationId&&e.length){let s=e.find(l=>l.id===t.locationId);return typeof s<"u"?s:null}else if(t.customLocation)return{address:"",name:t.customLocation};return null}let Mn=[],ss=["1788FB","4BBEC6","FBC22D","FA3C52","D696B8","689BCA","26CC2B","FD7E35","E38587","774DFB","31CDF3","6AB76C","FD5FA1","A697C5"];function Sx(n,t,e){if(t!==null){let s=e===!0?t.firstName+" "+t.lastName:t.name;if(typeof s<"u")return t.pictureThumbPath=t.pictureThumbPath||Hc(n,s),t.pictureThumbPath}}function Hn(n){return n.split(" ").map(t=>t.charAt(0)).join("").toUpperCase().substring(0,3).replace(/[^\w\s]/g,"")}function Hc(n,t,e={},s=!1){let l=Hn(t),i=Math.floor(Math.random()*ss.length),o=ss[i];if(Mn.push(ss[i]),ss.splice(i,1),ss.length===0&&(ss=Mn,Mn=[]),s)return e.firstName?n.wpAmeliaPluginURL+"public/img/default-employee.svg":e.latitude?n.wpAmeliaPluginURL+"public/img/default-location.svg":n.wpAmeliaPluginURL+"public/img/default-service.svg";const r=document.createElement("canvas");r.width=100,r.height=100;const u=r.getContext("2d");return u.fillStyle=`#${o}`,u.fillRect(0,0,r.width,r.height),u.font="40px Arial",u.fillStyle="#ffffff",u.textAlign="center",u.textBaseline="middle",u.fillText(l,r.width/2,r.height/2),r.toDataURL("image/png")}const Zc={class:"am-msd__item-wrapper"},Gc={class:"am-msd__item-inner"},Jc=d("div",{class:"am-msd__item-icon"},[d("span",{class:"am-icon-close"})],-1),Xc=["onClick"],Qc={class:"am-msd__item-inner"},Kc={class:"am-msd__item-icon"},eu={key:1,class:"am-msd__item-divider"},tu={class:"am-msd__item-inner"},au=d("div",{class:"am-msd__item-icon"},[d("span",{class:"am-icon-logout"})],-1),su={class:"am-msd__item-heading"},lu={props:{visibility:{type:Boolean,required:!0},customizedLabels:{type:Object,default:()=>({})},monitor:{type:String,required:!0},menuItems:{type:Array,required:!0},customCss:{type:Object,default:()=>{}},width:{type:Number,default:300},position:{type:String,default:"right",validator(n){return["right","left","top","bottom"].includes(n)}}},emits:["click","update:visibility","logout"],setup(n,{emit:t}){const e=n;let s=V("labels");const l=De();let i=_(()=>document?document.documentElement.dir==="rtl":!1);function o(h,v){t("click",{step:h,index:v}),t("update:visibility",!1)}function r(){t("update:visibility",!1)}function u(h){return Object.keys(e.customizedLabels).length&&e.customizedLabels[h]?e.customizedLabels[h]:s[h]}let m=_(()=>({"--am-mw-msd":`${e.width}px`}));return(h,v)=>(c(),U(za,{visibility:n.visibility,position:n.position,"custom-class":"am-msd","close-outside":!0,"custom-css":{...n.customCss,...a(m)},"onUpdate:visibility":v[1]||(v[1]=g=>a(t)("update:visibility",!1))},{footer:L(()=>[d("div",{class:"am-msd__item",onClick:v[0]||(v[0]=()=>a(t)("logout"))},[d("div",tu,[au,d("p",su,x(u("log_out")),1)])])]),default:L(()=>[d("div",Zc,[d("div",{class:"am-msd__item",onClick:r},[d("div",Gc,[I(ga,{name:"fade"},{default:L(()=>[d("p",{class:B(["am-msd__item-heading",{"am-rtl":a(i)}])},x(u("menu_title")),3)]),_:1}),I(ga,{name:"fade"},{default:L(()=>[Jc]),_:1})])]),(c(!0),C(ae,null,pe(n.menuItems,(g,b)=>(c(),C(ae,{key:g.key},[g.key!=="packages"||a(l).getters["entities/getPackages"].length?(c(),C("div",{key:0,class:B(["am-msd__item",{selected:n.monitor===g.key}]),onClick:D=>o(g,b)},[d("div",Qc,[d("div",Kc,[d("span",{class:B(`am-icon-${g.icon}`)},null,2)]),I(ga,{name:"fade"},{default:L(()=>[d("p",{class:B(["am-msd__item-heading",{"am-rtl":a(i)}])},x(g.label),3)]),_:2},1024),I(ga,{name:"fade"},{default:L(()=>[d("div",{class:B(["am-msd__item-indicator",{"am-rtl":a(i)}])},[d("span",{class:B(a(i)?"am-icon-arrow-big-left":"am-icon-arrow-big-right")},null,2)],2)]),_:1})])],10,Xc)):N("",!0),b===0?(c(),C("div",eu)):N("",!0)],64))),128))])]),_:1},8,["visibility","position","custom-css"]))}};const Zn={props:{size:{type:String,default:"default"}},setup(n){const t=n,e=Ml().cookies,s=V("settings");let l=V("cabinetType"),{bookingsCounterChanger:i}=V("bookingsCounterChanger",{bookingsCounterChanger:()=>{}});const o=De();let r=_({get:()=>o.getters["cabinet/getTimeZone"],set:y=>{o.commit("cabinet/setTimeZone",y||"")}}),u=_(()=>o.getters["appointment/getActive"]||o.getters["event/getActive"]||o.getters["attendee/getActive"]);const m=V("timeZone"),h=V("timeZones");let v=O("");function g(y){v.value=y.toLowerCase()}let b=_(()=>v.value?h.filter(y=>y.toLowerCase().includes(v.value)):h);function D(){let y;s.general.showClientTimeZone?y=Rs():y=m.value,e.set("ameliaUserTimeZone",y,s.roles[l.value+"Cabinet"].tokenValidTime),i(),o.commit("cabinet/setTimeZone",y)}function P(y){e.set("ameliaUserTimeZone",y,s.roles[l.value+"Cabinet"].tokenValidTime),i()}return(y,w)=>a(u)?N("",!0):(c(),U(Ze,{key:0,modelValue:a(r),"onUpdate:modelValue":w[0]||(w[0]=A=>we(r)?r.value=A:r=A),filterable:!0,placeholder:a(Rs)(),clearable:!0,size:a(t).size,"custom-class":"am-ctz","prefix-icon":"globe-watch","filter-method":g,onClear:D,onChange:P},{default:L(()=>[(c(!0),C(ae,null,pe(a(b),(A,S)=>(c(),U(Ue,{key:S,label:A,value:A},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","size"]))}};function $o(){return"ameliaBooking"in window&&"cabinet"in window.ameliaBooking&&"disableAuthorizationHeader"in window.ameliaBooking.cabinet&&window.ameliaBooking.cabinet.disableAuthorizationHeader}function ze(n){let t=n.getters["auth/getToken"];return t&&!$o()?{headers:{Authorization:"Bearer "+t}}:{}}const nu={key:0,class:"el-skeleton-item-wrapper-title"},iu={name:"AuthSkeleton"},Wt=Object.assign(iu,{props:{centerFirst:{type:Boolean,default:!1},count:{type:Number,default:3},mainClass:{type:String,default:""}},setup(n){const t=n;return(e,s)=>{const l=Fl,i=Vl;return c(),U(i,{animated:"",class:B(["am-asi-el-skeleton",a(t).mainClass])},{template:L(()=>[a(t).centerFirst?(c(),C("div",nu,[I(l,{variant:"rect"})])):N("",!0),(c(!0),C(ae,null,pe(new Array(a(t).count),o=>(c(),C("div",{key:o,class:"el-skeleton-item-wrapper"},[I(l,{variant:"rect"})]))),128))]),_:1},8,["class"])}}});function ou(n,t){let e=Ba(Ba(Ba(window.location.href,"code"),"state"),"scope");Pe.post("/google/authorization/token",{authCode:n,userId:El(window.location.href).state,redirectUri:e}).then(()=>{history.pushState(null,null,e)}).catch(s=>{console.log(s)}).finally(()=>{t()})}function ru(n){n.getters["auth/getGoogleLoading"]||(n.commit("auth/setGoogleLoading",!0),Pe.get("/google/authorization/url/"+n.getters["employee/getId"],Object.assign({redirectUri:window.location.href.split("?")[0]},ze(n))).then(t=>{window.location.href=t.data.data.authUrl.replace(/redirect_uri=.+?&/,"redirect_uri="+window.location.href+"&")}).catch(t=>{console.log(t),n.commit("auth/setGoogleLoading",!1)}))}function cu(n){n.commit("auth/setGoogleLoading",!0),Pe.post("/google/disconnect/"+n.getters["employee/getId"]).then(()=>{n.commit("employee/setGoogleId",null),n.commit("employee/setGoogleCalendarId",""),n.commit("employee/setGoogleToken",null),n.commit("auth/setGoogleCalendars",[])}).catch(t=>{console.log(t)}).finally(()=>{n.commit("auth/setGoogleLoading",!1)})}function uu(n,t){let e=Ba(Ba(Ba(window.location.href,"code"),"state"),"type");Pe.post("/outlook/authorization/token",{authCode:n,userId:El(window.location.href).state.split("amelia-outlook-calendar-auth-")[1],redirectUri:window.location.href.split("?")[0]}).then(()=>{history.pushState({},null,e)}).catch(s=>{console.log(s)}).finally(()=>{t()})}function du(n){n.getters["auth/getOutlookLoading"]||(n.commit("auth/setOutlookLoading",!0),Pe.get("/outlook/authorization/url/"+n.getters["employee/getId"],Object.assign({redirectUri:window.location.href.split("?")[0]},ze(n))).then(t=>{window.location.href=t.data.data.authUrl.replace(/redirect_uri=.+?&/,"redirect_uri="+window.location.href+"&")}).catch(t=>{console.log(t),n.commit("auth/setGoogleLoading",!1)}))}function mu(n){n.commit("auth/setOutlookLoading",!0),Pe.post("/outlook/disconnect/"+n.getters["employee/getId"]).then(()=>{n.commit("employee/setOutlookId",""),n.commit("employee/setOutlookCalendarId",""),n.commit("employee/setOutlookToken",null),n.commit("auth/setOutlookCalendars",[])}).catch(t=>{console.log(t)}).finally(()=>{n.commit("auth/setOutlookLoading",!1)})}function pu(n){n.commit("auth/setZoomLoading",!0),Pe.get("/zoom/users",Object.assign(ze(n),{params:{source:"cabinet-provider"}})).then(t=>{"data"in t.data&&"users"in t.data.data&&n.commit("auth/setZoomUsers",t.data.data?.users?t.data.data.users:[])}).catch(t=>{console.log(t)}).finally(()=>{n.commit("auth/setZoomLoading",!1)})}function gu(n){n.commit("auth/setStripeLoading",!0),Pe.get("/stripe/accounts/"+n.getters["employee/getId"],Object.assign({},ze(n))).then(t=>{t.data.data.account&&(n.commit("auth/setStripeProvider",t.data.data.account),n.getters["employee/getStripeConnect"]||n.commit("employee/setStripeConnect",{id:t.data.data.account.id,amount:null}))}).catch(t=>{console.log(t)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function fu(n,t){n.commit("auth/setStripeLoading",!0),Pe.post("/stripe/onboard/"+n.getters["auth/getProfile"].id,Object.assign({returnUrl:window.location.href,accountType:t},ze(n))).then(e=>{window.location.href=e.data.data.url}).catch(e=>{n.commit("auth/setStripeLoading",!1),console.log("response"in e&&"data"in e.response&&"message"in e.response.data?e.response.data.message:e.message)})}function hu(n){n.commit("auth/setStripeLoading",!0),Pe.post("/stripe/disconnect/"+n.getters["auth/getProfile"].id,ze(n)).then(()=>{n.commit("auth/setStripeProvider",{id:"",email:"",type:"",completed:!1}),n.commit("employee/setStripeConnect",null)}).catch(t=>{console.log(t)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}function _u(n){let t=n.getters["auth/getStripeProvider"];n.commit("auth/setStripeLoading",!0),t.type==="standard"?(window.open("https://dashboard.stripe.com/"+t.id,"_blank"),n.commit("auth/setStripeLoading",!1)):t.type==="express"&&Pe.post("/stripe/dashboard/"+n.getters["auth/getProfile"].id,ze(n)).then(e=>{e.data.data.url&&window.open(e.data.data.url,"_blank")}).catch(e=>{console.log(e)}).finally(()=>{n.commit("auth/setStripeLoading",!1)})}let ka=O(!1);function Gn(n){n.commit("auth/setAppleLoading",!0),Pe.get("/apple/calendar-list/"+n.getters["employee/getId"],ze(n)).then(t=>{n.commit("auth/setAppleCalendars",t.data.data?.calendarList?t.data.data.calendarList:[]),n.getters["auth/getAppleCalendars"].map(e=>e.id).indexOf(n.getters["employee/getAppleCalendarId"])===-1&&n.commit("employee/setAppleCalendarId",""),n.commit("employee/setAppleCalendarId",t.data.data?.appleCalendarId),ka.value=t.data.data.isEmployeeConnectedToPersonalAppleCalendar}).catch(t=>{console.log(t)}).finally(()=>{n.commit("auth/setAppleLoading",!1)})}const vu={class:"am-asi__top"},yu={class:"am-asi__header"},bu={class:"am-asi__text"},ku={key:0},Cu={class:"am-asi__social-wrapper"},xu={class:"am-asi__social-divider"},wu={class:"par-sm"},Tu={class:"am-asi__footer"},Lu={class:"am-asi__footer-text"},Eu={name:"AuthSignIn"},Su=Object.assign(Eu,{setup(n){let t=V("licence"),e=De();const s=Ml().cookies,l=V("settings");let i=V("amCustomize");const o=V("labels"),r=V("localLanguage");let u=_(()=>l.general.usedLanguages.includes(r.value)),m=_(()=>{let Z=Qe({...o}),ge=i.value.signIn.translations;return ge&&Object.keys(ge).forEach(be=>{ge[be][r.value]&&u.value?Z[be]=ge[be][r.value]:ge[be].default&&(Z[be]=ge[be].default)}),Z}),h={components:{IconComponent:We},template:'<IconComponent icon="email"></IconComponent>'},v={components:{IconComponent:We},template:'<IconComponent icon="password"></IconComponent>'},g=O("");const b=Nr.factory(Pe,Or);function D({provider:Z,credentials:ge}){e.commit("setLoading",!0);const be=`/users/authentication/${Z}`,q={};g=Z,q.cabinetType=k.value,Z==="facebook"&&(q.redirectUri=b.options.providers[Z].redirectUri,b.options.providers[Z].url=`${be}`,e.commit("setLoading",!1),b.authenticate(Z,q).then(Q=>{w.value.email=Q.data.data.user.email,P(Q)}).catch(Q=>{b.isAuthenticated()||($.value=!0,R.value="User is not authenticated.",e.commit("setLoading",!1)),Q.response?.data&&($.value=!0,R.value=Q.response.data.message),e.commit("setLoading",!1)})),Z==="google"&&(q.code=ge,Pe.post(`${be}`,q).then(Q=>{w.value.email=Q.data.data.user.email,P(Q)}).catch(Q=>{if(!("data"in Q.response.data)&&"message"in Q.response.data){$.value=!0,R.value=Q.response.data.message;return}"invalid_credentials"in Q.response.data.data&&($.value=!0,R.value=m.value.invalid_credentials)}).finally(()=>{e.commit("setLoading",!1)}))}function P(Z){"token"in Z.data.data&&(s.set("ameliaToken",Z.data.data.token,l.roles[k.value+"Cabinet"].tokenValidTime,null,null,!0),s.set("ameliaUserEmail",Z.data.data.user.email,l.roles[k.value+"Cabinet"].tokenValidTime,null,null,!0),e.commit("auth/setToken",Z.data.data.token)),"user"in Z.data.data&&Z.data.data.user.type==="provider"&&M(Z),e.commit("auth/setProfile",Z.data.data.user),Z.data.data.user.timeZone&&e.commit("cabinet/setTimeZone",Z.data.data.user.timeZone),e.commit("auth/setAuthenticated",!0);let ge=k.value==="customer"?l.roles.customerCabinet.tokenValidTime*1e3:l.roles.providerCabinet.tokenValidTime*1e3;ge>0&&ge<18144e5&&setTimeout(()=>{e.dispatch("auth/logout")},ge)}let y=O(null),w=O({email:_({get:()=>e.getters["auth/getEmail"],set:Z=>{e.commit("auth/setEmail",Z||"")}}),password:_({get:()=>e.getters["auth/getPassword"],set:Z=>{e.commit("auth/setPassword",Z||"")}})}),A=O({email:[{required:!0,message:m.value.enter_email_or_username_warning,trigger:"submit"}],password:[{required:!0,message:m.value.enter_password_warning,trigger:"submit"}]}),S=O({email:{template:Ye.text,props:{itemName:"email",label:m.value.email_or_username,prefixIcon:Ge(h),placeholder:"",class:"am-asi__item"}},password:{template:Ye.text,props:{itemName:"password",itemType:"password",showPassword:!0,label:m.value.password,prefixIcon:Ge(v),placeholder:"",class:"am-asi__item"}}}),f=V("pageKey"),k=V("cabinetType"),T=_(()=>e.getters.getLoading),E=_(()=>e.getters["auth/getProfileDeleted"]),$=O(!1),R=O("");function Y(Z,ge){let be=Fi("token");Z?K(Z,!1,!1,!1):be?K(be,!0,!1,ge):K("",!1,!0,!1)}function M(Z){let ge={id:Z.data.data.user.id,firstName:Z.data.data.user.firstName,lastName:Z.data.data.user.lastName,email:Z.data.data.user.email,phone:Z.data.data.user.phone,countryPhoneIso:Z.data.data.user.countryPhoneIso,googleCalendar:{id:"id"in Z.data.data.user.googleCalendar?Z.data.data.user.googleCalendar.id:null,calendarId:Z.data.data.user.googleCalendar.calendarId?Z.data.data.user.googleCalendar.calendarId:"",token:"token"in Z.data.data.user.googleCalendar?Z.data.data.user.googleCalendar.token:null},outlookCalendar:{id:"id"in Z.data.data.user.outlookCalendar?Z.data.data.user.outlookCalendar.id:null,calendarId:Z.data.data.user.outlookCalendar.calendarId?Z.data.data.user.outlookCalendar.calendarId:"",token:"token"in Z.data.data.user.outlookCalendar?Z.data.data.user.outlookCalendar.token:null},appleCalendarId:Z.data.data.user.appleCalendarId?Z.data.data.user.appleCalendarId:"",stripeConnect:Z.data.data.user.stripeConnect,zoomUserId:Z.data.data.user.zoomUserId?Z.data.data.user.zoomUserId:"",locationId:Z.data.data.user.locationId,pictureFullPath:Z.data.data.user.pictureFullPath,pictureThumbPath:Z.data.data.user.pictureThumbPath,description:Z.data.data.user.description,weekDayList:Z.data.data.user.weekDayList,specialDayList:Z.data.data.user.specialDayList,dayOffList:Z.data.data.user.dayOffList,serviceList:Z.data.data.user.serviceList};ge.serviceList.forEach(be=>{Fr(be)}),e.getters["entities/getReady"]&&(e.commit("entities/setEmployees",[JSON.parse(JSON.stringify(ge))]),ge.serviceList=xo(e,ge.serviceList)),e.commit("employee/setEmployee",Vr(e,ge)),e.commit("auth/setOutlookCalendars",Z.data.data.user.outlookCalendar?.calendarList?Z.data.data.user.outlookCalendar.calendarList:[]),e.commit("auth/setGoogleCalendars",Z.data.data.user.googleCalendar?.calendarList?Z.data.data.user.googleCalendar.calendarList:[]),l.appleCalendar&&!t.isLite&&!t.isStarter&&Gn(e),l.payments.stripe.enabled&&l.payments.stripe.connect.enabled&&!t.isLite&&!t.isStarter&&!t.isBasic&&gu(e),l.zoom.enabled&&!t.isLite&&!t.isStarter&&pu(e)}function K(Z,ge,be,q){let Q={cabinetType:k.value,changePass:q};be&&(Q.checkIfWpUser=!0);let G=e.getters["auth/getPassword"],H=e.getters["auth/getEmail"];!Z&&G&&H&&(Q.password=G,Q.email=H),ge&&(Q.token=Z),Pe.post("/users/authenticate",Q,Z!==null&&!$o()?{headers:{Authorization:"Bearer "+Z}}:{}).then(J=>{if("authentication_required"in J.data.data){l.roles[k.value+"Cabinet"].loginEnabled||(f.value="sendAccessLink");return}"token"in J.data.data&&(s.set("ameliaToken",J.data.data.token,l.roles[k.value+"Cabinet"].tokenValidTime,null,null,!0),s.set("ameliaUserEmail",J.data.data.user.email,l.roles[k.value+"Cabinet"].tokenValidTime,null,null,!0),e.commit("auth/setToken",J.data.data.token)),"user"in J.data.data&&J.data.data.user.type==="provider"&&M(J),Fi("token")&&window.history.replaceState(null,null,Ba(window.location.href,"token")),e.commit("auth/setProfile",J.data.data.user),!J.data.data.user.countryPhoneIso&&l.general.phoneDefaultCountryCode&&l.general.phoneDefaultCountryCode!=="auto"&&e.commit("auth/setProfileCountryPhoneIso",l.general.phoneDefaultCountryCode),J.data.data.user.timeZone&&e.commit("cabinet/setTimeZone",J.data.data.user.timeZone),"set_password"in J.data.data&&J.data.data.set_password||"change_password"in J.data.data&&J.data.data.change_password?f.value="setPassword":e.commit("auth/setAuthenticated",!0);let X=k.value==="customer"?l.roles.customerCabinet.tokenValidTime*1e3:l.roles.providerCabinet.tokenValidTime*1e3;X>0&&X<18144e5&&setTimeout(()=>{e.dispatch("auth/logout")},X)}).catch(J=>{if(!("data"in J.response.data)&&"message"in J.response.data){$.value=!0,R.value=J.response.data.message;return}"invalid_credentials"in J.response.data.data&&($.value=!0,R.value=m.value.invalid_credentials)}).finally(()=>{e.commit("setLoading",!1)})}function ce(){y.value.validate(Z=>{if(Z)e.commit("setLoading",!0),K(null,!1,!1,!1);else return!1})}function j(){Y(s.get("ameliaToken"),"changePass"in El(window.location.href))}Hs(()=>{e.commit("setLoading",!0)}),Je(()=>{if(e.getters["auth/getLoggedOut"])l.roles[k.value+"Cabinet"].loginEnabled||(f.value="sendAccessLink"),e.commit("setLoading",!1);else{let Z=El(window.location.href);l.googleCalendar.enabled&&k.value==="provider"&&Z&&Z.code&&Z.scope?ou(Z.code,j):l.outlookCalendar.enabled&&k.value==="provider"&&Z&&Z.code&&Z.state?uu(Z.code,j):j()}});let ie=V("containerWidth"),se=_(()=>st(ie.value)),le=V("amFonts"),te=V("amColors"),ne=_(()=>({"--am-c-primary":te.value.colorPrimary,"--am-c-success":te.value.colorSuccess,"--am-c-error":te.value.colorError,"--am-c-warning":te.value.colorWarning,"--am-c-main-bgr":te.value.colorMainBgr,"--am-c-main-heading-text":te.value.colorMainHeadingText,"--am-c-main-text":te.value.colorMainText,"--am-c-main-text-op70":W(te.value.colorMainText,.7),"--am-c-main-text-op60":W(te.value.colorMainText,.6),"--am-c-main-text-op40":W(te.value.colorMainText,.4),"--am-c-main-text-op25":W(te.value.colorMainText,.25),"--am-c-inp-bgr":te.value.colorInpBgr,"--am-c-inp-border":te.value.colorInpBorder,"--am-c-inp-text":te.value.colorInpText,"--am-c-inp-placeholder":te.value.colorInpPlaceHolder,"--am-c-btn-prim":te.value.colorBtnPrim,"--am-c-btn-prim-text":te.value.colorBtnPrimText,"--am-c-skeleton-op20":W(te.value.colorMainText,.2),"--am-c-skeleton-op60":W(te.value.colorMainText,.6),"--am-font-family":le.value.fontFamily,"--am-c-scroll-op30":W(te.value.colorPrimary,.3),"--am-c-scroll-op10":W(te.value.colorPrimary,.1)}));return(Z,ge)=>{const be=et;return a(T)?(c(),U(a(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi-sign-in am-asi"})):(c(),C("div",{key:0,class:"am-asi",style:ke(a(ne))},[d("div",vu,[a(E)?(c(),U(xt,{key:0,class:"am-asi__top-message am-asi__top-message-success",type:"success",title:a(m).profile_deleted,description:"","show-icon":!0,closable:!0,onClose:ge[0]||(ge[0]=q=>a(e).commit("auth/setProfileDeleted",!1))},null,8,["title"])):N("",!0),a($)?(c(),U(xt,{key:1,class:"am-asi__top-message am-asi__top-message-error",type:"error",title:a(R),description:"","show-icon":!0,closable:!0,onClose:ge[1]||(ge[1]=q=>a(e).commit("auth/setProfileDeleted",!1))},null,8,["title"])):N("",!0),d("div",yu,x(a(m).welcome_back),1),d("div",bu,x(a(m).enter_credentials),1)]),a(at).socialLogin.googleLoginEnabled&&a(at).general.googleClientId||a(at).socialLogin.facebookLoginEnabled&&a(at).socialLogin.facebookCredentialsEnabled?(c(),C("div",ku,[d("div",Cu,[I(Mr,{provider:a(g),onSocialAction:D},null,8,["provider"])]),d("div",xu,[d("span",wu,x(a(m).or_enter_details_below),1)])])):N("",!0),I(be,{ref_key:"authFormRef",ref:y,model:a(w),rules:a(A),"label-position":"top",class:B(["am-asi__form",a(se)])},{default:L(()=>[(c(!0),C(ae,null,pe(a(S),(q,Q)=>(c(),U(pt(q.template),St({key:Q,ref_for:!0,ref:"customerCollectorRef",modelValue:a(w)[Q],"onUpdate:modelValue":G=>a(w)[Q]=G},q.props,{onEnter:ce}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),I(Te,{class:"am-asi__btn",type:a(i).signIn.options.signInBtn.buttonType,onClick:ce},{default:L(()=>[re(x(a(m).sign_in),1)]),_:1},8,["type"]),d("div",Tu,[d("span",Lu,x(a(m).forgot_your_password),1),d("span",{class:"am-asi__footer-link",onClick:ge[2]||(ge[2]=q=>we(f)?f.value="sendAccessLink":f="sendAccessLink")},x(a(m).reset_password),1)])],4))}}});const Au={class:"am-asi__top"},Iu={class:"am-asi__header"},$u={class:"am-asi__text"},Du={key:0,class:"am-asi__footer"},Pu={name:"AuthReset"},Nu=Object.assign(Pu,{setup(n){let t=De();const e=V("settings");let s=V("amCustomize");const l=V("labels"),i=V("localLanguage");let o=_(()=>e.general.usedLanguages.includes(i.value)),r=_(()=>{let k=Qe({...l}),T=s.value.accessLink.translations;return T&&Object.keys(T).forEach(E=>{T[E][i.value]&&o.value?k[E]=T[E][i.value]:T[E].default&&(k[E]=T[E].default)}),k}),u=O(null),m=O({email:_({get:()=>t.getters["auth/getEmail"],set:k=>{t.commit("auth/setEmail",k||"")}})}),h=O({email:[{required:!0,message:r.value.enter_email_warning,trigger:"submit"}]}),v=O({email:{template:Ye.text,props:{itemName:"email",itemType:"email",label:r.value.email,placeholder:"",class:"am-asi__item"}}}),g=V("pageKey"),b=V("cabinetType"),D=_(()=>t.getters.getLoading);function P(){u.value.validate(k=>{if(k)t.commit("setLoading",!0),Pe.post("/users/customers/reauthorize",{email:t.getters["auth/getEmail"],locale:window.localeLanguage[0],cabinetType:b.value}).then(()=>{g.value="sendAccessLinkProcess"}).catch(()=>{}).finally(()=>{t.commit("setLoading",!1)});else return!1})}let y=V("containerWidth"),w=_(()=>st(y.value)),A=V("amFonts"),S=V("amColors"),f=_(()=>({"--am-c-primary":S.value.colorPrimary,"--am-c-success":S.value.colorSuccess,"--am-c-error":S.value.colorError,"--am-c-warning":S.value.colorWarning,"--am-c-main-bgr":S.value.colorMainBgr,"--am-c-main-heading-text":S.value.colorMainHeadingText,"--am-c-main-text":S.value.colorMainText,"--am-c-main-text-op70":W(S.value.colorMainText,.7),"--am-c-main-text-op60":W(S.value.colorMainText,.6),"--am-c-main-text-op40":W(S.value.colorMainText,.4),"--am-c-main-text-op25":W(S.value.colorMainText,.25),"--am-c-inp-bgr":S.value.colorInpBgr,"--am-c-inp-border":S.value.colorInpBorder,"--am-c-inp-text":S.value.colorInpText,"--am-c-inp-placeholder":S.value.colorInpPlaceHolder,"--am-c-btn-prim":S.value.colorBtnPrim,"--am-c-btn-prim-text":S.value.colorBtnPrimText,"--am-c-skeleton-op20":W(S.value.colorMainText,.2),"--am-c-skeleton-op60":W(S.value.colorMainText,.6),"--am-font-family":A.value.fontFamily,"--am-c-scroll-op30":W(S.value.colorPrimary,.3),"--am-c-scroll-op10":W(S.value.colorPrimary,.1)}));return(k,T)=>{const E=et;return a(D)?(c(),U(a(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi"})):(c(),C("div",{key:0,class:"am-asi",style:ke(a(f))},[d("div",Au,[d("div",Iu,x(a(r).access_link_send),1),d("div",$u,x(a(r).access_link_send_description),1)]),I(E,{ref_key:"authFormRef",ref:u,model:a(m),rules:a(h),"label-position":"top",class:B(["am-asi__form",a(w)])},{default:L(()=>[(c(!0),C(ae,null,pe(a(v),($,R)=>(c(),U(pt($.template),St({key:R,ref_for:!0,ref:"customerCollectorRef",modelValue:a(m)[R],"onUpdate:modelValue":Y=>a(m)[R]=Y},$.props,{onEnter:P}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),I(Te,{class:"am-asi__btn",type:a(s).accessLink.options.sendBtn.buttonType,onClick:P},{default:L(()=>[re(x(a(r).send),1)]),_:1},8,["type"]),a(e).roles[a(b)+"Cabinet"].loginEnabled?(c(),C("div",Du,[d("span",{class:"am-asi__footer-link",onClick:T[0]||(T[0]=$=>we(g)?g.value="signIn":g="signIn")},x(a(r).sign_in),1)])):N("",!0)],4))}}});const Ou={class:"am-asi__top"},Mu={class:"am-asi__header"},Fu={class:"am-asi__text"},Vu={class:"am-asi__email"},Bu={class:"am-asi__footer"},Ru={class:"am-asi__footer-text"},qu={name:"AuthResetProcess"},Uu=Object.assign(qu,{setup(n){let t=De();const e=V("settings");let s=V("amCustomize");const l=V("labels"),i=V("localLanguage");let o=_(()=>e.general.usedLanguages.includes(i.value)),r=_(()=>{let b=Qe({...l}),D=s.value.accessLinkSuccess.translations;return D&&Object.keys(D).forEach(P=>{D[P][i.value]&&o.value?b[P]=D[P][i.value]:D[P].default&&(b[P]=D[P].default)}),b}),u=_(()=>t.getters["auth/getEmail"]),m=V("pageKey"),h=V("amFonts"),v=V("amColors"),g=_(()=>({"--am-c-primary":v.value.colorPrimary,"--am-c-success":v.value.colorSuccess,"--am-c-error":v.value.colorError,"--am-c-warning":v.value.colorWarning,"--am-c-main-bgr":v.value.colorMainBgr,"--am-c-main-heading-text":v.value.colorMainHeadingText,"--am-c-main-text":v.value.colorMainText,"--am-c-main-text-op70":W(v.value.colorMainText,.7),"--am-c-main-text-op60":W(v.value.colorMainText,.6),"--am-c-main-text-op40":W(v.value.colorMainText,.4),"--am-c-main-text-op25":W(v.value.colorMainText,.25),"--am-c-inp-bgr":v.value.colorInpBgr,"--am-c-inp-border":v.value.colorInpBorder,"--am-c-inp-text":v.value.colorInpText,"--am-c-inp-placeholder":v.value.colorInpPlaceHolder,"--am-c-btn-prim":v.value.colorBtnPrim,"--am-c-btn-prim-text":v.value.colorBtnPrimText,"--am-c-skeleton-op20":W(v.value.colorMainText,.2),"--am-c-skeleton-op60":W(v.value.colorMainText,.6),"--am-font-family":h.value.fontFamily,"--am-c-scroll-op30":W(v.value.colorPrimary,.3),"--am-c-scroll-op10":W(v.value.colorPrimary,.1)}));return(b,D)=>(c(),C("div",{class:"am-asi",style:ke(a(g))},[d("div",Ou,[d("div",Mu,x(a(r).access_link_send_check),1),d("div",Fu,x(a(r).access_link_send_click),1),d("div",Vu,x(a(u)),1)]),d("div",Bu,[d("span",Ru,x(a(r).access_link_send_inbox),1),d("span",{class:"am-asi__footer-link",onClick:D[0]||(D[0]=P=>we(m)?m.value="sendAccessLink":m="sendAccessLink")},x(a(r).access_link_send_retry),1)])],4))}});const zu={class:"am-asi__top"},ju={class:"am-asi__header"},Yu={class:"am-asi__text"},Wu={name:"AuthNewPass"},Hu=Object.assign(Wu,{setup(n){let t=De();const e=V("settings");let s=V("amCustomize");const l=V("labels"),i=V("localLanguage");let o=_(()=>e.general.usedLanguages.includes(i.value)),r=_(()=>{let f=Qe({...l}),k=s.value.setPass.translations;return k&&Object.keys(k).forEach(T=>{k[T][i.value]&&o.value?f[T]=k[T][i.value]:k[T].default&&(f[T]=k[T].default)}),f}),u=O(null),m=O({newPassword:_({get:()=>t.getters["auth/getNewPassword"],set:f=>{t.commit("auth/setNewPassword",f||"")}}),confirmPassword:_({get:()=>t.getters["auth/getConfirmPassword"],set:f=>{t.commit("auth/setConfirmPassword",f||"")}})}),h=O({newPassword:[{required:!0,message:r.value.new_password_required,trigger:"submit"},{min:4,message:r.value.new_password_length,trigger:"submit"}],confirmPassword:[{required:!0,message:r.value.new_password_required,trigger:"submit"},{min:4,message:r.value.new_password_length,trigger:"submit"},{validator:()=>t.getters["auth/getNewPassword"]===t.getters["auth/getConfirmPassword"],message:r.value.passwords_not_match,trigger:"submit"}]}),v=O({newPassword:{template:Ye.text,props:{itemName:"newPassword",itemType:"password",showPassword:!0,label:r.value.new_password_colon,placeholder:"",minLength:3,class:"am-asi__item"}},confirmPassword:{template:Ye.text,props:{itemName:"confirmPassword",itemType:"password",showPassword:!0,label:r.value.new_password_colon_retype,placeholder:"",minLength:3,class:"am-asi__item"}}}),g=V("cabinetType"),b=_(()=>t.getters.getLoading);function D(){u.value.validate(f=>{if(f&&t.getters["auth/getNewPassword"]===t.getters["auth/getConfirmPassword"]){let k=t.getters["auth/getProfile"];t.commit("setLoading",!0),Pe.post("/users/"+g.value+"s/"+k.id,{password:t.getters["auth/getNewPassword"]},Object.assign(ze(t),{params:{source:"cabinet-"+g.value}})).then(()=>{t.commit("auth/setAuthenticated",!0)}).catch(()=>{}).finally(()=>{t.commit("setLoading",!1)})}else return!1})}let P=V("containerWidth"),y=_(()=>st(P.value)),w=V("amFonts"),A=V("amColors"),S=_(()=>({"--am-c-primary":A.value.colorPrimary,"--am-c-success":A.value.colorSuccess,"--am-c-error":A.value.colorError,"--am-c-warning":A.value.colorWarning,"--am-c-main-bgr":A.value.colorMainBgr,"--am-c-main-heading-text":A.value.colorMainHeadingText,"--am-c-main-text":A.value.colorMainText,"--am-c-main-text-op70":W(A.value.colorMainText,.7),"--am-c-main-text-op60":W(A.value.colorMainText,.6),"--am-c-main-text-op40":W(A.value.colorMainText,.4),"--am-c-main-text-op25":W(A.value.colorMainText,.25),"--am-c-inp-bgr":A.value.colorInpBgr,"--am-c-inp-border":A.value.colorInpBorder,"--am-c-inp-text":A.value.colorInpText,"--am-c-inp-placeholder":A.value.colorInpPlaceHolder,"--am-c-btn-prim":A.value.colorBtnPrim,"--am-c-btn-prim-text":A.value.colorBtnPrimText,"--am-c-skeleton-op20":W(A.value.colorMainText,.2),"--am-c-skeleton-op60":W(A.value.colorMainText,.6),"--am-font-family":w.value.fontFamily,"--am-c-scroll-op30":W(A.value.colorPrimary,.3),"--am-c-scroll-op10":W(A.value.colorPrimary,.1)}));return(f,k)=>{const T=et;return a(b)?(c(),U(a(Wt),{key:1,count:4,"center-first":!0,"main-class":"am-asi"})):(c(),C("div",{key:0,class:"am-asi",style:ke(a(S))},[d("div",zu,[d("div",ju,x(a(r).new_password_set),1),d("div",Yu,x(a(r).new_password_set_description),1)]),I(T,{ref_key:"authFormRef",ref:u,model:a(m),rules:a(h),"label-position":"top",class:B(["am-asi__form",a(y)])},{default:L(()=>[(c(!0),C(ae,null,pe(a(v),(E,$)=>(c(),U(pt(E.template),St({key:$,ref_for:!0,ref:"customerCollectorRef",modelValue:a(m)[$],"onUpdate:modelValue":R=>a(m)[$]=R},E.props,{onEnter:D}),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]),I(Te,{class:"am-asi__btn",type:a(s).setPass.options.newPassBtn.buttonType,onClick:D},{default:L(()=>[re(x(a(r).new_password_set_action),1)]),_:1},8,["type"])],4))}}});const Zu={class:"am-asi__top"},Gu=d("div",{class:"am-asi__img"},[d("span",{class:"am-icon-check"})],-1),Ju={class:"am-asi__header"},Xu={class:"am-asi__text"},Qu={name:"ChangePassSuccess"},Ku=Object.assign(Qu,{setup(n){const t=V("settings");let e=V("amCustomize");const s=V("labels"),l=V("localLanguage");let i=_(()=>t.general.usedLanguages.includes(l.value)),o=_(()=>{let v=Qe({...s}),g=e.value.setPassSuccess.translations;return g&&Object.keys(g).forEach(b=>{g[b][l.value]&&i.value?v[b]=g[b][l.value]:g[b].default&&(v[b]=g[b].default)}),v}),r=V("pageKey"),u=V("amFonts"),m=V("amColors"),h=_(()=>({"--am-c-primary":m.value.colorPrimary,"--am-c-success":m.value.colorSuccess,"--am-c-error":m.value.colorError,"--am-c-warning":m.value.colorWarning,"--am-c-main-bgr":m.value.colorMainBgr,"--am-c-main-heading-text":m.value.colorMainHeadingText,"--am-c-main-text":m.value.colorMainText,"--am-c-main-text-op70":W(m.value.colorMainText,.7),"--am-c-main-text-op60":W(m.value.colorMainText,.6),"--am-c-main-text-op40":W(m.value.colorMainText,.4),"--am-c-main-text-op25":W(m.value.colorMainText,.25),"--am-c-btn-prim":m.value.colorBtnPrim,"--am-c-btn-prim-text":m.value.colorBtnPrimText,"--am-c-skeleton-op20":W(m.value.colorMainText,.2),"--am-c-skeleton-op60":W(m.value.colorMainText,.6),"--am-font-family":u.value.fontFamily,"--am-c-scroll-op30":W(m.value.colorPrimary,.3),"--am-c-scroll-op10":W(m.value.colorPrimary,.1)}));return(v,g)=>(c(),C("div",{class:"am-asi",style:ke(a(h))},[d("div",Zu,[Gu,d("div",Ju,x(a(o).new_password_changed),1),d("div",Xu,x(a(o).new_password_changed_description),1)]),I(Te,{class:"am-asi__btn",type:a(e).setPassSuccess.options.signInBtn.buttonType,onClick:g[0]||(g[0]=b=>we(r)?r.value="signIn":r="signIn")},{default:L(()=>[re(x(a(o).sign_in),1)]),_:1},8,["type"])],4))}}),ed={name:"AuthWrapper"},td=Object.assign(ed,{setup(n){const t=V("settings");let e=O({signIn:Ge(Su),sendAccessLink:Ge(Nu),sendAccessLinkProcess:Ge(Uu),setPassword:Ge(Hu),changeSuccess:Ge(Ku)}),s=V("originKey"),l=O("signIn");Re("pageKey",l);const i=O(t.customizedData?t.customizedData.fonts:Sl.fonts);Re("amFonts",i);let o=_(()=>t.customizedData&&s.value in t.customizedData?t.customizedData[s.value].colors:Sl[s.value].colors);return Re("amColors",o),(r,u)=>(c(),U(pt(a(e)[a(l)])))}});const ad={class:"am-csd__inner"},sd={class:"am-csd__header"},ld={class:"am-csd__header-text"},nd={class:"am-csd__content"},id={class:"am-csd__footer"},od={name:"DeleteProfile"},rd=Object.assign(od,{props:{visibility:{type:Boolean,required:!0},customizedLabels:{type:Object,default:()=>({})},customizedOptions:{type:Object,default:()=>({})}},emits:["close","deleteProfile"],setup(n,{emit:t}){const e=n;let s=V("containerWidth");const l=V("labels");function i(m){return Object.keys(e.customizedLabels).length&&e.customizedLabels[m]?e.customizedLabels[m]:l[m]}let o=V("amFonts"),r=V("amColors"),u=_(()=>({"--am-c-csd-text":r.value.colorMainText,"--am-c-csd-bgr":r.value.colorMainBgr,"--am-c-csd-text-op10":W(r.value.colorMainText,.1),"--am-font-family":o.value.fontFamily}));return(m,h)=>(c(),U(za,{visibility:a(e).visibility,"custom-class":"am-csd am-csd__cancel",style:ke(a(u)),position:"center"},{footer:L(()=>[d("div",id,[I(Te,{category:"secondary",size:a(s)<=360?"small":"default",type:a(e).customizedOptions.closeBtn.buttonType,onClick:h[1]||(h[1]=()=>{t("close")})},{default:L(()=>[re(x(i("close")),1)]),_:1},8,["size","type"]),I(Te,{category:"danger",size:a(s)<=360?"small":"default","loading-icon":"loading",type:a(e).customizedOptions.confirmBtn.buttonType,onClick:h[2]||(h[2]=()=>{t("deleteProfile")})},{default:L(()=>[re(x(i("delete")),1)]),_:1},8,["size","type"])])]),default:L(()=>[d("div",ad,[d("div",sd,[d("div",ld,x(i("delete_profile")),1),d("div",{class:"am-csd__header-btn",onClick:h[0]||(h[0]=()=>{t("close")})},[I(We,{icon:"close"})])]),d("div",nd,[d("p",null,x(i("delete_profile_description")),1)])])]),_:1},8,["visibility","style"]))}});const Tl={props:{pageWidth:{type:Number,default:768},count:{type:[Number,String],default:2},itemDirection:{type:String,default:"row",validator(n){return["row","row-reverse","column","column-reverse","initial","revert","unset"].includes(n)}}},setup(n){const t=n;let e=_(()=>st(t.pageWidth)),s=V("amColors"),l=_(()=>({"--am-c-skeleton-op20":W(s.value.colorMainText,.2),"--am-c-skeleton-op60":W(s.value.colorMainText,.6),"--am-c-flex-direction":t.itemDirection}));return(i,o)=>{const r=Fl,u=Vl;return c(),U(u,{animated:"",class:"am-cps",style:ke(a(l))},{template:L(()=>[(c(!0),C(ae,null,pe(new Array(a(t).count),m=>(c(),C("div",{key:m,class:B(["am-cps__item",a(e)])},[I(r,{class:"am-cps__item-label",variant:"rect"}),I(r,{class:"am-cps__item-input",variant:"rect"})],2))),128))]),_:1},8,["style"])}}};const cd={class:"am-capi__inner"},ud=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),dd={name:"CabinetProfile",key:"profile"},md=Object.assign(dd,{setup(n){let t=De(),e=_(()=>t.getters.getLoading),s=O(null),l=O(0),i=V("sidebarCollapsed");window.addEventListener("resize",o);function o(){s.value&&(l.value=s.value.offsetWidth)}it(i,fe=>{fe?setTimeout(()=>{r()},1500):setTimeout(()=>{r()},500)});function r(){l.value=s.value.offsetWidth}Je(()=>{di(()=>{l.value=s.value.offsetWidth}),ye()});let u=_(()=>st(l.value));const m=V("settings");let h=V("cabinetType"),v=V("amCustomize");const g=V("labels"),b=V("localLanguage");let D=_(()=>m.general.usedLanguages.includes(b.value));function P(fe,Le){return Le&&Object.keys(Le).forEach(Ne=>{Le[Ne][b.value]&&D.value?fe[Ne]=Le[Ne][b.value]:Le[Ne].default&&(fe[Ne]=Le[Ne].default)}),fe}let y=_(()=>{let fe=Qe({...g}),Le=v.value.profile.translations;return P(fe,Le)});function w(fe){let Le={},Ne=v.value[fe].translations;return P(Le,Ne)}let A=_(()=>v.value.profile.options),S=O("first"),f=O("");function k(){le.value=!1,f.value=""}let T=O(null),E=O(!1),$=O({firstName:_({get:()=>t.getters["auth/getProfile"].firstName,set:fe=>{t.commit("auth/setProfileFirstName",fe||"")}}),lastName:_({get:()=>t.getters["auth/getProfile"].lastName,set:fe=>{t.commit("auth/setProfileLastName",fe||"")}}),email:_({get:()=>t.getters["auth/getProfile"].email,set:fe=>{t.commit("auth/setProfileEmail",fe||"")}}),phone:_({get:()=>t.getters["auth/getProfile"].phone,set:fe=>{t.commit("auth/setProfilePhone",fe||"")}}),birthday:_({get:()=>t.getters["auth/getProfile"].birthday?t.getters["auth/getProfile"].birthday:"",set:fe=>{t.commit("auth/setProfileBirthday",fe?me(fe).format("YYYY-MM-DD"):"")}})}),R=O({firstName:{template:Ye.text,props:{itemName:"firstName",label:y.value.first_name_colon,placeholder:y.value.enter_first_name,class:_(()=>`am-capi__item ${u.value}`)}},lastName:{template:Ye.text,props:{itemName:"lastName",label:y.value.last_name_colon,placeholder:y.value.enter_last_name,class:_(()=>`am-capi__item ${u.value}`)}},email:{template:Ye.text,props:{itemName:"email",label:y.value.email_colon,placeholder:y.value.enter_email,class:_(()=>`am-capi__item ${u.value}`)}},phone:{countryPhoneIso:_({get:()=>t.getters["auth/getProfile"].countryPhoneIso?t.getters["auth/getProfile"].countryPhoneIso:"",set:fe=>{t.commit("auth/setProfileCountryPhoneIso",fe?fe.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:y.value.phone_colon,placeholder:y.value.enter_phone,defaultCode:_(()=>t.getters["auth/getProfile"].countryPhoneIso?t.getters["auth/getProfile"].countryPhoneIso:""),phoneError:_(()=>E.value),whatsAppLabel:y.value.whatsapp_opt_in_text,isWhatsApp:m.notifications.whatsAppEnabled&&m.notifications.whatsAppAccessToken&&m.notifications.whatsAppBusinessID&&m.notifications.whatsAppPhoneID,class:_(()=>`am-capi__item ${u.value}`)}},birthday:{template:Ye.datepicker,props:{itemName:"birthday",label:y.value.date_of_birth,placeholder:y.value.enter_date_of_birth,clearable:!0,readonly:!1,class:_(()=>`am-capi__item am-capi__item-birthday ${u.value}`)}}}),Y=O({firstName:[{required:!0,message:y.value.enter_first_name_warning,trigger:"submit"}],lastName:[{required:A.value.lastName.required,message:y.value.enter_last_name_warning,trigger:"submit"}],email:[{required:A.value.email.required,type:"email",message:y.value.enter_valid_email_warning,trigger:"submit"}],phone:[{required:A.value.phone.required,message:y.value.enter_phone_warning,trigger:"submit"}],birthday:[{required:A.value.birthday.required,message:y.value.enter_date_of_birth_warning,trigger:"submit"}]}),M=O(!1);Re("deleteProfileDialog",M);function K(){t.commit("auth/setProfileFirstName",$.value.firstName?$.value.firstName.trim():""),t.commit("auth/setProfileLastName",$.value.lastName?$.value.lastName.trim():""),t.commit("auth/setProfileEmail",$.value.email?$.value.email.trim():""),T.value.validate(fe=>{if(fe){f.value=y.value.profile_data_success;let Le=t.getters["auth/getProfile"];t.commit("setLoading",!0),Pe.post("/users/"+h.value+"s/"+Le.id,Le,ze(t)).finally(()=>{t.commit("setLoading",!1),le.value=!0,A.value.phone.required&&$.value.phone&&(E.value=!1)})}else return A.value.phone.required&&!$.value.phone&&(E.value=!0),!1})}Re("saveProfileChanges",K);let ce=O(null),j=O({newPass:_({get:()=>t.getters["auth/getNewPassword"],set:fe=>{t.commit("auth/setNewPassword",fe||"")}}),confirmPass:_({get:()=>t.getters["auth/getConfirmPassword"],set:fe=>{t.commit("auth/setConfirmPassword",fe||"")}})}),ie=O({newPass:{template:Ye.text,props:{itemName:"newPass",itemType:"password",showPassword:!0,label:y.value.new_password_colon,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${u.value}`)}},confirmPass:{template:Ye.text,props:{itemName:"confirmPass",itemType:"password",showPassword:!0,label:y.value.new_password_colon_retype,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${u.value}`)}}}),se=O({newPass:[{required:!0,message:y.value.new_password_required,trigger:"submit"},{min:4,message:y.value.new_password_length,trigger:"submit"}],confirmPass:[{required:!0,message:y.value.new_password_required,trigger:"submit"},{min:4,message:y.value.new_password_length,trigger:"submit"},{validator:()=>t.getters["auth/getNewPassword"]===t.getters["auth/getConfirmPassword"],message:y.value.passwords_not_match,trigger:"submit"}]}),le=O(!1);function te(){le.value=!1}function ne(){ce.value.validate(fe=>{if(fe){let Le=t.getters["auth/getProfile"];t.commit("setLoading",!0),Pe.post("/users/customers/"+Le.id,{password:t.getters["auth/getNewPassword"]},ze(t)).then(()=>{f.value=y.value.password_success,t.commit("auth/setNewPassword",""),t.commit("auth/setConfirmPassword","")}).catch(()=>{}).finally(()=>{t.commit("setLoading",!1),le.value=!0})}else return!1})}Re("changeProfilePassword",ne);function Z(){M.value=!1,t.commit("auth/setProfileDeleted",!0),t.dispatch("auth/logout")}function ge(){t.commit("setLoading",!0);let fe=t.getters["auth/getProfile"]?t.getters["auth/getProfile"].id:null;if(!fe)return;let Le={email:"",firstName:y.value.customer,lastName:fe,phone:"",birthday:"",gender:"",externalId:"",password:""};const Ne=Ml().cookies;Pe.post("/users/customers/"+fe,Object.assign(ze(t),Le)).then(()=>{t.commit("auth/setProfile",{}),Ne.remove("ameliaUserEmail"),t.commit("setLoading",!1),Z()}).catch(Me=>{t.commit("setLoading",!1),console.log(Me)})}const be=O(null),q=Qe({}),Q=Qe({}),G=Qe({}),H=Qe({});function J(fe,Le,Ne){q[Le]=Ne??""}function X(fe,Le){if(G[Le]={template:Ye[fe.type],props:{id:Le,itemName:Le.toString(),label:fe.label,options:fe.options,class:`am-capei-att-cf__item am-cf-width-${fe.width}`}},fe.type==="text-area"&&(G[Le].props.itemType="textarea"),fe.type==="datepicker"&&(G[Le].props.weekStartsFromDay=m.wordpress.startOfWeek),fe.type==="file"){let Ne=t.getters["auth/getProfile"]?t.getters["auth/getProfile"].id:null;G[Le].props={...G[Le].props,btnLabel:y.value.upload_file_here,isUpload:!0,bookingId:Ne,source:"cabinet-customer"}}}function ve(fe){Q[fe.id]=[{message:y.value.required_field,required:fe.required,trigger:["submit","change"]}]}function ye(){const fe=t.getters["entities/getCustomFields"],Le=JSON.parse(t.getters["auth/getProfile"].customFields||"{}");fe.filter(Ne=>Ne.saveType==="customer"&&Ne.type!=="content").sort((Ne,Me)=>Ne.position-Me.position).forEach(Ne=>{const{position:Me,id:Be}=Ne,Ce=Le[Be]?.value;H[Me]={...Ne,value:Ce??(Ne.type==="checkbox"||Ne.type==="file"?[]:"")},J(Ne,Be,H[Me].value),X(Ne,Be),ve(Ne)})}function _e(){be.value.validate(fe=>{if(fe){const Le=t.getters["auth/getProfile"],Ne={};for(const Be in H){const Ce=H[Be],qe=q[Ce.id];Ne[Ce.id]={label:Ce.label,type:Ce.type,value:typeof qe=="string"?qe.trim():qe}}const Me={...Le,customFields:JSON.stringify(Ne)};t.commit("setLoading",!0),Pe.post(`/users/${h.value}s/${Le.id}`,Me,ze(t)).finally(()=>{t.commit("setLoading",!1),f.value=y.value.profile_data_success,le.value=!0})}else return!1})}Re("saveCustomerCustomFields",_e);let Se=V("amColors"),Oe=_(()=>({"--am-c-capi-primary":Se.value.colorPrimary,"--am-c-capi-text":Se.value.colorMainText,"--am-c-capi-text-op10":W(Se.value.colorMainText,.1)}));return(fe,Le)=>{const Ne=et,Me=Ia,Be=$a;return c(),C("div",{ref_key:"pageContainer",ref:s,class:"am-capi",style:ke(a(Oe))},[d("div",cd,[a(le)?(c(),U(xt,{key:0,type:"success","show-border":!0,"close-after":5e3,"custom-class":"am-capi__alert",onClose:k,onTriggerClose:k},{title:L(()=>[ud,re(" "+x(a(f)),1)]),_:1})):N("",!0),I(Be,{modelValue:a(S),"onUpdate:modelValue":Le[0]||(Le[0]=Ce=>we(S)?S.value=Ce:S=Ce),class:"am-capi__tabs",onTabClick:te},{default:L(()=>[I(Me,{class:"am-capi__tabs-item",label:a(y).personal_info,name:"first"},{default:L(()=>[a(e)?(c(),U(Tl,{key:1,count:5,"page-width":a(l)},null,8,["page-width"])):(c(),C(ae,{key:0},[a(t).getters["auth/getProfile"]?(c(),U(Ne,{key:0,ref_key:"infoFormRef",ref:T,model:a($),rules:a(Y),"label-position":"top",class:B(["am-capi__form",a(u)])},{default:L(()=>[(c(!0),C(ae,null,pe(a(v).profile.order,Ce=>(c(),C(ae,{key:Ce.id},[!a(A)[Ce.id]||a(A)[Ce.id].visibility?(c(),U(pt(a(R)[Ce.id].template),St({key:0,ref_for:!0,ref:"customerCollectorRef",modelValue:a($)[Ce.id],"onUpdate:modelValue":qe=>a($)[Ce.id]=qe,countryPhoneIso:a(R)[Ce.id].countryPhoneIso,"onUpdate:countryPhoneIso":qe=>a(R)[Ce.id].countryPhoneIso=qe},a(R)[Ce.id].props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"])):N("",!0)],64))),128))]),_:1},8,["model","rules","class"])):N("",!0)],64))]),_:1},8,["label"]),Object.keys(a(H)).length?(c(),U(Me,{key:0,label:a(y).custom_fields,name:"third"},{default:L(()=>[a(e)?(c(),U(Tl,{key:1,count:Object.keys(a(H)).length,"page-width":a(l)},null,8,["count","page-width"])):(c(),U(Ne,{key:0,ref_key:"customFieldsFormRef",ref:be,model:a(q),rules:a(Q),"label-position":"top",class:B(["am-capei-att-cf__form",a(u)])},{default:L(()=>[(c(!0),C(ae,null,pe(Object.values(a(H)),Ce=>(c(),C(ae,{key:Ce.id},[Ce.id in a(q)?(c(),U(pt(a(G)[Ce.id]?.template),St({key:0,modelValue:a(q)[Ce.id],"onUpdate:modelValue":qe=>a(q)[Ce.id]=qe},a(G)[Ce.id]?.props),null,16,["modelValue","onUpdate:modelValue"])):N("",!0)],64))),128))]),_:1},8,["model","rules","class"]))]),_:1},8,["label"])):N("",!0),I(Me,{class:"am-capi__tabs-item",label:a(y).password_tab,name:"second"},{default:L(()=>[a(e)?(c(),U(Tl,{key:1,"item-direction":"column",count:2,"page-width":a(l)},null,8,["page-width"])):(c(),U(Ne,{key:0,ref_key:"passFormRef",ref:ce,model:a(j),rules:a(se),"label-position":"top",class:B(["am-capi__form",a(u)])},{default:L(()=>[(c(!0),C(ae,null,pe(a(ie),(Ce,qe)=>(c(),U(pt(Ce.template),St({key:Ce.props.itemName,ref_for:!0,ref:"customerPassCollectorRef",modelValue:a(j)[qe],"onUpdate:modelValue":ee=>a(j)[qe]=ee},Ce.props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"]))]),_:1},8,["label"])]),_:1},8,["modelValue"]),I(rd,{visibility:a(M),"customized-labels":w("deleteProfile"),"customized-options":a(v).deleteProfile.options,onClose:Le[1]||(Le[1]=Ce=>we(M)?M.value=!1:M=!1),onDeleteProfile:ge},null,8,["visibility","customized-labels","customized-options"]),I(vc,{loading:a(e),display:a(S),"parent-width":a(l),"customized-labels":a(y),"save-footer-button":a(A).saveFooterButton.buttonType,"delete-footer-type":a(A).deleteFooterButton.buttonType,"pass-footer-button":a(A).passFooterButton.buttonType},null,8,["loading","display","parent-width","customized-labels","save-footer-button","delete-footer-type","pass-footer-button"])])],4)}}});var Ie=(n=>(n[n.TYPE=3]="TYPE",n[n.LEVEL=12]="LEVEL",n[n.ATTRIBUTE=13]="ATTRIBUTE",n[n.BLOT=14]="BLOT",n[n.INLINE=7]="INLINE",n[n.BLOCK=11]="BLOCK",n[n.BLOCK_BLOT=10]="BLOCK_BLOT",n[n.INLINE_BLOT=6]="INLINE_BLOT",n[n.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",n[n.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",n[n.ANY=15]="ANY",n))(Ie||{});class oa{constructor(t,e,s={}){this.attrName=t,this.keyName=e;const l=Ie.TYPE&Ie.ATTRIBUTE;this.scope=s.scope!=null?s.scope&Ie.LEVEL|l:Ie.ATTRIBUTE,s.whitelist!=null&&(this.whitelist=s.whitelist)}static keys(t){return Array.from(t.attributes).map(e=>e.name)}add(t,e){return this.canAdd(t,e)?(t.setAttribute(this.keyName,e),!0):!1}canAdd(t,e){return this.whitelist==null?!0:typeof e=="string"?this.whitelist.indexOf(e.replace(/["']/g,""))>-1:this.whitelist.indexOf(e)>-1}remove(t){t.removeAttribute(this.keyName)}value(t){const e=t.getAttribute(this.keyName);return this.canAdd(t,e)&&e?e:""}}class gs extends Error{constructor(t){t="[Parchment] "+t,super(t),this.message=t,this.name=this.constructor.name}}const Do=class Jn{constructor(){this.attributes={},this.classes={},this.tags={},this.types={}}static find(t,e=!1){if(t==null)return null;if(this.blots.has(t))return this.blots.get(t)||null;if(e){let s=null;try{s=t.parentNode}catch{return null}return this.find(s,e)}return null}create(t,e,s){const l=this.query(e);if(l==null)throw new gs(`Unable to create ${e} blot`);const i=l,o=e instanceof Node||e.nodeType===Node.TEXT_NODE?e:i.create(s),r=new i(t,o,s);return Jn.blots.set(r.domNode,r),r}find(t,e=!1){return Jn.find(t,e)}query(t,e=Ie.ANY){let s;return typeof t=="string"?s=this.types[t]||this.attributes[t]:t instanceof Text||t.nodeType===Node.TEXT_NODE?s=this.types.text:typeof t=="number"?t&Ie.LEVEL&Ie.BLOCK?s=this.types.block:t&Ie.LEVEL&Ie.INLINE&&(s=this.types.inline):t instanceof Element&&((t.getAttribute("class")||"").split(/\s+/).some(l=>(s=this.classes[l],!!s)),s=s||this.tags[t.tagName]),s==null?null:"scope"in s&&e&Ie.LEVEL&s.scope&&e&Ie.TYPE&s.scope?s:null}register(...t){return t.map(e=>{const s="blotName"in e,l="attrName"in e;if(!s&&!l)throw new gs("Invalid definition");if(s&&e.blotName==="abstract")throw new gs("Cannot register abstract class");const i=s?e.blotName:l?e.attrName:void 0;return this.types[i]=e,l?typeof e.keyName=="string"&&(this.attributes[e.keyName]=e):s&&(e.className&&(this.classes[e.className]=e),e.tagName&&(Array.isArray(e.tagName)?e.tagName=e.tagName.map(o=>o.toUpperCase()):e.tagName=e.tagName.toUpperCase(),(Array.isArray(e.tagName)?e.tagName:[e.tagName]).forEach(o=>{(this.tags[o]==null||e.className==null)&&(this.tags[o]=e)}))),e})}};Do.blots=new WeakMap;let _s=Do;function Ui(n,t){return(n.getAttribute("class")||"").split(/\s+/).filter(e=>e.indexOf(`${t}-`)===0)}class pd extends oa{static keys(t){return(t.getAttribute("class")||"").split(/\s+/).map(e=>e.split("-").slice(0,-1).join("-"))}add(t,e){return this.canAdd(t,e)?(this.remove(t),t.classList.add(`${this.keyName}-${e}`),!0):!1}remove(t){Ui(t,this.keyName).forEach(e=>{t.classList.remove(e)}),t.classList.length===0&&t.removeAttribute("class")}value(t){const e=(Ui(t,this.keyName)[0]||"").slice(this.keyName.length+1);return this.canAdd(t,e)?e:""}}const ea=pd;function Fn(n){const t=n.split("-"),e=t.slice(1).map(s=>s[0].toUpperCase()+s.slice(1)).join("");return t[0]+e}class gd extends oa{static keys(t){return(t.getAttribute("style")||"").split(";").map(e=>e.split(":")[0].trim())}add(t,e){return this.canAdd(t,e)?(t.style[Fn(this.keyName)]=e,!0):!1}remove(t){t.style[Fn(this.keyName)]="",t.getAttribute("style")||t.removeAttribute("style")}value(t){const e=t.style[Fn(this.keyName)];return this.canAdd(t,e)?e:""}}const Da=gd;class fd{constructor(t){this.attributes={},this.domNode=t,this.build()}attribute(t,e){e?t.add(this.domNode,e)&&(t.value(this.domNode)!=null?this.attributes[t.attrName]=t:delete this.attributes[t.attrName]):(t.remove(this.domNode),delete this.attributes[t.attrName])}build(){this.attributes={};const t=_s.find(this.domNode);if(t==null)return;const e=oa.keys(this.domNode),s=ea.keys(this.domNode),l=Da.keys(this.domNode);e.concat(s).concat(l).forEach(i=>{const o=t.scroll.query(i,Ie.ATTRIBUTE);o instanceof oa&&(this.attributes[o.attrName]=o)})}copy(t){Object.keys(this.attributes).forEach(e=>{const s=this.attributes[e].value(this.domNode);t.format(e,s)})}move(t){this.copy(t),Object.keys(this.attributes).forEach(e=>{this.attributes[e].remove(this.domNode)}),this.attributes={}}values(){return Object.keys(this.attributes).reduce((t,e)=>(t[e]=this.attributes[e].value(this.domNode),t),{})}}const ql=fd,Po=class{constructor(t,e){this.scroll=t,this.domNode=e,_s.blots.set(e,this),this.prev=null,this.next=null}static create(t){if(this.tagName==null)throw new gs("Blot definition missing tagName");let e,s;return Array.isArray(this.tagName)?(typeof t=="string"?(s=t.toUpperCase(),parseInt(s,10).toString()===s&&(s=parseInt(s,10))):typeof t=="number"&&(s=t),typeof s=="number"?e=document.createElement(this.tagName[s-1]):s&&this.tagName.indexOf(s)>-1?e=document.createElement(s):e=document.createElement(this.tagName[0])):e=document.createElement(this.tagName),this.className&&e.classList.add(this.className),e}get statics(){return this.constructor}attach(){}clone(){const t=this.domNode.cloneNode(!1);return this.scroll.create(t)}detach(){this.parent!=null&&this.parent.removeChild(this),_s.blots.delete(this.domNode)}deleteAt(t,e){this.isolate(t,e).remove()}formatAt(t,e,s,l){const i=this.isolate(t,e);if(this.scroll.query(s,Ie.BLOT)!=null&&l)i.wrap(s,l);else if(this.scroll.query(s,Ie.ATTRIBUTE)!=null){const o=this.scroll.create(this.statics.scope);i.wrap(o),o.format(s,l)}}insertAt(t,e,s){const l=s==null?this.scroll.create("text",e):this.scroll.create(e,s),i=this.split(t);this.parent.insertBefore(l,i||void 0)}isolate(t,e){const s=this.split(t);if(s==null)throw new Error("Attempt to isolate at end");return s.split(e),s}length(){return 1}offset(t=this.parent){return this.parent==null||this===t?0:this.parent.children.offset(this)+this.parent.offset(t)}optimize(t){this.statics.requiredContainer&&!(this.parent instanceof this.statics.requiredContainer)&&this.wrap(this.statics.requiredContainer.blotName)}remove(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()}replaceWith(t,e){const s=typeof t=="string"?this.scroll.create(t,e):t;return this.parent!=null&&(this.parent.insertBefore(s,this.next||void 0),this.remove()),s}split(t,e){return t===0?this:this.next}update(t,e){}wrap(t,e){const s=typeof t=="string"?this.scroll.create(t,e):t;if(this.parent!=null&&this.parent.insertBefore(s,this.next||void 0),typeof s.appendChild!="function")throw new gs(`Cannot wrap ${t}`);return s.appendChild(this),s}};Po.blotName="abstract";let No=Po;const Oo=class extends No{static value(t){return!0}index(t,e){return this.domNode===t||this.domNode.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(e,1):-1}position(t,e){let s=Array.from(this.parent.domNode.childNodes).indexOf(this.domNode);return t>0&&(s+=1),[this.parent.domNode,s]}value(){return{[this.statics.blotName]:this.statics.value(this.domNode)||!0}}};Oo.scope=Ie.INLINE_BLOT;let hd=Oo;const Ct=hd;class _d{constructor(){this.head=null,this.tail=null,this.length=0}append(...t){if(this.insertBefore(t[0],null),t.length>1){const e=t.slice(1);this.append(...e)}}at(t){const e=this.iterator();let s=e();for(;s&&t>0;)t-=1,s=e();return s}contains(t){const e=this.iterator();let s=e();for(;s;){if(s===t)return!0;s=e()}return!1}indexOf(t){const e=this.iterator();let s=e(),l=0;for(;s;){if(s===t)return l;l+=1,s=e()}return-1}insertBefore(t,e){t!=null&&(this.remove(t),t.next=e,e!=null?(t.prev=e.prev,e.prev!=null&&(e.prev.next=t),e.prev=t,e===this.head&&(this.head=t)):this.tail!=null?(this.tail.next=t,t.prev=this.tail,this.tail=t):(t.prev=null,this.head=this.tail=t),this.length+=1)}offset(t){let e=0,s=this.head;for(;s!=null;){if(s===t)return e;e+=s.length(),s=s.next}return-1}remove(t){this.contains(t)&&(t.prev!=null&&(t.prev.next=t.next),t.next!=null&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev),this.length-=1)}iterator(t=this.head){return()=>{const e=t;return t!=null&&(t=t.next),e}}find(t,e=!1){const s=this.iterator();let l=s();for(;l;){const i=l.length();if(t<i||e&&t===i&&(l.next==null||l.next.length()!==0))return[l,t];t-=i,l=s()}return[null,0]}forEach(t){const e=this.iterator();let s=e();for(;s;)t(s),s=e()}forEachAt(t,e,s){if(e<=0)return;const[l,i]=this.find(t);let o=t-i;const r=this.iterator(l);let u=r();for(;u&&o<t+e;){const m=u.length();t>o?s(u,t-o,Math.min(e,o+m-t)):s(u,0,Math.min(m,t+e-o)),o+=m,u=r()}}map(t){return this.reduce((e,s)=>(e.push(t(s)),e),[])}reduce(t,e){const s=this.iterator();let l=s();for(;l;)e=t(e,l),l=s();return e}}function zi(n,t){const e=t.find(n);if(e)return e;try{return t.create(n)}catch{const s=t.create(Ie.INLINE);return Array.from(n.childNodes).forEach(l=>{s.domNode.appendChild(l)}),n.parentNode&&n.parentNode.replaceChild(s.domNode,n),s.attach(),s}}const Mo=class Ca extends No{constructor(t,e){super(t,e),this.uiNode=null,this.build()}appendChild(t){this.insertBefore(t)}attach(){super.attach(),this.children.forEach(t=>{t.attach()})}attachUI(t){this.uiNode!=null&&this.uiNode.remove(),this.uiNode=t,Ca.uiClass&&this.uiNode.classList.add(Ca.uiClass),this.uiNode.setAttribute("contenteditable","false"),this.domNode.insertBefore(this.uiNode,this.domNode.firstChild)}build(){this.children=new _d,Array.from(this.domNode.childNodes).filter(t=>t!==this.uiNode).reverse().forEach(t=>{try{const e=zi(t,this.scroll);this.insertBefore(e,this.children.head||void 0)}catch(e){if(e instanceof gs)return;throw e}})}deleteAt(t,e){if(t===0&&e===this.length())return this.remove();this.children.forEachAt(t,e,(s,l,i)=>{s.deleteAt(l,i)})}descendant(t,e=0){const[s,l]=this.children.find(e);return t.blotName==null&&t(s)||t.blotName!=null&&s instanceof t?[s,l]:s instanceof Ca?s.descendant(t,l):[null,-1]}descendants(t,e=0,s=Number.MAX_VALUE){let l=[],i=s;return this.children.forEachAt(e,s,(o,r,u)=>{(t.blotName==null&&t(o)||t.blotName!=null&&o instanceof t)&&l.push(o),o instanceof Ca&&(l=l.concat(o.descendants(t,r,i))),i-=u}),l}detach(){this.children.forEach(t=>{t.detach()}),super.detach()}enforceAllowedChildren(){let t=!1;this.children.forEach(e=>{t||this.statics.allowedChildren.some(s=>e instanceof s)||(e.statics.scope===Ie.BLOCK_BLOT?(e.next!=null&&this.splitAfter(e),e.prev!=null&&this.splitAfter(e.prev),e.parent.unwrap(),t=!0):e instanceof Ca?e.unwrap():e.remove())})}formatAt(t,e,s,l){this.children.forEachAt(t,e,(i,o,r)=>{i.formatAt(o,r,s,l)})}insertAt(t,e,s){const[l,i]=this.children.find(t);if(l)l.insertAt(i,e,s);else{const o=s==null?this.scroll.create("text",e):this.scroll.create(e,s);this.appendChild(o)}}insertBefore(t,e){t.parent!=null&&t.parent.children.remove(t);let s=null;this.children.insertBefore(t,e||null),t.parent=this,e!=null&&(s=e.domNode),(this.domNode.parentNode!==t.domNode||this.domNode.nextSibling!==s)&&this.domNode.insertBefore(t.domNode,s),t.attach()}length(){return this.children.reduce((t,e)=>t+e.length(),0)}moveChildren(t,e){this.children.forEach(s=>{t.insertBefore(s,e)})}optimize(t){if(super.optimize(t),this.enforceAllowedChildren(),this.uiNode!=null&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length===0)if(this.statics.defaultChild!=null){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove()}path(t,e=!1){const[s,l]=this.children.find(t,e),i=[[this,t]];return s instanceof Ca?i.concat(s.path(l,e)):(s!=null&&i.push([s,l]),i)}removeChild(t){this.children.remove(t)}replaceWith(t,e){const s=typeof t=="string"?this.scroll.create(t,e):t;return s instanceof Ca&&this.moveChildren(s),super.replaceWith(s)}split(t,e=!1){if(!e){if(t===0)return this;if(t===this.length())return this.next}const s=this.clone();return this.parent&&this.parent.insertBefore(s,this.next||void 0),this.children.forEachAt(t,this.length(),(l,i,o)=>{const r=l.split(i,e);r!=null&&s.appendChild(r)}),s}splitAfter(t){const e=this.clone();for(;t.next!=null;)e.appendChild(t.next);return this.parent&&this.parent.insertBefore(e,this.next||void 0),e}unwrap(){this.parent&&this.moveChildren(this.parent,this.next||void 0),this.remove()}update(t,e){const s=[],l=[];t.forEach(i=>{i.target===this.domNode&&i.type==="childList"&&(s.push(...i.addedNodes),l.push(...i.removedNodes))}),l.forEach(i=>{if(i.parentNode!=null&&i.tagName!=="IFRAME"&&document.body.compareDocumentPosition(i)&Node.DOCUMENT_POSITION_CONTAINED_BY)return;const o=this.scroll.find(i);o!=null&&(o.domNode.parentNode==null||o.domNode.parentNode===this.domNode)&&o.detach()}),s.filter(i=>i.parentNode===this.domNode&&i!==this.uiNode).sort((i,o)=>i===o?0:i.compareDocumentPosition(o)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1).forEach(i=>{let o=null;i.nextSibling!=null&&(o=this.scroll.find(i.nextSibling));const r=zi(i,this.scroll);(r.next!==o||r.next==null)&&(r.parent!=null&&r.parent.removeChild(this),this.insertBefore(r,o||void 0))}),this.enforceAllowedChildren()}};Mo.uiClass="";let vd=Mo;const Qt=vd;function yd(n,t){if(Object.keys(n).length!==Object.keys(t).length)return!1;for(const e in n)if(n[e]!==t[e])return!1;return!0}const os=class rs extends Qt{static create(t){return super.create(t)}static formats(t,e){const s=e.query(rs.blotName);if(!(s!=null&&t.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new ql(this.domNode)}format(t,e){if(t===this.statics.blotName&&!e)this.children.forEach(s=>{s instanceof rs||(s=s.wrap(rs.blotName,!0)),this.attributes.copy(s)}),this.unwrap();else{const s=this.scroll.query(t,Ie.INLINE);if(s==null)return;s instanceof oa?this.attributes.attribute(s,e):e&&(t!==this.statics.blotName||this.formats()[t]!==e)&&this.replaceWith(t,e)}}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(t[this.statics.blotName]=e),t}formatAt(t,e,s,l){this.formats()[s]!=null||this.scroll.query(s,Ie.ATTRIBUTE)?this.isolate(t,e).format(s,l):super.formatAt(t,e,s,l)}optimize(t){super.optimize(t);const e=this.formats();if(Object.keys(e).length===0)return this.unwrap();const s=this.next;s instanceof rs&&s.prev===this&&yd(e,s.formats())&&(s.moveChildren(this),s.remove())}replaceWith(t,e){const s=super.replaceWith(t,e);return this.attributes.copy(s),s}update(t,e){super.update(t,e),t.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}wrap(t,e){const s=super.wrap(t,e);return s instanceof rs&&this.attributes.move(s),s}};os.allowedChildren=[os,Ct],os.blotName="inline",os.scope=Ie.INLINE_BLOT,os.tagName="SPAN";let bd=os;const hi=bd,cs=class Xn extends Qt{static create(t){return super.create(t)}static formats(t,e){const s=e.query(Xn.blotName);if(!(s!=null&&t.tagName===s.tagName)){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return t.tagName.toLowerCase()}}constructor(t,e){super(t,e),this.attributes=new ql(this.domNode)}format(t,e){const s=this.scroll.query(t,Ie.BLOCK);s!=null&&(s instanceof oa?this.attributes.attribute(s,e):t===this.statics.blotName&&!e?this.replaceWith(Xn.blotName):e&&(t!==this.statics.blotName||this.formats()[t]!==e)&&this.replaceWith(t,e))}formats(){const t=this.attributes.values(),e=this.statics.formats(this.domNode,this.scroll);return e!=null&&(t[this.statics.blotName]=e),t}formatAt(t,e,s,l){this.scroll.query(s,Ie.BLOCK)!=null?this.format(s,l):super.formatAt(t,e,s,l)}insertAt(t,e,s){if(s==null||this.scroll.query(e,Ie.INLINE)!=null)super.insertAt(t,e,s);else{const l=this.split(t);if(l!=null){const i=this.scroll.create(e,s);l.parent.insertBefore(i,l)}else throw new Error("Attempt to insertAt after block boundaries")}}replaceWith(t,e){const s=super.replaceWith(t,e);return this.attributes.copy(s),s}update(t,e){super.update(t,e),t.some(s=>s.target===this.domNode&&s.type==="attributes")&&this.attributes.build()}};cs.blotName="block",cs.scope=Ie.BLOCK_BLOT,cs.tagName="P",cs.allowedChildren=[hi,cs,Ct];let kd=cs;const Us=kd,Qn=class extends Qt{checkMerge(){return this.next!==null&&this.next.statics.blotName===this.statics.blotName}deleteAt(t,e){super.deleteAt(t,e),this.enforceAllowedChildren()}formatAt(t,e,s,l){super.formatAt(t,e,s,l),this.enforceAllowedChildren()}insertAt(t,e,s){super.insertAt(t,e,s),this.enforceAllowedChildren()}optimize(t){super.optimize(t),this.children.length>0&&this.next!=null&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}};Qn.blotName="container",Qn.scope=Ie.BLOCK_BLOT;let Cd=Qn;const Ul=Cd;class xd extends Ct{static formats(t,e){}format(t,e){super.formatAt(0,this.length(),t,e)}formatAt(t,e,s,l){t===0&&e===this.length()?this.format(s,l):super.formatAt(t,e,s,l)}formats(){return this.statics.formats(this.domNode,this.scroll)}}const Mt=xd,wd={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},Td=100,us=class extends Qt{constructor(t,e){super(null,e),this.registry=t,this.scroll=this,this.build(),this.observer=new MutationObserver(s=>{this.update(s)}),this.observer.observe(this.domNode,wd),this.attach()}create(t,e){return this.registry.create(this,t,e)}find(t,e=!1){const s=this.registry.find(t,e);return s?s.scroll===this?s:e?this.find(s.scroll.domNode.parentNode,!0):null:null}query(t,e=Ie.ANY){return this.registry.query(t,e)}register(...t){return this.registry.register(...t)}build(){this.scroll!=null&&super.build()}detach(){super.detach(),this.observer.disconnect()}deleteAt(t,e){this.update(),t===0&&e===this.length()?this.children.forEach(s=>{s.remove()}):super.deleteAt(t,e)}formatAt(t,e,s,l){this.update(),super.formatAt(t,e,s,l)}insertAt(t,e,s){this.update(),super.insertAt(t,e,s)}optimize(t=[],e={}){super.optimize(e);const s=e.mutationsMap||new WeakMap;let l=Array.from(this.observer.takeRecords());for(;l.length>0;)t.push(l.pop());const i=(u,m=!0)=>{u==null||u===this||u.domNode.parentNode!=null&&(s.has(u.domNode)||s.set(u.domNode,[]),m&&i(u.parent))},o=u=>{s.has(u.domNode)&&(u instanceof Qt&&u.children.forEach(o),s.delete(u.domNode),u.optimize(e))};let r=t;for(let u=0;r.length>0;u+=1){if(u>=Td)throw new Error("[Parchment] Maximum optimize iterations reached");for(r.forEach(m=>{const h=this.find(m.target,!0);h!=null&&(h.domNode===m.target&&(m.type==="childList"?(i(this.find(m.previousSibling,!1)),Array.from(m.addedNodes).forEach(v=>{const g=this.find(v,!1);i(g,!1),g instanceof Qt&&g.children.forEach(b=>{i(b,!1)})})):m.type==="attributes"&&i(h.prev)),i(h))}),this.children.forEach(o),r=Array.from(this.observer.takeRecords()),l=r.slice();l.length>0;)t.push(l.pop())}}update(t,e={}){t=t||this.observer.takeRecords();const s=new WeakMap;t.map(l=>{const i=this.find(l.target,!0);return i==null?null:s.has(i.domNode)?(s.get(i.domNode).push(l),null):(s.set(i.domNode,[l]),i)}).forEach(l=>{l!=null&&l!==this&&s.has(l.domNode)&&l.update(s.get(l.domNode)||[],e)}),e.mutationsMap=s,s.has(this.domNode)&&super.update(s.get(this.domNode),e),this.optimize(t,e)}};us.blotName="scroll",us.defaultChild=Us,us.allowedChildren=[Us,Ul],us.scope=Ie.BLOCK_BLOT,us.tagName="DIV";let Ld=us;const _i=Ld,Kn=class Fo extends Ct{static create(t){return document.createTextNode(t)}static value(t){return t.data}constructor(t,e){super(t,e),this.text=this.statics.value(this.domNode)}deleteAt(t,e){this.domNode.data=this.text=this.text.slice(0,t)+this.text.slice(t+e)}index(t,e){return this.domNode===t?e:-1}insertAt(t,e,s){s==null?(this.text=this.text.slice(0,t)+e+this.text.slice(t),this.domNode.data=this.text):super.insertAt(t,e,s)}length(){return this.text.length}optimize(t){super.optimize(t),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof Fo&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())}position(t,e=!1){return[this.domNode,t]}split(t,e=!1){if(!e){if(t===0)return this;if(t===this.length())return this.next}const s=this.scroll.create(this.domNode.splitText(t));return this.parent.insertBefore(s,this.next||void 0),this.text=this.statics.value(this.domNode),s}update(t,e){t.some(s=>s.type==="characterData"&&s.target===this.domNode)&&(this.text=this.statics.value(this.domNode))}value(){return this.text}};Kn.blotName="text",Kn.scope=Ie.INLINE_BLOT;let Ed=Kn;const $l=Ed;var Sd=Object.freeze(Object.defineProperty({__proto__:null,Attributor:oa,AttributorStore:ql,BlockBlot:Us,ClassAttributor:ea,ContainerBlot:Ul,EmbedBlot:Mt,InlineBlot:hi,LeafBlot:Ct,ParentBlot:Qt,Registry:_s,Scope:Ie,ScrollBlot:_i,StyleAttributor:Da,TextBlot:$l},Symbol.toStringTag,{value:"Module"})),Dt={exports:{}},Ot=-1,Et=1,ct=0;function zs(n,t,e,s,l){if(n===t)return n?[[ct,n]]:[];if(e!=null){var i=Fd(n,t,e);if(i)return i}var o=vi(n,t),r=n.substring(0,o);n=n.substring(o),t=t.substring(o),o=zl(n,t);var u=n.substring(n.length-o);n=n.substring(0,n.length-o),t=t.substring(0,t.length-o);var m=Ad(n,t);return r&&m.unshift([ct,r]),u&&m.push([ct,u]),yi(m,l),s&&Dd(m),m}function Ad(n,t){var e;if(!n)return[[Et,t]];if(!t)return[[Ot,n]];var s=n.length>t.length?n:t,l=n.length>t.length?t:n,i=s.indexOf(l);if(i!==-1)return e=[[Et,s.substring(0,i)],[ct,l],[Et,s.substring(i+l.length)]],n.length>t.length&&(e[0][0]=e[2][0]=Ot),e;if(l.length===1)return[[Ot,n],[Et,t]];var o=$d(n,t);if(o){var r=o[0],u=o[1],m=o[2],h=o[3],v=o[4],g=zs(r,m),b=zs(u,h);return g.concat([[ct,v]],b)}return Id(n,t)}function Id(n,t){for(var e=n.length,s=t.length,l=Math.ceil((e+s)/2),i=l,o=2*l,r=new Array(o),u=new Array(o),m=0;m<o;m++)r[m]=-1,u[m]=-1;r[i+1]=0,u[i+1]=0;for(var h=e-s,v=h%2!==0,g=0,b=0,D=0,P=0,y=0;y<l;y++){for(var w=-y+g;w<=y-b;w+=2){var A=i+w,S;w===-y||w!==y&&r[A-1]<r[A+1]?S=r[A+1]:S=r[A-1]+1;for(var f=S-w;S<e&&f<s&&n.charAt(S)===t.charAt(f);)S++,f++;if(r[A]=S,S>e)b+=2;else if(f>s)g+=2;else if(v){var k=i+h-w;if(k>=0&&k<o&&u[k]!==-1){var T=e-u[k];if(S>=T)return ji(n,t,S,f)}}}for(var E=-y+D;E<=y-P;E+=2){var k=i+E,T;E===-y||E!==y&&u[k-1]<u[k+1]?T=u[k+1]:T=u[k-1]+1;for(var $=T-E;T<e&&$<s&&n.charAt(e-T-1)===t.charAt(s-$-1);)T++,$++;if(u[k]=T,T>e)P+=2;else if($>s)D+=2;else if(!v){var A=i+h-E;if(A>=0&&A<o&&r[A]!==-1){var S=r[A],f=i+S-A;if(T=e-T,S>=T)return ji(n,t,S,f)}}}}return[[Ot,n],[Et,t]]}function ji(n,t,e,s){var l=n.substring(0,e),i=t.substring(0,s),o=n.substring(e),r=t.substring(s),u=zs(l,i),m=zs(o,r);return u.concat(m)}function vi(n,t){if(!n||!t||n.charAt(0)!==t.charAt(0))return 0;for(var e=0,s=Math.min(n.length,t.length),l=s,i=0;e<l;)n.substring(i,l)==t.substring(i,l)?(e=l,i=e):s=l,l=Math.floor((s-e)/2+e);return Vo(n.charCodeAt(l-1))&&l--,l}function Yi(n,t){var e=n.length,s=t.length;if(e==0||s==0)return 0;e>s?n=n.substring(e-s):e<s&&(t=t.substring(0,e));var l=Math.min(e,s);if(n==t)return l;for(var i=0,o=1;;){var r=n.substring(l-o),u=t.indexOf(r);if(u==-1)return i;o+=u,(u==0||n.substring(l-o)==t.substring(0,o))&&(i=o,o++)}}function zl(n,t){if(!n||!t||n.slice(-1)!==t.slice(-1))return 0;for(var e=0,s=Math.min(n.length,t.length),l=s,i=0;e<l;)n.substring(n.length-l,n.length-i)==t.substring(t.length-l,t.length-i)?(e=l,i=e):s=l,l=Math.floor((s-e)/2+e);return Bo(n.charCodeAt(n.length-l))&&l--,l}function $d(n,t){var e=n.length>t.length?n:t,s=n.length>t.length?t:n;if(e.length<4||s.length*2<e.length)return null;function l(b,D,P){for(var y=b.substring(P,P+Math.floor(b.length/4)),w=-1,A="",S,f,k,T;(w=D.indexOf(y,w+1))!==-1;){var E=vi(b.substring(P),D.substring(w)),$=zl(b.substring(0,P),D.substring(0,w));A.length<$+E&&(A=D.substring(w-$,w)+D.substring(w,w+E),S=b.substring(0,P-$),f=b.substring(P+E),k=D.substring(0,w-$),T=D.substring(w+E))}return A.length*2>=b.length?[S,f,k,T,A]:null}var i=l(e,s,Math.ceil(e.length/4)),o=l(e,s,Math.ceil(e.length/2)),r;if(!i&&!o)return null;o?i?r=i[4].length>o[4].length?i:o:r=o:r=i;var u,m,h,v;n.length>t.length?(u=r[0],m=r[1],h=r[2],v=r[3]):(h=r[0],v=r[1],u=r[2],m=r[3]);var g=r[4];return[u,m,h,v,g]}function Dd(n){for(var t=!1,e=[],s=0,l=null,i=0,o=0,r=0,u=0,m=0;i<n.length;)n[i][0]==ct?(e[s++]=i,o=u,r=m,u=0,m=0,l=n[i][1]):(n[i][0]==Et?u+=n[i][1].length:m+=n[i][1].length,l&&l.length<=Math.max(o,r)&&l.length<=Math.max(u,m)&&(n.splice(e[s-1],0,[Ot,l]),n[e[s-1]+1][0]=Et,s--,s--,i=s>0?e[s-1]:-1,o=0,r=0,u=0,m=0,l=null,t=!0)),i++;for(t&&yi(n),Od(n),i=1;i<n.length;){if(n[i-1][0]==Ot&&n[i][0]==Et){var h=n[i-1][1],v=n[i][1],g=Yi(h,v),b=Yi(v,h);g>=b?(g>=h.length/2||g>=v.length/2)&&(n.splice(i,0,[ct,v.substring(0,g)]),n[i-1][1]=h.substring(0,h.length-g),n[i+1][1]=v.substring(g),i++):(b>=h.length/2||b>=v.length/2)&&(n.splice(i,0,[ct,h.substring(0,b)]),n[i-1][0]=Et,n[i-1][1]=v.substring(0,v.length-b),n[i+1][0]=Ot,n[i+1][1]=h.substring(b),i++),i++}i++}}var Wi=/[^a-zA-Z0-9]/,Hi=/\s/,Zi=/[\r\n]/,Pd=/\n\r?\n$/,Nd=/^\r?\n\r?\n/;function Od(n){function t(b,D){if(!b||!D)return 6;var P=b.charAt(b.length-1),y=D.charAt(0),w=P.match(Wi),A=y.match(Wi),S=w&&P.match(Hi),f=A&&y.match(Hi),k=S&&P.match(Zi),T=f&&y.match(Zi),E=k&&b.match(Pd),$=T&&D.match(Nd);return E||$?5:k||T?4:w&&!S&&f?3:S||f?2:w||A?1:0}for(var e=1;e<n.length-1;){if(n[e-1][0]==ct&&n[e+1][0]==ct){var s=n[e-1][1],l=n[e][1],i=n[e+1][1],o=zl(s,l);if(o){var r=l.substring(l.length-o);s=s.substring(0,s.length-o),l=r+l.substring(0,l.length-o),i=r+i}for(var u=s,m=l,h=i,v=t(s,l)+t(l,i);l.charAt(0)===i.charAt(0);){s+=l.charAt(0),l=l.substring(1)+i.charAt(0),i=i.substring(1);var g=t(s,l)+t(l,i);g>=v&&(v=g,u=s,m=l,h=i)}n[e-1][1]!=u&&(u?n[e-1][1]=u:(n.splice(e-1,1),e--),n[e][1]=m,h?n[e+1][1]=h:(n.splice(e+1,1),e--))}e++}}function yi(n,t){n.push([ct,""]);for(var e=0,s=0,l=0,i="",o="",r;e<n.length;){if(e<n.length-1&&!n[e][1]){n.splice(e,1);continue}switch(n[e][0]){case Et:l++,o+=n[e][1],e++;break;case Ot:s++,i+=n[e][1],e++;break;case ct:var u=e-l-s-1;if(t){if(u>=0&&qo(n[u][1])){var m=n[u][1].slice(-1);if(n[u][1]=n[u][1].slice(0,-1),i=m+i,o=m+o,!n[u][1]){n.splice(u,1),e--;var h=u-1;n[h]&&n[h][0]===Et&&(l++,o=n[h][1]+o,h--),n[h]&&n[h][0]===Ot&&(s++,i=n[h][1]+i,h--),u=h}}if(Ro(n[e][1])){var m=n[e][1].charAt(0);n[e][1]=n[e][1].slice(1),i+=m,o+=m}}if(e<n.length-1&&!n[e][1]){n.splice(e,1);break}if(i.length>0||o.length>0){i.length>0&&o.length>0&&(r=vi(o,i),r!==0&&(u>=0?n[u][1]+=o.substring(0,r):(n.splice(0,0,[ct,o.substring(0,r)]),e++),o=o.substring(r),i=i.substring(r)),r=zl(o,i),r!==0&&(n[e][1]=o.substring(o.length-r)+n[e][1],o=o.substring(0,o.length-r),i=i.substring(0,i.length-r)));var v=l+s;i.length===0&&o.length===0?(n.splice(e-v,v),e=e-v):i.length===0?(n.splice(e-v,v,[Et,o]),e=e-v+1):o.length===0?(n.splice(e-v,v,[Ot,i]),e=e-v+1):(n.splice(e-v,v,[Ot,i],[Et,o]),e=e-v+2)}e!==0&&n[e-1][0]===ct?(n[e-1][1]+=n[e][1],n.splice(e,1)):e++,l=0,s=0,i="",o="";break}}n[n.length-1][1]===""&&n.pop();var g=!1;for(e=1;e<n.length-1;)n[e-1][0]===ct&&n[e+1][0]===ct&&(n[e][1].substring(n[e][1].length-n[e-1][1].length)===n[e-1][1]?(n[e][1]=n[e-1][1]+n[e][1].substring(0,n[e][1].length-n[e-1][1].length),n[e+1][1]=n[e-1][1]+n[e+1][1],n.splice(e-1,1),g=!0):n[e][1].substring(0,n[e+1][1].length)==n[e+1][1]&&(n[e-1][1]+=n[e+1][1],n[e][1]=n[e][1].substring(n[e+1][1].length)+n[e+1][1],n.splice(e+1,1),g=!0)),e++;g&&yi(n,t)}function Vo(n){return n>=55296&&n<=56319}function Bo(n){return n>=56320&&n<=57343}function Ro(n){return Bo(n.charCodeAt(0))}function qo(n){return Vo(n.charCodeAt(n.length-1))}function Md(n){for(var t=[],e=0;e<n.length;e++)n[e][1].length>0&&t.push(n[e]);return t}function Vn(n,t,e,s){return qo(n)||Ro(s)?null:Md([[ct,n],[Ot,t],[Et,e],[ct,s]])}function Fd(n,t,e){var s=typeof e=="number"?{index:e,length:0}:e.oldRange,l=typeof e=="number"?null:e.newRange,i=n.length,o=t.length;if(s.length===0&&(l===null||l.length===0)){var r=s.index,u=n.slice(0,r),m=n.slice(r),h=l?l.index:null;e:{var v=r+o-i;if(h!==null&&h!==v||v<0||v>o)break e;var g=t.slice(0,v),b=t.slice(v);if(b!==m)break e;var D=Math.min(r,v),P=u.slice(0,D),y=g.slice(0,D);if(P!==y)break e;var w=u.slice(D),A=g.slice(D);return Vn(P,w,A,m)}e:{if(h!==null&&h!==r)break e;var S=r,g=t.slice(0,S),b=t.slice(S);if(g!==u)break e;var f=Math.min(i-S,o-S),k=m.slice(m.length-f),T=b.slice(b.length-f);if(k!==T)break e;var w=m.slice(0,m.length-f),A=b.slice(0,b.length-f);return Vn(u,w,A,k)}}if(s.length>0&&l&&l.length===0){e:{var P=n.slice(0,s.index),k=n.slice(s.index+s.length),D=P.length,f=k.length;if(o<D+f)break e;var y=t.slice(0,D),T=t.slice(o-f);if(P!==y||k!==T)break e;var w=n.slice(D,i-f),A=t.slice(D,o-f);return Vn(P,w,A,k)}}return null}function jl(n,t,e,s){return zs(n,t,e,s,!0)}jl.INSERT=Et;jl.DELETE=Ot;jl.EQUAL=ct;var Vd=jl,Dl={exports:{}};(function(n,t){var e=200,s="__lodash_hash_undefined__",l=9007199254740991,i="[object Arguments]",o="[object Array]",r="[object Boolean]",u="[object Date]",m="[object Error]",h="[object Function]",v="[object GeneratorFunction]",g="[object Map]",b="[object Number]",D="[object Object]",P="[object Promise]",y="[object RegExp]",w="[object Set]",A="[object String]",S="[object Symbol]",f="[object WeakMap]",k="[object ArrayBuffer]",T="[object DataView]",E="[object Float32Array]",$="[object Float64Array]",R="[object Int8Array]",Y="[object Int16Array]",M="[object Int32Array]",K="[object Uint8Array]",ce="[object Uint8ClampedArray]",j="[object Uint16Array]",ie="[object Uint32Array]",se=/[\\^$.*+?()[\]{}|]/g,le=/\w*$/,te=/^\[object .+?Constructor\]$/,ne=/^(?:0|[1-9]\d*)$/,Z={};Z[i]=Z[o]=Z[k]=Z[T]=Z[r]=Z[u]=Z[E]=Z[$]=Z[R]=Z[Y]=Z[M]=Z[g]=Z[b]=Z[D]=Z[y]=Z[w]=Z[A]=Z[S]=Z[K]=Z[ce]=Z[j]=Z[ie]=!0,Z[m]=Z[h]=Z[f]=!1;var ge=typeof xa=="object"&&xa&&xa.Object===Object&&xa,be=typeof self=="object"&&self&&self.Object===Object&&self,q=ge||be||Function("return this")(),Q=t&&!t.nodeType&&t,G=Q&&!0&&n&&!n.nodeType&&n,H=G&&G.exports===Q;function J(p,F){return p.set(F[0],F[1]),p}function X(p,F){return p.add(F),p}function ve(p,F){for(var z=-1,oe=p?p.length:0;++z<oe&&F(p[z],z,p)!==!1;);return p}function ye(p,F){for(var z=-1,oe=F.length,Ve=p.length;++z<oe;)p[Ve+z]=F[z];return p}function _e(p,F,z,oe){var Ve=-1,$e=p?p.length:0;for(oe&&$e&&(z=p[++Ve]);++Ve<$e;)z=F(z,p[Ve],Ve,p);return z}function Se(p,F){for(var z=-1,oe=Array(p);++z<p;)oe[z]=F(z);return oe}function Oe(p,F){return p?.[F]}function fe(p){var F=!1;if(p!=null&&typeof p.toString!="function")try{F=!!(p+"")}catch{}return F}function Le(p){var F=-1,z=Array(p.size);return p.forEach(function(oe,Ve){z[++F]=[Ve,oe]}),z}function Ne(p,F){return function(z){return p(F(z))}}function Me(p){var F=-1,z=Array(p.size);return p.forEach(function(oe){z[++F]=oe}),z}var Be=Array.prototype,Ce=Function.prototype,qe=Object.prototype,ee=q["__core-js_shared__"],he=function(){var p=/[^.]+$/.exec(ee&&ee.keys&&ee.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),de=Ce.toString,Fe=qe.hasOwnProperty,xe=qe.toString,va=RegExp("^"+de.call(Fe).replace(se,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),wt=H?q.Buffer:void 0,Za=q.Symbol,Cs=q.Uint8Array,Ft=Ne(Object.getPrototypeOf,Object),tl=Object.create,al=qe.propertyIsEnumerable,Gl=Be.splice,xs=Object.getOwnPropertySymbols,Ga=wt?wt.isBuffer:void 0,sl=Ne(Object.keys,Object),Ja=Zt(q,"DataView"),Pa=Zt(q,"Map"),Ht=Zt(q,"Promise"),Xa=Zt(q,"Set"),ws=Zt(q,"WeakMap"),Na=Zt(Object,"create"),Ts=Tt(Ja),Oa=Tt(Pa),Ls=Tt(Ht),Es=Tt(Xa),Ss=Tt(ws),ya=Za?Za.prototype:void 0,ll=ya?ya.valueOf:void 0;function ca(p){var F=-1,z=p?p.length:0;for(this.clear();++F<z;){var oe=p[F];this.set(oe[0],oe[1])}}function Jl(){this.__data__=Na?Na(null):{}}function Xl(p){return this.has(p)&&delete this.__data__[p]}function Ql(p){var F=this.__data__;if(Na){var z=F[p];return z===s?void 0:z}return Fe.call(F,p)?F[p]:void 0}function nl(p){var F=this.__data__;return Na?F[p]!==void 0:Fe.call(F,p)}function As(p,F){var z=this.__data__;return z[p]=Na&&F===void 0?s:F,this}ca.prototype.clear=Jl,ca.prototype.delete=Xl,ca.prototype.get=Ql,ca.prototype.has=nl,ca.prototype.set=As;function gt(p){var F=-1,z=p?p.length:0;for(this.clear();++F<z;){var oe=p[F];this.set(oe[0],oe[1])}}function Kl(){this.__data__=[]}function en(p){var F=this.__data__,z=Ka(F,p);if(z<0)return!1;var oe=F.length-1;return z==oe?F.pop():Gl.call(F,z,1),!0}function tn(p){var F=this.__data__,z=Ka(F,p);return z<0?void 0:F[z][1]}function an(p){return Ka(this.__data__,p)>-1}function sn(p,F){var z=this.__data__,oe=Ka(z,p);return oe<0?z.push([p,F]):z[oe][1]=F,this}gt.prototype.clear=Kl,gt.prototype.delete=en,gt.prototype.get=tn,gt.prototype.has=an,gt.prototype.set=sn;function yt(p){var F=-1,z=p?p.length:0;for(this.clear();++F<z;){var oe=p[F];this.set(oe[0],oe[1])}}function ln(){this.__data__={hash:new ca,map:new(Pa||gt),string:new ca}}function nn(p){return Fa(this,p).delete(p)}function on(p){return Fa(this,p).get(p)}function rn(p){return Fa(this,p).has(p)}function cn(p,F){return Fa(this,p).set(p,F),this}yt.prototype.clear=ln,yt.prototype.delete=nn,yt.prototype.get=on,yt.prototype.has=rn,yt.prototype.set=cn;function It(p){this.__data__=new gt(p)}function un(){this.__data__=new gt}function dn(p){return this.__data__.delete(p)}function mn(p){return this.__data__.get(p)}function pn(p){return this.__data__.has(p)}function gn(p,F){var z=this.__data__;if(z instanceof gt){var oe=z.__data__;if(!Pa||oe.length<e-1)return oe.push([p,F]),this;z=this.__data__=new yt(oe)}return z.set(p,F),this}It.prototype.clear=un,It.prototype.delete=dn,It.prototype.get=mn,It.prototype.has=pn,It.prototype.set=gn;function Qa(p,F){var z=Ps(p)||ts(p)?Se(p.length,String):[],oe=z.length,Ve=!!oe;for(var $e in p)(F||Fe.call(p,$e))&&!(Ve&&($e=="length"||Sn($e,oe)))&&z.push($e);return z}function il(p,F,z){var oe=p[F];(!(Fe.call(p,F)&&dl(oe,z))||z===void 0&&!(F in p))&&(p[F]=z)}function Ka(p,F){for(var z=p.length;z--;)if(dl(p[z][0],F))return z;return-1}function aa(p,F){return p&&Ds(F,Os(F),p)}function Is(p,F,z,oe,Ve,$e,je){var He;if(oe&&(He=$e?oe(p,Ve,$e,je):oe(p)),He!==void 0)return He;if(!la(p))return p;var nt=Ps(p);if(nt){if(He=Ln(p),!F)return xn(p,He)}else{var Xe=da(p),bt=Xe==h||Xe==v;if(ml(p))return es(p,F);if(Xe==D||Xe==i||bt&&!$e){if(fe(p))return $e?p:{};if(He=sa(bt?{}:p),!F)return wn(p,aa(He,p))}else{if(!Z[Xe])return $e?p:{};He=En(p,Xe,Is,F)}}je||(je=new It);var $t=je.get(p);if($t)return $t;if(je.set(p,He),!nt)var rt=z?Tn(p):Os(p);return ve(rt||p,function(kt,ft){rt&&(ft=kt,kt=p[ft]),il(He,ft,Is(kt,F,z,oe,ft,p,je))}),He}function fn(p){return la(p)?tl(p):{}}function hn(p,F,z){var oe=F(p);return Ps(p)?oe:ye(oe,z(p))}function _n(p){return xe.call(p)}function vn(p){if(!la(p)||In(p))return!1;var F=Ns(p)||fe(p)?va:te;return F.test(Tt(p))}function yn(p){if(!cl(p))return sl(p);var F=[];for(var z in Object(p))Fe.call(p,z)&&z!="constructor"&&F.push(z);return F}function es(p,F){if(F)return p.slice();var z=new p.constructor(p.length);return p.copy(z),z}function $s(p){var F=new p.constructor(p.byteLength);return new Cs(F).set(new Cs(p)),F}function Ma(p,F){var z=F?$s(p.buffer):p.buffer;return new p.constructor(z,p.byteOffset,p.byteLength)}function ol(p,F,z){var oe=F?z(Le(p),!0):Le(p);return _e(oe,J,new p.constructor)}function rl(p){var F=new p.constructor(p.source,le.exec(p));return F.lastIndex=p.lastIndex,F}function bn(p,F,z){var oe=F?z(Me(p),!0):Me(p);return _e(oe,X,new p.constructor)}function kn(p){return ll?Object(ll.call(p)):{}}function Cn(p,F){var z=F?$s(p.buffer):p.buffer;return new p.constructor(z,p.byteOffset,p.length)}function xn(p,F){var z=-1,oe=p.length;for(F||(F=Array(oe));++z<oe;)F[z]=p[z];return F}function Ds(p,F,z,oe){z||(z={});for(var Ve=-1,$e=F.length;++Ve<$e;){var je=F[Ve],He=oe?oe(z[je],p[je],je,z,p):void 0;il(z,je,He===void 0?p[je]:He)}return z}function wn(p,F){return Ds(p,ua(p),F)}function Tn(p){return hn(p,Os,ua)}function Fa(p,F){var z=p.__data__;return An(F)?z[typeof F=="string"?"string":"hash"]:z.map}function Zt(p,F){var z=Oe(p,F);return vn(z)?z:void 0}var ua=xs?Ne(xs,Object):Dn,da=_n;(Ja&&da(new Ja(new ArrayBuffer(1)))!=T||Pa&&da(new Pa)!=g||Ht&&da(Ht.resolve())!=P||Xa&&da(new Xa)!=w||ws&&da(new ws)!=f)&&(da=function(p){var F=xe.call(p),z=F==D?p.constructor:void 0,oe=z?Tt(z):void 0;if(oe)switch(oe){case Ts:return T;case Oa:return g;case Ls:return P;case Es:return w;case Ss:return f}return F});function Ln(p){var F=p.length,z=p.constructor(F);return F&&typeof p[0]=="string"&&Fe.call(p,"index")&&(z.index=p.index,z.input=p.input),z}function sa(p){return typeof p.constructor=="function"&&!cl(p)?fn(Ft(p)):{}}function En(p,F,z,oe){var Ve=p.constructor;switch(F){case k:return $s(p);case r:case u:return new Ve(+p);case T:return Ma(p,oe);case E:case $:case R:case Y:case M:case K:case ce:case j:case ie:return Cn(p,oe);case g:return ol(p,oe,z);case b:case A:return new Ve(p);case y:return rl(p);case w:return bn(p,oe,z);case S:return kn(p)}}function Sn(p,F){return F=F??l,!!F&&(typeof p=="number"||ne.test(p))&&p>-1&&p%1==0&&p<F}function An(p){var F=typeof p;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?p!=="__proto__":p===null}function In(p){return!!he&&he in p}function cl(p){var F=p&&p.constructor,z=typeof F=="function"&&F.prototype||qe;return p===z}function Tt(p){if(p!=null){try{return de.call(p)}catch{}try{return p+""}catch{}}return""}function ul(p){return Is(p,!0,!0)}function dl(p,F){return p===F||p!==p&&F!==F}function ts(p){return $n(p)&&Fe.call(p,"callee")&&(!al.call(p,"callee")||xe.call(p)==i)}var Ps=Array.isArray;function as(p){return p!=null&&pl(p.length)&&!Ns(p)}function $n(p){return gl(p)&&as(p)}var ml=Ga||Pn;function Ns(p){var F=la(p)?xe.call(p):"";return F==h||F==v}function pl(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=l}function la(p){var F=typeof p;return!!p&&(F=="object"||F=="function")}function gl(p){return!!p&&typeof p=="object"}function Os(p){return as(p)?Qa(p):yn(p)}function Dn(){return[]}function Pn(){return!1}n.exports=ul})(Dl,Dl.exports);var Pl={exports:{}};(function(n,t){var e=200,s="__lodash_hash_undefined__",l=1,i=2,o=9007199254740991,r="[object Arguments]",u="[object Array]",m="[object AsyncFunction]",h="[object Boolean]",v="[object Date]",g="[object Error]",b="[object Function]",D="[object GeneratorFunction]",P="[object Map]",y="[object Number]",w="[object Null]",A="[object Object]",S="[object Promise]",f="[object Proxy]",k="[object RegExp]",T="[object Set]",E="[object String]",$="[object Symbol]",R="[object Undefined]",Y="[object WeakMap]",M="[object ArrayBuffer]",K="[object DataView]",ce="[object Float32Array]",j="[object Float64Array]",ie="[object Int8Array]",se="[object Int16Array]",le="[object Int32Array]",te="[object Uint8Array]",ne="[object Uint8ClampedArray]",Z="[object Uint16Array]",ge="[object Uint32Array]",be=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,G={};G[ce]=G[j]=G[ie]=G[se]=G[le]=G[te]=G[ne]=G[Z]=G[ge]=!0,G[r]=G[u]=G[M]=G[h]=G[K]=G[v]=G[g]=G[b]=G[P]=G[y]=G[A]=G[k]=G[T]=G[E]=G[Y]=!1;var H=typeof xa=="object"&&xa&&xa.Object===Object&&xa,J=typeof self=="object"&&self&&self.Object===Object&&self,X=H||J||Function("return this")(),ve=t&&!t.nodeType&&t,ye=ve&&!0&&n&&!n.nodeType&&n,_e=ye&&ye.exports===ve,Se=_e&&H.process,Oe=function(){try{return Se&&Se.binding&&Se.binding("util")}catch{}}(),fe=Oe&&Oe.isTypedArray;function Le(p,F){for(var z=-1,oe=p==null?0:p.length,Ve=0,$e=[];++z<oe;){var je=p[z];F(je,z,p)&&($e[Ve++]=je)}return $e}function Ne(p,F){for(var z=-1,oe=F.length,Ve=p.length;++z<oe;)p[Ve+z]=F[z];return p}function Me(p,F){for(var z=-1,oe=p==null?0:p.length;++z<oe;)if(F(p[z],z,p))return!0;return!1}function Be(p,F){for(var z=-1,oe=Array(p);++z<p;)oe[z]=F(z);return oe}function Ce(p){return function(F){return p(F)}}function qe(p,F){return p.has(F)}function ee(p,F){return p?.[F]}function he(p){var F=-1,z=Array(p.size);return p.forEach(function(oe,Ve){z[++F]=[Ve,oe]}),z}function de(p,F){return function(z){return p(F(z))}}function Fe(p){var F=-1,z=Array(p.size);return p.forEach(function(oe){z[++F]=oe}),z}var xe=Array.prototype,va=Function.prototype,wt=Object.prototype,Za=X["__core-js_shared__"],Cs=va.toString,Ft=wt.hasOwnProperty,tl=function(){var p=/[^.]+$/.exec(Za&&Za.keys&&Za.keys.IE_PROTO||"");return p?"Symbol(src)_1."+p:""}(),al=wt.toString,Gl=RegExp("^"+Cs.call(Ft).replace(be,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xs=_e?X.Buffer:void 0,Ga=X.Symbol,sl=X.Uint8Array,Ja=wt.propertyIsEnumerable,Pa=xe.splice,Ht=Ga?Ga.toStringTag:void 0,Xa=Object.getOwnPropertySymbols,ws=xs?xs.isBuffer:void 0,Na=de(Object.keys,Object),Ts=ua(X,"DataView"),Oa=ua(X,"Map"),Ls=ua(X,"Promise"),Es=ua(X,"Set"),Ss=ua(X,"WeakMap"),ya=ua(Object,"create"),ll=Tt(Ts),ca=Tt(Oa),Jl=Tt(Ls),Xl=Tt(Es),Ql=Tt(Ss),nl=Ga?Ga.prototype:void 0,As=nl?nl.valueOf:void 0;function gt(p){var F=-1,z=p==null?0:p.length;for(this.clear();++F<z;){var oe=p[F];this.set(oe[0],oe[1])}}function Kl(){this.__data__=ya?ya(null):{},this.size=0}function en(p){var F=this.has(p)&&delete this.__data__[p];return this.size-=F?1:0,F}function tn(p){var F=this.__data__;if(ya){var z=F[p];return z===s?void 0:z}return Ft.call(F,p)?F[p]:void 0}function an(p){var F=this.__data__;return ya?F[p]!==void 0:Ft.call(F,p)}function sn(p,F){var z=this.__data__;return this.size+=this.has(p)?0:1,z[p]=ya&&F===void 0?s:F,this}gt.prototype.clear=Kl,gt.prototype.delete=en,gt.prototype.get=tn,gt.prototype.has=an,gt.prototype.set=sn;function yt(p){var F=-1,z=p==null?0:p.length;for(this.clear();++F<z;){var oe=p[F];this.set(oe[0],oe[1])}}function ln(){this.__data__=[],this.size=0}function nn(p){var F=this.__data__,z=es(F,p);if(z<0)return!1;var oe=F.length-1;return z==oe?F.pop():Pa.call(F,z,1),--this.size,!0}function on(p){var F=this.__data__,z=es(F,p);return z<0?void 0:F[z][1]}function rn(p){return es(this.__data__,p)>-1}function cn(p,F){var z=this.__data__,oe=es(z,p);return oe<0?(++this.size,z.push([p,F])):z[oe][1]=F,this}yt.prototype.clear=ln,yt.prototype.delete=nn,yt.prototype.get=on,yt.prototype.has=rn,yt.prototype.set=cn;function It(p){var F=-1,z=p==null?0:p.length;for(this.clear();++F<z;){var oe=p[F];this.set(oe[0],oe[1])}}function un(){this.size=0,this.__data__={hash:new gt,map:new(Oa||yt),string:new gt}}function dn(p){var F=Zt(this,p).delete(p);return this.size-=F?1:0,F}function mn(p){return Zt(this,p).get(p)}function pn(p){return Zt(this,p).has(p)}function gn(p,F){var z=Zt(this,p),oe=z.size;return z.set(p,F),this.size+=z.size==oe?0:1,this}It.prototype.clear=un,It.prototype.delete=dn,It.prototype.get=mn,It.prototype.has=pn,It.prototype.set=gn;function Qa(p){var F=-1,z=p==null?0:p.length;for(this.__data__=new It;++F<z;)this.add(p[F])}function il(p){return this.__data__.set(p,s),this}function Ka(p){return this.__data__.has(p)}Qa.prototype.add=Qa.prototype.push=il,Qa.prototype.has=Ka;function aa(p){var F=this.__data__=new yt(p);this.size=F.size}function Is(){this.__data__=new yt,this.size=0}function fn(p){var F=this.__data__,z=F.delete(p);return this.size=F.size,z}function hn(p){return this.__data__.get(p)}function _n(p){return this.__data__.has(p)}function vn(p,F){var z=this.__data__;if(z instanceof yt){var oe=z.__data__;if(!Oa||oe.length<e-1)return oe.push([p,F]),this.size=++z.size,this;z=this.__data__=new It(oe)}return z.set(p,F),this.size=z.size,this}aa.prototype.clear=Is,aa.prototype.delete=fn,aa.prototype.get=hn,aa.prototype.has=_n,aa.prototype.set=vn;function yn(p,F){var z=ts(p),oe=!z&&dl(p),Ve=!z&&!oe&&as(p),$e=!z&&!oe&&!Ve&&gl(p),je=z||oe||Ve||$e,He=je?Be(p.length,String):[],nt=He.length;for(var Xe in p)(F||Ft.call(p,Xe))&&!(je&&(Xe=="length"||Ve&&(Xe=="offset"||Xe=="parent")||$e&&(Xe=="buffer"||Xe=="byteLength"||Xe=="byteOffset")||En(Xe,nt)))&&He.push(Xe);return He}function es(p,F){for(var z=p.length;z--;)if(ul(p[z][0],F))return z;return-1}function $s(p,F,z){var oe=F(p);return ts(p)?oe:Ne(oe,z(p))}function Ma(p){return p==null?p===void 0?R:w:Ht&&Ht in Object(p)?da(p):cl(p)}function ol(p){return la(p)&&Ma(p)==r}function rl(p,F,z,oe,Ve){return p===F?!0:p==null||F==null||!la(p)&&!la(F)?p!==p&&F!==F:bn(p,F,z,oe,rl,Ve)}function bn(p,F,z,oe,Ve,$e){var je=ts(p),He=ts(F),nt=je?u:sa(p),Xe=He?u:sa(F);nt=nt==r?A:nt,Xe=Xe==r?A:Xe;var bt=nt==A,$t=Xe==A,rt=nt==Xe;if(rt&&as(p)){if(!as(F))return!1;je=!0,bt=!1}if(rt&&!bt)return $e||($e=new aa),je||gl(p)?Ds(p,F,z,oe,Ve,$e):wn(p,F,nt,z,oe,Ve,$e);if(!(z&l)){var kt=bt&&Ft.call(p,"__wrapped__"),ft=$t&&Ft.call(F,"__wrapped__");if(kt||ft){var ba=kt?p.value():p,ma=ft?F.value():F;return $e||($e=new aa),Ve(ba,ma,z,oe,$e)}}return rt?($e||($e=new aa),Tn(p,F,z,oe,Ve,$e)):!1}function kn(p){if(!pl(p)||An(p))return!1;var F=ml(p)?Gl:q;return F.test(Tt(p))}function Cn(p){return la(p)&&Ns(p.length)&&!!G[Ma(p)]}function xn(p){if(!In(p))return Na(p);var F=[];for(var z in Object(p))Ft.call(p,z)&&z!="constructor"&&F.push(z);return F}function Ds(p,F,z,oe,Ve,$e){var je=z&l,He=p.length,nt=F.length;if(He!=nt&&!(je&&nt>He))return!1;var Xe=$e.get(p);if(Xe&&$e.get(F))return Xe==F;var bt=-1,$t=!0,rt=z&i?new Qa:void 0;for($e.set(p,F),$e.set(F,p);++bt<He;){var kt=p[bt],ft=F[bt];if(oe)var ba=je?oe(ft,kt,bt,F,p,$e):oe(kt,ft,bt,p,F,$e);if(ba!==void 0){if(ba)continue;$t=!1;break}if(rt){if(!Me(F,function(ma,Va){if(!qe(rt,Va)&&(kt===ma||Ve(kt,ma,z,oe,$e)))return rt.push(Va)})){$t=!1;break}}else if(!(kt===ft||Ve(kt,ft,z,oe,$e))){$t=!1;break}}return $e.delete(p),$e.delete(F),$t}function wn(p,F,z,oe,Ve,$e,je){switch(z){case K:if(p.byteLength!=F.byteLength||p.byteOffset!=F.byteOffset)return!1;p=p.buffer,F=F.buffer;case M:return!(p.byteLength!=F.byteLength||!$e(new sl(p),new sl(F)));case h:case v:case y:return ul(+p,+F);case g:return p.name==F.name&&p.message==F.message;case k:case E:return p==F+"";case P:var He=he;case T:var nt=oe&l;if(He||(He=Fe),p.size!=F.size&&!nt)return!1;var Xe=je.get(p);if(Xe)return Xe==F;oe|=i,je.set(p,F);var bt=Ds(He(p),He(F),oe,Ve,$e,je);return je.delete(p),bt;case $:if(As)return As.call(p)==As.call(F)}return!1}function Tn(p,F,z,oe,Ve,$e){var je=z&l,He=Fa(p),nt=He.length,Xe=Fa(F),bt=Xe.length;if(nt!=bt&&!je)return!1;for(var $t=nt;$t--;){var rt=He[$t];if(!(je?rt in F:Ft.call(F,rt)))return!1}var kt=$e.get(p);if(kt&&$e.get(F))return kt==F;var ft=!0;$e.set(p,F),$e.set(F,p);for(var ba=je;++$t<nt;){rt=He[$t];var ma=p[rt],Va=F[rt];if(oe)var Mi=je?oe(Va,ma,rt,F,p,$e):oe(ma,Va,rt,p,F,$e);if(!(Mi===void 0?ma===Va||Ve(ma,Va,z,oe,$e):Mi)){ft=!1;break}ba||(ba=rt=="constructor")}if(ft&&!ba){var fl=p.constructor,hl=F.constructor;fl!=hl&&"constructor"in p&&"constructor"in F&&!(typeof fl=="function"&&fl instanceof fl&&typeof hl=="function"&&hl instanceof hl)&&(ft=!1)}return $e.delete(p),$e.delete(F),ft}function Fa(p){return $s(p,Os,Ln)}function Zt(p,F){var z=p.__data__;return Sn(F)?z[typeof F=="string"?"string":"hash"]:z.map}function ua(p,F){var z=ee(p,F);return kn(z)?z:void 0}function da(p){var F=Ft.call(p,Ht),z=p[Ht];try{p[Ht]=void 0;var oe=!0}catch{}var Ve=al.call(p);return oe&&(F?p[Ht]=z:delete p[Ht]),Ve}var Ln=Xa?function(p){return p==null?[]:(p=Object(p),Le(Xa(p),function(F){return Ja.call(p,F)}))}:Dn,sa=Ma;(Ts&&sa(new Ts(new ArrayBuffer(1)))!=K||Oa&&sa(new Oa)!=P||Ls&&sa(Ls.resolve())!=S||Es&&sa(new Es)!=T||Ss&&sa(new Ss)!=Y)&&(sa=function(p){var F=Ma(p),z=F==A?p.constructor:void 0,oe=z?Tt(z):"";if(oe)switch(oe){case ll:return K;case ca:return P;case Jl:return S;case Xl:return T;case Ql:return Y}return F});function En(p,F){return F=F??o,!!F&&(typeof p=="number"||Q.test(p))&&p>-1&&p%1==0&&p<F}function Sn(p){var F=typeof p;return F=="string"||F=="number"||F=="symbol"||F=="boolean"?p!=="__proto__":p===null}function An(p){return!!tl&&tl in p}function In(p){var F=p&&p.constructor,z=typeof F=="function"&&F.prototype||wt;return p===z}function cl(p){return al.call(p)}function Tt(p){if(p!=null){try{return Cs.call(p)}catch{}try{return p+""}catch{}}return""}function ul(p,F){return p===F||p!==p&&F!==F}var dl=ol(function(){return arguments}())?ol:function(p){return la(p)&&Ft.call(p,"callee")&&!Ja.call(p,"callee")},ts=Array.isArray;function Ps(p){return p!=null&&Ns(p.length)&&!ml(p)}var as=ws||Pn;function $n(p,F){return rl(p,F)}function ml(p){if(!pl(p))return!1;var F=Ma(p);return F==b||F==D||F==m||F==f}function Ns(p){return typeof p=="number"&&p>-1&&p%1==0&&p<=o}function pl(p){var F=typeof p;return p!=null&&(F=="object"||F=="function")}function la(p){return p!=null&&typeof p=="object"}var gl=fe?Ce(fe):Cn;function Os(p){return Ps(p)?yn(p):xn(p)}function Dn(){return[]}function Pn(){return!1}n.exports=$n})(Pl,Pl.exports);var bi={};Object.defineProperty(bi,"__esModule",{value:!0});const Bd=Dl.exports,Rd=Pl.exports;var ei;(function(n){function t(i={},o={},r=!1){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});let u=Bd(o);r||(u=Object.keys(u).reduce((m,h)=>(u[h]!=null&&(m[h]=u[h]),m),{}));for(const m in i)i[m]!==void 0&&o[m]===void 0&&(u[m]=i[m]);return Object.keys(u).length>0?u:void 0}n.compose=t;function e(i={},o={}){typeof i!="object"&&(i={}),typeof o!="object"&&(o={});const r=Object.keys(i).concat(Object.keys(o)).reduce((u,m)=>(Rd(i[m],o[m])||(u[m]=o[m]===void 0?null:o[m]),u),{});return Object.keys(r).length>0?r:void 0}n.diff=e;function s(i={},o={}){i=i||{};const r=Object.keys(o).reduce((u,m)=>(o[m]!==i[m]&&i[m]!==void 0&&(u[m]=o[m]),u),{});return Object.keys(i).reduce((u,m)=>(i[m]!==o[m]&&o[m]===void 0&&(u[m]=null),u),r)}n.invert=s;function l(i,o,r=!1){if(typeof i!="object")return o;if(typeof o!="object")return;if(!r)return o;const u=Object.keys(o).reduce((m,h)=>(i[h]===void 0&&(m[h]=o[h]),m),{});return Object.keys(u).length>0?u:void 0}n.transform=l})(ei||(ei={}));bi.default=ei;var Yl={};Object.defineProperty(Yl,"__esModule",{value:!0});var ti;(function(n){function t(e){return typeof e.delete=="number"?e.delete:typeof e.retain=="number"?e.retain:typeof e.retain=="object"&&e.retain!==null?1:typeof e.insert=="string"?e.insert.length:1}n.length=t})(ti||(ti={}));Yl.default=ti;var ki={};Object.defineProperty(ki,"__esModule",{value:!0});const Gi=Yl;class qd{constructor(t){this.ops=t,this.index=0,this.offset=0}hasNext(){return this.peekLength()<1/0}next(t){t||(t=1/0);const e=this.ops[this.index];if(e){const s=this.offset,l=Gi.default.length(e);if(t>=l-s?(t=l-s,this.index+=1,this.offset=0):this.offset+=t,typeof e.delete=="number")return{delete:t};{const i={};return e.attributes&&(i.attributes=e.attributes),typeof e.retain=="number"?i.retain=t:typeof e.retain=="object"&&e.retain!==null?i.retain=e.retain:typeof e.insert=="string"?i.insert=e.insert.substr(s,t):i.insert=e.insert,i}}else return{retain:1/0}}peek(){return this.ops[this.index]}peekLength(){return this.ops[this.index]?Gi.default.length(this.ops[this.index])-this.offset:1/0}peekType(){const t=this.ops[this.index];return t?typeof t.delete=="number"?"delete":typeof t.retain=="number"||typeof t.retain=="object"&&t.retain!==null?"retain":"insert":"retain"}rest(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);{const t=this.offset,e=this.index,s=this.next(),l=this.ops.slice(this.index);return this.offset=t,this.index=e,[s].concat(l)}}else return[]}}ki.default=qd;(function(n,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeMap=t.OpIterator=t.Op=void 0;const e=Vd,s=Dl.exports,l=Pl.exports,i=bi;t.AttributeMap=i.default;const o=Yl;t.Op=o.default;const r=ki;t.OpIterator=r.default;const u=String.fromCharCode(0),m=(v,g)=>{if(typeof v!="object"||v===null)throw new Error(`cannot retain a ${typeof v}`);if(typeof g!="object"||g===null)throw new Error(`cannot retain a ${typeof g}`);const b=Object.keys(v)[0];if(!b||b!==Object.keys(g)[0])throw new Error(`embed types not matched: ${b} != ${Object.keys(g)[0]}`);return[b,v[b],g[b]]};class h{constructor(g){Array.isArray(g)?this.ops=g:g!=null&&Array.isArray(g.ops)?this.ops=g.ops:this.ops=[]}static registerEmbed(g,b){this.handlers[g]=b}static unregisterEmbed(g){delete this.handlers[g]}static getHandler(g){const b=this.handlers[g];if(!b)throw new Error(`no handlers for embed type "${g}"`);return b}insert(g,b){const D={};return typeof g=="string"&&g.length===0?this:(D.insert=g,b!=null&&typeof b=="object"&&Object.keys(b).length>0&&(D.attributes=b),this.push(D))}delete(g){return g<=0?this:this.push({delete:g})}retain(g,b){if(typeof g=="number"&&g<=0)return this;const D={retain:g};return b!=null&&typeof b=="object"&&Object.keys(b).length>0&&(D.attributes=b),this.push(D)}push(g){let b=this.ops.length,D=this.ops[b-1];if(g=s(g),typeof D=="object"){if(typeof g.delete=="number"&&typeof D.delete=="number")return this.ops[b-1]={delete:D.delete+g.delete},this;if(typeof D.delete=="number"&&g.insert!=null&&(b-=1,D=this.ops[b-1],typeof D!="object"))return this.ops.unshift(g),this;if(l(g.attributes,D.attributes)){if(typeof g.insert=="string"&&typeof D.insert=="string")return this.ops[b-1]={insert:D.insert+g.insert},typeof g.attributes=="object"&&(this.ops[b-1].attributes=g.attributes),this;if(typeof g.retain=="number"&&typeof D.retain=="number")return this.ops[b-1]={retain:D.retain+g.retain},typeof g.attributes=="object"&&(this.ops[b-1].attributes=g.attributes),this}}return b===this.ops.length?this.ops.push(g):this.ops.splice(b,0,g),this}chop(){const g=this.ops[this.ops.length-1];return g&&typeof g.retain=="number"&&!g.attributes&&this.ops.pop(),this}filter(g){return this.ops.filter(g)}forEach(g){this.ops.forEach(g)}map(g){return this.ops.map(g)}partition(g){const b=[],D=[];return this.forEach(P=>{(g(P)?b:D).push(P)}),[b,D]}reduce(g,b){return this.ops.reduce(g,b)}changeLength(){return this.reduce((g,b)=>b.insert?g+o.default.length(b):b.delete?g-b.delete:g,0)}length(){return this.reduce((g,b)=>g+o.default.length(b),0)}slice(g=0,b=1/0){const D=[],P=new r.default(this.ops);let y=0;for(;y<b&&P.hasNext();){let w;y<g?w=P.next(g-y):(w=P.next(b-y),D.push(w)),y+=o.default.length(w)}return new h(D)}compose(g){const b=new r.default(this.ops),D=new r.default(g.ops),P=[],y=D.peek();if(y!=null&&typeof y.retain=="number"&&y.attributes==null){let A=y.retain;for(;b.peekType()==="insert"&&b.peekLength()<=A;)A-=b.peekLength(),P.push(b.next());y.retain-A>0&&D.next(y.retain-A)}const w=new h(P);for(;b.hasNext()||D.hasNext();)if(D.peekType()==="insert")w.push(D.next());else if(b.peekType()==="delete")w.push(b.next());else{const A=Math.min(b.peekLength(),D.peekLength()),S=b.next(A),f=D.next(A);if(f.retain){const k={};if(typeof S.retain=="number")k.retain=typeof f.retain=="number"?A:f.retain;else if(typeof f.retain=="number")S.retain==null?k.insert=S.insert:k.retain=S.retain;else{const E=S.retain==null?"insert":"retain",[$,R,Y]=m(S[E],f.retain),M=h.getHandler($);k[E]={[$]:M.compose(R,Y,E==="retain")}}const T=i.default.compose(S.attributes,f.attributes,typeof S.retain=="number");if(T&&(k.attributes=T),w.push(k),!D.hasNext()&&l(w.ops[w.ops.length-1],k)){const E=new h(b.rest());return w.concat(E).chop()}}else typeof f.delete=="number"&&(typeof S.retain=="number"||typeof S.retain=="object"&&S.retain!==null)&&w.push(f)}return w.chop()}concat(g){const b=new h(this.ops.slice());return g.ops.length>0&&(b.push(g.ops[0]),b.ops=b.ops.concat(g.ops.slice(1))),b}diff(g,b){if(this.ops===g.ops)return new h;const D=[this,g].map(S=>S.map(f=>{if(f.insert!=null)return typeof f.insert=="string"?f.insert:u;const k=S===g?"on":"with";throw new Error("diff() called "+k+" non-document")}).join("")),P=new h,y=e(D[0],D[1],b,!0),w=new r.default(this.ops),A=new r.default(g.ops);return y.forEach(S=>{let f=S[1].length;for(;f>0;){let k=0;switch(S[0]){case e.INSERT:k=Math.min(A.peekLength(),f),P.push(A.next(k));break;case e.DELETE:k=Math.min(f,w.peekLength()),w.next(k),P.delete(k);break;case e.EQUAL:k=Math.min(w.peekLength(),A.peekLength(),f);const T=w.next(k),E=A.next(k);l(T.insert,E.insert)?P.retain(k,i.default.diff(T.attributes,E.attributes)):P.push(E).delete(k);break}f-=k}}),P.chop()}eachLine(g,b=`
`){const D=new r.default(this.ops);let P=new h,y=0;for(;D.hasNext();){if(D.peekType()!=="insert")return;const w=D.peek(),A=o.default.length(w)-D.peekLength(),S=typeof w.insert=="string"?w.insert.indexOf(b,A)-A:-1;if(S<0)P.push(D.next());else if(S>0)P.push(D.next(S));else{if(g(P,D.next(1).attributes||{},y)===!1)return;y+=1,P=new h}}P.length()>0&&g(P,{},y)}invert(g){const b=new h;return this.reduce((D,P)=>{if(P.insert)b.delete(o.default.length(P));else{if(typeof P.retain=="number"&&P.attributes==null)return b.retain(P.retain),D+P.retain;if(P.delete||typeof P.retain=="number"){const y=P.delete||P.retain;return g.slice(D,D+y).forEach(A=>{P.delete?b.push(A):P.retain&&P.attributes&&b.retain(o.default.length(A),i.default.invert(P.attributes,A.attributes))}),D+y}else if(typeof P.retain=="object"&&P.retain!==null){const y=g.slice(D,D+1),w=new r.default(y.ops).next(),[A,S,f]=m(P.retain,w.insert),k=h.getHandler(A);return b.retain({[A]:k.invert(S,f)},i.default.invert(P.attributes,w.attributes)),D+1}}return D},0),b.chop()}transform(g,b=!1){if(b=!!b,typeof g=="number")return this.transformPosition(g,b);const D=g,P=new r.default(this.ops),y=new r.default(D.ops),w=new h;for(;P.hasNext()||y.hasNext();)if(P.peekType()==="insert"&&(b||y.peekType()!=="insert"))w.retain(o.default.length(P.next()));else if(y.peekType()==="insert")w.push(y.next());else{const A=Math.min(P.peekLength(),y.peekLength()),S=P.next(A),f=y.next(A);if(S.delete)continue;if(f.delete)w.push(f);else{const k=S.retain,T=f.retain;let E=typeof T=="object"&&T!==null?T:A;if(typeof k=="object"&&k!==null&&typeof T=="object"&&T!==null){const $=Object.keys(k)[0];if($===Object.keys(T)[0]){const R=h.getHandler($);R&&(E={[$]:R.transform(k[$],T[$],b)})}}w.retain(E,i.default.transform(S.attributes,f.attributes,b))}}return w.chop()}transformPosition(g,b=!1){b=!!b;const D=new r.default(this.ops);let P=0;for(;D.hasNext()&&P<=g;){const y=D.peekLength(),w=D.peekType();if(D.next(),w==="delete"){g-=Math.min(y,g-P);continue}else w==="insert"&&(P<g||!b)&&(g+=y);P+=y}return g}}h.Op=o.default,h.OpIterator=r.default,h.AttributeMap=i.default,h.handlers={},t.default=h,n.exports=h,n.exports.default=h})(Dt,Dt.exports);var Ae=Br(Dt.exports);class ta extends Mt{static value(){}optimize(){(this.prev||this.next)&&this.remove()}length(){return 0}value(){return""}}ta.blotName="break";ta.tagName="BR";class Kt extends $l{}const Ud={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Wl(n){return n.replace(/[&<>"']/g,t=>Ud[t])}class Lt extends hi{static allowedChildren=[Lt,ta,Mt,Kt];static order=["cursor","inline","link","underline","strike","italic","bold","script","code"];static compare(t,e){const s=Lt.order.indexOf(t),l=Lt.order.indexOf(e);return s>=0||l>=0?s-l:t===e?0:t<e?-1:1}formatAt(t,e,s,l){if(Lt.compare(this.statics.blotName,s)<0&&this.scroll.query(s,Ie.BLOT)){const i=this.isolate(t,e);l&&i.wrap(s,l)}else super.formatAt(t,e,s,l)}optimize(t){if(super.optimize(t),this.parent instanceof Lt&&Lt.compare(this.statics.blotName,this.parent.statics.blotName)>0){const e=this.parent.isolate(this.offset(),this.length());this.moveChildren(e),e.wrap(this)}}}const Ji=1;class _t extends Us{cache={};delta(){return this.cache.delta==null&&(this.cache.delta=Uo(this)),this.cache.delta}deleteAt(t,e){super.deleteAt(t,e),this.cache={}}formatAt(t,e,s,l){e<=0||(this.scroll.query(s,Ie.BLOCK)?t+e===this.length()&&this.format(s,l):super.formatAt(t,Math.min(e,this.length()-t-1),s,l),this.cache={})}insertAt(t,e,s){if(s!=null){super.insertAt(t,e,s),this.cache={};return}if(e.length===0)return;const l=e.split(`
`),i=l.shift();i.length>0&&(t<this.length()-1||this.children.tail==null?super.insertAt(Math.min(t,this.length()-1),i):this.children.tail.insertAt(this.children.tail.length(),i),this.cache={});let o=this;l.reduce((r,u)=>(o=o.split(r,!0),o.insertAt(0,u),u.length),t+i.length)}insertBefore(t,e){const{head:s}=this.children;super.insertBefore(t,e),s instanceof ta&&s.remove(),this.cache={}}length(){return this.cache.length==null&&(this.cache.length=super.length()+Ji),this.cache.length}moveChildren(t,e){super.moveChildren(t,e),this.cache={}}optimize(t){super.optimize(t),this.cache={}}path(t){return super.path(t,!0)}removeChild(t){super.removeChild(t),this.cache={}}split(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(e&&(t===0||t>=this.length()-Ji)){const l=this.clone();return t===0?(this.parent.insertBefore(l,this),this):(this.parent.insertBefore(l,this.next),l)}const s=super.split(t,e);return this.cache={},s}}_t.blotName="block";_t.tagName="P";_t.defaultChild=ta;_t.allowedChildren=[ta,Lt,Mt,Kt];class Ut extends Mt{attach(){super.attach(),this.attributes=new ql(this.domNode)}delta(){return new Ae().insert(this.value(),{...this.formats(),...this.attributes.values()})}format(t,e){const s=this.scroll.query(t,Ie.BLOCK_ATTRIBUTE);s!=null&&this.attributes.attribute(s,e)}formatAt(t,e,s,l){this.format(s,l)}insertAt(t,e,s){if(s!=null){super.insertAt(t,e,s);return}const l=e.split(`
`),i=l.pop(),o=l.map(u=>{const m=this.scroll.create(_t.blotName);return m.insertAt(0,u),m}),r=this.split(t);o.forEach(u=>{this.parent.insertBefore(u,r)}),i&&this.parent.insertBefore(this.scroll.create("text",i),r)}}Ut.scope=Ie.BLOCK_BLOT;function Uo(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return n.descendants(Ct).reduce((e,s)=>s.length()===0?e:e.insert(s.value(),Rt(s,{},t)),new Ae).insert(`
`,Rt(n))}function Rt(n){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;return n==null||("formats"in n&&typeof n.formats=="function"&&(t={...t,...n.formats()},e&&delete t["code-token"]),n.parent==null||n.parent.statics.blotName==="scroll"||n.parent.statics.scope!==n.statics.scope)?t:Rt(n.parent,t,e)}class Jt extends Mt{static blotName="cursor";static className="ql-cursor";static tagName="span";static CONTENTS="\uFEFF";static value(){}constructor(t,e,s){super(t,e),this.selection=s,this.textNode=document.createTextNode(Jt.CONTENTS),this.domNode.appendChild(this.textNode),this.savedLength=0}detach(){this.parent!=null&&this.parent.removeChild(this)}format(t,e){if(this.savedLength!==0){super.format(t,e);return}let s=this,l=0;for(;s!=null&&s.statics.scope!==Ie.BLOCK_BLOT;)l+=s.offset(s.parent),s=s.parent;s!=null&&(this.savedLength=Jt.CONTENTS.length,s.optimize(),s.formatAt(l,Jt.CONTENTS.length,t,e),this.savedLength=0)}index(t,e){return t===this.textNode?0:super.index(t,e)}length(){return this.savedLength}position(){return[this.textNode,this.textNode.data.length]}remove(){super.remove(),this.parent=null}restore(){if(this.selection.composing||this.parent==null)return null;const t=this.selection.getNativeRange();for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);const e=this.prev instanceof Kt?this.prev:null,s=e?e.length():0,l=this.next instanceof Kt?this.next:null,i=l?l.text:"",{textNode:o}=this,r=o.data.split(Jt.CONTENTS).join("");o.data=Jt.CONTENTS;let u;if(e)u=e,(r||l)&&(e.insertAt(e.length(),r+i),l&&l.remove());else if(l)u=l,l.insertAt(0,r);else{const m=document.createTextNode(r);u=this.scroll.create(m),this.parent.insertBefore(u,this)}if(this.remove(),t){const m=(g,b)=>e&&g===e.domNode?b:g===o?s+b-1:l&&g===l.domNode?s+r.length+b:null,h=m(t.start.node,t.start.offset),v=m(t.end.node,t.end.offset);if(h!==null&&v!==null)return{startNode:u.domNode,startOffset:h,endNode:u.domNode,endOffset:v}}return null}update(t,e){if(t.some(s=>s.type==="characterData"&&s.target===this.textNode)){const s=this.restore();s&&(e.range=s)}}optimize(t){super.optimize(t);let{parent:e}=this;for(;e;){if(e.domNode.tagName==="A"){this.savedLength=Jt.CONTENTS.length,e.isolate(this.offset(e),this.length()).unwrap(),this.savedLength=0;break}e=e.parent}}value(){return""}}var zo={exports:{}};(function(n){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function l(u,m,h){this.fn=u,this.context=m,this.once=h||!1}function i(u,m,h,v,g){if(typeof h!="function")throw new TypeError("The listener must be a function");var b=new l(h,v||u,g),D=e?e+m:m;return u._events[D]?u._events[D].fn?u._events[D]=[u._events[D],b]:u._events[D].push(b):(u._events[D]=b,u._eventsCount++),u}function o(u,m){--u._eventsCount===0?u._events=new s:delete u._events[m]}function r(){this._events=new s,this._eventsCount=0}r.prototype.eventNames=function(){var m=[],h,v;if(this._eventsCount===0)return m;for(v in h=this._events)t.call(h,v)&&m.push(e?v.slice(1):v);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(h)):m},r.prototype.listeners=function(m){var h=e?e+m:m,v=this._events[h];if(!v)return[];if(v.fn)return[v.fn];for(var g=0,b=v.length,D=new Array(b);g<b;g++)D[g]=v[g].fn;return D},r.prototype.listenerCount=function(m){var h=e?e+m:m,v=this._events[h];return v?v.fn?1:v.length:0},r.prototype.emit=function(m,h,v,g,b,D){var P=e?e+m:m;if(!this._events[P])return!1;var y=this._events[P],w=arguments.length,A,S;if(y.fn){switch(y.once&&this.removeListener(m,y.fn,void 0,!0),w){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,h),!0;case 3:return y.fn.call(y.context,h,v),!0;case 4:return y.fn.call(y.context,h,v,g),!0;case 5:return y.fn.call(y.context,h,v,g,b),!0;case 6:return y.fn.call(y.context,h,v,g,b,D),!0}for(S=1,A=new Array(w-1);S<w;S++)A[S-1]=arguments[S];y.fn.apply(y.context,A)}else{var f=y.length,k;for(S=0;S<f;S++)switch(y[S].once&&this.removeListener(m,y[S].fn,void 0,!0),w){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,h);break;case 3:y[S].fn.call(y[S].context,h,v);break;case 4:y[S].fn.call(y[S].context,h,v,g);break;default:if(!A)for(k=1,A=new Array(w-1);k<w;k++)A[k-1]=arguments[k];y[S].fn.apply(y[S].context,A)}}return!0},r.prototype.on=function(m,h,v){return i(this,m,h,v,!1)},r.prototype.once=function(m,h,v){return i(this,m,h,v,!0)},r.prototype.removeListener=function(m,h,v,g){var b=e?e+m:m;if(!this._events[b])return this;if(!h)return o(this,b),this;var D=this._events[b];if(D.fn)D.fn===h&&(!g||D.once)&&(!v||D.context===v)&&o(this,b);else{for(var P=0,y=[],w=D.length;P<w;P++)(D[P].fn!==h||g&&!D[P].once||v&&D[P].context!==v)&&y.push(D[P]);y.length?this._events[b]=y.length===1?y[0]:y:o(this,b)}return this},r.prototype.removeAllListeners=function(m){var h;return m?(h=e?e+m:m,this._events[h]&&o(this,h)):(this._events=new s,this._eventsCount=0),this},r.prototype.off=r.prototype.removeListener,r.prototype.addListener=r.prototype.on,r.prefixed=e,r.EventEmitter=r,n.exports=r})(zo);var zd=zo.exports,ai=new WeakMap;const si=["error","warn","log","info"];let li="warn";function jo(n){if(li&&si.indexOf(n)<=si.indexOf(li)){for(var t=arguments.length,e=new Array(t>1?t-1:0),s=1;s<t;s++)e[s-1]=arguments[s];console[n](...e)}}function _a(n){return si.reduce((t,e)=>(t[e]=jo.bind(console,e,n),t),{})}_a.level=n=>{li=n};jo.level=_a.level;const Bn=_a("quill:events"),jd=["selectionchange","mousedown","mouseup","click"];jd.forEach(n=>{document.addEventListener(n,function(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];Array.from(document.querySelectorAll(".ql-container")).forEach(l=>{const i=ai.get(l);i&&i.emitter&&i.emitter.handleDOM(...e)})})});class Ee extends zd{static events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_BLOT_MOUNT:"scroll-blot-mount",SCROLL_BLOT_UNMOUNT:"scroll-blot-unmount",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SCROLL_EMBED_UPDATE:"scroll-embed-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change",COMPOSITION_BEFORE_START:"composition-before-start",COMPOSITION_START:"composition-start",COMPOSITION_BEFORE_END:"composition-before-end",COMPOSITION_END:"composition-end"};static sources={API:"api",SILENT:"silent",USER:"user"};constructor(){super(),this.domListeners={},this.on("error",Bn.error)}emit(){for(var t=arguments.length,e=new Array(t),s=0;s<t;s++)e[s]=arguments[s];return Bn.log.call(Bn,...e),super.emit(...e)}handleDOM(t){for(var e=arguments.length,s=new Array(e>1?e-1:0),l=1;l<e;l++)s[l-1]=arguments[l];(this.domListeners[t.type]||[]).forEach(i=>{let{node:o,handler:r}=i;(t.target===o||o.contains(t.target))&&r(t,...s)})}listenDOM(t,e,s){this.domListeners[t]||(this.domListeners[t]=[]),this.domListeners[t].push({node:e,handler:s})}}const Rn=_a("quill:selection");class Ra{constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.index=t,this.length=e}}class Yd{constructor(t,e){this.emitter=e,this.scroll=t,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=this.scroll.create("cursor",this),this.savedRange=new Ra(0,0),this.lastRange=this.savedRange,this.lastNative=null,this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,()=>{!this.mouseDown&&!this.composing&&setTimeout(this.update.bind(this,Ee.sources.USER),1)}),this.emitter.on(Ee.events.SCROLL_BEFORE_UPDATE,()=>{if(!this.hasFocus())return;const s=this.getNativeRange();s!=null&&s.start.node!==this.cursor.textNode&&this.emitter.once(Ee.events.SCROLL_UPDATE,(l,i)=>{try{this.root.contains(s.start.node)&&this.root.contains(s.end.node)&&this.setNativeRange(s.start.node,s.start.offset,s.end.node,s.end.offset);const o=i.some(r=>r.type==="characterData"||r.type==="childList"||r.type==="attributes"&&r.target===this.root);this.update(o?Ee.sources.SILENT:l)}catch{}})}),this.emitter.on(Ee.events.SCROLL_OPTIMIZE,(s,l)=>{if(l.range){const{startNode:i,startOffset:o,endNode:r,endOffset:u}=l.range;this.setNativeRange(i,o,r,u),this.update(Ee.sources.SILENT)}}),this.update(Ee.sources.SILENT)}handleComposition(){this.emitter.on(Ee.events.COMPOSITION_BEFORE_START,()=>{this.composing=!0}),this.emitter.on(Ee.events.COMPOSITION_END,()=>{if(this.composing=!1,this.cursor.parent){const t=this.cursor.restore();if(!t)return;setTimeout(()=>{this.setNativeRange(t.startNode,t.startOffset,t.endNode,t.endOffset)},1)}})}handleDragging(){this.emitter.listenDOM("mousedown",document.body,()=>{this.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,()=>{this.mouseDown=!1,this.update(Ee.sources.USER)})}focus(){this.hasFocus()||(this.root.focus({preventScroll:!0}),this.setRange(this.savedRange))}format(t,e){this.scroll.update();const s=this.getNativeRange();if(!(s==null||!s.native.collapsed||this.scroll.query(t,Ie.BLOCK))){if(s.start.node!==this.cursor.textNode){const l=this.scroll.find(s.start.node,!1);if(l==null)return;if(l instanceof Ct){const i=l.split(s.start.offset);l.parent.insertBefore(this.cursor,i)}else l.insertBefore(this.cursor,s.start.node);this.cursor.attach()}this.cursor.format(t,e),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}getBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const s=this.scroll.length();t=Math.min(t,s-1),e=Math.min(t+e,s-1)-t;let l,[i,o]=this.scroll.leaf(t);if(i==null)return null;if(e>0&&o===i.length()){const[h]=this.scroll.leaf(t+1);if(h){const[v]=this.scroll.line(t),[g]=this.scroll.line(t+1);v===g&&(i=h,o=0)}}[l,o]=i.position(o,!0);const r=document.createRange();if(e>0)return r.setStart(l,o),[i,o]=this.scroll.leaf(t+e),i==null?null:([l,o]=i.position(o,!0),r.setEnd(l,o),r.getBoundingClientRect());let u="left",m;if(l instanceof Text){if(!l.data.length)return null;o<l.data.length?(r.setStart(l,o),r.setEnd(l,o+1)):(r.setStart(l,o-1),r.setEnd(l,o),u="right"),m=r.getBoundingClientRect()}else{if(!(i.domNode instanceof Element))return null;m=i.domNode.getBoundingClientRect(),o>0&&(u="right")}return{bottom:m.top+m.height,height:m.height,left:m[u],right:m[u],top:m.top,width:0}}getNativeRange(){const t=document.getSelection();if(t==null||t.rangeCount<=0)return null;const e=t.getRangeAt(0);if(e==null)return null;const s=this.normalizeNative(e);return Rn.info("getNativeRange",s),s}getRange(){const t=this.scroll.domNode;if("isConnected"in t&&!t.isConnected)return[null,null];const e=this.getNativeRange();return e==null?[null,null]:[this.normalizedToRange(e),e]}hasFocus(){return document.activeElement===this.root||document.activeElement!=null&&qn(this.root,document.activeElement)}normalizedToRange(t){const e=[[t.start.node,t.start.offset]];t.native.collapsed||e.push([t.end.node,t.end.offset]);const s=e.map(o=>{const[r,u]=o,m=this.scroll.find(r,!0),h=m.offset(this.scroll);return u===0?h:m instanceof Ct?h+m.index(r,u):h+m.length()}),l=Math.min(Math.max(...s),this.scroll.length()-1),i=Math.min(l,...s);return new Ra(i,l-i)}normalizeNative(t){if(!qn(this.root,t.startContainer)||!t.collapsed&&!qn(this.root,t.endContainer))return null;const e={start:{node:t.startContainer,offset:t.startOffset},end:{node:t.endContainer,offset:t.endOffset},native:t};return[e.start,e.end].forEach(s=>{let{node:l,offset:i}=s;for(;!(l instanceof Text)&&l.childNodes.length>0;)if(l.childNodes.length>i)l=l.childNodes[i],i=0;else if(l.childNodes.length===i)l=l.lastChild,l instanceof Text?i=l.data.length:l.childNodes.length>0?i=l.childNodes.length:i=l.childNodes.length+1;else break;s.node=l,s.offset=i}),e}rangeToNative(t){const e=this.scroll.length(),s=(l,i)=>{l=Math.min(e-1,l);const[o,r]=this.scroll.leaf(l);return o?o.position(r,i):[null,-1]};return[...s(t.index,!1),...s(t.index+t.length,!0)]}setNativeRange(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t,l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(Rn.info("setNativeRange",t,e,s,l),t!=null&&(this.root.parentNode==null||t.parentNode==null||s.parentNode==null))return;const o=document.getSelection();if(o!=null)if(t!=null){this.hasFocus()||this.root.focus({preventScroll:!0});const{native:r}=this.getNativeRange()||{};if(r==null||i||t!==r.startContainer||e!==r.startOffset||s!==r.endContainer||l!==r.endOffset){t instanceof Element&&t.tagName==="BR"&&(e=Array.from(t.parentNode.childNodes).indexOf(t),t=t.parentNode),s instanceof Element&&s.tagName==="BR"&&(l=Array.from(s.parentNode.childNodes).indexOf(s),s=s.parentNode);const u=document.createRange();u.setStart(t,e),u.setEnd(s,l),o.removeAllRanges(),o.addRange(u)}}else o.removeAllRanges(),this.root.blur()}setRange(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ee.sources.API;if(typeof e=="string"&&(s=e,e=!1),Rn.info("setRange",t),t!=null){const l=this.rangeToNative(t);this.setNativeRange(...l,e)}else this.setNativeRange(null);this.update(s)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ee.sources.USER;const e=this.lastRange,[s,l]=this.getRange();if(this.lastRange=s,this.lastNative=l,this.lastRange!=null&&(this.savedRange=this.lastRange),!mi(e,this.lastRange)){if(!this.composing&&l!=null&&l.native.collapsed&&l.start.node!==this.cursor.textNode){const o=this.cursor.restore();o&&this.setNativeRange(o.startNode,o.startOffset,o.endNode,o.endOffset)}const i=[Ee.events.SELECTION_CHANGE,ps(this.lastRange),ps(e),t];this.emitter.emit(Ee.events.EDITOR_CHANGE,...i),t!==Ee.sources.SILENT&&this.emitter.emit(...i)}}}function qn(n,t){try{t.parentNode}catch{return!1}return n.contains(t)}const Wd=/^[ -~]*$/;class Hd{constructor(t){this.scroll=t,this.delta=this.getDelta()}applyDelta(t){this.scroll.update();let e=this.scroll.length();this.scroll.batchStart();const s=Xi(t),l=new Ae;return Gd(s.ops.slice()).reduce((o,r)=>{const u=Dt.exports.Op.length(r);let m=r.attributes||{},h=!1,v=!1;if(r.insert!=null){if(l.retain(u),typeof r.insert=="string"){const D=r.insert;v=!D.endsWith(`
`)&&(e<=o||!!this.scroll.descendant(Ut,o)[0]),this.scroll.insertAt(o,D);const[P,y]=this.scroll.line(o);let w=La({},Rt(P));if(P instanceof _t){const[A]=P.descendant(Ct,y);A&&(w=La(w,Rt(A)))}m=Dt.exports.AttributeMap.diff(w,m)||{}}else if(typeof r.insert=="object"){const D=Object.keys(r.insert)[0];if(D==null)return o;const P=this.scroll.query(D,Ie.INLINE)!=null;if(P)(e<=o||!!this.scroll.descendant(Ut,o)[0])&&(v=!0);else if(o>0){const[y,w]=this.scroll.descendant(Ct,o-1);y instanceof Kt?y.value()[w]!==`
`&&(h=!0):y instanceof Mt&&y.statics.scope===Ie.INLINE_BLOT&&(h=!0)}if(this.scroll.insertAt(o,D,r.insert[D]),P){const[y]=this.scroll.descendant(Ct,o);if(y){const w=La({},Rt(y));m=Dt.exports.AttributeMap.diff(w,m)||{}}}}e+=u}else if(l.push(r),r.retain!==null&&typeof r.retain=="object"){const D=Object.keys(r.retain)[0];if(D==null)return o;this.scroll.updateEmbedAt(o,D,r.retain[D])}Object.keys(m).forEach(D=>{this.scroll.formatAt(o,u,D,m[D])});const g=h?1:0,b=v?1:0;return e+=g+b,l.retain(g),l.delete(b),o+u+g+b},0),l.reduce((o,r)=>typeof r.delete=="number"?(this.scroll.deleteAt(o,r.delete),o):o+Dt.exports.Op.length(r),0),this.scroll.batchEnd(),this.scroll.optimize(),this.update(s)}deleteText(t,e){return this.scroll.deleteAt(t,e),this.update(new Ae().retain(t).delete(e))}formatLine(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.scroll.update(),Object.keys(s).forEach(i=>{this.scroll.lines(t,Math.max(e,1)).forEach(o=>{o.format(i,s[i])})}),this.scroll.optimize();const l=new Ae().retain(t).retain(e,ps(s));return this.update(l)}formatText(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};Object.keys(s).forEach(i=>{this.scroll.formatAt(t,e,i,s[i])});const l=new Ae().retain(t).retain(e,ps(s));return this.update(l)}getContents(t,e){return this.delta.slice(t,t+e)}getDelta(){return this.scroll.lines().reduce((t,e)=>t.concat(e.delta()),new Ae)}getFormat(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=[],l=[];e===0?this.scroll.path(t).forEach(r=>{const[u]=r;u instanceof _t?s.push(u):u instanceof Ct&&l.push(u)}):(s=this.scroll.lines(t,e),l=this.scroll.descendants(Ct,t,e));const[i,o]=[s,l].map(r=>{const u=r.shift();if(u==null)return{};let m=Rt(u);for(;Object.keys(m).length>0;){const h=r.shift();if(h==null)return m;m=Zd(Rt(h),m)}return m});return{...i,...o}}getHTML(t,e){const[s,l]=this.scroll.line(t);if(s){const i=s.length();return s.length()>=l+e&&!(l===0&&e===i)?js(s,l,e,!0):js(this.scroll,t,e,!0)}return""}getText(t,e){return this.getContents(t,e).filter(s=>typeof s.insert=="string").map(s=>s.insert).join("")}insertContents(t,e){const s=Xi(e),l=new Ae().retain(t).concat(s);return this.scroll.insertContents(t,s),this.update(l)}insertEmbed(t,e,s){return this.scroll.insertAt(t,e,s),this.update(new Ae().retain(t).insert({[e]:s}))}insertText(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return e=e.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(t,e),Object.keys(s).forEach(l=>{this.scroll.formatAt(t,e.length,l,s[l])}),this.update(new Ae().retain(t).insert(e,ps(s)))}isBlank(){if(this.scroll.children.length===0)return!0;if(this.scroll.children.length>1)return!1;const t=this.scroll.children.head;if(t?.statics.blotName!==_t.blotName)return!1;const e=t;return e.children.length>1?!1:e.children.head instanceof ta}removeFormat(t,e){const s=this.getText(t,e),[l,i]=this.scroll.line(t+e);let o=0,r=new Ae;l!=null&&(o=l.length()-i,r=l.delta().slice(i,i+o-1).insert(`
`));const m=this.getContents(t,e+o).diff(new Ae().insert(s).concat(r)),h=new Ae().retain(t).concat(m);return this.applyDelta(h)}update(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0;const l=this.delta;if(e.length===1&&e[0].type==="characterData"&&e[0].target.data.match(Wd)&&this.scroll.find(e[0].target)){const i=this.scroll.find(e[0].target),o=Rt(i),r=i.offset(this.scroll),u=e[0].oldValue.replace(Jt.CONTENTS,""),m=new Ae().insert(u),h=new Ae().insert(i.value()),v=s&&{oldRange:Qi(s.oldRange,-r),newRange:Qi(s.newRange,-r)};t=new Ae().retain(r).concat(m.diff(h,v)).reduce((b,D)=>D.insert?b.insert(D.insert,o):b.push(D),new Ae),this.delta=l.compose(t)}else this.delta=this.getDelta(),(!t||!mi(l.compose(t),this.delta))&&(t=l.diff(this.delta,s));return t}}function ds(n,t,e){if(n.length===0){const[b]=Un(e.pop());return t<=0?`</li></${b}>`:`</li></${b}>${ds([],t-1,e)}`}const[{child:s,offset:l,length:i,indent:o,type:r},...u]=n,[m,h]=Un(r);if(o>t)return e.push(r),o===t+1?`<${m}><li${h}>${js(s,l,i)}${ds(u,o,e)}`:`<${m}><li>${ds(n,t+1,e)}`;const v=e[e.length-1];if(o===t&&r===v)return`</li><li${h}>${js(s,l,i)}${ds(u,o,e)}`;const[g]=Un(e.pop());return`</li></${g}>${ds(n,t-1,e)}`}function js(n,t,e){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if("html"in n&&typeof n.html=="function")return n.html(t,e);if(n instanceof Kt)return Wl(n.value().slice(t,t+e)).replaceAll(" ","&nbsp;");if(n instanceof Qt){if(n.statics.blotName==="list-container"){const m=[];return n.children.forEachAt(t,e,(h,v,g)=>{const b="formats"in h&&typeof h.formats=="function"?h.formats():{};m.push({child:h,offset:v,length:g,indent:b.indent||0,type:b.list})}),ds(m,-1,[])}const l=[];if(n.children.forEachAt(t,e,(m,h,v)=>{l.push(js(m,h,v))}),s||n.statics.blotName==="list")return l.join("");const{outerHTML:i,innerHTML:o}=n.domNode,[r,u]=i.split(`>${o}<`);return r==="<table"?`<table style="border: 1px solid #000;">${l.join("")}<${u}`:`${r}>${l.join("")}<${u}`}return n.domNode instanceof Element?n.domNode.outerHTML:""}function Zd(n,t){return Object.keys(t).reduce((e,s)=>{if(n[s]==null)return e;const l=t[s];return l===n[s]?e[s]=l:Array.isArray(l)?l.indexOf(n[s])<0?e[s]=l.concat([n[s]]):e[s]=l:e[s]=[l,n[s]],e},{})}function Un(n){const t=n==="ordered"?"ol":"ul";switch(n){case"checked":return[t,' data-list="checked"'];case"unchecked":return[t,' data-list="unchecked"'];default:return[t,""]}}function Xi(n){return n.reduce((t,e)=>{if(typeof e.insert=="string"){const s=e.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return t.insert(s,e.attributes)}return t.push(e)},new Ae)}function Qi(n,t){let{index:e,length:s}=n;return new Ra(e+t,s)}function Gd(n){const t=[];return n.forEach(e=>{typeof e.insert=="string"?e.insert.split(`
`).forEach((l,i)=>{i&&t.push({insert:`
`,attributes:e.attributes}),l&&t.push({insert:l,attributes:e.attributes})}):t.push(e)}),t}class ra{static DEFAULTS={};constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.quill=t,this.options=e}}const _l="\uFEFF";class Ci extends Mt{constructor(t,e){super(t,e),this.contentNode=document.createElement("span"),this.contentNode.setAttribute("contenteditable","false"),Array.from(this.domNode.childNodes).forEach(s=>{this.contentNode.appendChild(s)}),this.leftGuard=document.createTextNode(_l),this.rightGuard=document.createTextNode(_l),this.domNode.appendChild(this.leftGuard),this.domNode.appendChild(this.contentNode),this.domNode.appendChild(this.rightGuard)}index(t,e){return t===this.leftGuard?0:t===this.rightGuard?1:super.index(t,e)}restore(t){let e=null,s;const l=t.data.split(_l).join("");if(t===this.leftGuard)if(this.prev instanceof Kt){const i=this.prev.length();this.prev.insertAt(i,l),e={startNode:this.prev.domNode,startOffset:i+l.length}}else s=document.createTextNode(l),this.parent.insertBefore(this.scroll.create(s),this),e={startNode:s,startOffset:l.length};else t===this.rightGuard&&(this.next instanceof Kt?(this.next.insertAt(0,l),e={startNode:this.next.domNode,startOffset:l.length}):(s=document.createTextNode(l),this.parent.insertBefore(this.scroll.create(s),this.next),e={startNode:s,startOffset:l.length}));return t.data=_l,e}update(t,e){t.forEach(s=>{if(s.type==="characterData"&&(s.target===this.leftGuard||s.target===this.rightGuard)){const l=this.restore(s.target);l&&(e.range=l)}})}}class Jd{isComposing=!1;constructor(t,e){this.scroll=t,this.emitter=e,this.setupListeners()}setupListeners(){this.scroll.domNode.addEventListener("compositionstart",t=>{this.isComposing||this.handleCompositionStart(t)}),this.scroll.domNode.addEventListener("compositionend",t=>{this.isComposing&&queueMicrotask(()=>{this.handleCompositionEnd(t)})})}handleCompositionStart(t){const e=t.target instanceof Node?this.scroll.find(t.target,!0):null;e&&!(e instanceof Ci)&&(this.emitter.emit(Ee.events.COMPOSITION_BEFORE_START,t),this.scroll.batchStart(),this.emitter.emit(Ee.events.COMPOSITION_START,t),this.isComposing=!0)}handleCompositionEnd(t){this.emitter.emit(Ee.events.COMPOSITION_BEFORE_END,t),this.scroll.batchEnd(),this.emitter.emit(Ee.events.COMPOSITION_END,t),this.isComposing=!1}}class ks{static DEFAULTS={modules:{}};static themes={default:ks};modules={};constructor(t,e){this.quill=t,this.options=e}init(){Object.keys(this.options.modules).forEach(t=>{this.modules[t]==null&&this.addModule(t)})}addModule(t){const e=this.quill.constructor.import(`modules/${t}`);return this.modules[t]=new e(this.quill,this.options.modules[t]||{}),this.modules[t]}}const Xd=n=>n.parentElement||n.getRootNode().host||null,Qd=n=>{const t=n.getBoundingClientRect(),e="offsetWidth"in n&&Math.abs(t.width)/n.offsetWidth||1,s="offsetHeight"in n&&Math.abs(t.height)/n.offsetHeight||1;return{top:t.top,right:t.left+n.clientWidth*e,bottom:t.top+n.clientHeight*s,left:t.left}},vl=n=>{const t=parseInt(n,10);return Number.isNaN(t)?0:t},Ki=(n,t,e,s,l,i)=>n<e&&t>s?0:n<e?-(e-n+l):t>s?t-n>s-e?n+l-e:t-s+i:0,Kd=(n,t)=>{const e=n.ownerDocument;let s=t,l=n;for(;l;){const i=l===e.body,o=i?{top:0,right:window.visualViewport?.width??e.documentElement.clientWidth,bottom:window.visualViewport?.height??e.documentElement.clientHeight,left:0}:Qd(l),r=getComputedStyle(l),u=Ki(s.left,s.right,o.left,o.right,vl(r.scrollPaddingLeft),vl(r.scrollPaddingRight)),m=Ki(s.top,s.bottom,o.top,o.bottom,vl(r.scrollPaddingTop),vl(r.scrollPaddingBottom));if(u||m)if(i)e.defaultView?.scrollBy(u,m);else{const{scrollLeft:h,scrollTop:v}=l;m&&(l.scrollTop+=m),u&&(l.scrollLeft+=u);const g=l.scrollLeft-h,b=l.scrollTop-v;s={left:s.left-g,top:s.top-b,right:s.right-g,bottom:s.bottom-b}}l=i||r.position==="fixed"?null:Xd(l)}},em=100,tm=["block","break","cursor","inline","scroll","text"],am=(n,t,e)=>{const s=new _s;return tm.forEach(l=>{const i=t.query(l);i&&s.register(i)}),n.forEach(l=>{let i=t.query(l);i||e.error(`Cannot register "${l}" specified in "formats" config. Are you sure it was registered?`);let o=0;for(;i;)if(s.register(i),i="blotName"in i?i.requiredContainer??null:null,o+=1,o>em){e.error(`Cycle detected in registering blot requiredContainer: "${l}"`);break}}),s},fs=_a("quill"),yl=new _s;Qt.uiClass="ql-ui";class ue{static DEFAULTS={bounds:null,modules:{clipboard:!0,keyboard:!0,history:!0,uploader:!0},placeholder:"",readOnly:!1,registry:yl,theme:"default"};static events=Ee.events;static sources=Ee.sources;static version="2.0.3";static imports={delta:Ae,parchment:Sd,"core/module":ra,"core/theme":ks};static debug(t){t===!0&&(t="log"),_a.level(t)}static find(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return ai.get(t)||yl.find(t,e)}static import(t){return this.imports[t]==null&&fs.error(`Cannot import ${t}. Are you sure it was registered?`),this.imports[t]}static register(){if(typeof(arguments.length<=0?void 0:arguments[0])!="string"){const t=arguments.length<=0?void 0:arguments[0],e=!!(!(arguments.length<=1)&&arguments[1]),s="attrName"in t?t.attrName:t.blotName;typeof s=="string"?this.register(`formats/${s}`,t,e):Object.keys(t).forEach(l=>{this.register(l,t[l],e)})}else{const t=arguments.length<=0?void 0:arguments[0],e=arguments.length<=1?void 0:arguments[1],s=!!(!(arguments.length<=2)&&arguments[2]);this.imports[t]!=null&&!s&&fs.warn(`Overwriting ${t} with`,e),this.imports[t]=e,(t.startsWith("blots/")||t.startsWith("formats/"))&&e&&typeof e!="boolean"&&e.blotName!=="abstract"&&yl.register(e),typeof e.register=="function"&&e.register(yl)}}constructor(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.options=sm(t,e),this.container=this.options.container,this.container==null){fs.error("Invalid Quill container",t);return}this.options.debug&&ue.debug(this.options.debug);const s=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",ai.set(this.container,this),this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.emitter=new Ee;const l=_i.blotName,i=this.options.registry.query(l);if(!i||!("blotName"in i))throw new Error(`Cannot initialize Quill without "${l}" blot`);if(this.scroll=new i(this.options.registry,this.root,{emitter:this.emitter}),this.editor=new Hd(this.scroll),this.selection=new Yd(this.scroll,this.emitter),this.composition=new Jd(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.uploader=this.theme.addModule("uploader"),this.theme.addModule("input"),this.theme.addModule("uiNode"),this.theme.init(),this.emitter.on(Ee.events.EDITOR_CHANGE,o=>{o===Ee.events.TEXT_CHANGE&&this.root.classList.toggle("ql-blank",this.editor.isBlank())}),this.emitter.on(Ee.events.SCROLL_UPDATE,(o,r)=>{const u=this.selection.lastRange,[m]=this.selection.getRange(),h=u&&m?{oldRange:u,newRange:m}:void 0;Gt.call(this,()=>this.editor.update(null,r,h),o)}),this.emitter.on(Ee.events.SCROLL_EMBED_UPDATE,(o,r)=>{const u=this.selection.lastRange,[m]=this.selection.getRange(),h=u&&m?{oldRange:u,newRange:m}:void 0;Gt.call(this,()=>{const v=new Ae().retain(o.offset(this)).retain({[o.statics.blotName]:r});return this.editor.update(v,[],h)},ue.sources.USER)}),s){const o=this.clipboard.convert({html:`${s}<p><br></p>`,text:`
`});this.setContents(o)}this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable(),this.allowReadOnlyEdits=!1}addContainer(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof t=="string"){const s=t;t=document.createElement("div"),t.classList.add(s)}return this.container.insertBefore(t,e),t}blur(){this.selection.setRange(null)}deleteText(t,e,s){return[t,e,,s]=pa(t,e,s),Gt.call(this,()=>this.editor.deleteText(t,e),s,t,-1*e)}disable(){this.enable(!1)}editReadOnly(t){this.allowReadOnlyEdits=!0;const e=t();return this.allowReadOnlyEdits=!1,e}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(t),this.container.classList.toggle("ql-disabled",!t)}focus(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.selection.focus(),t.preventScroll||this.scrollSelectionIntoView()}format(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ee.sources.API;return Gt.call(this,()=>{const l=this.getSelection(!0);let i=new Ae;if(l==null)return i;if(this.scroll.query(t,Ie.BLOCK))i=this.editor.formatLine(l.index,l.length,{[t]:e});else{if(l.length===0)return this.selection.format(t,e),i;i=this.editor.formatText(l.index,l.length,{[t]:e})}return this.setSelection(l,Ee.sources.SILENT),i},s)}formatLine(t,e,s,l,i){let o;return[t,e,o,i]=pa(t,e,s,l,i),Gt.call(this,()=>this.editor.formatLine(t,e,o),i,t,0)}formatText(t,e,s,l,i){let o;return[t,e,o,i]=pa(t,e,s,l,i),Gt.call(this,()=>this.editor.formatText(t,e,o),i,t,0)}getBounds(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=null;if(typeof t=="number"?s=this.selection.getBounds(t,e):s=this.selection.getBounds(t.index,t.length),!s)return null;const l=this.container.getBoundingClientRect();return{bottom:s.bottom-l.top,height:s.height,left:s.left-l.left,right:s.right-l.left,top:s.top-l.top,width:s.width}}getContents(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-t;return[t,e]=pa(t,e),this.editor.getContents(t,e)}getFormat(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof t=="number"?this.editor.getFormat(t,e):this.editor.getFormat(t.index,t.length)}getIndex(t){return t.offset(this.scroll)}getLength(){return this.scroll.length()}getLeaf(t){return this.scroll.leaf(t)}getLine(t){return this.scroll.line(t)}getLines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof t!="number"?this.scroll.lines(t.index,t.length):this.scroll.lines(t,e)}getModule(t){return this.theme.modules[t]}getSelection(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&this.focus(),this.update(),this.selection.getRange()[0]}getSemanticHTML(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(e=e??this.getLength()-t),[t,e]=pa(t,e),this.editor.getHTML(t,e)}getText(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1?arguments[1]:void 0;return typeof t=="number"&&(e=e??this.getLength()-t),[t,e]=pa(t,e),this.editor.getText(t,e)}hasFocus(){return this.selection.hasFocus()}insertEmbed(t,e,s){let l=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ue.sources.API;return Gt.call(this,()=>this.editor.insertEmbed(t,e,s),l,t)}insertText(t,e,s,l,i){let o;return[t,,o,i]=pa(t,0,s,l,i),Gt.call(this,()=>this.editor.insertText(t,e,o),i,t,e.length)}isEnabled(){return this.scroll.isEnabled()}off(){return this.emitter.off(...arguments)}on(){return this.emitter.on(...arguments)}once(){return this.emitter.once(...arguments)}removeFormat(t,e,s){return[t,e,,s]=pa(t,e,s),Gt.call(this,()=>this.editor.removeFormat(t,e),s,t)}scrollRectIntoView(t){Kd(this.root,t)}scrollIntoView(){console.warn("Quill#scrollIntoView() has been deprecated and will be removed in the near future. Please use Quill#scrollSelectionIntoView() instead."),this.scrollSelectionIntoView()}scrollSelectionIntoView(){const t=this.selection.lastRange,e=t&&this.selection.getBounds(t.index,t.length);e&&this.scrollRectIntoView(e)}setContents(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee.sources.API;return Gt.call(this,()=>{t=new Ae(t);const s=this.getLength(),l=this.editor.deleteText(0,s),i=this.editor.insertContents(0,t),o=this.editor.deleteText(this.getLength()-1,1);return l.compose(i).compose(o)},e)}setSelection(t,e,s){t==null?this.selection.setRange(null,e||ue.sources.API):([t,e,,s]=pa(t,e,s),this.selection.setRange(new Ra(Math.max(0,t),e),s),s!==Ee.sources.SILENT&&this.scrollSelectionIntoView())}setText(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee.sources.API;const s=new Ae().insert(t);return this.setContents(s,e)}update(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Ee.sources.USER;const e=this.scroll.update(t);return this.selection.update(t),e}updateContents(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ee.sources.API;return Gt.call(this,()=>(t=new Ae(t),this.editor.applyDelta(t)),e,!0)}}function eo(n){return typeof n=="string"?document.querySelector(n):n}function zn(n){return Object.entries(n??{}).reduce((t,e)=>{let[s,l]=e;return{...t,[s]:l===!0?{}:l}},{})}function to(n){return Object.fromEntries(Object.entries(n).filter(t=>t[1]!==void 0))}function sm(n,t){const e=eo(n);if(!e)throw new Error("Invalid Quill container");const l=!t.theme||t.theme===ue.DEFAULTS.theme?ks:ue.import(`themes/${t.theme}`);if(!l)throw new Error(`Invalid theme ${t.theme}. Did you register it?`);const{modules:i,...o}=ue.DEFAULTS,{modules:r,...u}=l.DEFAULTS;let m=zn(t.modules);m!=null&&m.toolbar&&m.toolbar.constructor!==Object&&(m={...m,toolbar:{container:m.toolbar}});const h=La({},zn(i),zn(r),m),v={...o,...to(u),...to(t)};let g=t.registry;return g?t.formats&&fs.warn('Ignoring "formats" option because "registry" is specified'):g=t.formats?am(t.formats,v.registry,fs):v.registry,{...v,registry:g,container:e,theme:l,modules:Object.entries(h).reduce((b,D)=>{let[P,y]=D;if(!y)return b;const w=ue.import(`modules/${P}`);return w==null?(fs.error(`Cannot load ${P} module. Are you sure you registered it?`),b):{...b,[P]:La({},w.DEFAULTS||{},y)}},{}),bounds:eo(v.bounds)}}function Gt(n,t,e,s){if(!this.isEnabled()&&t===Ee.sources.USER&&!this.allowReadOnlyEdits)return new Ae;let l=e==null?null:this.getSelection();const i=this.editor.delta,o=n();if(l!=null&&(e===!0&&(e=l.index),s==null?l=ao(l,o,t):s!==0&&(l=ao(l,e,s,t)),this.setSelection(l,Ee.sources.SILENT)),o.length()>0){const r=[Ee.events.TEXT_CHANGE,o,i,t];this.emitter.emit(Ee.events.EDITOR_CHANGE,...r),t!==Ee.sources.SILENT&&this.emitter.emit(...r)}return o}function pa(n,t,e,s,l){let i={};return typeof n.index=="number"&&typeof n.length=="number"?typeof t!="number"?(l=s,s=e,e=t,t=n.length,n=n.index):(t=n.length,n=n.index):typeof t!="number"&&(l=s,s=e,e=t,t=0),typeof e=="object"?(i=e,l=s):typeof e=="string"&&(s!=null?i[e]=s:l=e),l=l||Ee.sources.API,[n,t,i,l]}function ao(n,t,e,s){const l=typeof e=="number"?e:0;if(n==null)return null;let i,o;return t&&typeof t.transformPosition=="function"?[i,o]=[n.index,n.index+n.length].map(r=>t.transformPosition(r,s!==Ee.sources.USER)):[i,o]=[n.index,n.index+n.length].map(r=>r<t||r===t&&s===Ee.sources.USER?r:l>=0?r+l:Math.max(t,r+l)),new Ra(i,o-i)}class Ya extends Ul{}function so(n){return n instanceof _t||n instanceof Ut}function lo(n){return typeof n.updateContent=="function"}class lm extends _i{static blotName="scroll";static className="ql-editor";static tagName="DIV";static defaultChild=_t;static allowedChildren=[_t,Ut,Ya];constructor(t,e,s){let{emitter:l}=s;super(t,e),this.emitter=l,this.batch=!1,this.optimize(),this.enable(),this.domNode.addEventListener("dragstart",i=>this.handleDragStart(i))}batchStart(){Array.isArray(this.batch)||(this.batch=[])}batchEnd(){if(!this.batch)return;const t=this.batch;this.batch=!1,this.update(t)}emitMount(t){this.emitter.emit(Ee.events.SCROLL_BLOT_MOUNT,t)}emitUnmount(t){this.emitter.emit(Ee.events.SCROLL_BLOT_UNMOUNT,t)}emitEmbedUpdate(t,e){this.emitter.emit(Ee.events.SCROLL_EMBED_UPDATE,t,e)}deleteAt(t,e){const[s,l]=this.line(t),[i]=this.line(t+e);if(super.deleteAt(t,e),i!=null&&s!==i&&l>0){if(s instanceof Ut||i instanceof Ut){this.optimize();return}const o=i.children.head instanceof ta?null:i.children.head;s.moveChildren(i,o),s.remove()}this.optimize()}enable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",t?"true":"false")}formatAt(t,e,s,l){super.formatAt(t,e,s,l),this.optimize()}insertAt(t,e,s){if(t>=this.length())if(s==null||this.scroll.query(e,Ie.BLOCK)==null){const l=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(l),s==null&&e.endsWith(`
`)?l.insertAt(0,e.slice(0,-1),s):l.insertAt(0,e,s)}else{const l=this.scroll.create(e,s);this.appendChild(l)}else super.insertAt(t,e,s);this.optimize()}insertBefore(t,e){if(t.statics.scope===Ie.INLINE_BLOT){const s=this.scroll.create(this.statics.defaultChild.blotName);s.appendChild(t),super.insertBefore(s,e)}else super.insertBefore(t,e)}insertContents(t,e){const s=this.deltaToRenderBlocks(e.concat(new Ae().insert(`
`))),l=s.pop();if(l==null)return;this.batchStart();const i=s.shift();if(i){const u=i.type==="block"&&(i.delta.length()===0||!this.descendant(Ut,t)[0]&&t<this.length()),m=i.type==="block"?i.delta:new Ae().insert({[i.key]:i.value});jn(this,t,m);const h=i.type==="block"?1:0,v=t+m.length()+h;u&&this.insertAt(v-1,`
`);const g=Rt(this.line(t)[0]),b=Dt.exports.AttributeMap.diff(g,i.attributes)||{};Object.keys(b).forEach(D=>{this.formatAt(v-1,1,D,b[D])}),t=v}let[o,r]=this.children.find(t);if(s.length&&(o&&(o=o.split(r),r=0),s.forEach(u=>{if(u.type==="block"){const m=this.createBlock(u.attributes,o||void 0);jn(m,0,u.delta)}else{const m=this.create(u.key,u.value);this.insertBefore(m,o||void 0),Object.keys(u.attributes).forEach(h=>{m.format(h,u.attributes[h])})}})),l.type==="block"&&l.delta.length()){const u=o?o.offset(o.scroll)+r:this.length();jn(this,u,l.delta)}this.batchEnd(),this.optimize()}isEnabled(){return this.domNode.getAttribute("contenteditable")==="true"}leaf(t){const e=this.path(t).pop();if(!e)return[null,-1];const[s,l]=e;return s instanceof Ct?[s,l]:[null,-1]}line(t){return t===this.length()?this.line(t-1):this.descendant(so,t)}lines(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;const s=(l,i,o)=>{let r=[],u=o;return l.children.forEachAt(i,o,(m,h,v)=>{so(m)?r.push(m):m instanceof Ul&&(r=r.concat(s(m,h,u))),u-=v}),r};return s(this,t,e)}optimize(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch||(super.optimize(t,e),t.length>0&&this.emitter.emit(Ee.events.SCROLL_OPTIMIZE,t,e))}path(t){return super.path(t).slice(1)}remove(){}update(t){if(this.batch){Array.isArray(t)&&(this.batch=this.batch.concat(t));return}let e=Ee.sources.USER;typeof t=="string"&&(e=t),Array.isArray(t)||(t=this.observer.takeRecords()),t=t.filter(s=>{let{target:l}=s;const i=this.find(l,!0);return i&&!lo(i)}),t.length>0&&this.emitter.emit(Ee.events.SCROLL_BEFORE_UPDATE,e,t),super.update(t.concat([])),t.length>0&&this.emitter.emit(Ee.events.SCROLL_UPDATE,e,t)}updateEmbedAt(t,e,s){const[l]=this.descendant(i=>i instanceof Ut,t);l&&l.statics.blotName===e&&lo(l)&&l.updateContent(s)}handleDragStart(t){t.preventDefault()}deltaToRenderBlocks(t){const e=[];let s=new Ae;return t.forEach(l=>{const i=l?.insert;if(!!i)if(typeof i=="string"){const o=i.split(`
`);o.slice(0,-1).forEach(u=>{s.insert(u,l.attributes),e.push({type:"block",delta:s,attributes:l.attributes??{}}),s=new Ae});const r=o[o.length-1];r&&s.insert(r,l.attributes)}else{const o=Object.keys(i)[0];if(!o)return;this.query(o,Ie.INLINE)?s.push(l):(s.length()&&e.push({type:"block",delta:s,attributes:{}}),s=new Ae,e.push({type:"blockEmbed",key:o,value:i[o],attributes:l.attributes??{}}))}}),s.length()&&e.push({type:"block",delta:s,attributes:{}}),e}createBlock(t,e){let s;const l={};Object.entries(t).forEach(r=>{let[u,m]=r;this.query(u,Ie.BLOCK&Ie.BLOT)!=null?s=u:l[u]=m});const i=this.create(s||this.statics.defaultChild.blotName,s?t[s]:void 0);this.insertBefore(i,e||void 0);const o=i.length();return Object.entries(l).forEach(r=>{let[u,m]=r;i.formatAt(0,o,u,m)}),i}}function jn(n,t,e){e.reduce((s,l)=>{const i=Dt.exports.Op.length(l);let o=l.attributes||{};if(l.insert!=null){if(typeof l.insert=="string"){const r=l.insert;n.insertAt(s,r);const[u]=n.descendant(Ct,s),m=Rt(u);o=Dt.exports.AttributeMap.diff(m,o)||{}}else if(typeof l.insert=="object"){const r=Object.keys(l.insert)[0];if(r==null)return s;if(n.insertAt(s,r,l.insert[r]),n.scroll.query(r,Ie.INLINE)!=null){const[m]=n.descendant(Ct,s),h=Rt(m);o=Dt.exports.AttributeMap.diff(h,o)||{}}}}return Object.keys(o).forEach(r=>{n.formatAt(s,i,r,o[r])}),s+i},t)}const xi={scope:Ie.BLOCK,whitelist:["right","center","justify"]},nm=new oa("align","align",xi),Yo=new ea("align","ql-align",xi),Wo=new Da("align","text-align",xi);class Ho extends Da{value(t){let e=super.value(t);return e.startsWith("rgb(")?(e=e.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),`#${e.split(",").map(l=>`00${parseInt(l,10).toString(16)}`.slice(-2)).join("")}`):e}}const im=new ea("color","ql-color",{scope:Ie.INLINE}),wi=new Ho("color","color",{scope:Ie.INLINE}),om=new ea("background","ql-bg",{scope:Ie.INLINE}),Ti=new Ho("background","background-color",{scope:Ie.INLINE});class Wa extends Ya{static create(t){const e=super.create(t);return e.setAttribute("spellcheck","false"),e}code(t,e){return this.children.map(s=>s.length()<=1?"":s.domNode.innerText).join(`
`).slice(t,t+e)}html(t,e){return`<pre>
${Wl(this.code(t,e))}
</pre>`}}class At extends _t{static TAB="  ";static register(){ue.register(Wa)}}class Li extends Lt{}Li.blotName="code";Li.tagName="CODE";At.blotName="code-block";At.className="ql-code-block";At.tagName="DIV";Wa.blotName="code-block-container";Wa.className="ql-code-block-container";Wa.tagName="DIV";Wa.allowedChildren=[At];At.allowedChildren=[Kt,ta,Jt];At.requiredContainer=Wa;const Ei={scope:Ie.BLOCK,whitelist:["rtl"]},Zo=new oa("direction","dir",Ei),Go=new ea("direction","ql-direction",Ei),Jo=new Da("direction","direction",Ei),Xo={scope:Ie.INLINE,whitelist:["serif","monospace"]},Qo=new ea("font","ql-font",Xo);class rm extends Da{value(t){return super.value(t).replace(/["']/g,"")}}const Ko=new rm("font","font-family",Xo),er=new ea("size","ql-size",{scope:Ie.INLINE,whitelist:["small","large","huge"]}),tr=new Da("size","font-size",{scope:Ie.INLINE,whitelist:["10px","18px","32px"]}),cm=_a("quill:keyboard"),um=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey";class Hl extends ra{static match(t,e){return["altKey","ctrlKey","metaKey","shiftKey"].some(s=>!!e[s]!==t[s]&&e[s]!==null)?!1:e.key===t.key||e.key===t.which}constructor(t,e){super(t,e),this.bindings={},Object.keys(this.options.bindings).forEach(s=>{this.options.bindings[s]&&this.addBinding(this.options.bindings[s])}),this.addBinding({key:"Enter",shiftKey:null},this.handleEnter),this.addBinding({key:"Enter",metaKey:null,ctrlKey:null,altKey:null},()=>{}),/Firefox/i.test(navigator.userAgent)?(this.addBinding({key:"Backspace"},{collapsed:!0},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0},this.handleDelete)):(this.addBinding({key:"Backspace"},{collapsed:!0,prefix:/^.?$/},this.handleBackspace),this.addBinding({key:"Delete"},{collapsed:!0,suffix:/^.?$/},this.handleDelete)),this.addBinding({key:"Backspace"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Delete"},{collapsed:!1},this.handleDeleteRange),this.addBinding({key:"Backspace",altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},this.handleBackspace),this.listen()}addBinding(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const l=mm(t);if(l==null){cm.warn("Attempted to add invalid keyboard binding",l);return}typeof e=="function"&&(e={handler:e}),typeof s=="function"&&(s={handler:s}),(Array.isArray(l.key)?l.key:[l.key]).forEach(o=>{const r={...l,key:o,...e,...s};this.bindings[r.key]=this.bindings[r.key]||[],this.bindings[r.key].push(r)})}listen(){this.quill.root.addEventListener("keydown",t=>{if(t.defaultPrevented||t.isComposing||t.keyCode===229&&(t.key==="Enter"||t.key==="Backspace"))return;const l=(this.bindings[t.key]||[]).concat(this.bindings[t.which]||[]).filter(w=>Hl.match(t,w));if(l.length===0)return;const i=ue.find(t.target,!0);if(i&&i.scroll!==this.quill.scroll)return;const o=this.quill.getSelection();if(o==null||!this.quill.hasFocus())return;const[r,u]=this.quill.getLine(o.index),[m,h]=this.quill.getLeaf(o.index),[v,g]=o.length===0?[m,h]:this.quill.getLeaf(o.index+o.length),b=m instanceof $l?m.value().slice(0,h):"",D=v instanceof $l?v.value().slice(g):"",P={collapsed:o.length===0,empty:o.length===0&&r.length()<=1,format:this.quill.getFormat(o),line:r,offset:u,prefix:b,suffix:D,event:t};l.some(w=>{if(w.collapsed!=null&&w.collapsed!==P.collapsed||w.empty!=null&&w.empty!==P.empty||w.offset!=null&&w.offset!==P.offset)return!1;if(Array.isArray(w.format)){if(w.format.every(A=>P.format[A]==null))return!1}else if(typeof w.format=="object"&&!Object.keys(w.format).every(A=>w.format[A]===!0?P.format[A]!=null:w.format[A]===!1?P.format[A]==null:mi(w.format[A],P.format[A])))return!1;return w.prefix!=null&&!w.prefix.test(P.prefix)||w.suffix!=null&&!w.suffix.test(P.suffix)?!1:w.handler.call(this,o,P,w)!==!0})&&t.preventDefault()})}handleBackspace(t,e){const s=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(e.prefix)?2:1;if(t.index===0||this.quill.getLength()<=1)return;let l={};const[i]=this.quill.getLine(t.index);let o=new Ae().retain(t.index-s).delete(s);if(e.offset===0){const[r]=this.quill.getLine(t.index-1);if(r&&!(r.statics.blotName==="block"&&r.length()<=1)){const m=i.formats(),h=this.quill.getFormat(t.index-1,1);if(l=Dt.exports.AttributeMap.diff(m,h)||{},Object.keys(l).length>0){const v=new Ae().retain(t.index+i.length()-2).retain(1,l);o=o.compose(v)}}}this.quill.updateContents(o,ue.sources.USER),this.quill.focus()}handleDelete(t,e){const s=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(e.suffix)?2:1;if(t.index>=this.quill.getLength()-s)return;let l={};const[i]=this.quill.getLine(t.index);let o=new Ae().retain(t.index).delete(s);if(e.offset>=i.length()-1){const[r]=this.quill.getLine(t.index+1);if(r){const u=i.formats(),m=this.quill.getFormat(t.index,1);l=Dt.exports.AttributeMap.diff(u,m)||{},Object.keys(l).length>0&&(o=o.retain(r.length()-1).retain(1,l))}}this.quill.updateContents(o,ue.sources.USER),this.quill.focus()}handleDeleteRange(t){Si({range:t,quill:this.quill}),this.quill.focus()}handleEnter(t,e){const s=Object.keys(e.format).reduce((i,o)=>(this.quill.scroll.query(o,Ie.BLOCK)&&!Array.isArray(e.format[o])&&(i[o]=e.format[o]),i),{}),l=new Ae().retain(t.index).delete(t.length).insert(`
`,s);this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(t.index+1,ue.sources.SILENT),this.quill.focus()}}const dm={bindings:{bold:Yn("bold"),italic:Yn("italic"),underline:Yn("underline"),indent:{key:"Tab",format:["blockquote","indent","list"],handler(n,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","+1",ue.sources.USER),!1)}},outdent:{key:"Tab",shiftKey:!0,format:["blockquote","indent","list"],handler(n,t){return t.collapsed&&t.offset!==0?!0:(this.quill.format("indent","-1",ue.sources.USER),!1)}},"outdent backspace":{key:"Backspace",collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler(n,t){t.format.indent!=null?this.quill.format("indent","-1",ue.sources.USER):t.format.list!=null&&this.quill.format("list",!1,ue.sources.USER)}},"indent code-block":no(!0),"outdent code-block":no(!1),"remove tab":{key:"Tab",shiftKey:!0,collapsed:!0,prefix:/\t$/,handler(n){this.quill.deleteText(n.index-1,1,ue.sources.USER)}},tab:{key:"Tab",handler(n,t){if(t.format.table)return!0;this.quill.history.cutoff();const e=new Ae().retain(n.index).delete(n.length).insert("	");return this.quill.updateContents(e,ue.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index+1,ue.sources.SILENT),!1}},"blockquote empty enter":{key:"Enter",collapsed:!0,format:["blockquote"],empty:!0,handler(){this.quill.format("blockquote",!1,ue.sources.USER)}},"list empty enter":{key:"Enter",collapsed:!0,format:["list"],empty:!0,handler(n,t){const e={list:!1};t.format.indent&&(e.indent=!1),this.quill.formatLine(n.index,n.length,e,ue.sources.USER)}},"checklist enter":{key:"Enter",collapsed:!0,format:{list:"checked"},handler(n){const[t,e]=this.quill.getLine(n.index),s={...t.formats(),list:"checked"},l=new Ae().retain(n.index).insert(`
`,s).retain(t.length()-e-1).retain(1,{list:"unchecked"});this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(n.index+1,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}},"header enter":{key:"Enter",collapsed:!0,format:["header"],suffix:/^$/,handler(n,t){const[e,s]=this.quill.getLine(n.index),l=new Ae().retain(n.index).insert(`
`,t.format).retain(e.length()-s-1).retain(1,{header:null});this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(n.index+1,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}},"table backspace":{key:"Backspace",format:["table"],collapsed:!0,offset:0,handler(){}},"table delete":{key:"Delete",format:["table"],collapsed:!0,suffix:/^$/,handler(){}},"table enter":{key:"Enter",shiftKey:null,format:["table"],handler(n){const t=this.quill.getModule("table");if(t){const[e,s,l,i]=t.getTable(n),o=pm(e,s,l,i);if(o==null)return;let r=e.offset();if(o<0){const u=new Ae().retain(r).insert(`
`);this.quill.updateContents(u,ue.sources.USER),this.quill.setSelection(n.index+1,n.length,ue.sources.SILENT)}else if(o>0){r+=e.length();const u=new Ae().retain(r).insert(`
`);this.quill.updateContents(u,ue.sources.USER),this.quill.setSelection(r,ue.sources.USER)}}}},"table tab":{key:"Tab",shiftKey:null,format:["table"],handler(n,t){const{event:e,line:s}=t,l=s.offset(this.quill.scroll);e.shiftKey?this.quill.setSelection(l-1,ue.sources.USER):this.quill.setSelection(l+s.length(),ue.sources.USER)}},"list autofill":{key:" ",shiftKey:null,collapsed:!0,format:{"code-block":!1,blockquote:!1,table:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler(n,t){if(this.quill.scroll.query("list")==null)return!0;const{length:e}=t.prefix,[s,l]=this.quill.getLine(n.index);if(l>e)return!0;let i;switch(t.prefix.trim()){case"[]":case"[ ]":i="unchecked";break;case"[x]":i="checked";break;case"-":case"*":i="bullet";break;default:i="ordered"}this.quill.insertText(n.index," ",ue.sources.USER),this.quill.history.cutoff();const o=new Ae().retain(n.index-l).delete(e+1).retain(s.length()-2-l).retain(1,{list:i});return this.quill.updateContents(o,ue.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(n.index-e,ue.sources.SILENT),!1}},"code exit":{key:"Enter",collapsed:!0,format:["code-block"],prefix:/^$/,suffix:/^\s*$/,handler(n){const[t,e]=this.quill.getLine(n.index);let s=2,l=t;for(;l!=null&&l.length()<=1&&l.formats()["code-block"];)if(l=l.prev,s-=1,s<=0){const i=new Ae().retain(n.index+t.length()-e-2).retain(1,{"code-block":null}).delete(1);return this.quill.updateContents(i,ue.sources.USER),this.quill.setSelection(n.index-1,ue.sources.SILENT),!1}return!0}},"embed left":bl("ArrowLeft",!1),"embed left shift":bl("ArrowLeft",!0),"embed right":bl("ArrowRight",!1),"embed right shift":bl("ArrowRight",!0),"table down":io(!1),"table up":io(!0)}};Hl.DEFAULTS=dm;function no(n){return{key:"Tab",shiftKey:!n,format:{"code-block":!0},handler(t,e){let{event:s}=e;const l=this.quill.scroll.query("code-block"),{TAB:i}=l;if(t.length===0&&!s.shiftKey){this.quill.insertText(t.index,i,ue.sources.USER),this.quill.setSelection(t.index+i.length,ue.sources.SILENT);return}const o=t.length===0?this.quill.getLines(t.index,1):this.quill.getLines(t);let{index:r,length:u}=t;o.forEach((m,h)=>{n?(m.insertAt(0,i),h===0?r+=i.length:u+=i.length):m.domNode.textContent.startsWith(i)&&(m.deleteAt(0,i.length),h===0?r-=i.length:u-=i.length)}),this.quill.update(ue.sources.USER),this.quill.setSelection(r,u,ue.sources.SILENT)}}}function bl(n,t){return{key:n,shiftKey:t,altKey:null,[n==="ArrowLeft"?"prefix":"suffix"]:/^$/,handler(s){let{index:l}=s;n==="ArrowRight"&&(l+=s.length+1);const[i]=this.quill.getLeaf(l);return i instanceof Mt?(n==="ArrowLeft"?t?this.quill.setSelection(s.index-1,s.length+1,ue.sources.USER):this.quill.setSelection(s.index-1,ue.sources.USER):t?this.quill.setSelection(s.index,s.length+1,ue.sources.USER):this.quill.setSelection(s.index+s.length+1,ue.sources.USER),!1):!0}}}function Yn(n){return{key:n[0],shortKey:!0,handler(t,e){this.quill.format(n,!e.format[n],ue.sources.USER)}}}function io(n){return{key:n?"ArrowUp":"ArrowDown",collapsed:!0,format:["table"],handler(t,e){const s=n?"prev":"next",l=e.line,i=l.parent[s];if(i!=null){if(i.statics.blotName==="table-row"){let o=i.children.head,r=l;for(;r.prev!=null;)r=r.prev,o=o.next;const u=o.offset(this.quill.scroll)+Math.min(e.offset,o.length()-1);this.quill.setSelection(u,0,ue.sources.USER)}}else{const o=l.table()[s];o!=null&&(n?this.quill.setSelection(o.offset(this.quill.scroll)+o.length()-1,0,ue.sources.USER):this.quill.setSelection(o.offset(this.quill.scroll),0,ue.sources.USER))}return!1}}}function mm(n){if(typeof n=="string"||typeof n=="number")n={key:n};else if(typeof n=="object")n=ps(n);else return null;return n.shortKey&&(n[um]=n.shortKey,delete n.shortKey),n}function Si(n){let{quill:t,range:e}=n;const s=t.getLines(e);let l={};if(s.length>1){const i=s[0].formats(),o=s[s.length-1].formats();l=Dt.exports.AttributeMap.diff(o,i)||{}}t.deleteText(e,ue.sources.USER),Object.keys(l).length>0&&t.formatLine(e.index,1,l,ue.sources.USER),t.setSelection(e.index,ue.sources.SILENT)}function pm(n,t,e,s){return t.prev==null&&t.next==null?e.prev==null&&e.next==null?s===0?-1:1:e.prev==null?-1:1:t.prev==null?-1:t.next==null?1:null}const gm=/font-weight:\s*normal/,fm=["P","OL","UL"],oo=n=>n&&fm.includes(n.tagName),hm=n=>{Array.from(n.querySelectorAll("br")).filter(t=>oo(t.previousElementSibling)&&oo(t.nextElementSibling)).forEach(t=>{t.parentNode?.removeChild(t)})},_m=n=>{Array.from(n.querySelectorAll('b[style*="font-weight"]')).filter(t=>t.getAttribute("style")?.match(gm)).forEach(t=>{const e=n.createDocumentFragment();e.append(...t.childNodes),t.parentNode?.replaceChild(e,t)})};function vm(n){n.querySelector('[id^="docs-internal-guid-"]')&&(_m(n),hm(n))}const ym=/\bmso-list:[^;]*ignore/i,bm=/\bmso-list:[^;]*\bl(\d+)/i,km=/\bmso-list:[^;]*\blevel(\d+)/i,Cm=(n,t)=>{const e=n.getAttribute("style"),s=e?.match(bm);if(!s)return null;const l=Number(s[1]),i=e?.match(km),o=i?Number(i[1]):1,r=new RegExp(`@list l${l}:level${o}\\s*\\{[^\\}]*mso-level-number-format:\\s*([\\w-]+)`,"i"),u=t.match(r),m=u&&u[1]==="bullet"?"bullet":"ordered";return{id:l,indent:o,type:m,element:n}},xm=n=>{const t=Array.from(n.querySelectorAll("[style*=mso-list]")),e=[],s=[];t.forEach(o=>{(o.getAttribute("style")||"").match(ym)?e.push(o):s.push(o)}),e.forEach(o=>o.parentNode?.removeChild(o));const l=n.documentElement.innerHTML,i=s.map(o=>Cm(o,l)).filter(o=>o);for(;i.length;){const o=[];let r=i.shift();for(;r;)o.push(r),r=i.length&&i[0]?.element===r.element.nextElementSibling&&i[0].id===r.id?i.shift():null;const u=document.createElement("ul");o.forEach(v=>{const g=document.createElement("li");g.setAttribute("data-list",v.type),v.indent>1&&g.setAttribute("class",`ql-indent-${v.indent-1}`),g.innerHTML=v.element.innerHTML,u.appendChild(g)});const m=o[0]?.element,{parentNode:h}=m??{};m&&h?.replaceChild(u,m),o.slice(1).forEach(v=>{let{element:g}=v;h?.removeChild(g)})}};function wm(n){n.documentElement.getAttribute("xmlns:w")==="urn:schemas-microsoft-com:office:word"&&xm(n)}const Tm=[wm,vm],Lm=n=>{n.documentElement&&Tm.forEach(t=>{t(n)})},Em=_a("quill:clipboard"),Sm=[[Node.TEXT_NODE,qm],[Node.TEXT_NODE,co],["br",Nm],[Node.ELEMENT_NODE,co],[Node.ELEMENT_NODE,Pm],[Node.ELEMENT_NODE,Dm],[Node.ELEMENT_NODE,Bm],["li",Fm],["ol, ul",Vm],["pre",Om],["tr",Rm],["b",Wn("bold")],["i",Wn("italic")],["strike",Wn("strike")],["style",Mm]],Am=[nm,Zo].reduce((n,t)=>(n[t.keyName]=t,n),{}),ro=[Wo,Ti,wi,Jo,Ko,tr].reduce((n,t)=>(n[t.keyName]=t,n),{});class Im extends ra{static DEFAULTS={matchers:[]};constructor(t,e){super(t,e),this.quill.root.addEventListener("copy",s=>this.onCaptureCopy(s,!1)),this.quill.root.addEventListener("cut",s=>this.onCaptureCopy(s,!0)),this.quill.root.addEventListener("paste",this.onCapturePaste.bind(this)),this.matchers=[],Sm.concat(this.options.matchers??[]).forEach(s=>{let[l,i]=s;this.addMatcher(l,i)})}addMatcher(t,e){this.matchers.push([t,e])}convert(t){let{html:e,text:s}=t,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(l[At.blotName])return new Ae().insert(s||"",{[At.blotName]:l[At.blotName]});if(!e)return new Ae().insert(s||"",l);const i=this.convertHTML(e);return Xs(i,`
`)&&(i.ops[i.ops.length-1].attributes==null||l.table)?i.compose(new Ae().retain(i.length()-1).delete(1)):i}normalizeHTML(t){Lm(t)}convertHTML(t){const e=new DOMParser().parseFromString(t,"text/html");this.normalizeHTML(e);const s=e.body,l=new WeakMap,[i,o]=this.prepareMatching(s,l);return Ai(this.quill.scroll,s,i,o,l)}dangerouslyPasteHTML(t,e){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ue.sources.API;if(typeof t=="string"){const l=this.convert({html:t,text:""});this.quill.setContents(l,e),this.quill.setSelection(0,ue.sources.SILENT)}else{const l=this.convert({html:e,text:""});this.quill.updateContents(new Ae().retain(t).concat(l),s),this.quill.setSelection(t+l.length(),ue.sources.SILENT)}}onCaptureCopy(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(t.defaultPrevented)return;t.preventDefault();const[s]=this.quill.selection.getRange();if(s==null)return;const{html:l,text:i}=this.onCopy(s,e);t.clipboardData?.setData("text/plain",i),t.clipboardData?.setData("text/html",l),e&&Si({range:s,quill:this.quill})}normalizeURIList(t){return t.split(/\r?\n/).filter(e=>e[0]!=="#").join(`
`)}onCapturePaste(t){if(t.defaultPrevented||!this.quill.isEnabled())return;t.preventDefault();const e=this.quill.getSelection(!0);if(e==null)return;const s=t.clipboardData?.getData("text/html");let l=t.clipboardData?.getData("text/plain");if(!s&&!l){const o=t.clipboardData?.getData("text/uri-list");o&&(l=this.normalizeURIList(o))}const i=Array.from(t.clipboardData?.files||[]);if(!s&&i.length>0){this.quill.uploader.upload(e,i);return}if(s&&i.length>0){const o=new DOMParser().parseFromString(s,"text/html");if(o.body.childElementCount===1&&o.body.firstElementChild?.tagName==="IMG"){this.quill.uploader.upload(e,i);return}}this.onPaste(e,{html:s,text:l})}onCopy(t){const e=this.quill.getText(t);return{html:this.quill.getSemanticHTML(t),text:e}}onPaste(t,e){let{text:s,html:l}=e;const i=this.quill.getFormat(t.index),o=this.convert({text:s,html:l},i);Em.log("onPaste",o,{text:s,html:l});const r=new Ae().retain(t.index).delete(t.length).concat(o);this.quill.updateContents(r,ue.sources.USER),this.quill.setSelection(r.length()-t.length,ue.sources.SILENT),this.quill.scrollSelectionIntoView()}prepareMatching(t,e){const s=[],l=[];return this.matchers.forEach(i=>{const[o,r]=i;switch(o){case Node.TEXT_NODE:l.push(r);break;case Node.ELEMENT_NODE:s.push(r);break;default:Array.from(t.querySelectorAll(o)).forEach(u=>{e.has(u)?e.get(u)?.push(r):e.set(u,[r])});break}}),[s,l]}}function Ha(n,t,e,s){return s.query(t)?n.reduce((l,i)=>{if(!i.insert)return l;if(i.attributes&&i.attributes[t])return l.push(i);const o=e?{[t]:e}:{};return l.insert(i.insert,{...o,...i.attributes})},new Ae):n}function Xs(n,t){let e="";for(let s=n.ops.length-1;s>=0&&e.length<t.length;--s){const l=n.ops[s];if(typeof l.insert!="string")break;e=l.insert+e}return e.slice(-1*t.length)===t}function wa(n,t){if(!(n instanceof Element))return!1;const e=t.query(n);return e&&e.prototype instanceof Mt?!1:["address","article","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","iframe","li","main","nav","ol","output","p","pre","section","table","td","tr","ul","video"].includes(n.tagName.toLowerCase())}function $m(n,t){return n.previousElementSibling&&n.nextElementSibling&&!wa(n.previousElementSibling,t)&&!wa(n.nextElementSibling,t)}const kl=new WeakMap;function ar(n){return n==null?!1:(kl.has(n)||(n.tagName==="PRE"?kl.set(n,!0):kl.set(n,ar(n.parentNode))),kl.get(n))}function Ai(n,t,e,s,l){return t.nodeType===t.TEXT_NODE?s.reduce((i,o)=>o(t,i,n),new Ae):t.nodeType===t.ELEMENT_NODE?Array.from(t.childNodes||[]).reduce((i,o)=>{let r=Ai(n,o,e,s,l);return o.nodeType===t.ELEMENT_NODE&&(r=e.reduce((u,m)=>m(o,u,n),r),r=(l.get(o)||[]).reduce((u,m)=>m(o,u,n),r)),i.concat(r)},new Ae):new Ae}function Wn(n){return(t,e,s)=>Ha(e,n,!0,s)}function Dm(n,t,e){const s=oa.keys(n),l=ea.keys(n),i=Da.keys(n),o={};return s.concat(l).concat(i).forEach(r=>{let u=e.query(r,Ie.ATTRIBUTE);u!=null&&(o[u.attrName]=u.value(n),o[u.attrName])||(u=Am[r],u!=null&&(u.attrName===r||u.keyName===r)&&(o[u.attrName]=u.value(n)||void 0),u=ro[r],u!=null&&(u.attrName===r||u.keyName===r)&&(u=ro[r],o[u.attrName]=u.value(n)||void 0))}),Object.entries(o).reduce((r,u)=>{let[m,h]=u;return Ha(r,m,h,e)},t)}function Pm(n,t,e){const s=e.query(n);if(s==null)return t;if(s.prototype instanceof Mt){const l={},i=s.value(n);if(i!=null)return l[s.blotName]=i,new Ae().insert(l,s.formats(n,e))}else if(s.prototype instanceof Us&&!Xs(t,`
`)&&t.insert(`
`),"blotName"in s&&"formats"in s&&typeof s.formats=="function")return Ha(t,s.blotName,s.formats(n,e),e);return t}function Nm(n,t){return Xs(t,`
`)||t.insert(`
`),t}function Om(n,t,e){const s=e.query("code-block"),l=s&&"formats"in s&&typeof s.formats=="function"?s.formats(n,e):!0;return Ha(t,"code-block",l,e)}function Mm(){return new Ae}function Fm(n,t,e){const s=e.query(n);if(s==null||s.blotName!=="list"||!Xs(t,`
`))return t;let l=-1,i=n.parentNode;for(;i!=null;)["OL","UL"].includes(i.tagName)&&(l+=1),i=i.parentNode;return l<=0?t:t.reduce((o,r)=>r.insert?r.attributes&&typeof r.attributes.indent=="number"?o.push(r):o.insert(r.insert,{indent:l,...r.attributes||{}}):o,new Ae)}function Vm(n,t,e){const s=n;let l=s.tagName==="OL"?"ordered":"bullet";const i=s.getAttribute("data-checked");return i&&(l=i==="true"?"checked":"unchecked"),Ha(t,"list",l,e)}function co(n,t,e){if(!Xs(t,`
`)){if(wa(n,e)&&(n.childNodes.length>0||n instanceof HTMLParagraphElement))return t.insert(`
`);if(t.length()>0&&n.nextSibling){let s=n.nextSibling;for(;s!=null;){if(wa(s,e))return t.insert(`
`);const l=e.query(s);if(l&&l.prototype instanceof Ut)return t.insert(`
`);s=s.firstChild}}}return t}function Bm(n,t,e){const s={},l=n.style||{};return l.fontStyle==="italic"&&(s.italic=!0),l.textDecoration==="underline"&&(s.underline=!0),l.textDecoration==="line-through"&&(s.strike=!0),(l.fontWeight?.startsWith("bold")||parseInt(l.fontWeight,10)>=700)&&(s.bold=!0),t=Object.entries(s).reduce((i,o)=>{let[r,u]=o;return Ha(i,r,u,e)},t),parseFloat(l.textIndent||0)>0?new Ae().insert("	").concat(t):t}function Rm(n,t,e){const s=n.parentElement?.tagName==="TABLE"?n.parentElement:n.parentElement?.parentElement;if(s!=null){const i=Array.from(s.querySelectorAll("tr")).indexOf(n)+1;return Ha(t,"table",i,e)}return t}function qm(n,t,e){let s=n.data;if(n.parentElement?.tagName==="O:P")return t.insert(s.trim());if(!ar(n)){if(s.trim().length===0&&s.includes(`
`)&&!$m(n,e))return t;s=s.replace(/[^\S\u00a0]/g," "),s=s.replace(/ {2,}/g," "),(n.previousSibling==null&&n.parentElement!=null&&wa(n.parentElement,e)||n.previousSibling instanceof Element&&wa(n.previousSibling,e))&&(s=s.replace(/^ /,"")),(n.nextSibling==null&&n.parentElement!=null&&wa(n.parentElement,e)||n.nextSibling instanceof Element&&wa(n.nextSibling,e))&&(s=s.replace(/ $/,"")),s=s.replaceAll("\xA0"," ")}return t.insert(s)}class Um extends ra{static DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};lastRecorded=0;ignoreChange=!1;stack={undo:[],redo:[]};currentRange=null;constructor(t,e){super(t,e),this.quill.on(ue.events.EDITOR_CHANGE,(s,l,i,o)=>{s===ue.events.SELECTION_CHANGE?l&&o!==ue.sources.SILENT&&(this.currentRange=l):s===ue.events.TEXT_CHANGE&&(this.ignoreChange||(!this.options.userOnly||o===ue.sources.USER?this.record(l,i):this.transform(l)),this.currentRange=ni(this.currentRange,l))}),this.quill.keyboard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.quill.keyboard.addBinding({key:["z","Z"],shortKey:!0,shiftKey:!0},this.redo.bind(this)),/Win/i.test(navigator.platform)&&this.quill.keyboard.addBinding({key:"y",shortKey:!0},this.redo.bind(this)),this.quill.root.addEventListener("beforeinput",s=>{s.inputType==="historyUndo"?(this.undo(),s.preventDefault()):s.inputType==="historyRedo"&&(this.redo(),s.preventDefault())})}change(t,e){if(this.stack[t].length===0)return;const s=this.stack[t].pop();if(!s)return;const l=this.quill.getContents(),i=s.delta.invert(l);this.stack[e].push({delta:i,range:ni(s.range,i)}),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(s.delta,ue.sources.USER),this.ignoreChange=!1,this.restoreSelection(s)}clear(){this.stack={undo:[],redo:[]}}cutoff(){this.lastRecorded=0}record(t,e){if(t.ops.length===0)return;this.stack.redo=[];let s=t.invert(e),l=this.currentRange;const i=Date.now();if(this.lastRecorded+this.options.delay>i&&this.stack.undo.length>0){const o=this.stack.undo.pop();o&&(s=s.compose(o.delta),l=o.range)}else this.lastRecorded=i;s.length()!==0&&(this.stack.undo.push({delta:s,range:l}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift())}redo(){this.change("redo","undo")}transform(t){uo(this.stack.undo,t),uo(this.stack.redo,t)}undo(){this.change("undo","redo")}restoreSelection(t){if(t.range)this.quill.setSelection(t.range,ue.sources.USER);else{const e=jm(this.quill.scroll,t.delta);this.quill.setSelection(e,ue.sources.USER)}}}function uo(n,t){let e=t;for(let s=n.length-1;s>=0;s-=1){const l=n[s];n[s]={delta:e.transform(l.delta,!0),range:l.range&&ni(l.range,e)},e=l.delta.transform(e),n[s].delta.length()===0&&n.splice(s,1)}}function zm(n,t){const e=t.ops[t.ops.length-1];return e==null?!1:e.insert!=null?typeof e.insert=="string"&&e.insert.endsWith(`
`):e.attributes!=null?Object.keys(e.attributes).some(s=>n.query(s,Ie.BLOCK)!=null):!1}function jm(n,t){const e=t.reduce((l,i)=>l+(i.delete||0),0);let s=t.length()-e;return zm(n,t)&&(s-=1),s}function ni(n,t){if(!n)return n;const e=t.transformPosition(n.index),s=t.transformPosition(n.index+n.length);return{index:e,length:s-e}}class sr extends ra{constructor(t,e){super(t,e),t.root.addEventListener("drop",s=>{s.preventDefault();let l=null;if(document.caretRangeFromPoint)l=document.caretRangeFromPoint(s.clientX,s.clientY);else if(document.caretPositionFromPoint){const o=document.caretPositionFromPoint(s.clientX,s.clientY);l=document.createRange(),l.setStart(o.offsetNode,o.offset),l.setEnd(o.offsetNode,o.offset)}const i=l&&t.selection.normalizeNative(l);if(i){const o=t.selection.normalizedToRange(i);s.dataTransfer?.files&&this.upload(o,s.dataTransfer.files)}})}upload(t,e){const s=[];Array.from(e).forEach(l=>{l&&this.options.mimetypes?.includes(l.type)&&s.push(l)}),s.length>0&&this.options.handler.call(this,t,s)}}sr.DEFAULTS={mimetypes:["image/png","image/jpeg"],handler(n,t){if(!this.quill.scroll.query("image"))return;const e=t.map(s=>new Promise(l=>{const i=new FileReader;i.onload=()=>{l(i.result)},i.readAsDataURL(s)}));Promise.all(e).then(s=>{const l=s.reduce((i,o)=>i.insert({image:o}),new Ae().retain(n.index).delete(n.length));this.quill.updateContents(l,Ee.sources.USER),this.quill.setSelection(n.index+s.length,Ee.sources.SILENT)})}};const Ym=["insertText","insertReplacementText"];class Wm extends ra{constructor(t,e){super(t,e),t.root.addEventListener("beforeinput",s=>{this.handleBeforeInput(s)}),/Android/i.test(navigator.userAgent)||t.on(ue.events.COMPOSITION_BEFORE_START,()=>{this.handleCompositionStart()})}deleteRange(t){Si({range:t,quill:this.quill})}replaceText(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(t.length===0)return!1;if(e){const s=this.quill.getFormat(t.index,1);this.deleteRange(t),this.quill.updateContents(new Ae().retain(t.index).insert(e,s),ue.sources.USER)}else this.deleteRange(t);return this.quill.setSelection(t.index+e.length,0,ue.sources.SILENT),!0}handleBeforeInput(t){if(this.quill.composition.isComposing||t.defaultPrevented||!Ym.includes(t.inputType))return;const e=t.getTargetRanges?t.getTargetRanges()[0]:null;if(!e||e.collapsed===!0)return;const s=Hm(t);if(s==null)return;const l=this.quill.selection.normalizeNative(e),i=l?this.quill.selection.normalizedToRange(l):null;i&&this.replaceText(i,s)&&t.preventDefault()}handleCompositionStart(){const t=this.quill.getSelection();t&&this.replaceText(t)}}function Hm(n){return typeof n.data=="string"?n.data:n.dataTransfer?.types.includes("text/plain")?n.dataTransfer.getData("text/plain"):null}const Zm=/Mac/i.test(navigator.platform),Gm=100,Jm=n=>!!(n.key==="ArrowLeft"||n.key==="ArrowRight"||n.key==="ArrowUp"||n.key==="ArrowDown"||n.key==="Home"||Zm&&n.key==="a"&&n.ctrlKey===!0);class Xm extends ra{isListening=!1;selectionChangeDeadline=0;constructor(t,e){super(t,e),this.handleArrowKeys(),this.handleNavigationShortcuts()}handleArrowKeys(){this.quill.keyboard.addBinding({key:["ArrowLeft","ArrowRight"],offset:0,shiftKey:null,handler(t,e){let{line:s,event:l}=e;if(!(s instanceof Qt)||!s.uiNode)return!0;const i=getComputedStyle(s.domNode).direction==="rtl";return i&&l.key!=="ArrowRight"||!i&&l.key!=="ArrowLeft"?!0:(this.quill.setSelection(t.index-1,t.length+(l.shiftKey?1:0),ue.sources.USER),!1)}})}handleNavigationShortcuts(){this.quill.root.addEventListener("keydown",t=>{!t.defaultPrevented&&Jm(t)&&this.ensureListeningToSelectionChange()})}ensureListeningToSelectionChange(){if(this.selectionChangeDeadline=Date.now()+Gm,this.isListening)return;this.isListening=!0;const t=()=>{this.isListening=!1,Date.now()<=this.selectionChangeDeadline&&this.handleSelectionChange()};document.addEventListener("selectionchange",t,{once:!0})}handleSelectionChange(){const t=document.getSelection();if(!t)return;const e=t.getRangeAt(0);if(e.collapsed!==!0||e.startOffset!==0)return;const s=this.quill.scroll.find(e.startContainer);if(!(s instanceof Qt)||!s.uiNode)return;const l=document.createRange();l.setStartAfter(s.uiNode),l.setEndAfter(s.uiNode),t.removeAllRanges(),t.addRange(l)}}ue.register({"blots/block":_t,"blots/block/embed":Ut,"blots/break":ta,"blots/container":Ya,"blots/cursor":Jt,"blots/embed":Ci,"blots/inline":Lt,"blots/scroll":lm,"blots/text":Kt,"modules/clipboard":Im,"modules/history":Um,"modules/keyboard":Hl,"modules/uploader":sr,"modules/input":Wm,"modules/uiNode":Xm});class Qm extends ea{add(t,e){let s=0;if(e==="+1"||e==="-1"){const l=this.value(t)||0;s=e==="+1"?l+1:l-1}else typeof e=="number"&&(s=e);return s===0?(this.remove(t),!0):super.add(t,s.toString())}canAdd(t,e){return super.canAdd(t,e)||super.canAdd(t,parseInt(e,10))}value(t){return parseInt(super.value(t),10)||void 0}}const Km=new Qm("indent","ql-indent",{scope:Ie.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});class ep extends _t{static blotName="blockquote";static tagName="blockquote"}class tp extends _t{static blotName="header";static tagName=["H1","H2","H3","H4","H5","H6"];static formats(t){return this.tagName.indexOf(t.tagName)+1}}class Qs extends Ya{}Qs.blotName="list-container";Qs.tagName="OL";class Ks extends _t{static create(t){const e=super.create();return e.setAttribute("data-list",t),e}static formats(t){return t.getAttribute("data-list")||void 0}static register(){ue.register(Qs)}constructor(t,e){super(t,e);const s=e.ownerDocument.createElement("span"),l=i=>{if(!t.isEnabled())return;const o=this.statics.formats(e,t);o==="checked"?(this.format("list","unchecked"),i.preventDefault()):o==="unchecked"&&(this.format("list","checked"),i.preventDefault())};s.addEventListener("mousedown",l),s.addEventListener("touchstart",l),this.attachUI(s)}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("data-list",e):super.format(t,e)}}Ks.blotName="list";Ks.tagName="LI";Qs.allowedChildren=[Ks];Ks.requiredContainer=Qs;class Ii extends Lt{static blotName="bold";static tagName=["STRONG","B"];static create(){return super.create()}static formats(){return!0}optimize(t){super.optimize(t),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}class ap extends Ii{static blotName="italic";static tagName=["EM","I"]}class Nl extends Lt{static blotName="link";static tagName="A";static SANITIZED_URL="about:blank";static PROTOCOL_WHITELIST=["http","https","mailto","tel","sms"];static create(t){const e=super.create(t);return e.setAttribute("href",this.sanitize(t)),e.setAttribute("rel","noopener noreferrer"),e.setAttribute("target","_blank"),e}static formats(t){return t.getAttribute("href")}static sanitize(t){return lr(t,this.PROTOCOL_WHITELIST)?t:this.SANITIZED_URL}format(t,e){t!==this.statics.blotName||!e?super.format(t,e):this.domNode.setAttribute("href",this.constructor.sanitize(e))}}function lr(n,t){const e=document.createElement("a");e.href=n;const s=e.href.slice(0,e.href.indexOf(":"));return t.indexOf(s)>-1}class sp extends Lt{static blotName="script";static tagName=["SUB","SUP"];static create(t){return t==="super"?document.createElement("sup"):t==="sub"?document.createElement("sub"):super.create(t)}static formats(t){if(t.tagName==="SUB")return"sub";if(t.tagName==="SUP")return"super"}}class lp extends Ii{static blotName="strike";static tagName=["S","STRIKE"]}class np extends Lt{static blotName="underline";static tagName="U"}class ip extends Ci{static blotName="formula";static className="ql-formula";static tagName="SPAN";static create(t){if(window.katex==null)throw new Error("Formula module requires KaTeX.");const e=super.create(t);return typeof t=="string"&&(window.katex.render(t,e,{throwOnError:!1,errorColor:"#f00"}),e.setAttribute("data-value",t)),e}static value(t){return t.getAttribute("data-value")}html(){const{formula:t}=this.value();return`<span>${t}</span>`}}const mo=["alt","height","width"];class op extends Mt{static blotName="image";static tagName="IMG";static create(t){const e=super.create(t);return typeof t=="string"&&e.setAttribute("src",this.sanitize(t)),e}static formats(t){return mo.reduce((e,s)=>(t.hasAttribute(s)&&(e[s]=t.getAttribute(s)),e),{})}static match(t){return/\.(jpe?g|gif|png)$/.test(t)||/^data:image\/.+;base64/.test(t)}static sanitize(t){return lr(t,["http","https","data"])?t:"//:0"}static value(t){return t.getAttribute("src")}format(t,e){mo.indexOf(t)>-1?e?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}}const po=["height","width"];class rp extends Ut{static blotName="video";static className="ql-video";static tagName="IFRAME";static create(t){const e=super.create(t);return e.setAttribute("frameborder","0"),e.setAttribute("allowfullscreen","true"),e.setAttribute("src",this.sanitize(t)),e}static formats(t){return po.reduce((e,s)=>(t.hasAttribute(s)&&(e[s]=t.getAttribute(s)),e),{})}static sanitize(t){return Nl.sanitize(t)}static value(t){return t.getAttribute("src")}format(t,e){po.indexOf(t)>-1?e?this.domNode.setAttribute(t,e):this.domNode.removeAttribute(t):super.format(t,e)}html(){const{video:t}=this.value();return`<a href="${t}">${t}</a>`}}const Fs=new ea("code-token","hljs",{scope:Ie.INLINE});class fa extends Lt{static formats(t,e){for(;t!=null&&t!==e.domNode;){if(t.classList&&t.classList.contains(At.className))return super.formats(t,e);t=t.parentNode}}constructor(t,e,s){super(t,e,s),Fs.add(this.domNode,s)}format(t,e){t!==fa.blotName?super.format(t,e):e?Fs.add(this.domNode,e):(Fs.remove(this.domNode),this.domNode.classList.remove(this.statics.className))}optimize(){super.optimize(...arguments),Fs.value(this.domNode)||this.unwrap()}}fa.blotName="code-token";fa.className="ql-token";class qt extends At{static create(t){const e=super.create(t);return typeof t=="string"&&e.setAttribute("data-language",t),e}static formats(t){return t.getAttribute("data-language")||"plain"}static register(){}format(t,e){t===this.statics.blotName&&e?this.domNode.setAttribute("data-language",e):super.format(t,e)}replaceWith(t,e){return this.formatAt(0,this.length(),fa.blotName,!1),super.replaceWith(t,e)}}class Bs extends Wa{attach(){super.attach(),this.forceNext=!1,this.scroll.emitMount(this)}format(t,e){t===qt.blotName&&(this.forceNext=!0,this.children.forEach(s=>{s.format(t,e)}))}formatAt(t,e,s,l){s===qt.blotName&&(this.forceNext=!0),super.formatAt(t,e,s,l)}highlight(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.children.head==null)return;const l=`${Array.from(this.domNode.childNodes).filter(o=>o!==this.uiNode).map(o=>o.textContent).join(`
`)}
`,i=qt.formats(this.children.head.domNode);if(e||this.forceNext||this.cachedText!==l){if(l.trim().length>0||this.cachedText==null){const o=this.children.reduce((u,m)=>u.concat(Uo(m,!1)),new Ae),r=t(l,i);o.diff(r).reduce((u,m)=>{let{retain:h,attributes:v}=m;return h?(v&&Object.keys(v).forEach(g=>{[qt.blotName,fa.blotName].includes(g)&&this.formatAt(u,h,g,v[g])}),u+h):u},0)}this.cachedText=l,this.forceNext=!1}}html(t,e){const[s]=this.children.find(t);return`<pre data-language="${s?qt.formats(s.domNode):"plain"}">
${Wl(this.code(t,e))}
</pre>`}optimize(t){if(super.optimize(t),this.parent!=null&&this.children.head!=null&&this.uiNode!=null){const e=qt.formats(this.children.head.domNode);e!==this.uiNode.value&&(this.uiNode.value=e)}}}Bs.allowedChildren=[qt];qt.requiredContainer=Bs;qt.allowedChildren=[fa,Jt,Kt,ta];const cp=(n,t,e)=>{if(typeof n.versionString=="string"){const s=n.versionString.split(".")[0];if(parseInt(s,10)>=11)return n.highlight(e,{language:t}).value}return n.highlight(t,e).value};class nr extends ra{static register(){ue.register(fa,!0),ue.register(qt,!0),ue.register(Bs,!0)}constructor(t,e){if(super(t,e),this.options.hljs==null)throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");this.languages=this.options.languages.reduce((s,l)=>{let{key:i}=l;return s[i]=!0,s},{}),this.highlightBlot=this.highlightBlot.bind(this),this.initListener(),this.initTimer()}initListener(){this.quill.on(ue.events.SCROLL_BLOT_MOUNT,t=>{if(!(t instanceof Bs))return;const e=this.quill.root.ownerDocument.createElement("select");this.options.languages.forEach(s=>{let{key:l,label:i}=s;const o=e.ownerDocument.createElement("option");o.textContent=i,o.setAttribute("value",l),e.appendChild(o)}),e.addEventListener("change",()=>{t.format(qt.blotName,e.value),this.quill.root.focus(),this.highlight(t,!0)}),t.uiNode==null&&(t.attachUI(e),t.children.head&&(e.value=qt.formats(t.children.head.domNode)))})}initTimer(){let t=null;this.quill.on(ue.events.SCROLL_OPTIMIZE,()=>{t&&clearTimeout(t),t=setTimeout(()=>{this.highlight(),t=null},this.options.interval)})}highlight(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(this.quill.selection.composing)return;this.quill.update(ue.sources.USER);const s=this.quill.getSelection();(t==null?this.quill.scroll.descendants(Bs):[t]).forEach(i=>{i.highlight(this.highlightBlot,e)}),this.quill.update(ue.sources.SILENT),s!=null&&this.quill.setSelection(s,ue.sources.SILENT)}highlightBlot(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"plain";if(e=this.languages[e]?e:"plain",e==="plain")return Wl(t).split(`
`).reduce((l,i,o)=>(o!==0&&l.insert(`
`,{[At.blotName]:e}),l.insert(i)),new Ae);const s=this.quill.root.ownerDocument.createElement("div");return s.classList.add(At.className),s.innerHTML=cp(this.options.hljs,e,t),Ai(this.quill.scroll,s,[(l,i)=>{const o=Fs.value(l);return o?i.compose(new Ae().retain(i.length(),{[fa.blotName]:o})):i}],[(l,i)=>l.data.split(`
`).reduce((o,r,u)=>(u!==0&&o.insert(`
`,{[At.blotName]:e}),o.insert(r)),i)],new WeakMap)}}nr.DEFAULTS={hljs:(()=>window.hljs)(),interval:1e3,languages:[{key:"plain",label:"Plain"},{key:"bash",label:"Bash"},{key:"cpp",label:"C++"},{key:"cs",label:"C#"},{key:"css",label:"CSS"},{key:"diff",label:"Diff"},{key:"xml",label:"HTML/XML"},{key:"java",label:"Java"},{key:"javascript",label:"JavaScript"},{key:"markdown",label:"Markdown"},{key:"php",label:"PHP"},{key:"python",label:"Python"},{key:"ruby",label:"Ruby"},{key:"sql",label:"SQL"}]};class Xt extends _t{static blotName="table";static tagName="TD";static create(t){const e=super.create();return t?e.setAttribute("data-row",t):e.setAttribute("data-row",$i()),e}static formats(t){if(t.hasAttribute("data-row"))return t.getAttribute("data-row")}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}format(t,e){t===Xt.blotName&&e?this.domNode.setAttribute("data-row",e):super.format(t,e)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}class qa extends Ya{static blotName="table-row";static tagName="TR";checkMerge(){if(super.checkMerge()&&this.next.children.head!=null){const t=this.children.head.formats(),e=this.children.tail.formats(),s=this.next.children.head.formats(),l=this.next.children.tail.formats();return t.table===e.table&&t.table===s.table&&t.table===l.table}return!1}optimize(t){super.optimize(t),this.children.forEach(e=>{if(e.next==null)return;const s=e.formats(),l=e.next.formats();if(s.table!==l.table){const i=this.splitAfter(e);i&&i.optimize(),this.prev&&this.prev.optimize()}})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}class Ea extends Ya{static blotName="table-body";static tagName="TBODY"}class Ol extends Ya{static blotName="table-container";static tagName="TABLE";balanceCells(){const t=this.descendants(qa),e=t.reduce((s,l)=>Math.max(l.children.length,s),0);t.forEach(s=>{new Array(e-s.children.length).fill(0).forEach(()=>{let l;s.children.head!=null&&(l=Xt.formats(s.children.head.domNode));const i=this.scroll.create(Xt.blotName,l);s.appendChild(i),i.optimize()})})}cells(t){return this.rows().map(e=>e.children.at(t))}deleteColumn(t){const[e]=this.descendant(Ea);e==null||e.children.head==null||e.children.forEach(s=>{const l=s.children.at(t);l?.remove()})}insertColumn(t){const[e]=this.descendant(Ea);e==null||e.children.head==null||e.children.forEach(s=>{const l=s.children.at(t),i=Xt.formats(s.children.head.domNode),o=this.scroll.create(Xt.blotName,i);s.insertBefore(o,l)})}insertRow(t){const[e]=this.descendant(Ea);if(e==null||e.children.head==null)return;const s=$i(),l=this.scroll.create(qa.blotName);e.children.head.children.forEach(()=>{const o=this.scroll.create(Xt.blotName,s);l.appendChild(o)});const i=e.children.at(t);e.insertBefore(l,i)}rows(){const t=this.children.head;return t==null?[]:t.children.map(e=>e)}}Ol.allowedChildren=[Ea];Ea.requiredContainer=Ol;Ea.allowedChildren=[qa];qa.requiredContainer=Ea;qa.allowedChildren=[Xt];Xt.requiredContainer=qa;function $i(){return`row-${Math.random().toString(36).slice(2,6)}`}class up extends ra{static register(){ue.register(Xt),ue.register(qa),ue.register(Ea),ue.register(Ol)}constructor(){super(...arguments),this.listenBalanceCells()}balanceTables(){this.quill.scroll.descendants(Ol).forEach(t=>{t.balanceCells()})}deleteColumn(){const[t,,e]=this.getTable();e!=null&&(t.deleteColumn(e.cellOffset()),this.quill.update(ue.sources.USER))}deleteRow(){const[,t]=this.getTable();t!=null&&(t.remove(),this.quill.update(ue.sources.USER))}deleteTable(){const[t]=this.getTable();if(t==null)return;const e=t.offset();t.remove(),this.quill.update(ue.sources.USER),this.quill.setSelection(e,ue.sources.SILENT)}getTable(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.quill.getSelection();if(t==null)return[null,null,null,-1];const[e,s]=this.quill.getLine(t.index);if(e==null||e.statics.blotName!==Xt.blotName)return[null,null,null,-1];const l=e.parent;return[l.parent.parent,l,e,s]}insertColumn(t){const e=this.quill.getSelection();if(!e)return;const[s,l,i]=this.getTable(e);if(i==null)return;const o=i.cellOffset();s.insertColumn(o+t),this.quill.update(ue.sources.USER);let r=l.rowOffset();t===0&&(r+=1),this.quill.setSelection(e.index+r,e.length,ue.sources.SILENT)}insertColumnLeft(){this.insertColumn(0)}insertColumnRight(){this.insertColumn(1)}insertRow(t){const e=this.quill.getSelection();if(!e)return;const[s,l,i]=this.getTable(e);if(i==null)return;const o=l.rowOffset();s.insertRow(o+t),this.quill.update(ue.sources.USER),t>0?this.quill.setSelection(e,ue.sources.SILENT):this.quill.setSelection(e.index+l.children.length,e.length,ue.sources.SILENT)}insertRowAbove(){this.insertRow(0)}insertRowBelow(){this.insertRow(1)}insertTable(t,e){const s=this.quill.getSelection();if(s==null)return;const l=new Array(t).fill(0).reduce(i=>{const o=new Array(e).fill(`
`).join("");return i.insert(o,{table:$i()})},new Ae().retain(s.index));this.quill.updateContents(l,ue.sources.USER),this.quill.setSelection(s.index,ue.sources.SILENT),this.balanceTables()}listenBalanceCells(){this.quill.on(ue.events.SCROLL_OPTIMIZE,t=>{t.some(e=>["TD","TR","TBODY","TABLE"].includes(e.target.tagName)?(this.quill.once(ue.events.TEXT_CHANGE,(s,l,i)=>{i===ue.sources.USER&&this.balanceTables()}),!0):!1)})}}const go=_a("quill:toolbar");class Di extends ra{constructor(t,e){if(super(t,e),Array.isArray(this.options.container)){const s=document.createElement("div");s.setAttribute("role","toolbar"),dp(s,this.options.container),t.container?.parentNode?.insertBefore(s,t.container),this.container=s}else typeof this.options.container=="string"?this.container=document.querySelector(this.options.container):this.container=this.options.container;if(!(this.container instanceof HTMLElement)){go.error("Container required for toolbar",this.options);return}this.container.classList.add("ql-toolbar"),this.controls=[],this.handlers={},this.options.handlers&&Object.keys(this.options.handlers).forEach(s=>{const l=this.options.handlers?.[s];l&&this.addHandler(s,l)}),Array.from(this.container.querySelectorAll("button, select")).forEach(s=>{this.attach(s)}),this.quill.on(ue.events.EDITOR_CHANGE,()=>{const[s]=this.quill.selection.getRange();this.update(s)})}addHandler(t,e){this.handlers[t]=e}attach(t){let e=Array.from(t.classList).find(l=>l.indexOf("ql-")===0);if(!e)return;if(e=e.slice(3),t.tagName==="BUTTON"&&t.setAttribute("type","button"),this.handlers[e]==null&&this.quill.scroll.query(e)==null){go.warn("ignoring attaching to nonexistent format",e,t);return}const s=t.tagName==="SELECT"?"change":"click";t.addEventListener(s,l=>{let i;if(t.tagName==="SELECT"){if(t.selectedIndex<0)return;const r=t.options[t.selectedIndex];r.hasAttribute("selected")?i=!1:i=r.value||!1}else t.classList.contains("ql-active")?i=!1:i=t.value||!t.hasAttribute("value"),l.preventDefault();this.quill.focus();const[o]=this.quill.selection.getRange();if(this.handlers[e]!=null)this.handlers[e].call(this,i);else if(this.quill.scroll.query(e).prototype instanceof Mt){if(i=prompt(`Enter ${e}`),!i)return;this.quill.updateContents(new Ae().retain(o.index).delete(o.length).insert({[e]:i}),ue.sources.USER)}else this.quill.format(e,i,ue.sources.USER);this.update(o)}),this.controls.push([e,t])}update(t){const e=t==null?{}:this.quill.getFormat(t);this.controls.forEach(s=>{const[l,i]=s;if(i.tagName==="SELECT"){let o=null;if(t==null)o=null;else if(e[l]==null)o=i.querySelector("option[selected]");else if(!Array.isArray(e[l])){let r=e[l];typeof r=="string"&&(r=r.replace(/"/g,'\\"')),o=i.querySelector(`option[value="${r}"]`)}o==null?(i.value="",i.selectedIndex=-1):o.selected=!0}else if(t==null)i.classList.remove("ql-active"),i.setAttribute("aria-pressed","false");else if(i.hasAttribute("value")){const o=e[l],r=o===i.getAttribute("value")||o!=null&&o.toString()===i.getAttribute("value")||o==null&&!i.getAttribute("value");i.classList.toggle("ql-active",r),i.setAttribute("aria-pressed",r.toString())}else{const o=e[l]!=null;i.classList.toggle("ql-active",o),i.setAttribute("aria-pressed",o.toString())}})}}Di.DEFAULTS={};function fo(n,t,e){const s=document.createElement("button");s.setAttribute("type","button"),s.classList.add(`ql-${t}`),s.setAttribute("aria-pressed","false"),e!=null?(s.value=e,s.setAttribute("aria-label",`${t}: ${e}`)):s.setAttribute("aria-label",t),n.appendChild(s)}function dp(n,t){Array.isArray(t[0])||(t=[t]),t.forEach(e=>{const s=document.createElement("span");s.classList.add("ql-formats"),e.forEach(l=>{if(typeof l=="string")fo(s,l);else{const i=Object.keys(l)[0],o=l[i];Array.isArray(o)?mp(s,i,o):fo(s,i,o)}}),n.appendChild(s)})}function mp(n,t,e){const s=document.createElement("select");s.classList.add(`ql-${t}`),e.forEach(l=>{const i=document.createElement("option");l!==!1?i.setAttribute("value",String(l)):i.setAttribute("selected","selected"),s.appendChild(i)}),n.appendChild(s)}Di.DEFAULTS={container:null,handlers:{clean(){const n=this.quill.getSelection();if(n!=null)if(n.length===0){const t=this.quill.getFormat();Object.keys(t).forEach(e=>{this.quill.scroll.query(e,Ie.INLINE)!=null&&this.quill.format(e,!1,ue.sources.USER)})}else this.quill.removeFormat(n.index,n.length,ue.sources.USER)},direction(n){const{align:t}=this.quill.getFormat();n==="rtl"&&t==null?this.quill.format("align","right",ue.sources.USER):!n&&t==="right"&&this.quill.format("align",!1,ue.sources.USER),this.quill.format("direction",n,ue.sources.USER)},indent(n){const t=this.quill.getSelection(),e=this.quill.getFormat(t),s=parseInt(e.indent||0,10);if(n==="+1"||n==="-1"){let l=n==="+1"?1:-1;e.direction==="rtl"&&(l*=-1),this.quill.format("indent",s+l,ue.sources.USER)}},link(n){n===!0&&(n=prompt("Enter link URL:")),this.quill.format("link",n,ue.sources.USER)},list(n){const t=this.quill.getSelection(),e=this.quill.getFormat(t);n==="check"?e.list==="checked"||e.list==="unchecked"?this.quill.format("list",!1,ue.sources.USER):this.quill.format("list","unchecked",ue.sources.USER):this.quill.format("list",n,ue.sources.USER)}}};const pp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="13" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="9" y1="4" y2="4"/></svg>',gp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="14" x2="4" y1="14" y2="14"/><line class="ql-stroke" x1="12" x2="6" y1="4" y2="4"/></svg>',fp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="5" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="9" y1="4" y2="4"/></svg>',hp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="15" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="15" x2="3" y1="14" y2="14"/><line class="ql-stroke" x1="15" x2="3" y1="4" y2="4"/></svg>',_p='<svg viewbox="0 0 18 18"><g class="ql-fill ql-color-label"><polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"/><rect height="1" width="1" x="4" y="4"/><polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"/><rect height="1" width="1" x="2" y="6"/><rect height="1" width="1" x="3" y="5"/><rect height="1" width="1" x="4" y="7"/><polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"/><rect height="1" width="1" x="2" y="12"/><rect height="1" width="1" x="2" y="9"/><rect height="1" width="1" x="2" y="15"/><polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"/><rect height="1" width="1" x="3" y="8"/><path d="M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z"/><path d="M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z"/><path d="M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z"/><rect height="1" width="1" x="12" y="2"/><rect height="1" width="1" x="11" y="3"/><path d="M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z"/><rect height="1" width="1" x="2" y="3"/><rect height="1" width="1" x="6" y="2"/><rect height="1" width="1" x="3" y="2"/><rect height="1" width="1" x="5" y="3"/><rect height="1" width="1" x="9" y="2"/><rect height="1" width="1" x="15" y="14"/><polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"/><rect height="1" width="1" x="13" y="7"/><rect height="1" width="1" x="15" y="5"/><rect height="1" width="1" x="14" y="6"/><rect height="1" width="1" x="15" y="8"/><rect height="1" width="1" x="14" y="9"/><path d="M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z"/><rect height="1" width="1" x="14" y="3"/><polygon points="12 6.868 12 6 11.62 6 12 6.868"/><rect height="1" width="1" x="15" y="2"/><rect height="1" width="1" x="12" y="5"/><rect height="1" width="1" x="13" y="4"/><polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"/><rect height="1" width="1" x="9" y="14"/><rect height="1" width="1" x="8" y="15"/><path d="M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z"/><rect height="1" width="1" x="5" y="15"/><path d="M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z"/><rect height="1" width="1" x="11" y="15"/><path d="M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z"/><rect height="1" width="1" x="14" y="15"/><rect height="1" width="1" x="15" y="11"/></g><polyline class="ql-stroke" points="5.5 13 9 5 12.5 13"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="11" y2="11"/></svg>',vp='<svg viewbox="0 0 18 18"><rect class="ql-fill ql-stroke" height="3" width="3" x="4" y="5"/><rect class="ql-fill ql-stroke" height="3" width="3" x="11" y="5"/><path class="ql-even ql-fill ql-stroke" d="M7,8c0,4.031-3,5-3,5"/><path class="ql-even ql-fill ql-stroke" d="M14,8c0,4.031-3,5-3,5"/></svg>',yp='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z"/><path class="ql-stroke" d="M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z"/></svg>',bp='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="5" x2="13" y1="3" y2="3"/><line class="ql-stroke" x1="6" x2="9.35" y1="12" y2="3"/><line class="ql-stroke" x1="11" x2="15" y1="11" y2="15"/><line class="ql-stroke" x1="15" x2="11" y1="11" y2="15"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="7" x="2" y="14"/></svg>',ho='<svg viewbox="0 0 18 18"><polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"/><polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"/><line class="ql-stroke" x1="10" x2="8" y1="5" y2="13"/></svg>',kp='<svg viewbox="0 0 18 18"><line class="ql-color-label ql-stroke ql-transparent" x1="3" x2="15" y1="15" y2="15"/><polyline class="ql-stroke" points="5.5 11 9 3 12.5 11"/><line class="ql-stroke" x1="11.63" x2="6.38" y1="9" y2="9"/></svg>',Cp='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"/><line class="ql-stroke ql-fill" x1="15" x2="11" y1="4" y2="4"/><path class="ql-fill" d="M11,3a3,3,0,0,0,0,6h1V3H11Z"/><rect class="ql-fill" height="11" width="1" x="11" y="4"/><rect class="ql-fill" height="11" width="1" x="13" y="4"/></svg>',xp='<svg viewbox="0 0 18 18"><polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"/><line class="ql-stroke ql-fill" x1="9" x2="5" y1="4" y2="4"/><path class="ql-fill" d="M5,3A3,3,0,0,0,5,9H6V3H5Z"/><rect class="ql-fill" height="11" width="1" x="5" y="4"/><rect class="ql-fill" height="11" width="1" x="7" y="4"/></svg>',wp='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z"/><rect class="ql-fill" height="1.6" rx="0.8" ry="0.8" width="5" x="5.15" y="6.2"/><path class="ql-fill" d="M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z"/></svg>',Tp='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z"/></svg>',Lp='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Ep='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.65186,12.30664a2.6742,2.6742,0,0,1-2.915,2.68457,3.96592,3.96592,0,0,1-2.25537-.6709.56007.56007,0,0,1-.13232-.83594L11.64648,13c.209-.34082.48389-.36328.82471-.1543a2.32654,2.32654,0,0,0,1.12256.33008c.71484,0,1.12207-.35156,1.12207-.78125,0-.61523-.61621-.86816-1.46338-.86816H13.2085a.65159.65159,0,0,1-.68213-.41895l-.05518-.10937a.67114.67114,0,0,1,.14307-.78125l.71533-.86914a8.55289,8.55289,0,0,1,.68213-.7373V8.58887a3.93913,3.93913,0,0,1-.748.05469H11.9873a.54085.54085,0,0,1-.605-.60547V7.59863a.54085.54085,0,0,1,.605-.60547h3.75146a.53773.53773,0,0,1,.60547.59375v.17676a1.03723,1.03723,0,0,1-.27539.748L14.74854,10.0293A2.31132,2.31132,0,0,1,16.65186,12.30664ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Sp='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm7.05371,7.96582v.38477c0,.39648-.165.60547-.46191.60547h-.47314v1.29785a.54085.54085,0,0,1-.605.60547h-.69336a.54085.54085,0,0,1-.605-.60547V12.95605H11.333a.5412.5412,0,0,1-.60547-.60547v-.15332a1.199,1.199,0,0,1,.22021-.748l2.56348-4.05957a.7819.7819,0,0,1,.72607-.39648h1.27637a.54085.54085,0,0,1,.605.60547v3.7627h.33008A.54055.54055,0,0,1,17.05371,11.96582ZM14.28125,8.7207h-.022a4.18969,4.18969,0,0,1-.38525.81348l-1.188,1.80469v.02246h1.5293V9.60059A7.04058,7.04058,0,0,1,14.28125,8.7207Z"/></svg>',Ap='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M16.74023,12.18555a2.75131,2.75131,0,0,1-2.91553,2.80566,3.908,3.908,0,0,1-2.25537-.68164.54809.54809,0,0,1-.13184-.8252L11.73438,13c.209-.34082.48389-.36328.8252-.1543a2.23757,2.23757,0,0,0,1.1001.33008,1.01827,1.01827,0,0,0,1.1001-.96777c0-.61621-.53906-.97949-1.25439-.97949a2.15554,2.15554,0,0,0-.64893.09961,1.15209,1.15209,0,0,1-.814.01074l-.12109-.04395a.64116.64116,0,0,1-.45117-.71484l.231-3.00391a.56666.56666,0,0,1,.62744-.583H15.541a.54085.54085,0,0,1,.605.60547v.43945a.54085.54085,0,0,1-.605.60547H13.41748l-.04395.72559a1.29306,1.29306,0,0,1-.04395.30859h.022a2.39776,2.39776,0,0,1,.57227-.07715A2.53266,2.53266,0,0,1,16.74023,12.18555ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z"/></svg>',Ip='<svg viewBox="0 0 18 18"><path class="ql-fill" d="M14.51758,9.64453a1.85627,1.85627,0,0,0-1.24316.38477H13.252a1.73532,1.73532,0,0,1,1.72754-1.4082,2.66491,2.66491,0,0,1,.5498.06641c.35254.05469.57227.01074.70508-.40723l.16406-.5166a.53393.53393,0,0,0-.373-.75977,4.83723,4.83723,0,0,0-1.17773-.14258c-2.43164,0-3.7627,2.17773-3.7627,4.43359,0,2.47559,1.60645,3.69629,3.19043,3.69629A2.70585,2.70585,0,0,0,16.96,12.19727,2.43861,2.43861,0,0,0,14.51758,9.64453Zm-.23047,3.58691c-.67187,0-1.22168-.81445-1.22168-1.45215,0-.47363.30762-.583.72559-.583.96875,0,1.27734.59375,1.27734,1.12207A.82182.82182,0,0,1,14.28711,13.23145ZM10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Z"/></svg>',$p='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="13" y1="4" y2="4"/><line class="ql-stroke" x1="5" x2="11" y1="14" y2="14"/><line class="ql-stroke" x1="8" x2="10" y1="14" y2="4"/></svg>',Dp='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="10" width="12" x="3" y="4"/><circle class="ql-fill" cx="6" cy="7" r="1"/><polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"/></svg>',Pp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"/></svg>',Np='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="3" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="5 7 5 11 3 9 5 7"/></svg>',Op='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="11" y1="7" y2="11"/><path class="ql-even ql-stroke" d="M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z"/><path class="ql-even ql-stroke" d="M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z"/></svg>',Mp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="6" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="6" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="6" x2="15" y1="14" y2="14"/><line class="ql-stroke" x1="3" x2="3" y1="4" y2="4"/><line class="ql-stroke" x1="3" x2="3" y1="9" y2="9"/><line class="ql-stroke" x1="3" x2="3" y1="14" y2="14"/></svg>',Fp='<svg class="" viewbox="0 0 18 18"><line class="ql-stroke" x1="9" x2="15" y1="4" y2="4"/><polyline class="ql-stroke" points="3 4 4 5 6 3"/><line class="ql-stroke" x1="9" x2="15" y1="14" y2="14"/><polyline class="ql-stroke" points="3 14 4 15 6 13"/><line class="ql-stroke" x1="9" x2="15" y1="9" y2="9"/><polyline class="ql-stroke" points="3 9 4 10 6 8"/></svg>',Vp='<svg viewbox="0 0 18 18"><line class="ql-stroke" x1="7" x2="15" y1="4" y2="4"/><line class="ql-stroke" x1="7" x2="15" y1="9" y2="9"/><line class="ql-stroke" x1="7" x2="15" y1="14" y2="14"/><line class="ql-stroke ql-thin" x1="2.5" x2="4.5" y1="5.5" y2="5.5"/><path class="ql-fill" d="M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z"/><path class="ql-stroke ql-thin" d="M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156"/><path class="ql-stroke ql-thin" d="M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109"/></svg>',Bp='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z"/><path class="ql-fill" d="M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z"/></svg>',Rp='<svg viewbox="0 0 18 18"><path class="ql-fill" d="M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z"/><path class="ql-fill" d="M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z"/></svg>',qp='<svg viewbox="0 0 18 18"><line class="ql-stroke ql-thin" x1="15.5" x2="2.5" y1="8.5" y2="9.5"/><path class="ql-fill" d="M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z"/><path class="ql-fill" d="M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z"/></svg>',Up='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="2" width="3" x="5" y="5"/><rect class="ql-fill" height="2" width="4" x="9" y="5"/><g class="ql-fill ql-transparent"><rect height="2" width="3" x="5" y="8"/><rect height="2" width="4" x="9" y="8"/><rect height="2" width="3" x="5" y="11"/><rect height="2" width="4" x="9" y="11"/></g></svg>',zp='<svg viewbox="0 0 18 18"><path class="ql-stroke" d="M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3"/><rect class="ql-fill" height="1" rx="0.5" ry="0.5" width="12" x="3" y="15"/></svg>',jp='<svg viewbox="0 0 18 18"><rect class="ql-stroke" height="12" width="12" x="3" y="3"/><rect class="ql-fill" height="12" width="1" x="5" y="3"/><rect class="ql-fill" height="12" width="1" x="12" y="3"/><rect class="ql-fill" height="2" width="8" x="5" y="8"/><rect class="ql-fill" height="1" width="3" x="3" y="5"/><rect class="ql-fill" height="1" width="3" x="3" y="7"/><rect class="ql-fill" height="1" width="3" x="3" y="10"/><rect class="ql-fill" height="1" width="3" x="3" y="12"/><rect class="ql-fill" height="1" width="3" x="12" y="5"/><rect class="ql-fill" height="1" width="3" x="12" y="7"/><rect class="ql-fill" height="1" width="3" x="12" y="10"/><rect class="ql-fill" height="1" width="3" x="12" y="12"/></svg>';var Ys={align:{"":pp,center:gp,right:fp,justify:hp},background:_p,blockquote:vp,bold:yp,clean:bp,code:ho,"code-block":ho,color:kp,direction:{"":Cp,rtl:xp},formula:wp,header:{"1":Tp,"2":Lp,"3":Ep,"4":Sp,"5":Ap,"6":Ip},italic:$p,image:Dp,indent:{"+1":Pp,"-1":Np},link:Op,list:{bullet:Mp,check:Fp,ordered:Vp},script:{sub:Bp,super:Rp},strike:qp,table:Up,underline:zp,video:jp};const Yp='<svg viewbox="0 0 18 18"><polygon class="ql-stroke" points="7 11 9 13 11 11 7 11"/><polygon class="ql-stroke" points="7 7 9 5 11 7 7 7"/></svg>';let _o=0;function vo(n,t){n.setAttribute(t,`${n.getAttribute(t)!=="true"}`)}class Zl{constructor(t){this.select=t,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",()=>{this.togglePicker()}),this.label.addEventListener("keydown",e=>{switch(e.key){case"Enter":this.togglePicker();break;case"Escape":this.escape(),e.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}togglePicker(){this.container.classList.toggle("ql-expanded"),vo(this.label,"aria-expanded"),vo(this.options,"aria-hidden")}buildItem(t){const e=document.createElement("span");e.tabIndex="0",e.setAttribute("role","button"),e.classList.add("ql-picker-item");const s=t.getAttribute("value");return s&&e.setAttribute("data-value",s),t.textContent&&e.setAttribute("data-label",t.textContent),e.addEventListener("click",()=>{this.selectItem(e,!0)}),e.addEventListener("keydown",l=>{switch(l.key){case"Enter":this.selectItem(e,!0),l.preventDefault();break;case"Escape":this.escape(),l.preventDefault();break}}),e}buildLabel(){const t=document.createElement("span");return t.classList.add("ql-picker-label"),t.innerHTML=Yp,t.tabIndex="0",t.setAttribute("role","button"),t.setAttribute("aria-expanded","false"),this.container.appendChild(t),t}buildOptions(){const t=document.createElement("span");t.classList.add("ql-picker-options"),t.setAttribute("aria-hidden","true"),t.tabIndex="-1",t.id=`ql-picker-options-${_o}`,_o+=1,this.label.setAttribute("aria-controls",t.id),this.options=t,Array.from(this.select.options).forEach(e=>{const s=this.buildItem(e);t.appendChild(s),e.selected===!0&&this.selectItem(s)}),this.container.appendChild(t)}buildPicker(){Array.from(this.select.attributes).forEach(t=>{this.container.setAttribute(t.name,t.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}escape(){this.close(),setTimeout(()=>this.label.focus(),1)}close(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}selectItem(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const s=this.container.querySelector(".ql-selected");t!==s&&(s?.classList.remove("ql-selected"),t!=null&&(t.classList.add("ql-selected"),this.select.selectedIndex=Array.from(t.parentNode.children).indexOf(t),t.hasAttribute("data-value")?this.label.setAttribute("data-value",t.getAttribute("data-value")):this.label.removeAttribute("data-value"),t.hasAttribute("data-label")?this.label.setAttribute("data-label",t.getAttribute("data-label")):this.label.removeAttribute("data-label"),e&&(this.select.dispatchEvent(new Event("change")),this.close())))}update(){let t;if(this.select.selectedIndex>-1){const s=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];t=this.select.options[this.select.selectedIndex],this.selectItem(s)}else this.selectItem(null);const e=t!=null&&t!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",e)}}class ir extends Zl{constructor(t,e){super(t),this.label.innerHTML=e,this.container.classList.add("ql-color-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).slice(0,7).forEach(s=>{s.classList.add("ql-primary")})}buildItem(t){const e=super.buildItem(t);return e.style.backgroundColor=t.getAttribute("value")||"",e}selectItem(t,e){super.selectItem(t,e);const s=this.label.querySelector(".ql-color-label"),l=t&&t.getAttribute("data-value")||"";s&&(s.tagName==="line"?s.style.stroke=l:s.style.fill=l)}}class or extends Zl{constructor(t,e){super(t),this.container.classList.add("ql-icon-picker"),Array.from(this.container.querySelectorAll(".ql-picker-item")).forEach(s=>{s.innerHTML=e[s.getAttribute("data-value")||""]}),this.defaultItem=this.container.querySelector(".ql-selected"),this.selectItem(this.defaultItem)}selectItem(t,e){super.selectItem(t,e);const s=t||this.defaultItem;if(s!=null){if(this.label.innerHTML===s.innerHTML)return;this.label.innerHTML=s.innerHTML}}}const Wp=n=>{const{overflowY:t}=getComputedStyle(n,null);return t!=="visible"&&t!=="clip"};class rr{constructor(t,e){this.quill=t,this.boundsContainer=e||document.body,this.root=t.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,Wp(this.quill.root)&&this.quill.root.addEventListener("scroll",()=>{this.root.style.marginTop=`${-1*this.quill.root.scrollTop}px`}),this.hide()}hide(){this.root.classList.add("ql-hidden")}position(t){const e=t.left+t.width/2-this.root.offsetWidth/2,s=t.bottom+this.quill.root.scrollTop;this.root.style.left=`${e}px`,this.root.style.top=`${s}px`,this.root.classList.remove("ql-flip");const l=this.boundsContainer.getBoundingClientRect(),i=this.root.getBoundingClientRect();let o=0;if(i.right>l.right&&(o=l.right-i.right,this.root.style.left=`${e+o}px`),i.left<l.left&&(o=l.left-i.left,this.root.style.left=`${e+o}px`),i.bottom>l.bottom){const r=i.bottom-i.top,u=t.bottom-t.top+r;this.root.style.top=`${s-u}px`,this.root.classList.add("ql-flip")}return o}show(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}const Hp=[!1,"center","right","justify"],Zp=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],Gp=[!1,"serif","monospace"],Jp=["1","2","3",!1],Xp=["small",!1,"large","huge"];class el extends ks{constructor(t,e){super(t,e);const s=l=>{if(!document.body.contains(t.root)){document.body.removeEventListener("click",s);return}this.tooltip!=null&&!this.tooltip.root.contains(l.target)&&document.activeElement!==this.tooltip.textbox&&!this.quill.hasFocus()&&this.tooltip.hide(),this.pickers!=null&&this.pickers.forEach(i=>{i.container.contains(l.target)||i.close()})};t.emitter.listenDOM("click",document.body,s)}addModule(t){const e=super.addModule(t);return t==="toolbar"&&this.extendToolbar(e),e}buildButtons(t,e){Array.from(t).forEach(s=>{(s.getAttribute("class")||"").split(/\s+/).forEach(i=>{if(!!i.startsWith("ql-")&&(i=i.slice(3),e[i]!=null))if(i==="direction")s.innerHTML=e[i][""]+e[i].rtl;else if(typeof e[i]=="string")s.innerHTML=e[i];else{const o=s.value||"";o!=null&&e[i][o]&&(s.innerHTML=e[i][o])}})})}buildPickers(t,e){this.pickers=Array.from(t).map(l=>{if(l.classList.contains("ql-align")&&(l.querySelector("option")==null&&Ms(l,Hp),typeof e.align=="object"))return new or(l,e.align);if(l.classList.contains("ql-background")||l.classList.contains("ql-color")){const i=l.classList.contains("ql-background")?"background":"color";return l.querySelector("option")==null&&Ms(l,Zp,i==="background"?"#ffffff":"#000000"),new ir(l,e[i])}return l.querySelector("option")==null&&(l.classList.contains("ql-font")?Ms(l,Gp):l.classList.contains("ql-header")?Ms(l,Jp):l.classList.contains("ql-size")&&Ms(l,Xp)),new Zl(l)});const s=()=>{this.pickers.forEach(l=>{l.update()})};this.quill.on(Ee.events.EDITOR_CHANGE,s)}}el.DEFAULTS=La({},ks.DEFAULTS,{modules:{toolbar:{handlers:{formula(){this.quill.theme.tooltip.edit("formula")},image(){let n=this.container.querySelector("input.ql-image[type=file]");n==null&&(n=document.createElement("input"),n.setAttribute("type","file"),n.setAttribute("accept",this.quill.uploader.options.mimetypes.join(", ")),n.classList.add("ql-image"),n.addEventListener("change",()=>{const t=this.quill.getSelection(!0);this.quill.uploader.upload(t,n.files),n.value=""}),this.container.appendChild(n)),n.click()},video(){this.quill.theme.tooltip.edit("video")}}}}});class cr extends rr{constructor(t,e){super(t,e),this.textbox=this.root.querySelector('input[type="text"]'),this.listen()}listen(){this.textbox.addEventListener("keydown",t=>{t.key==="Enter"?(this.save(),t.preventDefault()):t.key==="Escape"&&(this.cancel(),t.preventDefault())})}cancel(){this.hide(),this.restoreFocus()}edit(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),this.textbox==null)return;e!=null?this.textbox.value=e:t!==this.root.getAttribute("data-mode")&&(this.textbox.value="");const s=this.quill.getBounds(this.quill.selection.savedRange);s!=null&&this.position(s),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute(`data-${t}`)||""),this.root.setAttribute("data-mode",t)}restoreFocus(){this.quill.focus({preventScroll:!0})}save(){let{value:t}=this.textbox;switch(this.root.getAttribute("data-mode")){case"link":{const{scrollTop:e}=this.quill.root;this.linkRange?(this.quill.formatText(this.linkRange,"link",t,Ee.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",t,Ee.sources.USER)),this.quill.root.scrollTop=e;break}case"video":t=Qp(t);case"formula":{if(!t)break;const e=this.quill.getSelection(!0);if(e!=null){const s=e.index+e.length;this.quill.insertEmbed(s,this.root.getAttribute("data-mode"),t,Ee.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(s+1," ",Ee.sources.USER),this.quill.setSelection(s+2,Ee.sources.USER)}break}}this.textbox.value="",this.hide()}}function Qp(n){let t=n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||n.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return t?`${t[1]||"https"}://www.youtube.com/embed/${t[2]}?showinfo=0`:(t=n.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?`${t[1]||"https"}://player.vimeo.com/video/${t[2]}/`:n}function Ms(n,t){let e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;t.forEach(s=>{const l=document.createElement("option");s===e?l.setAttribute("selected","selected"):l.setAttribute("value",String(s)),n.appendChild(l)})}const Kp=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]];class eg extends cr{static TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join("");constructor(t,e){super(t,e),this.quill.on(Ee.events.EDITOR_CHANGE,(s,l,i,o)=>{if(s===Ee.events.SELECTION_CHANGE)if(l!=null&&l.length>0&&o===Ee.sources.USER){this.show(),this.root.style.left="0px",this.root.style.width="",this.root.style.width=`${this.root.offsetWidth}px`;const r=this.quill.getLines(l.index,l.length);if(r.length===1){const u=this.quill.getBounds(l);u!=null&&this.position(u)}else{const u=r[r.length-1],m=this.quill.getIndex(u),h=Math.min(u.length()-1,l.index+l.length-m),v=this.quill.getBounds(new Ra(m,h));v!=null&&this.position(v)}}else document.activeElement!==this.textbox&&this.quill.hasFocus()&&this.hide()})}listen(){super.listen(),this.root.querySelector(".ql-close").addEventListener("click",()=>{this.root.classList.remove("ql-editing")}),this.quill.on(Ee.events.SCROLL_OPTIMIZE,()=>{setTimeout(()=>{if(this.root.classList.contains("ql-hidden"))return;const t=this.quill.getSelection();if(t!=null){const e=this.quill.getBounds(t);e!=null&&this.position(e)}},1)})}cancel(){this.show()}position(t){const e=super.position(t),s=this.root.querySelector(".ql-tooltip-arrow");return s.style.marginLeft="",e!==0&&(s.style.marginLeft=`${-1*e-s.offsetWidth/2}px`),e}}class ur extends el{constructor(t,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=Kp),super(t,e),this.quill.container.classList.add("ql-bubble")}extendToolbar(t){this.tooltip=new eg(this.quill,this.options.bounds),t.container!=null&&(this.tooltip.root.appendChild(t.container),this.buildButtons(t.container.querySelectorAll("button"),Ys),this.buildPickers(t.container.querySelectorAll("select"),Ys))}}ur.DEFAULTS=La({},el.DEFAULTS,{modules:{toolbar:{handlers:{link(n){n?this.quill.theme.tooltip.edit():this.quill.format("link",!1,ue.sources.USER)}}}}});const tg=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]];class ag extends cr{static TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join("");preview=this.root.querySelector("a.ql-preview");listen(){super.listen(),this.root.querySelector("a.ql-action").addEventListener("click",t=>{this.root.classList.contains("ql-editing")?this.save():this.edit("link",this.preview.textContent),t.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",t=>{if(this.linkRange!=null){const e=this.linkRange;this.restoreFocus(),this.quill.formatText(e,"link",!1,Ee.sources.USER),delete this.linkRange}t.preventDefault(),this.hide()}),this.quill.on(Ee.events.SELECTION_CHANGE,(t,e,s)=>{if(t!=null){if(t.length===0&&s===Ee.sources.USER){const[l,i]=this.quill.scroll.descendant(Nl,t.index);if(l!=null){this.linkRange=new Ra(t.index-i,l.length());const o=Nl.formats(l.domNode);this.preview.textContent=o,this.preview.setAttribute("href",o),this.show();const r=this.quill.getBounds(this.linkRange);r!=null&&this.position(r);return}}else delete this.linkRange;this.hide()}})}show(){super.show(),this.root.removeAttribute("data-mode")}}class dr extends el{constructor(t,e){e.modules.toolbar!=null&&e.modules.toolbar.container==null&&(e.modules.toolbar.container=tg),super(t,e),this.quill.container.classList.add("ql-snow")}extendToolbar(t){t.container!=null&&(t.container.classList.add("ql-snow"),this.buildButtons(t.container.querySelectorAll("button"),Ys),this.buildPickers(t.container.querySelectorAll("select"),Ys),this.tooltip=new ag(this.quill,this.options.bounds),t.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"k",shortKey:!0},(e,s)=>{t.handlers.link.call(t,!s.format.link)}))}}dr.DEFAULTS=La({},el.DEFAULTS,{modules:{toolbar:{handlers:{link(n){if(n){const t=this.quill.getSelection();if(t==null||t.length===0)return;let e=this.quill.getText(t);/^\S+@\S+\.\S+$/.test(e)&&e.indexOf("mailto:")!==0&&(e=`mailto:${e}`);const{tooltip:s}=this.quill.theme;s.edit("link",e)}else this.quill.format("link",!1,ue.sources.USER)}}}}});ue.register({"attributors/attribute/direction":Zo,"attributors/class/align":Yo,"attributors/class/background":om,"attributors/class/color":im,"attributors/class/direction":Go,"attributors/class/font":Qo,"attributors/class/size":er,"attributors/style/align":Wo,"attributors/style/background":Ti,"attributors/style/color":wi,"attributors/style/direction":Jo,"attributors/style/font":Ko,"attributors/style/size":tr},!0);ue.register({"formats/align":Yo,"formats/direction":Go,"formats/indent":Km,"formats/background":Ti,"formats/color":wi,"formats/font":Qo,"formats/size":er,"formats/blockquote":ep,"formats/code-block":At,"formats/header":tp,"formats/list":Ks,"formats/bold":Ii,"formats/code":Li,"formats/italic":ap,"formats/link":Nl,"formats/script":sp,"formats/strike":lp,"formats/underline":np,"formats/formula":ip,"formats/image":op,"formats/video":rp,"modules/syntax":nr,"modules/table":up,"modules/toolbar":Di,"themes/bubble":ur,"themes/snow":dr,"ui/icons":Ys,"ui/picker":Zl,"ui/icon-picker":or,"ui/color-picker":ir,"ui/tooltip":rr},!0);const sg={props:{content:String,value:String,disabled:{type:Boolean,default:!1},options:{type:Object,default:()=>({})}},emits:["ready","change","input","blur","focus","update:value"],setup(n,{emit:t}){const e=n,s={theme:"snow",boundary:document.body,modules:{toolbar:[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},placeholder:"Insert content here ...",readOnly:!1},l=h=>{const v=new MutationObserver(g=>{g.forEach(()=>{})});return v.observe(h,{childList:!0,subtree:!0}),v},i=O(null);let o=null,r="";const u=(h,v)=>{for(const g in v)!h[g]||g!=="modules"?h[g]=v[g]:u(h[g],v[g]);return h},m=()=>{if(i.value){const h=u(s,e.options);h.readOnly=!!e.disabled,o=new ue(i.value,h),e.value&&o.clipboard.dangerouslyPasteHTML(e.value),o.on("selection-change",v=>{t(v?"focus":"blur",o)}),o.on("text-change",()=>{e.disabled&&o.enable(!1);let v=i.value.children[0].innerHTML;const g=o.getText();v==="<p><br></p>"&&(v=""),r=v,t("update:value",r),t("change",{html:v,text:g,quill:o})}),t("ready",o)}};return it(()=>e.value,h=>{o&&h!==r?(r=h,o.clipboard.dangerouslyPasteHTML(h)):h||o.setText("")}),it(()=>e.disabled,h=>{o&&o.enable(!h)}),Je(()=>{if(m(),i.value){const h=l(i.value);Vi(()=>{h.disconnect()})}}),Rr(()=>{const h=i.value.previousSibling;h&&h.nodeType===1&&h.className.indexOf("ql-toolbar")>-1&&h.parentNode.removeChild(h)}),Vi(()=>{o=null}),(h,v)=>(c(),C("section",{ref_key:"editor",ref:i},null,512))}};const lg={class:"am-desc-editor__header"},ng={class:"am-desc-editor__header-warning"},ig=d("span",{class:"am-icon-triangle-info"},null,-1),og={key:1,class:"am-quill-wrapper"},mr={props:{modelValue:{type:String,default:""},mode:{type:String,default:"html"}},emits:["update:modelValue","setMode"],setup(n,{emit:t}){const e=n;let s=V("amLabels"),l=O(e.mode),i=_({get:()=>e.modelValue,set:v=>{t("update:modelValue",v)}});function o(){l.value="text",t("setMode","text")}function r(){l.value="html",t("setMode","html")}const u={theme:"snow",modules:{toolbar:[["bold","italic","underline","strike"],["blockquote"],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{color:[]},{background:[]}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{font:[]}],[{align:[]}],["clean"],["link","image"]]},readOnly:!1};let m=V("amColors",O({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#808A90",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),h=_(()=>({"--am-c-desce-text-op03":W(m.value.colorMainText,.03),"--am-c-desce-warn-op10":W(m.value.colorWarning,.1)}));return(v,g)=>a(l)?(c(),C("div",{key:0,class:"am-desc-editor",style:ke(a(h))},[d("div",lg,[I(qr,null,{default:L(()=>[I(Te,{category:a(l)==="text"?"primary":"secondary",type:a(l)==="text"?"filled":"plain",size:"small",onClick:o},{default:L(()=>[re(x(a(s).text_mode),1)]),_:1},8,["category","type"]),I(Te,{category:a(l)==="html"?"primary":"secondary",type:a(l)==="html"?"filled":"plain",size:"small",onClick:r},{default:L(()=>[re(x(a(s).html_mode),1)]),_:1},8,["category","type"])]),_:1}),d("div",ng,[ig,re(" "+x(a(s).content_mode_tooltip),1)])]),a(l)==="html"?(c(),U(mt,{key:0,modelValue:a(i),"onUpdate:modelValue":g[0]||(g[0]=b=>we(i)?i.value=b:i=b),type:"textarea",rows:3,style:{width:"100%"}},null,8,["modelValue"])):N("",!0),a(l)==="text"?(c(),C("div",og,[I(sg,{value:a(i),"onUpdate:value":g[1]||(g[1]=b=>we(i)?i.value=b:i=b),options:u},null,8,["value"])])):N("",!0)],4)):N("",!0)}};const rg=["innerHTML"],cg={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:t}){const e=n,s=De(),l=V("settings");let i=V("amLabels"),o=_(()=>s.getters["entities/getEmployee"](s.getters["employee/getId"])),r=_(()=>s.getters["entities/getLocations"]),u=_(()=>r.value.map(P=>({value:P.id,label:P.name}))),m=O(null),h=O(!1),v=O({firstName:_({get:()=>s.getters["employee/getFirstName"],set:P=>{s.commit("employee/setFirstName",P||"")}}),lastName:_({get:()=>s.getters["employee/getLastName"],set:P=>{s.commit("employee/setLastName",P||"")}}),email:_({get:()=>s.getters["employee/getEmail"],set:P=>{s.commit("employee/setEmail",P||"")}}),phone:_({get:()=>s.getters["employee/getPhone"],set:P=>{s.commit("employee/setPhone",P||"")}}),locationId:_({get:()=>s.getters["employee/getLocationId"],set:P=>{s.commit("employee/setLocationId",P||"")}}),description:_({get:()=>s.getters["employee/getDescription"],set:P=>{s.commit("employee/setDescription",P||"")}})}),g=_(()=>({firstName:[{required:!0,message:i.enter_first_name_warning,trigger:["submit","change"]}],lastName:[{required:!0,message:i.enter_last_name_warning,trigger:["submit","change"]}],email:[{required:!0,message:i.enter_email_warning,trigger:["submit","change"]}],locationId:[{required:r.value.filter(P=>P.status==="visible").length>0,message:i.enter_location_warning,trigger:["submit","change"]}]})),b=O({firstName:{template:Ye.text,props:{itemName:"firstName",label:i.first_name_colon,placeholder:i.enter_first_name,class:_(()=>`am-caepif__item ${e.responsiveClass}`)}},lastName:{template:Ye.text,props:{itemName:"lastName",label:i.last_name_colon,placeholder:i.enter_last_name,class:_(()=>`am-caepif__item ${e.responsiveClass}`)}},email:{template:Ye.text,props:{itemName:"email",label:i.email_colon,placeholder:i.enter_email,class:_(()=>`am-caepif__item ${e.responsiveClass}`)}},phone:{countryPhoneIso:_({get:()=>s.getters["auth/getProfile"].countryPhoneIso?s.getters["auth/getProfile"].countryPhoneIso:"",set:P=>{s.commit("auth/setProfileCountryPhoneIso",P?P.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:i.phone_colon,placeholder:i.enter_phone,defaultCode:_(()=>s.getters["auth/getProfile"].countryPhoneIso?s.getters["auth/getProfile"].countryPhoneIso:""),phoneError:_(()=>h.value),whatsAppLabel:i.whatsapp_opt_in_text,isWhatsApp:l.notifications.whatsAppEnabled&&l.notifications.whatsAppAccessToken&&l.notifications.whatsAppBusinessID&&l.notifications.whatsAppPhoneID,class:_(()=>`am-caepif__item ${e.responsiveClass}`)}}}),D=O({locationId:{template:Ye.select,props:{itemName:"locationId",label:`${i.location}:`,placeholder:i.select_location,class:_(()=>`am-caepif__item ${e.responsiveClass} ${l.zoom.enabled||"am-w-100"}`),options:u.value}}});return Hs(()=>{r.value.length||delete D.value.locationId}),t({employeeFormRef:m}),(P,y)=>{const w=vt,A=et;return c(),U(A,{ref_key:"employeeFormRef",ref:m,model:a(v),rules:a(g),"label-position":"top",class:B(["am-caepif",e.responsiveClass])},{default:L(()=>[d("div",{class:B(["am-caepif__block",[{"am-w-70":a(o).pictureFullPath},e.responsiveClass]])},[(c(!0),C(ae,null,pe(a(b),(S,f)=>(c(),U(pt(S.template),St({key:f,ref_for:!0,ref:"customerCollectorRef",modelValue:a(v)[f],"onUpdate:modelValue":k=>a(v)[f]=k,countryPhoneIso:S.countryPhoneIso,"onUpdate:countryPhoneIso":k=>S.countryPhoneIso=k},S.props),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"]))),128))],2),a(o).pictureFullPath?(c(),C("div",{key:0,class:B(["am-caepif__block am-w-30",e.responsiveClass])},[d("div",{class:"am-caepif__img",style:ke({backgroundImage:`url(${a(o).pictureFullPath})`})},null,4)],2)):N("",!0),d("div",{class:B(["am-caepif__block",e.responsiveClass])},[(c(!0),C(ae,null,pe(a(D),(S,f)=>(c(),U(pt(S.template),St({key:f,ref_for:!0,ref:"customerCollectorRef",modelValue:a(v)[f],"onUpdate:modelValue":k=>a(v)[f]=k},S.props,pi(S.handlers?S.handlers:{})),{default:L(()=>[S.slots&&S.slots.default?(c(),C("div",{key:0,innerHTML:S.slots.default},null,8,rg)):N("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue"]))),128)),I(w,{label:a(i).description_colon},{default:L(()=>[I(mr,{modelValue:a(v).description,"onUpdate:modelValue":y[0]||(y[0]=S=>a(v).description=S),mode:a(s).getters["employee/getDescriptionMode"],onSetMode:y[1]||(y[1]=S=>a(s).commit("employee/setDescriptionMode",S))},null,8,["modelValue","mode"])]),_:1},8,["label"])],2)]),_:1},8,["model","rules","class"])}}};const ug={class:"am-caes__category-header"},dg={class:"am-caes__category-header__text"},mg={class:"am-caes__service-header"},pg={class:"am-caes__service-header__text"},gg={class:"am-caes__service-content"},fg={class:"am-caes__service-content__text"},hg={class:"am-caes__service-content__text"},_g={class:"am-caes__service-content__text"},vg={class:"am-caes__service-content__inner am-caes__service-content__disabled"},yg={class:"am-caes__service-content__text"},bg={class:"am-caes__service-content__text"},kg={class:"am-caes__service-content__inner am-caes__service-content__disabled"},Cg={class:"am-caes__service-content__text"},xg={name:"CabinetEmployeeProfileServices"},wg=Object.assign(xg,{props:{responsiveClass:{type:String,default:""}},setup(n){const t=n;let e=De(),s=V("amLabels"),l=O(""),i={components:{IconComponent:We},template:'<IconComponent icon="search"/>'},o=O({}),r=_(()=>e.getters["employee/getEmployee"]),u=_(()=>e.getters["entities/getCategories"].filter(y=>y.status==="visible"&&y.serviceList.length>0&&(!l.value.trim()||y.serviceList.filter(w=>w.name.toLowerCase().includes(l.value.toLowerCase().trim())).length))),m=O(u.value.length===1?"category_"+u.value[0].id:null),h=O(0);function v(y){const w=y.serviceList.filter(A=>r.value.serviceList[y.id][A.id].enabled);return w.length>0&&w.length<y.serviceList.length}function g(y){const w=y.serviceList.filter(A=>r.value.serviceList[y.id][A.id].enabled);o.value[y.id]=w.length!==0}function b(y,w){w.serviceList.forEach(A=>{e.commit("employee/setServiceEnabled",{categoryId:w.id,serviceId:A.id,value:y})})}Je(()=>{u.value.forEach(y=>{o.value[y.id]=y.serviceList.filter(w=>r.value.serviceList[y.id][w.id].enabled).length!==0})});let D=V("amColors"),P=_(()=>({"--am-c-caes-primary":D.value.colorPrimary,"--am-c-caes-text":D.value.colorMainText,"--am-c-caes-text-op03":W(D.value.colorMainText,.03),"--am-c-caes-inp-bgr-op03":W(D.value.colorInpBgr,.03)}));return(y,w)=>{const A=ys,S=bs;return c(),C("div",null,[d("div",null,[I(mt,{modelValue:a(l),"onUpdate:modelValue":w[0]||(w[0]=f=>we(l)?l.value=f:l=f),"prefix-icon":a(i),"aria-label":"Search"},null,8,["modelValue","prefix-icon"])]),I(S,{modelValue:a(m),"onUpdate:modelValue":w[2]||(w[2]=f=>we(m)?m.value=f:m=f),class:"am-caes",style:ke(a(P))},{default:L(()=>[(c(!0),C(ae,null,pe(a(u),f=>(c(),U(A,{key:"category_"+f.id,name:"category_"+f.id,class:"am-caes__category"},{title:L(()=>[d("div",ug,[I(dt,{modelValue:a(o)[f.id],"onUpdate:modelValue":k=>a(o)[f.id]=k,indeterminate:v(f),onClick:k=>{k.stopPropagation(),we(m)?m.value=`category_${f.id}`:m=`category_${f.id}`},onChange:k=>b(k,f),onKeydown:Bi(k=>{k.stopPropagation(),we(m)?m.value=`category_${f.id}`:m=`category_${f.id}`,a(o)[f.id]=!a(o)[f.id],b(a(o)[f.id],f)},["enter"])},null,8,["modelValue","onUpdate:modelValue","indeterminate","onClick","onChange","onKeydown"]),d("div",dg,x(f.name),1)])]),default:L(()=>[I(S,{modelValue:a(h),"onUpdate:modelValue":w[1]||(w[1]=k=>we(h)?h.value=k:h=k),class:"am-caes__inner"},{default:L(()=>[(c(!0),C(ae,null,pe(a(u).find(k=>k.id===f.id).serviceList.filter(k=>!a(l).trim()||k.name.toLowerCase().includes(a(l).toLowerCase())),k=>(c(),U(A,{key:`service_${k.id}`,name:`service_${k.id}`,class:"am-caes__service"},{title:L(()=>[d("div",mg,[I(dt,{modelValue:a(r).serviceList[f.id][k.id].enabled,"onUpdate:modelValue":T=>a(r).serviceList[f.id][k.id].enabled=T,onClick:T=>{T.stopPropagation(),we(h)?h.value=`service_${k.id}`:h=`service_${k.id}`},onChange:T=>g(f),onKeydown:Bi(T=>{T.stopPropagation(),we(h)?h.value=`service_${k.id}`:h=`service_${k.id}`,a(r).serviceList[f.id][k.id].enabled=!a(r).serviceList[f.id][k.id].enabled,g(f)},["enter"])},null,8,["modelValue","onUpdate:modelValue","onClick","onChange","onKeydown"]),d("div",pg,x(k.name),1)])]),default:L(()=>[d("div",gg,[d("div",{class:B(["am-caes__service-content__item",t.responsiveClass])},[d("div",fg,x(a(s).minimum_capacity),1),I(ht,{modelValue:a(r).serviceList[f.id][k.id].minCapacity,"onUpdate:modelValue":T=>a(r).serviceList[f.id][k.id].minCapacity=T,class:"am-caes__service-content__inner",min:1,size:"small"},null,8,["modelValue","onUpdate:modelValue"])],2),d("div",{class:B(["am-caes__service-content__item",t.responsiveClass])},[d("div",hg,x(a(s).maximum_capacity),1),I(ht,{modelValue:a(r).serviceList[f.id][k.id].maxCapacity,"onUpdate:modelValue":T=>a(r).serviceList[f.id][k.id].maxCapacity=T,class:"am-caes__service-content__inner",min:a(r).serviceList[f.id][k.id].minCapacity,size:"small","aria-label":a(s).maximum_capacity},null,8,["modelValue","onUpdate:modelValue","min","aria-label"])],2),(c(!0),C(ae,null,pe(a(r).serviceList[f.id][k.id].customPricing.enabled!=="person"?a(r).serviceList[f.id][k.id].customPricing.durations:[],(T,E)=>(c(),C(ae,{key:E},[a(r).serviceList[f.id][k.id].customPricing.enabled==="duration"?(c(),C("div",{key:0,class:B(["am-caes__service-content__item",t.responsiveClass])},[d("div",_g,x(a(s).duration),1),d("div",vg,x(a(Zs)(E,a(s).h,a(s).min)),1)],2)):N("",!0),d("div",{class:B(["am-caes__service-content__item",t.responsiveClass])},[d("div",yg,x(a(s).price),1),I(mt,{modelValue:T.price,"onUpdate:modelValue":$=>T.price=$,class:"am-caes__service-content__inner",placeholder:"","aria-label":a(s).price,size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue","aria-label"])],2)],64))),128)),(c(!0),C(ae,null,pe(a(r).serviceList[f.id][k.id].customPricing.enabled==="person"?a(r).serviceList[f.id][k.id].customPricing.persons:[],(T,E)=>(c(),C(ae,{key:E},[d("div",{class:B(["am-caes__service-content__item",t.responsiveClass])},[d("div",bg,x(a(s).capacity),1),d("div",kg,x(T.from)+" - "+x(E),1)],2),d("div",{class:B(["am-caes__service-content__item",t.responsiveClass])},[d("div",Cg,x(a(s).price),1),I(mt,{modelValue:T.price,"onUpdate:modelValue":$=>T.price=$,class:"am-caes__service-content__inner",placeholder:"",size:"small","is-money":!0},null,8,["modelValue","onUpdate:modelValue"])],2)],64))),128))])]),_:2},1032,["name"]))),128))]),_:2},1032,["modelValue"])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])])}}});const Ta={props:{modelValue:{type:String},id:{type:String,default:""},disabled:{type:Boolean,default:!1},editable:{type:Boolean,default:!0},clearable:{type:Boolean,default:!0},includeEndTime:{type:Boolean,default:!1},size:{type:String,default:"default",validator(n){return["default","medium","small","mini","micro"].includes(n)}},placeholder:{type:String,default:""},name:{type:String},effect:{type:String,default:"light",validator(n){return["dark","light"].includes(n)}},prefixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="clock"/>'})},suffixIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="arrow-up"/>'})},clearIcon:{type:[String,Object,Function],default:Ge({components:{IconComponent:We},template:'<IconComponent icon="close"/>'})},start:{type:String,default:""},end:{type:String,default:""},step:{type:String,default:""},minTime:{type:String,default:""},maxTime:{type:String,default:""},format:{type:String,default:"HH:mm"},popperClass:{type:String,default:""},class:{type:String,default:""},parentClass:{type:String,default:""}},emits:["update:modelValue"],setup(n,{emit:t}){const e=n,{modelValue:s}=ci(e),l=_({get:()=>s.value,set:m=>{t("update:modelValue",m)}}),i=O(null);let o=V("amFonts",O({fontFamily:"Amelia Roboto, sans-serif",fontUrl:"",customFontFamily:"",fontFormat:"",customFontSelected:!1})),r=V("amColors",O({colorPrimary:"#1246D6",colorSuccess:"#019719",colorError:"#B4190F",colorWarning:"#CCA20C",colorMainBgr:"#FFFFFF",colorMainHeadingText:"#33434C",colorMainText:"#1A2C37",colorSbBgr:"#17295A",colorSbText:"#FFFFFF",colorInpBgr:"#FFFFFF",colorInpBorder:"#D1D5D7",colorInpText:"#1A2C37",colorInpPlaceHolder:"#808A90",colorDropBgr:"#FFFFFF",colorDropBorder:"#D1D5D7",colorDropText:"#0E1920",colorBtnPrim:"#265CF2",colorBtnPrimText:"#FFFFFF",colorBtnSec:"#1A2C37",colorBtnSecText:"#FFFFFF"})),u=_(()=>({"--am-c-timeselect-shadow":W(r.value.colorInpText,.05),"--am-c-timeselect-text-op60":W(r.value.colorInpText,.6),"--am-c-timeselect-text-op40":W(r.value.colorInpText,.4),"--am-c-timeselect-text-op10":W(r.value.colorInpText,.03),"--am-font-family":o.value.fontFamily}));return Je(()=>{const m=document.querySelector("[id^='el-popper-container']");m.style.setProperty("--am-c-option-bgr",r.value.colorDropBgr),m.style.setProperty("--am-c-option-border",r.value.colorDropBorder),m.style.setProperty("--am-c-option-text",r.value.colorDropText),m.style.setProperty("--am-c-option-text-op65",W(r.value.colorDropText,.65)),m.style.setProperty("--am-c-option-text-op50",W(r.value.colorDropText,.5)),m.style.setProperty("--am-c-option-hover",W(r.value.colorDropText,.1)),m.style.setProperty("--am-c-option-selected",r.value.colorPrimary),m.style.setProperty("--am-c-option-selected-op10",W(r.value.colorPrimary,.1)),m.style.setProperty("--am-c-option-img-bgr",r.value.colorSuccess),m.style.setProperty("--am-c-option-img-text",r.value.colorMainBgr),m.style.setProperty("--am-font-family",o.value.fontFamily)}),(m,h)=>{const v=Ur;return c(),C("div",{class:B(["am-time-select__wrapper",n.parentClass]),style:ke(a(u))},[I(v,{id:e.id,ref_key:"amTimeSelect",ref:i,modelValue:a(l),"onUpdate:modelValue":h[0]||(h[0]=g=>we(l)?l.value=g:null),class:B(["am-time-select",[`am-time-select--${n.size}`,{"am-time-select--disabled":n.disabled},{"am-time-select--prefix":e.prefixIcon},{"am-time-select--suffix":e.suffixIcon||e.clearIcon&&m.pross.clearable},e.class]]),disabled:e.disabled,placeholder:e.placeholder,"clear-icon":e.clearIcon,clearable:e.clearable,editable:e.editable,name:e.name,"popper-class":`am-time-select__popper${e.popperClass?" "+e.popperClass:e.popperClass}`,"prefix-icon":e.prefixIcon,"suffix-icon":e.suffixIcon,end:e.end,"max-time":e.maxTime,"min-time":e.minTime,start:e.start,step:e.step,format:e.format,"include-end-time":e.includeEndTime,effect:e.effect},null,8,["id","modelValue","class","disabled","placeholder","clear-icon","clearable","editable","name","popper-class","prefix-icon","suffix-icon","end","max-time","min-time","start","step","format","include-end-time","effect"])],6)}}};const Tg={class:"am-csd__period-header"},Lg={class:"am-csd__period-content__inner"},Eg=d("span",{class:"am-icon-clearable"},null,-1),Sg={name:"WorkPeriod"},Ag=Object.assign(Sg,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},origin:{type:String,default:""},periodIndex:{type:Number,default:0},originIndex:{type:Number,default:0},isNew:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:t}){const e=n;let s=De();const l=V("settings");let i=V("amLabels"),o=V("pageWidth"),r=O(null),u=_(()=>e.visibility);const{width:m}=ja(r),h=_(()=>st(m.value));it(u,ie=>{ie&&setTimeout(()=>{P.value=JSON.parse(JSON.stringify(T.value[e.periodIndex]))},300)});let v=O(!1),g=O(null),b=O("");function D(){v.value=!1,b.value=""}let P=O(null),y=O({startTime:_({get:()=>E.value.startTime,set:ie=>{E.value.startTime=ie}}),endTime:_({get:()=>E.value.endTime,set:ie=>{E.value.endTime=ie}}),periodServiceList:_({get:()=>E.value.periodServiceList,set:ie=>{E.value.periodServiceList=ie}}),periodLocationList:_({get:()=>E.value.periodLocationList,set:ie=>{E.value.periodLocationList=ie}})}),w=O(null),A=_(()=>({startTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}],endTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}]})),S=O();Re("formWrapper",S);let f=O(s.getters["entities/getLocations"]),k=_(()=>{let ie=wo(s),se=E.value.periodServiceList.filter(le=>ie.map(te=>te.id).indexOf(le)===-1);return ie.concat(s.getters["entities/getServices"].filter(le=>se.indexOf(le.id)!==-1))}),T=_(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].periodList),E=_(()=>e.periodIndex!==null?T.value[e.periodIndex]:null);function $(ie){return Nt(Bt(ie)-l.general.timeSlotLength)}function R(ie){let se=Nt(Bt(ie)+l.general.timeSlotLength);return se==="00:00"?null:se}function Y(){w.value.validate(ie=>{ie&&t("close")})}function M(){e.isNew?T.value.pop():T.value[e.periodIndex]=P.value,t("close")}let K=V("amFonts"),ce=V("amColors"),j=_(()=>({"--am-c-csd-text":ce.value.colorMainText,"--am-c-csd-bgr":ce.value.colorMainBgr,"--am-c-csd-text-op10":W(ce.value.colorMainText,.1),"--am-c-scroll-op30":W(ce.value.colorPrimary,.3),"--am-c-scroll-op10":W(ce.value.colorPrimary,.1),"--am-font-family":K.value.fontFamily}));return(ie,se)=>{const le=vt,te=et;return c(),U(za,{visibility:a(e).visibility,style:ke(a(j)),"custom-class":`am-csd am-csd__period${a(o)<=400?" am-w-100":""}`,position:"center","onUpdate:visibility":M},To({footer:L(()=>[d("div",{class:B(["am-csd__period-footer",a(h)])},[I(Te,{category:"secondary",type:"plain",size:a(o)>430?"default":"small",onClick:M},{default:L(()=>[re(x(a(i).cancel),1)]),_:1},8,["size"]),I(Te,{size:a(o)>430?"default":"small",onClick:Y},{default:L(()=>[re(x(a(i).save),1)]),_:1},8,["size"])],2)]),default:L(()=>[a(E)?(c(),C("div",{key:0,ref_key:"popupPeriodRef",ref:r,class:"am-csd__period-content"},[d("div",Lg,[a(v)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:D,onTriggerClose:D},{title:L(()=>[Eg,re(" "+x(a(b)),1)]),_:1},512)):N("",!0),I(te,{ref_key:"periodFormRef",ref:w,class:"am-csd__period-form",rules:a(A),model:a(y),"label-position":"top"},{default:L(()=>[I(le,{label:`${a(i).time}:`,prop:"startTime",class:B(["am-csd__period-form__item am-w-50",a(h)])},{default:L(()=>[I(Ta,{modelValue:a(E).startTime,"onUpdate:modelValue":se[0]||(se[0]=ne=>a(E).startTime=ne),placeholder:a(i).from,start:"00:00",end:$("24:00"),"min-time":a(e).periodIndex===0?null:$(a(T)[a(e).periodIndex-1].endTime),"max-time":a(e).periodIndex===a(T).length-1?null:a(E).endTime,step:a(Nt)(a(l).general.timeSlotLength)},null,8,["modelValue","placeholder","end","min-time","max-time","step"])]),_:1},8,["label","class"]),I(le,{label:`${a(i).time}:`,prop:"endTime",class:B(["am-csd__period-form__item am-w-50",a(h)])},{default:L(()=>[I(Ta,{modelValue:a(E).endTime,"onUpdate:modelValue":se[1]||(se[1]=ne=>a(E).endTime=ne),placeholder:a(i).to_upper,disabled:!a(E).startTime,start:R("00:00"),end:"24:00","min-time":a(E).startTime,"max-time":a(e).periodIndex===a(T).length-1?null:R(a(T)[a(e).periodIndex+1].startTime),step:a(Nt)(a(l).general.timeSlotLength)},null,8,["modelValue","placeholder","disabled","start","min-time","max-time","step"])]),_:1},8,["label","class"]),I(le,{label:`${a(i).heading_services}:`,prop:"periodServiceList",class:"am-csd__period-form__item"},{default:L(()=>[I(Ze,{modelValue:a(E).periodServiceList,"onUpdate:modelValue":se[2]||(se[2]=ne=>a(E).periodServiceList=ne),placeholder:`${a(i).all_services}`,multiple:"",clearable:""},{default:L(()=>[(c(!0),C(ae,null,pe(a(k),ne=>(c(),U(Ue,{key:ne.id,value:ne.id,label:ne.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),a(f).length>0?(c(),U(le,{key:0,label:`${a(i).location}:`,prop:"periodLocationList",class:"am-csd__period-form__item"},{default:L(()=>[I(Ze,{modelValue:a(E).periodLocationList,"onUpdate:modelValue":se[3]||(se[3]=ne=>a(E).periodLocationList=ne),placeholder:`${a(i).all_locations}`,multiple:"",clearable:""},{default:L(()=>[(c(!0),C(ae,null,pe(a(f),ne=>(c(),U(Ue,{key:ne.id,value:ne.id,label:ne.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["rules","model"])])],512)):N("",!0)]),_:2},[a(e).title?{name:"header",fn:L(()=>[d("div",Tg,x(a(e).title),1)])}:void 0]),1032,["visibility","style","custom-class"])}}});const Ig={class:"am-csd__timeOut-header"},$g={class:"am-csd__timeOut-content__inner"},Dg=d("span",{class:"am-icon-clearable"},null,-1),Pg={name:"WorkTimeOut"},Ng=Object.assign(Pg,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},origin:{type:String,default:""},timeOutIndex:{type:Number,default:0},originIndex:{type:Number,default:0},isNew:{type:Boolean,default:!1}},emits:["close"],setup(n,{emit:t}){const e=n;let s=De();const l=V("settings");let i=V("amLabels"),o=V("pageWidth"),r=O(null),u=_(()=>e.visibility);const{width:m}=ja(r),h=_(()=>st(m.value));it(u,j=>{j&&setTimeout(()=>{P.value=JSON.parse(JSON.stringify(f.value[e.timeOutIndex]))},300)});let v=O(!1),g=O(null),b=O("");function D(){v.value=!1,b.value=""}let P=O(null),y=O({startTime:_({get:()=>T.value.startTime,set:j=>{T.value.startTime=j}}),endTime:_({get:()=>T.value.endTime,set:j=>{T.value.endTime=j}})}),w=O(null),A=_(()=>({startTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}],endTime:[{required:!0,message:i.select_time_warning,trigger:["submit","change"]}]})),S=O();Re("formWrapper",S);let f=_(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].timeOutList),k=_(()=>s.getters["employee/getEmployee"][e.origin][e.originIndex].periodList),T=_(()=>e.timeOutIndex!==null?f.value[e.timeOutIndex]:null);_(()=>k.value.length?$(k.value[0].startTime):"00:00"),_(()=>k.value.length?E(k.value[k.value.length-1].endTime):"00:00");function E(j){return Nt(Bt(j)-l.general.timeSlotLength)}function $(j){let ie=Nt(Bt(j)+l.general.timeSlotLength);return ie==="00:00"?null:ie}function R(){w.value.validate(j=>{j&&t("close")})}function Y(){e.isNew?f.value.pop():f.value[e.timeOutIndex]=P.value,t("close")}let M=V("amFonts"),K=V("amColors"),ce=_(()=>({"--am-c-csd-text":K.value.colorMainText,"--am-c-csd-bgr":K.value.colorMainBgr,"--am-c-csd-text-op10":W(K.value.colorMainText,.1),"--am-c-scroll-op30":W(K.value.colorPrimary,.3),"--am-c-scroll-op10":W(K.value.colorPrimary,.1),"--am-font-family":M.value.fontFamily}));return(j,ie)=>{const se=vt,le=et;return c(),U(za,{visibility:a(e).visibility,style:ke(a(ce)),"custom-class":`am-csd am-csd__timeOut${a(o)<=400?" am-w-100":""}`,position:"center","onUpdate:visibility":Y},To({footer:L(()=>[d("div",{class:B(["am-csd__timeOut-footer",a(h)])},[I(Te,{category:"secondary",type:"plain",size:a(o)>430?"default":"small",onClick:Y},{default:L(()=>[re(x(a(i).cancel),1)]),_:1},8,["size"]),I(Te,{size:a(o)>430?"default":"small",onClick:R},{default:L(()=>[re(x(a(i).save),1)]),_:1},8,["size"])],2)]),default:L(()=>[a(T)?(c(),C("div",{key:0,ref_key:"popupTimeOutRef",ref:r,class:"am-csd__timeOut-content"},[d("div",$g,[a(v)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:D,onTriggerClose:D},{title:L(()=>[Dg,re(" "+x(a(b)),1)]),_:1},512)):N("",!0),I(le,{ref_key:"timeOutFormRef",ref:w,class:"am-csd__timeOut-form",rules:a(A),model:a(y),"label-position":"top"},{default:L(()=>[I(se,{label:`${a(i).time}:`,prop:"startTime",class:B(["am-csd__timeOut-form__item am-w-50",a(h)])},{default:L(()=>[I(Ta,{modelValue:a(T).startTime,"onUpdate:modelValue":ie[0]||(ie[0]=te=>a(T).startTime=te),placeholder:a(i).from,start:$(a(k)[0].startTime),end:E(a(k)[a(k).length-1].endTime),step:a(Nt)(a(l).general.timeSlotLength),"max-time":a(f)[a(e).timeOutIndex].endTime},null,8,["modelValue","placeholder","start","end","step","max-time"])]),_:1},8,["label","class"]),I(se,{label:`${a(i).time}:`,prop:"endTime",class:B(["am-csd__timeOut-form__item am-w-50",a(h)])},{default:L(()=>[I(Ta,{modelValue:a(T).endTime,"onUpdate:modelValue":ie[1]||(ie[1]=te=>a(T).endTime=te),placeholder:a(i).to_upper,disabled:!a(T).startTime,start:$(a(k)[0].startTime),end:E(a(k)[a(k).length-1].endTime),"min-time":a(f)[a(e).timeOutIndex].startTime,step:a(Nt)(a(l).general.timeSlotLength)},null,8,["modelValue","placeholder","disabled","start","end","min-time","step"])]),_:1},8,["label","class"])]),_:1},8,["rules","model"])])],512)):N("",!0)]),_:2},[a(e).title?{name:"header",fn:L(()=>[d("div",Ig,x(a(e).title),1)])}:void 0]),1032,["visibility","style","custom-class"])}}});const Og={class:"am-cc__edit"},Mg=d("span",{class:"am-icon-edit"},null,-1),Fg={class:"am-cc__edit-text"},Vg=d("span",{class:"am-icon-search"},null,-1),Bg={class:"am-cc__edit-text"},Rg=d("span",{class:"am-icon-clearable"},null,-1),qg={class:"am-cc__edit-text"},Ug=d("span",{class:"am-icon-clearable"},null,-1),zg={class:"am-cc__edit-text"},jg={name:"DotsPopup"},ha=Object.assign(jg,{props:{index:{type:Number,default:0},referenceClass:{type:String,default:""},haveDuplicate:{type:Boolean,default:!1},haveDelete:{type:Boolean,default:!0},haveEdit:{type:Boolean,default:!0},haveView:{type:Boolean,default:!1}},emits:["remove","edit","duplicate"],setup(n,{emit:t}){const e=n;let s=V("amLabels"),l=O(!1);function i(){l.value=!0}function o(){t("edit",e.index),m()}function r(){t("remove",e.index),m()}function u(){t("duplicate",e.index),m()}function m(){l.value=!1}let h=V("amFonts"),v=V("amColors"),g=_(()=>({"--am-c-cc-error":v.value.colorError,"--am-c-cc-error-op15":W(v.value.colorError,.15),"--am-c-cc-bgr":v.value.colorMainBgr,"--am-c-cc-text":v.value.colorMainText,"--am-c-cc-text-op10":W(v.value.colorMainText,.1),"--am-c-cc-text-op15":W(v.value.colorMainText,.15),"--am-font-family":h.value.fontFamily}));return(b,D)=>{const P=Gs;return c(),U(P,{ref:"editRef",visible:a(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(g),trigger:"click"},{reference:L(()=>[d("span",{class:B(["am-cc__edit-btn am-icon-dots-vertical",a(e).referenceClass]),onClick:i},null,2)]),default:L(()=>[zt((c(),C("div",Og,[a(e).haveEdit?(c(),C("div",{key:0,class:"am-cc__edit-item",onClick:o},[Mg,d("span",Fg,x(a(s).edit),1)])):N("",!0),a(e).haveView?(c(),C("div",{key:1,class:"am-cc__edit-item",onClick:o},[Vg,d("span",Bg,x(a(s).view),1)])):N("",!0),a(e).haveDelete?(c(),C("div",{key:2,class:"am-cc__edit-item am-delete",onClick:r},[Rg,d("span",qg,x(a(s).delete),1)])):N("",!0),a(e).haveDuplicate?(c(),C("div",{key:3,class:"am-cc__edit-item am-clone",onClick:u},[Ug,d("span",zg,x(a(s).duplicate),1)])):N("",!0)])),[[a(ia),m]])]),_:1},8,["visible","popper-style"])}}});const Yg={class:"am-caeper__heading-item am-w-20"},Wg={class:"am-caeper__heading-item am-w-40"},Hg={class:"am-caeper__heading-item am-w-40"},Zg={key:1},Gg={class:"am-caeper__heading-item am-w-20"},Jg={key:0,class:"am-caeper__error"},Xg={name:"WorkPeriods"},pr=Object.assign(Xg,{props:{title:{type:String,default:""},type:{type:String,default:""},index:{type:Number,default:0},enabled:{type:Boolean,default:!1},headerVisible:{type:Boolean,default:!0},applyToAllDaysVisible:{type:Boolean,default:!0},footerVisible:{type:Boolean,default:!0},editVisible:{type:Boolean,default:!0},error:{type:String,default:""},responsiveClass:{type:String,default:""}},emits:["addPeriod"],setup(n,{emit:t}){const e=n;let s=De(),l=V("amLabels"),i=_(()=>s.getters["entities/getLocations"]),o=_(()=>s.getters["entities/getServices"]),r=_(()=>wo(s)),u=_(()=>{let A=s.getters["employee/getEmployee"];switch(e.type){case"weekDayList":return A.weekDayList[e.index].periodList;case"specialDayList":return A.specialDayList[e.index].periodList}return[]}),m=_(()=>{let A=s.getters["employee/getEmployee"];return e.type==="weekDayList"?A.weekDayList[e.index].timeOutList:[]}),h=O(null),v=O(null),g=O(null);function b(){u.value.push({id:null,locationId:null,startTime:"",endTime:"",periodLocationList:[],periodServiceList:[],editing:!0}),g.value=!0,h.value=u.value.length-1,t("addPeriod")}function D(){let A=[];s.getters["employee/getEmployee"].weekDayList[e.index].periodList.forEach(S=>{A.push({id:null,locationId:null,startTime:S.startTime,endTime:S.endTime,periodLocationList:[...S.periodLocationList],periodServiceList:[...S.periodServiceList],editing:!1})}),s.getters["employee/getEmployee"].weekDayList.forEach((S,f)=>{f!==e.index&&(S.periodList=JSON.parse(JSON.stringify(A)))})}function P(){return!u.value.length||!u.value.filter(A=>A.startTime&&A.endTime).length||u.value[u.value.length-1].endTime!=="00:00"}let y=V("amColors"),w=_(()=>({"--am-c-caeper-bgr":y.value.colorMainBgr,"--am-c-caeper-text":y.value.colorMainText,"--am-c-caeper-text-op80":W(y.value.colorMainText,.8)}));return(A,S)=>zt((c(),C("div",{class:"am-caeper",style:ke(a(w))},[a(e).headerVisible&&a(u).length?(c(),C("div",{key:0,class:B(["am-caeper__heading",a(e).responsiveClass])},[d("div",Yg,x(a(l).time),1),d("div",Wg,x(a(l).service_colon),1),d("div",Hg,x(a(l).location),1)],2)):N("",!0),(c(!0),C(ae,null,pe(a(u),(f,k)=>(c(),C("div",{key:k,class:"am-caeper__content"},[d("div",{class:B(["am-caeper__content-item am-w-20",a(e).responsiveClass])},x(f.startTime?f.startTime.substring(0,5):"")+" - "+x(f.endTime?f.endTime.substring(0,5):""),3),d("div",{class:B(["am-caeper__content-item am-w-40",[a(e).responsiveClass,{"am-cabinet-empty":!f.periodServiceList.length}]])},x(f.periodServiceList.filter(T=>a(r).map(E=>E.id).indexOf(T)!==-1).map(T=>a(o).find(E=>E.id===T).name).join(", ")),3),d("div",{class:B(["am-caeper__content-item am-w-40",[a(e).responsiveClass,{"am-cabinet-empty":!f.periodLocationList.length}]])},x(f.periodLocationList.map(T=>a(i).find(E=>E.id===T).name).join(", ")),3),a(e).editVisible?(c(),U(ha,{key:0,index:k,onRemove:T=>a(u).splice(k,1),onEdit:T=>we(h)?h.value=k:h=k},null,8,["index","onRemove","onEdit"])):N("",!0)]))),128)),a(m).length?(c(),C("span",Zg,x(a(l).breaks),1)):N("",!0),a(e).headerVisible&&a(m).length?(c(),C("div",{key:2,class:B(["am-caeper__heading",a(e).responsiveClass])},[d("div",Gg,x(a(l).time),1)],2)):N("",!0),(c(!0),C(ae,null,pe(a(m),(f,k)=>(c(),C("div",{key:k,class:"am-caeper__content"},[d("div",{class:B(["am-caeper__content-item am-w-20",a(e).responsiveClass])},x(f.startTime?f.startTime.substring(0,5):"")+" - "+x(f.endTime?f.endTime.substring(0,5):""),3),a(e).editVisible?(c(),U(ha,{key:0,index:k,onRemove:T=>a(m).splice(k,1),onEdit:T=>we(v)?v.value=k:v=k},null,8,["index","onRemove","onEdit"])):N("",!0)]))),128)),a(e).footerVisible?(c(),C("div",{key:3,class:B(["am-caeper__footer",[{"am-error":a(e).error},a(e).responsiveClass]])},[a(e).error?(c(),C("div",Jg,x(a(e).error),1)):N("",!0),P()?(c(),U(Te,{key:1,prefix:"plus",size:"small",onClick:S[0]||(S[0]=f=>b())},{default:L(()=>[re(x(a(l).add_period),1)]),_:1})):N("",!0),a(e).applyToAllDaysVisible?(c(),U(Te,{key:2,size:"small",category:"secondary",type:"plain",onClick:D},{default:L(()=>[re(x(a(l).apply_to_all_days),1)]),_:1})):N("",!0)],2)):N("",!0),I(Ag,{title:a(e).title,visibility:a(h)!==null,origin:a(e).type,"period-index":a(h),"origin-index":n.index,"is-new":a(g),onClose:S[1]||(S[1]=()=>{we(h)?h.value=null:h=null,we(g)?g.value=null:g=null})},null,8,["title","visibility","origin","period-index","origin-index","is-new"]),I(Ng,{title:a(l).break_hours,visibility:a(v)!==null,origin:a(e).type,"time-out-index":a(v),"origin-index":n.index,"is-new":!1,"is-break":!0,onClose:S[2]||(S[2]=()=>{we(v)?v.value=null:v=null})},null,8,["title","visibility","origin","time-out-index","origin-index"])],4)),[[Lo,a(e).enabled]])}});const Qg={class:"am-caewh__header"},Kg={class:"am-caewh__header-text"},ef={class:"am-caewh__content"},tf={name:"WeekDays"},af=Object.assign(tf,{props:{responsiveClass:{type:String,default:""}},setup(n){const t=n;let e=De(),s=V("amLabels"),l=_(()=>e.getters["employee/getEmployee"]),i=O([{label:s.weekday_monday,value:"monday"},{label:s.weekday_tuesday,value:"tuesday"},{label:s.weekday_wednesday,value:"wednesday"},{label:s.weekday_thursday,value:"thursday"},{label:s.weekday_friday,value:"friday"},{label:s.weekday_saturday,value:"saturday"},{label:s.weekday_sunday,value:"sunday"}]),o=V("amColors"),r=_(()=>({"--am-c-caewh-primary":o.value.colorPrimary,"--am-c-caewh-bgr":o.value.colorMainBgr,"--am-c-caewh-text":o.value.colorMainText,"--am-c-caewh-text-op03":W(o.value.colorMainText,.03),"--am-c-caewh-bgr-op03":W(o.value.colorInpBgr,.03)}));return(u,m)=>(c(),C("div",{class:"am-caewh",style:ke(a(r))},[(c(!0),C(ae,null,pe(a(l).weekDayList,(h,v)=>(c(),C("div",{key:v,class:"am-caewh__item"},[d("div",Qg,[d("div",Kg,x(a(i)[v].label),1),I(lt,{modelValue:h.enabled,"onUpdate:modelValue":g=>h.enabled=g,size:"small","aria-label":a(i)[v].label},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),d("div",ef,[I(pr,{title:a(s).working_hours,enabled:h.enabled,index:v,type:"weekDayList","responsive-class":a(t).responsiveClass},null,8,["title","enabled","index","responsive-class"])])]))),128))],4))}});const sf={class:"am-ces__img-holder"},lf={width:"240",height:"195",viewBox:"0 0 240 195",fill:"none",xmlns:"http://www.w3.org/2000/svg"},nf={"clip-path":"url(#clip0_1811_81872)"},of=["fill"],rf=["fill"],cf=["fill"],uf=["fill"],df=["fill"],mf=["fill"],pf=["fill"],gf={opacity:"0.5"},ff=["fill"],hf=["fill"],_f=["fill"],vf=["fill"],yf=["fill"],bf=["stroke"],kf={opacity:"0.5"},Cf=["stroke"],xf=zr('<circle cx="109.964" cy="55.167" r="34.0723" transform="rotate(-45 109.964 55.167)" fill="url(#paint0_linear_1811_81872)" fill-opacity="0.7"></circle><mask id="mask0_1811_81872" style="mask-type:alpha;" maskUnits="userSpaceOnUse" x="75" y="21" width="69" height="69"><circle cx="109.714" cy="55.167" r="34.0723" transform="rotate(-45 109.714 55.167)" fill="url(#paint1_linear_1811_81872)"></circle></mask><g mask="url(#mask0_1811_81872)"><rect x="111.095" y="4.51782" width="10.0968" height="107.245" transform="rotate(30 111.095 4.51782)" fill="url(#paint2_linear_1811_81872)" fill-opacity="0.6"></rect><rect x="125.427" y="2.67041" width="3.39099" height="107.245" transform="rotate(30 125.427 2.67041)" fill="url(#paint3_linear_1811_81872)" fill-opacity="0.6"></rect></g>',3),wf={id:"paint0_linear_1811_81872",x1:"144.037",y1:"91.6409",x2:"83.5731",y2:"31.1781",gradientUnits:"userSpaceOnUse"},Tf=["stop-color"],Lf=["stop-color"],Ef={id:"paint1_linear_1811_81872",x1:"143.786",y1:"91.6409",x2:"83.3226",y2:"31.1781",gradientUnits:"userSpaceOnUse"},Sf=["stop-color"],Af=["stop-color"],If={id:"paint2_linear_1811_81872",x1:"116.144",y1:"4.51782",x2:"116.144",y2:"111.763",gradientUnits:"userSpaceOnUse"},$f=["stop-color"],Df=["stop-color"],Pf={id:"paint3_linear_1811_81872",x1:"127.122",y1:"2.67041",x2:"127.122",y2:"109.915",gradientUnits:"userSpaceOnUse"},Nf=["stop-color"],Of=["stop-color"],Mf={id:"clip0_1811_81872"},Ff=["fill"],Vf={class:"am-ces__content"},Bf={class:"am-ces__heading"},Rf={class:"am-ces__text"},Aa={props:{heading:{type:String,default:""},text:{type:String,default:""}},setup(n){const t=n;let e=V("amColors"),s=_(()=>({"--am-c-ces-text":e.value.colorMainText,"--am-c-ces-text-op70":W(e.value.colorMainText,.7)}));return(l,i)=>(c(),C("div",{class:"am-ces",style:ke(a(s))},[d("div",sf,[(c(),C("svg",lf,[d("g",nf,[d("path",{d:"M10.0934 144.996C11.624 145.051 13.0595 145.879 14.0693 147.034C15.0791 148.184 15.6995 149.633 16.0934 151.114C16.8587 153.976 16.3878 157.359 15.5727 160.207C12.4708 159.097 10.5599 155.792 9.69496 154.053C8.32741 151.304 7.5259 145.513 10.0889 144.996",fill:a(e).colorMainText},null,8,of),d("path",{d:"M20.033 163.676C19.0549 162.272 19.0322 160.32 19.8066 158.79C20.5809 157.264 22.0662 156.163 23.7009 155.661C24.4571 155.43 25.3356 155.33 25.9922 155.769C26.6081 156.181 26.8752 156.987 26.7937 157.721C26.7122 158.455 26.3409 159.129 25.9017 159.723C24.3937 161.765 22.5598 163.463 20.033 163.671",fill:a(e).colorMainText},null,8,rf),d("path",{d:"M20.3771 173.244C20.3771 173.244 20.3137 173.036 20.2367 172.651C20.1552 172.225 20.0465 171.677 19.9198 171.021C19.6752 169.649 19.2858 167.697 19.5801 165.541C19.8609 163.395 20.7167 161.557 21.6133 160.461C22.0526 159.908 22.4782 159.514 22.7907 159.274C22.9401 159.148 23.076 159.071 23.1575 159.007C23.2435 158.948 23.2933 158.921 23.2979 158.93C23.3296 158.966 22.5733 159.437 21.7356 160.556C20.8888 161.656 20.0737 163.458 19.793 165.573C19.5032 167.688 19.8609 169.621 20.0692 170.998C20.1779 171.691 20.2684 172.252 20.3228 172.642C20.3726 173.031 20.3952 173.249 20.3771 173.249V173.244Z",fill:a(e).colorMainText},null,8,cf),d("path",{d:"M11.0894 149.357C11.0894 149.357 11.1392 149.434 11.2161 149.593C11.2977 149.769 11.4063 150 11.5377 150.281C11.8094 150.883 12.1988 151.757 12.6652 152.839C13.598 155.009 14.8478 158.024 16.152 161.38C17.4561 164.74 18.5656 167.81 19.3354 170.038C19.7203 171.152 20.0282 172.058 20.232 172.687C20.3271 172.986 20.4041 173.226 20.4629 173.412C20.5128 173.579 20.5354 173.665 20.5309 173.67C20.5263 173.674 20.4856 173.588 20.4222 173.425C20.3543 173.239 20.2637 173.004 20.155 172.714C19.9195 172.071 19.5935 171.179 19.195 170.088C18.3845 167.869 17.2524 164.812 15.9528 161.452C14.6486 158.097 13.426 155.076 12.5294 152.894C12.0901 151.821 11.7278 150.942 11.4652 150.308C11.3475 150.018 11.2569 149.783 11.1844 149.602C11.1211 149.439 11.0939 149.353 11.0984 149.348L11.0894 149.357Z",fill:a(e).colorMainText},null,8,uf),d("path",{d:"M16.6956 166.913C14.8662 163.802 11.4564 161.683 7.85639 161.421C6.94167 161.353 5.83676 161.507 5.42922 162.331C5.02167 163.155 5.56507 164.128 6.18997 164.808C8.78922 167.62 13.1817 168.602 16.7273 167.162",fill:a(e).colorMainText},null,8,df),d("path",{d:"M9.25113 163.875C9.25113 163.875 9.4549 163.87 9.82622 163.897C10.0119 163.911 10.2383 163.925 10.4964 163.974C10.7545 164.024 11.0534 164.051 11.3749 164.137C11.6964 164.214 12.0541 164.296 12.4209 164.427C12.7968 164.536 13.1817 164.699 13.5847 164.871C14.3817 165.233 15.233 165.709 16.0391 166.325C16.8406 166.95 17.5153 167.647 18.0677 168.331C18.3304 168.679 18.584 169.014 18.7832 169.354C19.0006 169.68 19.1636 170.006 19.313 170.3C19.476 170.59 19.5711 170.876 19.6798 171.116C19.7885 171.356 19.8519 171.573 19.9062 171.75C20.0149 172.103 20.0692 172.297 20.0557 172.302C20.0104 172.32 19.7885 171.528 19.1772 170.368C19.0187 170.083 18.8511 169.766 18.6292 169.449C18.43 169.119 18.1764 168.797 17.9092 168.457C17.3613 167.792 16.6911 167.113 15.9032 166.497C15.1108 165.89 14.2821 165.419 13.4987 165.052C13.1047 164.88 12.7243 164.713 12.3575 164.599C11.9998 164.463 11.6511 164.377 11.3341 164.287C10.0617 163.965 9.24207 163.92 9.2466 163.875H9.25113Z",fill:a(e).colorMainText},null,8,mf),d("path",{d:"M91.9065 80.3956L75.8945 162.72L73.7979 173.497L180.693 172.972C185.488 172.95 189.74 168.688 191.285 162.362L210.24 84.6386C211.413 79.8341 208.841 74.8394 205.2 74.8394L97.0099 74.9526C94.619 74.9526 92.5314 77.185 91.9065 80.3956Z",fill:a(e).colorMainBgr},null,8,pf),d("g",gf,[d("path",{d:"M91.9065 80.3951L75.8945 162.72L73.7979 173.497L180.693 172.972C185.488 172.949 189.74 168.688 191.285 162.362L210.24 84.6381C211.413 79.8336 208.841 74.8389 205.2 74.8389L97.0099 74.9521C94.619 74.9521 92.5314 77.1845 91.9065 80.3951Z",fill:a(e).colorMainText},null,8,ff)]),d("path",{d:"M170.441 157.146L159.125 65.9412C158.663 62.2053 155.683 59.4159 152.169 59.4295L127.35 59.511C125.511 59.5155 123.75 60.2989 122.445 61.6846L110.663 74.2099L41.6378 74.5721C37.422 74.5948 34.1797 78.5842 34.7367 83.0718L45.2469 167.366C45.7133 171.097 48.6839 173.882 52.1933 173.873L172.488 173.638C185.887 173.914 187.164 169.961 187.164 169.961C171.808 173.362 170.441 157.159 170.441 157.15V157.146Z",fill:a(e).colorMainText},null,8,hf),d("rect",{x:"130.984",y:"80.0801",width:"5.5062",height:"25.0888",rx:"2.7531",transform:"rotate(-45 130.984 80.0801)",fill:a(e).colorMainBgr},null,8,_f),d("path",{d:"M147.845 104.347C142.496 98.9978 142.496 90.3249 147.845 84.9756C148.737 84.084 150.182 84.084 151.074 84.9756L178.063 111.965C181.183 115.085 181.183 120.144 178.063 123.265C174.942 126.385 169.883 126.385 166.763 123.265L147.845 104.347Z",fill:a(e).colorMainBgr},null,8,vf),d("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M151.42 91.7928C151.138 91.5115 150.682 91.5115 150.401 91.7928C150.12 92.0741 150.12 92.5303 150.401 92.8116L161.801 104.212C162.083 104.493 162.539 104.493 162.82 104.212C163.101 103.931 163.101 103.474 162.82 103.193L151.42 91.7928ZM165.702 105.806C165.42 105.524 164.964 105.524 164.683 105.806C164.402 106.087 164.402 106.543 164.683 106.825L165.11 107.252C165.391 107.533 165.847 107.533 166.129 107.252C166.41 106.97 166.41 106.514 166.129 106.233L165.702 105.806Z",fill:a(e).colorMainText},null,8,yf),d("circle",{cx:"109.964",cy:"55.167",r:"37.6805",transform:"rotate(-45 109.964 55.167)",stroke:a(e).colorMainText,"stroke-width":"8"},null,8,bf),d("g",kf,[d("circle",{cx:"109.964",cy:"55.167",r:"37.6805",transform:"rotate(-45 109.964 55.167)",stroke:a(e).colorMainBgr,"stroke-width":"8"},null,8,Cf)]),xf]),d("defs",null,[d("linearGradient",wf,[d("stop",{"stop-color":a(e).colorMainBgr},null,8,Tf),d("stop",{offset:"1","stop-color":a(e).colorMainBgr},null,8,Lf)]),d("linearGradient",Ef,[d("stop",{"stop-color":a(e).colorMainBgr},null,8,Sf),d("stop",{offset:"1","stop-color":a(e).colorMainBgr},null,8,Af)]),d("linearGradient",If,[d("stop",{"stop-color":a(e).colorMainText},null,8,$f),d("stop",{offset:"1","stop-color":a(e).colorMainText,"stop-opacity":"0"},null,8,Df)]),d("linearGradient",Pf,[d("stop",{"stop-color":a(e).colorMainText},null,8,Nf),d("stop",{offset:"1","stop-color":a(e).colorMainText,"stop-opacity":"0"},null,8,Of)]),d("clipPath",Mf,[d("rect",{width:"240",height:"194.717",fill:a(e).colorMainText},null,8,Ff)])])]))]),d("div",Vf,[d("div",Bf,x(a(t).heading),1),d("div",Rf,x(a(t).text),1)])],4))}};const qf={class:"am-caesd__item"},Uf={class:"am-caesd__item-header"},zf={key:2},jf={key:0,class:"am-caesd__footer"},Yf={name:"SpecialDays"},Wf=Object.assign(Yf,{props:{responsiveClass:{type:String,default:""}},setup(n){const t=n;let e=De(),s=V("amLabels"),l=V("localLanguage"),i=_(()=>e.getters["employee/getEmployee"].specialDayList),o=Qe({data:null,index:null}),r=O({range:_({get:()=>e.getters["employee/getEmployee"].specialDayList[o.index].range,set:f=>{e.getters["employee/getEmployee"].specialDayList[o.index].range=f}})}),u=O([]),m=_(()=>({range:[{required:!0,message:s.select_date_warning,trigger:["submit","change"]}]}));function h(f){i.value.splice(f,1)}function v(f){o.index=f,o.data=JSON.parse(JSON.stringify(i.value[f]))}function g(f){let k=[];i.value[f].periodList.forEach(T=>{k.push({id:null,locationId:null,startTime:T.startTime,endTime:T.endTime,periodLocationList:[...T.periodLocationList],periodServiceList:[...T.periodServiceList],editing:!1})}),e.getters["employee/getEmployee"].specialDayList.push({id:null,range:[],periodList:k}),o.index=i.value.length-1,o.data={}}let b=O("");function D(f){let k=e.getters["employee/getEmployee"].specialDayList[f].periodList;u.value[f].validate(T=>{T&&k.length>0?(b.value="",o.index=null,o.data=null):b.value="Please add period to special day"})}function P(f){Object.keys(o.data).length===0?i.value.pop():i.value[f]=o.data,o.index=null,o.data=null,b.value=""}function y(){i.value.push({id:null,range:[],periodList:[]}),o.index=i.value.length-1,o.data={}}function w(f,k){f?u.value[k]=f:u.value.splice(k,1)}let A=V("amColors"),S=_(()=>({"--am-c-caesd-bgr":A.value.colorMainBgr,"--am-c-caesd-text":A.value.colorMainText,"--am-c-caesd-text-op03":W(A.value.colorMainText,.03),"--am-c-caesd-text-op80":W(A.value.colorMainText,.8)}));return(f,k)=>{const T=vt,E=et;return c(),C("div",{class:"am-caesd",style:ke(a(S))},[(c(!0),C(ae,null,pe(a(i),($,R)=>(c(),C("div",{key:R,class:"am-caesd__content"},[d("div",qf,[d("div",Uf,[a(o).index!==R?(c(),C(ae,{key:0},[d("div",null,x($.range[0]?a(ot)(a(me)($.range[0]).format("YYYY-MM-DD")):"")+" - "+x($.range[1]?a(ot)(a(me)($.range[1]).format("YYYY-MM-DD")):""),1),I(ha,{index:R,"have-duplicate":!0,onRemove:Y=>h(R),onEdit:Y=>v(R),onDuplicate:Y=>g(R)},null,8,["index","onRemove","onEdit","onDuplicate"])],64)):N("",!0),a(o).index===R?(c(),U(E,{key:1,ref_for:!0,ref:Y=>w(Y,R),class:"am-caesd__form",rules:a(m),model:a(r),"label-position":"top"},{default:L(()=>[I(T,{prop:"range"},{default:L(()=>[I(Yt,{modelValue:a(r).range,"onUpdate:modelValue":k[0]||(k[0]=Y=>a(r).range=Y),type:"daterange",size:"small","popper-class":"am-cap__datepicker-popper","prefix-icon":Ge({components:{IconComponent:We},template:"<IconComponent icon='calendar'/>"}),format:a(jt)(),placeholder:a(s).select_date,lang:a(l)},null,8,["modelValue","prefix-icon","format","placeholder","lang"])]),_:1})]),_:2},1032,["rules","model"])):N("",!0),a(b)?(c(),C("div",zf)):N("",!0)]),d("div",{class:B(["am-caesd__item-inner",{"am-editable":a(o).index===R}])},[I(pr,{title:a(s).special_days,enabled:!0,index:R,type:"specialDayList","apply-to-all-days-visible":!1,"header-visible":a(o).index===R,"edit-visible":a(o).index===R,"footer-visible":a(o).index===R,error:a(o).index===R?a(b):"","responsive-class":a(t).responsiveClass,onAddPeriod:k[1]||(k[1]=()=>{we(b)?b.value="":b=""})},null,8,["title","index","header-visible","edit-visible","footer-visible","error","responsive-class"])],2)]),a(o).index===R?(c(),C("div",jf,[I(Te,{category:"secondary",type:"plain",size:"small",onClick:Y=>P(R)},{default:L(()=>[re(x(a(s).cancel),1)]),_:2},1032,["onClick"]),I(Te,{size:"small",onClick:Y=>D(R)},{default:L(()=>[re(x(a(s).save),1)]),_:2},1032,["onClick"])])):N("",!0)]))),128)),a(i).length===0?(c(),U(Aa,{key:0,heading:a(s).no_special_days_yet},null,8,["heading"])):N("",!0),a(o).index===null?(c(),C("div",{key:1,class:B(a(i).length===0?"add-btn":"")},[I(Te,{size:"small",onClick:k[2]||(k[2]=$=>y())},{default:L(()=>[re(x(a(s).add_special_day),1)]),_:1})],2)):N("",!0)],4)}}});const Hf={key:0,class:"am-caedo__title_emp"},Zf={class:"am-caedo__heading-item am-w-50"},Gf={class:"am-caedo__heading-item am-w-30"},Jf={class:"am-caedo__heading-item am-w-20"},Xf={class:"am-caedo__content-item"},Qf={key:0,class:"am-caedo__wrapper"},Kf={class:"am-caedo__footer"},eh={key:4,class:"am-caedo__title_global"},th={class:"am-caedo__heading-item am-w-50"},ah={class:"am-caedo__heading-item am-w-30"},sh={class:"am-caedo__heading-item am-w-20"},lh={class:"am-caedo__content-item"},nh={name:"DaysOff"},ih=Object.assign(nh,{props:{responsiveClass:{type:String,default:""}},setup(n){const t=n;let e=De(),s=V("amLabels"),l=V("localLanguage");const i=V("settings");let o=_(()=>e.getters["employee/getEmployee"].dayOffList),r=O([]),u=Qe({data:null,index:null}),m=O({range:_({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].range,set:k=>{e.getters["employee/getEmployee"].dayOffList[u.index].range=k}}),name:_({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].name,set:k=>{e.getters["employee/getEmployee"].dayOffList[u.index].name=k}}),repeat:_({get:()=>e.getters["employee/getEmployee"].dayOffList[u.index].repeat,set:k=>{e.getters["employee/getEmployee"].dayOffList[u.index].repeat=k}})}),h=O([]),v=_(()=>({range:[{required:!0,message:s.select_date_warning,trigger:["submit","change"]}],name:[{required:!0,message:s.days_off_name_warning,trigger:["submit","change"]}]}));function g(k){o.value.splice(k,1)}function b(k){u.index=k,u.data=JSON.parse(JSON.stringify(o.value[k]))}function D(k){h.value[k].validate(T=>{T&&(u.index=null,u.data=null)})}function P(k){Object.keys(u.data).length===0?o.value.pop():o.value[k]=u.data,u.index=null,u.data=null}function y(){o.value.push({id:null,name:"",repeat:!1,range:[]}),u.index=o.value.length-1,u.data={}}function w(k){let T=k.range[0]?ot(me(k.range[0]).format("YYYY-MM-DD")):"",E=k.range[1]?ot(me(k.range[1]).format("YYYY-MM-DD")):"";return`${T} - ${E}`}function A(k,T){k?h.value[T]=k:h.value.splice(T,1)}Je(()=>{r.value=i.daysOff.map(k=>new Object({range:[k.startDate,k.endDate],name:k.name,repeat:k.repeat}))});let S=V("amColors"),f=_(()=>({"--am-c-caedo-bgr":S.value.colorMainBgr,"--am-c-caedo-text":S.value.colorMainText,"--am-c-caedo-text-op80":W(S.value.colorMainText,.8),"--am-c-caedo-text-op03":W(S.value.colorMainText,.03)}));return(k,T)=>{const E=vt,$=et;return c(),C("div",{class:"am-caedo",style:ke(a(f))},[a(r).length?(c(),C("span",Hf,x(a(s).employee_days_off),1)):N("",!0),a(o).length||a(r).length?(c(),C("div",{key:1,class:B(["am-caedo__heading",a(t).responsiveClass])},[d("div",Zf,x(a(s).date),1),d("div",Gf,x(a(s).name),1),d("div",Jf,x(a(s).days_off_repeat_yearly),1)],2)):N("",!0),(c(!0),C(ae,null,pe(a(o),(R,Y)=>(c(),C("div",{key:Y,class:"am-caedo__content"},[d("div",Xf,[d("div",{class:B(["am-caedo__content-item__inner am-w-50",a(t).responsiveClass])},[d("div",{class:B(["am-caedo__content-item__label",a(t).responsiveClass])},x(a(s).date),3),re(" "+x(w(R)),1)],2),d("div",{class:B(["am-caedo__content-item__inner am-w-30",a(t).responsiveClass])},[d("div",{class:B(["am-caedo__content-item__label",a(t).responsiveClass])},x(a(s).name),3),re(" "+x(R.name),1)],2),d("div",{class:B(["am-caedo__content-item__inner am-w-20",a(t).responsiveClass])},[d("div",{class:B(["am-caedo__content-item__label",a(t).responsiveClass])},x(a(s).days_off_repeat_yearly),3),re(" "+x(R.repeat?a(s).yes:a(s).no),1)],2),a(u).index===null?(c(),U(ha,{key:0,index:Y,onRemove:M=>g(Y),onEdit:M=>b(Y)},null,8,["index","onRemove","onEdit"])):N("",!0)]),a(u).index===Y?(c(),C("div",Qf,[I($,{ref_for:!0,ref:M=>A(M,Y),class:"am-caedo__form",rules:a(v),model:a(m),"label-position":"top"},{default:L(()=>[I(E,{label:`${a(s).date}:`,prop:"range"},{default:L(()=>[I(Yt,{modelValue:a(m).range,"onUpdate:modelValue":T[0]||(T[0]=M=>a(m).range=M),type:"daterange","popper-class":"am-cap__datepicker-popper",format:a(jt)(),placeholder:a(s).select_date,lang:a(l)},null,8,["modelValue","format","placeholder","lang"])]),_:1},8,["label"]),I(E,{label:`${a(s).name}:`,prop:"name"},{default:L(()=>[I(mt,{modelValue:a(m).name,"onUpdate:modelValue":T[1]||(T[1]=M=>a(m).name=M)},null,8,["modelValue"])]),_:1},8,["label"]),I(E,{prop:"repeat"},{default:L(()=>[I(dt,{modelValue:a(m).repeat,"onUpdate:modelValue":T[2]||(T[2]=M=>a(m).repeat=M),label:a(s).days_off_repeat_yearly},null,8,["modelValue","label"])]),_:1})]),_:2},1032,["rules","model"]),d("div",Kf,[I(Te,{category:"secondary",size:"small",type:"plain",onClick:M=>P(Y)},{default:L(()=>[re(x(a(s).cancel),1)]),_:2},1032,["onClick"]),I(Te,{size:"small",onClick:M=>D(Y)},{default:L(()=>[re(x(a(s).save),1)]),_:2},1032,["onClick"])])])):N("",!0)]))),128)),a(o).length===0&&a(r).length===0?(c(),U(Aa,{key:2,heading:a(s).no_days_off_yet},null,8,["heading"])):N("",!0),a(u).index===null?(c(),C("div",{key:3,class:B(a(o).length===0&&a(r).length===0?"add-btn":"")},[I(Te,{size:"small",onClick:T[3]||(T[3]=R=>y())},{default:L(()=>[re(x(a(s).add_day_off),1)]),_:1})],2)):N("",!0),a(r).length?(c(),C("span",eh,x(a(s).company_days_off),1)):N("",!0),a(r).length?(c(),C("div",{key:5,class:B(["am-caedo__heading",a(t).responsiveClass])},[d("div",th,x(a(s).date),1),d("div",ah,x(a(s).name),1),d("div",sh,x(a(s).days_off_repeat_yearly),1)],2)):N("",!0),(c(!0),C(ae,null,pe(a(r),(R,Y)=>(c(),C("div",{key:Y,class:"am-caedo__content"},[d("div",lh,[d("div",{class:B(["am-caedo__content-item__inner am-w-50",a(t).responsiveClass])},[d("div",{class:B(["am-caedo__content-item__label",a(t).responsiveClass])},x(a(s).date),3),re(" "+x(w(R)),1)],2),d("div",{class:B(["am-caedo__content-item__inner am-w-30",a(t).responsiveClass])},[d("div",{class:B(["am-caedo__content-item__label",a(t).responsiveClass])},x(a(s).name),3),re(" "+x(R.name),1)],2),d("div",{class:B(["am-caedo__content-item__inner am-w-20",a(t).responsiveClass])},[d("div",{class:B(["am-caedo__content-item__label",a(t).responsiveClass])},x(a(s).days_off_repeat_yearly),3),re(" "+x(R.repeat?a(s).yes:a(s).no),1)],2)])]))),128))],4)}}});const oh={class:"am-cc__edit"},rh={class:"am-cc__edit-text"},ch={class:"am-cc__edit-text"},uh={class:"am-cc__edit"},dh={class:"am-cc__edit-text"},mh={class:"am-cc__edit-text"},ph={class:"am-cc__edit"},gh={class:"am-cc__edit-text"},fh={class:"am-cc__edit-text"},hh={name:"StripeConnect"},_h=Object.assign(hh,{setup(n){let t=De(),e=V("amLabels"),s=_(()=>t.getters["auth/getStripeProvider"]),l=O(!1);function i(b){b.stopPropagation(),l.value=!l.value}function o(b){fu(t,b),m()}function r(){_u(t),m()}function u(){hu(t),m()}function m(){l.value=!1}let h=V("amFonts"),v=V("amColors"),g=_(()=>({"--am-c-cc-error":v.value.colorError,"--am-c-cc-error-op15":W(v.value.colorError,.15),"--am-c-cc-bgr":v.value.colorMainBgr,"--am-c-cc-text":v.value.colorMainText,"--am-c-cc-text-op10":W(v.value.colorMainText,.1),"--am-c-cc-text-op15":W(v.value.colorMainText,.15),"--am-font-family":h.value.fontFamily}));return(b,D)=>{const P=Gs;return a(s)&&a(s).id&&a(s).completed?(c(),U(P,{key:0,ref:"stripeConnectRef",visible:a(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(g),trigger:"click"},{reference:L(()=>[I(Te,{onClick:i},{default:L(()=>[re(x(a(e).stripe_connect)+" "+x("("+(a(s).email?a(s).email:a(s).id)+")"),1)]),_:1})]),default:L(()=>[zt((c(),C("div",oh,[d("div",{class:"am-cc__edit-item",onClick:D[0]||(D[0]=y=>r())},[d("span",rh,x(a(e).stripe_preview),1)]),d("div",{class:"am-cc__edit-item",onClick:D[1]||(D[1]=y=>u())},[d("span",ch,x(a(e).disconnect),1)])])),[[a(ia),m]])]),_:1},8,["visible","popper-style"])):a(s)&&a(s).id&&!a(s).completed?(c(),U(P,{key:1,ref:"stripeConnectRef",visible:a(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(g),trigger:"click"},{reference:L(()=>[I(Te,{onClick:i},{default:L(()=>[re(x(a(e).stripe_connect)+" "+x("("+(a(s).email?a(s).email:a(s).id)+")"),1)]),_:1})]),default:L(()=>[zt((c(),C("div",uh,[d("div",{class:"am-cc__edit-item",onClick:D[2]||(D[2]=y=>o(a(s).type))},[d("span",dh,x(a(e).stripe_onboard),1)]),d("div",{class:"am-cc__edit-item",onClick:D[3]||(D[3]=y=>u())},[d("span",mh,x(a(e).disconnect),1)])])),[[a(ia),m]])]),_:1},8,["visible","popper-style"])):(c(),U(P,{key:2,ref:"stripeConnectRef",visible:a(l),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(g),trigger:"click"},{reference:L(()=>[I(Te,{onClick:i},{default:L(()=>[re(x(a(e).stripe_connect),1)]),_:1})]),default:L(()=>[zt((c(),C("div",ph,[d("div",{class:"am-cc__edit-item",onClick:D[4]||(D[4]=y=>o("standard"))},[d("span",gh,x(a(e).stripe_account_standard),1)]),d("div",{class:"am-cc__edit-item",onClick:D[5]||(D[5]=y=>o("express"))},[d("span",fh,x(a(e).stripe_account_express),1)])])),[[a(ia),m]])]),_:1},8,["visible","popper-style"]))}}});const vh=["innerHTML"],yh={key:2,class:"am-caedo__apple"},bh={class:"am-caedo__apple__connect"},kh={props:{responsiveClass:{type:String,default:""}},setup(n){const t=n;let e=O(""),s=O("error"),l=O(!1);function i(){l.value=!1,e.value=""}const o=De(),r=V("baseUrls"),u=V("settings");let m=V("amLabels"),h=_(()=>o.getters["auth/getGoogleLoading"]||o.getters["auth/getOutlookLoading"]||o.getters["auth/getAppleLoading"]||o.getters["auth/getStripeLoading"]||o.getters["auth/getZoomLoading"]),v=_(()=>{let E=o.getters["auth/getZoomUsers"];return E.length?E.map($=>({value:$.id,label:`${$.first_name} ${$.last_name} (${$.email})`})):[]}),g=_(()=>{let E=o.getters["auth/getGoogleCalendars"];return E.length?E.map($=>({value:$.calendarId,label:$.summary})):[]}),b=_(()=>{let E=o.getters["auth/getOutlookCalendars"];return E.length?E.map($=>({value:$.id,label:$.name})):[]}),D=_(()=>{let E=o.getters["auth/getAppleCalendars"];return E.length?E.map($=>({value:$.id,label:$.name})):[]}),P=O(null),y=O({iCloudId:_({get:()=>o.getters["employee/getEmployeeAppleCalendarICloudId"],set:E=>{o.commit("employee/setEmployeeAppleCalendarICloudId",E||"")}}),appSpecificPassword:_({get:()=>o.getters["employee/getEmployeeAppleCalendarAppSpecificPassword"],set:E=>{o.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",E||null)}})}),w=_(()=>o.getters["employee/getGoogleToken"]?m.google_sign_out:m.google_sign_in),A=_(()=>o.getters["employee/getOutlookToken"]?m.outlook_sign_out:m.outlook_sign_in),S=O({googleId:_({get:()=>o.getters["employee/getGoogleCalendarId"],set:E=>{o.commit("employee/setGoogleCalendarId",E||"")}}),googleBtn:"",outlookId:_({get:()=>o.getters["employee/getOutlookCalendarId"],set:E=>{o.commit("employee/setOutlookCalendarId",E||"")}}),outlookBtn:"",zoomUserId:_({get:()=>o.getters["employee/getZoomUserId"],set:E=>{o.commit("employee/setZoomUserId",E||"")}}),appleId:_({get:()=>o.getters["employee/getAppleCalendarId"],set:E=>{o.commit("employee/setAppleCalendarId",E||"")}})}),f=O({googleId:{template:Ye.select,props:{itemName:"googleId",label:m.google_calendar,placeholder:"",class:_(()=>`am-caepif__item ${t.responsiveClass}`),disabled:_(()=>!o.getters["employee/getGoogleToken"]),clearable:!1,options:g.value,loading:_(()=>o.getters["auth/getGoogleLoading"]),loadingIcon:"loading"}},googleBtn:{template:Ge(Te),props:{class:_(()=>`am-caepif__item am-google-calendar-button ${t.responsiveClass}`),category:_(()=>"primary")},slots:{default:_(()=>`<img src="${r.wpAmeliaPluginURL}/v3/src/assets/img/cabinet/google-button.svg" alt="Google" />${w.value}`)},handlers:{click:()=>{o.getters["employee/getGoogleToken"]?cu(o):ru(o)}}},outlookId:{template:Ye.select,props:{itemName:"outlookId",label:m.outlook_calendar,placeholder:"",class:_(()=>`am-caepif__item ${t.responsiveClass}`),disabled:_(()=>!o.getters["employee/getOutlookToken"]),clearable:!1,options:b.value,loading:_(()=>o.getters["auth/getOutlookLoading"]),loadingIcon:"loading"}},outlookBtn:{template:Ge(Te),props:{class:_(()=>`am-caepif__item am-outlook-button ${t.responsiveClass}`),category:_(()=>"primary")},slots:{default:_(()=>`<div class="am-outlook-img"><img src="${r.wpAmeliaPluginURL}/v3/src/assets/img/cabinet/outlook-calendar.png" alt="Outlook"/></div>${A.value}`)},handlers:{click:()=>{o.getters["employee/getOutlookToken"]?mu(o):du(o)}}},zoomUserId:{template:Ye.select,props:{itemName:"zoomUserId",label:m.zoom_user,placeholder:m.zoom_user_placeholder,class:_(()=>`am-caepif__item ${t.responsiveClass}`),options:v.value}},appleId:{template:Ye.select,props:{itemName:"appleId",label:m.apple_calendar,placeholder:m.apple_calendar_placeholder,class:_(()=>`am-caepif__item ${t.responsiveClass}`),disabled:!1,clearable:_(()=>!ka.value),options:_(()=>D.value),loading:_(()=>o.getters["auth/getAppleLoading"]),loadingText:"Loading..."}}});Je(()=>{u.appleCalendar&&P.value&&(P.value.contentVisibility=ka.value)}),Hs(()=>{u.zoom.enabled||delete f.value.zoomUserId,u.googleCalendar.enabled||(delete f.value.googleId,delete f.value.googleBtn),u.outlookCalendar.enabled||(delete f.value.outlookId,delete f.value.outlookBtn),u.appleCalendar||delete f.value.appleId});function k(E){const $={iCloudId:E.getters["employee/getEmployeeAppleCalendarICloudId"],appSpecificPassword:E.getters["employee/getEmployeeAppleCalendarAppSpecificPassword"]};Pe.post("/apple/connect/"+E.getters["employee/getId"],{employeeAppleCalendar:$}).then(()=>{E.commit("employee/setEmployeeAppleCalendarICloudId",$.iCloudId),E.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",$.appSpecificPassword),Gn(E)}).catch(R=>{l.value=!0,e.value=R.response.data.message,s.value="error"}).finally(()=>{l.value=!0})}function T(E){E.commit("auth/setAppleLoading",!0),Pe.post("/apple/disconnect-employee/"+E.getters["employee/getId"]).then(()=>{E.commit("employee/setEmployeeAppleCalendarICloudId",null),E.commit("employee/setEmployeeAppleCalendarAppSpecificPassword",null),ka.value=!1,Gn(E),D.value=E.getters["auth/getAppleCalendars"]}).catch($=>{console.log($)}).finally(()=>{E.commit("auth/setAppleLoading",!1)})}return(E,$)=>{const R=vt,Y=et;return a(h)?(c(),U(Wt,{key:1})):(c(),U(Y,{key:0,ref:"employeeFormRef",model:a(S),"label-position":"top",class:B(["am-caedo",t.responsiveClass])},{default:L(()=>[a(u).payments.stripe.enabled&&a(u).payments.stripe.connect.enabled?(c(),U(_h,{key:0})):N("",!0),d("div",{class:B(["am-caepif__block",t.responsiveClass])},[(c(!0),C(ae,null,pe(a(f),(M,K)=>(c(),U(pt(M.template),St({key:K,ref_for:!0,ref:"customerCollectorRef",modelValue:a(S)[K],"onUpdate:modelValue":ce=>a(S)[K]=ce},M.props,pi(M.handlers?M.handlers:{})),{default:L(()=>[M.slots&&M.slots.default?(c(),C("div",{key:0,innerHTML:M.slots.default},null,8,vh)):N("",!0)]),_:2},1040,["modelValue","onUpdate:modelValue"]))),128))],2),a(l)?(c(),U(xt,{key:1,type:"error","show-border":!0,"close-after":5e3,onClose:i,onTriggerClose:i},{default:L(()=>[re(x(a(e)),1)]),_:1})):N("",!0),a(u).appleCalendar?(c(),C("div",yh,[I(So,null,{default:L(()=>[I(Eo,{ref_key:"appleVisibility",ref:P,side:!0,delay:500},{heading:L(()=>[re(x(a(m).apple_calendar_personal),1)]),default:L(()=>[d("div",bh,[I(R,{label:a(m).apple_icloud_id,class:"am-caedo__apple__connect__item"},{default:L(()=>[I(mt,{modelValue:a(y).iCloudId,"onUpdate:modelValue":$[0]||($[0]=M=>a(y).iCloudId=M),disabled:a(ka),placeholder:a(m).apple_icloud_id},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),I(R,{label:a(m).apple_app_specific_password,class:"am-caedo__apple__connect__item"},{default:L(()=>[I(mt,{modelValue:a(y).appSpecificPassword,"onUpdate:modelValue":$[1]||($[1]=M=>a(y).appSpecificPassword=M),type:"password","show-password":!0,disabled:a(ka),placeholder:a(m).apple_app_specific_password},null,8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),I(Te,{onClick:$[2]||($[2]=M=>a(ka)?T(a(o)):k(a(o)))},{default:L(()=>[re(x(a(ka)?a(m).apple_disconnect:a(m).apple_connect),1)]),_:1})])]),_:1},512)]),_:1})])):N("",!0)]),_:1},8,["model","class"]))}}};const Ch={props:{tabActive:{type:String,required:!0},passwordActive:{type:Boolean,default:!1}},emits:["changePassword","savePassword","saveChanges"],setup(n,{emit:t}){const e=n;let s=V("amLabels");function l(){e.tabActive==="password"?t("savePassword"):t("saveChanges")}let i=V("amColors"),o=_(()=>({"--am-c-caepf-text-op15":W(i.value.colorMainText,.15)}));return(r,u)=>(c(),C("div",{class:B(["am-caepf",{"am-single-btn":e.tabActive!=="details"||e.passwordActive}]),style:ke(a(o))},[e.tabActive==="details"&&!e.passwordActive?(c(),U(Te,{key:0,size:"medium",category:"secondary",type:"plain",onClick:u[0]||(u[0]=m=>t("changePassword"))},{default:L(()=>[re(x(a(s).change_password),1)]),_:1})):N("",!0),I(Te,{size:"medium",onClick:l},{default:L(()=>[re(x(e.tabActive!=="password"?a(s).save:a(s).change_password),1)]),_:1})],6))}},xh={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:t}){const e=n,s=De();let l=V("amLabels"),i=O(null),o=O({newPass:_({get:()=>s.getters["auth/getNewPassword"],set:m=>{s.commit("auth/setNewPassword",m||"")}}),confirmPass:_({get:()=>s.getters["auth/getConfirmPassword"],set:m=>{s.commit("auth/setConfirmPassword",m||"")}})}),r=O({newPass:{template:Ye.text,props:{itemName:"newPass",itemType:"password",showPassword:!0,label:l.new_password_colon,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${e.responsiveClass}`)}},confirmPass:{template:Ye.text,props:{itemName:"confirmPass",itemType:"password",showPassword:!0,label:l.new_password_colon_retype,placeholder:"",minLength:3,class:_(()=>`am-capp__item ${e.responsiveClass}`)}}}),u=O({newPass:[{required:!0,message:l.new_password_required,trigger:"submit"},{min:4,message:l.new_password_length,trigger:"submit"}],confirmPass:[{required:!0,message:l.new_password_required,trigger:"submit"},{min:4,message:l.new_password_length,trigger:"submit"},{validator:()=>s.getters["auth/getNewPassword"]===s.getters["auth/getConfirmPassword"],message:l.passwords_not_match,trigger:"submit"}]});return t({passFormRef:i}),(m,h)=>{const v=et;return c(),U(v,{ref_key:"passFormRef",ref:i,model:a(o),rules:a(u),"label-position":"top",class:B(["am-capi__form",n.responsiveClass])},{default:L(()=>[(c(!0),C(ae,null,pe(a(r),(g,b)=>(c(),U(pt(g.template),St({key:g.props.itemName,ref_for:!0,ref:"customerPassCollectorRef",modelValue:a(o)[b],"onUpdate:modelValue":D=>a(o)[b]=D},g.props),null,16,["modelValue","onUpdate:modelValue"]))),128))]),_:1},8,["model","rules","class"])}}};const wh=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),Th={name:"CabinetEmployeeProfile"},Lh=Object.assign(Th,{setup(n){let t=De();const e=V("settings");let s=V("amLabels"),l=O(null);const{width:i}=ja(l);let o=_(()=>st(i.value));Re("pageWidth",i);let r=_(()=>t.getters["entities/getReady"]);const u=O("details");let m=O(""),h=O("success"),v=O(!1);function g(){v.value=!1}function b(){v.value=!1,m.value=""}let D=O(null),P=_(()=>t.getters["employee/getEmployee"]),y=_(()=>t.getters["auth/getGoogleLoading"]||t.getters["auth/getOutlookLoading"]||t.getters["auth/getAppleLoading"]||t.getters["auth/getStripeLoading"]||t.getters["auth/getZoomLoading"]),w=O(!1),A=V("timeZone");function S(){D.value.employeeFormRef.validate(Y=>{!Y||(w.value=!0,Pe.post("/users/providers/"+P.value.id,jr(t,A.value),Object.assign(ze(t),{params:{source:"cabinet-provider"}})).then(()=>{m.value=s.profile_data_success,h.value="success"}).catch(M=>{m.value=M.response.data.message,h.value="error"}).finally(()=>{v.value=!0,w.value=!1}))})}let f=O(null),k=O(!1);function T(){k.value=!0,u.value="password"}function E(){f.value.passFormRef.validate(Y=>{if(Y){let M=t.getters["auth/getProfile"];w.value=!0,Pe.post("/users/providers/"+M.id,{password:t.getters["auth/getNewPassword"]},ze(t)).then(()=>{m.value=s.password_success,k.value=!1,u.value="details",t.commit("auth/setNewPassword",""),t.commit("auth/setConfirmPassword","")}).catch(()=>{v.value=!0}).finally(()=>{w.value=!1})}})}let $=V("amColors"),R=_(()=>({"--am-c-caep-primary":$.value.colorPrimary,"--am-c-caep-text":$.value.colorMainText,"--am-c-caep-text-op10":W($.value.colorMainText,.1)}));return(Y,M)=>{const K=Ia,ce=$a;return c(),C("div",{ref_key:"pageContainer",ref:l,class:"am-caep",style:ke(a(R))},[a(r)&&!a(w)&&!a(y)?(c(),C("div",{key:0,class:B(["am-caep__inner",a(o)])},[a(v)?(c(),U(xt,{key:0,type:a(h),"show-border":!0,"close-after":5e3,"custom-class":"am-capi__alert",onClose:b,onTriggerClose:b},{title:L(()=>[wh,re(" "+x(a(m)),1)]),_:1},8,["type"])):N("",!0),I(ce,{modelValue:u.value,"onUpdate:modelValue":M[0]||(M[0]=j=>u.value=j)},{default:L(()=>[I(K,{label:a(s).details,name:"details",onClick:g},{default:L(()=>[I(cg,{ref_key:"detailsRef",ref:D,"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"]),a(e).roles.allowConfigureServices?(c(),U(K,{key:0,label:a(s).heading_services,name:"services"},{default:L(()=>[I(wg,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(e).roles.allowConfigureSchedule?(c(),U(K,{key:1,label:a(s).working_hours,name:"workingHours"},{default:L(()=>[I(af,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(e).roles.allowConfigureSpecialDays?(c(),U(K,{key:2,label:a(s).special_days,name:"specialDays"},{default:L(()=>[I(Wf,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(e).roles.allowConfigureDaysOff?(c(),U(K,{key:3,label:a(s).days_off,name:"daysOff"},{default:L(()=>[I(ih,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(k)?(c(),U(K,{key:4,label:a(s).password,name:"password"},{default:L(()=>[a(w)?(c(),U(Tl,{key:1,"item-direction":"column",count:2})):(c(),U(xh,{key:0,ref_key:"changePassRef",ref:f},null,512))]),_:1},8,["label"])):N("",!0),a(e).zoom.enabled||a(e).googleCalendar.enabled||a(e).outlookCalendar.enabled||a(e).appleCalendar||a(e).payments.stripe.enabled&&a(e).payments.stripe.connect.enabled?(c(),U(K,{key:5,label:a(s).integrations_settings,name:"integrations"},{default:L(()=>[I(kh,{"responsive-class":a(o)},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"]),I(Ch,{"tab-active":u.value,"password-active":a(k),onChangePassword:T,onSavePassword:E,onSaveChanges:S},null,8,["tab-active","password-active"])],2)):(c(),U(Wt,{key:1}))],4)}}});function gr(n,t){Pe.get("/users/customers",{params:Js(n)}).then(e=>{t(e.data.data.users)}).catch(()=>{t([])})}function Ws(n,t="",e={},s=()=>{}){n.commit("customerInfo/setLoading",!0),setTimeout(()=>{gr(Object.assign({search:t,page:1,limit:at.general.customersFilterLimit,skipCount:1},e),l=>{n.commit("customerInfo/setCustomers",l),n.commit("customerInfo/setLoading",!1),s()})},500)}function Pi(n){n.getters["customerInfo/getCustomers"].length||Ws(n)}const Eh={key:0,class:"am-capf__zone"},Sh={class:"am-capf__menu"},Ah=d("span",{class:"am-icon-filter"},null,-1),Ih={key:0},$h={key:0,class:"am-capf__list"},Dh={name:"CabinetFilters"},Ni=Object.assign(Dh,{props:{paramList:{type:[Object,Array],default:()=>[]},stepKey:{type:String,default:""},responsiveClass:{type:String,default:""},empty:{type:Boolean,default:!1}},emits:["changeFilters","addAppointment"],setup(n,{emit:t}){const e=n;let s=De(),l=_(()=>s.getters["entities/getReady"]),i=_(()=>s.getters.getLoading),o=O({customers:!1,events:!1}),r=_(()=>e.stepKey==="packages"?"packagesList":e.stepKey);const u=V("shortcodeData"),m=V("settings");let h=V("amCustomize");const v=V("labels"),g=V("localLanguage");let b=_(()=>m.general.usedLanguages.includes(g.value)),D=_(()=>{let se=Qe({...v});if(e.stepKey){let le=h.value[r.value].translations;le&&Object.keys(le).forEach(te=>{le[te][g.value]&&b.value?se[te]=le[te][g.value]:le[te].default&&(se[te]=le[te].default)})}return se});function P(se){return se==="customers"?"user":se==="services"?"service":se==="providers"?"employee":se==="locations"?"locations":se==="packages"?"shipment":se==="events"?"star-outline":""}function y(){t("changeFilters")}let w=V("containerWidth"),A={components:{IconComponent:We},template:'<IconComponent icon="filter"/>'},S=O(!1),f=O({dates:_({get:()=>s.getters["cabinetFilters/getDates"],set:se=>{Yr(se[0],se[1]),s.commit("cabinetFilters/setDates",se),t("changeFilters")}}),customers:_({get:()=>s.getters["cabinetFilters/getCustomers"],set:se=>{s.commit("cabinetFilters/setCustomers",se||[])}}),services:_({get:()=>s.getters["cabinetFilters/getServices"],set:se=>{s.commit("cabinetFilters/setServices",se)}}),providers:_({get:()=>s.getters["cabinetFilters/getProviders"],set:se=>{s.commit("cabinetFilters/setProviders",se)}}),locations:_({get:()=>s.getters["cabinetFilters/getLocations"],set:se=>{s.commit("cabinetFilters/setLocations",se)}}),packages:_({get:()=>s.getters["cabinetFilters/getPackages"],set:se=>{s.commit("cabinetFilters/setPackages",se)}}),events:_({get:()=>s.getters["cabinetFilters/getEvents"],set:se=>{s.commit("cabinetFilters/setEvents",se||[])}})}),k=_(()=>e.stepKey==="events"?s.getters["cabinetFilters/getEventFiltersOption"](u.value.cabinetType):e.stepKey==="packages"?s.getters["cabinetFilters/getPackageFilterOptions"]:s.getters["cabinetFilters/getAppointmentFilterOptions"](u.value.cabinetType)),T=_(()=>{let se=0;return Object.keys(k.value).forEach(le=>{h.value[r.value].options[`${le}Filter`].visibility&&(le==="customers"||le==="events"||k.value[le].length>0)&&se++}),se});function E(se,le){switch(se){case"customers":R(le);break;case"events":Y(le);break}}function $(){u.value.cabinetType==="employee"&&R("",s.getters["auth/getPreloadedCustomers"])}function R(se="",le=[]){if(o.value.customers=!0,le.length){s.dispatch("cabinetFilters/injectCustomerOptions",le),o.value.customers=!1;return}setTimeout(()=>{gr({search:se,page:1,limit:at.general.customersFilterLimit,skipCount:1},te=>{s.dispatch("cabinetFilters/injectCustomerOptions",te),s.getters["auth/getPreloadedCustomers"].length===0&&s.commit("auth/setPreloadedCustomers",te),o.value.customers=!1})},500)}function Y(se="",le=[]){if(o.value.events=!0,le.length){s.dispatch("cabinetFilters/injectEventsOptions",le),o.value.events=!1;return}setTimeout(()=>{rc({dates:[me().format("YYYY-MM-DD")],timeZone:s.getters["cabinet/getTimeZone"],group:!0,page:1,limit:m.general.itemsPerPageBackEnd,search:se},te=>{s.dispatch("cabinetFilters/injectEventsOptions",te),o.value.events=!1})},500)}let M=_(()=>h.value[r.value].options),K=_(()=>e.stepKey==="appointments"?u.value.cabinetType==="employee"?M.value.servicesFilter.visibility||M.value.customersFilter.visibility||M.value.locationsFilter.visibility:M.value.servicesFilter.visibility||M.value.providersFilter.visibility||M.value.locationsFilter.visibility:e.stepKey==="events"?u.value.cabinetType==="employee"?M.value.eventsFilter.visibility||M.value.customersFilter.visibility||M.value.locationsFilter.visibility:M.value.eventsFilter.visibility||M.value.providersFilter.visibility||M.value.locationsFilter.visibility:M.value.packagesFilter.visibility||M.value.servicesFilter.visibility||M.value.providersFilter.visibility||M.value.locationsFilter.visibility),ce=_(()=>e.stepKey==="appointments"?u.value.cabinetType==="employee"?!!(k.value.services.length||k.value.customers.length||k.value.locations.length):!!(k.value.services.length||k.value.providers.length||k.value.locations.length):e.stepKey==="events"?u.value.cabinetType==="employee"?!!(k.value.events.length||k.value.customers.length||k.value.locations.length):!!(k.value.events.length||k.value.providers.length||k.value.locations.length):!!(k.value.packages.length||k.value.services.length||k.value.providers.length||k.value.locations.length));Je(()=>{$()});let j=V("amColors"),ie=_(()=>({"--am-c-capf-heading-text":j.value.colorMainText,"--am-c-capf-text":j.value.colorInpText,"--am-c-capf-text-op10":W(j.value.colorInpText,.1),"--am-c-select-border":j.value.colorInpBorder,"--am-c-select-bgr":j.value.colorInpBgr}));return(se,le)=>!a(i)&&a(l)?(c(),C("div",{key:0,class:"am-capf",style:ke(a(ie))},[a(w)<=480&&a(M).timeZone.visibility&&a(e).stepKey!=="packages"?(c(),C("div",Eh,[I(Zn,{size:"small"})])):N("",!0),d("div",Sh,[a(w)<=480&&a(M).timeZone.visibility&&a(e).stepKey==="packages"?(c(),U(Zn,{key:0,size:"small"})):N("",!0),a(e).stepKey!=="packages"?(c(),U(Yt,{key:1,modelValue:a(f).dates,"onUpdate:modelValue":le[0]||(le[0]=te=>a(f).dates=te),type:"daterange",editable:!1,size:"small",clearable:!1,format:a(jt)(),style:ke(a(ie)),lang:a(g),class:B(["am-capf__menu-datepicker",a(e).responsiveClass]),"popper-class":"am-capf__menu-datepicker-popper","start-placeholder":a(D).start_date,"end-placeholder":a(D).end_date},null,8,["modelValue","format","style","lang","class","start-placeholder","end-placeholder"])):N("",!0),!a(e).empty&&a(K)&&a(ce)?(c(),U(Te,{key:2,icon:a(A),"icon-only":a(w)<=700,"custom-class":"am-capf__menu-btn",size:"small",category:"primary","aria-label":a(D).filters,type:a(M).filterBtn?a(M).filterBtn.buttonType:"filled",onClick:le[1]||(le[1]=te=>we(S)?S.value=!a(S):S=!a(S))},{default:L(()=>[Ah,a(w)>700?(c(),C("span",Ih,x(a(D).filters),1)):N("",!0)]),_:1},8,["icon","icon-only","aria-label","type"])):N("",!0)]),I(ga,{name:"am-slide-fade"},{default:L(()=>[a(S)&&!a(e).empty?(c(),C("div",$h,[(c(!0),C(ae,null,pe(Object.keys(a(k)),te=>(c(),C(ae,{key:te},[(a(k)[te].length>0||te==="customers"||te==="events")&&a(h)[a(r)].options[`${te}Filter`].visibility?(c(),C("span",{key:0,class:B(["am-capf__list-item",[{"am-selected":a(f)[te].length>0},`am-capf__list-item-${a(T)}`,a(e).responsiveClass]])},[I(Ze,{id:`am-select-${te}`,modelValue:a(f)[te],"onUpdate:modelValue":ne=>a(f)[te]=ne,multiple:te!=="customers"&&te!=="events",loading:te!=="customers"&&te!=="events"?!1:a(o)[te],remote:"",clearable:"",filterable:te==="customers"||te==="events",placeholder:a(D)[te+(te==="customers"?"":"_dropdown")],"prefix-icon":P(te),"collapse-tags":!0,size:"small","popper-class":"am-filter-select-popper","remote-method":ne=>{E(te,ne)},onChange:y,onClear:$},{default:L(()=>[(c(!0),C(ae,null,pe(a(k)[te],ne=>(c(),U(Ue,{key:ne.id,value:ne.id,label:ne.firstName?ne.firstName+" "+ne.lastName:ne.name},null,8,["value","label"]))),128))]),_:2},1032,["id","modelValue","onUpdate:modelValue","multiple","loading","filterable","placeholder","prefix-icon","remote-method"])],2)):N("",!0)],64))),128))])):N("",!0)]),_:1})],4)):N("",!0)}});function Ph(n,t){let e=n.getters["entities/getService"](t.serviceId),s=0,l=0;return t.bookings.forEach(i=>{if(["approved","pending"].includes(i.status)){let o=i.duration?i.duration:e.duration;o>s&&(s=o);let r=0;i.extras.forEach(u=>{r+=e.extras.find(h=>h.id===u.extraId).duration*u.quantity}),r>l&&(l=r)}}),s+l}function fr(n,t,e){for(let s in n)n[s].appointments.forEach(l=>{let i={};l.bookings.forEach(r=>{r.customerId in i||(i[r.customerId]=[]),i[r.customerId][r.id]=r.status});let o={};for(let r in i)for(let u in i[r])(!(r in o)||i[r][u]==="approved"||i[r][u]==="pending")&&(o[r]=u);l.bookings.forEach(r=>{r.customerId in o&&parseInt(r.id)!==parseInt(o[r.customerId])||(t===""&&(l.bookingStart=Ll(l.bookingStart),l.bookingEnd=Ll(l.bookingEnd)),e||(l.bookings=[r]))})});if(t===""){let s={};for(let l in n)n[l].appointments.forEach(i=>{let o=i.bookingStart.split(" ")[0];o in s?s[o].appointments.push(i):s[o]={appointments:[i],date:o}});return s}return n}function hr(n,t){let e=[];return n.forEach(s=>{if(["approved","pending"].includes(s.status)&&s.customFields){let l=JSON.parse(s.customFields);Object.keys(l).forEach(i=>{if(l[i]){let o=l[i].type==="file"?l[i]?.value?l[i].value:"":l[i].value;(Array.isArray(o)?o.length:o)&&e.push({label:l[i].label,value:o})}})}}),t==="customer"?e:[...new Set(e.filter(s=>s.value).map(s=>s.label))].map(s=>new Object({label:s}))}function Nh(n,t){let e={};return n.forEach(s=>{["approved","pending"].includes(s.status)&&s.extras.forEach(l=>{l.extraId in e||(e[l.extraId]={quantity:0,price:l.price,name:t.extras.find(i=>i.id===l.extraId).name}),e[l.extraId].quantity=e[l.extraId].quantity+l.quantity})}),e}const Oh={class:"am-cc__periods-date"},Mh={class:"am-cc__periods-time"},Fh={key:0,class:"am-cc__periods-link__list"},Vh=["href"],Bh=d("span",{class:"am-icon-link"},null,-1),Rh=["href"],qh=d("span",{class:"am-icon-link"},null,-1),Uh=["href"],zh=d("span",{class:"am-icon-link"},null,-1),jh=["href"],Yh=d("span",{class:"am-icon-link"},null,-1),Wh={name:"TemplatePeriods"},Hh=Object.assign(Wh,{props:{data:{type:[Array,Object,String]}},setup(n){const t=n,e=V("amLabels");let s=V("containerWidth"),l=_(()=>st(s.value));return(i,o)=>(c(),C("div",{class:B(["am-cc__periods",a(l)])},[(c(!0),C(ae,null,pe(a(t).data,(r,u)=>(c(),C("div",{key:u,class:"am-cc__periods-item"},[d("span",Oh,x(a(ot)(r.date)),1),d("span",Mh,x(`${a(qs)(r.startTime)} - ${a(qs)(r.endTime)}`),1),r.googleMeetLink||r.zoomLink||r.lessonSpaceLink||r.microsoftTeamsLink?(c(),C("div",Fh,[r.googleMeetLink?(c(),C("a",{key:0,class:"am-cc__periods-link",href:r.googleMeetLink,target:"_blank"},[Bh,re(" "+x(a(e).google_meet_link),1)],8,Vh)):N("",!0),r.microsoftTeamsLink?(c(),C("a",{key:1,class:"am-cc__periods-link",href:r.microsoftTeamsLink,target:"_blank"},[qh,re(" "+x(a(e).microsoft_teams_link),1)],8,Rh)):N("",!0),r.zoomLink?(c(),C("a",{key:2,class:"am-cc__periods-link",href:r.zoomLink,target:"_blank"},[zh,re(" "+x(a(e).zoom_link),1)],8,Uh)):N("",!0),r.lessonSpaceLink?(c(),C("a",{key:3,class:"am-cc__periods-link",href:r.lessonSpaceLink,target:"_blank"},[Yh,re(" "+x(a(e).lesson_space_link),1)],8,jh)):N("",!0)])):N("",!0)]))),128))],2))}});const Zh={class:"am-cc__extras-name"},Gh={key:0,class:"am-cc__extras-duration"},Jh={key:1,class:"am-cc__extras-price"},Xh={key:2,class:"am-cc__extras-quantity"},Qh={name:"TemplateExtras"},Kh=Object.assign(Qh,{props:{data:{type:[Array,Object,String]}},setup(n){const t=n,e=V("amLabels"),s=V("shortcodeData");let l=V("containerWidth"),i=_(()=>st(l.value));return(o,r)=>(c(),C("div",{class:B(["am-cc__extras",a(i)])},[(c(!0),C(ae,null,pe(a(t).data,(u,m)=>(c(),C("div",{key:m,class:"am-cc__extras-item"},[d("span",Zh,x(u.name),1),u.duration||u.price||u.quantity?(c(),C("div",{key:0,class:B(["am-cc__extras-item__inner",[{"am-flex-space":!u.price&&u.duration},{"am-flex-end":!u.duration}]])},[u.duration?(c(),C("span",Gh,x(a(Zs)(u.duration,a(e).h,a(e).min)),1)):N("",!0),a(s).cabinetType==="customer"&&u.price?(c(),C("span",Jh,x(a(tt)(u.price)),1)):N("",!0),u.quantity?(c(),C("span",Xh," x"+x(u.quantity),1)):N("",!0)],2)):N("",!0)]))),128))],2))}});const e_={class:"am-cc__tickets-item_inner"},t_={class:"am-cc__tickets-name"},a_={class:"am-cc__tickets-calc"},s_={key:0,class:"am-cc__tickets-price"},l_={name:"TemplateTickets"},n_=Object.assign(l_,{props:{data:{type:[Array,Object,String]}},setup(n){const t=n,e=V("amLabels"),s=V("shortcodeData");let l=V("containerWidth"),i=_(()=>st(l.value));return(o,r)=>(c(),C("div",{class:B(["am-cc__tickets",a(i)])},[(c(!0),C(ae,null,pe(a(t).data,(u,m)=>(c(),C("div",{key:m,class:"am-cc__tickets-item"},[d("div",e_,[d("span",t_,x(u.name),1),d("span",a_,x(`${u.persons} ${u.persons>1?a(e).event_tickets:a(e).event_ticket}${a(s).cabinetType==="customer"?" x "+a(tt)(u.price):""}`),1)]),a(s).cabinetType==="customer"?(c(),C("div",s_,x(a(tt)(u.persons*u.price)),1)):N("",!0)]))),128))],2))}});const i_=["innerHTML"],o_={key:0,class:"am-cc__cf-value"},r_={class:"am-cc__cf-value__inner"},c_={name:"TemplateCustomFields"},u_=Object.assign(c_,{props:{data:{type:[Array,Object,String]}},setup(n){const t=n;let e=V("containerWidth"),s=_(()=>st(e.value));function l(i){return i?Array.isArray(i)?i.length===0?"/":i.map(o=>typeof o=="object"&&o!==null&&!Array.isArray(o)?o.name||"/":o||"/").join(", "):i:"/"}return(i,o)=>(c(),C("div",{class:B(["am-cc__cf",a(s)])},[(c(!0),C(ae,null,pe(a(t).data,(r,u)=>(c(),C("div",{key:u,class:"am-cc__cf-item"},[d("span",{class:"am-cc__cf-name",innerHTML:r.label},null,8,i_),"value"in r?(c(),C("div",o_,[d("span",r_,x(l(r.value)),1)])):N("",!0)]))),128))],2))}});const d_={class:"am-cc__employee-heading"},m_={class:"am-cc__employee-heading__inner"},p_={class:"am-cc__employee-name"},g_=["innerHTML"],f_={key:1,class:"am-cc__employee-wrapper"},h_={class:"am-cc__employee-heading"},__={class:"am-cc__employee-heading__inner"},v_={class:"am-cc__employee-name"},y_=["innerHTML"],b_={name:"TemplateEmployee"},k_=Object.assign(b_,{props:{data:{type:[Object,Array]}},setup(n){const t=n;let e=_(()=>!Array.isArray(t.data)),s=V("containerWidth"),l=_(()=>st(s.value));function i(u){let m=u.firstName.charAt(0).toUpperCase(),h=u.lastName.charAt(0).toUpperCase();return`${m}${h}`}function o(u){return u.pictureThumbPath?{backgroundImage:`url(${u.pictureThumbPath})`}:{}}function r(u){return u&&u.includes("<!-- Content -->")?u.slice(16).length:u?u.length:!1}return(u,m)=>(c(),C("div",{class:B(["am-cc__employee",a(l)])},[a(e)?(c(),C(ae,{key:0},[d("div",d_,[d("span",{class:"am-cc__employee-img",style:ke(o(a(t).data))},[a(t).data.pictureThumbPath?N("",!0):(c(),C(ae,{key:0},[re(x(i(a(t).data)),1)],64))],4),d("div",m_,[d("span",p_,x(`${a(t).data.firstName} ${a(t).data.lastName}`),1),a(t).data.badge?(c(),C("span",{key:0,class:"am-cc__employee-badge",style:ke({background:a(t).data.badge.color})},x(a(t).data.badge.content),5)):N("",!0)])]),a(t).data.description?(c(),C("div",{key:0,class:B(["am-cc__employee-desc",{"ql-description":a(t).data.description.includes("<!-- Content -->")}]),innerHTML:a(t).data.description},null,10,g_)):N("",!0)],64)):(c(),C("div",f_,[(c(!0),C(ae,null,pe(a(t).data,h=>(c(),C(ae,{key:h.id},[d("div",h_,[d("span",{class:"am-cc__employee-img",style:ke(o(h))},[h.pictureThumbPath?N("",!0):(c(),C(ae,{key:0},[re(x(i(h)),1)],64))],4),d("div",__,[d("span",v_,x(`${h.firstName} ${h.lastName}`),1),h.badge?(c(),C("span",{key:0,class:"am-cc__employee-badge",style:ke({background:h.badge.color})},x(h.badge.content),5)):N("",!0)])]),r(h.description)?(c(),C("div",{key:0,class:B(["am-cc__employee-desc",{"ql-description":h.description.includes("<!-- Content -->")}]),innerHTML:h.description},null,10,y_)):N("",!0)],64))),128))]))],2))}});const C_={class:"am-cc__customers-item_inner"},x_={class:"am-cc__customers-name"},w_={class:"am-cc__customers-info"},T_={class:"am-cc__customers-info"},L_={name:"TemplateCustomers"},E_=Object.assign(L_,{props:{data:{type:[Array,Object,String]}},setup(n){const t=n;let e=V("containerWidth"),s=_(()=>st(e.value));return(l,i)=>(c(),C("div",{class:B(["am-cc__customers",a(s)])},[(c(!0),C(ae,null,pe(a(t).data,(o,r)=>(c(),C("div",{key:r,class:"am-cc__customers-item"},[d("div",C_,[d("span",x_,x(o.firstName)+" "+x(o.lastName),1),d("span",w_,x(o.email),1),d("span",T_,x(o.phone),1)])]))),128))],2))}});const S_={class:"am-cc__popover-inner"},A_={key:0,class:"am-cc__popover-heading"},I_={name:"CollapseCardPopoverTemplate"},ls=Object.assign(I_,{props:{headerText:{type:String,default:""},type:{type:String,required:!0},contentData:{type:[Array,Object,String],default:""}},setup(n){const t=n;let e=O({period:Ge(Hh),extras:Ge(Kh),ticket:Ge(n_),customField:Ge(u_),employee:Ge(k_),customers:Ge(E_)}),s=V("amFonts"),l=V("amColors"),i=_(()=>({"--am-c-cc-primary":l.value.colorPrimary,"--am-c-cc-primary-op70":W(l.value.colorPrimary,.7),"--am-c-cc-success":l.value.colorSuccess,"--am-c-cc-success-op15":W(l.value.colorSuccess,.15),"--am-c-cc-bgr":l.value.colorMainBgr,"--am-c-cc-text":l.value.colorMainText,"--am-c-cc-text-op10":W(l.value.colorMainText,.1),"--am-c-cc-text-op15":W(l.value.colorMainText,.15),"--am-c-cc-text-op70":W(l.value.colorMainText,.7),"--am-c-cc-text-op80":W(l.value.colorMainText,.8),"--am-c-cc-text-op90":W(l.value.colorMainText,.9),"--am-c-scroll-op30":W(l.value.colorPrimary,.3),"--am-c-scroll-op10":W(l.value.colorPrimary,.1),"--am-font-family":s.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(o,r)=>{const u=Gs;return c(),U(u,{"show-arrow":!1,persistent:!1,width:"auto","popper-class":"am-cc__popover","popper-style":a(i),trigger:"click"},{reference:L(()=>[Co(o.$slots,"default")]),default:L(()=>[d("div",S_,[a(t).headerText?(c(),C("div",A_,x(a(t).headerText),1)):N("",!0),(c(),U(pt(a(e)[a(t).type]),{class:"am-cc__popover-content",data:a(t).contentData},null,8,["data"]))])]),_:3},8,["popper-style"])}}});function $_(n){let t=ui(null,n.coupon,n.tax?n.tax[0]:null,n.price-n.price/100*n.discount,!1);return t.price-t.discount+t.tax}const ns=Qe(window.wpAmeliaLabels);function yo(n,t,e,s=null){e.type==="package"&&n.commit("cabinet/setPackageLoading",!0),e.type==="appointment"&&n.commit("cabinet/setAppointmentsLoading",!0),e.type==="event"&&n.commit("cabinet/setEventsLoading",!0),n.commit("cabinet/setPaymentLinkLoader",e.bookings?e.bookings[0].id:e.id);let l=JSON.parse(JSON.stringify(e)),i=JSON.parse(JSON.stringify(n.getters["auth/getProfile"]));i.birthday=null,l.customer=i,l.type!=="package"?(l[l.type]=e,l.booking=e.bookings[0],l.paymentId=e.bookings[0].payments[0].id):l=Object.assign(l,l.package),Pe.post("/payments/link",{data:l,paymentMethod:t}).then(o=>{!o.data.data.error&&o.data.data.paymentLink?window.location.href=o.data.data.paymentLink:n.commit("cabinet/setPaymentLinkError",{value:!0,type:e.type})}).catch(o=>{n.commit("cabinet/setPaymentLinkError",{value:!0,type:e.type})}).finally(()=>{n.commit("cabinet/setPaymentLinkLoader",null),e.type==="package"&&n.commit("cabinet/setPackageLoading",!1),e.type==="appointment"&&n.commit("cabinet/setAppointmentsLoading",!1),e.type==="event"&&n.commit("cabinet/setEventsLoading",!1)})}function ii(n,t){if(n.type!=="package"&&(!n.bookings||n.bookings.length===0))return!1;t=JSON.parse(t);let e=t&&"payments"in t&&t.payments&&"paymentLinks"in t.payments&&t.payments.paymentLinks?t.payments.paymentLinks:at.payments.paymentLinks,s=!1;switch(n.type){case"package":s=!n.end||me(n.end,"YYYY-MM-DD HH:mm").isAfter(me());break;case"appointment":s=me(n.bookingStart,"YYYY-MM-DD HH:mm:ss").isAfter(me())&&n.bookings[0].payments.length>0;break;case"event":s=me(n.periods[n.periods.length-1].periodEnd,"YYYY-MM-DD HH:mm:ss").isAfter(me())&&n.bookings[0].payments.length>0;break}return oi(at).length&&at&&e&&e.enabled&&s}function oi(n){typeof n=="string"&&(n=JSON.parse(n));let t=[];return n=n.payments,at.payments.wc.enabled?t.push({value:"wc",label:ns.wc}):at.payments.mollie.enabled&&(!("mollie"in n)||n.mollie.enabled)?t.push({value:"mollie",label:ns.on_line}):(at.payments.payPal.enabled&&(!("payPal"in n)||n.payPal.enabled)&&t.push({value:"payPal",label:ns.pay_pal}),at.payments.stripe.enabled&&(!("stripe"in n)||n.stripe.enabled)&&t.push({value:"stripe",label:ns.credit_card}),at.payments.razorpay.enabled&&(!("razorpay"in n)||n.razorpay.enabled)&&t.push({value:"razorpay",label:ns.razorpay}),at.payments.square.enabled&&(!("square"in n)||n.square.enabled)&&t.push({value:"square",label:ns.square})),t}function Cl(n,t){switch(t.type){case"appointment":{let e=gi(n,{price:t.bookings[0].price,persons:t.bookings[0].persons,aggregatedPrice:t.bookings[0].aggregatedPrice,extras:t.bookings[0].extras,serviceId:null,tax:t.bookings[0].tax,coupon:t.bookings[0].coupon},!1);return e.total-e.discount+e.tax>t.bookings[0].payments.filter(s=>s.status!=="refunded"&&s.status!=="pending").reduce((s,l)=>s+l.amount,0)}case"event":return Io(t)>t.bookings[0].payments.filter(e=>e.status!=="refunded"&&e.status!=="pending").reduce((e,s)=>e+s.amount,0);case"package":return $_(t)>t.payments.filter(e=>e.status!=="refunded"&&e.status!=="pending").reduce((e,s)=>e+s.amount,0)}}const D_={class:"am-cc__edit"},P_=["onClick"],N_={class:"am-cc__edit-text"},O_={name:"PaymentButton"},_r=Object.assign(O_,{props:{reservation:{type:Object,default:()=>{}},bookable:{type:Object,default:()=>{}},type:{type:String},btnSize:{type:String,default:"mini"},class:{type:String,default:""}},setup(n){const t=n;let e=De();const s=V("amLabels");let l=_(()=>oi(t.bookable.settings)),i=_(()=>e.getters["cabinet/getPaymentLinkLoader"]),o={components:{IconComponent:We},template:'<IconComponent icon="arrow-down"></IconComponent>'},r=O(!1);function u(P){P.stopPropagation(),l.value.length===1?yo(e,l.value[0].value,t.reservation):r.value=!r.value}function m(){r.value=!1}let h=O(!1);function v(){h.value=!1}let g=V("amFonts"),b=V("amColors"),D=_(()=>({"--am-c-cc-primary":b.value.colorPrimary,"--am-c-cc-primary-op70":W(b.value.colorPrimary,.7),"--am-c-cc-error":b.value.colorError,"--am-c-cc-error-op15":W(b.value.colorError,.15),"--am-c-cc-warning":b.value.colorWarning,"--am-c-cc-warning-op15":W(b.value.colorWarning,.15),"--am-c-cc-success":b.value.colorSuccess,"--am-c-cc-success-op15":W(b.value.colorSuccess,.15),"--am-c-cc-bgr":b.value.colorMainBgr,"--am-c-cc-text":b.value.colorMainText,"--am-c-cc-text-op10":W(b.value.colorMainText,.1),"--am-c-cc-text-op15":W(b.value.colorMainText,.15),"--am-c-cc-text-op70":W(b.value.colorMainText,.7),"--am-c-cc-text-op90":W(b.value.colorMainText,.9),"--am-font-family":g.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(P,y)=>{const w=Gs;return a(ii)(a(t).reservation,a(t).bookable.settings)?(c(),U(w,{key:0,ref:"payRef",visible:a(r),persistent:!1,"show-arrow":!1,"popper-class":"am-cc__popper","popper-style":a(D),trigger:"click"},{reference:L(()=>[I(Te,{size:a(t).btnSize,type:a(t).type,suffix:a(l).length>1&&a(Cl)(a(e),a(t).reservation)?a(o):"",class:B([{"am-button-single":a(l).length===1||!a(Cl)(a(e),a(t).reservation)},a(t).class]),loading:!!a(i),"loading-icon":"loading",disabled:!a(Cl)(a(e),a(t).reservation),onClick:u},{default:L(()=>[re(x(a(Cl)(a(e),a(t).reservation)?a(s).pay_now_btn:a(s).paid),1)]),_:1},8,["size","type","suffix","class","loading","disabled"])]),default:L(()=>[zt((c(),C("div",D_,[(c(!0),C(ae,null,pe(a(oi)(a(t).bookable.settings),A=>zt((c(),C("div",{key:A.value,class:"am-cc__edit-item",onClick:S=>a(yo)(a(e),A.value,a(t).reservation)},[d("span",N_,x(A.label),1)],8,P_)),[[a(ia),m]])),128))])),[[a(ia),v]])]),_:1},8,["visible","popper-style"])):N("",!0)}}});const M_={class:"am-cc__time"},F_={key:0,class:"am-cc__name"},V_={key:0,class:"am-cc__name"},B_={key:1,class:"am-cc__places"},R_={key:2,class:"am-cc__customer"},q_={key:0,class:"am-cc__edit"},U_=d("span",{class:"am-icon-edit"},null,-1),z_={class:"am-cc__edit-text"},j_={key:0,class:"am-cc__edit"},Y_=d("span",{class:"am-icon-users-plus"},null,-1),W_={class:"am-cc__edit-text"},H_={class:"am-cc__edit"},Z_=d("span",{class:"am-icon-user"},null,-1),G_={class:"am-cc__edit-text"},J_={class:"am-cc__edit"},X_=d("span",{class:"am-icon-date-time"},null,-1),Q_={class:"am-cc__edit-text"},K_=d("span",{class:"am-icon-clearable"},null,-1),ev={class:"am-cc__edit-text"},tv={class:"am-cc__content-inner"},av={class:"am-cc__data"},sv=d("span",{class:"am-icon-user"},null,-1),lv={class:"am-cc__data-text"},nv={class:"am-cc__data"},iv=d("span",{class:"am-icon-user"},null,-1),ov={class:"am-cc__data-text"},rv={key:2,class:"am-cc__data"},cv=d("span",{class:"am-icon-payments"},null,-1),uv={class:"am-cc__data-text"},dv={key:3,class:"am-cc__data"},mv=d("span",{class:"am-icon-clock"},null,-1),pv={class:"am-cc__data-text"},gv={class:"am-cc__data"},fv=d("span",{class:"am-icon-clock"},null,-1),hv={class:"am-cc__data-text"},_v={key:5,class:"am-cc__data link"},vv=d("span",{class:"am-icon-link"},null,-1),yv=["href"],bv={key:6,class:"am-cc__data link"},kv=d("span",{class:"am-icon-link"},null,-1),Cv=["href"],xv={key:7,class:"am-cc__data link"},wv=d("span",{class:"am-icon-link"},null,-1),Tv=["href"],Lv={key:8,class:"am-cc__data link"},Ev=d("span",{class:"am-icon-link"},null,-1),Sv=["href"],Av={class:"am-cc__data"},Iv=d("span",{class:"am-icon-border-plus"},null,-1),$v={class:"am-cc__data-text"},Dv={class:"am-cc__data"},Pv=d("span",{class:"am-icon-file-text"},null,-1),Nv={class:"am-cc__data-text"},Ov={class:"am-cc__data"},Mv=d("span",{class:"am-icon-tickets"},null,-1),Fv={class:"am-cc__data-text"},Vv=d("span",{class:"am-icon-locations"},null,-1),Bv=["href"],Rv={key:1,class:"am-cc__data-text"},qv={name:"CollapseCard"},vr=Object.assign(qv,{props:{start:{type:[String,Object,Array,Function],required:!0},name:{type:String,default:""},employee:{type:[Object,Array],default:()=>{}},customers:{type:[Array],default:()=>{}},location:{type:[String,Object],default:""},price:{type:Number,default:0},duration:{type:Number,default:0},periods:{type:Array,default:()=>{}},extras:{type:Object,default:()=>{}},tickets:{type:Object,default:()=>{}},customFields:{type:Array,default:()=>[]},googleMeetLink:{type:String,default:""},microsoftTeamsLink:{type:String,default:""},zoomLink:{type:String,default:""},lessonSpaceLink:{type:String,default:""},reservation:{type:Object,default:()=>{}},bookable:{type:Object,default:()=>{}},booking:{type:Object,default:()=>{}},isPackageBooking:{type:Boolean,default:!1},responsiveClass:{type:String,default:""},parentWidth:{type:Number,default:1200},customizedOptions:{type:Object,required:!0}},emits:["cancelBooking","rescheduling","editAppointment","editEvent","addEventAttendee","listEventAttendees"],setup(n,{emit:t}){const e=n,s=V("shortcodeData"),l=V("settings");let i=V("originKey");const o=V("amLabels");let r=O(!1);function u(k){k.stopPropagation(),r.value=!r.value}function m(){r.value=!1}function h(){t("cancelBooking",e.booking),r.value=!1}function v(k){t("edit"+k.charAt(0).toUpperCase()+k.slice(1),e.reservation),r.value=!1}function g(k){t("addEventAttendee",k),r.value=!1}function b(k){t("listEventAttendees",k),r.value=!1}function D(){t("rescheduling",e.reservation,e.booking),r.value=!1}function P(k){return Array.isArray(k)?o.value.event_staff:!Array.isArray(k)&&k.rank&&k.rank==="organizer"?o.value.event_organizer:`${e.employee.firstName} ${e.employee.lastName}`}let y=_(()=>e.reservation.type==="event"?e.reservation.maxCapacity-e.reservation.places+"/"+e.reservation.maxCapacity:""),w=_(()=>{if(e.reservation.type==="appointment")return{label:o.value[s.value.cabinetType==="employee"||e.booking.status==="approved"?e.reservation.status:e.booking.status],class:s.value.cabinetType==="employee"||e.booking.status==="approved"?e.reservation.status:e.booking.status};if(e.reservation.type==="event"){if(s.value.cabinetType==="customer")return{label:o.value[e.booking.status],class:e.booking.status};switch(e.reservation.status){case"rejected":case"canceled":return{label:o.value.canceled,class:"canceled"};case"full":return{label:o.value.full,class:"full"};case"waiting":return{label:o.value.waiting_list,class:"waiting"};case"upcoming":return{label:o.value.upcoming,class:"upcoming"};case"approved":if(e.reservation.closed)return{label:o.value.closed,class:"closed"};if(e.reservation.opened&&e.reservation.places>0)return{label:o.value.opened,class:"opened"}}}return{label:"",class:""}}),A=V("amFonts"),S=V("amColors"),f=_(()=>({"--am-c-cc-primary":S.value.colorPrimary,"--am-c-cc-primary-op15":W(S.value.colorPrimary,.15),"--am-c-cc-primary-op70":W(S.value.colorPrimary,.7),"--am-c-cc-error":S.value.colorError,"--am-c-cc-error-op15":W(S.value.colorError,.15),"--am-c-cc-warning":S.value.colorWarning,"--am-c-cc-warning-op15":W(S.value.colorWarning,.15),"--am-c-cc-success":S.value.colorSuccess,"--am-c-cc-success-op15":W(S.value.colorSuccess,.15),"--am-c-cc-bgr":S.value.colorMainBgr,"--am-c-cc-text":S.value.colorMainText,"--am-c-cc-text-op03":W(S.value.colorMainText,.03),"--am-c-cc-text-op10":W(S.value.colorMainText,.1),"--am-c-cc-text-op15":W(S.value.colorMainText,.15),"--am-c-cc-text-op70":W(S.value.colorMainText,.7),"--am-c-cc-text-op90":W(S.value.colorMainText,.9),"--am-font-family":A.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px"}));return(k,T)=>{const E=Gs;return c(),C("div",{class:"am-cc",style:ke(a(f))},[I(So,null,{default:L(()=>[I(Eo,{"heading-class":"am-cc__heading-wrapper",side:a(e).parentWidth>500},{heading:L(()=>[d("div",{class:B(["am-cc__heading",a(e).responsiveClass])},[d("div",{class:B(["am-cc__heading-info",a(e).responsiveClass])},[d("div",{class:B(["am-cc__heading-info__part",a(e).responsiveClass])},[d("div",M_,x(a(e).start),1),a(e).parentWidth>650?(c(),C("div",F_,x(a(e).name),1)):N("",!0),a(e).reservation.type==="event"&&a(s).cabinetType==="employee"&&a(e).parentWidth<=650?(c(),C("div",{key:1,class:B(["am-cc__places",a(e).responsiveClass])},x(a(y)),3)):N("",!0),a(e).reservation.type==="appointment"&&a(s).cabinetType==="employee"&&a(e).customers.length===1&&a(e).customizedOptions.customer.visibility&&a(e).parentWidth<=650?(c(),C("div",{key:2,class:B(["am-cc__customer",a(e).responsiveClass])},x(`${a(e).customers[0].firstName} ${a(e).customers[0].lastName}`),3)):N("",!0),(a(e).booking||a(s).cabinetType==="employee")&&a(e).parentWidth<=650?(c(),C("div",{key:3,class:B(["am-cc__status",`am-cc__status-${a(w).class}`])},x(a(w).label),3)):N("",!0)],2),d("div",{class:B(["am-cc__heading-info__part",a(e).responsiveClass])},[a(e).parentWidth<=650?(c(),C("div",V_,x(a(e).name),1)):N("",!0),a(e).reservation.type==="event"&&a(s).cabinetType==="employee"&&a(e).parentWidth>650?(c(),C("div",B_,x(a(y)),1)):N("",!0),a(e).reservation.type==="appointment"&&a(s).cabinetType==="employee"&&a(e).customers.length===1&&a(e).customizedOptions.customer.visibility&&a(e).parentWidth>650?(c(),C("div",R_,x(`${a(e).customers[0].firstName} ${a(e).customers[0].lastName}`),1)):N("",!0),(a(e).booking||a(s).cabinetType==="employee")&&a(e).parentWidth>650?(c(),C("div",{key:3,class:B(["am-cc__status",`am-cc__status-${a(w).class}`])},x(a(w).label),3)):N("",!0)],2)],2),a(s).cabinetType==="employee"?(c(),C("div",{key:0,class:B(["am-cc__heading-actions",a(e).responsiveClass])},[a(e).reservation.type!=="appointment"||a(l).roles.allowWriteAppointments?(c(),U(E,{key:0,ref:"editRef",visible:a(r),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(f),trigger:"click"},{reference:L(()=>[a(e).reservation?(c(),C("span",{key:0,class:"am-cc__edit-btn am-icon-dots-vertical",onClick:u})):N("",!0)]),default:L(()=>[a(e).reservation.type==="appointment"&&a(l).roles.allowWriteAppointments||a(e).reservation.type==="event"&&a(l).roles.allowWriteEvents?zt((c(),C("div",q_,[d("div",{class:"am-cc__edit-item am-edit",onClick:T[0]||(T[0]=$=>v(a(e).reservation.type))},[U_,d("span",z_,x(a(o).edit),1)])])),[[a(ia),m]]):N("",!0),a(e).reservation.type==="event"?(c(),C(ae,{key:1},[a(l).roles.allowWriteEvents?zt((c(),C("div",j_,[d("div",{class:"am-cc__edit-item am-edit",onClick:T[1]||(T[1]=$=>g(a(e).reservation))},[Y_,d("span",W_,x(a(o).event_add_attendee),1)])])),[[a(ia),m]]):N("",!0),zt((c(),C("div",H_,[d("div",{class:"am-cc__edit-item am-edit",onClick:T[2]||(T[2]=$=>b(a(e).reservation))},[Z_,d("span",G_,x(a(o).attendees),1)])])),[[a(ia),m]])],64)):N("",!0)]),_:1},8,["visible","popper-style"])):N("",!0)],2)):(a(e).booking&&a(e).booking.status==="approved"||a(e).booking.status==="pending"||a(e).booking.status==="waiting")&&(!a(e).isPackageBooking&&a(e).booking.price>0&&a(ii)(a(e).reservation,a(e).bookable.settings)||!!(a(e).reservation.cancelable||a(l).roles.allowCustomerReschedule&&a(e).reservation.reschedulable))?(c(),C("div",{key:1,class:B(["am-cc__heading-actions",a(e).responsiveClass])},[a(e).booking.status!=="waiting"&&!a(e).isPackageBooking&&a(e).booking.price>0&&a(ii)(a(e).reservation,a(e).bookable.settings)?(c(),U(_r,{key:0,reservation:a(e).reservation,bookable:a(e).bookable},null,8,["reservation","bookable"])):N("",!0),a(e).reservation.cancelable||a(l).roles.allowCustomerReschedule&&a(e).reservation.reschedulable?(c(),U(E,{key:1,ref:"editRef",visible:a(r),persistent:!1,"show-arrow":!1,width:"auto","popper-class":"am-cc__popper","popper-style":a(f),trigger:"click"},{reference:L(()=>[a(e).booking?(c(),C("span",{key:0,class:"am-cc__edit-btn am-icon-dots-vertical",onClick:u})):N("",!0)]),default:L(()=>[zt((c(),C("div",J_,[a(e).reservation.type==="appointment"&&a(l).roles.allowCustomerReschedule&&a(e).reservation.reschedulable?(c(),C("div",{key:0,class:"am-cc__edit-item",onClick:D},[X_,d("span",Q_,x(a(o).reschedule),1)])):N("",!0),a(e).reservation.cancelable?(c(),C("div",{key:1,class:"am-cc__edit-item am-delete",onClick:h},[K_,d("span",ev,x(a(o).cancel),1)])):N("",!0)])),[[a(ia),m]])]),_:1},8,["visible","popper-style"])):N("",!0)],2)):N("",!0)],2)]),default:L(()=>[d("div",{class:B(["am-cc__content",a(e).responsiveClass])},[d("div",tv,[a(i)==="capc"&&n.customizedOptions.employee.visibility?(c(),C(ae,{key:0},[(Array.isArray(a(e).employee)?a(e).employee.length:Object.keys(a(e).employee).length)?(c(),U(ls,{key:0,"header-text":Array.isArray(a(e).employee)?a(o).view_employees:a(o).provider_profile,type:"employee","content-data":a(e).employee},{default:L(()=>[d("div",av,[sv,d("span",lv,x(P(a(e).employee)),1)])]),_:1},8,["header-text","content-data"])):N("",!0)],64)):N("",!0),a(i)==="cape"&&a(e).reservation.type==="appointment"&&a(e).customers.length>1&&a(e).customizedOptions.customer.visibility?(c(),C(ae,{key:1},[a(e).customers.length?(c(),U(ls,{key:0,"header-text":a(o).customers,type:"customers","content-data":a(e).customers},{default:L(()=>[d("div",nv,[iv,d("span",ov,x(a(o).customers),1)])]),_:1},8,["header-text","content-data"])):N("",!0)],64)):N("",!0),a(e).price&&a(e).customizedOptions.price.visibility?(c(),C("div",rv,[cv,d("span",uv,x(a(tt)(a(e).price)),1)])):N("",!0),a(e).duration?(c(),C("div",dv,[mv,d("span",pv,x(a(Zs)(a(e).duration,a(o).h,a(o).min)),1)])):N("",!0),n.periods.length?(c(),U(ls,{key:4,"header-text":a(o).event_timetable,type:"period","content-data":a(e).periods},{default:L(()=>[d("div",gv,[fv,d("span",hv,x(a(o).event_timetable),1)])]),_:1},8,["header-text","content-data"])):N("",!0),a(e).googleMeetLink?(c(),C("div",_v,[vv,d("a",{class:"am-cc__data-text link",href:a(e).googleMeetLink,target:"_blank",tabindex:"-1"},x(a(o).google_meet_link),9,yv)])):N("",!0),a(e).microsoftTeamsLink?(c(),C("div",bv,[kv,d("a",{class:"am-cc__data-text link",href:a(e).microsoftTeamsLink,target:"_blank",tabindex:"-1"},x(a(o).microsoft_teams_link),9,Cv)])):N("",!0),a(e).zoomLink?(c(),C("div",xv,[wv,d("a",{class:"am-cc__data-text link",href:a(e).zoomLink,target:"_blank",tabindex:"-1"},x(a(o).zoom_link),9,Tv)])):N("",!0),a(e).lessonSpaceLink?(c(),C("div",Lv,[Ev,d("a",{class:"am-cc__data-text link",href:a(e).lessonSpaceLink,target:"_blank",tabindex:"-1"},x(a(o).lesson_space_link),9,Sv)])):N("",!0),Object.keys(a(e).extras).length?(c(),U(ls,{key:9,"header-text":`${Object.keys(a(e).extras).length} ${a(o).extras}`,type:"extras","content-data":a(e).extras},{default:L(()=>[d("div",Av,[Iv,d("span",$v,x(`${Object.keys(a(e).extras).length} ${a(o).extras}`),1)])]),_:1},8,["header-text","content-data"])):N("",!0),a(e).customFields.length?(c(),U(ls,{key:10,"header-text":a(o).custom_fields,type:"customField","content-data":a(e).customFields},{default:L(()=>[d("div",Dv,[Pv,d("span",Nv,x(a(o).custom_fields),1)])]),_:1},8,["header-text","content-data"])):N("",!0),Object.keys(a(e).tickets).length?(c(),U(ls,{key:11,"header-text":a(o).event_tickets,type:"ticket","content-data":a(e).tickets},{default:L(()=>[d("div",Ov,[Mv,d("span",Fv,x(a(o).event_tickets),1)])]),_:1},8,["header-text","content-data"])):N("",!0),a(e).location?(c(),C("div",{key:12,class:B(["am-cc__data",{link:a(e).location.address}])},[Vv,a(e).location.address?(c(),C("a",{key:0,class:"am-cc__data-text",href:`https://maps.google.com/?q=${a(e).location.address}`,target:"_blank",tabindex:"-1"},x(a(e).location.name),9,Bv)):(c(),C("span",Rv,x(a(e).location.name),1))],2)):N("",!0)])],2)]),_:1},8,["side"])]),_:1})],4)}}});const Uv={class:"am-csd__header"},zv={class:"am-csd__header-text"},jv=d("span",{class:"am-icon-clearable"},null,-1),Yv={class:"am-csd__footer"},Wv={name:"AppointmentBooking"},yr=Object.assign(Wv,{props:{visibility:{type:Boolean,default:!1},appointment:{type:Object,default:null},employees:{type:Array,default:()=>[]},locations:{type:Array,default:()=>[]},slotsParams:{type:Object,default:()=>{}},labels:{type:Object,required:!0},customizedOptions:{type:Object,required:!0}},emits:["close","success","error","employee-selection","location-selection"],setup(n,{emit:t}){const e=n;let s=De();const l=V("settings");let i=O("");function o(ee){i.value=ee.toLowerCase()}let r=_(()=>i.value?e.employees.filter(ee=>`${ee.firstName} ${ee.lastName}`.toLowerCase().includes(i.value)):e.employees),u=O("");function m(ee){u.value=ee.toLowerCase()}let h=_(()=>u.value?e.locations.filter(ee=>ee.name.toLowerCase().includes(u.value)):e.locations),v=V("amLabels"),g=O(null),b=O(null);it(()=>e.appointment,ee=>{setTimeout(()=>{K.value++},200);let he=JSON.parse(JSON.stringify(ee));he&&he.bookingStart&&(g.value=he.bookingStart.split(" ")[0],b.value=he.bookingStart.split(" ")[1].substring(0,5))});let D=O(null),P=O(0),y=V("sidebarCollapsed");window.addEventListener("resize",w);function w(){D.value&&(P.value=D.value.offsetWidth)}it(y,ee=>{ee?setTimeout(()=>{A()},1500):setTimeout(()=>{A()},500)});function A(){P.value=D.value.offsetWidth}Je(()=>{di(()=>{P.value=D.value.offsetWidth})});let S=_(()=>e.visibility);it(S,ee=>{ee&&setTimeout(()=>{P.value=D.value.offsetWidth},300)});let f=_(()=>st(P.value)),k=O(!1),T=O(null),E=O("");function $(){k.value=!1,E.value=""}let R=O(null),Y=_(()=>R.value?R.value.calendarSlotsLoading:!0),M=V("cabinetType"),K=O(0),ce=O(!1),j=O({employee:null,location:null}),ie=O(!0),se=O(!0),le=_(()=>e.appointment&&!e.appointment.id&&(e.employees.length||e.locations.length)&&(e.customizedOptions.employee.visibility||e.customizedOptions.location.visibility)&&(ie.value||se.value)),te=O(null),ne=_(()=>le.value?{employee:[{required:"employee"in e.customizedOptions?e.customizedOptions.employee.required:!1,message:v.value.please_select_employee,trigger:"submit"}],location:[{required:"location"in e.customizedOptions?e.customizedOptions.location.required:!1,message:v.value.please_select_location,trigger:"submit"}]}:{}),Z=_(()=>{let ee={};return j.value.employee?ee.providerIds=[j.value.employee]:"providerIds"in e.slotsParams&&e.slotsParams.providerIds.length&&(ee.providerIds=e.slotsParams.providerIds),j.value.location?ee.locationId=j.value.location:"locationId"in e.slotsParams&&e.slotsParams.locationId?ee.locationId=e.slotsParams.locationId:ee.locationId=null,Object.assign({},e.slotsParams,ee)});function ge(){te.value&&te.value.clearValidate(),ce.value=!0,K.value++,t("employee-selection",j.value.employee),t("location-selection",j.value.location)}function be(ee){j.value.employee=ee,ge()}function q(){le.value&&(j.value.employee=null,j.value.location=null,ie.value=!0,se.value=!0,ge()),t("close")}it(S,ee=>{ee&&e.employees.length===1&&(j.value.employee=e.employees[0].id,ie.value=!1),ee&&e.locations.length===1&&(j.value.location=e.locations[0].id,se.value=!1),ee&&(e.locations.length===1||e.employees.length===1)&&ge()});let Q=O();Re("formWrapper",Q);let G=_(()=>s.getters["entities/getService"](e.appointment.serviceId).duration);Re("calendarSlotDuration",G);let H=O(!0);Re("calendarChangeSideBar",H);let J=O(0);Re("calendarServiceDuration",J);function X(){"id"in e.appointment?ye():Se()}function ve(ee){let he=ee?"UTC":s.getters["cabinet/getTimeZone"],de=g.value+" "+b.value,Fe=null,xe=null;if(ee){let va=qi(de);xe=Ri(va),Fe=va}else Fe=de;return{utcOffset:xe,bookingStart:Fe,timeZone:he}}function ye(){R.value.calendarSlotsLoading=!0;let ee=ve(!1);Rs()===s.getters["cabinet/getTimeZone"]&&l.general.showClientTimeZone&&(ee.utcOffset=Ri(qi(g.value+" "+b.value))),Pe.post("/bookings/reassign/"+e.appointment.bookings.filter(he=>he.status==="approved"||he.status==="pending")[0].id,ee,Object.assign(ze(s),{params:{source:"cabinet-"+M.value}})).then(()=>{R.value.calendarSlotsLoading=!1,t("success",{message:v.value.appointment_rescheduled})}).catch(he=>{R.value.calendarSlotsLoading=!1,he.response&&(!("data"in he.response.data)&&"message"in he.response.data&&(k.value=!0,E.value=he.response.data.message,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500)),"data"in he.response&&"data"in he.response.data&&"customerAlreadyBooked"in he.response.data.data&&(k.value=!0,E.value=e.labels.customer_already_booked_app,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500)),"data"in he.response&&"data"in he.response.data&&"cancelBookingUnavailable"in he.response.data.data&&(k.value=!0,E.value=e.labels.booking_cancel_exception,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500)),"data"in he.response&&"data"in he.response.data&&"timeSlotUnavailable"in he.response.data.data&&he.response.data.data.timeSlotUnavailable===!0&&(k.value=!0,E.value=e.labels.time_slot_unavailable,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500)),"data"in he.response&&"data"in he.response.data&&"rescheduleBookingUnavailable"in he.response.data.data&&he.response.data.data.rescheduleBookingUnavailable===!0&&(k.value=!0,E.value=e.labels.booking_reschedule_exception,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500))),t("error")})}function _e(){R.value.calendarSlotsLoading=!0;let ee=ve(l.general.showClientTimeZone&&s.getters["cabinet/getTimeZone"]===Rs()),he=JSON.parse(JSON.stringify(e.appointment));he.bookingStart=ee.bookingStart,he.bookings[0].utcOffset=ee.utcOffset,he.bookings[0].timeZone=ee.timeZone,he.providerId=parseInt(Oe.value),he.locationId=parseInt(fe.value),Pe.post("/bookings",he,ze(s)).then(de=>{R.value.calendarSlotsLoading=!1,Hr(s,de),t("success",{message:v.value.booking_added_success})}).catch(de=>{R.value.calendarSlotsLoading=!1,de.response&&("customerAlreadyBooked"in de.response.data.data&&de.response.data.data.customerAlreadyBooked===!0&&(k.value=!0,E.value=e.labels.customer_already_booked_app,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500)),"timeSlotUnavailable"in de.response.data.data&&de.response.data.data.timeSlotUnavailable===!0&&(k.value=!0,E.value=e.labels.time_slot_unavailable,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500)),"packageBookingUnavailable"in de.response.data.data&&de.response.data.data.packageBookingUnavailable===!0&&(k.value=!0,E.value=e.labels.package_booking_unavailable,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500)),"customerBlocked"in de.response.data.data&&de.response.data.data.customerBlocked===!0&&(k.value=!0,E.value=e.labels.customer_blocked,setTimeout(function(){ut(Q.value,T.value.$el,0,300)},500))),t("error",de)})}function Se(){le.value?te.value.validate(ee=>{ee?_e():setTimeout(()=>{ut(Q.value,te.value.$el,0,300)},200)}):_e()}let Oe=O(null),fe=O(null),Le=O(null);function Ne(ee,he){if(Le.value=he,ce.value=!1,!e.appointment.bookingStart)return{calendarStartDate:Al(Object.keys(he))[0],calendarEventSlots:[],calendarEventSlot:null};let de=e.appointment.bookingStart.split(" ");return{calendarStartDate:de[0],calendarEventSlots:de[0]in he?Object.keys(he[de[0]]):[],calendarEventSlot:de[1].slice(0,5)}}Re("useSlotsCallback",Ne),Re("useRange",()=>{if(!e.appointment.bookingStart)return{start:null,end:null};let ee=e.appointment.bookingStart.split(" ")[0];return{start:me(ee,"YYYY-MM-DD").startOf("month").subtract(6,"days").format("YYYY-MM-DD"),end:me(ee,"YYYY-MM-DD").endOf("month").add(12,"days").format("YYYY-MM-DD")}}),Re("useSelectedDuration",()=>{});function Me(){let ee=Object.keys(Le.value[g.value]);ee.length&&(Oe.value=b.value&&Le.value[g.value][b.value]?Le.value[g.value][b.value][0][0]:Le.value[g.value][ee[0]][0][0],fe.value=b.value&&Le.value[g.value][b.value]?Le.value[g.value][b.value][0][1]:Le.value[g.value][ee[0]][0][1])}Re("useBusySlots",()=>[]),Re("useSelectedDate",(ee,he)=>(g.value=he,e.appointment&&e.appointment.bookingStart&&(b.value=e.appointment.bookingStart.split(" ")[1].substring(0,5)),Me(),Object.keys(Le.value[he]))),Re("useSelectedTime",(ee,he)=>{b.value=he.substring(0,5),g.value?Me():e.appointment&&(g.value=e.appointment.bookingStart.split(" ")[0],Me())}),Re("useDeselectedDate",()=>{g.value="",b.value="",Oe.value=null,fe.value=null});let Be=V("amFonts"),Ce=V("amColors"),qe=_(()=>({"--am-c-csd-text":Ce.value.colorMainText,"--am-c-csd-bgr":Ce.value.colorMainBgr,"--am-c-csd-text-op10":W(Ce.value.colorMainText,.1),"--am-c-scroll-op30":W(Ce.value.colorPrimary,.3),"--am-c-scroll-op10":W(Ce.value.colorPrimary,.1),"--am-font-family":Be.value.fontFamily}));return(ee,he)=>{const de=vt,Fe=et;return c(),U(za,{visibility:a(e).visibility,"custom-class":"am-csd am-csd__reschedule",style:ke(a(qe)),position:"center"},{footer:L(()=>[d("div",Yv,[I(Te,{category:"secondary",size:a(P)<=360?"small":"default",type:a(e).customizedOptions.cancelBtn.buttonType,disabled:a(ce)||a(Y),onClick:q},{default:L(()=>[re(x(n.labels.cancel),1)]),_:1},8,["size","type","disabled"]),I(Te,{size:a(P)<=360?"small":"default",type:a(e).customizedOptions.continueBtn.buttonType,disabled:!!(a(ce)||a(Y)||!a(g)||!a(b)),onClick:X},{default:L(()=>[re(x(n.labels.continue),1)]),_:1},8,["size","type","disabled"])])]),default:L(()=>[d("div",{ref_key:"popupInnerRef",ref:D,class:"am-csd__inner"},[d("div",Uv,[d("div",zv,x(n.labels.no_selected_slot_requirements),1),d("div",{class:"am-csd__header-btn",onClick:q},[I(We,{icon:"close"})])]),d("div",{ref_key:"rescheduleRef",ref:Q,class:"am-csd__content"},[a(k)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:T,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:$,onTriggerClose:$},{title:L(()=>[jv,re(" "+x(a(E)),1)]),_:1},512)):N("",!0),a(le)?(c(),U(Fe,{key:1,ref_key:"packageFormRef",ref:te,class:"am-csd__filter-wrapper",rules:a(ne),model:a(j),"label-position":"top"},{default:L(()=>[d("div",{class:B(["am-csd__filter am-csd__filter-employee",a(f)])},[a(e).employees.length&&a(ie)&&a(e).customizedOptions.employee.visibility?(c(),U(de,{key:0,class:B([{"am-csd__filter-full":!(a(e).locations.length&&a(se)&&a(e).customizedOptions.location.visibility)},a(f)]),label:`${a(v).package_appointment_employee}:`,prop:"employee"},{default:L(()=>[I(Ze,{modelValue:a(j).employee,"onUpdate:modelValue":he[0]||(he[0]=xe=>a(j).employee=xe),clearable:"",filterable:a(e).customizedOptions.employee.filterable,placeholder:`${a(v).package_select_employee}...`,"fit-input-width":!0,"popper-class":"am-csd__filter-employees",disabled:a(ce),"filter-method":o,onChange:ge},{default:L(()=>[(c(!0),C(ae,null,pe(a(r),xe=>(c(),U(Ue,{key:xe.id,value:xe.id,label:`${xe.firstName} ${xe.lastName}`},{default:L(()=>[I(Uc,{identifier:xe.id,label:`${xe.firstName} ${xe.lastName}`,price:0,"image-thumb":xe.pictureThumbPath,description:xe.description,"dialog-title":a(v).employee_information_package,"dialog-button-text":a(v).select_this_employee_package,badge:xe.badge,onClick:be},null,8,["identifier","label","image-thumb","description","dialog-title","dialog-button-text","badge"])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","filterable","placeholder","disabled"])]),_:1},8,["class","label"])):N("",!0),a(e).locations.length&&a(se)&&a(e).customizedOptions.location.visibility?(c(),U(de,{key:1,class:B([{"am-csd__filter-full":!(a(e).employees.length&&a(ie)&&a(e).customizedOptions.employee.visibility)},a(f)]),label:`${a(v).package_appointment_location}:`,prop:"location"},{default:L(()=>[I(Ze,{modelValue:a(j).location,"onUpdate:modelValue":he[1]||(he[1]=xe=>a(j).location=xe),clearable:"",filterable:a(e).customizedOptions.location.filterable,placeholder:`${a(v).package_select_location}...`,"fit-input-width":!0,disabled:a(ce),"filter-method":m,onChange:ge},{default:L(()=>[(c(!0),C(ae,null,pe(a(h),xe=>(c(),U(Ue,{key:xe.id,value:xe.id,label:xe.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","filterable","placeholder","disabled"])]),_:1},8,["class","label"])):N("",!0)],2)]),_:1},8,["rules","model"])):N("",!0),a(e).appointment!==null?(c(),U(Wr,{key:2,id:0,ref_key:"calendarRef",ref:R,"preselect-slot":!1,"load-counter":a(K),"end-time":a(e).customizedOptions.endTimeVisibility.visibility,"time-zone":a(e).customizedOptions.timeZoneVisibility.visibility,"label-slots-selected":n.labels.date_time_slots_selected,"fetched-slots":null,"service-id":0,date:a(e).appointment&&a(e).appointment.bookingStart?a(e).appointment.bookingStart.split(" ")[0]:"","slots-params":a(Z)},null,8,["load-counter","end-time","time-zone","label-slots-selected","date","slots-params"])):N("",!0)],512)],512)]),_:1},8,["visibility","style"])}}});const Hv={class:"am-csd__inner"},Zv={class:"am-csd__header"},Gv={class:"am-csd__header-text"},Jv={class:"am-csd__content"},Xv={class:"am-ccpss__heading"},Qv={class:"am-csd__footer"},Kv={name:"CancelBooking"},Ua=Object.assign(Kv,{props:{visibility:{type:Boolean,required:!0},title:{type:String,default:""},description:{type:String,default:""},closeBtnText:{type:String,required:!0},confirmBtnText:{type:String,required:!0},loading:{type:Boolean,default:!1},count:{type:Number,default:1},customizedOptions:{type:Object,required:!0}},emits:["close","confirm","decline"],setup(n,{emit:t}){const e=n;let s=V("containerWidth"),l=V("amFonts"),i=V("amColors"),o=_(()=>({"--am-c-csd-text":i.value.colorMainText,"--am-c-csd-bgr":i.value.colorMainBgr,"--am-font-family":l.value.fontFamily}));return(r,u)=>{const m=Fl,h=Vl;return c(),U(za,{visibility:a(e).visibility,"custom-class":"am-csd am-csd__cancel",style:ke(a(o)),position:"center"},{footer:L(()=>[d("div",Qv,[I(Te,{category:"secondary",size:a(s)<=360?"small":"default",type:n.customizedOptions.cancelBtn.buttonType,disabled:n.loading,onClick:u[1]||(u[1]=()=>{t("decline")})},{default:L(()=>[re(x(a(e).closeBtnText),1)]),_:1},8,["size","type","disabled"]),I(Te,{category:"danger",size:a(s)<=360?"small":"default",type:n.customizedOptions.confirmBtn.buttonType,disabled:n.loading,onClick:u[2]||(u[2]=()=>{t("confirm")})},{default:L(()=>[re(x(a(e).confirmBtnText),1)]),_:1},8,["size","type","disabled"])])]),default:L(()=>[d("div",Hv,[n.loading?(c(),U(h,{key:1,animated:"",class:"am-ccpss"},{template:L(()=>[d("div",Xv,[I(m,{variant:"rect"})]),(c(!0),C(ae,null,pe(new Array(a(e).count),v=>(c(),C("div",{key:v,class:"am-ccpss__text"},[I(m,{variant:"rect"})]))),128))]),_:1})):(c(),C(ae,{key:0},[d("div",Zv,[d("div",Gv,x(a(e).title),1),d("div",{class:"am-csd__header-btn",onClick:u[0]||(u[0]=()=>{t("close")})},[I(We,{icon:"close"})])]),d("div",Jv,[d("p",null,x(a(e).description),1)])],64))])]),_:1},8,["visibility","style"])}}});const e1={name:"CabinetAppointmentsList"},br=Object.assign(e1,{props:{groupedAppointments:{type:Object,default:null},responsiveClass:{type:String,default:""},pageWidth:{type:Number},isPackageBooking:{type:Boolean,default:!1},stepKey:{type:String,required:!0}},emits:["booked","canceled","editAppointment"],setup(n,{emit:t}){const e=n;let s=De(),l=V("originKey");const i=V("settings");let o=V("amLabels"),r=V("cabinetType"),u=O(null),m=O(null),h=O(null);function v(Y=null){m.value=null,t("booked",Y)}let g=O(!1);function b(){g.value=!0,Pe.post("/bookings/cancel/"+u.value.id,{type:"appointment"},Object.assign(ze(s),{params:{source:"cabinet-"+r.value}})).then(()=>{u.value=null,t("canceled",{message:o.value.appointment_canceled})}).catch(Y=>{console.log(Y)}).finally(()=>{g.value=!1})}function D(Y){let M={total:0,bookable:0,discount:0,tax:0};return Y.bookings.forEach(K=>{if(K.status==="approved"||K.status==="pending"){let ce=gi(s,{price:K.price,persons:K.persons,aggregatedPrice:K.aggregatedPrice,extras:K.extras,tax:K.tax,coupon:K.coupon},!1);M.total+=ce.total,M.bookable+=ce.bookable,M.discount+=ce.discount,M.tax+=ce.tax}}),M.total-M.discount+M.tax}function P(Y){let M=[],K=0,ce=Y;ce.bookings.forEach(ie=>{ie.extras.forEach(se=>{M.push({id:se.extraId,quantity:se.quantity})}),"duration"in ie&&ie.duration&&ie.duration>K&&(ie.status==="approved"||ie.status==="pending")&&(K=ie.duration)});let j={serviceId:ce.serviceId,serviceDuration:K||null,locationId:ce.locationId,providerIds:[ce.providerId],extras:JSON.stringify(M),excludeAppointmentId:ce.isGroup?null:ce.id,group:1,timeZone:s.getters["cabinet/getTimeZone"],page:"cabinet"};m.value=Y,h.value=j}function y(Y){return s.getters["entities/getEmployee"](Y)}function w(Y){return Y.bookings.filter(M=>M.status!=="rejected"&&M.status!=="canceled").map(M=>{if("info"in M&&M.info){let K="customer"in M?M.customer:{};return Object.assign(K,JSON.parse(M.info))}else return M.customer})}let A=V("amCustomize");const S=V("labels"),f=V("localLanguage");let k=_(()=>i.general.usedLanguages.includes(f.value));function T(Y){let M=Qe({...S}),K=A.value[Y].translations;return K&&Object.keys(K).forEach(ce=>{K[ce][f.value]&&k.value?M[ce]=K[ce][f.value]:K[ce].default&&(M[ce]=K[ce].default)}),M}function E(Y){return A.value[Y].options}let $=V("amColors"),R=_(()=>({"--am-c-capa-bgr":$.value.colorMainBgr,"--am-c-capa-text":$.value.colorMainText,"--am-c-capa-text-op70":W($.value.colorMainText,.7),"--am-c-capa-text-op25":W($.value.colorMainText,.25),"--am-c-capa-primary":$.value.colorPrimary}));return(Y,M)=>(c(),C(ae,null,[d("div",{class:B(["am-capa__wrapper",[{"am-no-border":a(e).groupedAppointments&&Object.keys(a(e).groupedAppointments).length===1},a(e).responsiveClass]]),style:ke(a(R))},[(c(!0),C(ae,null,pe(a(e).groupedAppointments,(K,ce)=>(c(),C("div",{key:ce,class:"am-capa"},[d("div",{class:B(["am-capa__date",[{"am-today":a(ot)(ce)===a(ot)(a(Ke)().format("YYYY-MM-DD"))},{"am-no-flag":a(e).groupedAppointments&&Object.keys(a(e).groupedAppointments).length===1},a(e).responsiveClass]])},x(a(ot)(ce)),3),(c(!0),C(ae,null,pe(K.appointments,(j,ie)=>(c(),C(ae,{key:ie},[a(s).getters["entities/getService"](j.serviceId)?(c(),U(vr,{key:0,start:a(qs)(j.bookingStart.split(" ")[1].slice(0,5)),name:a(s).getters["entities/getService"](j.serviceId).name,employee:y(j.provider.id),customers:w(j),price:D(j),duration:a(Ph)(a(s),j),periods:[],extras:a(Nh)(j.bookings,a(s).getters["entities/getService"](j.serviceId)),tickets:[],"custom-fields":a(hr)(j.bookings,a(r)),location:j.locationId?a(s).getters["entities/getLocation"](j.locationId):null,"google-meet-link":j.googleMeetUrl,"microsoft-teams-link":j.microsoftTeamsUrl,"zoom-link":j.zoomMeeting?j.zoomMeeting.joinUrl:"","lesson-space-link":j.lessonSpace,bookable:j.service,reservation:j,booking:j.bookings[0],"is-package-booking":a(e).isPackageBooking,"responsive-class":a(e).responsiveClass,"parent-width":a(e).pageWidth,"customized-options":E(a(e).stepKey),onCancelBooking:M[0]||(M[0]=se=>{we(u)?u.value=se:u=se}),onRescheduling:P,onEditAppointment:M[1]||(M[1]=se=>{a(t)("editAppointment",se)})},null,8,["start","name","employee","customers","price","duration","extras","custom-fields","location","google-meet-link","microsoft-teams-link","zoom-link","lesson-space-link","bookable","reservation","booking","is-package-booking","responsive-class","parent-width","customized-options"])):N("",!0)],64))),128))]))),128))],6),a(l)==="capc"?(c(),U(Ua,{key:0,visibility:a(u)!==null,title:T("cancelAppointment").cancel_appointment,description:T("cancelAppointment").confirm_cancel_appointment,"close-btn-text":T("cancelAppointment").close,"confirm-btn-text":T("cancelAppointment").confirm,"customized-options":E("cancelAppointment"),loading:a(g),onClose:M[2]||(M[2]=K=>we(u)?u.value=null:u=null),onDecline:M[3]||(M[3]=K=>we(u)?u.value=null:u=null),onConfirm:b},null,8,["visibility","title","description","close-btn-text","confirm-btn-text","customized-options","loading"])):N("",!0),a(l)==="capc"?(c(),U(yr,{key:1,visibility:a(m)!==null,appointment:a(m),"slots-params":a(h),labels:T("rescheduleAppointment"),"customized-options":E("rescheduleAppointment"),onClose:M[4]||(M[4]=K=>we(m)?m.value=null:m=null),onSuccess:v,onError:M[5]||(M[5]=()=>{})},null,8,["visibility","appointment","slots-params","labels","customized-options"])):N("",!0)],64))}});const t1={class:"am-capai-def__notify"},a1=["innerHTML"],s1={class:"am-capai-def__notify"},l1=["innerHTML"],n1={props:{slotsProps:{type:Object,required:!0},slotsLoading:{type:Boolean,required:!0},isDisabledDate:{type:Function,required:!0},freeSlots:{type:Object,required:!0},times:{type:Array,required:!0},getFreeTimes:{type:Function,required:!0}},emits:["removeSlots","fetchSlots","changedSlotCondition","getSelectedDatesTimes","filterOut","getFreeTimes","selectDate","selectTime"],setup(n,{expose:t,emit:e}){const s=n;let l=De(),i=V("amLabels"),o=V("localLanguage");const r=V("settings");let u=V("licence");const m=O(null);let{width:h}=ja(m),v=_(()=>st(h.value)),g=O({categoryId:_({get:()=>l.getters["appointment/getCategoryId"],set:q=>{l.commit("appointment/setCategoryId",q||null)}}),serviceId:_({get:()=>l.getters["appointment/getServiceId"],set:q=>{l.commit("appointment/setServiceId",q||null)}}),providerId:_({get:()=>l.getters["appointment/getProviderId"],set:q=>{l.commit("appointment/setProviderId",q||null)}}),locationId:_({get:()=>l.getters["appointment/getLocationId"],set:q=>{l.commit("appointment/setLocationId",q||null)}}),lessonSpace:_({get:()=>l.getters["appointment/getLessonSpace"],set:q=>{l.commit("appointment/setLessonSpace",q||"")}}),startDate:_({get:()=>l.getters["appointment/getStartDate"],set:q=>{l.commit("appointment/setStartDate",q||"")}}),startTime:_({get:()=>l.getters["appointment/getStartTime"],set:q=>{l.commit("appointment/setStartTime",q||"")}}),notifyParticipants:_({get:()=>l.getters["appointment/getNotifyParticipants"],set:q=>{l.commit("appointment/setNotifyParticipants",q)}}),createPaymentLinks:_({get:()=>l.getters["appointment/getCreatePaymentLinks"],set:q=>{l.commit("appointment/setCreatePaymentLinks",q)}}),internalNotes:_({get:()=>l.getters["appointment/getInternalNotes"],set:q=>{l.commit("appointment/setInternalNotes",q||"")}})}),b=_(()=>({serviceId:[{required:!0,message:i.value.please_select_service,trigger:["submit","change"]}],startDate:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}],startTime:[{required:!0,message:i.value.select_time_warning,trigger:["submit","change"]}]})),D=_(()=>l.getters["entities/filteredCategories"](l.getters["appointment/getSelection"])),P=O(l.getters["entities/filteredCategories"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),y=O("");function w(q){y.value=q.toLowerCase()}let A=_(()=>y.value?P.value.filter(q=>q.name.toLowerCase().includes(y.value)):P.value),S=_(()=>l.getters["entities/filteredServices"](l.getters["appointment/getSelection"])),f=O(l.getters["entities/filteredServices"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null}));function k(q){let Q=l.getters["entities/getService"](q),G=Q&&Q.settings?JSON.parse(Q.settings):null,H=G&&"payments"in G&&G.payments&&"paymentLinks"in G.payments&&G.payments.paymentLinks?G.payments.paymentLinks:r.payments.paymentLinks;return H&&H.enabled}let T=O("");function E(q){T.value=q.toLowerCase()}let $=_(()=>T.value?f.value.filter(q=>q.name.toLowerCase().includes(T.value)):f.value),R=_(()=>l.getters["appointment/getId"]&&l.getters["appointment/getServiceId"]&&f.value.map(q=>q.id).indexOf(l.getters["appointment/getServiceId"])===-1?l.getters["entities/getService"](l.getters["appointment/getServiceId"]):null),Y=_(()=>l.getters["entities/filteredLocations"](l.getters["appointment/getSelection"])),M=O(l.getters["entities/filteredLocations"]({categoryId:null,serviceId:null,providerId:l.getters["appointment/getProviderId"],locationId:null})),K=O("");function ce(q){K.value=q.toLowerCase()}let j=_(()=>K.value?M.value.filter(q=>q.name.toLowerCase().includes(K.value)):M.value),ie=_(()=>l.getters["appointment/getId"]&&l.getters["appointment/getLocationId"]&&M.value.map(q=>q.id).indexOf(l.getters["appointment/getLocationId"])===-1?l.getters["entities/getLocation"](l.getters["appointment/getLocationId"]):null),se=O(l.getters["entities/getSpaces"]);function le(){l.commit("appointment/setTargetedDate",null),l.commit("appointment/setStartDate",null),l.commit("appointment/setStartTime",null),e("removeSlots")}function te(q,Q=null,G=!1){let H=l.getters["appointment/getTargetedDate"];!q&&!H?q=me().toDate():!q&&H&&(q=H),l.commit("appointment/setTargetedDate",q&&G?q:H),g.value.serviceId&&e("fetchSlots",q,Q,G)}function ne(){g.value.startDate&&te(g.value.startDate)}function Z(q){e("selectTime",q)}function ge(q){q?e("selectDate",q):le()}function be(q){q?(clearTimeout(this.searchSpacesTimer),l.commit("auth/setSpacesLoading",!0),Pe.get("/entities",{params:{types:["spaces"],lessonSpaceSearch:q}}).then(Q=>{se.value=Q.data.data.spaces}).catch(Q=>{console.log(Q)}).finally(()=>{l.commit("auth/setSpacesLoading",!1)})):se.value=l.getters["entities/getSpaces"]}return it(()=>g.value.serviceId,q=>{l.dispatch("appointment/updateEmployeeService",q||null),q&&(l.dispatch("appointment/recreateAllBookingCustomFields",{label:i.value.required_field}),ne())}),Je(()=>{f.value.length===1&&!l.getters["appointment/getId"]&&l.commit("appointment/setServiceId",f.value[0].id),M.value.length===1&&!l.getters["appointment/getId"]&&l.commit("appointment/setLocationId",M.value[0].id)}),t({detailsFormRef:m}),(q,Q)=>{const G=vt,H=Bl,J=et;return c(),U(J,{ref_key:"detailsFormRef",ref:m,model:a(g),rules:a(b),class:"am-capai-def"},{default:L(()=>[a(P).length>1?(c(),U(G,{key:0,label:`${a(i).category}`,class:"am-capai-def__item"},{default:L(()=>[I(Ze,{modelValue:a(g).categoryId,"onUpdate:modelValue":Q[0]||(Q[0]=X=>a(g).categoryId=X),clearable:"",filterable:"",placeholder:`${a(i).select_service_category}`,"filter-method":w},{default:L(()=>[(c(!0),C(ae,null,pe(a(A),X=>(c(),U(Ue,{key:X.id,value:X.id,label:X.name,disabled:a(g).serviceId&&typeof a(D).find(ve=>ve.id===X.id)>"u"},null,8,["value","label","disabled"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0),I(G,{label:`${a(i).services_dropdown}`,prop:"serviceId",class:"am-capai-def__item"},{default:L(()=>[I(Ze,{modelValue:a(g).serviceId,"onUpdate:modelValue":Q[1]||(Q[1]=X=>a(g).serviceId=X),disabled:a(f).length===1,clearable:"",filterable:"",placeholder:`${a(i).select_service}`,"filter-method":E},{default:L(()=>[(c(!0),C(ae,null,pe(a($),X=>(c(),U(Ue,{key:X.id,value:X.id,label:X.name,disabled:typeof a(S).find(ve=>ve.id===X.id)>"u"},null,8,["value","label","disabled"]))),128)),a(R)?(c(),U(Ue,{key:a(R).id,value:a(R).id,label:a(R).name},null,8,["value","label"])):N("",!0)]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"]),!a(u).isStarter&&a(M).length>1?(c(),U(G,{key:1,label:`${a(i).location}`,class:"am-capai-def__item"},{default:L(()=>[I(Ze,{modelValue:a(g).locationId,"onUpdate:modelValue":Q[2]||(Q[2]=X=>a(g).locationId=X),disabled:a(M).length===1,clearable:"",filterable:"",placeholder:`${a(i).select_location}`,"filter-method":ce,onChange:ne},{default:L(()=>[(c(!0),C(ae,null,pe(a(j),X=>(c(),U(Ue,{key:X.id,value:X.id,label:X.name,disabled:a(ie)===null&&typeof a(Y).find(ve=>ve.id===X.id)>"u"},null,8,["value","label","disabled"]))),128)),a(ie)?(c(),U(Ue,{key:a(ie).id,value:a(ie).id,label:a(ie).name},null,8,["value","label"])):N("",!0)]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["label"])):N("",!0),a(r).lessonSpace.enabled?(c(),U(G,{key:2,label:`${a(i).lesson_space}`,class:"am-capai-def__item"},{default:L(()=>[I(Ze,{modelValue:a(g).lessonSpace,"onUpdate:modelValue":Q[3]||(Q[3]=X=>a(g).lessonSpace=X),filterable:"",clearable:"",remote:"","remote-method":be,placeholder:`${a(i).select}`},{default:L(()=>[(c(),U(Ue,{key:0,value:0,label:a(i).lesson_space_new_space},null,8,["label"])),(c(!0),C(ae,null,pe(a(se),X=>(c(),U(Ue,{key:X.id,value:X.id,label:X.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0),I(G,{label:`${a(i).date}`,prop:"startDate",class:B(["am-capai-def__item am-w-50",a(v)])},{default:L(()=>[I(Yt,{modelValue:a(g).startDate,"onUpdate:modelValue":Q[4]||(Q[4]=X=>a(g).startDate=X),type:"date",format:a(jt)(),placeholder:a(i).select_date,clearable:!0,lang:a(o),disabled:!a(g).serviceId,"disabled-date":(X,ve)=>a(s).isDisabledDate(X,null,!0,ve),"popper-class":n.slotsLoading?"am-slots-loader":"",onPanelChange:Q[5]||(Q[5]=X=>{te(X,null,!0)}),onChange:ge,onFocus:Q[6]||(Q[6]=X=>a(g).serviceId&&!a(g).startDate?te(null,null,!0):!1)},null,8,["modelValue","format","placeholder","lang","disabled","disabled-date","popper-class"])]),_:1},8,["label","class"]),I(G,{label:`${a(i).time}`,prop:"startTime",class:B(["am-capai-def__item am-w-50",a(v)])},{default:L(()=>[I(Ze,{modelValue:a(g).startTime,"onUpdate:modelValue":Q[7]||(Q[7]=X=>a(g).startTime=X),placeholder:`${a(i).select_time}`,disabled:!a(g).startDate,"prefix-icon":"clock",onChange:Z},{default:L(()=>[(c(!0),C(ae,null,pe(a(s).getFreeTimes(null,{date:a(g).startDate,times:a(s).times,time:a(g).startTime},!0),X=>(c(),U(Ue,{key:X,value:X,label:X},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["label","class"]),I(G,{class:"am-capai-def__item"},{default:L(()=>[d("div",t1,[I(dt,{modelValue:a(g).notifyParticipants,"onUpdate:modelValue":Q[8]||(Q[8]=X=>a(g).notifyParticipants=X),label:a(i).notify_customers},null,8,["modelValue","label"]),I(H,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(i).notify_customers_tooltip},null,8,a1)]),default:L(()=>[I(We,{icon:"info-reverse"})]),_:1})])]),_:1}),a(g).notifyParticipants&&a(g).serviceId&&k(a(g).serviceId)?(c(),U(G,{key:3,class:"am-capai-def__item"},{default:L(()=>[d("div",s1,[I(dt,{modelValue:a(g).createPaymentLinks,"onUpdate:modelValue":Q[9]||(Q[9]=X=>a(g).createPaymentLinks=X),label:a(i).generate_payment_links},null,8,["modelValue","label"]),I(H,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(i).generate_payment_links_tooltip},null,8,l1)]),default:L(()=>[I(We,{icon:"info-reverse"})]),_:1})])]),_:1})):N("",!0),I(G,{label:`${a(i).note_internal}`,class:"am-capai-def__item"},{default:L(()=>[I(mt,{modelValue:a(g).internalNotes,"onUpdate:modelValue":Q[10]||(Q[10]=X=>a(g).internalNotes=X),type:"textarea"},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model","rules"])}}};function kr(n,t){return Object.assign({},t,{gender:t.gender?t.gender:"",note:t.note?t.note:"",phone:t.phone?t.phone:"",birthday:t.birthday?me(t.birthday.date.split(" ")[0]).toDate():null,translations:t.translations?JSON.parse(t.translations):{defaultLanguage:""}})}function i1(n){let t=n.getters["customerInfo/getCustomer"];return Object.assign({},t,{birthday:t.birthday?me(t.birthday).format("YYYY-MM-DD"):null,translations:t.translations.defaultLanguage?JSON.stringify(t.translations):null})}const is=Qe(window.wpAmeliaLabels);function o1(){return[{value:"approved",label:is.approved,icon:"check",color:"var(--am-c-success)"},{value:"pending",label:is.pending,icon:"refresh",color:"var(--am-c-warning)"},{value:"canceled",label:is.canceled,icon:"close",color:"var(--am-c-error)"},{value:"rejected",label:is.rejected,icon:"info-reverse",color:"var(--am-c-main-text)"},{value:"waiting",label:is.waiting,icon:"clock",color:"var(--am-c-warning)"},{value:"no-show",label:is["no-show"],icon:"clock",color:"var(--am-c-warning)"}]}const r1=d("span",{class:"am-icon-triangle-info"},null,-1),c1={key:0,class:"am-capai-warn__content"},u1={key:0,class:"am-capai-warn__heading"},d1={key:1,class:"am-capai-warn__text"},Cr={props:{heading:{type:String,default:""},text:{type:String,default:""}},setup(n){const t=n;let e=V("amColors"),s=_(()=>({"--am-c-warning":e.value.colorWarning,"--am-c-warning-op10":W(e.value.colorWarning,.1),"--am-c-main-text":e.value.colorMainText,"--am-c-main-text-op10":W(e.value.colorMainText,.1)}));return(l,i)=>(c(),C("div",{class:"am-capai-warn",style:ke(a(s))},[r1,t.heading||t.text?(c(),C("div",c1,[t.heading?(c(),C("div",u1,x(t.heading),1)):N("",!0),t.text?(c(),C("div",d1,x(t.text),1)):N("",!0)])):N("",!0)],4))}};const m1={class:"am-cap-aec__header"},p1=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),xr={props:{visibility:{type:Boolean,required:!0},customCss:{type:Object,default:()=>{}},responsiveClass:{type:String,default:""}},emits:["update:visibility","addedCustomer"],setup(n,{emit:t}){const e=n,s=V("settings");let l=V("amLabels");const i=De();let o=O("details"),r=O(null),u=O(!1),m=O("success"),h=O("");function v(){u.value=!1,i.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}let g=_(()=>i.getters["customerInfo/getCustomerId"]),b=_(()=>{let j=[];return s.wordpress.locale in i.getters["entities/getSettings"].languages&&j.push({value:i.getters["entities/getSettings"].languages[s.wordpress.locale].wp_locale,label:i.getters["entities/getSettings"].languages[s.wordpress.locale].name}),s.general.usedLanguages.forEach(ie=>{ie in i.getters["entities/getSettings"].languages&&j.push({value:i.getters["entities/getSettings"].languages[ie].wp_locale,label:i.getters["entities/getSettings"].languages[ie].name})}),j}),D=O(null),P=O(!1),y=O({firstName:_({get:()=>i.getters["customerInfo/getCustomerFirstName"],set:j=>{i.commit("customerInfo/setCustomerFirstName",j||"")}}),lastName:_({get:()=>i.getters["customerInfo/getCustomerLastName"],set:j=>{i.commit("customerInfo/setCustomerLastName",j||"")}}),email:_({get:()=>i.getters["customerInfo/getCustomerEmail"],set:j=>{i.commit("customerInfo/setCustomerEmail",j||"")}}),phone:_({get:()=>i.getters["customerInfo/getCustomerPhone"],set:j=>{i.commit("customerInfo/setCustomerPhone",j||"")}}),language:_({get:()=>i.getters["customerInfo/getCustomerLanguage"],set:j=>{i.commit("customerInfo/setCustomerLanguage",j||"")}}),gender:_({get:()=>i.getters["customerInfo/getCustomerGender"],set:j=>{i.commit("customerInfo/setCustomerGender",j||"")}}),birthday:_({get:()=>i.getters["customerInfo/getCustomerBirthday"]||"",set:j=>{i.commit("customerInfo/setCustomerBirthday",j?me(j).format("YYYY-MM-DD"):"")}}),note:_({get:()=>i.getters["customerInfo/getCustomerNote"],set:j=>{i.commit("customerInfo/setCustomerNote",j||"")}})}),w=O({firstName:[{required:!0,message:l.value.enter_first_name_warning,trigger:["submit","blur"]}],lastName:[{required:!0,message:l.value.enter_last_name_warning,trigger:["submit","blur"]}]}),A=O({firstName:{template:Ye.text,props:{itemName:"firstName",label:l.value.first_name_colon,placeholder:l.value.enter_first_name,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="user"/>'})}},lastName:{template:Ye.text,props:{itemName:"lastName",label:l.value.last_name_colon,placeholder:l.value.enter_last_name,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="user"/>'})}},email:{template:Ye.text,props:{itemName:"email",label:l.value.email_colon,placeholder:l.value.enter_email,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:'<IconComponent icon="email"/>'})}},phone:{countryPhoneIso:_({get:()=>i.getters["customerInfo/getCustomerCountryPhoneIso"]||"",set:j=>{i.commit("customerInfo/setCustomerCountryPhoneIso",j?j.toLowerCase():"")}}),template:Ye.phone,props:{itemName:"phone",label:l.value.phone_colon,placeholder:l.value.enter_phone,defaultCode:_(()=>i.getters["customerInfo/getCustomerCountryPhoneIso"]?i.getters["customerInfo/getCustomerCountryPhoneIso"]:s.general.phoneDefaultCountryCode&&s.general.phoneDefaultCountryCode!=="auto"?s.general.phoneDefaultCountryCode:""),phoneError:_(()=>P.value),whatsAppLabel:l.value.whatsapp_opt_in_text,isWhatsApp:s.notifications.whatsAppEnabled&&s.notifications.whatsAppAccessToken&&s.notifications.whatsAppBusinessID&&s.notifications.whatsAppPhoneID,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}},language:{template:Ye.select,props:{itemName:"language",label:l.value.notification_language,placeholder:l.value.language,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:`
          <IconComponent icon="pennant"/>`}),options:b.value}},gender:{template:Ye.select,props:{itemName:"gender",label:l.value.gender,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`),prefixIcon:Ge({components:{IconComponent:We},template:`
          <IconComponent icon="gender"/>`}),options:[{label:l.value.female,value:"female"},{label:l.value.male,value:"male"}]}},birthday:{template:Ye.datepicker,props:{itemName:"birthday",label:l.value.date_of_birth,placeholder:l.value.enter_date_of_birth,clearable:!0,readonly:!1,class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}},note:{template:Ye["text-area"],props:{itemName:"note",label:l.value.note_internal,itemType:"textarea",class:_(()=>`am-cap-aec__form-item ${e.responsiveClass}`)}}});function S(){i.dispatch("customerInfo/resetCustomer"),t("update:visibility",!1)}let f=_(()=>i.getters["customerInfo/getLoading"]);function k(){D.value.validate(j=>{if(!j){o.value="details";return}i.commit("customerInfo/setLoading",!0);let ie=i1(i);const se={};for(const le in R){const te=R[le],ne=E[le];se[le]={label:te.label,type:te.type,value:typeof ne=="string"?ne.trim():ne}}ie.customFields=JSON.stringify(se),Pe.post("/users/customers"+(ie.id?"/"+ie.id:""),ie,Object.assign(ze(i),{params:{source:"cabinet-provider"}})).then(le=>{i.commit("auth/setPreloadedCustomers",i.getters["auth/getPreloadedCustomers"].concat([le.data.data.user]).sort((te,ne)=>te.id-ne.id)),t("addedCustomer",le.data.data.user),S()}).catch(le=>{"response"in le&&le.response&&(h.value=le.response.data.message,u.value=!0)}).finally(()=>{i.commit("customerInfo/setLoading",!1)})})}Zr(()=>{g.value!==null&&M()});const T=O(null),E=Qe({}),$=Qe({}),R=Qe({});function Y(j,ie){if($[ie]={template:Ye[j.type],props:{id:ie,itemName:ie.toString(),label:j.label,options:j.options,class:`am-cap-aec-cf__item am-cf-width-${j.width}`}},j.type==="text-area"&&($[ie].props.itemType="textarea"),j.type==="datepicker"&&($[ie].props.weekStartsFromDay=s.wordpress.startOfWeek),j.type==="file"){let se=i.getters["auth/getProfile"]?i.getters["auth/getProfile"].id:null;$[ie].props={...$[ie].props,btnLabel:l.value.upload_file_here,isUpload:!0,bookingId:se,source:"cabinet-customer"}}}function M(){const j=i.getters["entities/getCustomFields"],ie=_(()=>{const se=i.getters["customerInfo/getCustomerCustomFields"];return se?JSON.parse(se):null});j.filter(se=>se.saveType==="customer"&&se.type!=="content").forEach(se=>{const{id:le}=se,te=g.value&&ie.value?ie.value[le]?.value:null;R[le]={...se,value:te??(se.type==="checkbox"||se.type==="file"?[]:"")},E[le]=R[le].value??"",Y(se,le)})}let K=V("amColors"),ce=_(()=>({"--am-c-aec-text":K.value.colorMainText}));return(j,ie)=>{const se=et,le=Ia,te=$a;return c(),U(za,{visibility:e.visibility,position:"center","custom-class":"am-slide-popup-aec","custom-css":{...n.customCss,...a(ce)},"onUpdate:visibility":S},{header:L(()=>[d("div",m1,[a(g)?(c(),C(ae,{key:0},[re(x(a(l).edit_customer),1)],64)):(c(),C(ae,{key:1},[re(x(a(l).add_customer),1)],64))])]),footer:L(()=>[I(Te,{type:"plain",category:"secondary",onClick:S},{default:L(()=>[re(x(a(l).cancel),1)]),_:1}),I(Te,{onClick:k},{default:L(()=>[re(x(a(l).save),1)]),_:1})]),default:L(()=>[a(u)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:r,type:a(m),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:v,onTriggerClose:v},{title:L(()=>[p1,re(" "+x(a(h)),1)]),_:1},8,["type"])):N("",!0),a(f)?(c(),U(Wt,{key:2})):(c(),U(te,{key:1,modelValue:a(o),"onUpdate:modelValue":ie[0]||(ie[0]=ne=>we(o)?o.value=ne:o=ne)},{default:L(()=>[I(le,{class:"am-cap__tabs-item",label:a(l).details,name:"details"},{default:L(()=>[I(se,{ref_key:"customerFormRef",ref:D,model:a(y),rules:a(w),"label-position":"top",class:"am-cap-aec__form"},{default:L(()=>[(c(!0),C(ae,null,pe(a(A),(ne,Z)=>(c(),U(pt(ne.template),St({key:Z},ne.props,{modelValue:a(y)[Z],"onUpdate:modelValue":ge=>a(y)[Z]=ge,countryPhoneIso:ne.countryPhoneIso,"onUpdate:countryPhoneIso":ge=>ne.countryPhoneIso=ge}),null,16,["modelValue","onUpdate:modelValue","countryPhoneIso","onUpdate:countryPhoneIso"]))),128))]),_:1},8,["model","rules"])]),_:1},8,["label"]),Object.keys(a(R)).length?(c(),U(le,{key:0,class:"am-cap__tabs-item",label:a(l).custom_fields,name:"customFields"},{default:L(()=>[a(f)?N("",!0):(c(),U(se,{key:0,ref_key:"customFieldsFormRef",ref:T,model:a(E),"label-position":"top",class:B(["am-cap-aec__form",n.responsiveClass])},{default:L(()=>[(c(!0),C(ae,null,pe(Object.keys(a(R)),ne=>(c(),C(ae,{key:ne},[ne in a(E)?(c(),U(pt(a($)[ne]?.template),St({key:0,modelValue:a(E)[ne],"onUpdate:modelValue":Z=>a(E)[ne]=Z},a($)[ne]?.props),null,16,["modelValue","onUpdate:modelValue"])):N("",!0)],64))),128))]),_:1},8,["model","class"]))]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"]))]),_:1},8,["visibility","custom-css"])}}};const g1={class:"am-cap__cust-option"},f1={class:"am-cap__cust-option__heading"},h1={key:0,class:"am-cap__cust-option__inner"},_1={key:1,class:"am-cap__cust-option__inner"},v1={class:"am-capai-cuf__content"},y1={class:"am-capai-cuf__bulk-label"},b1={key:0,class:"am-capai-customer__data"},k1=d("span",{class:"am-icon-phone"},null,-1),C1=["href"],x1={key:1,class:"am-capai-customer__data"},w1=d("span",{class:"am-icon-email"},null,-1),T1=["href"],L1={props:{responsiveClass:{type:String,default:""},capacityWarning:{type:String,default:""},appointmentCapacity:{type:Number,default:0},savedAppointment:{type:Object,default:()=>{}}},emits:["changedSlotCondition"],setup(n,{expose:t,emit:e}){const s=n;let l=De();const i=V("shortcodeData"),o=V("settings");let r=V("amCustomize"),u=V("amLabels"),m=V("pageWidth"),h=_(()=>l.getters["appointment/getEmployeeService"]),v=O(null),g=O({customersIds:_({get:()=>l.getters["customerInfo/getCustomersIds"],set:ne=>l.commit("customerInfo/setCustomersIds",ne)})}),b=O({customersIds:[{required:!0,message:u.value.select_customers,trigger:["submit","change"]}]}),D=_(()=>l.getters["customerInfo/getLoading"]),P=_(()=>l.getters["customerInfo/getCustomers"]),y=O(o.general.defaultAppointmentStatus),w=_(()=>o1().filter(ne=>l.getters["appointment/getId"]?ne.value!=="waiting":(ne.value==="approved"||ne.value==="pending")&&ne.value!=="no-show")),A=_(()=>l.getters["appointment/getBookings"]?l.getters["appointment/getBookings"]:[]),S=O(!1);function f(ne){l.commit("customerInfo/setCustomersIds",[ne.id].concat(l.getters["customerInfo/getCustomersIds"])),l.commit("customerInfo/setCustomers",[ne].concat(l.getters["customerInfo/getCustomers"])),k()}function k(){let ne=l.getters["appointment/getBookings"].map(G=>parseInt(G.customer.id)),Z=!1,ge=h.value.settings?JSON.parse(h.value.settings):null;g.value.customersIds.filter(G=>!ne.includes(G)).forEach(G=>{let H={};s.savedAppointment&&s.savedAppointment.bookings.forEach(J=>{parseInt(J.customer.id)===parseInt(G)&&(H=J)}),Z=l.getters["appointment/getBookings"].length>1,l.getters["appointment/getBookings"].push(Object.assign({id:null,customer:P.value.find(J=>J.id===parseInt(G)),persons:1,status:ge&&"general"in ge&&"defaultAppointmentStatus"in ge.general?ge.general.defaultAppointmentStatus:o.general.defaultAppointmentStatus,duration:Object.keys(h.value.customPricing.durations)[0],extras:h.value.extras.map(J=>new Object({extraId:J.id,quantity:0})),customFields:{}},H)),l.dispatch("appointment/resetBookingCustomFields",l.getters["appointment/getBookings"].length-1),l.dispatch("appointment/addCustomFieldsFormRules",{key:l.getters["appointment/getBookings"].length-1,label:u.value.required_field}),l.commit("appointment/setBooking",{index:l.getters["appointment/getBookings"].length-1,value:l.getters["appointment/getBookings"][l.getters["appointment/getBookings"].length-1]})});let be=ne.filter(G=>!g.value.customersIds.includes(G)),q=[];l.getters["appointment/getBookings"].forEach((G,H)=>{be.indexOf(G.customer.id)!==-1&&q.push(H)});let Q=l.getters["appointment/getBookings"].length;for(let G=Q-1;G>=0;G--)q.indexOf(G)!==-1&&(Z=!0,l.dispatch("appointment/removeBooking",G));Z&&e("changedSlotCondition")}function T(){l.dispatch("customerInfo/resetCustomer"),S.value=!0}function E(ne){l.dispatch("customerInfo/resetCustomer"),l.commit("customerInfo/setLoading",!0),S.value=!0,Pe.get("/users/customers/"+ne,Object.assign({params:{source:"cabinet-provider"}},ze(l))).then(Z=>{l.commit("customerInfo/setCustomer",kr(l,Z.data.data.user))}).catch(Z=>{console.log(Z)}).finally(()=>{l.commit("customerInfo/setLoading",!1)})}function $(ne){l.dispatch("appointment/removeBooking",ne),l.dispatch("appointment/deleteAllCustomFieldsFormRules"),l.dispatch("appointment/addAllCustomFieldsFormRules",{label:u.value.required_field}),e("changedSlotCondition")}const{noShowData:R}=V("noShowData");function Y(ne,Z){return ne&&Z?"am-w-50":""}function M(ne){ne&&l.commit("appointment/setAllBookingsStatus",ne)}function K(ne,Z){l.commit("appointment/setBookingStatus",{index:ne,value:Z})}function ce(ne,Z){l.commit("appointment/setBookingPersons",{index:ne,value:Z}),e("changedSlotCondition")}function j(ne,Z){l.commit("appointment/setBookingDuration",{index:ne,value:Z}),e("changedSlotCondition")}let ie=_(()=>i.value.cabinetType==="employee"?r.value.appointments.options.customerPhone.visibility:!0),se=_(()=>i.value.cabinetType==="employee"?r.value.appointments.options.customerEmail.visibility:!0),le=V("amColors"),te=_(()=>({"--am-c-card-text":le.value.colorMainText}));return Je(()=>{if(l.getters["appointment/getId"]){let ne=l.getters["appointment/getBookings"].map(Z=>Z.customer.id);l.commit("customerInfo/setCustomersIds",ne),Ws(l,"",{limit:ne.length,customers:ne},()=>{l.commit("customerInfo/setCustomers",l.getters["customerInfo/getCustomers"].concat(l.getters["auth/getPreloadedCustomers"].filter(Z=>l.getters["customerInfo/getCustomers"].map(ge=>ge.id).indexOf(Z.id)===-1)).sort((Z,ge)=>Z.id-ge.id))})}else l.commit("customerInfo/setCustomers",l.getters["auth/getPreloadedCustomers"])}),t({customersFormRef:v}),(ne,Z)=>{const ge=vt,be=et;return c(),C("div",{class:"am-capai-cuf",style:ke(a(te))},[s.capacityWarning?(c(),U(Cr,{key:0,heading:s.capacityWarning},null,8,["heading"])):N("",!0),d("div",{class:B(["am-capai-cuf__heading",s.responsiveClass])},[I(be,{ref_key:"customersFormRef",ref:v,model:a(g),rules:a(b),class:B(["am-capai-cuf__heading-form",s.responsiveClass])},{default:L(()=>[I(ge,{prop:"customersIds",class:"am-capai-cuf__heading-form__item"},{default:L(()=>[I(Ze,{modelValue:a(g).customersIds,"onUpdate:modelValue":Z[0]||(Z[0]=q=>a(g).customersIds=q),filterable:"",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","popper-class":"am-capai-cuf__popper-customer",placeholder:`${a(u).select_customers}`,"remote-method":q=>{a(Ws)(a(l),q)},loading:a(D),onChange:k,onFocus:Z[1]||(Z[1]=q=>a(Pi)(a(l)))},{default:L(()=>[(c(!0),C(ae,null,pe(a(P),q=>(c(),U(Ue,{key:q.id,disabled:a(h)?.maxCapacity===n.appointmentCapacity&&a(g).customersIds.indexOf(q.id)===-1,value:q.id,label:q.email&&a(se)?q.email:q.firstName+" "+q.lastName},{default:L(()=>[d("div",g1,[d("div",f1,x(q.firstName+" "+q.lastName),1),a(se)&&q.email?(c(),C("div",h1,x(q.email),1)):N("",!0),a(ie)&&q.phone?(c(),C("div",_1,x(q.phone),1)):N("",!0)])]),_:2},1032,["disabled","value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"])]),_:1})]),_:1},8,["model","rules","class"]),a(o).roles.allowWriteCustomers?(c(),U(Te,{key:0,class:B(["am-capai-cuf__heading-add",s.responsiveClass]),size:"default",prefix:"plus",icon:"plus","icon-only":a(m)<=540,disabled:a(h)?.maxCapacity===n.appointmentCapacity,onClick:T},{default:L(()=>[re(x(a(u).new_customer),1)]),_:1},8,["class","icon-only","disabled"])):N("",!0)],2),d("div",v1,[a(l).getters["appointment/getBookings"].length>1?(c(),C("div",{key:0,class:B(["am-capai-cuf__bulk",s.responsiveClass])},[d("div",y1,x(a(u).change_group_status),1),I(Ze,{modelValue:a(y),"onUpdate:modelValue":Z[2]||(Z[2]=q=>we(y)?y.value=q:y=q),clearable:"",size:"small",placeholder:"Group Status","popper-class":"am-capai-cuf__popper","parent-class":`am-capai-cuf__bulk-status ${s.responsiveClass}`,"prefix-icon":a(y)?a(w).find(q=>q.value===a(y)).icon:"circle-empty","prefix-icon-color":a(y)?a(w).find(q=>q.value===a(y)).color:"var(--am-c-select-text-op40)",onChange:M},{default:L(()=>[(c(!0),C(ae,null,pe(a(w),q=>(c(),U(Ue,{key:q.value,value:q.value,label:q.label},{default:L(()=>[d("span",{class:B(`am-icon-${q.icon}`),style:ke(`color: ${q.color}`)},null,6),re(" "+x(q.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","parent-class","prefix-icon","prefix-icon-color"])],2)):N("",!0),(c(!0),C(ae,null,pe(a(A),(q,Q)=>(c(),C("div",{key:Q,class:B(["am-capai-cuf__card",s.responsiveClass])},[d("div",{class:B(["am-capai-cuf__card-info",s.responsiveClass])},[d("div",{class:B(["am-capai-customer__name",a(R)(q.customer.noShowCount).class])},[a(R)(q.customer.noShowCount).icon?(c(),C("span",{key:0,class:B(`am-icon-${a(R)(q.customer.noShowCount).icon}`)},null,2)):N("",!0),re(" "+x(q.customer.firstName+" "+q.customer.lastName),1)],2),q.customer.phone&&a(ie)?(c(),C("div",b1,[k1,d("a",{href:`tel:${q.customer.phone}`},x(q.customer.phone),9,C1)])):N("",!0),q.customer.email&&a(se)?(c(),C("div",x1,[w1,d("a",{href:`mailto:${q.customer.email}`},x(q.customer.email),9,T1)])):N("",!0)],2),d("div",{class:B(["am-capai-cuf__card-booking",s.responsiveClass])},[I(Ze,{modelValue:q.status,"onUpdate:modelValue":G=>q.status=G,"prefix-icon":a(w).find(G=>G.value===q.status).icon,"prefix-icon-color":a(w).find(G=>G.value===q.status).color,"popper-class":"am-capai-cuf__popper",size:"small",onChange:G=>K(Q,G)},{default:L(()=>[(c(!0),C(ae,null,pe(a(w),G=>(c(),U(Ue,{key:G.value,value:G.value,label:a(w).find(H=>H.value===q.status).label},{default:L(()=>[d("span",{class:B(`am-icon-${G.icon}`),style:ke(`color: ${G.color}`)},null,6),re(" "+x(G.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","prefix-icon","prefix-icon-color","onChange"]),a(h).maxCapacity>1?(c(),U(Ze,{key:0,modelValue:q.persons,"onUpdate:modelValue":G=>q.persons=G,"parent-class":`${Y(a(h).maxCapacity>1,a(h).customPricing.enabled==="duration")} ${s.responsiveClass}`,placeholder:a(u).persons,"prefix-icon":"users","prefix-icon-color":"var(--am-c-card-text)",size:"small",onChange:G=>ce(Q,G)},{default:L(()=>[(c(!0),C(ae,null,pe(a(h)?.maxCapacity,G=>(c(),U(Ue,{key:G,disabled:n.appointmentCapacity-q.persons+G>a(h)?.maxCapacity,value:G,label:G},null,8,["disabled","value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","parent-class","placeholder","onChange"])):N("",!0),a(h).customPricing.durations.enabled==="duration"?(c(),U(Ze,{key:1,modelValue:q.duration,"onUpdate:modelValue":G=>q.duration=G,"parent-class":`${Y(a(h).maxCapacity>1,a(h).customPricing.durations.enabled==="duration")} ${s.responsiveClass}`,placeholder:a(u).duration,"prefix-icon":"clock","prefix-icon-color":"var(--am-c-card-text)",size:"small",onChange:G=>j(Q,G)},{default:L(()=>[(c(!0),C(ae,null,pe(Object.keys(a(h).customPricing.durations),G=>(c(),U(Ue,{key:G,value:G,label:a(Zs)(G,a(u).h,a(u).min)},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","parent-class","placeholder","onChange"])):N("",!0)],2),I(ha,{index:Q,"reference-class":s.responsiveClass,"have-edit":a(o).roles.allowWriteCustomers,onRemove:$,onEdit:G=>E(q.customer.id)},null,8,["index","reference-class","have-edit","onEdit"])],2))),128))]),a(S)?(c(),U(xr,{key:1,visibility:a(S),"responsive-class":s.responsiveClass,"onUpdate:visibility":Z[3]||(Z[3]=q=>we(S)?S.value=q:S=q),onAddedCustomer:f},null,8,["visibility","responsive-class"])):N("",!0)],4)}}};const E1=d("span",{class:"am-icon-email"},null,-1),S1=["href"],A1=d("span",{class:"am-icon-phone"},null,-1),I1=["href"],$1={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:t}){const e=n;let s=De();const l=V("shortcodeData");let i=V("amCustomize");const o=V("settings");let r=V("amLabels"),u=O(null),m=O({}),h=_(()=>s.getters["appointment/getCustomFieldsRules"]),v=O({}),g=_(()=>s.getters["appointment/getCustomFields"]),b=_(()=>s.getters["appointment/getServiceId"]),D=_(()=>s.getters["customerInfo/getCustomersIds"]),P=O(null);function y(T,E){let $=s.getters["appointment/getBookings"][T].id;(E.type!=="file"||$)&&(m.value[`${T}cf${E.id}`]=_({get:()=>{let R=s.getters["appointment/getBookings"][T].customFields[E.id]?.value;return R||""},set:R=>s.dispatch("appointment/updateBookingCustomField",{bookingKey:T,fieldId:E.id,value:R})}))}function w(T,E){let $=s.getters["appointment/getBookings"][T].id;(E.type!=="file"||$)&&(v.value[T][E.id]={template:Ye[E.type],props:{id:E.id,itemName:`${T}cf${E.id}`,label:E.label,options:E.options,class:`am-capai-cfields__item am-cf-width-${E.width}`}}),(E.type==="checkbox"||E.type==="radio")&&(v.value[T][E.id].props.options=v.value[T][E.id].props.options.map(R=>({...R,value:R.label}))),E.type==="text-area"&&(v.value[T][E.id].props={...v.value[T][E.id].props,itemType:"textarea"}),E.type==="file"&&$&&(v.value[T][E.id].props={...v.value[T][E.id].props,btnLabel:r.value.upload_file_here,isUpload:!1,bookingId:$}),E.type==="datepicker"&&(v.value[T][E.id].props={...v.value[T][E.id].props,weekStartsFromDay:o.wordpress.startOfWeek})}function A(){m.value={},s.getters["appointment/getBookings"].forEach((T,E)=>{v.value[E]={},s.getters["appointment/getCustomFields"].forEach($=>{y(E,$),w(E,$)})})}const{noShowData:S}=V("noShowData");let f=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),k=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0);return it([b,D],()=>{A()}),Hs(()=>{A()}),Je(()=>{s.getters["appointment/getBookings"].filter(T=>T.status!=="canceled"&&T.status!=="rejected").length<2&&(P.value=0)}),t({customFieldsFormRef:u}),(T,E)=>{const $=ys,R=bs,Y=et;return c(),U(Y,{ref_key:"customFieldsFormRef",ref:u,model:a(m),rules:a(h),"label-position":"top",class:B(["am-capai-cfields am-capai-cfields__form",e.responsiveClass])},{default:L(()=>[I(R,{modelValue:a(P),"onUpdate:modelValue":E[0]||(E[0]=M=>we(P)?P.value=M:P=M),class:"am-capai-collapse",accordion:""},{default:L(()=>[(c(!0),C(ae,null,pe(a(s).getters["appointment/getBookings"].filter(M=>M.status!=="canceled"&&M.status!=="rejected"),(M,K)=>(c(),U($,{key:K,name:K,class:"am-capai-collapse__item"},{title:L(()=>[d("div",{class:B(["am-capai-customer__name",[{"am-pb-16":!(M.customer.email&&a(k)||M.customer.phone&&a(f))},a(S)(M.customer.noShowCount).class]])},[a(S)(M.customer.noShowCount).icon?(c(),C("span",{key:0,class:B(`am-icon-${a(S)(M.customer.noShowCount).icon}`)},null,2)):N("",!0),re(" "+x(M.customer.firstName+" "+M.customer.lastName),1)],2)]),default:L(()=>[M.customer.email&&a(k)||M.customer.phone&&a(f)?(c(),C("div",{key:0,class:B(["am-capai-customer__data-wrapper",e.responsiveClass])},[M.customer.email&&a(k)?(c(),C("div",{key:0,class:B(["am-capai-customer__data",e.responsiveClass])},[E1,d("a",{href:`mailto:${M.customer.email}`},x(M.customer.email),9,S1)],2)):N("",!0),M.customer.phone&&a(f)?(c(),C("div",{key:1,class:B(["am-capai-customer__data",e.responsiveClass])},[A1,d("a",{href:`tel:${M.customer.phone}`},x(M.customer.phone),9,I1)],2)):N("",!0)],2)):N("",!0),(c(!0),C(ae,null,pe(a(g),ce=>(c(),C(ae,{key:K+"_"+ce.id},[K in a(v)&&`${K}cf${ce.id}`in a(m)?(c(),U(pt(a(v)[K][ce.id].template),St({key:0,modelValue:a(m)[`${K}cf${ce.id}`],"onUpdate:modelValue":j=>a(m)[`${K}cf${ce.id}`]=j},a(v)[K][ce.id].props),null,16,["modelValue","onUpdate:modelValue"])):N("",!0)],64))),128))]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["model","rules","class"])}}};const D1={key:0,class:"am-capai-ext__heading-extra"},P1=d("span",{class:"am-icon-email"},null,-1),N1=["href"],O1=d("span",{class:"am-icon-phone"},null,-1),M1=["href"],F1={class:"am-capai-ext__wrapper"},V1={class:"am-capai-ext__inner-info"},B1={class:"am-capai-ext__inner-name"},R1={key:0,class:"am-capai-ext__inner-duration"},q1={class:"am-capai-ext__total"},U1={props:{responsiveClass:{type:String,default:""}},emits:["changedSlotCondition"],setup(n,{emit:t}){const e=n,s=De(),l=V("shortcodeData");let i=V("amCustomize"),o=V("amLabels"),r=_(()=>s.getters["appointment/getEmployeeService"]),u=_(()=>s.getters["appointment/getBookings"]),m=O(null);function h(A,S,f){A.duration&&(f.extras[S].quantity===0||f.extras[S].quantity===1)&&t("changedSlotCondition")}function v(A){return A.extras.length?A.extras.reduce((S,f)=>S+("price"in f?f.price:r.value.extras.find(k=>k.id===f.extraId).price)*f.quantity,0):0}function g(A){return A.filter(S=>S.quantity>0).length}const{noShowData:b}=V("noShowData");let D=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),P=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0),y=V("amColors"),w=_(()=>({"--am-c-ext-text-op60":W(y.value.colorMainText,.6)}));return Je(()=>{u.value.filter(A=>A.status!=="canceled"&&A.status!=="rejected").length<2&&(m.value=0)}),(A,S)=>{const f=ys,k=bs;return c(),U(k,{modelValue:a(m),"onUpdate:modelValue":S[0]||(S[0]=T=>we(m)?m.value=T:m=T),class:"am-capai-ext am-capai-collapse",accordion:"",style:ke(a(w))},{default:L(()=>[(c(!0),C(ae,null,pe(a(u).filter(T=>T.status!=="canceled"&&T.status!=="rejected"),(T,E)=>(c(),U(f,{key:E,name:E,class:"am-capai-ext__item am-capai-collapse__item"},{title:L(()=>[d("div",{class:B(["am-capai-ext__heading",{"am-pb-16":!(T.customer.email&&a(P)||T.customer.phone&&a(D))}])},[d("div",{class:B(["am-capai-customer__name",a(b)(T.customer.noShowCount).class])},[a(b)(T.customer.noShowCount).icon?(c(),C("span",{key:0,class:B(`am-icon-${a(b)(T.customer.noShowCount).icon}`)},null,2)):N("",!0),re(" "+x(T.customer.firstName+" "+T.customer.lastName),1)],2),g(T.extras)>0?(c(),C("div",D1,x(`${a(o).extras}: ${g(T.extras)}`),1)):N("",!0)],2)]),default:L(()=>[T.customer.email&&a(P)||T.customer.phone&&a(D)?(c(),C("div",{key:0,class:B(["am-capai-customer__data-wrapper",e.responsiveClass])},[T.customer.email&&a(P)?(c(),C("div",{key:0,class:B(["am-capai-customer__data",e.responsiveClass])},[P1,d("a",{href:`mailto:${T.customer.email}`},x(T.customer.email),9,N1)],2)):N("",!0),T.customer.phone&&a(D)?(c(),C("div",{key:1,class:B(["am-capai-customer__data",e.responsiveClass])},[O1,d("a",{href:`tel:${T.customer.phone}`},x(T.customer.phone),9,M1)],2)):N("",!0)],2)):N("",!0),d("div",F1,[(c(!0),C(ae,null,pe(a(r).extras,($,R)=>(c(),C("div",{key:R,class:B(["am-capai-ext__inner",[{"am-border-bottom":R!==a(r).extras.length-1},e.responsiveClass]])},[d("div",V1,[d("div",B1,x($.name),1),$.duration?(c(),C("div",R1,x(`${a(o).duration}: ${a(Zs)($.duration,a(o).h,a(o).min)}`),1)):N("",!0)]),d("div",{class:B(["am-capai-ext__inner-selection",e.responsiveClass])},[d("div",{class:B(["am-capai-ext__inner-price",e.responsiveClass])},[$.price?(c(),C(ae,{key:0},[re(x(a(tt)("price"in T.extras[R]?T.extras[R].price:$.price)),1)],64)):(c(),C(ae,{key:1},[re(x(a(o).free),1)],64))],2),I(ht,{modelValue:T.extras[R].quantity,"onUpdate:modelValue":Y=>T.extras[R].quantity=Y,class:B(e.responsiveClass),size:"small",min:0,max:$.maxQuantity,onChange:Y=>h($,R,T)},null,8,["modelValue","onUpdate:modelValue","class","max","onChange"])],2)],2))),128)),d("div",q1,x(`${a(o).subtotal}: ${a(tt)(v(T))}`),1)])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])}}};function bo(n,t){let e=me(n,"YYYY-MM-DD"),s=me(e).add(t,"M"),l=me(s).startOf("month");return e.date()!==s.date()&&s.isSame(l.format("YYYY-MM-DD"))&&s.subtract(1,"d"),s}function z1(n,t,e){let s=me(n,"YYYY-MM-DD").startOf("month").day(e);s.format("M")!==n.format("M")&&s.add(7,"days");let l=s.add(7*(t-1),"days");return n.format("M")!==l.format("M")&&l.subtract(7,"days"),l}function j1(n,t,e,s,l,i,o,r){let u=e?me(e):me().add(s,"days"),m=me(t,"YYYY-MM-DD"),h={},v=[];switch(l){case"daily":v.push(me(t,"YYYY-MM-DD"));break;case"weekly":let b=me(t,"YYYY-MM-DD").isoWeekday();o.forEach((D,P)=>{if(D.selected){let y=P+1,w=me(t,"YYYY-MM-DD");b<y?v.push(w.add(y-b,"days")):b===y?v.push(w):b>y&&v.push(w.subtract(b-y,"days"));let A=u||n;w.isSameOrBefore(A)&&w.isAfter(m)&&(h[w.format("YYYY-MM-DD")]=w)}});break;case"monthly":v.push(me(t,"YYYY-MM-DD"));break}let g=v.length>0;for(;g;)for(let b=0;b<v.length;b++){switch(l){case"daily":v[b].add(i,"days");break;case"weekly":v[b].add(i*7,"days");break;case"monthly":let D=v[b].isoWeekday();v[b]=r===0?bo(v[b].format("YYYY-MM-DD"),i):z1(bo(v[b].startOf("month").format("YYYY-MM-DD"),i),r,D);break}g=v[b].isSameOrBefore(u),g&&(h[me(v[b]).format("YYYY-MM-DD")]=me(v[b]))}return h}function Y1(n,t,e,s,l,i,o){let r=me(s,"YYYY-MM-DD"),u=i?me(i,"YYYY-MM-DD"):null,m={},h={};Al(Object.keys(t)).forEach(g=>{h[g]=me(g+" 00:00:00")});let v=me(s,"YYYY-MM-DD").format("YYYY-MM-DD");for(let g in e){let b=me(g,"YYYY-MM-DD"),D=u?b.isSameOrBefore(u):!0;if(g in t&&Object.keys(t[g]).length&&!(g in m)&&D){let P=l in t[g],y=P?l:Object.keys(t[g])[0];m[g]={isSubstituteDate:!1,isSubstituteTime:!P,time:y,times:Object.keys(t[g]),slot:t[g][y]}}else if(g!==v&&!(g in m)&&D){let P=null,y=null;for(let f in h)if((n.recurringSub==="past"||n.recurringSub==="both")&&h[f].isBefore(e[g])&&h[f].isAfter(r)&&f!==g&&!(f in m)&&(P=h[f]),(n.recurringSub==="future"||n.recurringSub==="both")&&h[f].isAfter(e[g])&&f!==g&&!(f in m)){y=h[f];break}let w=P!==null?me(e[g]).diff(P,"days"):null,A=y!==null?me(y).diff(e[g],"days"):null,S=null;if(w&&A?S=w<A?P:y:w?S=P:A&&(S=y),S!==null&&(u?me(S).isSameOrBefore(u):!0)){let f=me(S).format("YYYY-MM-DD");if(f in t&&!(g in m)&&!(f in e)){let k=l in t[f],T=k?l:Object.keys(t[f])[0];m[f]={isSubstituteDate:!0,isSubstituteTime:!k,time:T,times:Object.keys(t[f]),slot:t[f][T]}}}}if(u?!D:Al(Object.keys(m)).length>=o)break}return m}const W1={class:"am-fs__rs-every"},H1={key:1},Z1={class:"am-fs__rs-on-week"},G1=["onClick"],J1={key:2},X1={class:"am-fs__rs-on-month"},Q1={class:"am-fs__rs-ends"},K1={class:"am-fs__rs-ends-choose"},ey={class:"am-fs__rs-ends-options"},ty={class:"am-fs__rs-ends-after"},ay={class:"am-fs__rs-summary"},sy={key:0},ly={key:1},ny={key:0},iy=re(", "),oy={key:0},ry={key:1},cy={name:"RecurringSetup"},uy=Object.assign(cy,{props:{service:{type:Object,default:()=>{}},startDate:{type:String,default:""},startTime:{type:String,default:""},maxDate:{type:String,default:""},globalClass:{type:String,default:""}},setup(n){const t=n;let e=V("amLabels"),s=V("amCustomize"),l=De(),i=V("containerWidth",0),o=_(()=>i.value<560||i.value-240<520),r=_({get:()=>l.getters["recurring/getRepeatType"],set:T=>{l.commit("recurring/setRepeatType",T)}}),u=_({get:()=>l.getters["recurring/getRepeatInterval"],set:T=>{l.commit("recurring/setRepeatInterval",T)}}),m=_({get:()=>l.getters["recurring/getOccurrenceType"],set:T=>{l.commit("recurring/setOccurrenceType",T)}}),h=_({get:()=>l.getters["recurring/getOccurrenceDate"]?l.getters["recurring/getOccurrenceDate"]:new Date(t.startDate),set:T=>{l.commit("recurring/setOccurrenceDate",T)}}),v=_({get:()=>l.getters["recurring/getOccurrenceCount"],set:T=>{l.commit("recurring/setOccurrenceCount",T)}}),g=_({get:()=>l.getters["recurring/getMonthly"],set:T=>{l.commit("recurring/setMonthly",T)}});const b=O([{label:e.value.recurrence_day,labelPlural:e.value.recurrence_days,value:"daily"},{label:e.value.recurrence_week,labelPlural:e.value.recurrence_weeks,value:"weekly"},{label:e.value.recurrence_month,labelPlural:e.value.recurrence_months,value:"monthly"}]),D=O([{label:e.value.recurrence_specific_date,value:0},{label:e.value.recurrence_first,value:1},{label:e.value.recurrence_second,value:2},{label:e.value.recurrence_third,value:3},{label:e.value.recurrence_fourth,value:4},{label:e.value.recurrence_last,value:5}]);let P=O(me(t.startDate).format("dddd").toLowerCase()),y=O([{label:"Mon",labelFull:"Monday",value:"monday",selected:!1},{label:"Tue",labelFull:"Tuesday",value:"tuesday",selected:!1},{label:"Wed",labelFull:"Wednesday",value:"wednesday",selected:!1},{label:"Thu",labelFull:"Thursday",value:"thursday",selected:!1},{label:"Fri",labelFull:"Friday",value:"friday",selected:!1},{label:"Sat",labelFull:"Saturday",value:"saturday",selected:!1},{label:"Sun",labelFull:"Sunday",value:"sunday",selected:!1}]),w=_(()=>y.value.find(T=>T.value===me(t.startDate,"YYYY-MM-DD").format("dddd").toLowerCase()).labelFull);function A(T){h.value=me(T,"YYYY-MM-DD").toDate()}function S(T,E=!1){let $=y.value.find(R=>R.value===T);$.selected=E?!0:!$.selected,l.commit("recurring/setDays",{value:T,selected:$.selected})}Je(()=>{wl&&(y.value=y.value.map((E,$)=>({...E,label:Gr[$],labelFull:Jr[$]})));let T=l.getters["recurring/getDays"].filter(E=>E.selected);T.length===0?S(y.value.find(E=>P.value&&E.value===P.value).value,!0):T.forEach(E=>{S(E.value,!0)}),t.service.recurringCycle!=="all"&&l.commit("recurring/setRepeatType",t.service.recurringCycle)});let f=V("amColors"),k=_(()=>({"--am-c-rs-text":f.value.colorMainText,"--am-c-rs-text-op60":W(f.value.colorMainText,.6),"--am-c-rs-bgr":f.value.colorMainBgr,"--am-c-rs-primary":f.value.colorPrimary,"--am-c-rs-inp-border":f.value.colorInpBorder}));return(T,E)=>(c(),C("div",{class:B(["am-fs__rs",[{"am-fs__rs-mobile":a(o)},a(t).globalClass]]),style:ke(a(k))},[a(s)&&a(s).recurringStep&&a(s).recurringStep.options.heading.visibility?(c(),C(ae,{key:0},[d("p",null,x(a(e).recurrence),1),d("span",null,x(a(e).recurrence_choosing_time),1)],64)):N("",!0),d("p",null,x(a(e).repeat_every)+":",1),d("div",W1,[I(a(ht),{modelValue:a(u),"onUpdate:modelValue":E[0]||(E[0]=$=>we(u)?u.value=$:u=$),min:1,max:100},null,8,["modelValue"]),I(a(Ze),{modelValue:a(r),"onUpdate:modelValue":E[1]||(E[1]=$=>we(r)?r.value=$:r=$),disabled:a(t).service.recurringCycle!=="all"},{default:L(()=>[(c(!0),C(ae,null,pe(b.value,($,R)=>(c(),U(a(Ue),{key:R,label:$.label,value:$.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled"])]),a(r)==="weekly"?(c(),C("div",H1,[d("p",null,x(`${a(e).recurrence_repeat_on}:`),1),d("div",Z1,[(c(!0),C(ae,null,pe(a(y),($,R)=>(c(),C("div",{key:R,class:B({"am-fs__rs-on-week-selected":a(y).find(Y=>Y.value===$.value).selected}),onClick:Y=>S($.value)},x($.label),11,G1))),128))])])):N("",!0),a(r)==="monthly"?(c(),C("div",J1,[d("p",null,x(`${a(e).recurrence_repeat_on}:`),1),d("div",X1,[I(a(Ze),{modelValue:a(g),"onUpdate:modelValue":E[2]||(E[2]=$=>we(g)?g.value=$:g=$)},{default:L(()=>[(c(!0),C(ae,null,pe(D.value,($,R)=>(c(),U(a(Ue),{key:R,label:$.label+(R!==0?" "+a(w):""),value:$.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])])])):N("",!0),d("p",null,x(`${a(e).recurrence_ends}:`),1),d("span",null,x(a(e).recurrence_choose_ends),1),d("div",Q1,[d("div",K1,[I(a(Rl),{modelValue:a(m),"onUpdate:modelValue":E[3]||(E[3]=$=>we(m)?m.value=$:m=$)},{default:L(()=>[I(a(Sa),{value:"On"},{default:L(()=>[re(x(a(e).recurrence_on),1)]),_:1}),I(a(Sa),{value:"After"},{default:L(()=>[re(x(a(e).recurrence_after),1)]),_:1})]),_:1},8,["modelValue"])]),d("div",ey,[I(a(Xr),{"calendar-minimum-date":a(t).startDate,disabled:a(m)!=="On","input-placeholder":a(e).recurrence_select_date,"calendar-maximum-date":a(t).maxDate,onSelectedDate:A},null,8,["calendar-minimum-date","disabled","input-placeholder","calendar-maximum-date"]),d("div",ty,[I(a(ht),{modelValue:a(v),"onUpdate:modelValue":E[4]||(E[4]=$=>we(v)?v.value=$:v=$),disabled:a(m)!=="After",min:1,max:100},null,8,["modelValue","disabled"]),d("span",null,x(` ${a(e).occurrences}`),1)])])]),d("div",ay,[d("p",null,x(`${a(e).appointment_repeats}:`),1),d("p",null,[re(x(`${a(e).recurrence_every} ${a(u)>1?a(u):""} ${b.value.find($=>$.value===a(r))?b.value.find($=>$.value===a(r)).label:""}`)+" ",1),a(r)==="weekly"?(c(),C("span",sy,x(`${a(e).repeats_on} ${a(y).filter($=>$.selected).map($=>$.labelFull).join(", ")}`),1)):N("",!0),a(r)==="monthly"?(c(),C("span",ly,[re(x(` ${a(e).repeats_on} ${D.value[a(g)].label}`)+" ",1),a(g)!==0?(c(),C("span",ny,x(` ${a(w)}`),1)):N("",!0),iy])):N("",!0),d("span",null,x(` ${a(e).repeats_from} ${a(ot)(a(t).startDate)} ${a(e).repeats_at} ${a(qs)(a(t).startTime)}`),1)]),d("p",null,[a(m)==="After"?(c(),C("span",oy,x(a(e).number_of_recurrences)+" "+x(` ${a(v)}`),1)):a(h)?(c(),C("span",ry,x(a(e).ends_on)+" "+x(` ${a(ot)(a(Qr)(a(h)))}`),1)):N("",!0)])])],6))}});const dy={class:"am-capai-recurr__enable"},my={key:0,class:"am-capai-recurr__content"},py={key:1,class:"am-capai-recurr__list"},gy={class:"am-capai-recurr__list-heading"},fy={class:"am-capai-recurr__list-heading__text"},hy=d("span",{class:"am-icon-refresh"},null,-1),_y={class:"am-capai-recurr__table"},vy={key:2,class:"am-capai-recurr__actions"},yy={props:{responsiveClass:{type:String,default:""},maximumBookingStartDate:{type:String,required:!0},slotsLoading:{type:Boolean,required:!0},slotsProps:{type:Object,required:!0},freeSlots:{type:Object,required:!0},getFreeTimes:{type:Function,required:!0},isDisabledDate:{type:Function,required:!0},getSelectedDatesTimes:{type:Function,required:!0}},emits:["fetchSlots"],setup(n,{emit:t}){const e=n,s=De(),l=V("settings");let i=V("amLabels"),o=V("localLanguage"),r=_(()=>s.getters["appointment/getEmployeeService"]),u=O(!1),m=O(2),h=O(!1),v=V("recurringList"),g=O(!0);function b(){let E=s.getters["recurring/getOccurrenceType"]==="On"?Ke(s.getters["recurring/getOccurrenceDate"]).format("YYYY-MM-DD"):null,$=j1(e.maximumBookingStartDate,Ke(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),E,l.general.numberOfDaysAvailableForBooking,s.getters["recurring/getRepeatType"],s.getters["recurring/getRepeatInterval"],s.getters["recurring/getDays"],s.getters["recurring/getMonthly"]);m.value=s.getters["recurring/getOccurrenceType"]==="On"?Object.keys($).length:s.getters["recurring/getOccurrenceCount"],h.value=!0;let R=Al(Object.keys($));Ao(Object.assign({startDateTime:Ke(s.getters["appointment/getStartDate"]).startOf("month").subtract(6,"days").format("YYYY-MM-DD"),endDateTime:R.length?Ke(R[R.length-1]).endOf("month").add(11,"days").format("YYYY-MM-DD"):Ke().add(l.general.numberOfDaysAvailableForBooking,"days").format("YYYY-MM-DD")},e.slotsProps),null,Y=>{let M=Y1(r.value,Y,$,Ke(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),s.getters["appointment/getStartTime"],E,s.getters["recurring/getOccurrenceType"]==="After"?s.getters["recurring/getOccurrenceCount"]:null);v.value=[],Object.keys(M).forEach(K=>{v.value.push(Object.assign({date:Ke(K).toDate(),editing:!1},M[K]))}),h.value=!1})}function D(){v.value=null}function P(E){let $=Ke(v.value[E].date).format("YYYY-MM-DD");v.value[E].times=Object.keys(e.freeSlots[$]);let R=e.getSelectedDatesTimes(E,!1);$ in R&&v.value[E].time in R[$]&&(v.value[E].time="")}function y(E){v.value.splice(E,1)}function w(E){v.value[E].editing=!0}function A(E){v.value[E].editing=!1}let S=O(null);function f(E,$,R=!1){!E&&!S.value?E=Ke().toDate():!E&&S.value&&(E=S.value),S.value=E&&R?E:S.value,t("fetchSlots",E,$,R)}let k=V("amColors"),T=_(()=>({"--am-c-recurr-bgr-op05":W(k.value.colorPrimary,.05),"--am-c-warning-op10":W(k.value.colorWarning,.1),"--am-c-main-text-op10":W(k.value.colorMainText,.1)}));return it(u,E=>{E||(v.value=null)}),(E,$)=>(c(),C("div",{class:"am-capai-recurr",style:ke(a(T))},[d("div",dy,[I(dt,{modelValue:a(u),"onUpdate:modelValue":$[0]||($[0]=R=>we(u)?u.value=R:u=R),label:"Enable Recurring appointment"},null,8,["modelValue"])]),a(u)?(c(),C("div",my,[!a(h)&&!a(v)?(c(),U(uy,{key:0,"start-date":a(Ke)(a(s).getters["appointment/getStartDate"]).format("YYYY-MM-DD"),"start-time":a(s).getters["appointment/getStartTime"],"max-date":a(e).maximumBookingStartDate,service:a(r)},null,8,["start-date","start-time","max-date","service"])):(c(),C(ae,{key:1},[a(v)?(c(),C("div",py,[d("div",gy,[d("div",fy,[hy,d("div",null,x(`${a(v).length} appointments total`),1)]),d("div",{class:"am-capai-recurr__list-heading__action",onClick:$[1]||($[1]=()=>{we(g)?g.value=!a(g):g=!a(g)})},x(a(g)?a(i).show_less:a(i).show_more),1)]),a(g)?(c(),C(ae,{key:0},[a(v).filter(R=>R.isSubstituteDate||R.isSubstituteTime).length?(c(),U(Cr,{key:0,heading:a(i).recurring_unavailable_slots,text:a(i).recurring_sub_message1},null,8,["heading","text"])):N("",!0),d("div",_y,[(c(!0),C(ae,null,pe(a(v),(R,Y)=>(c(),C("div",{key:Y,class:B(["am-capai-recurr__row",[{"am-warn":R.isSubstituteDate||R.isSubstituteTime},a(e).responsiveClass]])},[d("div",{class:B(["am-capai-recurr__row-num",a(e).responsiveClass])},x(Y+1),3),d("div",{class:B(["am-capai-recurr__row-date",[{"am-disable":!R.editing},a(e).responsiveClass]])},[I(Yt,{modelValue:R.date,"onUpdate:modelValue":M=>R.date=M,type:"date",format:a(jt)(),placeholder:"Pick a day",size:"small",lang:a(o),"disabled-date":(M,K)=>a(e).isDisabledDate(M,R.editing,!1,K),"popper-class":a(e).slotsLoading?"slots-loader":"",onPanelChange:M=>{f(M,Y,!0)},onChange:M=>P(Y),onFocus:M=>f(R.date,Y,!0)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date","popper-class","onPanelChange","onChange","onFocus"])],2),d("div",{class:B(["am-capai-recurr__row-time",[{"am-disable":!R.editing},a(e).responsiveClass]])},[I(Ze,{modelValue:R.time,"onUpdate:modelValue":M=>R.time=M,size:"small",placeholder:`${a(i).select_time}`,disabled:!R.date},{default:L(()=>[(c(!0),C(ae,null,pe(R.editing?a(e).getFreeTimes(Y,a(v)[Y],!1):a(v)[Y].times,M=>(c(),U(Ue,{key:M,value:M,label:M},null,8,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])],2),d("div",{class:B(["am-capai-recurr__row-actions",a(e).responsiveClass])},[R.editing?(c(),U(Te,{key:1,category:"primary",size:"small",onClick:M=>A(Y)},{default:L(()=>[re(x(a(i).save),1)]),_:2},1032,["onClick"])):(c(),U(ha,{key:0,index:Y,onRemove:y,onEdit:w},null,8,["index"]))],2)],2))),128))])],64)):N("",!0)])):(c(),U(Wt,{key:0,count:a(m)},null,8,["count"]))],64)),a(h)?N("",!0):(c(),C("div",vy,[a(v)?N("",!0):(c(),U(Te,{key:0,category:"primary",size:"medium",onClick:$[2]||($[2]=R=>b())},{default:L(()=>[re(x(a(i).recurring_list),1)]),_:1})),a(v)?(c(),U(Te,{key:1,category:"secondary",type:"plain",size:"medium",onClick:$[3]||($[3]=R=>D())},{default:L(()=>[re(x(a(i).recurring_settings),1)]),_:1})):N("",!0)]))])):N("",!0)],4))}};const by=d("span",{class:"am-icon-email"},null,-1),ky=["href"],Cy=d("span",{class:"am-icon-phone"},null,-1),xy=["href"],wy={class:"am-capai-linked__list"},Ty={class:"am-capai-linked__list-index"},Ly={class:"am-capai-linked__list-date"},Ey=d("span",{class:"am-icon-calendar"},null,-1),Sy={class:"am-capai-linked__list-action"},Ay={props:{responsiveClass:{type:String,default:""},linkedAppointments:{type:Array,required:!0}},emits:["editLinkedAppointment"],setup(n,{emit:t}){const e=n;let s=De();const l=V("shortcodeData");let i=V("amCustomize"),o=O(null);function r(P){return e.linkedAppointments.filter(y=>y.bookings.filter(w=>parseInt(w.customer.id)===parseInt(P.customer.id)).length)}const{noShowData:u}=V("noShowData");let m=V("amLabels");function h(P){s.commit("appointment/resetAppointment",{providerId:s.getters["auth/getProfile"].id}),s.commit("customerInfo/setCustomers",[]),s.commit("customerInfo/setCustomersIds",[]),t("editLinkedAppointment",P)}let v=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerPhone.visibility:!0),g=_(()=>l.value.cabinetType==="employee"?i.value.appointments.options.customerEmail.visibility:!0),b=V("amColors"),D=_(()=>({"--am-c-linked-bgr-op05":W(b.value.colorMainText,.05)}));return Je(()=>{s.getters["appointment/getBookings"].filter(P=>P.status!=="canceled"&&P.status!=="rejected").length<2&&(o.value=0)}),(P,y)=>{const w=ys,A=bs;return c(),U(A,{modelValue:a(o),"onUpdate:modelValue":y[0]||(y[0]=S=>we(o)?o.value=S:o=S),class:"am-capai-collapse am-capai-linked",accordion:"",style:ke(a(D))},{default:L(()=>[(c(!0),C(ae,null,pe(a(s).getters["appointment/getBookings"],(S,f)=>(c(),C(ae,{key:f},[r(S).length?(c(),U(w,{key:0,name:f,class:"am-capai-collapse__item"},{title:L(()=>[d("div",{class:B(["am-capai-customer__name",[{"am-pb-16":!(S.customer.email&&a(g)||S.customer.phone&&a(v))},a(u)(S.customer.noShowCount).class]])},[a(u)(S.customer.noShowCount).icon?(c(),C("span",{key:0,class:B(`am-icon-${a(u)(S.customer.noShowCount).icon}`)},null,2)):N("",!0),re(" "+x(S.customer.firstName+" "+S.customer.lastName),1)],2)]),default:L(()=>[S.customer.email&&a(g)||S.customer.phone&&a(v)?(c(),C("div",{key:0,class:B(["am-capai-customer__data-wrapper",a(e).responsiveClass])},[S.customer.email&&a(g)?(c(),C("div",{key:0,class:B(["am-capai-customer__data",a(e).responsiveClass])},[by,d("a",{href:`mailto:${S.customer.email}`},x(S.customer.email),9,ky)],2)):N("",!0),S.customer.phone&&a(v)?(c(),C("div",{key:1,class:B(["am-capai-customer__data",a(e).responsiveClass])},[Cy,d("a",{href:`tel:${S.customer.phone}`},x(S.customer.phone),9,xy)],2)):N("",!0)],2)):N("",!0),d("div",wy,[(c(!0),C(ae,null,pe(r(S),(k,T)=>(c(),C("div",{key:S.id+"-"+T,class:B(["am-capai-linked__list-item",a(e).responsiveClass])},[d("div",Ty,x(T+1),1),d("div",Ly,[Ey,re(" "+x(a(Kr)(k.bookingStart)),1)]),d("div",Sy,[I(Te,{category:"primary",size:"small",onClick:E=>h(k)},{default:L(()=>[re(x(a(m).edit),1)]),_:2},1032,["onClick"])])],2))),128))])]),_:2},1032,["name"])):N("",!0)],64))),128))]),_:1},8,["modelValue","style"])}}},Vs=Qe(window.wpAmeliaLabels);function wr(n){if(n.gateway==="onSite")return Vs.on_site;if(n.gateway==="wc")return n.gatewayTitle;if(n.gateway)return n.gateway.charAt(0).toUpperCase()+n.gateway.slice(1)}function ri(n){switch(n){case"paid":return Vs.paid;case"pending":return Vs.pending;case"partiallyPaid":return Vs.partially_paid;case"refunded":return Vs.refunded}}function ms(n,t){switch(n){case"paid":return{icon:"am-icon-checkmark-circle",color:t.colorSuccess};case"pending":return{icon:"am-icon-refresh",color:t.colorWarning};case"partiallyPaid":return{icon:"am-icon-prepaid",color:t.colorPrimary};case"refunded":return{icon:"am-icon-refund",color:t.colorError}}}const Iy={class:"am-capai-pay__heading-status"},$y={class:"am-capai-pay__heading-status__text"},Dy=d("span",{class:"am-icon-email"},null,-1),Py=["href"],Ny=d("span",{class:"am-icon-phone"},null,-1),Oy=["href"],My={class:"am-capai-pay__row-label"},Fy={class:"am-capai-pay__row-value"},Vy={class:"am-capai-pay__row-label"},By={class:"am-capai-pay__row-value"},Ry={class:"am-capai-pay__row-label"},qy={class:"am-capai-pay__row-value"},Uy={key:0,class:"am-divider"},zy={class:"am-capai-pay__row-label"},jy={class:"am-capai-pay__row-label"},Yy={class:"am-capai-pay__row-label"},Wy={class:"am-capai-pay__row-label"},Hy={class:"am-capai-pay__row-label"},Zy={class:"am-capai-pay__row-label"},Gy={class:"am-capai-pay__row-label"},Jy={class:"am-capai-pay__row-label"},Xy={class:"am-capai-pay__row-label"},Qy={class:"am-capai-pay__row-label"},Ky={class:"am-capai-pay__row-label"},eb={props:{responsiveClass:{type:String,default:""},savedAppointment:{type:Object,default:()=>{}}},setup(n){const t=n;let e=De();const s=V("shortcodeData");let l=V("amCustomize"),i=V("pageWidth"),o=V("amLabels"),r=_(()=>s.value.cabinetType==="employee"?l.value.appointments.options.customerPhone.visibility:!0),u=_(()=>s.value.cabinetType==="employee"?l.value.appointments.options.customerEmail.visibility:!0),m=O(null),h=_(()=>e.getters["appointment/getEmployeeService"]),v=_(()=>e.getters["appointment/getBookings"].filter(y=>"id"in y&&y.id&&y.status!=="canceled"&&y.status!=="rejected")),g=_(()=>{let y=[];return v.value.forEach((w,A)=>{let S=ec(e.getters["appointment/getAppointmentData"],t.savedAppointment,w,h.value);y.push(gi(e,{price:S?tc(h.value,w.persons,w.duration):w.price,persons:w.persons,aggregatedPrice:w.aggregatedPrice,extras:w.extras.filter(f=>"id"in f&&f.id),serviceId:e.getters["appointment/getServiceId"],tax:w.tax,coupon:w.coupon,wcTax:w.payments.filter(f=>f.wcOrderId&&f.wcItemTaxValue).reduce((f,k)=>f+k.wcItemTaxValue,0)},!1)),y[A].deposit=w.payments.length&&(w.payments[0].status==="paid"||w.payments[0].status==="partiallyPaid")?w.payments[0].amount:0,y[A].paid=w.payments.filter(f=>f.status==="paid"||f.status==="partiallyPaid").reduce((f,k)=>f+k.amount,0),y[A].refunded=w.payments.filter(f=>f.status==="refunded").reduce((f,k)=>f+k.amount,0),y[A].status=w.payments.reduce((f,k)=>f+k.amount,0),w.payments.filter(f=>f.status!=="refunded").length===0?y[A].status="refunded":y[A].paid-(y[A].total-y[A].discount+y[A].tax+y[A].wcTax)===0?y[A].status="paid":y[A].paid?y[A].status="partiallyPaid":y[A].status="pending"}),y});const{noShowData:b}=V("noShowData");let D=V("amColors"),P=_(()=>({"--am-c-pay-text-op03":W(D.value.colorMainText,.03)}));return Je(()=>{e.getters["appointment/getBookings"].filter(y=>y.status!=="canceled"&&y.status!=="rejected").length<2&&(m.value=0)}),(y,w)=>{const A=ys,S=bs;return c(),U(S,{modelValue:a(m),"onUpdate:modelValue":w[0]||(w[0]=f=>we(m)?m.value=f:m=f),class:"am-capai-collapse am-capai-pay",accordion:"",style:ke(a(P))},{default:L(()=>[(c(!0),C(ae,null,pe(a(v),(f,k)=>(c(),U(A,{key:k,name:k,class:"am-capai-collapse__item"},{title:L(()=>[d("div",{class:B(["am-capai-pay__heading",{"am-pb-16":!(f.customer.email&&a(u)||f.customer.phone&&a(r))}])},[d("div",{class:B(["am-capai-customer__name",a(b)(f.customer.noShowCount).class])},[a(b)(f.customer.noShowCount).icon?(c(),C("span",{key:0,class:B(`am-icon-${a(b)(f.customer.noShowCount).icon}`)},null,2)):N("",!0),re(" "+x(f.customer.firstName+" "+f.customer.lastName),1)],2),d("div",Iy,[d("span",{class:B(a(ms)(a(g)[k].status,a(D)).icon),style:ke({color:a(ms)(a(g)[k].status,a(D)).color})},null,6),d("div",$y,x(a(ri)(a(g)[k].status)),1)])],2)]),default:L(()=>[f.customer.email&&a(u)||f.customer.phone&&a(r)?(c(),C("div",{key:0,class:B(["am-capai-customer__data-wrapper",a(t).responsiveClass])},[f.customer.email&&a(u)?(c(),C("div",{key:0,class:B(["am-capai-customer__data",a(t).responsiveClass])},[Dy,d("a",{href:`mailto:${f.customer.email}`},x(f.customer.email),9,Py)],2)):N("",!0),f.customer.phone&&a(r)?(c(),C("div",{key:1,class:B(["am-capai-customer__data",a(t).responsiveClass])},[Ny,d("a",{href:`tel:${f.customer.phone}`},x(f.customer.phone),9,Oy)],2)):N("",!0)],2)):N("",!0),d("div",{class:B(["am-capai-pay__content",a(t).responsiveClass])},[(c(!0),C(ae,null,pe(f.payments,(T,E)=>(c(),C(ae,{key:E},[d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",My,x(a(o).date),1),d("div",Fy,x(a(ot)(T.dateTime.split(" ")[0])),1)],2),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Vy,x(a(o).payment_method),1),d("div",By,x(a(wr)(T)),1)],2),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Ry,x(a(o).status),1),d("div",qy,[d("span",{class:B(a(ms)(T.status,a(D)).icon),style:ke({color:a(ms)(T.status,a(D)).color})},null,6),re(" "+x(a(ri)(T.status)),1)])],2)],64))),128)),a(i)>480?(c(),C("div",Uy)):N("",!0),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",zy,x(a(o).price),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].bookable)),3)],2),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",jy,x(a(o).extras),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].total-a(g)[k].bookable)),3)],2),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Yy,x(a(o).subtotal),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].total)),3)],2),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Wy,x(a(o).discount_amount),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].discount)),3)],2),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Hy,x(a(o).tax),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].tax)),3)],2),a(g)[k].wcTax?(c(),C("div",{key:1,class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Zy,x(a(o).tax)+" (Woo) ",1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].wcTax)),3)],2)):N("",!0),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Gy,x(a(o).paid_deposit),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].deposit)),3)],2),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Jy,x(a(o).paid_remaining_amount),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].paid?a(g)[k].paid-a(g)[k].deposit:0)),3)],2),a(g)[k].refunded?(c(),C("div",{key:2,class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Xy,x(a(o).refunded),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].refunded)),3)],2)):N("",!0),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Qy,x(a(o).due),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].paid-(a(g)[k].total-a(g)[k].discount+a(g)[k].tax+a(g)[k].wcTax))),3)],2),d("div",{class:B(["am-capai-pay__row",a(t).responsiveClass])},[d("div",Ky,x(a(o).total),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":a(i)>480}])},x(a(tt)(a(g)[k].total-a(g)[k].discount+a(g)[k].tax+a(g)[k].wcTax)),3)],2)],2)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","style"])}}};const tb={class:"am-capai__footer"},ab={name:"CabinetAppointment"},sb=Object.assign(ab,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number},linkedAppointments:{type:Array,default:()=>[]}},emits:["close","save","editLinkedAppointment"],setup(n,{emit:t}){const e=n;let s=De(),l=V("amLabels");V("settings");const i=O("details"),o=O(null);let r=_(()=>s.getters["appointment/getEmployeeService"]),u=O(null),m=O(""),h=_(()=>s.getters["appointment/getBookings"].length?s.getters["appointment/getBookings"].filter(q=>q.status==="approved"||q.status==="pending").map(q=>q.persons).reduce((q,Q)=>q+Q,0):0),v=O(null),g=_(()=>s.getters["appointment/getCustomFields"]),b=O(null);Re("recurringList",b);function D(q,Q){let G=me(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD"),H={};return s.getters["appointment/getStartDate"]&&s.getters["appointment/getStartTime"]&&!Q&&(H[G]={},H[G][s.getters["appointment/getStartTime"]]=!0),b.value&&b.value.forEach((J,X)=>{if(J.time&&(q!==null?X!==q:!0)){let ve=me(J.date).format("YYYY-MM-DD");ve in H||(H[ve]={}),H[ve][J.time]=!0}}),H}function P(q,Q,G){if(Q.date===null)return[];let H=me(Q.date).format("YYYY-MM-DD"),J=D(q,G),X=Q.time?Bt(Q.time):null;if(H in J){let ve=Q.times.filter(_e=>!Object.keys(J[H]).includes(_e)),ye=[];return ve.forEach(_e=>{let Se=Bt(_e),Oe=!0;Object.keys(J[H]).map(fe=>Bt(fe)).sort((fe,Le)=>fe-Le).forEach(fe=>{Se<fe?Se+r.value.duration+r.value.timeAfter>fe&&(Oe=!1):fe+r.value.duration+r.value.timeAfter>Se&&(Oe=!1)}),Oe&&(X!==null&&Se>X&&ye.indexOf(Q.time)===-1&&ye.push(Q.time),ye.push(_e))}),y(H,J,ye)}return y(H,J,Q.times)}function y(q,Q,G){let H=[],J=!1,X=me(q,"YYYY-MM-DD").subtract(1,"days").format("YYYY-MM-DD");if(X in Q){let ye=Object.keys(Q[X]).map(Se=>Bt(Se)).sort((Se,Oe)=>Se-Oe),_e=ye[ye.length-1]+r.value.duration+r.value.timeAfter;_e>86400&&(G.forEach(Se=>{_e-86400<=Bt(Se)&&H.push(Se)}),G=H,J=!0)}let ve=me(q,"YYYY-MM-DD").add(1,"days").format("YYYY-MM-DD");if(ve in Q){let ye=Object.keys(Q[ve]).map(_e=>Bt(_e)).sort((_e,Se)=>_e-Se);ye[0]-r.value.duration-r.value.timeAfter<0&&(G.forEach(_e=>{let Se=Bt(_e);(Se+r.value.duration+r.value.timeAfter<=86400||ye[0]>=Se+r.value.duration+r.value.timeAfter-86400)&&H.push(_e)}),J=!0)}return J?H:G}let w=O(""),A=O({}),S=O([]);function f(q){S.value=Object.keys(A.value[me(q).format("YYYY-MM-DD")])}function k(q){let Q=A.value[me(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD")][q][0][1];Q&&s.commit("appointment/setLocationId",Q)}function T(q,Q,G,H){let J=me(q).format("YYYY-MM-DD");return typeof H>"u"&&!(J in A.value&&(Q?P(null,{date:q,times:Object.keys(A.value[J])},G).length:!0))}let E=O(!1),$=_(()=>{let q={};return s.getters["appointment/getBookings"].filter(Q=>Q.status==="pending"||Q.status==="approved").forEach(Q=>{Q.extras.forEach(G=>{G.quantity&&!(G.extraId in q)&&(q[G.extraId]={id:G.extraId,quantity:G.quantity})})}),{serviceId:s.getters["appointment/getServiceId"],serviceDuration:Math.max.apply(Math,s.getters["appointment/getBookings"].filter(Q=>Q.status!=="canceled"&&Q.status!=="rejected").map(Q=>Q.duration)),providerIds:s.getters["appointment/getProviderId"]?[s.getters["appointment/getProviderId"]]:[],locationId:s.getters["appointment/getLocationId"],extras:JSON.stringify(Object.values(q)),persons:h.value?h.value:1,excludeAppointmentId:s.getters["appointment/getId"],group:s.getters["appointment/getId"]?0:1,timeZone:s.getters["cabinet/getTimeZone"],monthsLoad:1,page:"appointments"}});function R(q=!1){s.getters["appointment/getStartDate"]&&Y(s.getters["appointment/getStartDate"],null,!1,q)}function Y(q,Q=null,G=!1,H=!1){s.getters["appointment/getServiceId"]&&(E.value=!0,Ao(Object.assign({startDateTime:q?me(q).startOf("month").subtract(6,"days").format("YYYY-MM-DD"):null,endDateTime:q?me(q).endOf("month").add(6,"days").format("YYYY-MM-DD"):null},$.value),{},(J,X,ve,ye)=>{if(w.value=ye,s.getters["appointment/getStartDate"]&&Q===null&&!G){let _e=me(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD");_e in J?(s.getters["appointment/getStartTime"]&&!(s.getters["appointment/getStartTime"]in J[_e])&&!H&&s.commit("appointment/setStartTime",null),S.value=Object.keys(J[_e]),A.value=J):H||(A.value={},s.commit("appointment/setStartTime",null),s.commit("appointment/setStartDate",null),s.commit("appointment/setTargetedDate",null),S.value=[])}else A.value=J;E.value=!1},()=>{}))}function M(){A.value={},w.value=null,b.value=null}function K(q){if(q){if(q===1)return{class:"am-no-show-1",icon:"no-show-1"};if(q===2)return{class:"am-no-show-2",icon:"no-show-2"};if(q>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}Re("noShowData",{noShowData:K});let ce=O(!1),j=O("");function ie(){ce.value=!1,j.value=""}let se=O(!1),le=O(null);function te(){const q=new Promise(H=>{v.value?.customFieldsFormRef?v.value.customFieldsFormRef.validate(J=>{J?H(!0):(i.value="customFields",H(!1))}):H(!0)}),Q=new Promise(H=>{u.value?.customersFormRef?u.value.customersFormRef.validate(J=>{!J||!s.getters["customerInfo/getCustomersIds"].length?(i.value="customers",H(!1)):H(!0)}):H(!0)}),G=new Promise(H=>{o.value?.detailsFormRef?o.value.detailsFormRef.validate(J=>{!J||!s.getters["appointment/getServiceId"]||!s.getters["appointment/getStartDate"]||!s.getters["appointment/getStartTime"]?(i.value="details",H(!1)):H(!0)}):H(!0)});Promise.all([q,Q,G]).then(H=>{if(!H.includes(!1)){if(m.value=s.getters["appointment/getBookings"].filter(J=>J.status!=="canceled"&&J.status!=="rejected").map(J=>J.persons).reduce((J,X)=>J+X,0)>r.value.maxCapacity?l.value.select_max_customer_count_warning+" "+r.value.maxCapacity:"",m.value){i.value="customers";return}ne()}})}function ne(){let q=[];s.getters["appointment/getBookings"].forEach(J=>{let X={};Object.keys(J.customFields).forEach(ve=>{X[ve]=Object.assign({},J.customFields[ve],{value:J.customFields[ve].type==="datepicker"?J.customFields[ve].value?me(J.customFields[ve].value).format("YYYY-MM-DD"):null:J.customFields[ve].value})}),q.push(Object.assign({},J,{customerId:J.customer.id,extras:J.extras.filter(ve=>ve.quantity),customFields:X}))});let Q=[];if(le.value){let J=le.value.bookings.map(ve=>"id"in ve&&ve.id),X=q.map(ve=>"id"in ve&&ve.id);Q=le.value.bookings.filter(ve=>J.filter(ye=>!X.includes(ye)).includes(ve.id)).map(ve=>new Object({id:ve.id}))}let G=s.getters["cabinet/getTimeZone"],H={serviceId:s.getters["appointment/getServiceId"],providerId:s.getters["appointment/getProviderId"],locationId:s.getters["appointment/getLocationId"],bookings:q,removedBookings:Q,bookingStart:me(s.getters["appointment/getStartDate"]).format("YYYY-MM-DD")+" "+s.getters["appointment/getStartTime"],utc:G==="UTC",timeZone:G==="UTC"?null:G,notifyParticipants:s.getters["appointment/getNotifyParticipants"]?1:0,internalNotes:s.getters["appointment/getInternalNotes"],id:s.getters["appointment/getId"],payment:{gateway:"onSite"},recurring:b.value?b.value.map(J=>new Object({bookingStart:me(J.date).format("YYYY-MM-DD")+" "+J.time,providerId:J.slot[0][0],locationId:J.slot[0][1]})):[],lessonSpace:s.getters["appointment/getLessonSpace"]?"https://www.thelessonspace.com/space/"+s.getters["appointment/getLessonSpace"]:null,createPaymentLinks:s.getters["appointment/getCreatePaymentLinks"]?1:0};se.value=!0,Pe.post("/appointments"+(s.getters["appointment/getId"]?"/"+s.getters["appointment/getId"]:""),H,Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(J=>{J.data.data.appointment.id&&Z("save")}).catch(J=>{j.value=l.value.error,"response"in J&&"data"in J.response&&"data"in J.response.data&&("timeSlotUnavailable"in J.response.data.data&&J.response.data.data.timeSlotUnavailable===!0&&(j.value=l.value.time_slot_unavailable,i.value="details"),"customerAlreadyBooked"in J.response.data.data&&J.response.data.data.customerAlreadyBooked===!0&&(j.value=l.value.customer_already_booked,i.value="customers")),ce.value=!0}).finally(()=>{se.value=!1})}function Z(q){s.commit("appointment/setActive",!1),t(q)}Je(()=>{if(s.commit("appointment/setActive",!0),s.getters["appointment/getId"]){le.value=JSON.parse(JSON.stringify(s.getters["appointment/getAppointmentData"]));let q=s.getters["entities/filteredLocations"]({categoryId:null,serviceId:null,providerId:s.getters["appointment/getProviderId"],locationId:null}),Q=s.getters["entities/filteredServices"]({categoryId:null,serviceId:null,providerId:s.getters["appointment/getProviderId"],locationId:null});s.getters["appointment/getId"]&&s.getters["appointment/getServiceId"]&&Q.map(H=>H.id).indexOf(s.getters["appointment/getServiceId"])===-1||s.getters["appointment/getId"]&&s.getters["appointment/getLocationId"]&&q.map(H=>H.id).indexOf(s.getters["appointment/getLocationId"])===-1||R(!0)}s.getters["appointment/getServiceId"]&&(s.dispatch("appointment/updateEmployeeService",s.getters["appointment/getServiceId"]),s.dispatch("appointment/addAllCustomFieldsFormRules",{label:l.value.required_field}))});let ge=V("amColors"),be=_(()=>({"--am-c-capai-text":ge.value.colorMainText,"--am-c-capai-text-op10":W(ge.value.colorMainText,.1),"--am-c-capai-primary":ge.value.colorPrimary,"--am-c-cust-no1":ge.value.colorMainText,"--am-c-cust-no1-bgr":W(ge.value.colorMainText,.1),"--am-c-cust-no2":ge.value.colorWarning,"--am-c-cust-no2-bgr":W(ge.value.colorWarning,.1),"--am-c-cust-no3":ge.value.colorError,"--am-c-cust-no3-bgr":W(ge.value.colorError,.1),"--am-c-cust-link":W(ge.value.colorMainText,.5),"--am-c-cust-text":ge.value.colorMainText}));return(q,Q)=>{const G=Ia,H=$a;return a(se)?(c(),U(Wt,{key:1})):(c(),C("div",{key:0,class:B(["am-capai",[{"am-no-border":!0},a(e).responsiveClass]]),style:ke(a(be))},[a(ce)?(c(),U(xt,{key:0,class:"am-asi__top-message am-asi__top-message-error",type:"error","show-icon":!0,"show-border":!0,"close-after":5e3,onClose:ie,onTriggerClose:ie},{title:L(()=>[re(x(a(j)),1)]),_:1})):N("",!0),I(H,{modelValue:i.value,"onUpdate:modelValue":Q[1]||(Q[1]=J=>i.value=J)},{default:L(()=>[I(G,{label:a(l).details,name:"details"},{default:L(()=>[I(n1,{ref_key:"appointmentDetailsRef",ref:o,"slots-props":a($),"slots-loading":a(E),"free-slots":a(A),"is-disabled-date":T,times:a(S),"get-free-times":P,onRemoveSlots:M,onFetchSlots:Y,onSelectDate:f,onSelectTime:k},null,8,["slots-props","slots-loading","free-slots","times"])]),_:1},8,["label"]),a(r)?(c(),U(G,{key:0,label:a(l).customers,name:"customers"},{default:L(()=>[I(L1,{ref_key:"appointmentCustomersRef",ref:u,"responsive-class":a(e).responsiveClass,"capacity-warning":a(m),"appointment-capacity":a(h),"saved-appointment":a(le),onChangedSlotCondition:R},null,8,["responsive-class","capacity-warning","appointment-capacity","saved-appointment"])]),_:1},8,["label"])):N("",!0),a(r)&&a(r).extras.length&&a(s).getters["appointment/getBookings"].length?(c(),U(G,{key:1,label:a(l).extras,name:"extras"},{default:L(()=>[I(U1,{"responsive-class":a(e).responsiveClass,onChangedSlotCondition:R},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(r)&&a(g).length&&a(s).getters["appointment/getBookings"].length?(c(),U(G,{key:2,label:a(l).custom_fields,name:"customFields"},{default:L(()=>[I($1,{ref_key:"appointmentCustomFieldsRef",ref:v,"responsive-class":a(e).responsiveClass},null,8,["responsive-class"])]),_:1},8,["label"])):N("",!0),a(s).getters["appointment/getId"]&&n.linkedAppointments.length?(c(),U(G,{key:3,label:a(l).linked,name:"linked"},{default:L(()=>[I(Ay,{"linked-appointments":n.linkedAppointments,"responsive-class":a(e).responsiveClass,onEditLinkedAppointment:Q[0]||(Q[0]=J=>a(t)("editLinkedAppointment",J))},null,8,["linked-appointments","responsive-class"])]),_:1},8,["label"])):N("",!0),a(r)&&a(r).recurringCycle!=="disabled"&&a(s).getters["appointment/getStartDate"]&&a(s).getters["appointment/getStartTime"]&&!a(s).getters["appointment/getId"]&&!!a(s).getters["customerInfo/getCustomersIds"].length?(c(),U(G,{key:4,label:a(l).recurring,name:"recurring"},{default:L(()=>[I(yy,{"free-slots":a(A),"slots-props":a($),"maximum-booking-start-date":a(w),"get-free-times":P,"get-selected-dates-times":D,"is-disabled-date":T,"slots-loading":a(E),"responsive-class":a(e).responsiveClass,onFetchSlots:Y},null,8,["free-slots","slots-props","maximum-booking-start-date","slots-loading","responsive-class"])]),_:1},8,["label"])):N("",!0),a(s).getters["appointment/getId"]?(c(),U(G,{key:5,label:a(l).payment,name:"payment"},{default:L(()=>[I(eb,{"responsive-class":a(e).responsiveClass,"saved-appointment":a(le)},null,8,["responsive-class","saved-appointment"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"]),d("div",tb,[I(Te,{category:"secondary",size:"default",type:"plain",onClick:Q[2]||(Q[2]=()=>{a(t)("close")})},{default:L(()=>[re(x(a(l).cancel),1)]),_:1}),I(Te,{size:"default",onClick:te},{default:L(()=>[re(x(a(l).save),1)]),_:1})])],6))}}});const lb={key:0,class:"el-skeleton-item-wrapper-title"},nb={name:"AuthSkeleton"},Oi=Object.assign(nb,{props:{centerFirst:{type:Boolean,default:!1},count:{type:Number,default:3},mainClass:{type:String,default:""}},setup(n){const t=n;return(e,s)=>{const l=Fl,i=Vl;return c(),U(i,{animated:"",class:B(["am-asi-el-skeleton",[{"am-asi":a(t).mainClass}]])},{template:L(()=>[a(t).centerFirst?(c(),C("div",lb,[I(l,{variant:"rect"})])):N("",!0),(c(!0),C(ae,null,pe(new Array(a(t).count),o=>(c(),C("div",{key:o,class:"el-skeleton-item-wrapper"},[I(l,{variant:"rect"})]))),128))]),_:1},8,["class"])}}});const ib=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),ob={key:2,class:"am-cap__actions"},rb={name:"CabinetAppointments",key:"appointments"},cb=Object.assign(rb,{props:{loadBookingsCounter:{type:Number,default:0},appointments:{type:Object,default:null}},setup(n){const t=n;let e=De();const s=V("settings");let l=V("amCustomize");const i=V("shortcodeData"),o=V("labels"),r=V("localLanguage");let u=_(()=>s.general.usedLanguages.includes(r.value)),m=_(()=>{let le=Qe({...o}),te=l.value.appointments.translations;return te&&Object.keys(te).forEach(ne=>{te[ne][r.value]&&u.value?le[ne]=te[ne][r.value]:te[ne].default&&(le[ne]=te[ne].default)}),le});Re("amLabels",m);const h=O(null),{width:v}=ja(h);let g=_(()=>st(v.value));Re("pageWidth",v);let b=O(null),D=O(!1),P=O("success"),y=O("");function w(){D.value=!1,e.commit("cabinet/setPaymentLinkError",{value:!1,type:"appointment"})}let A=V("cabinetType");e.commit("cabinetFilters/setDates",fi(A.value));let S=_(()=>e.getters["cabinet/getAppointmentsLoading"]),f=_(()=>e.getters["entities/getReady"]),k=O(null),T=O(0),E=O(1);function $(le){E.value=le,R(null,le)}function R(le=null,te=1){e.commit("cabinet/setAppointmentsLoading",!0);let ne=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getAppointmentsFilters"])),Z=e.getters["cabinet/getTimeZone"];ne.dates=ne.dates.map(be=>me(be).format("YYYY-MM-DD")),ne.timeZone=Z,ne.source="cabinet-"+A.value,ne.page=te,e.commit("auth/setLoadingAppointmentsCounter",e.getters["auth/getLoadingAppointmentsCounter"]+1);let ge=e.getters["auth/getLoadingAppointmentsCounter"];Pe.get("/appointments",Object.assign(ze(e),{params:Js(ne)})).then(be=>{ge===e.getters["auth/getLoadingAppointmentsCounter"]&&(T.value=be.data.data.total,k.value=fr(be.data.data.appointments,Z,A.value==="provider"))}).catch(be=>{be?.response?.data?.data?.reauthorize!==void 0&&be.response.data.data.reauthorize&&e.dispatch("auth/logout"),console.log(be)}).finally(()=>{ge===e.getters["auth/getLoadingAppointmentsCounter"]&&(e.commit("cabinet/setAppointmentsLoading",!1),le&&"message"in le&&(D.value=!0,y.value=le.message,h.value&&b.value&&setTimeout(function(){ut(h.value,b.value.$el,0,300)},500)))})}let Y=O([]);function M(le){e.commit("cabinet/setAppointmentsLoading",!0),Pe.get("/appointments/"+le.id,Object.assign({params:{source:"cabinet-"+A.value,timeZone:e.getters["cabinet/getTimeZone"]}},ze(e))).then(te=>{let ne=te.data.data.appointment.bookingStart.split(" "),Z=e.getters["entities/getService"](te.data.data.appointment.serviceId),ge=[];te.data.data.appointment.bookings.forEach(be=>{let q=[];Z.extras.sort((G,H)=>G.position-H.position).forEach(G=>{q.push({extraId:G.id,quantity:0});let H=be.extras.find(J=>J.extraId===G.id);typeof H<"u"&&(q[q.length-1]=H)});let Q=be.customFields?JSON.parse(be.customFields):{};Object.keys(Q).forEach(G=>{Q[G]=Object.assign({},Q[G],{value:Q[G].type==="datepicker"?Q[G].value?me(Q[G].value).toDate():"":Q[G].value})}),ge.push({id:be.id,customer:le.bookings.find(G=>G.id===be.id).customer,persons:be.persons,status:be.status,duration:be.duration?be.duration.toString():null,extras:q,customFields:Q,payments:be.payments,price:be.price,aggregatedPrice:be.aggregatedPrice,tax:be.tax,coupon:be.coupon})}),e.commit("appointment/setAppointment",{id:te.data.data.appointment.id,categoryId:Z.categoryId,serviceId:te.data.data.appointment.serviceId,providerId:te.data.data.appointment.providerId,locationId:te.data.data.appointment.locationId,internalNotes:te.data.data.appointment.internalNotes,lessonSpace:te.data.data.appointment.lessonSpace!==null?te.data.data.appointment.lessonSpace.split("https://www.thelessonspace.com/space/")[1]:null,startDate:me(ne[0]).toDate(),startTime:ne[1].substring(0,5),bookings:ge,notifyParticipants:!!te.data.data.appointment.notifyParticipants,createPaymentLinks:!!te.data.data.appointment.createPaymentLinks}),Y.value=te.data.data.recurring,K.value=!0}).catch(te=>{console.log(te)}).finally(()=>{e.commit("cabinet/setAppointmentsLoading",!1)})}let K=O(!1);function ce(){D.value=!0,y.value=m.value.appointment_saved,h.value&&b.value&&setTimeout(function(){ut(h.value,b.value.$el,0,300)},500),R(),ie()}function j(){se(),K.value=!0}function ie(){K.value=!1,se()}function se(){e.commit("appointment/resetAppointment",{providerId:e.getters["auth/getProfile"].id}),e.commit("customerInfo/setCustomers",[]),e.commit("customerInfo/setCustomersIds",[])}return it(()=>t.loadBookingsCounter,()=>{R()}),Je(()=>{R()}),(le,te)=>(c(),C("div",{ref_key:"pageContainer",ref:h,class:B(["am-cap am-capa-main",{"am-capai-main":a(K)}])},[d("div",{class:B(["am-capa-main__inner",a(g)])},[a(D)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:b,type:a(P),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:w,onTriggerClose:w},{title:L(()=>[ib,re(" "+x(a(y)),1)]),_:1},8,["type"])):N("",!0),!a(K)&&a(f)?(c(),U(Ni,{key:1,"step-key":"appointments","responsive-class":a(g),empty:!1,onAddAppointment:j,onChangeFilters:R},null,8,["responsive-class"])):N("",!0),a(i).cabinetType==="employee"&&a(s).roles.allowWriteAppointments&&!a(K)&&a(f)?(c(),C("div",ob,[I(Te,{prefix:"plus",size:"small",category:"primary",type:a(l).appointments.options.newAppBtn.buttonType,onClick:j},{default:L(()=>[d("span",null,x(a(m).new_appointment),1)]),_:1},8,["type"])])):N("",!0),!a(S)&&a(f)?(c(),C(ae,{key:3},[!a(K)&&a(k)&&Object.keys(a(k)).length>0?(c(),U(br,{key:0,"grouped-appointments":a(k),"page-width":a(v),"responsive-class":a(g),"step-key":"appointments",onCanceled:R,onBooked:R,onEditAppointment:M},null,8,["grouped-appointments","page-width","responsive-class"])):a(K)?N("",!0):(c(),U(Aa,{key:1,heading:a(m).no_app_found,text:a(m).have_no_app},null,8,["heading","text"])),!a(K)&&a(k)&&Object.keys(a(k)).length>0&&a(T)>a(s).general.itemsPerPageBackEnd?(c(),U(Il,{key:2,"page-size":a(s).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:a(T),"current-page":a(E),onCurrentChange:$},null,8,["page-size","total","current-page"])):N("",!0),a(K)?(c(),U(sb,{key:3,"page-width":a(v),"responsive-class":a(g),"linked-appointments":a(Y),onEditLinkedAppointment:M,onClose:ie,onSave:ce},null,8,["page-width","responsive-class","linked-appointments"])):N("",!0)],64)):(c(),U(Oi,{key:4}))],2)],2))}});function vs(n,t,e={},s={}){for(let l in t)l in n&&t[l]&&typeof t[l]=="object"?(l in s||(s[l]={}),vs(n[l],t[l],l in e?e[l]:n[l],s[l]),Object.keys(s[l]).length===0&&delete s[l]):l in e?s[l]=e[l]:l in n?s[l]=n[l]:s[l]=t[l];return s}function ub(n){at.activation.stash&&Pe.post("/stash",{},Object.assign(ze(n),{params:{source:"cabinet-provider"}})).then(()=>{}).catch(()=>{})}function db(n,t){let e=n.getters["event/getDefaultEvent"],s=[],l={};t.customTickets.length&&t.bookings.forEach(r=>{r.ticketsData.forEach(u=>{l[u.eventTicketId]=!0})}),t.customTickets.forEach(r=>{JSON.parse(r.dateRanges).forEach((u,m)=>{m in s||s.push({enabled:u.enabled,range:[me(u.startDate,"YYYY-MM-DD").toDate(),me(u.endDate,"YYYY-MM-DD").toDate()],tickets:[]}),s[m].tickets.push({price:u.price})}),r.booked=r.id in l});let i=!t.description||t.description.startsWith("<!-- Content -->")?"text":"html",o=t.description?t.description.replace("<!-- Content -->",""):"";return Object.assign({},t,{description:o,descriptionMode:i,tags:t.tags.map(r=>r.name),organizerId:t.organizerId,periods:t.periods.map(r=>new Object({id:r.id,eventId:r.eventId,appleCalendarEventId:r.appleCalendarEventId,googleCalendarEventId:r.googleCalendarEventId,googleMeetUrl:r.googleMeetUrl,outlookCalendarEventId:r.outlookCalendarEventId,startDate:me(r.periodStart.split(" ")[0],"YYYY-MM-DD").toDate(),endDate:me(r.periodEnd.split(" ")[0],"YYYY-MM-DD").toDate(),startTime:r.periodStart.split(" ")[1].substring(0,5),endTime:r.periodEnd.split(" ")[1].substring(0,5)})),bookingOpens:{disabled:t.bookingOpens===null,date:t.bookingOpens?me(t.bookingOpens.split(" ")[0],"YYYY-MM-DD").toDate():null,time:t.bookingOpens?t.bookingOpens.split(" ")[1].substring(0,5):null},bookingOpensRec:t.bookingOpensRec==="same",bookingCloses:{disabled:t.bookingCloses===null,date:t.bookingCloses?me(t.bookingCloses.split(" ")[0],"YYYY-MM-DD").toDate():null,time:t.bookingCloses?t.bookingCloses.split(" ")[1].substring(0,5):null},bookingClosesRec:t.bookingClosesRec==="same",recurringEnabled:t.recurring&&t.recurring.cycle!==null,recurring:t.recurring!==null?Object.assign({},t.recurring,{until:t.recurring.until?me(t.recurring.until.split(" ")[0],"YYYY-MM-DD").toDate():null,monthDate:t.recurring.monthDate?me(t.recurring.monthDate.split(" ")[0],"YYYY-MM-DD").toDate():null}):e.recurring,depositEnabled:t.depositPayment!=="disabled",depositPayment:t.depositPayment!=="disabled"?t.depositPayment:"percentage",customTicketsRangesEnabled:s.length>0,customTicketsRanges:s,maxCustomCapacity:t.maxCustomCapacity===null?1:t.maxCustomCapacity,maxCustomCapacityEnabled:t.maxCustomCapacity!==null,closeAfterMinEnabled:t.closeAfterMin!==null,closeAfterMinBookings:t.closeAfterMinBookings,closeAfterMin:t.closeAfterMin===null?1:t.closeAfterMin,maxExtraPeopleEnabled:t.maxExtraPeople!==null,maxExtraPeople:t.maxExtraPeople===null?0:t.maxExtraPeople,locationId:t.locationId===null&&t.customLocation?0:t.locationId,settings:vs(at,e.settings,t.settings?JSON.parse(t.settings):{},{})})}function mb(n){let t=n.getters["event/getDefaultEvent"],e=[];n.getters["event/getCustomTickets"].forEach((l,i)=>{let o=[];n.getters["event/getCustomTicketsRanges"].filter(r=>r.range[0]&&r.range[1]).forEach(r=>{o.push({startDate:me(r.range[0]).format("YYYY-MM-DD"),endDate:me(r.range[1]).format("YYYY-MM-DD"),price:r.tickets[i].price})}),e.push(Object.assign({},l,{dateRanges:JSON.stringify(o)}))});let s=vs(vs(at,t.settings,{},{}),t.settings,n.getters["event/getSettings"],{});return Object.keys(n.getters["event/getSettings"]).forEach(l=>{Object.keys(n.getters["event/getSettings"][l]).forEach(i=>{n.getters["event/getSettings"][l][i]!==null&&typeof n.getters["event/getSettings"][l][i]=="object"?(Object.keys(n.getters["event/getSettings"][l][i]).forEach(o=>{(n.getters["event/getSettings"][l][i][o]===at[l][i][o]||at[l][i][o]&&(n.getters["event/getSettings"][l][i][o]===""||n.getters["event/getSettings"][l][i][o]===null))&&delete s[l][i][o]}),typeof s[l][i]=="object"&&Object.keys(s[l][i]).length===0&&delete s[l][i]):l in at&&i in at[l]&&(s[l][i]===at[l][i]||at[l][i]&&(n.getters["event/getSettings"][l][i]===""||n.getters["event/getSettings"][l][i]===null))&&delete s[l][i]}),Object.keys(s[l]).length===0&&delete s[l]}),{aggregatedPrice:n.getters["event/getAggregatedPrice"],bookMultipleTimes:n.getters["event/getBookMultipleTimes"],bookingCloses:!n.getters["event/getBookingClosesDisabled"]&&n.getters["event/getBookingClosesDate"]&&n.getters["event/getBookingClosesTime"]?me(n.getters["event/getBookingClosesDate"]).format("YYYY-MM-DD")+" "+n.getters["event/getBookingClosesTime"]+":00":null,bookingClosesRec:n.getters["event/getBookingClosesRec"]?"same":"calculate",bookingOpens:!n.getters["event/getBookingOpensDisabled"]&&n.getters["event/getBookingOpensDate"]&&n.getters["event/getBookingOpensTime"]?me(n.getters["event/getBookingOpensDate"]).format("YYYY-MM-DD")+" "+n.getters["event/getBookingOpensTime"]+":00":null,bookingOpensRec:n.getters["event/getBookingOpensRec"]?"same":"calculate",bringingAnyone:n.getters["event/getBringingAnyone"],closeAfterMin:n.getters["event/getCloseAfterMinEnabled"]?n.getters["event/getCloseAfterMin"]:null,closeAfterMinBookings:n.getters["event/getCloseAfterMinBookings"],color:n.getters["event/getColor"],customLocation:n.getters["event/getCustomLocation"],customPricing:n.getters["event/getCustomPricing"],customTickets:e,deposit:n.getters["event/getDeposit"],depositPayment:n.getters["event/getDepositEnabled"]?n.getters["event/getDepositPayment"]:"disabled",depositPerPerson:n.getters["event/getDepositPerPerson"],description:n.getters["event/getDescription"]&&n.getters["event/getDescriptionMode"]==="text"?"<!-- Content -->"+n.getters["event/getDescription"]:n.getters["event/getDescription"],fullPayment:n.getters["event/getFullPayment"],gallery:n.getters["event/getGallery"],id:n.getters["event/getId"],locationId:n.getters["event/getLocationId"]===0?null:n.getters["event/getLocationId"],maxCapacity:n.getters["event/getMaxCapacity"],maxCustomCapacity:n.getters["event/getMaxCustomCapacityEnabled"]?n.getters["event/getMaxCustomCapacity"]:null,maxExtraPeople:n.getters["event/getMaxExtraPeopleEnabled"]?n.getters["event/getMaxExtraPeople"]:null,name:n.getters["event/getName"],notifyParticipants:n.getters["event/getNotifyParticipants"],organizerId:n.getters["event/getOrganizerId"],parentId:n.getters["event/getParentId"],periods:Tr(n),price:n.getters["event/getPrice"],providers:n.getters["event/getId"]?n.getters["event/getProviders"]:[{id:n.getters["auth/getProfile"].id,firstName:n.getters["auth/getProfile"].firstName,lastName:n.getters["auth/getProfile"].lastName,email:n.getters["auth/getProfile"].email,type:"provider"}],recurring:n.getters["event/getRecurringEnabled"]?Object.assign({},n.getters["event/getRecurring"],{until:me(n.getters["event/getRecurringUntil"]).format("YYYY-MM-DD"),monthDate:n.getters["event/getRecurringMonthDate"]?me(n.getters["event/getRecurringMonthDate"]).format("YYYY-MM-DD"):null}):null,settings:Object.keys(s).length?JSON.stringify(s):null,show:n.getters["event/getShow"],tags:n.getters["event/getTags"].map(l=>new Object({name:l})),timeZone:n.getters["cabinet/getTimeZone"],translations:n.getters["event/getTranslations"],utc:n.getters["cabinet/getTimeZone"]==="UTC",zoomUserId:n.getters["event/getZoomUserId"]}}function Tr(n){return n.getters["event/getPeriods"].map(t=>new Object({id:t.id,eventId:t.eventId,appleCalendarEventId:t.appleCalendarEventId,googleCalendarEventId:t.googleCalendarEventId,googleMeetUrl:t.googleMeetUrl,outlookCalendarEventId:t.outlookCalendarEventId,microsoftTeamsUrl:t.microsoftTeamsUrl,periodStart:n.getters["cabinet/getTimeZone"]==="UTC"?me(t.startDate).utc().format("YYYY-MM-DD")+" "+t.startTime+":00":me(t.startDate).format("YYYY-MM-DD")+" "+t.startTime+":00",periodEnd:n.getters["cabinet/getTimeZone"]==="UTC"?me(t.endDate).utc().format("YYYY-MM-DD")+" "+t.endTime+":00":me(t.endDate).format("YYYY-MM-DD")+" "+t.endTime+":00"}))}const xl=Qe(window.wpAmeliaLabels);function ko(n,t={}){return Object.assign(t,{id:n.id,eventId:n.event.id,customer:n.customer,customerId:n.customer.id,persons:n.persons,customFields:n.customFields?JSON.parse(n.customFields):{},ticketsData:n.ticketsData,status:n.status,tax:n.tax,price:n.price,coupon:n.coupon,payments:n.payments})}function Lr(n){let t={};return Object.keys(n.getters["attendee/getCustomFields"]).forEach(e=>{t[e]={label:n.getters["attendee/getCustomFields"][e].label,type:n.getters["attendee/getCustomFields"][e].type,value:n.getters["attendee/getCustomFields"][e].type==="datepicker"?n.getters["attendee/getCustomFields"][e].value?me(n.getters["attendee/getCustomFields"][e].value).format("YYYY-MM-DD"):null:n.getters["attendee/getCustomFields"][e].value}}),{id:n.getters["attendee/getId"],type:"event",eventId:n.getters["attendee/getEventId"],bookings:[{customerId:n.getters["attendee/getCustomerId"],persons:n.getters["attendee/getPersons"],customFields:t,ticketsData:n.getters["attendee/getTickets"],status:n.getters["attendee/getStatus"],coupon:n.getters["attendee/getCoupon"]}],status:n.getters["attendee/getStatus"],validateCoupon:!1,isBackendOrCabinet:!0,createPaymentLinks:!1,payment:{gateway:"onSite"}}}function hs(n,t,e=null){let s=t.customFields,l=e&&e.customPricing?e.customTickets.map((i,o)=>new Object({eventTicketId:i.id,persons:o===0&&!Object.keys(t.ticketsData).length?1:0,price:i.price})):[];return e&&(n.getters["entities/getCustomFields"].filter(i=>i.allEvents||i.events.map(o=>o.id).indexOf(e.id)!==-1&&i.type!=="content"&&i.type!=="file").forEach(i=>{s[i.id]={type:i.type,label:i.label,value:i.id in s?s[i.id].value:i.type==="checkbox"||i.type==="file"?[]:"",width:i.width,options:i.options,id:i.id,required:i.required}}),e.customPricing&&Object.keys(t.ticketsData).forEach(i=>{let o=l.find(r=>r.eventTicketId===t.ticketsData[i].eventTicketId);o.id=t.ticketsData[i].id,o.persons=t.ticketsData[i].persons,o.price=t.ticketsData[i].price,o.customerBookingId=t.ticketsData[i].customerBookingId})),Object.assign({},t,{eventId:e?e.id:null,customFields:s,ticketsData:l})}function Er(){return[{label:xl.approved,value:"approved",icon:"check",color:"var(--am-c-success)"},{label:xl.waiting,value:"waiting",icon:"clock",color:"var(--am-c-warning)"},{label:xl.canceled,value:"canceled",icon:"close",color:"var(--am-c-error)"},{label:xl["no-show"],value:"no-show",icon:"clock",color:"var(--am-c-warning)"}]}function Sr(n){let t=0;return n.getters["attendee/getTickets"].length?n.getters["attendee/getTickets"].forEach(e=>{e.persons&&(t+=n.getters["attendee/getAggregatedPrice"]?e.price*e.persons:e.price)}):t=n.getters["attendee/getAggregatedPrice"]?n.getters["attendee/getPrice"]*n.getters["attendee/getPersons"]:n.getters["attendee/getPrice"],ui(null,n.getters["attendee/getCoupon"],n.getters["attendee/getTax"]&&n.getters["attendee/getTax"].length?n.getters["attendee/getTax"][0]:null,t,!1)}const pb=["innerHTML"],gb=["innerHTML"],fb={setup(n,{expose:t}){let e=De(),s=V("amLabels"),l=V("licence");const i=V("settings");let o=O(e.getters["entities/getLocations"]),r=O(e.getters["entities/getTags"]),u=O("");function m(w){u.value=w.toLowerCase()}let h=_(()=>u.value?r.value.filter(w=>w.name.toLowerCase().includes(u.value)):r.value),v=O(null),g=O({name:_({get:()=>e.getters["event/getName"],set:w=>{e.commit("event/setName",w)}}),locationId:_({get:()=>e.getters["event/getLocationId"],set:w=>{e.commit("event/setLocationId",w)}}),customLocation:_({get:()=>e.getters["event/getCustomLocation"],set:w=>{e.commit("event/setCustomLocation",w)}}),organizerId:_({get:()=>e.getters["event/getOrganizerId"],set:w=>{e.commit("event/setOrganizerId",w)}}),zoomUserId:_({get:()=>e.getters["event/getZoomUserId"],set:w=>{e.commit("event/setZoomUserId",w)}}),tags:_({get:()=>e.getters["event/getTags"],set:w=>{e.commit("event/setTags",w)}}),notifyParticipants:_({get:()=>e.getters["event/getNotifyParticipants"],set:w=>{e.commit("event/setNotifyParticipants",w)}}),description:_({get:()=>e.getters["event/getDescription"],set:w=>{e.commit("event/setDescription",w||"")}})}),b=_(()=>g.value.organizerId!==null);function D(w){e.commit("event/setOrganizerId",w?e.getters["auth/getProfile"].id:null)}let P=_(()=>({name:[{required:!0,message:s.value.please_enter_name,trigger:["submit","change"]}]})),y=_(()=>{let w=e.getters["auth/getZoomUsers"];return w.length?w.map(A=>({value:A.id,label:`${A.first_name} ${A.last_name} (${A.email})`})):[]});return t({detailsFormRef:v}),(w,A)=>{const S=vt,f=Bl,k=et;return c(),U(k,{ref_key:"detailsFormRef",ref:v,model:a(g),rules:a(P),class:"am-capei-def"},{default:L(()=>[I(S,{prop:"name",label:`${a(s).name}:`,class:"am-capei-def__item"},{default:L(()=>[I(mt,{modelValue:a(g).name,"onUpdate:modelValue":A[0]||(A[0]=T=>a(g).name=T),placeholder:a(s).enter_event_name},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),!a(l).isStarter&&a(o).length>1?(c(),U(S,{key:0,label:`${a(s).event_select_address}:`,class:"am-capei-def__item"},{default:L(()=>[I(Ze,{modelValue:a(g).locationId,"onUpdate:modelValue":A[1]||(A[1]=T=>a(g).locationId=T),placeholder:a(s).select},{default:L(()=>[(c(),U(Ue,{key:0,value:0,label:a(s).event_custom_address},null,8,["label"])),(c(!0),C(ae,null,pe(a(o),T=>(c(),U(Ue,{key:T.id,value:T.id,label:T.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0),a(g).locationId?N("",!0):(c(),U(S,{key:1,label:`${a(s).event_custom_address}:`,class:"am-capei-def__item"},{default:L(()=>[I(mt,{modelValue:a(g).customLocation,"onUpdate:modelValue":A[2]||(A[2]=T=>a(g).customLocation=T)},null,8,["modelValue"])]),_:1},8,["label"])),a(i).zoom.enabled?(c(),U(S,{key:2,label:`${a(s).zoom_user}:`,class:"am-capei-def__item"},{default:L(()=>[I(Ze,{modelValue:a(g).zoomUserId,"onUpdate:modelValue":A[3]||(A[3]=T=>a(g).zoomUserId=T),clearable:"",placeholder:a(s).zoom_user_placeholder},{default:L(()=>[(c(!0),C(ae,null,pe(a(y),T=>(c(),U(Ue,{key:T.value,value:T.value,label:T.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0),!a(l).isStarter&&(a(i).googleCalendar.enabled||a(i).outlookCalendar.enabled||a(i).appleCalendar)&&(a(e).getters["employee/getGoogleCalendarId"]||a(e).getters["employee/getOutlookCalendarId"]||a(e).getters["employee/getAppleCalendarId"])?(c(),U(S,{key:3,class:"am-capei-def__item am-capei-def__item-tool"},{default:L(()=>[I(lt,{modelValue:a(b),"onUpdate:modelValue":A[4]||(A[4]=T=>we(b)?b.value=T:b=T),disabled:a(g).organizerId&&a(g).organizerId!==a(e).getters["auth/getProfile"].id,"active-text":a(s).event_organizer,"aria-label":a(s).event_organizer,onChange:D},null,8,["modelValue","disabled","active-text","aria-label"]),I(f,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(s).event_organizer_tooltip},null,8,pb)]),default:L(()=>[I(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1})):N("",!0),I(S,{label:`${a(s).event_tags}:`,class:"am-capei-def__item"},{default:L(()=>[I(Ze,{modelValue:a(g).tags,"onUpdate:modelValue":A[5]||(A[5]=T=>a(g).tags=T),clearable:"",filterable:"",multiple:"","allow-create":!0,placeholder:a(s).event_tags_select_or_create,"filter-method":m},{default:L(()=>[(c(!0),C(ae,null,pe(a(h),(T,E)=>(c(),U(Ue,{key:E,value:T.name,label:T.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"]),I(S,{class:"am-capei-def__item am-capei-def__item-tool"},{default:L(()=>[I(lt,{modelValue:a(g).notifyParticipants,"onUpdate:modelValue":A[6]||(A[6]=T=>a(g).notifyParticipants=T),"active-text":a(s).notify_attendees,"aria-label":a(s).notify_attendees},null,8,["modelValue","active-text","aria-label"]),I(f,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(s).notify_attendees_tooltip},null,8,gb)]),default:L(()=>[I(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1}),I(S,{prop:"description",label:a(s).description_colon,class:"am-capei-def__item"},{default:L(()=>[I(mr,{modelValue:a(g).description,"onUpdate:modelValue":A[7]||(A[7]=T=>a(g).description=T),mode:a(e).getters["event/getDescriptionMode"],onSetMode:A[8]||(A[8]=T=>a(e).commit("event/setDescriptionMode",T))},null,8,["modelValue","mode"])]),_:1},8,["label"])]),_:1},8,["model","rules"])}}};const hb={class:"am-capei-per__segment"},_b={key:0,class:"am-capei-per__delete"},vb={class:"am-capei-per__segment"},yb=["innerHTML"],bb={class:"am-capei-per__segment"},kb=["innerHTML"],Cb={props:{pageWidth:{type:Number,default:0}},setup(n,{expose:t}){const e=n;let s=_(()=>st(e.pageWidth));const l=De(),i=V("settings");let o=V("amLabels"),r=V("localLanguage"),u=O(Ke());function m(S){let f=y.value.periods.map(k=>k.endDate).filter(k=>k instanceof Date&&!isNaN(k));return Ke(S)<u.value||Ke(S)>Ke(new Date(Math.max(...f)))}function h(S,f){const k=Ke(S)<u.value;return(f?Ke(S)>Ke(f):!1)||k}function v(S,f){return f?Ke(S)<Ke(f):Ke(S)<u.value}function g(){let S=!0;P.value.validate(f=>{f||(S=!1)}),S&&y.value.periods.push({eventId:l.getters["event/getId"]?l.getters["event/getId"]:null,startDate:null,endDate:null,startTime:null,endTime:null})}function b(S){l.getters["event/getId"]&&y.value.periods[S]?.id&&y.value.periods[S].id&&y.value.periods.forEach((f,k)=>{k!==S&&!f?.id&&(y.value.periods[k].id=y.value.periods[S].id,y.value.periods[k].eventId=y.value.periods[S].eventId,y.value.periods[k].appleCalendarEventId=y.value.periods[S].appleCalendarEventId,y.value.periods[k].googleCalendarEventId=y.value.periods[S].googleCalendarEventId,y.value.periods[k].googleMeetUrl=y.value.periods[S].googleMeetUrl,y.value.periods[k].outlookCalendarEventId=y.value.periods[S].outlookCalendarEventId,y.value.periods[k].microsoftTeamsUrl=y.value.periods[S].microsoftTeamsUrl)}),y.value.periods.splice(S,1)}let D=_(()=>l.getters["event/getRecurringEnabled"]),P=O(null),y=O({periods:_({get:()=>l.getters["event/getPeriods"],set:S=>{l.commit("event/setPeriods",S)}}),bookingOpensDisabled:_({get:()=>l.getters["event/getBookingOpensDisabled"],set:S=>{l.commit("event/setBookingOpensDisabled",S)}}),bookingOpensDate:_({get:()=>l.getters["event/getBookingOpensDate"],set:S=>{l.commit("event/setBookingOpensDate",S)}}),bookingOpensTime:_({get:()=>l.getters["event/getBookingOpensTime"],set:S=>{l.commit("event/setBookingOpensTime",S)}}),bookingOpensRec:_({get:()=>l.getters["event/getBookingOpensRec"],set:S=>{l.commit("event/setBookingOpensRec",S)}}),bookingClosesDisabled:_({get:()=>l.getters["event/getBookingClosesDisabled"],set:S=>{l.commit("event/setBookingClosesDisabled",S)}}),bookingClosesDate:_({get:()=>l.getters["event/getBookingClosesDate"],set:S=>{l.commit("event/setBookingClosesDate",S)}}),bookingClosesTime:_({get:()=>l.getters["event/getBookingClosesTime"],set:S=>{l.commit("event/setBookingClosesTime",S)}}),bookingClosesRec:_({get:()=>l.getters["event/getBookingClosesRec"],set:S=>{l.commit("event/setBookingClosesRec",S)}})});t({periodsFormRef:P});let w=V("amColors"),A=_(()=>({"--am-c-capei-per-text":w.value.colorMainText,"--am-c-capei-per-text-op03":W(w.value.colorMainText,.03),"--am-c-capei-per-inp-bgr-op03":W(w.value.colorInpBgr,.03)}));return(S,f)=>{const k=vt,T=Bl,E=et;return c(),U(E,{ref_key:"periodsFormRef",ref:P,model:a(y),"label-position":"top",class:"am-capei-per",style:ke(a(A))},{default:L(()=>[d("div",hb,[(c(!0),C(ae,null,pe(a(y).periods,($,R)=>(c(),C(ae,{key:R},[I(k,{prop:"periods."+R+".startDate",rules:{required:!0,message:a(o).select_date_warning,trigger:["blur","change"]},label:`${a(o).start_date}:`,class:B(["am-capei-per__item am-w-50",a(s)])},{default:L(()=>[I(Yt,{modelValue:$.startDate,"onUpdate:modelValue":Y=>$.startDate=Y,format:a(jt)(),lang:a(r),"disabled-date":Y=>h(Y,$.endDate)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date"])]),_:2},1032,["prop","rules","label","class"]),I(k,{prop:"periods."+R+".endDate",rules:{required:!0,message:a(o).select_date_warning,trigger:["blur","change"]},label:`${a(o).end_date}:`,class:B(["am-capei-per__item am-w-50",a(s)])},{default:L(()=>[I(Yt,{modelValue:$.endDate,"onUpdate:modelValue":Y=>$.endDate=Y,format:a(jt)(),lang:a(r),"disabled-date":Y=>v(Y,$.startDate)},null,8,["modelValue","onUpdate:modelValue","format","lang","disabled-date"])]),_:2},1032,["prop","rules","label","class"]),I(k,{prop:"periods."+R+".startTime",rules:{required:!0,message:a(o).select_time_warning,trigger:["blur","change"]},label:`${a(o).start_time}:`,class:B(["am-capei-per__item am-w-50",a(s)])},{default:L(()=>[I(Ta,{modelValue:$.startTime,"onUpdate:modelValue":Y=>$.startTime=Y,start:"00:00",end:a(Nt)(a(Bt)("24:00")-a(i).general.timeSlotLength),"min-time":null,"max-time":$.endTime,step:a(Nt)(a(i).general.timeSlotLength),clearable:!1,placeholder:a(o).select_time},null,8,["modelValue","onUpdate:modelValue","end","max-time","step","placeholder"])]),_:2},1032,["prop","rules","label","class"]),I(k,{prop:"periods."+R+".endTime",rules:{required:!0,message:a(o).select_time_warning,trigger:["blur","change"]},label:`${a(o).end_time}:`,class:B(["am-capei-per__item am-w-50",a(s)])},{default:L(()=>[I(Ta,{modelValue:$.endTime,"onUpdate:modelValue":Y=>$.endTime=Y,disabled:!$.startTime,start:"00:00",end:"24:00","min-time":$.startTime,"max-time":null,step:a(Nt)(a(i).general.timeSlotLength),clearable:!1,placeholder:a(o).select_time},null,8,["modelValue","onUpdate:modelValue","disabled","min-time","step","placeholder"])]),_:2},1032,["prop","rules","label","class"]),a(y).periods.length>1?(c(),C("div",_b,[I(Te,{size:"default",category:"danger",onClick:Y=>b(R)},{default:L(()=>[re(x(a(o).delete_period),1)]),_:2},1032,["onClick"])])):N("",!0)],64))),128)),I(Te,{size:"default",onClick:f[0]||(f[0]=$=>g())},{default:L(()=>[re(x(a(o).add_period),1)]),_:1})]),d("div",vb,[I(dt,{modelValue:a(y).bookingOpensDisabled,"onUpdate:modelValue":f[1]||(f[1]=$=>a(y).bookingOpensDisabled=$),label:a(o).event_booking_opens_now},null,8,["modelValue","label"]),a(y).bookingOpensDisabled?N("",!0):(c(),C(ae,{key:0},[I(k,{label:`${a(o).date}:`,prop:"bookingOpensDate",rules:{required:!0,message:a(o).select_date_warning,trigger:["blur","change"]},class:B(["am-capei-per__item am-w-50",a(s)])},{default:L(()=>[I(Yt,{modelValue:a(y).bookingOpensDate,"onUpdate:modelValue":f[2]||(f[2]=$=>a(y).bookingOpensDate=$),format:a(jt)(),lang:a(r),"disabled-date":m},null,8,["modelValue","format","lang"])]),_:1},8,["label","rules","class"]),I(k,{label:`${a(o).time}:`,prop:"bookingOpensTime",rules:{required:!0,message:a(o).select_time_warning,trigger:["blur","change"]},class:B(["am-capei-per__item am-w-50",a(s)])},{default:L(()=>[I(Ta,{modelValue:a(y).bookingOpensTime,"onUpdate:modelValue":f[3]||(f[3]=$=>a(y).bookingOpensTime=$),placeholder:a(o).select_time,step:a(Nt)(a(i).general.timeSlotLength),start:"00:00",end:"24:00",clearable:!1},null,8,["modelValue","placeholder","step"])]),_:1},8,["label","rules","class"])],64)),a(D)?(c(),U(dt,{key:1,modelValue:a(y).bookingOpensRec,"onUpdate:modelValue":f[4]||(f[4]=$=>a(y).bookingOpensRec=$)},{default:L(()=>[re(x(a(o).apply_to_all)+" ",1),I(T,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(o).event_booking_closes_apply},null,8,yb)]),default:L(()=>[I(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1},8,["modelValue"])):N("",!0)]),d("div",bb,[I(dt,{modelValue:a(y).bookingClosesDisabled,"onUpdate:modelValue":f[5]||(f[5]=$=>a(y).bookingClosesDisabled=$),label:a(o).event_booking_closes_after},null,8,["modelValue","label"]),a(y).bookingClosesDisabled?N("",!0):(c(),C(ae,{key:0},[I(k,{label:`${a(o).date}:`,prop:"bookingClosesDate",rules:{required:!0,message:a(o).select_date_warning,trigger:["blur","change"]},class:B(["am-capei-per__item am-w-50",a(s)])},{default:L(()=>[I(Yt,{modelValue:a(y).bookingClosesDate,"onUpdate:modelValue":f[6]||(f[6]=$=>a(y).bookingClosesDate=$),format:a(jt)(),lang:a(r),"disabled-date":m},null,8,["modelValue","format","lang"])]),_:1},8,["label","rules","class"]),I(k,{label:`${a(o).time}:`,prop:"bookingClosesTime",rules:{required:!0,message:a(o).select_time_warning,trigger:["blur","change"]},class:B(["am-capei-per__item am-w-50",a(s)])},{default:L(()=>[I(Ta,{modelValue:a(y).bookingClosesTime,"onUpdate:modelValue":f[7]||(f[7]=$=>a(y).bookingClosesTime=$),step:a(Nt)(a(i).general.timeSlotLength),start:"00:00",end:"24:00",clearable:!1,placeholder:a(o).select_time},null,8,["modelValue","step","placeholder"])]),_:1},8,["label","rules","class"])],64)),a(D)?(c(),U(dt,{key:1,modelValue:a(y).bookingClosesRec,"onUpdate:modelValue":f[8]||(f[8]=$=>a(y).bookingClosesRec=$)},{default:L(()=>[re(x(a(o).apply_to_all)+" ",1),I(T,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(o).event_booking_closes_apply},null,8,kb)]),default:L(()=>[I(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),_:1},8,["modelValue"])):N("",!0)])]),_:1},8,["model","style"])}}};const xb={class:"am-capei-recurr__header"},wb={class:"am-capei-recurr__header-text"},Tb={props:{pageWidth:{type:Number,default:0},recurringUntil:{type:Object,default:null}},setup(n,{expose:t}){const e=n;let s=_(()=>st(e.pageWidth));const l=De();let i=V("amLabels"),o=V("localLanguage"),r=O([{label:i.value.day,value:"daily"},{label:i.value.week,value:"weekly"},{label:i.value.month,value:"monthly"},{label:i.value.year,value:"yearly"}]),u=O([{label:i.value.recurring_date_first,value:"first"},{label:i.value.recurring_date_second,value:"second"},{label:i.value.recurring_date_third,value:"third"},{label:i.value.recurring_date_fourth,value:"fourth"},{label:i.value.recurring_date_fifth,value:"fifth"},{label:i.value.recurring_date_last,value:"last"}]),m=[{label:i.value.weekday_monday,value:"monday"},{label:i.value.weekday_tuesday,value:"tuesday"},{label:i.value.weekday_wednesday,value:"wednesday"},{label:i.value.weekday_thursday,value:"thursday"},{label:i.value.weekday_friday,value:"friday"},{label:i.value.weekday_saturday,value:"saturday"},{label:i.value.weekday_sunday,value:"sunday"}],h=O(null),v=O({enabled:_({get:()=>l.getters["event/getRecurringEnabled"],set:A=>{l.commit("event/setRecurringEnabled",A)}}),cycle:_({get:()=>l.getters["event/getRecurringCycle"],set:A=>{l.commit("event/setRecurringCycle",A)}}),cycleInterval:_({get:()=>l.getters["event/getRecurringCycleInterval"],set:A=>{l.commit("event/setRecurringCycleInterval",A)}}),monthDate:_({get:()=>l.getters["event/getRecurringMonthDate"],set:A=>{l.commit("event/setRecurringMonthDate",A)}}),monthlyOnDay:_({get:()=>l.getters["event/getRecurringMonthlyOnDay"],set:A=>{l.commit("event/setRecurringMonthlyOnDay",A)}}),monthlyOnRepeat:_({get:()=>l.getters["event/getRecurringMonthlyOnRepeat"],set:A=>{l.commit("event/setRecurringMonthlyOnRepeat",A)}}),monthlyRepeat:_({get:()=>l.getters["event/getRecurringMonthlyRepeat"],set:A=>{l.commit("event/setRecurringMonthlyRepeat",A)}}),order:_({get:()=>l.getters["event/getRecurringOrder"],set:A=>{l.commit("event/setRecurringOrder",A)}}),until:_({get:()=>l.getters["event/getRecurringUntil"],set:A=>{l.commit("event/setRecurringUntil",A)}})}),g=_(()=>({cycle:[{required:!0,message:i.value.select_cycle_warning,trigger:["submit","change"]}],until:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}],monthDate:[{required:!0,message:i.value.select_date_warning,trigger:["submit","change"]}]})),b=_(()=>l.getters["event/getPeriods"]),D=_(()=>e.recurringUntil!==null?e.recurringUntil:b.value.length?Ke(b.value[0].startDate,"YYYY-MM-DD"):Ke());function P(A){return Ke(A)<=D.value}t({recurringFormRef:h});let y=V("amColors"),w=_(()=>({"--am-c-capei-recurr-text":y.value.colorMainText,"--am-c-capei-recurr-text-op03":W(y.value.colorMainText,.03),"--am-c-capei-recurr-inp-bgr-op03":W(y.value.colorInpBgr,.03),"--am-c-capei-recurr-bgr-op03":W(y.value.colorMainText,.03)}));return(A,S)=>{const f=vt,k=et;return c(),C("div",{class:"am-capei-recurr",style:ke(a(w))},[d("div",xb,[d("div",wb,x(a(i).event_recurring_check),1),I(lt,{modelValue:a(v).enabled,"onUpdate:modelValue":S[0]||(S[0]=T=>a(v).enabled=T),disabled:!a(b).length||!a(b)[0].startDate||!a(b)[0].endDate,"aria-label":a(i).event_recurring_check},null,8,["modelValue","disabled","aria-label"])]),a(v).enabled&&a(b).length&&a(b)[0].startDate&&a(b)[0].endDate?(c(),U(k,{key:0,ref_key:"recurringFormRef",ref:h,rules:a(g),model:a(v),"label-position":"top",class:"am-capei-recurr__form"},{default:L(()=>[I(f,{label:`${a(i).repeat_every}`,class:B(["am-capei-recurr__form-item am-ws-150",a(s)])},{default:L(()=>[I(ht,{modelValue:a(v).cycleInterval,"onUpdate:modelValue":S[1]||(S[1]=T=>a(v).cycleInterval=T),min:1,disabled:a(e).recurringUntil!==null},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),I(f,{prop:"cycle",class:B(["am-capei-recurr__form-item am-inline-ws-150 am-align-end",a(s)])},{default:L(()=>[I(Ze,{modelValue:a(v).cycle,"onUpdate:modelValue":S[2]||(S[2]=T=>a(v).cycle=T),clearable:"",placeholder:a(i).select_repeat_period,disabled:a(e).recurringUntil!==null},{default:L(()=>[(c(!0),C(ae,null,pe(a(r),(T,E)=>(c(),U(Ue,{key:E,value:T.value,label:T.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","disabled"])]),_:1},8,["class"]),a(v).cycle==="monthly"?(c(),U(Rl,{key:0,modelValue:a(v).monthlyRepeat,"onUpdate:modelValue":S[6]||(S[6]=T=>a(v).monthlyRepeat=T),class:"am-w-100",disabled:a(e).recurringUntil!==null},{default:L(()=>[I(f,{class:"am-capei-recurr__form-item"},{default:L(()=>[I(Sa,{value:"each"},{default:L(()=>[re(x(a(i).recurrence_each),1)]),_:1})]),_:1}),I(f,{prop:"monthDate",class:"am-capei-recurr__form-item"},{default:L(()=>[I(Yt,{modelValue:a(v).monthDate,"onUpdate:modelValue":S[3]||(S[3]=T=>a(v).monthDate=T),disabled:a(v).monthlyRepeat==="on"||a(e).recurringUntil!==null,format:a(jt)(),lang:a(o),placeholder:a(i).select_date},null,8,["modelValue","disabled","format","lang","placeholder"])]),_:1}),I(f,{prop:"on",class:"am-capei-recurr__form-item"},{default:L(()=>[I(Sa,{value:"on"},{default:L(()=>[re(x(a(i).recurrence_on),1)]),_:1})]),_:1}),I(f,{class:B(["am-capei-recurr__form-item am-w-50",a(s)])},{default:L(()=>[I(Ze,{modelValue:a(v).monthlyOnRepeat,"onUpdate:modelValue":S[4]||(S[4]=T=>a(v).monthlyOnRepeat=T),disabled:a(v).monthlyRepeat==="each"||a(e).recurringUntil!==null,placeholder:a(i).select_repeat_period},{default:L(()=>[(c(!0),C(ae,null,pe(a(u),(T,E)=>(c(),U(Ue,{key:E,value:T.value,label:T.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["class"]),I(f,{class:B(["am-capei-recurr__form-item am-w-50",a(s)])},{default:L(()=>[I(Ze,{modelValue:a(v).monthlyOnDay,"onUpdate:modelValue":S[5]||(S[5]=T=>a(v).monthlyOnDay=T),disabled:a(v).monthlyRepeat==="each",placeholder:a(i).select_repeat_period},{default:L(()=>[(c(!0),C(ae,null,pe(a(m),(T,E)=>(c(),U(Ue,{key:E,value:T.value,label:T.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder"])]),_:1},8,["class"])]),_:1},8,["modelValue","disabled"])):N("",!0),I(f,{label:a(i).event_recurring_until,prop:"until",class:"am-capei-recurr__form-item"},{default:L(()=>[I(Yt,{modelValue:a(v).until,"onUpdate:modelValue":S[7]||(S[7]=T=>a(v).until=T),format:a(jt)(),lang:a(o),"disabled-date":P,placeholder:a(i).select_date},null,8,["modelValue","format","lang","placeholder"])]),_:1},8,["label"])]),_:1},8,["rules","model"])):N("",!0)],4)}}};const Lb={class:"am-capei-price__heading"},Eb={key:0,class:"am-capei-price__segment"},Sb={key:0,class:"am-capei-price__block"},Ab={class:"am-capei-price__block-header"},Ib={class:"am-capei-price__block-header__text"},$b={key:1,class:"am-capei-price__segment"},Db={key:1,class:"am-capei-price__block"},Pb={class:"am-capei-price__block-header"},Nb={class:"am-capei-price__block-header__text"},Ob={key:0,class:"am-capei-price__block-heading am-pl-32 am-pr-44"},Mb={class:"am-capei-price__block-heading__item am-custom-pricing am-w-40"},Fb={class:"am-capei-price__block-heading__item am-custom-pricing am-w-30"},Vb={class:"am-capei-price__block-heading__item am-custom-pricing am-w-30"},Bb={key:1,class:"am-separator am-order-6"},Rb=d("div",{class:"am-separator"},null,-1),qb={class:"am-capei-price__part"},Ub=d("div",{class:"am-separator"},null,-1),zb={class:"am-capei-price__block-header"},jb={class:"am-capei-price__block-header__text"},Yb={key:1,class:"am-capei-price__block-segment"},Wb={key:0,class:"am-capei-price__block-heading"},Hb={class:"am-capei-price__block-heading__item am-custom-date am-w-50"},Zb={class:"am-capei-price__block-heading__item am-custom-date am-w-50"},Gb=d("div",{class:"am-separator"},null,-1),Jb={key:2,class:"am-capei-price__block"},Xb={class:"am-capei-price__block-header"},Qb={class:"am-capei-price__block-header__text"},Kb={key:0,class:"am-capei-price__part"},e0={key:3,class:"am-capei-price__block"},t0={class:"am-capei-price__block-header"},a0={class:"am-capei-price__block-header__text"},s0={key:0,class:"am-capei-price__part"},l0={props:{pageWidth:{type:Number,default:0}},setup(n,{expose:t}){const e=n;let s=_(()=>st(e.pageWidth)),l=De(),i=V("amLabels"),o=V("localLanguage"),r=V("licence"),u={components:{IconComponent:We},template:'<IconComponent icon="plus"/>'};function m(E){let $=me(E),R=!1;if(f.value.customTicketsRanges.forEach(K=>{!R&&K.range[0]&&K.range[1]&&(R=me(K.range[0])<=$&&me(K.range[1])>=$)}),R)return!0;let Y=l.getters["event/getBookingOpensDisabled"]?me():me(l.getters["event/getBookingOpensDate"]),M=l.getters["event/getBookingClosesDisabled"]?l.getters["event/getPeriods"][0].startDate?me(l.getters["event/getPeriods"][0].startDate,"YYYY-MM-DD"):me():me(l.getters["event/getBookingClosesDate"]);return $<Y||$>M}let h=_(()=>l.getters["event/getEvent"]),v=_(()=>f.value.customPricing?f.value.customTickets.reduce((E,$)=>E+$.spots,0)>1:f.value.maxCapacity>1),g=_(()=>f.value.customPricing?f.value.customTickets.reduce((E,$)=>E+$.spots,0):0),b=_(()=>f.value.customPricing&&f.value.maxCustomCapacityEnabled?f.value.maxCustomCapacity:f.value.customPricing?g.value:f.value.maxCapacity);function D(){f.value.customPricing&&f.value.customTickets.length===0&&y()}function P(E){f.value.customTickets.splice(E,1)}function y(){f.value.customTickets.push({enabled:!0,name:"",spots:1,waitingListSpots:0,price:0}),f.value.customTicketsRanges.forEach(E=>{E.tickets.push(new Object({price:0}))})}function w(E){f.value.customTicketsRanges.splice(E,1)}function A(){f.value.customTicketsRanges.push({range:["",""],tickets:f.value.customTickets.map(E=>new Object({price:E.price}))})}const S=O(null);let f=O({price:_({get:()=>l.getters["event/getPrice"],set:E=>{l.commit("event/setPrice",E)}}),maxCapacity:_({get:()=>l.getters["event/getMaxCapacity"],set:E=>{l.commit("event/setMaxCapacity",E)}}),bringingAnyone:_({get:()=>l.getters["event/getBringingAnyone"],set:E=>{l.commit("event/setBringingAnyone",E)}}),aggregatedPrice:_({get:()=>l.getters["event/getAggregatedPrice"],set:E=>{l.commit("event/setAggregatedPrice",E)}}),bookMultipleTimes:_({get:()=>l.getters["event/getBookMultipleTimes"],set:E=>{l.commit("event/setBookMultipleTimes",E)}}),depositEnabled:_({get:()=>l.getters["event/getDepositEnabled"],set:E=>{l.commit("event/setDepositEnabled",E)}}),deposit:_({get:()=>l.getters["event/getDeposit"],set:E=>{l.commit("event/setDeposit",E)}}),depositPayment:_({get:()=>l.getters["event/getDepositPayment"],set:E=>{l.commit("event/setDepositPayment",E)}}),depositPerPerson:_({get:()=>l.getters["event/getDepositPerPerson"],set:E=>{l.commit("event/setDepositPerPerson",E)}}),fullPayment:_({get:()=>l.getters["event/getFullPayment"],set:E=>{l.commit("event/setFullPayment",E)}}),customPricing:_({get:()=>l.getters["event/getCustomPricing"],set:E=>{l.commit("event/setCustomPricing",E)}}),customTickets:_({get:()=>l.getters["event/getCustomTickets"],set:E=>{l.commit("event/setCustomTickets",E)}}),customTicketsRangesEnabled:_({get:()=>l.getters["event/getCustomTicketsRangesEnabled"],set:E=>{l.commit("event/setCustomTicketsRangesEnabled",E)}}),customTicketsRanges:_({get:()=>l.getters["event/getCustomTicketsRanges"],set:E=>{l.commit("event/setCustomTicketsRanges",E)}}),maxCustomCapacityEnabled:_({get:()=>l.getters["event/getMaxCustomCapacityEnabled"],set:E=>{l.commit("event/setMaxCustomCapacityEnabled",E)}}),maxCustomCapacity:_({get:()=>l.getters["event/getMaxCustomCapacity"],set:E=>{l.commit("event/setMaxCustomCapacity",E)}}),closeAfterMinEnabled:_({get:()=>l.getters["event/getCloseAfterMinEnabled"],set:E=>{l.commit("event/setCloseAfterMinEnabled",E)}}),closeAfterMin:_({get:()=>l.getters["event/getCloseAfterMin"],set:E=>{l.commit("event/setCloseAfterMin",E)}}),closeAfterMinBookings:_({get:()=>l.getters["event/getCloseAfterMinBookings"],set:E=>{l.commit("event/setCloseAfterMinBookings",E)}}),maxExtraPeopleEnabled:_({get:()=>l.getters["event/getMaxExtraPeopleEnabled"],set:E=>{l.commit("event/setMaxExtraPeopleEnabled",E)}}),maxExtraPeople:_({get:()=>l.getters["event/getMaxExtraPeople"],set:E=>{l.commit("event/setMaxExtraPeople",E)}})});t({pricingFormRef:S});let k=V("amColors"),T=_(()=>({"--am-c-capei-price-text":k.value.colorMainText,"--am-c-capei-price-text-op03":W(k.value.colorMainText,.03),"--am-c-capei-price-inp-bgr-op03":W(k.value.colorInpBgr,.03)}));return(E,$)=>{const R=vt,Y=et;return c(),U(Y,{ref_key:"pricingFormRef",ref:S,model:a(f),style:ke(a(T)),class:"am-capei-price"},{default:L(()=>[d("div",Lb,[I(R,{label:`${a(i).price}:`,class:B(["am-capei-price__item am-w-50",a(s)])},{default:L(()=>[I(mt,{modelValue:a(f).price,"onUpdate:modelValue":$[0]||($[0]=M=>a(f).price=M),disabled:a(f).customPricing,"is-money":!0},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),I(R,{label:`${a(i).event_max_capacity}:`,class:B(["am-capei-price__item am-w-50",a(s)])},{default:L(()=>[I(ht,{modelValue:a(f).maxCapacity,"onUpdate:modelValue":$[1]||($[1]=M=>a(f).maxCapacity=M),disabled:a(f).customPricing,min:1},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]),a(v)?(c(),C("div",Eb,[I(dt,{modelValue:a(f).bringingAnyone,"onUpdate:modelValue":$[2]||($[2]=M=>a(f).bringingAnyone=M),label:a(i).event_bringing_anyone},null,8,["modelValue","label"]),a(f).bringingAnyone?(c(),U(dt,{key:0,modelValue:a(f).aggregatedPrice,"onUpdate:modelValue":$[3]||($[3]=M=>a(f).aggregatedPrice=M),label:a(i).event_aggregated_price},null,8,["modelValue","label"])):N("",!0),I(dt,{modelValue:a(f).bookMultipleTimes,"onUpdate:modelValue":$[4]||($[4]=M=>a(f).bookMultipleTimes=M),label:a(i).event_book_more_than_once},null,8,["modelValue","label"])])):N("",!0)]),a(r).isStarter?N("",!0):(c(),C("div",Sb,[d("div",Ab,[d("div",Ib,x(a(i).deposit_enabled),1),I(lt,{modelValue:a(f).depositEnabled,"onUpdate:modelValue":$[5]||($[5]=M=>a(f).depositEnabled=M),"aria-label":a(i).deposit_enabled},null,8,["modelValue","aria-label"])]),a(f).depositEnabled?(c(),C(ae,{key:0},[I(R,{label:`${a(i).deposit_payment}:`,class:B(["am-capei-price__item am-w-50",a(s)])},{default:L(()=>[I(Ze,{modelValue:a(f).depositPayment,"onUpdate:modelValue":$[6]||($[6]=M=>a(f).depositPayment=M)},{default:L(()=>[I(Ue,{value:"percentage",label:a(i).amount_percentage},null,8,["label"]),I(Ue,{value:"fixed",label:a(i).amount_fixed},null,8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label","class"]),a(f).depositPayment==="fixed"?(c(),U(R,{key:0,label:`${a(i).amount} (${a(ac)()}):`,class:B(["am-capei-price__item am-w-50",a(s)])},{default:L(()=>[I(mt,{modelValue:a(f).deposit,"onUpdate:modelValue":$[7]||($[7]=M=>a(f).deposit=M),"is-money":!0},null,8,["modelValue"])]),_:1},8,["label","class"])):N("",!0),a(f).depositPayment==="percentage"?(c(),U(R,{key:1,label:`${a(i).amount} (%):`,class:B(["am-capei-price__item am-w-50",a(s)])},{default:L(()=>[I(ht,{modelValue:a(f).deposit,"onUpdate:modelValue":$[8]||($[8]=M=>a(f).deposit=M),min:1,max:100},null,8,["modelValue"])]),_:1},8,["label","class"])):N("",!0)],64)):N("",!0),a(f).depositEnabled?(c(),C("div",$b,[I(dt,{modelValue:a(f).depositPerPerson,"onUpdate:modelValue":$[9]||($[9]=M=>a(f).depositPerPerson=M),label:a(i).deposit_per_person},null,8,["modelValue","label"]),I(dt,{modelValue:a(f).fullPayment,"onUpdate:modelValue":$[10]||($[10]=M=>a(f).fullPayment=M),label:a(i).allow_total_event_amount},null,8,["modelValue","label"])])):N("",!0)])),a(r).isStarter?N("",!0):(c(),C("div",Db,[d("div",Pb,[d("div",Nb,x(a(i).custom_pricing_enabled),1),I(lt,{modelValue:a(f).customPricing,"onUpdate:modelValue":$[11]||($[11]=M=>a(f).customPricing=M),disabled:a(h).bookings&&a(h).bookings.length>0,"aria-label":a(i).custom_pricing_enabled,onChange:D},null,8,["modelValue","disabled","aria-label"])]),a(f).customPricing?(c(),C(ae,{key:0},[e.pageWidth>545?(c(),C("div",Ob,[d("div",Mb,x(a(i).name)+": ",1),d("div",Fb,x(a(i).price)+": ",1),d("div",Vb,x(a(i).spots)+": ",1)])):N("",!0),(c(!0),C(ae,null,pe(a(f).customTickets,(M,K)=>(c(),C("div",{key:K,class:"am-capei-price__block-segment am-custom-76"},[d("div",{class:B(["am-capei-price__block-inner am-ws-16",{"am-mt-22":e.pageWidth<546}])},[I(R,null,{default:L(()=>[I(dt,{modelValue:M.enabled,"onUpdate:modelValue":ce=>M.enabled=ce},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)],2),d("div",{class:B(["am-capei-price__block-inner",[{"am-we-40":e.pageWidth>545},{"am-we-100":e.pageWidth<546}]])},[I(R,{label:e.pageWidth<546?`${a(i).name}:`:""},{default:L(()=>[I(mt,{modelValue:M.name,"onUpdate:modelValue":ce=>M.name=ce,disabled:!M.enabled,"aria-label":a(i).name},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),d("div",{class:B(["am-capei-price__block-inner",[{"am-we-30":e.pageWidth>545},{"am-w-50 am-order-2":e.pageWidth<546},{"am-w-100":e.pageWidth<401}]])},[I(R,{label:e.pageWidth<546?a(i).price:""},{default:L(()=>[I(mt,{modelValue:M.price,"onUpdate:modelValue":ce=>M.price=ce,disabled:!M.enabled,"is-money":!0,"aria-label":a(i).price},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),d("div",{class:B(["am-capei-price__block-inner",[{"am-we-30":e.pageWidth>545},{"am-w-50 am-order-3":e.pageWidth<546},{"am-w-100":e.pageWidth<401}]])},[I(R,{label:e.pageWidth<546?`${a(i).spots}:`:""},{default:L(()=>[I(ht,{modelValue:M.spots,"onUpdate:modelValue":ce=>M.spots=ce,min:1,disabled:!M.enabled||a(f).maxCustomCapacityEnabled,"aria-label":a(i).spots},null,8,["modelValue","onUpdate:modelValue","disabled","aria-label"])]),_:2},1032,["label"])],2),!M.booked&&a(f).customTickets.length>1?(c(),C("div",{key:0,class:B(["am-capei-price__block-delete",{"am-order-1 am-mt-22":e.pageWidth<546}])},[I(Te,{category:"secondary",type:"plain",size:"mini","icon-only":!0,icon:{components:{IconComponent:We},template:"<IconComponent icon='bucket'/>"},onClick:ce=>P(K)},null,8,["icon","onClick"])],2)):N("",!0),e.pageWidth<546?(c(),C("div",Bb)):N("",!0)]))),128)),I(Te,{icon:a(u),prefix:"plus",size:"default",category:"primary",type:"filled",onClick:y},{default:L(()=>[re(x(a(i).add_ticket_category),1)]),_:1},8,["icon"]),Rb,d("div",qb,[d("div",{class:B(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},[I(dt,{modelValue:a(f).maxCustomCapacityEnabled,"onUpdate:modelValue":$[12]||($[12]=M=>a(f).maxCustomCapacityEnabled=M),label:`${a(i).event_max_capacity}:`},null,8,["modelValue","label"])],2),d("div",{class:B(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},[I(ht,{modelValue:a(f).maxCustomCapacity,"onUpdate:modelValue":$[13]||($[13]=M=>a(f).maxCustomCapacity=M),min:1,disabled:!a(f).maxCustomCapacityEnabled},null,8,["modelValue","disabled"])],2)]),Ub,d("div",zb,[d("div",jb,x(a(i).pricing_by_date_enabled),1),I(lt,{modelValue:a(f).customTicketsRangesEnabled,"onUpdate:modelValue":$[14]||($[14]=M=>a(f).customTicketsRangesEnabled=M),"aria-label":a(i).pricing_by_date_enabled},null,8,["modelValue","aria-label"])]),a(f).customTicketsRangesEnabled?(c(),C("div",Yb,[(c(!0),C(ae,null,pe(a(f).customTicketsRanges,(M,K)=>(c(),C(ae,{key:K},[I(R,{label:`${a(i).event_date_range}:`,class:"am-capei-price__date-range"},{default:L(()=>[I(Yt,{modelValue:M.range,"onUpdate:modelValue":ce=>M.range=ce,type:"daterange",format:a(jt)(),placeholder:"Pick a day",lang:a(o),"disabled-date":m,"start-placeholder":a(i).start_date,"end-placeholder":a(i).end_date},null,8,["modelValue","onUpdate:modelValue","format","lang","start-placeholder","end-placeholder"]),I(Te,{category:"secondary",type:"plain",size:"mini","icon-only":!0,icon:{components:{IconComponent:We},template:"<IconComponent icon='bucket'/>"},"aria-label":a(i).delete,onClick:ce=>w(K)},null,8,["icon","aria-label","onClick"])]),_:2},1032,["label"]),e.pageWidth>545?(c(),C("div",Wb,[d("div",Hb,x(a(i).name)+": ",1),d("div",Zb,x(a(i).price)+": ",1)])):N("",!0),(c(!0),C(ae,null,pe(a(f).customTickets,(ce,j)=>(c(),C(ae,{key:j},[d("div",{class:B(["am-capei-price__block-inner",[{"am-w-50":e.pageWidth>545},{"am-w-100":e.pageWidth<546}]])},[I(R,{label:e.pageWidth<546?`${a(i).name}:`:""},{default:L(()=>[I(mt,{modelValue:ce.name,"onUpdate:modelValue":ie=>ce.name=ie,disabled:!0,"aria-label":a(i).name},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),_:2},1032,["label"])],2),d("div",{class:B(["am-capei-price__block-inner",[{"am-w-50":e.pageWidth>545},{"am-w-100":e.pageWidth<546}]])},[I(R,{label:e.pageWidth<546?`${a(i).price}:`:""},{default:L(()=>[I(mt,{modelValue:M.tickets[j].price,"onUpdate:modelValue":ie=>M.tickets[j].price=ie,"is-money":!0,"aria-label":a(i).price},null,8,["modelValue","onUpdate:modelValue","aria-label"])]),_:2},1032,["label"])],2)],64))),128)),Gb],64))),128)),I(Te,{icon:a(u),prefix:"plus",size:"default",category:"primary",type:"filled",onClick:A},{default:L(()=>[re(x(a(i).event_add_date_range),1)]),_:1},8,["icon"])])):N("",!0)],64)):N("",!0)])),a(f).maxCapacity>1||a(f).maxCustomCapacity>1||a(g)>1?(c(),C("div",Jb,[d("div",Xb,[d("div",Qb,x(a(i).event_close_after_min),1),I(lt,{modelValue:a(f).closeAfterMinEnabled,"onUpdate:modelValue":$[15]||($[15]=M=>a(f).closeAfterMinEnabled=M),"aria-label":a(i).event_close_after_min},null,8,["modelValue","aria-label"])]),a(f).closeAfterMinEnabled&&(a(f).maxCapacity>1||a(f).maxCustomCapacity>1||a(g)>1)?(c(),C("div",Kb,[I(Rl,{modelValue:a(f).closeAfterMinBookings,"onUpdate:modelValue":$[16]||($[16]=M=>a(f).closeAfterMinBookings=M),class:B(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},{default:L(()=>[I(Sa,{value:!1},{default:L(()=>[re(x(a(i).event_close_min_total),1)]),_:1}),I(Sa,{value:!0},{default:L(()=>[re(x(a(i).event_close_min_bookings),1)]),_:1})]),_:1},8,["modelValue","class"]),I(R,{class:B(["am-capei-price__part-item",[{"am-w-100":e.pageWidth<546},{"am-w-50":e.pageWidth>545}]])},{default:L(()=>[I(ht,{modelValue:a(f).closeAfterMin,"onUpdate:modelValue":$[17]||($[17]=M=>a(f).closeAfterMin=M),min:1,max:a(b)},null,8,["modelValue","max"])]),_:1},8,["class"])])):N("",!0)])):N("",!0),a(f).maxCapacity>1||a(f).maxCustomCapacity>1||a(g)>1?(c(),C("div",e0,[d("div",t0,[d("div",a0,x(a(i).limit_extra_people),1),I(lt,{modelValue:a(f).maxExtraPeopleEnabled,"onUpdate:modelValue":$[18]||($[18]=M=>a(f).maxExtraPeopleEnabled=M),"aria-label":a(i).limit_extra_people},null,8,["modelValue","aria-label"])]),a(f).maxExtraPeopleEnabled&&(a(f).maxCapacity>1||a(f).maxCustomCapacity>1||a(g)>1)?(c(),C("div",s0,[I(R,{label:`${a(i).limit_extra_people_set}:`,class:"am-capei-price__part-item am-w-100"},{default:L(()=>[I(ht,{modelValue:a(f).maxExtraPeople,"onUpdate:modelValue":$[19]||($[19]=M=>a(f).maxExtraPeople=M),min:0,max:a(b)-1},null,8,["modelValue","max"])]),_:1},8,["label"])])):N("",!0)])):N("",!0)]),_:1},8,["model","style"])}}};const n0={class:"am-capei-custef__heading"},i0={class:"am-capei-custef__colors"},o0=["onClick"],r0={key:0,class:"am-icon-check"},c0={setup(n){let t=De(),e=V("amLabels");const s=O(null);let l=O(1),i=O(["#1788FB","#4BBEC6","#FBC22D","#FA3C52","#D696B8","#689BCA","#26CC2B","#FD7E35","#E38587","#774DFB"]),o=O({color:_({get:()=>t.getters["event/getColor"],set:r=>{t.commit("event/setColor",r)}}),show:_({get:()=>t.getters["event/getShow"],set:r=>{t.commit("event/setShow",r)}})});return Je(()=>{let r=t.getters["event/getColor"];i.value.filter(m=>m===r).length>0?l.value=1:l.value=2}),(r,u)=>{const m=vt,h=sc,v=et;return c(),U(v,{ref_key:"customizeFormRef",ref:s,model:a(o),class:"am-capei-custef"},{default:L(()=>[d("div",n0,x(a(e).event_colors),1),I(Rl,{modelValue:a(l),"onUpdate:modelValue":u[2]||(u[2]=g=>we(l)?l.value=g:l=g)},{default:L(()=>[I(m,{class:"am-capei-custef__item"},{default:L(()=>[I(Sa,{value:1},{default:L(()=>[re(x(a(e).event_colors_preset)+": ",1)]),_:1}),d("div",i0,[(c(!0),C(ae,null,pe(a(i),g=>(c(),C("div",{key:g,class:B(["am-capei-custef__colors-item",{"am-disabled":a(l)===2}]),onClick:b=>a(t).commit("event/setColor",g)},[d("div",{class:"am-capei-custef__colors-item__inner",style:ke({backgroundColor:g})},[g===a(o).color?(c(),C("span",r0)):N("",!0)],4)],10,o0))),128))])]),_:1}),I(m,{class:"am-capei-custef__item"},{default:L(()=>[I(Sa,{value:2},{default:L(()=>[re(x(a(e).event_colors_custom)+": ",1)]),_:1}),I(h,{modelValue:a(o).color,"onUpdate:modelValue":u[0]||(u[0]=g=>a(o).color=g),disabled:a(l)===1,"aria-label":a(e).event_colors_custom},null,8,["modelValue","disabled","aria-label"])]),_:1}),I(m,{class:"am-capei-custef__item"},{default:L(()=>[I(dt,{modelValue:a(o).show,"onUpdate:modelValue":u[1]||(u[1]=g=>a(o).show=g),label:a(e).event_show_on_site},null,8,["modelValue","label"])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model"])}}};const u0={class:"am-capei-waiting__header"},d0={class:"am-capei-waiting__header-text"},m0={class:"am-capei-waiting__header"},p0={class:"am-capei-waiting__header-text"},g0={props:{pageWidth:{type:Number,default:0},waitingListUntil:{type:Object,default:null}},setup(n,{expose:t}){const e=n;let s=_(()=>st(e.pageWidth));const l=De();let i=V("amLabels"),o=O(null),r=O({enabled:_({get:()=>l.getters["event/getWaitingListEnabled"],set:b=>{l.commit("event/setWaitingListEnabled",b)}}),maxCapacity:_({get:()=>l.getters["event/getWaitingListMaxCapacity"],set:b=>{l.commit("event/setWaitingListMaxCapacity",b)}}),maxExtraPeopleEnabled:_({get:()=>l.getters["event/getWaitingListMaxExtraPeopleEnabled"],set:b=>{l.commit("event/setWaitingListMaxExtraPeopleEnabled",b)}}),maxExtraPeople:_({get:()=>l.getters["event/getWaitingListMaxExtraPeople"],set:b=>{l.commit("event/setWaitingListMaxExtraPeople",b)}})}),u=_(()=>l.getters["event/getCustomTickets"]),m=_(()=>l.getters["event/getCustomPricing"]),h=_(()=>l.getters["event/getMaxCustomCapacityEnabled"]);t({waitingListFormRef:o});let v=V("amColors"),g=_(()=>({"--am-c-capei-waiting-text":v.value.colorMainText,"--am-c-capei-waiting-text-op03":W(v.value.colorMainText,.03),"--am-c-capei-waiting-inp-bgr-op03":W(v.value.colorInpBgr,.03),"--am-c-capei-waiting-bgr-op05":W(v.value.colorPrimary,.05)}));return(b,D)=>{const P=vt,y=et;return c(),C("div",{class:"am-capei-waiting",style:ke(a(g))},[d("div",u0,[d("div",d0,x(a(i).events_show_waiting_list_booking_full),1),I(lt,{modelValue:a(r).enabled,"onUpdate:modelValue":D[0]||(D[0]=w=>a(r).enabled=w),"aria-label":a(i).events_show_waiting_list_booking_full},null,8,["modelValue","aria-label"])]),a(r).enabled?(c(),U(y,{key:0,ref_key:"waitingListFormRef",ref:o,model:a(r),"label-position":"top"},{default:L(()=>[!a(m)||a(h)?(c(),U(P,{key:0,label:`${a(i).maximum_capacity}`,class:B(["am-capei-waiting__item",a(s)])},{default:L(()=>[I(ht,{modelValue:a(r).maxCapacity,"onUpdate:modelValue":D[1]||(D[1]=w=>a(r).maxCapacity=w),min:1},null,8,["modelValue"])]),_:1},8,["label","class"])):N("",!0),a(m)?(c(!0),C(ae,{key:1},pe(a(u),(w,A)=>(c(),U(P,{key:A,label:w.name,class:B(["am-capei-waiting__item",a(s)])},{default:L(()=>[I(ht,{modelValue:w.waitingListSpots,"onUpdate:modelValue":S=>w.waitingListSpots=S,min:1,disabled:a(h)},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","class"]))),128)):N("",!0),d("div",m0,[d("div",p0,x(a(i).limit_extra_people),1),I(lt,{modelValue:a(r).maxExtraPeopleEnabled,"onUpdate:modelValue":D[2]||(D[2]=w=>a(r).maxExtraPeopleEnabled=w),"aria-label":a(i).limit_extra_people},null,8,["modelValue","aria-label"])]),a(r).maxExtraPeopleEnabled?(c(),U(P,{key:2,class:B(a(s))},{default:L(()=>[I(ht,{modelValue:a(r).maxExtraPeople,"onUpdate:modelValue":D[3]||(D[3]=w=>a(r).maxExtraPeople=w),min:0,disabled:!a(r).maxExtraPeopleEnabled},null,8,["modelValue","disabled"])]),_:1},8,["class"])):N("",!0)]),_:1},8,["model"])):N("",!0)],4)}}};const f0={class:"am-capei-sef__header"},h0=d("span",{class:"am-icon-options"},null,-1),_0={class:"am-capei-sef__header-text"},v0={class:"am-capei-sef__content"},y0=["innerHTML"],b0=["innerHTML"],k0={class:"am-capei-sef__header"},C0=d("span",{class:"am-icon-payments"},null,-1),x0={class:"am-capei-sef__header-text"},w0={class:"am-capei-sef__content"},T0={class:"am-capei-sef__segment"},L0={key:0,class:"am-capei-sef__heading"},E0={class:"am-capei-sef__heading-text"},S0=["innerHTML"],A0=["innerHTML"],I0={key:0,class:"am-capei-sef__heading"},$0={class:"am-capei-sef__heading-text"},D0={class:"am-capei-sef__segment"},P0={key:0,class:"am-capei-sef__heading"},N0={class:"am-capei-sef__heading-text"},O0={key:1,class:"am-capei-sef__heading"},M0=["src"],F0={key:2,class:"am-capei-sef__heading"},V0=["src"],B0={key:3,class:"am-capei-sef__heading"},R0=["src"],q0={key:4,class:"am-capei-sef__heading"},U0=["src"],z0={key:5,class:"am-capei-sef__heading"},j0=["src"],Y0={class:"am-capei-sef__header"},W0=d("span",{class:"am-icon-options"},null,-1),H0={class:"am-capei-sef__header-text"},Z0={key:0,class:"am-capei-sef__heading"},G0={class:"am-capei-sef__heading-text"},J0={key:1,class:"am-capei-sef__heading"},X0={class:"am-capei-sef__heading-text"},Q0={key:2,class:"am-capei-sef__heading"},K0={class:"am-capei-sef__heading-text"},ek={setup(n){let t=De(),e=V("licence"),s=V("amLabels");const l=V("settings"),i=V("baseUrls");let o=O([{label:s.value.disabled,value:0},{label:s.value.min10,value:600},{label:s.value.min12,value:720},{label:s.value.min15,value:900},{label:s.value.min30,value:1800},{label:s.value.min45,value:2700},{label:s.value.h1,value:3600},{label:s.value.h1min30,value:5400},{label:s.value.h2,value:7200},{label:s.value.h3,value:10800},{label:s.value.h4,value:14400},{label:s.value.h6,value:21600},{label:s.value.h8,value:28800},{label:s.value.h9,value:32400},{label:s.value.h10,value:36e3},{label:s.value.h11,value:39600},{label:s.value.h12,value:43200},{label:s.value.day1,value:86400},{label:s.value.days2,value:172800},{label:s.value.days3,value:259200},{label:s.value.days4,value:345600},{label:s.value.days5,value:432e3},{label:s.value.days6,value:518400},{label:s.value.week1,value:604800},{label:s.value.weeks2,value:1209600},{label:s.value.weeks3,value:1814400},{label:s.value.weeks4,value:2419200},{label:s.value.months3,value:7884e3},{label:s.value.months6,value:15768e3}]),r=O([]),u=O(!1),m=O(0),h=O(null),v=_(()=>{if(r.value.length){let f=r.value.find(k=>k.id===l.payments.wc.productId);return typeof f<"u"?f.name:s.value.select}return""});function g(){l.payments.wc.enabled&&b({id:w.value.paymentsWcProductId},f=>{r.value=f.length?f:[]})}function b(f,k){clearTimeout(h.value),u.value=!0,m.value++,h.value=setTimeout(()=>{let T=m.value;Pe.get("/payment/wc/products",{params:f}).then(E=>{T>=m.value&&k(E.data.data.products.sort(($,R)=>$.name.toLowerCase()>R.name.toLowerCase()?1:-1))}).finally(()=>{u.value=!1})},500)}function D(f){f&&b({name:f},k=>{r.value=k})}let P=O("");const y=O(null);let w=O({generalMinimumTimeRequirementPriorToCanceling:_({get:()=>t.getters["event/getSettingsGeneralMinimumTimeRequirementPriorToCanceling"],set:f=>{t.commit("event/setSettingsGeneralMinimumTimeRequirementPriorToCanceling",f)}}),generalRedirectUrlAfterAppointment:_({get:()=>t.getters["event/getSettingsGeneralRedirectUrlAfterAppointment"],set:f=>{t.commit("event/setSettingsGeneralRedirectUrlAfterAppointment",f)}}),paymentsPaymentLinksEnabled:_({get:()=>t.getters["event/getSettingsPaymentsPaymentLinksEnabled"],set:f=>{t.commit("event/setSettingsPaymentsPaymentLinksEnabled",f)}}),paymentsPaymentLinksRedirectUrl:_({get:()=>t.getters["event/getSettingsPaymentsPaymentLinksRedirectUrl"],set:f=>{t.commit("event/setSettingsPaymentsPaymentLinksRedirectUrl",f)}}),paymentsOnSite:_({get:()=>t.getters["event/getSettingsPaymentsOnSite"],set:f=>{t.commit("event/setSettingsPaymentsOnSite",f)}}),paymentsWcEnabled:_({get:()=>t.getters["event/getSettingsPaymentsWcEnabled"],set:f=>{t.commit("event/setSettingsPaymentsWcEnabled",f)}}),paymentsWcProductId:_({get:()=>t.getters["event/getSettingsPaymentsWcProductId"],set:f=>{t.commit("event/setSettingsPaymentsWcProductId",f)}}),paymentsStripeEnabled:_({get:()=>t.getters["event/getSettingsPaymentsStripeEnabled"],set:f=>{t.commit("event/setSettingsPaymentsStripeEnabled",f)}}),paymentsPayPalEnabled:_({get:()=>t.getters["event/getSettingsPaymentsPayPalEnabled"],set:f=>{t.commit("event/setSettingsPaymentsPayPalEnabled",f)}}),paymentsMollieEnabled:_({get:()=>t.getters["event/getSettingsPaymentsMollieEnabled"],set:f=>{t.commit("event/setSettingsPaymentsMollieEnabled",f)}}),paymentsRazorpayEnabled:_({get:()=>t.getters["event/getSettingsPaymentsRazorpayEnabled"],set:f=>{t.commit("event/setSettingsPaymentsRazorpayEnabled",f)}}),paymentsSquareEnabled:_({get:()=>t.getters["event/getSettingsPaymentsSquareEnabled"],set:f=>{t.commit("event/setSettingsPaymentsSquareEnabled",f)}}),integrationsGoogleMeetEnabled:_({get:()=>t.getters["event/getSettingsIntegrationsGoogleMeetEnabled"],set:f=>{t.commit("event/setSettingsIntegrationsGoogleMeetEnabled",f)}}),integrationsMicrosoftTeamsEnabled:_({get:()=>t.getters["event/getSettingsIntegrationsMicrosoftTeamsEnabled"],set:f=>{t.commit("event/setSettingsIntegrationsMicrosoftTeamsEnabled",f)}}),integrationsLessonSpaceEnabled:_({get:()=>t.getters["event/getSettingsIntegrationsLessonSpaceEnabled"],set:f=>{t.commit("event/setSettingsIntegrationsLessonSpaceEnabled",f)}})});Je(()=>{w.value.generalMinimumTimeRequirementPriorToCanceling===l.general.minimumTimeRequirementPriorToCanceling&&t.commit("event/setSettingsGeneralMinimumTimeRequirementPriorToCanceling",""),w.value.generalRedirectUrlAfterAppointment===l.general.redirectUrlAfterAppointment&&t.commit("event/setSettingsGeneralRedirectUrlAfterAppointment",""),w.value.paymentsPaymentLinksRedirectUrl===l.payments.paymentLinks.redirectUrl&&t.commit("event/setSettingsPaymentsPaymentLinksRedirectUrl",""),g()});let A=V("amColors"),S=_(()=>({"--am-c-capei-sef-primary":A.value.colorPrimary,"--am-c-capei-sef-text":A.value.colorMainText,"--am-c-capei-sef-text-op03":W(A.value.colorMainText,.03),"--am-c-capei-sef-bgr":A.value.colorMainBgr}));return(f,k)=>{const T=Bl,E=vt,$=ys,R=bs,Y=et;return c(),U(Y,{ref_key:"settingsFormRef",ref:y,model:a(w),class:"am-capei-sef",style:ke(a(S))},{default:L(()=>[I(R,{modelValue:a(P),"onUpdate:modelValue":k[15]||(k[15]=M=>we(P)?P.value=M:P=M),accordion:"",class:"am-capei-sef__collapse"},{default:L(()=>[I($,{name:"general",class:"am-capei-sef__collapse-item"},{title:L(()=>[d("div",f0,[h0,d("div",_0,x(a(s).general),1)])]),default:L(()=>[d("div",v0,[I(E,null,{label:L(()=>[re(x(a(s).minimum_time_before_canceling)+" ",1),I(T,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(s).minimum_time_before_canceling_tooltip},null,8,y0)]),default:L(()=>[I(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:L(()=>[I(Ze,{modelValue:a(w).generalMinimumTimeRequirementPriorToCanceling,"onUpdate:modelValue":k[0]||(k[0]=M=>a(w).generalMinimumTimeRequirementPriorToCanceling=M),placeholder:a(o).find(M=>M.value===a(l).general.minimumTimeRequirementPriorToCanceling).label,clearable:""},{default:L(()=>[(c(!0),C(ae,null,pe(a(o),(M,K)=>(c(),U(Ue,{key:K,value:M.value,label:M.label},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder"])]),_:1}),I(E,null,{label:L(()=>[re(x(a(s).redirect_url_after_appointment)+" ",1),I(T,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(s).redirect_url_after_appointment_tooltip},null,8,b0)]),default:L(()=>[I(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:L(()=>[I(mt,{modelValue:a(w).generalRedirectUrlAfterAppointment,"onUpdate:modelValue":k[1]||(k[1]=M=>a(w).generalRedirectUrlAfterAppointment=M),placeholder:a(l).general.redirectUrlAfterAppointment},null,8,["modelValue","placeholder"])]),_:1})])]),_:1}),I($,{name:"payment",class:"am-capei-sef__collapse-item"},{title:L(()=>[d("div",k0,[C0,d("div",x0,x(a(s).payments),1)])]),default:L(()=>[d("div",w0,[d("div",T0,[a(e).isStarter?N("",!0):(c(),C("div",L0,[d("div",E0,[re(x(a(s).payment_links_enable)+" ",1),I(T,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(s).payment_links_enable_tooltip},null,8,S0)]),default:L(()=>[I(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),I(lt,{modelValue:a(w).paymentsPaymentLinksEnabled,"onUpdate:modelValue":k[2]||(k[2]=M=>a(w).paymentsPaymentLinksEnabled=M)},null,8,["modelValue"])])),a(w).paymentsPaymentLinksEnabled&&!a(e).isStarter?(c(),U(E,{key:1,label:a(s).redirect_url_after_appointment},{label:L(()=>[re(x(a(s).redirect_url_after_appointment)+" ",1),I(T,{effect:"dark",placement:"top"},{content:L(()=>[d("div",{innerHTML:a(e).isPro||a(e).isDeveloper?a(s).redirect_url_after_app_or_package_tt:a(s).redirect_url_after_appointment_tooltip},null,8,A0)]),default:L(()=>[I(We,{class:"am-tooltip__trigger",icon:"info-reverse"})]),_:1})]),default:L(()=>[I(mt,{modelValue:a(w).paymentsPaymentLinksRedirectUrl,"onUpdate:modelValue":k[3]||(k[3]=M=>a(w).paymentsPaymentLinksRedirectUrl=M),placeholder:a(l).payments.paymentLinks.redirectUrl},null,8,["modelValue","placeholder"])]),_:1},8,["label"])):N("",!0)]),a(l).payments.onSite?(c(),C("div",I0,[d("div",$0,x(a(s).on_site),1),I(lt,{modelValue:a(w).paymentsOnSite,"onUpdate:modelValue":k[4]||(k[4]=M=>a(w).paymentsOnSite=M)},null,8,["modelValue"])])):N("",!0),d("div",D0,[a(l).payments.wc.enabled?(c(),C("div",P0,[d("div",N0,x(a(s).wc_service),1),I(lt,{modelValue:a(w).paymentsWcEnabled,"onUpdate:modelValue":k[5]||(k[5]=M=>a(w).paymentsWcEnabled=M)},null,8,["modelValue"])])):N("",!0),a(w).paymentsWcEnabled?(c(),U(E,{key:1},{default:L(()=>[I(Ze,{modelValue:a(w).paymentsWcProductId,"onUpdate:modelValue":k[6]||(k[6]=M=>a(w).paymentsWcProductId=M),clearable:"",filterable:"",remote:"",placeholder:a(v),loading:a(u),"remote-method":D},{default:L(()=>[(c(!0),C(ae,null,pe(a(r),(M,K)=>(c(),U(Ue,{key:K,value:M.id,label:M.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","loading"])]),_:1})):N("",!0)]),a(l).payments.payPal.enabled?(c(),C("div",O0,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/paypal-light.svg",alt:"PayPal"},null,8,M0),I(lt,{modelValue:a(w).paymentsPayPalEnabled,"onUpdate:modelValue":k[7]||(k[7]=M=>a(w).paymentsPayPalEnabled=M)},null,8,["modelValue"])])):N("",!0),a(l).payments.stripe.enabled?(c(),C("div",F0,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/stripe.svg",alt:"Stripe"},null,8,V0),I(lt,{modelValue:a(w).paymentsStripeEnabled,"onUpdate:modelValue":k[8]||(k[8]=M=>a(w).paymentsStripeEnabled=M)},null,8,["modelValue"])])):N("",!0),a(l).payments.mollie.enabled?(c(),C("div",B0,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/mollie.svg",alt:"Mollie"},null,8,R0),I(lt,{modelValue:a(w).paymentsMollieEnabled,"onUpdate:modelValue":k[9]||(k[9]=M=>a(w).paymentsMollieEnabled=M)},null,8,["modelValue"])])):N("",!0),a(l).payments.square.enabled?(c(),C("div",q0,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/square.svg",alt:"Square"},null,8,U0),I(lt,{modelValue:a(w).paymentsSquareEnabled,"onUpdate:modelValue":k[10]||(k[10]=M=>a(w).paymentsSquareEnabled=M)},null,8,["modelValue"])])):N("",!0),a(l).payments.razorpay.enabled?(c(),C("div",z0,[d("img",{style:{width:"60px"},src:a(i).wpAmeliaPluginURL+"public/img/payments/razorpay.svg",alt:"Razorpay"},null,8,j0),I(lt,{modelValue:a(w).paymentsRazorpayEnabled,"onUpdate:modelValue":k[11]||(k[11]=M=>a(w).paymentsRazorpayEnabled=M)},null,8,["modelValue"])])):N("",!0)])]),_:1}),a(l).googleCalendar.enabled&&a(l).googleMeet.enabled||a(l).outlookCalendar.enabled&&a(l).microsoftTeams.enabled||a(l).lessonSpace.enabled?(c(),U($,{key:0,name:"integrations",class:"am-capei-sef__collapse-item"},{title:L(()=>[d("div",Y0,[W0,d("div",H0,x(a(s).integrations_settings),1)])]),default:L(()=>[a(l).googleCalendar.enabled&&a(l).googleMeet.enabled?(c(),C("div",Z0,[d("div",G0,x(a(s).enable_google_meet),1),I(lt,{modelValue:a(w).integrationsGoogleMeetEnabled,"onUpdate:modelValue":k[12]||(k[12]=M=>a(w).integrationsGoogleMeetEnabled=M)},null,8,["modelValue"])])):N("",!0),a(l).outlookCalendar.enabled&&a(l).microsoftTeams.enabled?(c(),C("div",J0,[d("div",X0,x(a(s).enable_microsoft_teams),1),I(lt,{modelValue:a(w).integrationsMicrosoftTeamsEnabled,"onUpdate:modelValue":k[13]||(k[13]=M=>a(w).integrationsMicrosoftTeamsEnabled=M)},null,8,["modelValue"])])):N("",!0),a(l).lessonSpace.enabled?(c(),C("div",Q0,[d("div",K0,x(a(s).lesson_space),1),I(lt,{modelValue:a(w).integrationsLessonSpaceEnabled,"onUpdate:modelValue":k[14]||(k[14]=M=>a(w).integrationsLessonSpaceEnabled=M)},null,8,["modelValue"])])):N("",!0)]),_:1})):N("",!0)]),_:1},8,["modelValue"])]),_:1},8,["model","style"])}}};const tk={class:"am-capei__footer-actions"},ak={name:"CabinetEvent"},sk=Object.assign(ak,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number}},emits:["close","save","duplicate"],setup(n,{emit:t}){const e=n;let s=De(),l=V("amLabels");const i=V("settings");let o=V("licence");const r=O("details");let u=O(null),m=O(null),h=O(null),v=O(null),g=O(null),b=O(!0),D=O(!1),P=O(!1);function y(){t("duplicate",Object.assign(JSON.parse(JSON.stringify(s.getters["event/getEvent"])),{id:null,bookings:[]}))}async function w(){let $=!0;await new Promise(R=>{u.value?.detailsFormRef.validate(Y=>{Y||(r.value="details",$=!1),R()})}),$&&(await new Promise(R=>{m.value?.periodsFormRef.validate(Y=>{Y||(r.value="periods",$=!1),R()})}),$&&(s.getters["event/getRecurringEnabled"]&&(await new Promise(R=>{h.value?.recurringFormRef.validate(Y=>{Y||(r.value="recurring",$=!1),R()})}),!$)||f(R=>{R?P.value=!0:S()})))}function A($){b.value=!0,Pe.post("/events"+(s.getters["event/getId"]?"/"+s.getters["event/getId"]:""),Object.assign(mb(s),{applyGlobally:$}),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{ub(s),k("save")}).catch(R=>{console.log(R)}).finally(()=>{b.value=!1})}function S(){g.value?(b.value=!1,P.value=!1,D.value=!0):A(!1)}function f($){let R=s.getters["event/getOrganizerId"]?s.getters["employee/getEmployee"]:null;if(R&&(R.googleCalendar||R.outlookCalendar)){b.value=!0;let Y=s.getters["event/getProviders"].map(M=>new Object({id:M.id}));Pe.post("/events/calendar",{providers:s.getters["event/getProviders"].map(M=>M.id).indexOf(R.id)===-1?Y.concat([{id:R.id}]):Y,periods:Tr(s),eventIds:[s.getters["event/getId"],s.getters["event/getParentId"]],recurring:s.getters["event/getRecurring"]},Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{$(!1)}).catch(()=>{$(!0),b.value=!1})}else $(!1)}function k($){s.commit("event/setActive",!1),t($)}Je(()=>{s.getters["event/getId"]&&s.getters["event/getRecurringUntil"]&&(g.value=Ke(s.getters["event/getRecurringUntil"].toISOString().split("T")[0])),s.commit("event/setActive",!0),b.value=!1});let T=V("amColors"),E=_(()=>({"--am-c-capei-text":T.value.colorMainText,"--am-c-capei-text-op10":W(T.value.colorMainText,.1),"--am-c-capei-primary":T.value.colorPrimary,"--am-c-cust-no1":T.value.colorMainText,"--am-c-cust-no1-bgr":W(T.value.colorMainText,.1),"--am-c-cust-no2":T.value.colorWarning,"--am-c-cust-no2-bgr":W(T.value.colorWarning,.1),"--am-c-cust-no3":T.value.colorError,"--am-c-cust-no3-bgr":W(T.value.colorError,.1),"--am-c-cust-link":W(T.value.colorMainText,.5),"--am-c-cust-text":T.value.colorMainText}));return($,R)=>{const Y=Ia,M=$a;return c(),C(ae,null,[a(b)?(c(),U(Wt,{key:1})):(c(),C("div",{key:0,class:B(["am-capei",a(e).responsiveClass]),style:ke(a(E))},[I(M,{modelValue:r.value,"onUpdate:modelValue":R[0]||(R[0]=K=>r.value=K),class:"am-ap__tabs"},{default:L(()=>[I(Y,{label:a(l).details,name:"details"},{default:L(()=>[I(fb,{ref_key:"eventDetailsRef",ref:u},null,512)]),_:1},8,["label"]),I(Y,{label:a(l).periods,name:"periods"},{default:L(()=>[I(Cb,{ref_key:"eventPeriodsRef",ref:m,"page-width":a(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"]),a(o).isStarter?N("",!0):(c(),U(Y,{key:0,label:a(l).recurring,name:"recurring"},{default:L(()=>[I(Tb,{ref_key:"eventRecurringRef",ref:h,"page-width":a(e).pageWidth,"recurring-until":a(g)},null,8,["page-width","recurring-until"])]),_:1},8,["label"])),I(Y,{label:a(l).pricing,name:"pricing"},{default:L(()=>[I(l0,{ref_key:"eventPricingRef",ref:v,"page-width":a(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"]),I(Y,{label:a(l).customize,name:"customize"},{default:L(()=>[I(c0)]),_:1},8,["label"]),a(i).appointments.waitingListEvents.enabled&&!a(o).isStarter&&!a(o).isBasic?(c(),U(Y,{key:1,label:a(l).waiting_list,name:"waitingList"},{default:L(()=>[I(g0,{"page-width":a(e).pageWidth},null,8,["page-width"])]),_:1},8,["label"])):N("",!0),I(Y,{label:a(l).settings,name:"settings"},{default:L(()=>[I(ek)]),_:1},8,["label"])]),_:1},8,["modelValue"]),d("div",{class:B(["am-capei__footer",[{"am-capei__footer_new":!a(s).getters["event/getId"]},a(e).responsiveClass]])},[a(s).getters["event/getId"]?(c(),U(Te,{key:0,class:"am-capei__footer-duplicate","icon-only":!0,icon:"duplicate",type:"plain",category:"secondary",onClick:y})):N("",!0),d("div",tk,[I(Te,{category:"secondary",size:"default",type:"plain",onClick:R[1]||(R[1]=()=>{a(t)("close")})},{default:L(()=>[re(x(a(l).cancel),1)]),_:1}),I(Te,{size:"default",onClick:w},{default:L(()=>[re(x(a(l).save),1)]),_:1})])],2)],6)),I(Ua,{visibility:a(D)&&a(g)!==null,title:a(l).confirm,description:a(l).confirm_save_following,"close-btn-text":a(l).save_single,"confirm-btn-text":a(l).update_following,"customized-options":{cancelBtn:{type:"plain"},confirmBtn:{type:""}},onDecline:R[2]||(R[2]=K=>A(!1)),onConfirm:R[3]||(R[3]=K=>A(!0)),onClose:R[4]||(R[4]=K=>we(D)?D.value=!1:D=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"]),I(Ua,{visibility:a(P),title:a(l).confirm,description:a(l).confirm_save_conflict,"close-btn-text":a(l).cancel,"confirm-btn-text":a(l).confirm,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:R[5]||(R[5]=K=>we(P)?P.value=!1:P=!1),onConfirm:S,onClose:R[6]||(R[6]=K=>we(P)?P.value=!1:P=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],64)}}});const lk={class:"am-cap__att"},nk={class:"am-cap-customers"},ik={class:"am-cap__cust-option"},ok={class:"am-cap__cust-option__heading"},rk={key:0,class:"am-cap__cust-option__inner"},ck={key:1,class:"am-cap__cust-option__inner"},uk={key:0,class:"am-cap-cust__data-wrapper"},dk={key:0,class:"am-cap-cust__data"},mk=d("span",{class:"am-icon-phone"},null,-1),pk=["href"],gk={key:1,class:"am-cap-cust__data"},fk=d("span",{class:"am-icon-email"},null,-1),hk=["href"],_k={class:"am-cap__att-heading"},vk={props:{event:{type:Object,default:()=>{}},isNew:{type:Boolean,default:!1},pageWidth:{type:Number,required:!0}},setup(n,{expose:t}){const e=n;let s=_(()=>st(e.pageWidth)),l=De(),i=V("amLabels");const o=V("settings"),r=V("shortcodeData");let u=V("amCustomize"),m=_(()=>r.value.cabinetType==="employee"?u.value.events.options.customerPhone.visibility:!0),h=_(()=>r.value.cabinetType==="employee"?u.value.events.options.customerEmail.visibility:!0),v=O(null),g=O({customerId:_({get:()=>l.getters["attendee/getCustomerId"],set:Y=>l.commit("attendee/setCustomerId",Y)}),status:_({get:()=>l.getters["attendee/getStatus"],set:Y=>l.commit("attendee/setStatus",Y)}),persons:_({get:()=>l.getters["attendee/getPersons"],set:Y=>l.commit("attendee/setPersons",Y)}),tickets:_({get:()=>l.getters["attendee/getTickets"],set:Y=>l.commit("attendee/setTickets",Y)})}),b=O({customerId:[{required:!0,message:i.value.select_customer,trigger:["submit","change"]}]}),D=_(()=>e.event.settings?JSON.parse(e.event.settings):null),P=O(Er().filter(Y=>Y.value!=="canceled"&&(!o.appointments.waitingListEvents.enabled||(D.value?"waitingList"in D.value&&!D.value.waitingList.enabled:!0)?Y.value!=="waiting":!0)&&Y.value!=="no-show")),y=_(()=>l.getters["customerInfo/getLoading"]),w=_(()=>l.getters["customerInfo/getCustomers"]),A=_(()=>g.value.customerId?w.value.find(Y=>Y.id===g.value.customerId):null);function S(Y){l.dispatch("customerInfo/resetCustomer"),l.commit("customerInfo/setLoading",!0),f.value=!0,Pe.get("/users/customers/"+Y,Object.assign({params:{source:"cabinet-provider"}},ze(l))).then(M=>{l.commit("customerInfo/setCustomer",kr(l,M.data.data.user))}).catch(M=>{console.log(M)}).finally(()=>{l.commit("customerInfo/setLoading",!1)})}let f=O(!1);function k(){l.dispatch("customerInfo/resetCustomer"),f.value=!0}function T(Y){l.commit("customerInfo/setCustomers",[Y]),l.commit("attendee/setCustomerId",Y.id)}Je(()=>{l.getters["attendee/getId"]||l.commit("customerInfo/setCustomers",l.getters["auth/getPreloadedCustomers"])}),t({detailsFormRef:v});function E(Y){if(Y){if(Y===1)return{class:"am-no-show-1",icon:"no-show-1"};if(Y===2)return{class:"am-no-show-2",icon:"no-show-2"};if(Y>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}let $=V("amColors"),R=_(()=>({"--am-c-cust-no1":$.value.colorMainText,"--am-c-cust-no1-bgr":W($.value.colorMainText,.1),"--am-c-cust-no2":$.value.colorWarning,"--am-c-cust-no2-bgr":W($.value.colorWarning,.1),"--am-c-cust-no3":$.value.colorError,"--am-c-cust-no3-bgr":W($.value.colorError,.1),"--am-c-cust-text":$.value.colorMainText,"--am-c-cust-link":W($.value.colorMainText,.5)}));return(Y,M)=>{const K=vt,ce=et;return c(),C("div",lk,[I(ce,{ref_key:"detailsFormRef",ref:v,model:a(g),rules:a(b),class:"am-cap__att-form"},{default:L(()=>[d("div",nk,[e.isNew?(c(),U(K,{key:0,prop:"customerId",class:"am-cap__att-form__item am-w-100"},{default:L(()=>[I(Ze,{modelValue:a(g).customerId,"onUpdate:modelValue":M[0]||(M[0]=j=>a(g).customerId=j),filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","prefix-icon":"search","prefix-icon-color":"var(--am-c-inp-text)","popper-class":"am-cap-cust__popper",placeholder:a(i).event_attendees_search,"remote-method":j=>{a(Ws)(a(l),j)},loading:a(y),onFocus:M[1]||(M[1]=j=>a(Pi)(a(l)))},{default:L(()=>[(c(!0),C(ae,null,pe(a(w),j=>(c(),U(Ue,{key:j.id,value:j.id,label:j.email?j.email:j.firstName+" "+j.lastName},{default:L(()=>[d("div",ik,[d("div",ok,x(j.firstName+" "+j.lastName),1),j.email&&a(h)?(c(),C("div",rk,x(j.email),1)):N("",!0),j.phone&&a(m)?(c(),C("div",ck,x(j.phone),1)):N("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"])]),_:1})):N("",!0),!a(l).getters["attendee/getId"]&&a(o).roles.allowWriteCustomers?(c(),U(Te,{key:1,class:B(["am-capai-cuf__heading-add",e.responsiveClass]),size:"default",disabled:!!a(g).customerId,prefix:"plus",icon:"plus","icon-only":e.pageWidth<=420,onClick:k},{default:L(()=>[re(x(a(i).new_customer),1)]),_:1},8,["class","disabled","icon-only"])):N("",!0)]),a(A)?(c(),C("div",{key:0,class:B(["am-cap-attendee",a(s)])},[d("div",{class:B(["am-cap-cust",a(s)]),style:ke(a(R))},[d("div",{class:B(["am-cap-cust__name",E(0).class])},[E(0).icon?(c(),C("span",{key:0,class:B(`am-icon-${E(0).icon}`)},null,2)):N("",!0),re(" "+x(a(A).firstName+" "+a(A).lastName),1)],2),a(A).phone&&a(m)||a(A).email&&a(h)?(c(),C("div",uk,[a(A).phone&&a(m)?(c(),C("div",dk,[mk,d("a",{href:`tel:${a(A).phone}`},x(a(A).phone),9,pk)])):N("",!0),a(A).email&&a(h)?(c(),C("div",gk,[fk,d("a",{href:`mailto:${a(A).email}`},x(a(A).email),9,hk)])):N("",!0)])):N("",!0)],6),I(K,{prop:"status",class:B(["am-cap__att-form__item",a(s)])},{default:L(()=>[I(Ze,{modelValue:a(g).status,"onUpdate:modelValue":M[2]||(M[2]=j=>a(g).status=j),disabled:!e.isNew,placeholder:a(i).select,"prefix-icon":a(P).find(j=>j.value===a(g).status).icon,"prefix-icon-color":a(P).find(j=>j.value===a(g).status).color,"popper-class":"am-capei-att__popper"},{default:L(()=>[(c(!0),C(ae,null,pe(a(P),j=>(c(),U(Ue,{key:j.value,value:j.value,label:j.label},{default:L(()=>[d("span",{class:B(`am-icon-${j.icon}`),style:ke({color:j.color})},null,6),re(" "+x(j.label),1)]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","disabled","placeholder","prefix-icon","prefix-icon-color"])]),_:1},8,["class"]),a(o).roles.allowWriteCustomers?(c(),U(ha,{key:0,"have-delete":!1,"reference-class":a(s),onEdit:M[3]||(M[3]=j=>S(a(A).id))},null,8,["reference-class"])):N("",!0)],2)):N("",!0),a(A)?(c(),C(ae,{key:1},[e.event.customPricing?(c(),C(ae,{key:1},[d("div",_k,x(`${a(i).event_book_tickets}:`),1),(c(!0),C(ae,null,pe(a(g).tickets,(j,ie)=>(c(),U(K,{key:ie,label:e.event.customTickets.find(se=>se.id===j.eventTicketId).name,class:B(["am-cap__att-form__item",a(s)])},{default:L(()=>[I(ht,{modelValue:j.persons,"onUpdate:modelValue":se=>j.persons=se,min:0,disabled:!a(o).roles.allowWriteEvents},null,8,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1032,["label","class"]))),128))],64)):(c(),U(K,{key:0,prop:"persons",label:`${a(i).event_book_persons}:`,class:B(["am-cap__att-form__item",a(s)])},{default:L(()=>[I(ht,{modelValue:a(g).persons,"onUpdate:modelValue":M[4]||(M[4]=j=>a(g).persons=j),min:1,disabled:!a(o).roles.allowWriteEvents},null,8,["modelValue","disabled"])]),_:1},8,["label","class"]))],64)):N("",!0),a(A)?N("",!0):(c(),U(Aa,{key:2,heading:a(i).no_attendees_yet},null,8,["heading"]))]),_:1},8,["model","rules"]),a(f)?(c(),U(xr,{key:0,visibility:a(f),"responsive-class":e.responsiveClass,"onUpdate:visibility":M[5]||(M[5]=j=>we(f)?f.value=j:f=j),onAddedCustomer:T},null,8,["visibility","responsive-class"])):N("",!0)])}}};const yk={props:{responsiveClass:{type:String,default:""}},setup(n,{expose:t}){const e=n;let s=De();const l=V("settings");let i=V("amLabels"),o=O(null),r=O({}),u=O({}),m=O({}),h=_(()=>s.getters["attendee/getCustomFields"]);function v(D,P){let y=s.getters["attendee/getId"];(D.type!=="file"||y)&&(r.value[P]=_({get:()=>{let w=s.getters["attendee/getCustomFields"][P]?.value;return w||""},set:w=>s.commit("attendee/setCustomFields",{id:P,value:w})}))}function g(D,P){let y=s.getters["attendee/getId"];(D.type!=="file"||y)&&(m.value[P]={template:Ye[D.type],props:{id:P,itemName:P.toString(),label:D.label,options:D.options,class:`am-capei-att-cf__item am-cf-width-${D.width}`}}),(D.type==="checkbox"||D.type==="radio")&&(m.value[P].props.options=m.value[P].props.options.map(w=>({...w,value:w.label}))),D.type==="text-area"&&(m.value[P].props={...m.value[P].props,itemType:"textarea"}),D.type==="file"&&y&&(m.value[P].props={...m.value[P].props,btnLabel:i.value.upload_file_here,isUpload:!1,bookingId:y,source:"cabinet-provider"}),D.type==="datepicker"&&(m.value[P].props={...m.value[P].props,weekStartsFromDay:l.wordpress.startOfWeek})}function b(D){let P=s.getters["attendee/getId"];(D.type!=="file"||P)&&(u.value[D.id]=[{message:i.value.required_field,required:D.required,trigger:["submit","change"]}])}return Je(()=>{r.value={},m.value={};for(let D in h.value)v(h.value[D],D),g(h.value[D],D),b(h.value[D])}),t({customFieldsFormRef:o}),(D,P)=>{const y=et;return c(),U(y,{ref_key:"customFieldsFormRef",ref:o,model:a(r),rules:a(u),"label-position":"top",class:B(["am-capei-att-cf__form",e.responsiveClass])},{default:L(()=>[(c(!0),C(ae,null,pe(Object.keys(a(h)),w=>(c(),C(ae,{key:w},[w in a(r)?(c(),U(pt(a(m)[w].template),St({key:0,modelValue:a(r)[w],"onUpdate:modelValue":A=>a(r)[w]=A},a(m)[w].props),null,16,["modelValue","onUpdate:modelValue"])):N("",!0)],64))),128))]),_:1},8,["model","rules","class"])}}};const bk={class:"am-capai-pay__row-label"},kk={class:"am-capai-pay__row-value"},Ck={class:"am-capai-pay__row-label"},xk={class:"am-capai-pay__row-value"},wk={class:"am-capai-pay__row-label"},Tk={class:"am-capai-pay__row-value"},Lk={key:0,class:"am-divider"},Ek={class:"am-capai-pay__row-label"},Sk={class:"am-capai-pay__row-label"},Ak={class:"am-capai-pay__row-label"},Ik={class:"am-capai-pay__row-label"},$k={class:"am-capai-pay__row-label"},Dk={class:"am-capai-pay__row-label"},Pk={class:"am-capai-pay__row-label"},Nk={props:{event:{type:Object,default:()=>{}},pageWidth:{type:Number,default:0}},setup(n){const t=n;let e=De(),s=V("amLabels"),l=_(()=>e.getters["attendee/getPayments"]),i=_(()=>Object.assign(Sr(e),{deposit:l.value[0].amount,paid:l.value.reduce((u,m)=>u+m.amount,0)})),o=V("amColors"),r=_(()=>({"--am-c-pay-text-op03":W(o.value.colorMainText,.03)}));return(u,m)=>(c(),C("div",{class:B(["am-capai-pay__content",t.responsiveClass]),style:ke(a(r))},[(c(!0),C(ae,null,pe(a(l),(h,v)=>(c(),C(ae,{key:v},[d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",bk,x(a(s).date),1),d("div",kk,x(a(ot)(h.dateTime.split(" ")[0])),1)],2),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",Ck,x(a(s).payment_method),1),d("div",xk,x(a(wr)(h)),1)],2),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",wk,x(a(s).status),1),d("div",Tk,[d("span",{class:B(a(ms)(h.status,a(o)).icon),style:ke({color:a(ms)(h.status,a(o)).color})},null,6),re(" "+x(a(ri)(h.status)),1)])],2)],64))),128)),t.pageWidth>480?(c(),C("div",Lk)):N("",!0),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",Ek,x(a(s).price),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":t.pageWidth>480}])},x(a(tt)(a(i).price)),3)],2),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",Sk,x(a(s).discount_amount),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":t.pageWidth>480}])},x(a(tt)(a(i).discount)),3)],2),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",Ak,x(a(s).tax),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":t.pageWidth>480}])},x(a(tt)(a(i).tax)),3)],2),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",Ik,x(a(s).paid_deposit),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":t.pageWidth>480}])},x(a(tt)(a(i).deposit)),3)],2),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",$k,x(a(s).paid_remaining_amount),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":t.pageWidth>480}])},x(a(tt)(a(i).paid-a(i).deposit)),3)],2),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",Dk,x(a(s).due),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":t.pageWidth>480}])},x(a(tt)(a(i).paid-(a(i).price-a(i).discount+a(i).tax))),3)],2),d("div",{class:B(["am-capai-pay__row",t.responsiveClass])},[d("div",Pk,x(a(s).total),1),d("div",{class:B(["am-capai-pay__row-value",{"am-pl-34":t.pageWidth>480}])},x(a(tt)(a(i).price-a(i).discount+a(i).tax)),3)],2)],6))}};const Ok=d("span",{class:"am-icon-clearable"},null,-1),Mk={class:"am-capei-atti__footer"},Fk={name:"CabinetEventAttendee"},Ar=Object.assign(Fk,{props:{title:{type:String,default:""},visibility:{type:Boolean,default:!1},isNew:{type:Boolean,default:!1},event:{type:Object,default:()=>{}},pageWidth:{type:Number,default:0}},emits:["close","save"],setup(n,{emit:t}){const e=n;let s=De(),l=V("amLabels");const i=V("settings");let o=O(!1),r=_(()=>s.getters["attendee/getCustomFields"]);const u=O("details");let m=O(null),h=O(null),v=O(!1),g=O(null),b=O("");function D(){v.value=!1,b.value=""}let P=O(!1),y=O();Re("formWrapper",y);function w(){let $=Sr(s);return $.price-$.discount+$.tax}function A(){let $=!0;if(h.value?.customFieldsFormRef.validate(M=>{M||(u.value="customFields",$=!1)}),m.value?.detailsFormRef.validate(M=>{M||(u.value="details",$=!1)}),!$)return;let R=i.payments.paymentLinks&&i.payments.paymentLinks.enabled,Y=e.event.settings?JSON.parse(e.event.settings):null;Y&&"payments"in Y&&"paymentLinks"in Y.payments&&(R=Y.payments.paymentLinks.enabled),R&&s.getters["attendee/getId"]&&w()>f.value?P.value=!0:S(!1)}function S($){o.value=!0,Pe.post(s.getters["attendee/getId"]?"/events/bookings/"+s.getters["attendee/getId"]:"/bookings",Object.assign(Lr(s),{runInstantPostBookingActions:!0,createPaymentLinks:$}),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{t("save"),s.commit("attendee/setActive",!1)}).catch(R=>{console.log(R)}).finally(()=>{o.value=!1})}let f=O(0);function k(){s.commit("attendee/setActive",!1),t("close")}Je(()=>{s.commit("attendee/setActive",!0),s.getters["attendee/getId"]&&(f.value=w())});let T=V("amColors"),E=_(()=>({"--am-c-capai-text":T.value.colorMainText,"--am-c-capai-text-op10":W(T.value.colorMainText,.1),"--am-c-capai-primary":T.value.colorPrimary,"--am-c-cust-no1":T.value.colorMainText,"--am-c-cust-no1-bgr":W(T.value.colorMainText,.1),"--am-c-cust-no2":T.value.colorWarning,"--am-c-cust-no2-bgr":W(T.value.colorWarning,.1),"--am-c-cust-no3":T.value.colorError,"--am-c-cust-no3-bgr":W(T.value.colorError,.1),"--am-c-cust-link":W(T.value.colorMainText,.5),"--am-c-cust-text":T.value.colorMainText}));return($,R)=>{const Y=Ia,M=$a;return a(o)?(c(),U(Wt,{key:1})):(c(),C("div",{key:0,class:B(["am-capei-atti",[{"am-no-border":!0},a(e).responsiveClass]]),style:ke(a(E))},[a(v)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:g,type:"error","show-border":!0,"close-after":1e4,"custom-class":"am-csd__alert",onClose:D,onTriggerClose:D},{title:L(()=>[Ok,re(" "+x(a(b)),1)]),_:1},512)):N("",!0),I(M,{modelValue:u.value,"onUpdate:modelValue":R[0]||(R[0]=K=>u.value=K)},{default:L(()=>[I(Y,{label:a(l).details,name:"details"},{default:L(()=>[I(a(vk),{ref_key:"attendeeDetailsRef",ref:m,event:a(e).event,"is-new":a(e).isNew,"page-width":a(e).pageWidth},null,8,["event","is-new","page-width"])]),_:1},8,["label"]),Object.keys(a(r)).length?(c(),U(Y,{key:0,label:a(l).custom_fields,name:"customFields"},{default:L(()=>[I(a(yk),{ref_key:"attendeeCustomFieldsRef",ref:h,event:a(e).event},null,8,["event"])]),_:1},8,["label"])):N("",!0),a(s).getters["attendee/getId"]?(c(),U(Y,{key:1,label:a(l).payment,name:"payment"},{default:L(()=>[I(a(Nk),{event:a(e).event,"page-width":a(e).pageWidth},null,8,["event","page-width"])]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"]),d("div",Mk,[I(Te,{category:"secondary",size:"default",type:"plain",onClick:k},{default:L(()=>[re(x(a(i).roles.allowWriteEvents?a(l).cancel:a(l).close),1)]),_:1}),a(i).roles.allowWriteEvents?(c(),U(Te,{key:0,size:"default",onClick:A},{default:L(()=>[re(x(a(l).save),1)]),_:1})):N("",!0)]),I(Ua,{visibility:a(P),title:a(l).confirm,description:a(l).price_changed_message,"close-btn-text":a(l).no,"confirm-btn-text":a(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:R[1]||(R[1]=K=>S(!1)),onConfirm:R[2]||(R[2]=K=>S(!0)),onClose:R[3]||(R[3]=K=>we(P)?P.value=!1:P=!1)},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"])],6))}}});const Vk=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),Bk={key:1,class:"am-capei-att__top"},Rk={class:"am-capei-att__top-heading"},qk={class:"am-capei-att__top-text"},Uk={key:0,class:"am-capei-att__top-places"},zk={class:"am-cap__cust-option"},jk={class:"am-cap__cust-option__heading"},Yk={key:0,class:"am-cap__cust-option__inner"},Wk={key:1,class:"am-cap__cust-option__inner"},Hk={key:0,class:"am-capei-att__card-wrapper"},Zk={key:0,class:"am-capei-customer__data-wrapper"},Gk={key:0,class:"am-capei-customer__data"},Jk=d("span",{class:"am-icon-phone"},null,-1),Xk=["href"],Qk={key:1,class:"am-capei-customer__data"},Kk=d("span",{class:"am-icon-email"},null,-1),eC=["href"],tC={key:0,class:"am-capei-att__card-tickets"},aC={class:"am-capei-att__card-label"},sC={class:"am-capei-att__card-tickets__inner"},lC={key:1,class:"am-capei-att__card-persons"},nC={class:"am-capei-att__card-label"},iC={class:"am-capei-att__card-person"},oC={key:0,class:"am-capei-att__card-wrapper"},rC={key:0,class:"am-capei-customer__data-wrapper"},cC={key:0,class:"am-capei-customer__data"},uC=d("span",{class:"am-icon-phone"},null,-1),dC=["href"],mC={key:1,class:"am-capei-customer__data"},pC=d("span",{class:"am-icon-email"},null,-1),gC=["href"],fC={key:0,class:"am-capei-att__card-tickets"},hC={class:"am-capei-att__card-label"},_C={class:"am-capei-att__card-tickets__inner"},vC={key:1,class:"am-capei-att__card-persons"},yC={class:"am-capei-att__card-label"},bC={class:"am-capei-att__card-person"},kC={name:"CabinetEventAttendees"},CC=Object.assign(kC,{props:{responsiveClass:{type:String,default:""},pageWidth:{type:Number},event:{type:Object,default:()=>{}}},emits:["close","openAttendee"],setup(n,{emit:t}){const e=n;let s=De(),l=V("amLabels");const i=V("settings"),o=V("shortcodeData");let r=V("amCustomize"),u=_(()=>o.value.cabinetType==="employee"?r.value.events.options.customerPhone.visibility:!0),m=_(()=>o.value.cabinetType==="employee"?r.value.events.options.customerEmail.visibility:!0),h=O(null),v=O(!1),g=O("success"),b=O("");function D(){v.value=!1,s.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}let P=O(!1),y=O(!1),w=O(!1),A=O([]),S=O(0),f=O(1),k=O(!1),T=O([]),E=O(0),$=O(1),R=_(()=>e.event.settings?JSON.parse(e.event.settings):null);const{noShowData:Y}=V("noShowData");let M=O(!1),K=O(null),ce=O(!1);function j(){K.value=null,M.value=!1}function ie(Me,Be){K.value=Me,ce.value=Be,M.value=!0}let se=O(null);function le(){s.commit("attendee/setActive",!1),v.value=!0,b.value=l.value.event_attendee_saved,se.value&&h.value&&setTimeout(function(){ut(se.value,h.value.$el,0,300)},500),H(ge.value==="approved"?["approved","canceled"]:["waiting"]),te()}function te(){P.value=!1,y.value=!1,t("openAttendee",!1)}function ne(){s.commit("attendee/setAttendee",hs(s,s.getters["attendee/getDefaultAttendee"],e.event)),P.value=!0,t("openAttendee",!0)}function Z(Me){let Be=s.getters["customerInfo/getCustomers"],Ce=s.getters["customerInfo/getCustomersIds"];Be.filter(qe=>qe.id===Me.customer.id).length===0&&(Be.push(Me.customer),s.commit("customerInfo/setCustomers",Be)),Ce.indexOf(Me.customer.id)===-1&&(Ce.push(Me.customer.id),s.commit("customerInfo/setCustomersIds",Ce)),s.commit("attendee/setAttendee",hs(s,Me,e.event)),y.value=!0,P.value=!0,t("openAttendee",!0)}const ge=O("approved");function be(){switch(ge.value){case"approved":f.value=1;break;case"waiting":$.value=1;break}H(ge.value==="approved"?["approved","canceled"]:["waiting"])}let q=O(null),Q=_(()=>s.getters["customerInfo/getLoading"]),G=_(()=>s.getters["customerInfo/getCustomers"]);function H(Me,Be=1){Me[0]==="approved"?w.value=!0:k.value=!0,Pe.get("/bookings/events",Object.assign(ze(s),{params:Js({source:"cabinet-provider",statuses:Me,page:Be,limit:parseInt(i.general.itemsPerPageBackEnd),events:[e.event.id],customers:q.value?[q.value]:[]})})).then(Ce=>{Me[0]==="approved"?(_e.value=Ce.data.data.attendeeCount,Se.value=Ce.data.data.maxCapacity,A.value=Ce.data.data.bookings.filter(qe=>qe.status==="approved"||qe.status==="canceled").reduce((qe,ee)=>(qe.push(hs(s,ko(ee,s.getters["attendee/getAttendee"]),e.event)),qe),[]),S.value=Ce.data.data.filteredCount):(_e.value=Ce.data.data.waitingCount,Se.value=Ce.data.data.waitingCapacity,T.value=Ce.data.data.bookings.filter(qe=>qe.status==="waiting").reduce((qe,ee)=>(qe.push(ko(ee)),qe),[]),E.value=Ce.data.data.filteredCount)}).catch(Ce=>{console.log(Ce)}).finally(()=>{w.value=!1,k.value=!1})}function J(Me,Be){Pe.post("/events/bookings/"+Me,{status:Be,bookings:[{status:Be}]},Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{}).catch(Ce=>{console.log(Ce)}).finally(()=>{})}function X(Me){let Be=ge.value==="approved"?["approved","canceled"]:["waiting"];Be[0]==="approved"?f.value=Me:$.value=Me,H(Be,Me)}function ve(){M.value=!1,ce.value?k.value=!0:w.value=!0,Pe.post("/events/bookings/delete/"+K.value.id,Lr(s),Object.assign(ze(s),{params:{source:"cabinet-provider"}})).then(()=>{X(f.value)}).catch(()=>{k.value=!1,w.value=!1})}let ye=O(Er().filter(Me=>(!i.appointments.waitingListEvents.enabled||(R.value?"waitingList"in R.value&&!R.value.waitingList.enabled:!0)?Me.value!=="waiting":!0)&&(i.roles.enableNoShowTag?!0:Me.value!=="no-show"))),_e=O(0),Se=O(0),Oe=_(()=>`${_e.value}/${Se.value}`),fe=_(()=>_e.value===1?l.value.attendee:l.value.attendees);Je(()=>{H(["approved","canceled"]),s.commit("customerInfo/setCustomers",s.getters["auth/getPreloadedCustomers"])});let Le=V("amColors"),Ne=_(()=>({"--am-c-capei-att-primary":Le.value.colorPrimary,"--am-c-capei-att-text":Le.value.colorMainText,"--am-c-capei-att-text-op90":W(Le.value.colorMainText,.9),"--am-c-capei-att-text-op10":W(Le.value.colorMainText,.1)}));return(Me,Be)=>{const Ce=Ia,qe=$a;return c(),C("div",{ref_key:"attendeesContainer",ref:se,class:"am-capei-att",style:ke(a(Ne))},[a(v)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:h,type:a(g),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:D,onTriggerClose:D},{title:L(()=>[Vk,re(" "+x(a(b)),1)]),_:1},8,["type"])):N("",!0),a(P)?N("",!0):(c(),C("div",Bk,[d("div",Rk,[d("div",qk,x(a(e).event.name),1),a(Se)?(c(),C("div",Uk,x(a(Oe))+" "+x(a(fe)),1)):N("",!0)]),I(Te,{category:"secondary",type:"plain",size:"small",class:"am-capei-att__back",onClick:Be[0]||(Be[0]=ee=>a(t)("close"))},{default:L(()=>[re(x(a(l).back),1)]),_:1})])),a(P)?N("",!0):(c(),C("div",{key:2,class:B(["am-capei-att__header",a(e).responsiveClass])},[I(Ze,{modelValue:a(q),"onUpdate:modelValue":Be[1]||(Be[1]=ee=>we(q)?q.value=ee:q=ee),filterable:"",clearable:"","collapse-tags":"","collapse-tags-tooltip":"",remote:"","prefix-icon":"search","prefix-icon-color":"var(--am-c-capei-att-text)","popper-class":"am-cap-cust__popper",placeholder:a(l).event_attendees_search,"remote-method":ee=>{a(Ws)(a(s),ee)},loading:a(Q),onFocus:Be[2]||(Be[2]=ee=>a(Pi)(a(s))),onChange:Be[3]||(Be[3]=ee=>H(ge.value==="approved"?["approved","canceled"]:["waiting"],1))},{default:L(()=>[(c(!0),C(ae,null,pe(a(G),ee=>(c(),U(Ue,{key:ee.id,value:ee.id,label:`${ee.firstName} ${ee.lastName}`},{default:L(()=>[d("div",zk,[d("div",jk,x(ee.firstName+" "+ee.lastName),1),a(m)?(c(),C("div",Yk,x(ee.email),1)):N("",!0),a(u)?(c(),C("div",Wk,x(ee.phone),1)):N("",!0)])]),_:2},1032,["value","label"]))),128))]),_:1},8,["modelValue","placeholder","remote-method","loading"]),a(i).roles.allowWriteEvents?(c(),U(Te,{key:0,prefix:"plus",icon:"plus","icon-only":a(e).pageWidth<540,onClick:ne},{default:L(()=>[re(x(a(l).event_add_attendee),1)]),_:1},8,["icon-only"])):N("",!0)],2)),a(P)?N("",!0):(c(),U(qe,{key:3,modelValue:ge.value,"onUpdate:modelValue":Be[4]||(Be[4]=ee=>ge.value=ee),onTabClick:be},{default:L(()=>[I(Ce,{label:a(l).attendees,name:"approved"},{default:L(()=>[a(w)?(c(),U(Wt,{key:1})):(c(),C("div",Hk,[a(A).length?(c(),C(ae,{key:0},[(c(!0),C(ae,null,pe(a(A),(ee,he)=>(c(),C("div",{key:he,class:B(["am-capei-att__card",a(e).responsiveClass])},[d("div",{class:B(["am-capei-att__card-inner",a(e).responsiveClass])},[d("div",{class:B(["am-capei-att__info",a(e).responsiveClass])},[d("div",{class:B(["am-capei-customer__name",a(Y)(0).class])},[a(Y)(0).icon?(c(),C("span",{key:0,class:B(`am-icon-${a(Y)(0).icon}`)},null,2)):N("",!0),re(" "+x(ee.customer.firstName+" "+ee.customer.lastName),1)],2),ee.customer.phone&&a(u)||ee.customer.email&&a(m)?(c(),C("div",Zk,[ee.customer.phone&&a(u)?(c(),C("div",Gk,[Jk,d("a",{href:`tel:${ee.customer.phone}`},x(ee.customer.phone),9,Xk)])):N("",!0),ee.customer.email&&a(m)?(c(),C("div",Qk,[Kk,d("a",{href:`mailto:${ee.customer.email}`},x(ee.customer.email),9,eC)])):N("",!0)])):N("",!0)],2),I(Ze,{modelValue:ee.status,"onUpdate:modelValue":de=>ee.status=de,placeholder:a(l).select,disabled:!a(i).roles.allowWriteEvents,"prefix-icon":a(ye).find(de=>de.value===ee.status).icon,"prefix-icon-color":a(ye).find(de=>de.value===ee.status).color,"popper-class":"am-capei-att__popper","parent-class":a(e).responsiveClass,onChange:de=>{J(ee.id,de)}},{default:L(()=>[(c(!0),C(ae,null,pe(a(ye),de=>(c(),U(Ue,{key:de.value,value:de.value,label:de.label},{default:L(()=>[d("span",{class:B(`am-icon-${de.icon}`),style:ke({color:de.color})},null,6),re(" "+x(de.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","prefix-icon","prefix-icon-color","parent-class","onChange"])],2),ee.ticketsData.length?(c(),C("div",tC,[d("div",aC,x(a(l).event_book_tickets)+": ",1),d("div",sC,[(c(!0),C(ae,null,pe(ee.ticketsData,(de,Fe)=>(c(),C("div",{key:Fe,class:"am-capei-att__card-ticket"},x(de.persons)+" x "+x(a(e).event.customTickets.find(xe=>xe.id===de.eventTicketId).name),1))),128))])])):(c(),C("div",lC,[d("div",nC,x(a(l).event_book_persons)+": ",1),d("div",iC,x(ee.persons),1)])),a(i).roles.allowWriteEvents?(c(),U(ha,{key:2,index:he,"reference-class":a(e).responsiveClass,onEdit:de=>Z(ee),onRemove:de=>ie(ee,!1)},null,8,["index","reference-class","onEdit","onRemove"])):N("",!0)],2))),128)),a(S)>a(i).general.itemsPerPageBackEnd?(c(),U(Il,{key:0,"page-size":a(i).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:a(S),"current-page":a(f),onCurrentChange:X},null,8,["page-size","total","current-page"])):N("",!0)],64)):(c(),U(Aa,{key:1,heading:a(l).no_attendees_yet},null,8,["heading"]))]))]),_:1},8,["label"]),a(i).appointments.waitingListEvents.enabled&&a(R)!==null&&"waitingList"in a(R)&&a(R).waitingList.enabled?(c(),U(Ce,{key:0,label:a(l).waiting_list,name:"waiting"},{default:L(()=>[a(k)?(c(),U(Wt,{key:1})):(c(),C("div",oC,[a(T).length?(c(),C(ae,{key:0},[(c(!0),C(ae,null,pe(a(T),(ee,he)=>(c(),C("div",{key:he,class:"am-capei-att__card"},[d("div",{class:B(["am-capei-att__card-inner",a(e).responsiveClass])},[d("div",{class:B(["am-capei-att__info",a(e).responsiveClass])},[d("div",{class:B(["am-capei-customer__name",a(Y)(0).class])},[a(Y)(0).icon?(c(),C("span",{key:0,class:B(`am-icon-${a(Y)(0).icon}`)},null,2)):N("",!0),re(" "+x(ee.customer.firstName+" "+ee.customer.lastName),1)],2),ee.customer.phone&&a(u)||ee.customer.email&&a(m)?(c(),C("div",rC,[ee.customer.phone&&a(u)?(c(),C("div",cC,[uC,d("a",{href:`tel:${ee.customer.phone}`},x(ee.customer.phone),9,dC)])):N("",!0),ee.customer.email&&a(m)?(c(),C("div",mC,[pC,d("a",{href:`mailto:${ee.customer.email}`},x(ee.customer.email),9,gC)])):N("",!0)])):N("",!0)],2),I(Ze,{modelValue:ee.status,"onUpdate:modelValue":de=>ee.status=de,placeholder:a(l).select,disabled:!a(i).roles.allowWriteEvents,"prefix-icon":a(ye).find(de=>de.value===ee.status).icon,"prefix-icon-color":a(ye).find(de=>de.value===ee.status).color,"popper-class":"am-capei-att__popper",onChange:de=>{J(ee.id,de)}},{default:L(()=>[(c(!0),C(ae,null,pe(a(ye),de=>(c(),U(Ue,{key:de.value,value:de.value,label:de.label},{default:L(()=>[d("span",{class:B(`am-icon-${de.icon}`),style:ke({color:de.color})},null,6),re(" "+x(de.label),1)]),_:2},1032,["value","label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","disabled","prefix-icon","prefix-icon-color","onChange"])],2),Object.keys(ee.ticketsData).length?(c(),C("div",fC,[d("div",hC,x(a(l).event_book_tickets)+": ",1),d("div",_C,[(c(!0),C(ae,null,pe(ee.ticketsData,(de,Fe)=>(c(),C("div",{key:Fe,class:"am-capei-att__card-ticket"},x(de.persons)+" x "+x(a(e).event.customTickets.find(xe=>xe.id===de.eventTicketId).name),1))),128))])])):(c(),C("div",vC,[d("div",yC,x(a(l).event_book_persons)+": ",1),d("div",bC,x(ee.persons),1)])),a(i).roles.allowWriteEvents?(c(),U(ha,{key:2,index:he,"reference-class":a(e).responsiveClass,onEdit:de=>Z(ee),onRemove:de=>ie(ee,!0)},null,8,["index","reference-class","onEdit","onRemove"])):N("",!0)]))),128)),a(E)>a(i).general.itemsPerPageBackEnd?(c(),U(Il,{key:0,"page-size":a(i).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:a(E),"current-page":a($),onCurrentChange:X},null,8,["page-size","total","current-page"])):N("",!0)],64)):(c(),U(Aa,{key:1,heading:a(l).no_attendees_yet},null,8,["heading"]))]))]),_:1},8,["label"])):N("",!0)]),_:1},8,["modelValue"])),I(Ua,{visibility:a(M),title:a(l).confirm,description:a(l).event_attendee_remove,"close-btn-text":a(l).no,"confirm-btn-text":a(l).yes,"customized-options":{cancelBtn:{buttonType:"plain"},confirmBtn:{buttonType:"filled"}},onDecline:j,onConfirm:ve,onClose:j},null,8,["visibility","title","description","close-btn-text","confirm-btn-text"]),a(P)?(c(),U(Ar,{key:4,visibility:a(P),title:a(y)?a(l).event_edit_attendee:a(l).event_add_attendee,event:a(e).event,"page-width":a(e).pageWidth,"is-new":!a(y),onSave:le,onClose:te},null,8,["visibility","title","event","page-width","is-new"])):N("",!0)],4)}}});const xC=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),wC={key:2,class:"am-cap__actions"},TC={name:"CabinetEvents",key:"events"},LC=Object.assign(TC,{props:{loadBookingsCounter:{type:Number,default:0}},setup(n){const t=n;let e=De(),s=O(null),{width:l}=ja(s),i=_(()=>st(l.value)),o={components:{IconComponent:We},template:'<IconComponent icon="plus"/>'};const r=V("settings");let u=V("originKey"),m=V("amCustomize");const h=V("shortcodeData"),v=V("labels"),g=V("localLanguage");let b=_(()=>r.general.usedLanguages.includes(g.value)),D=_(()=>{let ee=Qe({...v}),he=m.value.events.translations;return he&&Object.keys(he).forEach(de=>{he[de][g.value]&&b.value?ee[de]=he[de][g.value]:he[de].default&&(ee[de]=he[de].default)}),ee});Re("amLabels",D);let P=O(null),y=O(!1),w=O("success"),A=O("");function S(){y.value=!1,e.commit("cabinet/setPaymentLinkError",{value:!1,type:"event"})}function f(ee){let he=Qe({...v}),de=m.value[ee].translations;return de&&Object.keys(de).forEach(Fe=>{de[Fe][g.value]&&b.value?he[Fe]=de[Fe][g.value]:de[Fe].default&&(he[Fe]=de[Fe].default)}),he}function k(ee){return m.value[ee].options}let T=_(()=>e.getters["entities/getReady"]),E=V("cabinetType");e.commit("cabinetFilters/setDates",fi(E.value));let $=_(()=>e.getters["cabinet/getEventsLoading"]),R=O(!1),Y=O(null),M=O(null),K=O(0),ce=O(1);function j(ee){ce.value=ee,ie(ee)}function ie(ee=1){Y.value=null,e.commit("cabinet/setEventsLoading",!0);let he=e.getters["cabinet/getTimeZone"],de=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getEventsFilters"]));de.dates=de.dates.map(xe=>me(xe).format("YYYY-MM-DD")),de.timeZone=he,de.source="cabinet-"+E.value,de.id=de.events,de.group=!0,de.page=ee,de.limit=r.general.itemsPerPageBackEnd,de.customers&&(de.customerId=de.customers),e.commit("auth/setLoadingEventsCounter",e.getters["auth/getLoadingEventsCounter"]+1);let Fe=e.getters["auth/getLoadingEventsCounter"];Pe.get("/events",Object.assign(ze(e),{params:Js(de)})).then(xe=>{Fe===e.getters["auth/getLoadingEventsCounter"]&&(e.dispatch("cabinetFilters/injectEventsOptions",xe.data.data.events),e.commit("auth/setPreloadedEvents",xe.data.data.events),K.value=xe.data.data.count,e.commit("eventEntities/setEvents",xe.data.data.events),M.value=zc(xe.data.data.events,e.getters["cabinet/getTimeZone"],e))}).catch(xe=>{xe?.response?.data?.data?.reauthorize!==void 0&&xe.response.data.data.reauthorize&&e.dispatch("auth/logout"),console.log(xe)}).finally(()=>{Fe===e.getters["auth/getLoadingEventsCounter"]&&e.commit("cabinet/setEventsLoading",!1)})}function se(ee){e.commit("cabinet/setEventsLoading",!0),Pe.get("/events/"+ee.id,Object.assign({params:{source:"cabinet-"+E.value,timeZone:e.getters["cabinet/getTimeZone"]}},ze(e))).then(he=>{e.commit("event/setEvent",db(e,he.data.data.event)),le.value=!0}).catch(he=>{console.log(he)}).finally(()=>{e.commit("cabinet/setEventsLoading",!1)})}let le=O(!1),te=O(!1),ne=O(!1),Z=O(!1),ge=O(!1),be=O(null);function q(ee){e.commit("cabinet/setEventsLoading",!0),le.value=!1,setTimeout(()=>{e.commit("event/setEvent",ee),le.value=!0,e.commit("cabinet/setEventsLoading",!1)},500)}function Q(){y.value=!0,A.value=D.value.event_saved,s.value&&P.value&&setTimeout(function(){ut(s.value,P.value.$el,0,300)},500),ie(),Oe()}function G(){fe(),le.value=!0}function H(ee){be.value=ee,Se(hs(e,e.getters["attendee/getDefaultAttendee"],ee)),ne.value=!0}function J(){ie(ce.value),X()}function X(){ne.value=!1,Z.value=!1}function ve(ee){be.value=ee,te.value=!0}function ye(){be.value=null,ie(ce.value),Se(hs(e,e.getters["attendee/getDefaultAttendee"])),te.value=!1,ge.value=!1}function _e(ee){ge.value=ee}function Se(ee={}){e.commit("attendee/setAttendee",ee)}function Oe(){le.value=!1,fe()}function fe(){e.commit("event/setEvent",{bookings:[],settings:vs(r,e.getters["event/getSettings"],{},{})})}let Le=O(!1);function Ne(){Le.value=!0,Pe.post("/bookings/cancel/"+Y.value.id,{type:"event",source:"cabinet-"+E.value},Object.assign(ze(e),{params:{source:"cabinet-"+E.value}})).then(()=>{Y.value=null,ie(),y.value=!0,A.value=D.value.event_canceled,s.value&&P.value&&setTimeout(function(){ut(s.value,P.value.$el,0,300)},500)}).catch(ee=>{!("data"in ee.response.data)&&"message"in ee.response.data&&(y.value=!0,A.value=ee.response.data.message,s.value&&P.value&&setTimeout(function(){ut(s.value,P.value.$el,0,300)},500))}).finally(()=>{Le.value=!1})}it(()=>t.loadBookingsCounter,()=>{ie()}),Je(()=>{ie()});function Me(ee){let he=[],de=e.getters["entities/getEmployees"];if(ee.organizerId&&de.find(Fe=>Fe.id===ee.organizerId)){let Fe={...de.find(xe=>xe.id===ee.organizerId),rank:"organizer"};if(!ee.providers.length)return Fe;he.push(Fe)}return ee.providers.length&&ee.providers.forEach(Fe=>{Fe.id!==ee.organizerId&&de.find(xe=>xe.id===Fe.id)&&he.push(de.find(xe=>xe.id===Fe.id))}),he}function Be(ee){if(ee){if(ee===1)return{class:"am-no-show-1",icon:"no-show-1"};if(ee===2)return{class:"am-no-show-2",icon:"no-show-2"};if(ee>2)return{class:"am-no-show-3",icon:"no-show-3"}}return{class:"",icon:""}}Re("noShowData",{noShowData:Be});let Ce=V("amColors"),qe=_(()=>({"--am-c-cape-bgr":Ce.value.colorMainBgr,"--am-c-cape-text":Ce.value.colorMainText,"--am-c-cape-text-op70":W(Ce.value.colorMainText,.7),"--am-c-cape-text-op25":W(Ce.value.colorMainText,.25),"--am-c-cape-primary":Ce.value.colorPrimary,"--am-c-cust-no1":Ce.value.colorMainText,"--am-c-cust-no1-bgr":W(Ce.value.colorMainText,.1),"--am-c-cust-no2":Ce.value.colorWarning,"--am-c-cust-no2-bgr":W(Ce.value.colorWarning,.1),"--am-c-cust-no3":Ce.value.colorError,"--am-c-cust-no3-bgr":W(Ce.value.colorError,.1),"--am-c-cust-text":Ce.value.colorMainText,"--am-c-cust-link":W(Ce.value.colorMainText,.5)}));return(ee,he)=>(c(),C("div",{ref_key:"pageContainer",ref:s,class:B(["am-cap am-cape-main",{"am-capei-main":a(le)||a(ne)||a(ge)}]),style:ke(a(qe))},[d("div",{class:B(["am-cape-main__inner",a(i)])},[a(y)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:P,type:a(w),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:S,onTriggerClose:S},{title:L(()=>[xC,re(" "+x(a(A)),1)]),_:1},8,["type"])):N("",!0),!a(ne)&&!a(le)&&!a(te)&&a(T)?(c(),U(Ni,{key:1,"step-key":"events",empty:a(R),"responsive-class":a(i),onChangeFilters:ie},null,8,["empty","responsive-class"])):N("",!0),a(h).cabinetType==="employee"&&a(r).roles.allowWriteEvents&&!a(ne)&&!a(le)&&!a(te)&&a(T)?(c(),C("div",wC,[I(Te,{icon:a(o),prefix:"plus",size:"small",category:"primary",type:a(m).events.options.newEvtBtn.buttonType,onClick:G},{default:L(()=>[d("span",null,x(a(D).new_event),1)]),_:1},8,["icon","type"])])):N("",!0),!a($)&&a(T)?(c(),C(ae,{key:3},[!a(ne)&&!a(le)&&!a(te)&&a(M)&&Object.keys(a(M)).length>0?(c(),C("div",{key:0,class:B(["am-cape__wrapper",[{"am-no-border":a(M)&&Object.keys(a(M)).length===1},a(i)]])},[(c(!0),C(ae,null,pe(a(M),(de,Fe)=>(c(),C("div",{key:Fe,class:"am-cape"},[d("div",{class:B(["am-cape__date",[{"am-today":a(ot)(Fe)===a(ot)(a(me)().format("YYYY-MM-DD"))},{"am-no-flag":a(M)&&Object.keys(a(M)).length===1},a(i)]])},x(a(ot)(Fe)),3),(c(!0),C(ae,null,pe(de.events,(xe,va)=>(c(),U(vr,{key:va,start:a(qs)(xe.periods[0].periodStart.split(" ")[1].slice(0,5)),name:xe.name,employee:Me(xe),customers:xe.bookings.filter(wt=>wt.status!=="rejected"&&wt.status!=="canceled").map(wt=>wt.customer),price:a(Io)(xe),duration:null,periods:(ee.periods=a(jc)(xe.periods))?ee.periods:[],extras:[],tickets:a(Yc)(xe),"custom-fields":a(hr)(xe.bookings,a(h).cabinetType),location:a(Wc)(a(e),xe),"google-meet-link":xe.periods.length===1&&xe.periods[0].googleMeetUrl?xe.periods[0].googleMeetUrl:"","microsoft-teams-link":xe.periods.length===1&&xe.periods[0].microsoftTeamsUrl?xe.periods[0].microsoftTeamsUrl:"","zoom-link":xe.periods.length===1&&xe.periods[0].zoomMeeting?xe.periods[0].zoomMeeting.joinUrl:"","lesson-space-link":xe.periods.length===1&&xe.periods[0].lessonSpace?xe.periods[0].lessonSpace:"",bookable:xe,reservation:xe,booking:xe.bookings[0],"responsive-class":a(i),"parent-width":a(l),"customized-options":k("events"),onEditEvent:se,onAddEventAttendee:H,onListEventAttendees:ve,onCancelBooking:he[0]||(he[0]=wt=>{we(Y)?Y.value=wt:Y=wt})},null,8,["start","name","employee","customers","price","periods","tickets","custom-fields","location","google-meet-link","microsoft-teams-link","zoom-link","lesson-space-link","bookable","reservation","booking","responsive-class","parent-width","customized-options"]))),128))]))),128))],2)):N("",!0),!a(ne)&&!a(le)&&!a(te)&&(a(M)===null||Object.keys(a(M)).length===0)?(c(),U(Aa,{key:1,heading:a(D).no_evt_found,text:a(D).have_no_evt},null,8,["heading","text"])):N("",!0),!a(ne)&&!a(le)&&!a(te)&&a(M)&&Object.keys(a(M)).length>0&&a(K)>a(r).general.itemsPerPageBackEnd?(c(),U(Il,{key:2,"page-size":a(r).general.itemsPerPageBackEnd,"pager-count":5,layout:"prev, pager, next",total:a(K),"current-page":a(ce),onCurrentChange:j},null,8,["page-size","total","current-page"])):N("",!0),a(le)?(c(),U(sk,{key:3,"page-width":a(l),"responsive-class":a(i),onClose:Oe,onSave:Q,onDuplicate:q},null,8,["page-width","responsive-class"])):N("",!0),!a(ne)&&a(te)?(c(),U(CC,{key:4,event:a(be),"page-width":a(l),"responsive-class":a(i),onClose:ye,onOpenAttendee:_e},null,8,["event","page-width","responsive-class"])):N("",!0),a(ne)?(c(),U(Ar,{key:5,visibility:a(ne),title:a(Z)?a(D).event_edit_attendee:a(D).event_add_attendee,event:a(be),"page-width":a(l),"is-new":!a(Z),onSave:J,onClose:X},null,8,["visibility","title","event","page-width","is-new"])):N("",!0),a(u)==="capc"?(c(),U(Ua,{key:6,visibility:a(Y)!==null,title:f("cancelEvent").cancel_event,description:f("cancelEvent").confirm_cancel_event,"close-btn-text":f("cancelEvent").close,"confirm-btn-text":f("cancelEvent").confirm,"customized-options":k("cancelEvent"),loading:a(Le),onClose:he[1]||(he[1]=de=>we(Y)?Y.value=null:Y=null),onDecline:he[2]||(he[2]=de=>we(Y)?Y.value=null:Y=null),onConfirm:Ne},null,8,["visibility","title","description","close-btn-text","confirm-btn-text","customized-options","loading"])):N("",!0)],64)):(c(),U(Oi,{key:4}))],2)],6))}});const EC={class:"am-sc__top-left"},SC={class:"am-sc__name"},AC={key:0,class:"am-sc__date"},IC={key:1,class:"am-sc__date"},$C=["onClick"],DC={class:"am-sc__capacity"},PC=d("div",{class:"am-sc__btn"},[d("span",{class:"am-icon-arrow-right"})],-1),NC={key:0,class:"am-sc__bottom"},OC={class:"am-sc__expiration"},MC=d("span",{class:"am-icon-triangle-info"},null,-1),FC={name:"CabinetPackagesList"},VC=Object.assign(FC,{props:{packages:{type:[Object,Array],default:()=>{}},responsiveClass:{type:String,default:""}},emits:["click"],setup(n,{emit:t}){const e=n;function s(y){return me(y,"YYYY-MM-DD").diff(me(),"days")}function l(y){t("click",y)}function i(y,w,A){let S=0;return Object.keys(y).forEach(f=>{(w===null||parseInt(w)===parseInt(f))&&(S+=y[f].purchaseData[A])}),S}function o(y){return y===1?b.value.appointment_booked:b.value.appointments_booked}function r(y){let w=y.packageData.sharedCapacity?y.packageData.sharedCount:i(y.services,null,"count"),A=y.packageData.sharedCapacity?y.packageData.sharedTotal:i(y.services,null,"total");return`${A-w}/${A} ${o(A-w)}`}const u=V("settings");let m=V("amCustomize");const h=V("labels"),v=V("localLanguage");let g=_(()=>u.general.usedLanguages.includes(v.value)),b=_(()=>{let y=Qe({...h}),w=m.value.packagesList.translations;return w&&Object.keys(w).forEach(A=>{w[A][v.value]&&g.value?y[A]=w[A][v.value]:w[A].default&&(y[A]=w[A].default)}),y}),D=V("amColors"),P=_(()=>({"--am-c-sc-bgr":D.value.colorMainBgr,"--am-c-sc-bgr-op15":W(D.value.colorMainText,.15),"--am-c-sc-text":D.value.colorMainText,"--am-c-sc-text-op80":W(D.value.colorMainText,.8),"--am-c-sc-text-op60":W(D.value.colorMainText,.6),"--am-c-sc-warning-op50":W(D.value.colorWarning,.5)}));return(y,w)=>a(e).packages.length?(c(!0),C(ae,{key:0},pe(a(e).packages,A=>(c(),C("div",{key:A[0],style:ke(a(P)),class:B(["am-sc",{"am-sc__canceled":A[1].packageData.status==="canceled"}])},[d("div",{class:B(["am-sc__top",n.responsiveClass])},[d("div",EC,[d("div",SC,x(A[1].packageData.name),1),A[1].packageData.end?(c(),C("div",AC,x(a(b).package_book_expire)+" "+x(a(ot)(A[1].packageData.end.split(" ")[0])),1)):(c(),C("div",IC,x(`${a(b).package_book_expiration} ${a(b).package_book_unlimited}`),1))]),d("div",{class:B(["am-sc__top-right",n.responsiveClass]),onClick:S=>l(A[0])},[d("div",DC,x(r(A[1])),1),PC],10,$C)],2),A[1].packageData.end&&A[1].packageData.status!=="canceled"?(c(),C(ae,{key:0},[s(A[1].packageData.end.split(" ")[0])>0?(c(),C("div",NC,[d("span",OC,[MC,re(" "+x(`${a(b).package_deal_expire_in} ${s(A[1].packageData.end.split(" ")[0])} ${a(b).expires_days}, ${a(b).appointments_deal_expire}`),1)])])):N("",!0)],64)):N("",!0)],6))),128)):(c(),U(Aa,{key:1,heading:a(b).no_pack_found,text:a(b).have_no_pack},null,8,["heading","text"]))}});const BC=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),RC={class:"am-cappa__back"},qC={class:"am-cappa__heading-left"},UC={key:0,class:"am-cappa__img-name"},zC={class:"am-cappa__info"},jC={class:"am-cappa__name"},YC={key:0,class:"am-cappa__date"},WC={key:1,class:"am-cappa__date"},HC={key:2,class:"am-cappa__capacity"},ZC={class:"am-cappa__service-heading"},GC={class:"am-cappa__service-right"},JC={key:0,class:"am-cappa__service-img__name"},XC={class:"am-cappa__service-info"},QC={class:"am-cappa__service-name"},KC={key:0,class:"am-cappa__service-capacity"},ex={name:"CabinetPackageAppointmentsList",key:"packagesList"},tx=Object.assign(ex,{props:{data:{type:[Object,Array],default:()=>{}},responsiveClass:{type:String,default:""},pageWidth:{type:Number}},emits:["goBack","booked","canceled","cancelError"],setup(n,{emit:t}){const e=n;let s=De(),l=_(()=>s.getters.getSettings),i={components:{IconComponent:We},template:'<IconComponent icon="arrow-left"></IconComponent>'},{selectedPackageCustomerId:o}=V("packageSelection"),r=_(()=>s.getters["entities/getPackage"](e.data.packageData.id)),u=_(()=>r.value.bookable.filter(H=>e.data.services[H.service.id]).map(H=>H.service.id.toString())),m=_(()=>r.value.bookable.find(H=>parseInt(H.service.id)===parseInt(y.value))),h=O(null),v=O(null),g=_(()=>{let H=s.getters["entities/getEntitiesRelations"],J=s.getters["entities/getUnfilteredEmployees"],X=[];if(m.value){if(v.value)Object.keys(H).forEach(ye=>{w.value&&w.value.serviceId in H[ye]&&H[ye][parseInt(w.value.serviceId)].indexOf(v.value)!==-1&&X.push(parseInt(ye))});else{let ye=[];if(m.value.locations.length)ye=m.value.locations.map(_e=>_e.id);else for(let _e in H)m.value.service.id in H[_e]&&(ye=ye.concat(H[_e][m.value.service.id]));for(let _e in H)m.value.service.id in H[_e]&&ye.forEach(Se=>{H[_e][m.value.service.id].indexOf(Se)!==-1&&X.push(parseInt(_e))})}let ve=m.value.providers.length?m.value.providers.map(ye=>ye.id):J.map(ye=>ye.id);return J.filter(ye=>ve.indexOf(ye.id)!==-1&&X.indexOf(ye.id)!==-1&&(s.getters["entities/getShowHidden"]||ye.status==="visible"))}return[]}),b=_(()=>{let H=s.getters["entities/getEntitiesRelations"],J=s.getters["entities/getUnfilteredLocations"],X=[];if(m.value){if(h.value)X=H[h.value][m.value.service.id];else{let ye=[];if(m.value.providers.length)ye=m.value.providers.map(_e=>_e.id);else for(let _e in H)m.value.service.id in H[_e]&&ye.push(parseInt(_e));for(let _e in H)m.value.service.id in H[_e]&&ye.indexOf(parseInt(_e))!==-1&&(X=X.concat(H[_e][m.value.service.id]))}let ve=m.value.locations.length?m.value.locations.map(ye=>ye.id):J.map(ye=>ye.id);return J.filter(ye=>ve.indexOf(ye.id)!==-1&&X.indexOf(ye.id)!==-1&&(s.getters["entities/getShowHidden"]||ye.status==="visible"))}return[]}),D=_(()=>{let H=[];return Object.keys(e.data.services).forEach(J=>{Object.keys(e.data.services[J].appointments).forEach(X=>{e.data.services[J].appointments[X].appointments.forEach(ve=>{H.push(ve)})})}),{type:"package",package:r.value,booking:null,bookable:r.value,paymentId:e.data.packageData.payments.length?e.data.packageData.payments[0].id:null,customer:s.getters["auth/getProfile"],packageCustomerId:parseInt(o.value),packageReservations:H,payments:e.data.packageData.payments,price:e.data.packageData.price,tax:e.data.packageData.tax,coupon:e.data.packageData.coupon,discount:e.data.packageData.discount,end:e.data.packageData.end}}),P=O(!1),y=O(null),w=O(null),A=O(null);Je(()=>{y.value=u.value[0]});function S(H,J,X){let ve=0;return Object.keys(H).forEach(ye=>{(J===null||parseInt(J)===parseInt(ye))&&(ve+=H[ye].purchaseData[X])}),ve}function f(H){return H===1?le.value.appointment_booked:le.value.appointments_booked}function k(H,J=null){let X=H.packageData.sharedCapacity?H.packageData.sharedCount:S(H.services,J,"count"),ve=H.packageData.sharedCapacity?H.packageData.sharedTotal:S(H.services,J,"total");return`${ve-X}/${ve} ${f(ve-X)}`}function T(H){y.value=H.paneName}function E(){let H=s.getters["auth/getProfile"],J=s.getters["cabinet/getTimeZone"]?s.getters["cabinet/getTimeZone"]:"UTC",X={serviceId:parseInt(y.value),group:1,timeZone:s.getters["cabinet/getTimeZone"],page:"cabinet"},ve=r.value.bookable.find(ye=>parseInt(ye.service.id)===parseInt(y.value)).providers.map(ye=>ye.id);ve.length&&(X.providerIds=ve),X.locationId=null,A.value=X,w.value={type:"appointment",bookings:[{packageCustomerService:{id:e.data.services[y.value].purchaseData.packageCustomerServiceId},customer:{id:H.id,firstName:H.firstName,lastName:H.lastName,email:H.email,phone:H.phone,countryPhoneIso:H.countryPhoneIso,externalId:H.externalId},customerId:H.id,customFields:null,persons:1,extras:[],deposit:0}],serviceId:y.value,locationId:e.data.services[y.value].purchaseData.locitionId,providerId:e.data.services[y.value].purchaseData.employeeId,isGroup:!0,notifyParticipants:l.value.notifications.notifyCustomers?1:0,payment:null,recurring:[],package:[],timeZone:J===""?Intl.DateTimeFormat().resolvedOptions().timeZone:J,utc:J==="",locale:window.localeLanguage[0]}}function $(H){w.value=null,t("booked",H)}let R=O(!1);function Y(){R.value=!0,Pe.post("/packages/customers/"+parseInt(o.value),{status:"canceled"},ze(s)).then(()=>{P.value=!1,t("canceled",{message:le.value.package_purchase_canceled})}).catch(H=>{H.response&&t("cancelError",H.response.data)}).finally(()=>{R.value=!1})}function M(H){t("booked",H)}function K(){t("goBack")}let ce=V("amCustomize");const j=V("labels"),ie=V("localLanguage");let se=_(()=>l.value.general.usedLanguages.includes(ie.value)),le=_(()=>{let H=Qe({...j}),J=ce.value.packageAppointmentsList.translations;return J&&Object.keys(J).forEach(X=>{J[X][ie.value]&&se.value?H[X]=J[X][ie.value]:J[X].default&&(H[X]=J[X].default)}),H});Re("amLabels",le);let te=_(()=>s.getters["cabinet/getPaymentLinkError"].package),ne=O("error"),Z=O(le.value.payment_link_error);function ge(){te.value=!1,s.commit("cabinet/setPaymentLinkError",{value:!1,type:"package"})}function be(H){let J=Qe({...j}),X=ce.value[H].translations;return X&&Object.keys(X).forEach(ve=>{X[ve][ie.value]&&se.value?J[ve]=X[ve][ie.value]:X[ve].default&&(J[ve]=X[ve].default)}),J}function q(H){return ce.value[H].options}let Q=V("amColors"),G=_(()=>({"--am-c-cappa-text":Q.value.colorMainText,"--am-c-cappa-bgr":Q.value.colorMainBgr,"--am-c-cappa-text-op80":W(Q.value.colorMainText,.8),"--am-c-cappa-text-op70":W(Q.value.colorMainText,.7),"--am-c-cappa-text-op20":W(Q.value.colorMainText,.2),"--am-c-cappa-primary":Q.value.colorPrimary}));return(H,J)=>{const X=Ia,ve=$a;return c(),C("div",{class:"am-cappa",style:ke(a(G))},[a(te)?(c(),U(xt,{key:0,ref:"alertContainer",type:a(ne),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:ge,onTriggerClose:ge},{title:L(()=>[BC,re(" "+x(a(Z)),1)]),_:1},8,["type"])):N("",!0),d("div",RC,[I(Te,{"custom-class":"am-cappa__back-btn",icon:a(i),type:a(ce).packageAppointmentsList.options.backBtn.buttonType,size:"micro",category:"secondary","icon-only":"","aria-label":a(le).back_btn,onClick:K},null,8,["icon","type","aria-label"]),d("span",null,x(a(le).back_btn),1)]),d("div",{class:B(["am-cappa__heading",n.responsiveClass])},[d("div",qC,[d("div",{class:"am-cappa__img",style:ke(a(e).data.packageData.pictureThumbPath?{backgroundImage:`url(${a(e).data.packageData.pictureThumbPath})`}:{})},[a(e).data.packageData.pictureThumbPath?N("",!0):(c(),C("span",UC,x(a(Hn)(a(e).data.packageData.name)),1)),d("span",{class:"am-cappa__img-color",style:ke({backgroundColor:a(e).data.packageData.color})},null,4)],4),d("div",zC,[d("div",jC,x(a(e).data.packageData.name),1),a(e).data.packageData.end?(c(),C("div",YC,x(a(le).package_book_expire)+" "+x(a(ot)(a(e).data.packageData.end.split(" ")[0])),1)):(c(),C("div",WC,x(`${a(le).package_book_expiration} ${a(le).package_book_unlimited}`),1)),Object.keys(a(e).data.services).length>1?(c(),C("div",HC,x(k(a(e).data)),1)):N("",!0)])]),d("div",{class:B(["am-cappa__heading-right",n.responsiveClass])},[a(l).roles.allowCustomerCancelPackages&&a(e).data.packageData.status!=="canceled"?(c(),U(Te,{key:0,category:"danger",size:"small",class:B(["am-cappa__actions",n.responsiveClass]),type:a(ce).packageAppointmentsList.options.cancelBtn.buttonType,onClick:J[0]||(J[0]=()=>{we(P)?P.value=!0:P=!0})},{default:L(()=>[re(x(a(le).cancel),1)]),_:1},8,["class","type"])):N("",!0),a(e).data.packageData.status==="approved"&&a(e).data.packageData.price>0?(c(),U(_r,{key:1,"btn-size":"small",class:B(`am-cappa__actions ${n.responsiveClass}`),type:a(ce).packageAppointmentsList.options.payBtn.buttonType,reservation:a(D),bookable:a(r)},null,8,["class","type","reservation","bookable"])):N("",!0)],2)],2),I(ve,{modelValue:a(y),"onUpdate:modelValue":J[1]||(J[1]=ye=>we(y)?y.value=ye:y=ye),class:"am-cappa__service",onTabClick:T},{default:L(()=>[(c(!0),C(ae,null,pe(a(u),ye=>(c(),U(X,{key:ye,name:ye},{label:L(()=>[d("div",ZC,x(a(e).data.services[ye].purchaseData.name),1)]),default:L(()=>[a(y)===ye?(c(),C(ae,{key:0},[d("div",{class:B(["am-cappa__service-top",n.responsiveClass])},[d("div",GC,[d("div",{class:"am-cappa__service-img",style:ke(a(e).data.services[a(y)].purchaseData.pictureThumbPath?{backgroundImage:`url(${a(e).data.services[a(y)].purchaseData.pictureThumbPath})`}:{})},[a(e).data.services[a(y)].purchaseData.pictureThumbPath?N("",!0):(c(),C("span",JC,x(a(Hn)(a(e).data.services[a(y)].purchaseData.name)),1)),d("span",{class:"am-cappa__service-img__color",style:ke({backgroundColor:a(e).data.services[a(y)].purchaseData.color})},null,4)],4),d("div",XC,[d("div",QC,x(a(e).data.services[a(y)].purchaseData.name),1),a(e).data.packageData.sharedCapacity?N("",!0):(c(),C("div",KC,x(k(a(e).data,a(y))),1))])]),a(e).data.packageData.status!=="canceled"?(c(),U(Te,{key:0,class:B(["am-cappa__service-book",n.responsiveClass]),size:"small",type:a(ce).packageAppointmentsList.options.bookBtn.buttonType,disabled:S(a(e).data.services,a(y),"count")===0,onClick:E},{default:L(()=>[re(x(a(le).book_now),1)]),_:1},8,["class","type","disabled"])):N("",!0)],2),I(br,{"grouped-appointments":a(e).data.services[a(y)].appointments,"page-width":n.pageWidth,"responsive-class":n.responsiveClass,"is-package-booking":!0,"step-key":"packageAppointmentsList",onCanceled:M,onBooked:M},null,8,["grouped-appointments","page-width","responsive-class"])],64)):N("",!0)]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue"]),I(Ua,{loading:a(R),visibility:a(P),title:be("cancelPackage").cancel_package,description:be("cancelPackage").confirm_cancel_package,"close-btn-text":be("cancelPackage").close,"confirm-btn-text":be("cancelPackage").confirm,"customized-options":q("cancelPackage"),onClose:J[2]||(J[2]=()=>{we(P)?P.value=!1:P=!1}),onDecline:J[3]||(J[3]=()=>{we(P)?P.value=!1:P=!1}),onConfirm:Y},null,8,["loading","visibility","title","description","close-btn-text","confirm-btn-text","customized-options"]),I(yr,{visibility:a(w)!==null&&!a(w).id,appointment:a(w),employees:a(g),locations:a(b),"slots-params":a(A),labels:be("bookAppointment"),"customized-options":q("bookAppointment"),onClose:J[4]||(J[4]=ye=>we(w)?w.value=null:w=null),onSuccess:$,onError:J[5]||(J[5]=()=>{}),onEmployeeSelection:J[6]||(J[6]=ye=>we(h)?h.value=ye:h=ye),onLocationSelection:J[7]||(J[7]=ye=>we(v)?v.value=ye:v=ye)},null,8,["visibility","appointment","employees","locations","slots-params","labels","customized-options"])],4)}}});const ax=d("span",{class:"am-icon-checkmark-circle-full"},null,-1),sx={name:"CabinetPackages",key:"packages"},lx=Object.assign(sx,{props:{loadBookingsCounter:{type:Number,default:0}},setup(n){const t=n;let e=De(),s=O(null),l=O(0),i=V("sidebarCollapsed");window.addEventListener("resize",o);function o(){s.value&&(l.value=s.value.offsetWidth)}it(i,K=>{K?setTimeout(()=>{r()},1500):setTimeout(()=>{r()},500)});function r(){l.value=s.value.offsetWidth}Je(()=>{di(()=>{l.value=s.value.offsetWidth})});let u=_(()=>st(l.value)),m=O(null),h=O(!1),v=O("success"),g=O("");function b(){h.value=!1,g.value=""}let D=V("cabinetType");e.commit("cabinetFilters/setDates",fi(D.value));let P=_(()=>e.getters["cabinet/getPackageLoading"]),y=O([]),w=O(null);function A(){let K=e.getters["cabinetFilters/getPackages"],ce=e.getters["cabinetFilters/getServices"],j=e.getters["cabinetFilters/getProviders"],ie=e.getters["cabinetFilters/getLocations"];y.value=E.value.filter(se=>{let le=e.getters["entities/getPackageEntities"](se[1].packageData.id);return(ce.length===0||ce.filter(te=>le.services.includes(te)).length>0)&&(j.length===0||j.filter(te=>le.providers.includes(te)).length>0)&&(ie.length===0||ie.filter(te=>le.locations.includes(te)).length>0)&&(K.length===0||K.filter(te=>le.packages.includes(te)).length>0)})}function S(K,ce,j){let ie=0;return Object.keys(K).forEach(se=>{(ce===null||parseInt(ce)===parseInt(se))&&(ie+=K[se].purchaseData[j])}),ie}function f(K){let ce=S(K.services,null,"count"),j=S(K.services,null,"total");return j-ce===j}function k(K){e.commit("cabinet/setPackageLoading",!0);let ce=e.getters["cabinet/getTimeZone"],j=JSON.parse(JSON.stringify(e.getters["cabinetFilters/getPackagesFilters"]));j.timeZone=ce,j.source="cabinet-"+D.value,j.activePackages=0,Pe.get("/appointments",Js(Object.assign(ze(e),{params:j}))).then(ie=>{let se={};ie.data.data.availablePackageBookings.forEach(q=>{q.packages.forEach(Q=>{Q.services.forEach(G=>{G.bookings.forEach(H=>{let J=e.getters["entities/getPackage"](Q.packageId);if(J&&(H.packageCustomerId in se||(se[H.packageCustomerId]={packageData:{id:J.id,name:J.name,start:H.start,end:H.end,price:H.price,tax:H.tax,coupon:H.coupon,status:H.status,type:"package",payments:H.payments,sharedCapacity:H.sharedCapacity,sharedTotal:H.total,sharedCount:H.count,discount:0,color:J.color,pictureFullPath:J.pictureFullPath,pictureThumbPath:J.pictureThumbPath},services:{}}),!(G.serviceId in se[H.packageCustomerId].services))){let X=e.getters["entities/getService"](G.serviceId);se[H.packageCustomerId].services[G.serviceId]={appointments:{},purchaseData:{packageCustomerServiceId:H.id,total:H.total,count:H.count,employeeId:H.employeeId,locationId:H.locationId,name:X.name,color:X.color,pictureThumbPath:X.pictureThumbPath}}}})})})});let le=fr(ie.data.data.appointments,ce,D.value==="provider");Object.keys(le).forEach(q=>{le[q].appointments.forEach(Q=>{Q.bookings.forEach(G=>{let H=G.packageCustomerService.packageCustomer.id;H in se&&(q in se[H].services[Q.serviceId].appointments||(se[H].services[Q.serviceId].appointments[q]={date:q,appointments:[]}),se[H].services[Q.serviceId].appointments[q].appointments.push(Q))})})});let te=Object.entries(se).filter(q=>q[1].packageData.status==="canceled"),ne=Object.entries(se).filter(q=>q[1].packageData.status!=="canceled"&&f(q[1])),Z=Object.entries(se).filter(q=>q[1].packageData.status!=="canceled"&&!f(q[1])&&q[1].packageData.end===null),ge=Object.entries(se).filter(q=>q[1].packageData.status!=="canceled"&&!f(q[1])&&q[1].packageData.end!==null).sort((q,Q)=>me(q[1].packageData.end,"YYYY-MM-DD HH:mm:ss").diff(me(Q[1].packageData.end,"YYYY-MM-DD HH:mm:ss"),"minutes"));if(y.value=[...ge,...Z,...ne,...te],E.value=[...ge,...Z,...ne,...te],!(j.packages.length||j.services.length||j.providers.length||j.locations.length)){let q=[],Q=[],G=[],H=[];y.value.forEach(J=>{let X=e.getters["entities/getPackageEntities"](J[1].packageData.id);q=q.concat(X.services),Q=Q.concat(X.providers),G=G.concat(X.locations),H=H.concat(X.packages)}),e.dispatch("cabinetFilters/injectServiceOptions",q.filter((J,X,ve)=>ve.indexOf(J)===X)),e.dispatch("cabinetFilters/injectProviderOptions",Q.filter((J,X,ve)=>ve.indexOf(J)===X)),e.dispatch("cabinetFilters/injectLocationOptions",G.filter((J,X,ve)=>ve.indexOf(J)===X)),e.dispatch("cabinetFilters/injectPackagesOptions",H.filter((J,X,ve)=>ve.indexOf(J)===X))}}).catch(ie=>{console.log(ie)}).finally(()=>{e.commit("cabinet/setPackageLoading",!1),K&&"message"in K&&(h.value=!0,g.value=K.message,s.value&&m.value&&setTimeout(function(){ut(s.value,m.value.$el,0,300)},500))})}function T(K){h.value=!0,g.value=K.message,v.value="error",s.value&&m.value&&setTimeout(function(){ut(s.value,m.value.$el,0,300)},500)}Re("packageSelection",{selectedPackageCustomerId:w});let E=O([]);it(()=>t.loadBookingsCounter,()=>{k()}),Je(()=>{k()});let $=_(()=>({list:{template:Ge(VC),props:{packages:y.value,responsiveClass:u.value},handlers:{click:Y}},item:{template:Ge(tx),props:{data:w.value?y.value.find(K=>K[0]===w.value)[1]:{},responsiveClass:u.value,pageWidth:l.value},handlers:{goBack:M,booked:k,canceled:k,cancelError:T}}})),R=O("list");function Y(K){w.value=K,R.value="item"}function M(){w.value=null,R.value="list"}return(K,ce)=>(c(),C("div",{ref_key:"pageContainer",ref:s,class:"am-cap"},[a(h)?(c(),U(xt,{key:0,ref_key:"alertContainer",ref:m,type:a(v),"show-border":!0,"close-after":5e3,"custom-class":"am-cap__alert",onClose:b,onTriggerClose:b},{title:L(()=>[ax,re(" "+x(a(g)),1)]),_:1},8,["type"])):N("",!0),zt(I(Ni,{"step-key":"packages","responsive-class":a(u),onChangeFilters:A},null,8,["responsive-class"]),[[Lo,a(R)==="list"]]),a(P)?(c(),U(Oi,{key:2})):(c(),U(pt(a($)[a(R)].template),St({key:1},a($)[a(R)].props,pi(a($)[a(R)].handlers)),null,16))],512))}});const nx=d("link",{rel:"preconnect",href:"https://fonts.googleapis.com"},null,-1),ix=d("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossorigin:""},null,-1),ox=["href"],rx={class:"am-fs-sb__page-wrapper am-fs-sb__page-wrapper__cabinet"},cx=["onClick"],ux={class:"am-fs-sb__page-icon"},dx={key:1,class:"am-fs-sb__page-divider"},mx={class:"am-fs-sb__page-inner"},px=d("div",{class:"am-fs-sb__page-icon"},[d("span",{class:"am-icon-dashboard"})],-1),gx=d("div",{class:"am-fs-sb__page-divider"},null,-1),fx={class:"am-fs-sb__page-inner"},hx=d("div",{class:"am-fs-sb__page-icon"},[d("span",{class:"am-icon-logout"})],-1),_x={class:"am-caph"},vx={class:"am-caph__text"},yx=d("span",{class:"am-icon-menu"},null,-1),bx=[yx],kx={name:"CustomerPanel"},Cx=Object.assign(kx,{setup(n){const t=Ml().cookies,e=De();let s=_(()=>e.getters.getIsRtl);const l=V("shortcodeData");let i=_(()=>e.getters["auth/getAuthenticated"]);it(i,_e=>{_e&&(e.commit("auth/setNewPassword",""),e.commit("auth/setConfirmPassword",""))});let o=O(l.value.cabinetType==="employee"?"provider":"customer");Re("cabinetType",o);let r=V("licence"),u=_(()=>o.value==="provider"?"cape":"capc");Re("originKey",u);let m=O(null),{width:h}=ja(m);Re("containerWidth",h);const v=V("settings");let g=O(l.value.appointments||!l.value.events?"appointments":"events");const b=_(()=>v.customizedData&&u.value in v.customizedData?v.customizedData[u.value]:Sl[u.value]);Re("amCustomize",b);const D=O(v.customizedData?v.customizedData.fonts:Sl.fonts);Re("amFonts",D);const P=V("labels");Re("amLabels",P);const y=V("localLanguage");let w=_(()=>v.general.usedLanguages.includes(y.value)),A=_(()=>{let _e=Qe({...P});return v.customizedData&&Object.keys(b.value).forEach(Se=>{if(Se!=="colors"&&b.value[Se].translations){let Oe=b.value[Se].translations;Object.keys(Oe).forEach(fe=>{Oe[fe][y.value]&&w.value?_e[fe]=Oe[fe][y.value]:Oe[fe].default&&(_e[fe]=Oe[fe].default)})}}),_e});function S(){let _e=document.head||document.getElementsByTagName("head")[0];_e.querySelector("#amCustomFont")&&_e.querySelector("#amCustomFont").remove();let Se="@font-face {font-family: 'comic'; src: url(http://localhost/amelia-test/wp-content/uploads/amelia/fonts/comic.woff);}",Oe=document.createElement("style");_e.appendChild(Oe),Oe.setAttribute("type","text/css"),Oe.setAttribute("id","amCustomFont"),Oe.appendChild(document.createTextNode(Se))}D.value.customFontSelected&&S();let f=_(()=>g.value==="packages"?b.value.packagesList.options:b.value[g.value].options),k=_(()=>{let _e=g.value;return o.value==="customer"?_e!=="profile"?f.value.timeZone.visibility:!0:_e==="appointments"||_e==="events"?f.value.timeZone.visibility:!0}),T=O(!1),E=O(!1);Re("sidebarCollapsed",lc(E));let $=O("");it(E,_e=>{_e?setTimeout(()=>{$.value="am-collapsed"},1e3):$.value=""});let R=O(null),Y=O(0),M=_(()=>h.value>480);Je(()=>{R.value&&setTimeout(()=>{Y.value=R.value.offsetHeight},200),setTimeout(()=>{E.value=h.value<=600?!0:b.value.sidebar.options.toggle.visibility},1300)});const K=()=>{h.value<=600?E.value=!0:E.value=b.value.sidebar.options.toggle.visibility};window.addEventListener("resize",K),it(h,_e=>{T.value=_e>481?!1:T.value});const ce=_(()=>e.getters["entities/getReady"]);it(ce,_e=>{if(_e){if(l.value.cabinetType==="employee"&&e.getters["employee/getId"]){let Se=e.getters["employee/getEmployee"];e.commit("employee/setServiceList",xo(e,Se.serviceList)),e.commit("entities/setEmployees",[e.getters["entities/getEmployee"](e.getters["employee/getId"])])}e.dispatch("cabinetFilters/injectServiceOptions",e.getters["entities/getServices"].map(Se=>Se.id)),e.dispatch("cabinetFilters/injectProviderOptions",o.value==="customer"?e.getters["entities/getEmployees"].map(Se=>Se.id):[]),e.dispatch("cabinetFilters/injectLocationOptions",e.getters["entities/getLocations"].map(Se=>Se.id))}});const j=V("baseUrls");let ie=["employees","categories","locations","packages","entitiesRelations","customFields"];l.value.cabinetType==="employee"&&(ie=ie.concat(["taxes","spaces","tags","settings"])),e.dispatch("entities/getEntities",{types:ie,licence:"basic",loadEntities:!0,showHidden:!0,isPanel:!0});let se=_(()=>e.getters.getReady),le=O({profile:Ge(l.value.cabinetType==="employee"?Lh:md)});(l.value.appointments||!l.value.events)&&(le.value.appointments=Ge(cb)),(l.value.events||!l.value.appointments)&&(le.value.events=Ge(LC)),(l.value.appointments||!l.value.events)&&(r.isPro||r.isDeveloper)&&(le.value.packages=Ge(lx));const te=O([{key:"profile",icon:"user",pageLabel:A.value.my_profile,label:_(()=>u.value==="cape"?`${e.getters["auth/getProfile"].firstName} ${e.getters["auth/getProfile"].lastName}`:b.value.profile.options.lastName.visibility?`${e.getters["auth/getProfile"].firstName} ${e.getters["auth/getProfile"].lastName}`:`${e.getters["auth/getProfile"].firstName}`)}]);(l.value.appointments||!l.value.events)&&te.value.push({key:"appointments",icon:"service",label:A.value.appointments}),(l.value.events||!l.value.appointments)&&te.value.push({key:"events",icon:"star-outline",label:A.value.events}),l.value.cabinetType==="customer"&&(l.value.appointments||!l.value.events)&&(r.isPro||r.isDeveloper)&&te.value.push({key:"packages",icon:"shipment",label:A.value.packages}),Re("sidebarSteps",te),Je(()=>{ne.value=te.value.findIndex(_e=>_e.key===g.value)});let ne=O(0);function Z(_e,Se){l.value.cabinetType==="employee"&&(_e.key!=="appointments"&&(e.commit("appointment/resetAppointment",{providerId:e.getters["auth/getProfile"].id,categoryId:null,serviceId:null,locationId:null}),e.commit("customerInfo/setCustomers",[]),e.commit("customerInfo/setCustomersIds",[])),_e.key!=="events"&&(e.commit("event/setEvent",{settings:vs(v,e.getters["event/getSettings"],{},{})}),e.commit("attendee/setAttendee",hs(e,e.getters["attendee/getDefaultAttendee"])))),g.value=_e.key,ne.value=Se,e.commit("cabinetFilters/setResetFilters")}function ge(_e){l.value.cabinetType==="employee"&&l.value.profile&&_e.step.key==="profile"||(Z(_e.step,_e.index),e.commit("cabinetFilters/setResetFilters"))}function be(){e.dispatch("auth/logout")}function q(){T.value=!1,be()}let Q=O(0);function G(){Q.value++}let H=_(()=>{switch(te.value[ne.value].key){case"profile":return te.value[ne.value].pageLabel;case"appointments":return e.getters["appointment/getActive"]&&!e.getters["appointment/getId"]?A.value.new_appointment:e.getters["appointment/getActive"]&&e.getters["appointment/getId"]?A.value.edit_appointment:te.value[ne.value].label;case"events":return e.getters["attendee/getActive"]&&!e.getters["attendee/getId"]?A.value.event_add_attendee:e.getters["attendee/getActive"]&&e.getters["attendee/getId"]?A.value.event_edit_attendee:e.getters["event/getActive"]&&!e.getters["event/getId"]?A.value.new_event:e.getters["event/getActive"]&&e.getters["event/getId"]?A.value.edit_event:te.value[ne.value].label;default:return te.value[ne.value].label}});Re("bookingsCounterChanger",{bookingsCounterChanger:G});const J=V("timeZone");Hs(()=>{if(!v.general.showClientTimeZone){let _e=J.value;t.get("ameliaUserTimeZone")&&(_e=t.get("ameliaUserTimeZone")),e.commit("cabinet/setTimeZone",_e)}e.getters["cabinet/getTimeZone"]||e.commit("cabinet/setTimeZone",Rs())});let X=_(()=>b.value.colors);Re("amColors",X);let ve=_(()=>({"--am-c-primary":X.value.colorPrimary,"--am-c-success":X.value.colorSuccess,"--am-c-error":X.value.colorError,"--am-c-warning":X.value.colorWarning,"--am-c-main-bgr":X.value.colorMainBgr,"--am-c-main-heading-text":X.value.colorMainHeadingText,"--am-c-main-text":X.value.colorMainText,"--am-c-main-text-op10":W(X.value.colorMainText,.1),"--am-c-sb-bgr":X.value.colorSbBgr,"--am-c-sb-text":X.value.colorSbText,"--am-c-inp-bgr":X.value.colorInpBgr,"--am-c-inp-border":X.value.colorInpBorder,"--am-c-inp-text":X.value.colorInpText,"--am-c-inp-placeholder":X.value.colorInpPlaceHolder,"--am-c-drop-bgr":X.value.colorDropBgr,"--am-c-drop-text":X.value.colorDropText,"--am-c-btn-prim":X.value.colorBtnPrim,"--am-c-btn-prim-text":X.value.colorBtnPrimText,"--am-c-btn-sec":X.value.colorBtnSec,"--am-c-btn-sec-text":X.value.colorBtnSecText,"--am-c-btn-danger":X.value.colorBtnDanger,"--am-c-btn-danger-text":X.value.colorBtnDangerText,"--am-c-skeleton-op20":W(X.value.colorMainText,.2),"--am-c-skeleton-op60":W(X.value.colorMainText,.6),"--am-c-skeleton-sb-op20":W(X.value.colorSbText,.2),"--am-c-skeleton-sb-op60":W(X.value.colorSbText,.6),"--am-c-scroll-op30":W(X.value.colorPrimary,.3),"--am-c-scroll-op10":W(X.value.colorPrimary,.1),"--am-font-family":D.value.fontFamily,"--am-rad-inp":"6px","--am-fs-inp":"15px","--am-mw-main":M.value?E.value?"858px":"1024px":"520px","--am-brad-main":M.value?"0 0.5rem 0.5rem 0":"0.5rem"})),ye=_(()=>({"--am-c-msd-bgr":X.value.colorSbBgr,"--am-c-msd-text":X.value.colorSbText,"--am-c-msd-text-op05":W(X.value.colorSbText,.05),"--am-c-msd-text-op10":W(X.value.colorSbText,.1),"--am-c-msd-text-op60":W(X.value.colorSbText,.6)}));return(_e,Se)=>(c(),C(ae,null,[D.value.customFontSelected?N("",!0):(c(),C(ae,{key:0},[nx,ix,d("link",{rel:"stylesheet",type:"text/css",href:`${a(j).wpAmeliaPluginURL}v3/src/assets/scss/common/fonts/font.css`,media:"all"},null,8,ox)],64)),d("div",{id:"amelia-container",ref_key:"ameliaContainer",ref:m,class:B(["am-cap__wrapper",[{"am-collapsed":a(E)},{"am-auth":!a(i)}]]),style:ke(a(ve))},[a(i)?N("",!0):(c(),U(td,{key:0})),a(i)?(c(),C(ae,{key:1},[a(M)?(c(),U(nc,{key:0,class:B(["am-fs-sb",[{"am-collapsed":a(E)},{"am-rtl":a(s)}]]),style:ke({width:a(E)?"72px":"240px",paddingBottom:`${a(Y)+16}px`})},{"step-list":L(()=>[d("div",rx,[(c(!0),C(ae,null,pe(te.value,(Oe,fe)=>(c(),C(ae,{key:Oe.key},[Oe.key!=="packages"||a(e).getters["entities/getPackages"].length?(c(),C("div",{key:0,class:B(["am-fs-sb__page",{selected:a(g)===Oe.key}]),style:ke({"pointer-events":a(l).cabinetType==="employee"&&a(l).profile&&Oe.key==="profile"?"none":""}),onClick:()=>{a(l).cabinetType==="employee"&&a(l).profile&&Oe.key==="profile"||Z(Oe,fe)}},[d("div",{class:B(["am-fs-sb__page-inner",{"am-collapsed":a(E)}])},[d("div",ux,[d("span",{class:B(`am-icon-${Oe.icon}`)},null,2)]),I(ga,{name:"fade"},{default:L(()=>[a(E)?N("",!0):(c(),C("p",{key:0,class:B(["am-fs-sb__page-heading",[a($),{"am-rtl":a(s)}]])},x(Oe.label),3))]),_:2},1024),I(ga,{name:"fade"},{default:L(()=>[a(E)?N("",!0):(c(),C("div",{key:0,class:B(["am-fs-sb__page-indicator",[a($),{"am-rtl":a(s)}]])},[d("span",{class:B(a(s)?"am-icon-arrow-big-left":"am-icon-arrow-big-right")},null,2)],2))]),_:1})],2)],14,cx)):N("",!0),fe===0&&te.value[0].key==="profile"?(c(),C("div",dx)):N("",!0)],64))),128))])]),"support-info":L(()=>[d("div",{ref_key:"sidebarFooterRef",ref:R,class:"am-fs-sb__footer"},[d("div",{class:"am-fs-sb__page",onClick:Se[0]||(Se[0]=Oe=>we(E)?E.value=!a(E):E=!a(E))},[d("div",mx,[px,I(ga,{name:"fade"},{default:L(()=>[a(E)?N("",!0):(c(),C("p",{key:0,class:B(["am-fs-sb__page-heading",a($)])},x(a(A).toggle_sidebar),3))]),_:1})])]),gx,d("div",{class:"am-fs-sb__page",onClick:be},[d("div",fx,[hx,I(ga,{name:"fade"},{default:L(()=>[a(E)?N("",!0):(c(),C("p",{key:0,class:B(["am-fs-sb__page-heading",a($)])},x(a(A).log_out),3))]),_:1})])])],512)]),_:1},8,["class","style"])):N("",!0),I(ic,{"max-width":786,"old-responsive":!1},{header:L(()=>[I(pc,{ready:a(se)},{default:L(()=>[d("div",_x,[d("div",vx,x(a(H)),1),a(M)?N("",!0):(c(),C("div",{key:0,class:"am-caph__menu",onClick:Se[1]||(Se[1]=()=>we(T)?T.value=!a(T):T=!a(T))},bx)),a(ce)&&a(M)&&a(k)?(c(),U(Zn,{key:1})):N("",!0),I(lu,{"menu-items":te.value,monitor:a(g),visibility:a(T),"custom-css":a(ye),"customized-labels":a(A),position:"right",width:240,"onUpdate:visibility":Se[2]||(Se[2]=Oe=>we(T)?T.value=Oe:T=Oe),onClick:ge,onLogout:q},null,8,["menu-items","monitor","visibility","custom-css","customized-labels"])])]),_:1},8,["ready"])]),step:L(()=>[(c(),U(pt(a(le)[a(g)]),{class:"am-fs__main-content","load-bookings-counter":a(Q)},null,8,["load-bookings-counter"]))]),_:1})],64)):N("",!0)],6)],64))}});var Px=Object.freeze(Object.defineProperty({__proto__:null,default:Cx},Symbol.toStringTag,{value:"Module"}));export{Px as C,lt as _,vc as a,Yt as b,Uc as c,jc as d,Sx as e,pc as f,lu as g,Ex as h,Lx as i,Vt as j,na as k,uc as l,Io as u};
