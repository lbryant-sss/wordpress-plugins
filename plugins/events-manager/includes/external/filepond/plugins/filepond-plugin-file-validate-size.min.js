(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):(global=global||self,global.FilePondPluginFileValidateSize=factory())})(this,function(){"use strict";var plugin=function plugin(_ref){var addFilter=_ref.addFilter,utils=_ref.utils;var Type=utils.Type,replaceInString=utils.replaceInString,toNaturalFileSize=utils.toNaturalFileSize;addFilter("ALLOW_HOPPER_ITEM",function(file,_ref2){var query=_ref2.query;if(!query("GET_ALLOW_FILE_SIZE_VALIDATION")){return true}var sizeMax=query("GET_MAX_FILE_SIZE");if(sizeMax!==null&&file.size>sizeMax){return false}var sizeMin=query("GET_MIN_FILE_SIZE");if(sizeMin!==null&&file.size<sizeMin){return false}return true});addFilter("LOAD_FILE",function(file,_ref3){var query=_ref3.query;return new Promise(function(resolve,reject){if(!query("GET_ALLOW_FILE_SIZE_VALIDATION")){return resolve(file)}var fileFilter=query("GET_FILE_VALIDATE_SIZE_FILTER");if(fileFilter&&!fileFilter(file)){return resolve(file)}var sizeMax=query("GET_MAX_FILE_SIZE");if(sizeMax!==null&&file.size>sizeMax){reject({status:{main:query("GET_LABEL_MAX_FILE_SIZE_EXCEEDED"),sub:replaceInString(query("GET_LABEL_MAX_FILE_SIZE"),{filesize:toNaturalFileSize(sizeMax,".",query("GET_FILE_SIZE_BASE"),query("GET_FILE_SIZE_LABELS",query))})}});return}var sizeMin=query("GET_MIN_FILE_SIZE");if(sizeMin!==null&&file.size<sizeMin){reject({status:{main:query("GET_LABEL_MIN_FILE_SIZE_EXCEEDED"),sub:replaceInString(query("GET_LABEL_MIN_FILE_SIZE"),{filesize:toNaturalFileSize(sizeMin,".",query("GET_FILE_SIZE_BASE"),query("GET_FILE_SIZE_LABELS",query))})}});return}var totalSizeMax=query("GET_MAX_TOTAL_FILE_SIZE");if(totalSizeMax!==null){var currentTotalSize=query("GET_ACTIVE_ITEMS").reduce(function(total,item){return total+item.fileSize},0);if(currentTotalSize>totalSizeMax){reject({status:{main:query("GET_LABEL_MAX_TOTAL_FILE_SIZE_EXCEEDED"),sub:replaceInString(query("GET_LABEL_MAX_TOTAL_FILE_SIZE"),{filesize:toNaturalFileSize(totalSizeMax,".",query("GET_FILE_SIZE_BASE"),query("GET_FILE_SIZE_LABELS",query))})}});return}}resolve(file)})});return{options:{allowFileSizeValidation:[true,Type.BOOLEAN],maxFileSize:[null,Type.INT],minFileSize:[null,Type.INT],maxTotalFileSize:[null,Type.INT],fileValidateSizeFilter:[null,Type.FUNCTION],labelMinFileSizeExceeded:["File is too small",Type.STRING],labelMinFileSize:["Minimum file size is {filesize}",Type.STRING],labelMaxFileSizeExceeded:["File is too large",Type.STRING],labelMaxFileSize:["Maximum file size is {filesize}",Type.STRING],labelMaxTotalFileSizeExceeded:["Maximum total size exceeded",Type.STRING],labelMaxTotalFileSize:["Maximum total file size is {filesize}",Type.STRING]}}};var isBrowser=typeof window!=="undefined"&&typeof window.document!=="undefined";if(isBrowser){document.dispatchEvent(new CustomEvent("FilePond:pluginloaded",{detail:plugin}))}return plugin});