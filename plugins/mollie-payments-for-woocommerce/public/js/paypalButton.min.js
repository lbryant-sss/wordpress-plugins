(()=>{"use strict";!function({_:e,molliepaypalbutton:t,jQuery:a}){if(e.isEmpty(t))return;const{product:{id:o,needShipping:i=!0,isVariation:n=!1,price:r,minFee:s,stock:l},ajaxUrl:d}=t;if(!o||!r||!d)return;const c=document.querySelector("#mollie-PayPal-button"),u=c.parentNode;let p=!1;var m,b;u.hasChildNodes()&&(m=u.children,b=c,p=Object.keys(m).find(e=>m[e]===b));const _=e=>{let t=e*r;a.ajax({url:d,method:"POST",data:{action:"mollie_paypal_update_amount",productId:h,productQuantity:e,nonce:y},success:e=>{t=parseFloat(e.data),parseFloat(s)>t?v():f()},error:e=>{console.warn(e)}})},v=()=>{null!==u&&u.removeChild(c)},f=()=>{const e=u.children[p];u.insertBefore(c,e)};if("outofstock"===l)return void v();const y=c.children[0].value;let h=o,w=1,L="";document.querySelector("input.qty").addEventListener("change",e=>{w=e.currentTarget.value,_(w)}),_(w);const g=()=>{c.disabled=!0,c.classList.add("buttonDisabled")};if(n&&(a(".single_variation_wrap").on("show_variation",function(e,t){h="",g(),t.is_virtual&&t.is_in_stock&&t.variation_id&&(h=t.variation_id,c.disabled=!1,c.classList.remove("buttonDisabled"))}),a(".reset_variations").on("click.wc-variation-form",function(e){h="",g()}),g()),null==c.parentNode)return;let k=!1;c.addEventListener("click",e=>{e.preventDefault(),null===c.parentNode||c.disabled||(c.disabled=!0,c.classList.add("buttonDisabled"),k||a.ajax({url:d,method:"POST",data:{action:"mollie_paypal_create_order",productId:h,productQuantity:w,needShipping:i,"mollie-payments-for-woocommerce_issuer_paypal_button":"paypal",nonce:y},success:e=>{const t=e.data;!0===e.success?(L=t.redirect,window.location.href=L):console.log(e.data)},error:(e,t,a)=>{c.disabled=!1,c.classList.remove("buttonDisabled"),console.warn(t,a)}}),k=!0,k&&setTimeout(function(){c.disabled=!1,c.classList.remove("buttonDisabled"),k=!1},3e3))})}(window)})();