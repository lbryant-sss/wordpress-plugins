function soGoogleMapInitialize(){jQuery(window.sowb).trigger("sow-google-map-loaded")}window.sowb=window.sowb||{},sowb.SiteOriginGoogleMapInstances=[],sowb.SiteOriginGoogleMap=function(o){return{DEFAULT_LOCATIONS:["Addo Elephant National Park, R335, Addo","Cape Town, Western Cape, South Africa","San Francisco Bay Area, CA, United States","New York, NY, United States"],hasMapStyles:!1,drawMarkerEl:o=>{if(void 0===o||!1===o)return null;const e=document.createElement("img");return e.src=o,e.loading="lazy",e},showMap:function(o,e,t){var a=Number(t.zoom);a||(a=14),window.matchMedia("(max-width: "+t.breakpoint+"px)").matches&&(a=t.mobileZoom);var i={zoom:a,gestureHandling:t.gestureHandling,disableDefaultUI:t.disableUi,zoomControl:t.zoomControl,panControl:t.panControl,center:e,mapTypeControlOptions:{mapTypeIds:[window.google.maps.MapTypeId.ROADMAP,window.google.maps.MapTypeId.SATELLITE,"user_map_style"]}};this.hasMapStyles=t.mapStyles&&Object.keys(t.mapStyles).length>0,this.hasMapStyles||(i.mapId=t.id);var s=new window.google.maps.Map(o,i),n={name:t.mapName};if(this.hasMapStyles){var r=new window.google.maps.StyledMapType(t.mapStyles,n);s.mapTypes.set("user_map_style",r),s.setMapTypeId("user_map_style")}t.markerAtCenter&&(this.centerMarker=this.addMarker(e,s,t.markerIcon,t.markersDraggable),s.centerMarker=this.centerMarker),this.linkAutocompleteField(t.autocomplete,t.autocompleteElement,s,t),this.showMarkers(t.markerPositions,s,t),this.showDirections(t.directions,s,t),sowb.SiteOriginGoogleMapInstances.push(s)},linkAutocompleteField:function(e,t,a,i){if(e&&t){var s=function(o){this.inputAddress!==o&&(this.inputAddress=o,this.getLocation(this.inputAddress).done(function(o){a.setZoom(15),a.setCenter(o),this.centerMarker&&(this.centerMarker.setPosition(o),this.centerMarker.setTitle(this.inputAddress))}.bind(this)))}.bind(this),n=o(t);e.addListener("place_changed",function(){var o=e.getPlace();a.setZoom(15),o.geometry&&(a.setCenter(o.geometry.location),this.centerMarker&&this.centerMarker.setPosition(o.geometry.location))}.bind(this)),window.google.maps.event.addListener(t,"keypress",(function(o){"13"===(o.keyCode||o.which)&&o.preventDefault()})),n.on("focusin",function(){if(!this.resultsObserver){var e=document.querySelector(".pac-container");this.resultsObserver=new MutationObserver((function(){var e=o(o(".pac-item").get(0)),t=e.find(".pac-item-query").text(),a=e.find("span").not("[class]").text(),i=t+(a?", "+a:"");i&&s(i)}));this.resultsObserver.observe(e,{attributes:!0,childList:!0,characterData:!0})}}.bind(this));var r=function(o){this.getGeocoder().geocode({location:o},function(e,t){if(t===window.google.maps.GeocoderStatus.OK&&e.length>0){var a=e[0].formatted_address;n.val(a),this.centerMarker&&(this.centerMarker.setPosition(o),this.centerMarker.setTitle(a))}}.bind(this))}.bind(this);a.addListener("click",(function(o){r(o.latLng)})),this.centerMarker.addListener("dragend",(function(o){r(o.latLng)}))}},addMarker:function(o,e,t,a){const i={position:o,map:e,gmpDraggable:a,draggable:a,title:""};return this.hasMapStyles?("string"==typeof t&&(i.icon=t),new window.google.maps.Marker(i)):(i.content=this.drawMarkerEl(t),new window.google.maps.marker.AdvancedMarkerElement(i))},showMarkers:function(o,e,t){if(o&&o.length){this.infoWindows=[];for(var a=[],i=0;i<o.length;i++){var s=parseInt(i/10);a.length===s&&(a[s]=[]),a[s][i%10]=o[i]}var n=function(o){var a=o.customMarkerIcon,i=o.hasOwnProperty("info")?o.info:null,s=o.hasOwnProperty("infoMaxWidth")?o.infoMaxWidth:null;return this.getLocation(o.place).done(function(o){const n=a||t.markerIcon,r=this.addMarker(o,e,n,t.markersDraggable);if(i){var l={content:i};s&&(l.maxWidth=s);var p=t.markerInfoDisplay;l.disableAutoPan="always"===p;var g=new window.google.maps.InfoWindow(l);this.infoWindows.push(g);var d=p;"always"===p&&(d="click",g.open({map:e,anchor:r,shouldFocus:!1})),r.addListener(d,function(){g.open(e,r),"always"===p||t.markerInfoMultiple||this.infoWindows.forEach((function(o){o!==g&&o.close()}))}.bind(this)),"mouseover"===p&&r.addListener("mouseout",(function(){setTimeout((function(){g.close()}),100)}))}}.bind(this)).fail((function(o){r=o===window.google.maps.GeocoderStatus.OVER_QUERY_LIMIT,console.log(o)}))}.bind(this),r=!1,l=function(o,e){for(var t=0,a=0;a<o.length&&!r;a++)n(o[a]).then((function(){++t===o.length&&e.length&&l(e.shift(),e)}))}.bind(this);l(a.shift(),a)}},showDirections:function(o,e){if(o){o.waypoints&&o.waypoints.length&&o.waypoints.map((function(o){o.stopover=Boolean(o.stopover)}));var t=new window.google.maps.DirectionsRenderer;t.setMap(e),(new window.google.maps.DirectionsService).route({origin:o.origin,destination:o.destination,travelMode:o.travelMode.toUpperCase(),avoidHighways:o.avoidHighways,avoidTolls:o.avoidTolls,waypoints:o.waypoints,optimizeWaypoints:o.optimizeWaypoints},(function(e,a){a===window.google.maps.DirectionsStatus.OK&&(t.setOptions({preserveViewport:o.preserveViewport}),t.setDirections(e))}))}},initMaps:function(){var e=o(".sow-google-map-autocomplete"),t=new o.Deferred;0===e.length?t.resolve():e.each(function(e,a){if(void 0!==window.google.maps.places){var i=new window.google.maps.places.Autocomplete(a),s=o(a).siblings(".sow-google-map-canvas");if(s.length>0){var n=s.data("options");n.autocomplete=i,n.autocompleteElement=a,this.getLocation(n.address).done(function(o){this.showMap(s.get(0),o,n),s.data("initialized",!0),t.resolve()}.bind(this)).fail((function(){s.append("<div><p><strong>"+soWidgetsGoogleMap.geocode.noResults+"</strong></p></div>"),t.reject()}))}}else t.reject('Sorry, we couldn\'t load the "places" library due to another plugin, so the autocomplete feature is not available.')}.bind(this)),t.always(function(){o(".sow-google-map-canvas").each(function(e,t){var a=o(t);if(a.data("initialized"))return!0;var i=a.data("options"),s=i.address;if(!s){var n=i.markerPositions;n&&n.length&&(s=n[0].place)}this.getLocation(s).done(function(o){this.showMap(a.get(0),o,i),a.data("initialized",!0)}.bind(this)).fail((function(){a.append("<div><p><strong>"+soWidgetsGoogleMap.geocode.noResults+"</strong></p></div>")}))}.bind(this))}.bind(this)).fail((function(o){console.log(o)})).done((function(){o(sowb).trigger("maps_loaded")}))},getGeocoder:function(){return this._geocoder||(this._geocoder=new window.google.maps.Geocoder),this._geocoder},getLocation:function(e){var t,a=new o.Deferred,i={address:e};if(e&&e.indexOf(",")>-1){var s=e.replace(/[\(\)]/g,"").split(",");s&&2===s.length&&(t=new window.google.maps.LatLng(s[0],s[1]),isNaN(t.lat())||isNaN(t.lng())||(i={location:{lat:t.lat(),lng:t.lng()}}))}if(i.hasOwnProperty("location"))a.resolve(i.location);else if(i.hasOwnProperty("address")){if(!i.address){var n=parseInt(Math.random()*this.DEFAULT_LOCATIONS.length);i.address=this.DEFAULT_LOCATIONS[n]}var r=0,l=function(o,e){e===window.google.maps.GeocoderStatus.OK?a.resolve(o[0].geometry.location):e===window.google.maps.GeocoderStatus.OVER_QUERY_LIMIT?++r<3?setTimeout(function(){this.getGeocoder().geocode.call(this,i,l)}.bind(this),1e3):a.reject(e):e!==window.google.maps.GeocoderStatus.ZERO_RESULTS&&e!==window.google.maps.GeocoderStatus.OVER_DAILY_LIMIT||a.reject(e)}.bind(this);this.getGeocoder().geocode(i,l)}return a}}},jQuery(window.sowb).on("sow-google-map-loaded",(function(){new sowb.SiteOriginGoogleMap(jQuery).initMaps()})),jQuery((function(o){sowb.googleMapsData=[],sowb.googleMapsData.libraries=["marker"];const e=()=>{if("object"!=typeof window.wp||"object"!=typeof window.wp.data||void 0===window.google.maps)return void setTimeout(e,250);const o=wp.data.subscribe(()=>{0!==wp.data.select("core/block-editor").getBlocks().length&&(soGoogleMapInitialize(),o())})};sowb.setupGoogleMaps=function(t,a=!1){var i=o(".sow-google-map-canvas");if(i.length&&(o("body.wp-admin").length&&sowb.googleMapsData.libraries.push("places"),i.each((function(e,t){var a=o(t);if(a.data("apiInitialized"))return a;var i=a.data("options");i&&(void 0!==i.libraries&&null!==i.libraries&&(sowb.googleMapsData.libraries=sowb.googleMapsData.libraries.concat(i.libraries)),!sowb.googleMapsData.apiKey&&i.apiKey&&(sowb.googleMapsData.apiKey=i.apiKey)),a.data("apiInitialized",!0)})),void 0===window.google&&(window.google={}),a||void 0===window.google.maps))if(o("body.wp-admin").length){if(o("#sow-google-maps-js").length||sowb.loadGoogleMapsAPI(a),o(".editor-styles-wrapper").length)return void e();setTimeout((function(){soGoogleMapInitialize()}),250)}else sowb.loadGoogleMapsAPI(a),sowb.googleMapsData.timer=setInterval((function(){var o=!1;sowb.googleMapsData.ApiError=!0,void 0!==sowb.googleMapsData.ApiError&&sowb.googleMapsData.ApiError&&(o=!0),o||void 0===window.google.maps||(o=!0,soGoogleMapInitialize()),o&&clearInterval(sowb.googleMapsData.timer)}),250)},sowb.loadGoogleMapsAPI=function(e=!1){o("#sow-google-maps-js").length&&(e||void 0!==sowb.googleMapsData.ApiError&&sowb.googleMapsData.ApiError)&&o("#sow-google-maps-js").remove(),sowb.googleMapsData.apiKey||console.warn("SiteOrigin Google Maps: Could not find API key. Google Maps API key is required.");let t="https://maps.googleapis.com/maps/api/js?key="+sowb.googleMapsData.apiKey+"&callback=soGoogleMapInitialize&loading=async";if(sowb.googleMapsData.libraries&&sowb.googleMapsData.libraries.length&&(t+="&libraries="+sowb.googleMapsData.libraries.join(",")),window.console&&window.console.error){var a=window.console.error;sowb.googleMapsData.ApiError=!1,sowb.onLoadMapsApiError=function(e){var t;"string"==typeof e&&(t=e.match(/^Google Maps API (error|warning): ([^\s]*)\s([^\s]*)(?:\s(.*))?/)),t&&t.length&&t[0]&&(o(".sow-google-map-canvas").each((function(e,t){var a=o(t);if(a.data("fallbackImage")){var i=a.data("fallbackImage");i.hasOwnProperty("img")&&a.append(i.img)}})),sowb.googleMapsData.ApiError=!0),a.apply(window.console,arguments)},window.console.error=sowb.onLoadMapsApiError}soWidgetsGoogleMap.map_consent?(e&&o(".sow-google-map-consent button").off("click"),o(".sow-google-map-consent button").on("click",(function(){o(".sow-google-map-consent").remove(),o(".sow-google-map-canvas").show(),sowb.mapsApiInitialized||(o("body").append('<script async type="text/javascript" id="sow-google-maps-js" src="'+t+'">'),sowb.mapsApiInitialized=!0)}))):(o("body").append('<script async type="text/javascript" id="sow-google-maps-js" src="'+t+'">'),sowb.mapsApiInitialized=!0)},sowb.setupGoogleMaps(),o(sowb).on("setup_widgets",sowb.setupGoogleMaps)}));