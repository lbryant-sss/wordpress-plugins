!function(e){const t=function(t){const n=e(this);if(n.data("initialized"))return;const i=n.find(" .existing-content-selector"),s=parseInt(jQuery("#post_ID").val()),o=function(){const e=n.find("input.siteorigin-widget-input").val();return 0===e.length?[]:e.split(",")},d=function(){const t=o();n.find("ul.items > li").each(function(n,i){const s=e(this);t.indexOf(s.data("value"))>-1?s.addClass("selected"):s.removeClass("selected")})},l=n.find("ul.items"),a=n.find(".content-no-results");const c=()=>{const t=n.find(".content-text-search"),i=t.val(),o=t.data("source"),d=t.data("postTypes"),c={action:"so_widgets_search_"+o,postId:s};return"posts"===o?(c.query=i,c.postTypes=d):"terms"===o&&(c.term=i),"string"==typeof icl_this_lang&&(c.language=icl_this_lang),a.addClass("hidden"),l.empty(),l.removeClass("hidden"),l.addClass("loading"),e.get(window.top.soWidgets.ajaxurl,c,t=>{if(0===t.length)return a.removeClass("hidden"),l.addClass("hidden"),void l.removeClass("loading");t.forEach(t=>{""===t.label&&(t.label="&nbsp;"),l.append(e("<li>").html(t.label+"<span>("+t.type+")</span>").data(t))}),l.removeClass("loading")})};n.find(".siteorigin-widget-autocomplete-input").on("click",()=>{a.addClass("hidden"),l.show(),i.show();let t=new e.Deferred;i.is(":visible")&&0===i.find("ul.items li").length?t=c():t.resolve(),t.done(d)});const r=function(){i.hide()};e(window).on("mousedown",function(e){0===n.find(e.target).length&&r()}),n.find(".button-close").on("click",r),n.on("click keypress",".items li",function(t){if(t.preventDefault(),"keyup"==t.type&&!window.sowbForms.isEnter(t))return;const s=n.find("input.siteorigin-widget-input"),d=e(this),l=d.data("value");if(i.data("multiple")){const e=o(),t=e.indexOf(l);t>-1?(e.splice(t,1),d.removeClass("selected")):(e.push(l),d.addClass("selected")),s.val(e.join(","))}else d.parent().find(".selected").removeClass("selected"),d.addClass("selected"),s.val(l),r();s.trigger("change")});let u=null;n.find(".content-text-search").on("keyup",function(){null!==u&&clearTimeout(u),u=setTimeout(function(){c()},500)}),n.data("initialized",!0)};window.top===window.self&&"string"==typeof pagenow&&"site-editor"!==pagenow&&e(document).on("sowsetupformfield",".siteorigin-widget-field-type-autocomplete",t),window.addEventListener("message",function(n){n.data&&"sowbBlockFormInit"===n.data.action&&e(".siteorigin-widget-field-type-autocomplete").each(function(){t.call(this)})})}(jQuery);