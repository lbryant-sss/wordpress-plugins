(()=>{"use strict";var e={20:(e,t,n)=>{var a=n(609),r=Symbol.for("react.element"),s=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),l=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function o(e,t,n){var a,o={},c=null,m=null;for(a in void 0!==n&&(c=""+n),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(m=t.ref),t)s.call(t,a)&&!i.hasOwnProperty(a)&&(o[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===o[a]&&(o[a]=t[a]);return{$$typeof:r,type:e,key:c,ref:m,props:o,_owner:l.current}}t.jsx=o,t.jsxs=o},848:(e,t,n)=>{e.exports=n(20)},609:e=>{e.exports=window.React}},t={};function n(a){var r=t[a];if(void 0!==r)return r.exports;var s=t[a]={exports:{}};return e[a](s,s.exports,n),s.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a=n(609);const r=window.wp.components,s=window.wp.domReady;var l=n.n(s);const i=window.wp.element,o=window.wp.apiFetch;var c=n.n(o);const m=window.wp.compose,u=window.wp.url,d=window.wp.i18n,g={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function h(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const p={date:h({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:h({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:h({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},y={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function f(e){return(t,n)=>{let a;if("formatting"===(n?.context?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,r=n?.width?String(n.width):t;a=e.formattingValues[r]||e.formattingValues[t]}else{const t=e.defaultWidth,r=n?.width?String(n.width):e.defaultWidth;a=e.values[r]||e.values[t]}return a[e.argumentCallback?e.argumentCallback(t):t]}}function _(e){return(t,n={})=>{const a=n.width,r=a&&e.matchPatterns[a]||e.matchPatterns[e.defaultMatchWidth],s=t.match(r);if(!s)return null;const l=s[0],i=a&&e.parsePatterns[a]||e.parsePatterns[e.defaultParseWidth],o=Array.isArray(i)?function(e){for(let t=0;t<e.length;t++)if(e[t].test(l))return t}(i):function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&e[t].test(l))return t}(i);let c;return c=e.valueCallback?e.valueCallback(o):o,c=n.valueCallback?n.valueCallback(c):c,{value:c,rest:t.slice(l.length)}}}var v;const E={code:"en-US",formatDistance:(e,t,n)=>{let a;const r=g[e];return a="string"==typeof r?r:1===t?r.one:r.other.replace("{{count}}",t.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+a:a+" ago":a},formatLong:p,formatRelative:(e,t,n,a)=>y[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),a=n%100;if(a>20||a<10)switch(a%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:f({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:f({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:f({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:f({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:f({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(v={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(v.matchPattern);if(!n)return null;const a=n[0],r=e.match(v.parsePattern);if(!r)return null;let s=v.valueCallback?v.valueCallback(r[0]):r[0];return s=t.valueCallback?t.valueCallback(s):s,{value:s,rest:e.slice(a.length)}}),era:_({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:_({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:_({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:_({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:_({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};let w={};function x(){return w}Math.pow(10,8);const S=6048e5,b=Symbol.for("constructDateFrom");function M(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&b in e?e[b](t):e instanceof Date?new e.constructor(t):new Date(t)}function T(e,t){return M(t||e,e)}function L(e){const t=T(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function k(e,t){const n=T(e,t?.in);return n.setHours(0,0,0,0),n}function D(e,t){const n=T(e,t?.in);return function(e,t,n){const[a,r]=function(e,...t){const n=M.bind(null,e||t.find((e=>"object"==typeof e)));return t.map(n)}(n?.in,e,t),s=k(a),l=k(r),i=+s-L(s),o=+l-L(l);return Math.round((i-o)/864e5)}(n,function(e,t){const n=T(e,t?.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}(n))+1}function C(e,t){const n=x(),a=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??n.weekStartsOn??n.locale?.options?.weekStartsOn??0,r=T(e,t?.in),s=r.getDay(),l=(s<a?7:0)+s-a;return r.setDate(r.getDate()-l),r.setHours(0,0,0,0),r}function N(e,t){return C(e,{...t,weekStartsOn:1})}function I(e,t){const n=T(e,t?.in),a=n.getFullYear(),r=M(n,0);r.setFullYear(a+1,0,4),r.setHours(0,0,0,0);const s=N(r),l=M(n,0);l.setFullYear(a,0,4),l.setHours(0,0,0,0);const i=N(l);return n.getTime()>=s.getTime()?a+1:n.getTime()>=i.getTime()?a:a-1}function P(e,t){const n=T(e,t?.in),a=+N(n)-+function(e,t){const n=I(e,t),a=M(t?.in||e,0);return a.setFullYear(n,0,4),a.setHours(0,0,0,0),N(a)}(n);return Math.round(a/S)+1}function A(e,t){const n=T(e,t?.in),a=n.getFullYear(),r=x(),s=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,l=M(t?.in||e,0);l.setFullYear(a+1,0,s),l.setHours(0,0,0,0);const i=C(l,t),o=M(t?.in||e,0);o.setFullYear(a,0,s),o.setHours(0,0,0,0);const c=C(o,t);return+n>=+i?a+1:+n>=+c?a:a-1}function H(e,t){const n=T(e,t?.in),a=+C(n,t)-+function(e,t){const n=x(),a=t?.firstWeekContainsDate??t?.locale?.options?.firstWeekContainsDate??n.firstWeekContainsDate??n.locale?.options?.firstWeekContainsDate??1,r=A(e,t),s=M(t?.in||e,0);return s.setFullYear(r,0,a),s.setHours(0,0,0,0),C(s,t)}(n,t);return Math.round(a/S)+1}function O(e,t){return(e<0?"-":"")+Math.abs(e).toString().padStart(t,"0")}const F={y(e,t){const n=e.getFullYear(),a=n>0?n:1-n;return O("yy"===t?a%100:a,t.length)},M(e,t){const n=e.getMonth();return"M"===t?String(n+1):O(n+1,2)},d:(e,t)=>O(e.getDate(),t.length),a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];default:return"am"===n?"a.m.":"p.m."}},h:(e,t)=>O(e.getHours()%12||12,t.length),H:(e,t)=>O(e.getHours(),t.length),m:(e,t)=>O(e.getMinutes(),t.length),s:(e,t)=>O(e.getSeconds(),t.length),S(e,t){const n=t.length,a=e.getMilliseconds();return O(Math.trunc(a*Math.pow(10,n-3)),t.length)}},j={G:function(e,t,n){const a=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(a,{width:"abbreviated"});case"GGGGG":return n.era(a,{width:"narrow"});default:return n.era(a,{width:"wide"})}},y:function(e,t,n){if("yo"===t){const t=e.getFullYear(),a=t>0?t:1-t;return n.ordinalNumber(a,{unit:"year"})}return F.y(e,t)},Y:function(e,t,n,a){const r=A(e,a),s=r>0?r:1-r;return"YY"===t?O(s%100,2):"Yo"===t?n.ordinalNumber(s,{unit:"year"}):O(s,t.length)},R:function(e,t){return O(I(e),t.length)},u:function(e,t){return O(e.getFullYear(),t.length)},Q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(a);case"QQ":return O(a,2);case"Qo":return n.ordinalNumber(a,{unit:"quarter"});case"QQQ":return n.quarter(a,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(a,{width:"narrow",context:"formatting"});default:return n.quarter(a,{width:"wide",context:"formatting"})}},q:function(e,t,n){const a=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(a);case"qq":return O(a,2);case"qo":return n.ordinalNumber(a,{unit:"quarter"});case"qqq":return n.quarter(a,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(a,{width:"narrow",context:"standalone"});default:return n.quarter(a,{width:"wide",context:"standalone"})}},M:function(e,t,n){const a=e.getMonth();switch(t){case"M":case"MM":return F.M(e,t);case"Mo":return n.ordinalNumber(a+1,{unit:"month"});case"MMM":return n.month(a,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(a,{width:"narrow",context:"formatting"});default:return n.month(a,{width:"wide",context:"formatting"})}},L:function(e,t,n){const a=e.getMonth();switch(t){case"L":return String(a+1);case"LL":return O(a+1,2);case"Lo":return n.ordinalNumber(a+1,{unit:"month"});case"LLL":return n.month(a,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(a,{width:"narrow",context:"standalone"});default:return n.month(a,{width:"wide",context:"standalone"})}},w:function(e,t,n,a){const r=H(e,a);return"wo"===t?n.ordinalNumber(r,{unit:"week"}):O(r,t.length)},I:function(e,t,n){const a=P(e);return"Io"===t?n.ordinalNumber(a,{unit:"week"}):O(a,t.length)},d:function(e,t,n){return"do"===t?n.ordinalNumber(e.getDate(),{unit:"date"}):F.d(e,t)},D:function(e,t,n){const a=D(e);return"Do"===t?n.ordinalNumber(a,{unit:"dayOfYear"}):O(a,t.length)},E:function(e,t,n){const a=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(a,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(a,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},e:function(e,t,n,a){const r=e.getDay(),s=(r-a.weekStartsOn+8)%7||7;switch(t){case"e":return String(s);case"ee":return O(s,2);case"eo":return n.ordinalNumber(s,{unit:"day"});case"eee":return n.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(r,{width:"short",context:"formatting"});default:return n.day(r,{width:"wide",context:"formatting"})}},c:function(e,t,n,a){const r=e.getDay(),s=(r-a.weekStartsOn+8)%7||7;switch(t){case"c":return String(s);case"cc":return O(s,t.length);case"co":return n.ordinalNumber(s,{unit:"day"});case"ccc":return n.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(r,{width:"narrow",context:"standalone"});case"cccccc":return n.day(r,{width:"short",context:"standalone"});default:return n.day(r,{width:"wide",context:"standalone"})}},i:function(e,t,n){const a=e.getDay(),r=0===a?7:a;switch(t){case"i":return String(r);case"ii":return O(r,t.length);case"io":return n.ordinalNumber(r,{unit:"day"});case"iii":return n.day(a,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(a,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(a,{width:"short",context:"formatting"});default:return n.day(a,{width:"wide",context:"formatting"})}},a:function(e,t,n){const a=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(a,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(a,{width:"narrow",context:"formatting"});default:return n.dayPeriod(a,{width:"wide",context:"formatting"})}},b:function(e,t,n){const a=e.getHours();let r;switch(r=12===a?"noon":0===a?"midnight":a/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(e,t,n){const a=e.getHours();let r;switch(r=a>=17?"evening":a>=12?"afternoon":a>=4?"morning":"night",t){case"B":case"BB":case"BBB":return n.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(r,{width:"narrow",context:"formatting"});default:return n.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(e,t,n){if("ho"===t){let t=e.getHours()%12;return 0===t&&(t=12),n.ordinalNumber(t,{unit:"hour"})}return F.h(e,t)},H:function(e,t,n){return"Ho"===t?n.ordinalNumber(e.getHours(),{unit:"hour"}):F.H(e,t)},K:function(e,t,n){const a=e.getHours()%12;return"Ko"===t?n.ordinalNumber(a,{unit:"hour"}):O(a,t.length)},k:function(e,t,n){let a=e.getHours();return 0===a&&(a=24),"ko"===t?n.ordinalNumber(a,{unit:"hour"}):O(a,t.length)},m:function(e,t,n){return"mo"===t?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):F.m(e,t)},s:function(e,t,n){return"so"===t?n.ordinalNumber(e.getSeconds(),{unit:"second"}):F.s(e,t)},S:function(e,t){return F.S(e,t)},X:function(e,t,n){const a=e.getTimezoneOffset();if(0===a)return"Z";switch(t){case"X":return W(a);case"XXXX":case"XX":return B(a);default:return B(a,":")}},x:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"x":return W(a);case"xxxx":case"xx":return B(a);default:return B(a,":")}},O:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+z(a,":");default:return"GMT"+B(a,":")}},z:function(e,t,n){const a=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+z(a,":");default:return"GMT"+B(a,":")}},t:function(e,t,n){return O(Math.trunc(+e/1e3),t.length)},T:function(e,t,n){return O(+e,t.length)}};function z(e,t=""){const n=e>0?"-":"+",a=Math.abs(e),r=Math.trunc(a/60),s=a%60;return 0===s?n+String(r):n+String(r)+t+O(s,2)}function W(e,t){return e%60==0?(e>0?"-":"+")+O(Math.abs(e)/60,2):B(e,t)}function B(e,t=""){const n=e>0?"-":"+",a=Math.abs(e);return n+O(Math.trunc(a/60),2)+t+O(a%60,2)}const q=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});default:return t.date({width:"full"})}},Y=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});default:return t.time({width:"full"})}},R={p:Y,P:(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],a=n[1],r=n[2];if(!r)return q(e,t);let s;switch(a){case"P":s=t.dateTime({width:"short"});break;case"PP":s=t.dateTime({width:"medium"});break;case"PPP":s=t.dateTime({width:"long"});break;default:s=t.dateTime({width:"full"})}return s.replace("{{date}}",q(a,t)).replace("{{time}}",Y(r,t))}},Q=/^D+$/,V=/^Y+$/,G=["D","DD","YY","YYYY"];function U(e){return!(!((t=e)instanceof Date||"object"==typeof t&&"[object Date]"===Object.prototype.toString.call(t))&&"number"!=typeof e||isNaN(+T(e)));var t}const Z=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,X=/^'([^]*?)'?$/,K=/''/g,J=/[a-zA-Z]/;function ee(e,t,n){const a=x(),r=n?.locale??a.locale??E,s=n?.firstWeekContainsDate??n?.locale?.options?.firstWeekContainsDate??a.firstWeekContainsDate??a.locale?.options?.firstWeekContainsDate??1,l=n?.weekStartsOn??n?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,i=T(e,n?.in);if(!U(i))throw new RangeError("Invalid time value");let o=t.match($).map((e=>{const t=e[0];return"p"===t||"P"===t?(0,R[t])(e,r.formatLong):e})).join("").match(Z).map((e=>{if("''"===e)return{isToken:!1,value:"'"};const t=e[0];if("'"===t)return{isToken:!1,value:te(e)};if(j[t])return{isToken:!0,value:e};if(t.match(J))throw new RangeError("Format string contains an unescaped latin alphabet character `"+t+"`");return{isToken:!1,value:e}}));r.localize.preprocessor&&(o=r.localize.preprocessor(i,o));const c={firstWeekContainsDate:s,weekStartsOn:l,locale:r};return o.map((a=>{if(!a.isToken)return a.value;const s=a.value;return(!n?.useAdditionalWeekYearTokens&&function(e){return V.test(e)}(s)||!n?.useAdditionalDayOfYearTokens&&function(e){return Q.test(e)}(s))&&function(e,t,n){const a=function(e,t,n){const a="Y"===e[0]?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${a} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}(e,t,n);if(console.warn(a),G.includes(e))throw new RangeError(a)}(s,t,String(e)),(0,j[s[0]])(i,s,r.localize,c)})).join("")}function te(e){const t=e.match(X);return t?t[1].replace(K,"'"):e}function ne(e,t){const n=T(e,t?.in);return n.setHours(23,59,59,999),n}const ae=[{label:(0,d.__)("Custom date range…","simple-history"),value:"customRange"},{label:(0,d.__)("Last day","simple-history"),value:"lastdays:1"},{label:(0,d.__)("Last 7 days","simple-history"),value:"lastdays:7"},{label:(0,d.__)("Last 14 days","simple-history"),value:"lastdays:14"},{label:(0,d.__)("Last 30 days","simple-history"),value:"lastdays:30"},{label:(0,d.__)("Last 60 days","simple-history"),value:"lastdays:60"}],re=[{label:(0,d.__)("Loading…","simple-history"),value:""}],se=[{label:(0,d._x)("Info","Log level in gui","simple-history"),value:"info"},{label:(0,d._x)("Warning","Log level in gui","simple-history"),value:"warning"},{label:(0,d._x)("Error","Log level in gui","simple-history"),value:"error"},{label:(0,d._x)("Critical","Log level in gui","simple-history"),value:"critical"},{label:(0,d._x)("Alert","Log level in gui","simple-history"),value:"alert"},{label:(0,d._x)("Emergency","Log level in gui","simple-history"),value:"emergency"},{label:(0,d._x)("Debug","Log level in gui","simple-history"),value:"debug"}],le="yyyy-MM-dd'T'HH:mm:ss",ie=" - ",oe=ee(k(new Date),le),ce=ee(ne(new Date),le);function me({event:e}){window.location.hash=`#simple-history/event/${e.id}`}function ue(e,t){return Math.floor(Math.random()*(t-e+1)+e)}const de=window.wp.primitives;var ge=n(848);const he=(0,ge.jsxs)(de.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,ge.jsx)(de.Path,{d:"M7.5 12C7.5 11.1716 6.82843 10.5 6 10.5C5.17157 10.5 4.5 11.1716 4.5 12C4.5 12.8284 5.17157 13.5 6 13.5C6.82843 13.5 7.5 12.8284 7.5 12Z"}),(0,ge.jsx)(de.Path,{d:"M13.5 12C13.5 11.1716 12.8284 10.5 12 10.5C11.1716 10.5 10.5 11.1716 10.5 12C10.5 12.8284 11.1716 13.5 12 13.5C12.8284 13.5 13.5 12.8284 13.5 12Z"}),(0,ge.jsx)(de.Path,{d:"M19.5 12C19.5 11.1716 18.8284 10.5 18 10.5C17.1716 10.5 16.5 11.1716 16.5 12C16.5 12.8284 17.1716 13.5 18 13.5C18.8284 13.5 19.5 12.8284 19.5 12Z"})]}),pe=window.wp.hooks,ye=(0,ge.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ge.jsx)(de.Path,{d:"M11.776 4.454a.25.25 0 01.448 0l2.069 4.192a.25.25 0 00.188.137l4.626.672a.25.25 0 01.139.426l-3.348 3.263a.25.25 0 00-.072.222l.79 4.607a.25.25 0 01-.362.263l-4.138-2.175a.25.25 0 00-.232 0l-4.138 2.175a.25.25 0 01-.363-.263l.79-4.607a.25.25 0 00-.071-.222L4.754 9.881a.25.25 0 01.139-.426l4.626-.672a.25.25 0 00.188-.137l2.069-4.192z"})}),fe=(0,ge.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ge.jsx)(de.Path,{fillRule:"evenodd",d:"M9.706 8.646a.25.25 0 01-.188.137l-4.626.672a.25.25 0 00-.139.427l3.348 3.262a.25.25 0 01.072.222l-.79 4.607a.25.25 0 00.362.264l4.138-2.176a.25.25 0 01.233 0l4.137 2.175a.25.25 0 00.363-.263l-.79-4.607a.25.25 0 01.072-.222l3.347-3.262a.25.25 0 00-.139-.427l-4.626-.672a.25.25 0 01-.188-.137l-2.069-4.192a.25.25 0 00-.448 0L9.706 8.646zM12 7.39l-.948 1.921a1.75 1.75 0 01-1.317.957l-2.12.308 1.534 1.495c.412.402.6.982.503 1.55l-.362 2.11 1.896-.997a1.75 1.75 0 011.629 0l1.895.997-.362-2.11a1.75 1.75 0 01.504-1.55l1.533-1.495-2.12-.308a1.75 1.75 0 01-1.317-.957L12 7.39z",clipRule:"evenodd"})}),_e=(0,ge.jsx)(de.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,ge.jsx)(de.Path,{d:"M17 10h-1.2V7c0-2.1-1.7-3.8-3.8-3.8-2.1 0-3.8 1.7-3.8 3.8h1.5c0-1.2 1-2.2 2.2-2.2s2.2 1 2.2 2.2v3H7c-.6 0-1 .4-1 1v8c0 .6.4 1 1 1h10c.6 0 1-.4 1-1v-8c0-.6-.4-1-1-1z"})}),ve=(0,ge.jsx)(de.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,ge.jsx)(de.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M15 11h-.2V9c0-1.5-1.2-2.8-2.8-2.8S9.2 7.5 9.2 9v2H9c-.6 0-1 .4-1 1v4c0 .6.4 1 1 1h6c.6 0 1-.4 1-1v-4c0-.6-.4-1-1-1zm-1.8 0h-2.5V9c0-.7.6-1.2 1.2-1.2s1.2.6 1.2 1.2v2z"})}),Ee=function(e){const{variant:t,char:n=null}=e;let s,l;switch(t){case"unlocked":s=ye;break;case"unlocked2":s=fe;break;case"unlocked3":s=_e;break;case"locked":s=ve;break;case"verified":l="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iNDgiIHZpZXdCb3g9IjAgLTk2MCA5NjAgOTYwIiB3aWR0aD0iNDgiPjxwYXRoIGQ9Im0zNDYtNjAtNzYtMTMwLTE1MS0zMSAxNy0xNDctOTYtMTEyIDk2LTExMS0xNy0xNDcgMTUxLTMxIDc2LTEzMSAxMzQgNjIgMTM0LTYyIDc3IDEzMSAxNTAgMzEtMTcgMTQ3IDk2IDExMS05NiAxMTIgMTcgMTQ3LTE1MCAzMS03NyAxMzAtMTM0LTYyLTEzNCA2MlptMjctNzkgMTA3LTQ1IDExMCA0NSA2Ny0xMDAgMTE3LTMwLTEyLTExOSA4MS05Mi04MS05NCAxMi0xMTktMTE3LTI4LTY5LTEwMC0xMDggNDUtMTEwLTQ1LTY3IDEwMC0xMTcgMjggMTIgMTE5LTgxIDk0IDgxIDkyLTEyIDEyMSAxMTcgMjggNzAgMTAwWm0xMDctMzQxWm0tNDMgMTMzIDIyNy0yMjUtNDUtNDEtMTgyIDE4MC05NS05OS00NiA0NSAxNDEgMTQwWiIvPjwvc3ZnPg==";break;default:s=null}return(0,a.createElement)("span",{style:{display:"flex",alignItems:"center",color:"#fff",backgroundColor:"var(--sh-color-green-2)",textTransform:"uppercase",fontSize:"0.8em",border:"1px solid darkgreen",borderRadius:"4px",padding:"0 0.5em",opacity:"0.75",lineHeight:1,margin:"0 0 0 1em"}},(0,a.createElement)("span",{style:{padding:".5em 0"}},(0,d.__)("Premium","simple-history")),s?(0,a.createElement)(r.Icon,{icon:s,size:20}):null,l?(0,a.createElement)("img",{src:l,alt:"",style:{width:"20px",padding:"0 0 0 .5em"}}):null,n?(0,a.createElement)("span",{style:{padding:"0 0 0 .5em"}},n):null)};function we(e){const{handleOnClickPremiumFeature:t,onCloseDropdownMenu:n}=e;return!1===(0,pe.applyFilters)("SimpleHistory.showPremiumAddonsMenuGroup",!0)?null:(0,a.createElement)(r.MenuGroup,null,(0,a.createElement)(r.MenuItem,{onClick:()=>{n(),t({featureTitle:"Export results",featureDescription:(0,a.createElement)(a.Fragment,null,(0,a.createElement)("p",{style:{backgroundColor:"rgb(251 246 126)",fontSize:"1.1rem",padding:"1rem 2rem"}},(0,a.createElement)("strong",null,"Export results")," is a premium feature."),(0,a.createElement)("p",null,"The export function supports CSV and JSON and gives you a downloaded file of the current search result."))})},suffix:(0,a.createElement)(Ee,null),info:(0,d.__)("CSV and JSON supported","simple-history")},(0,d.__)("Export results…","simple-history")))}const xe=(0,a.createElement)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#5f6368"},(0,a.createElement)("path",{d:"m387-412 35-114-92-74h114l36-112 36 112h114l-93 74 35 114-92-71-93 71ZM240-40v-309q-38-42-59-96t-21-115q0-134 93-227t227-93q134 0 227 93t93 227q0 61-21 115t-59 96v309l-240-80-240 80Zm240-280q100 0 170-70t70-170q0-100-70-170t-170-70q-100 0-170 70t-70 170q0 100 70 170t170 70ZM320-159l160-41 160 41v-124q-35 20-75.5 31.5T480-240q-44 0-84.5-11.5T320-283v124Zm160-62Z"})),Se=e=>{const{premiumFeatureModalTitle:t,premiumFeatureDescription:n,handleModalClose:s}=e,l={backgroundImage:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIGhlaWdodD0iMjRweCIgdmlld0JveD0iMCAtOTYwIDk2MCA5NjAiIHdpZHRoPSIyNHB4IiBmaWxsPSIjM2Y5MzQ5Ij48cGF0aCBkPSJtNDI0LTI5NiAyODItMjgyLTU2LTU2LTIyNiAyMjYtMTE0LTExNC01NiA1NiAxNzAgMTcwWm01NiAyMTZxLTgzIDAtMTU2LTMxLjVUMTk3LTE5N3EtNTQtNTQtODUuNS0xMjdUODAtNDgwcTAtODMgMzEuNS0xNTZUMTk3LTc2M3E1NC01NCAxMjctODUuNVQ0ODAtODgwcTgzIDAgMTU2IDMxLjVUNzYzLTc2M3E1NCA1NCA4NS41IDEyN1Q4ODAtNDgwcTAgODMtMzEuNSAxNTZUNzYzLTE5N3EtNTQgNTQtMTI3IDg1LjVUNDgwLTgwWm0wLTgwcTEzNCAwIDIyNy05M3Q5My0yMjdxMC0xMzQtOTMtMjI3dC0yMjctOTNxLTEzNCAwLTIyNyA5M3QtOTMgMjI3cTAgMTM0IDkzIDIyN3QyMjcgOTNabTAtMzIwWiIvPjwvc3ZnPg==)",backgroundSize:"1.5rem",lineHeight:"1.5rem",backgroundRepeat:"no-repeat",backgroundPosition:"center left",paddingLeft:"30px"};return(0,a.createElement)(r.Modal,{icon:(0,a.createElement)(r.Icon,{icon:xe}),title:t,onRequestClose:s},n,(0,a.createElement)(r.__experimentalDivider,{margin:5,style:{color:"var(--sh-color-gray)"}}),(0,a.createElement)("p",{style:{fontWeight:"600",fontSize:"1rem"}},"Simple History Premium also includes:"),(0,a.createElement)("ul",{style:{listStyle:"disc",listStyleType:"none"}},(0,a.createElement)("li",{style:l},"Export as CSV and JSON"),(0,a.createElement)("li",{style:l},"Option to set number of days to keep the log"),(0,a.createElement)("li",{style:l},"Limit number of failed login attempts that are logged"),(0,a.createElement)("li",{style:l},"Control how to store IP Addresses (anonymized or not)"),(0,a.createElement)("li",{style:l},"Show a map of where a failed login attempt happened"),(0,a.createElement)("li",{style:l},"Control what messages to log"),(0,a.createElement)("li",{style:l},"Remove premium upgrade banners"),(0,a.createElement)("li",{style:l},"Remove review and donate banners")),(0,a.createElement)(r.__experimentalSpacer,{margin:10}),(0,a.createElement)(r.__experimentalHStack,{spacing:3},(0,a.createElement)(r.Button,{variant:"primary",onClick:()=>{window.open("https://simple-history.com/premium/?utm_source=wpadmin&utm_content=premium-feature-modal"),s()},style:{backgroundColor:"var(--sh-color-green)"}},"Upgrade to premium"),(0,a.createElement)(r.Button,{variant:"tertiary",onClick:s},"Maybe later")))};function be(e){const{eventsQueryParams:t,eventsTotal:n}=e,[s,l]=(0,i.useState)(!1),[o,c]=(0,i.useState)(""),[m,u]=(0,i.useState)(""),g=e=>{const{featureDescription:t="",featureTitle:n=""}=e;l(!0),u(n),c(t)};return(0,a.createElement)(a.Fragment,null,s?(0,a.createElement)(Se,{premiumFeatureModalTitle:m,premiumFeatureDescription:o,handleModalClose:()=>{l(!1)}}):null,(0,a.createElement)(r.DropdownMenu,{label:(0,d.__)("Actions (Export & other tools)","simple-history"),icon:he,toggleProps:{iconPosition:"right"}},(({onClose:e})=>(0,a.createElement)(a.Fragment,null,(0,a.createElement)(we,{handleOnClickPremiumFeature:g,onCloseDropdownMenu:e}),(0,a.createElement)(r.Slot,{name:"SimpleHistorySlotEventsControlBarMenu",fillProps:{onClose:e,eventsQueryParams:t,eventsTotal:n}})))))}function Me(e){const{eventsIsLoading:t,eventsTotal:n,eventsQueryParams:s}=e,l=t?(0,a.createElement)(r.__experimentalText,null,(0,a.createElement)(r.Spinner,null),(0,d._x)("Loading…","Message visible while waiting for log to load from server the first time","simple-history")):null,i=n?(0,a.createElement)(r.__experimentalText,null,(0,d.sprintf)(/* translators: %s: number of events */ /* translators: %s: number of events */
(0,d._n)("%s event","%s events",n,"simple-history"),n)):null;return(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{style:{background:"white",padding:"6px 12px"}},(0,a.createElement)(r.Flex,{gap:2},(0,a.createElement)(r.FlexItem,null,(0,a.createElement)(r.__experimentalHStack,{spacing:2},i,l)),(0,a.createElement)(r.FlexItem,null,(0,a.createElement)(be,{eventsQueryParams:s,eventsTotal:n})))))}function Te(e){var t,n,a="";if("string"==typeof e||"number"==typeof e)a+=e;else if("object"==typeof e)if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=Te(e[t]))&&(a&&(a+=" "),a+=n)}else for(n in e)e[n]&&(a&&(a+=" "),a+=n);return a}function Le(){for(var e,t,n=0,a="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=Te(e))&&(a&&(a+=" "),a+=t);return a}const ke=(0,ge.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ge.jsx)(de.Path,{d:"M10 17.389H8.444A5.194 5.194 0 1 1 8.444 7H10v1.5H8.444a3.694 3.694 0 0 0 0 7.389H10v1.5ZM14 7h1.556a5.194 5.194 0 0 1 0 10.39H14v-1.5h1.556a3.694 3.694 0 0 0 0-7.39H14V7Zm-4.5 6h5v-1.5h-5V13Z"})}),De=(0,ge.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ge.jsx)(de.Path,{d:"M12 3.2c-4.8 0-8.8 3.9-8.8 8.8 0 4.8 3.9 8.8 8.8 8.8 4.8 0 8.8-3.9 8.8-8.8 0-4.8-4-8.8-8.8-8.8zm0 16c-4 0-7.2-3.3-7.2-7.2C4.8 8 8 4.8 12 4.8s7.2 3.3 7.2 7.2c0 4-3.2 7.2-7.2 7.2zM11 17h2v-6h-2v6zm0-8h2V7h-2v2z"})});function Ce(e){const{event:t}=e,{details_html:n}=t;return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__details",dangerouslySetInnerHTML:{__html:n}})}const Ne=window.wp.date;function Ie(e){const{children:t,className:n}=e,r=Le("SimpleHistoryLogitem__inlineDivided",n);return(0,a.createElement)(a.Fragment,null," ",(0,a.createElement)("span",{className:r},t))}function Pe(e){const{event:t,eventVariant:n}=e,s=(0,Ne.getSettings)(),l=s.formats.datetimeAbbreviated,o=s.formats.time,c=s.timezone.string,m=Intl.DateTimeFormat().resolvedOptions().timeZone,u=t.date_gmt+"+0000";let g;g=(0,Ne.date)("Y-m-d",u)===(0,Ne.date)("Y-m-d",void 0,"GMT")?(0,d.sprintf)(
// translators: %s is the time, like 8:36 pm.
// translators: %s is the time, like 8:36 pm.
(0,d.__)("Today %s","simple-history"),(0,Ne.dateI18n)(o,u,m)):(0,Ne.dateI18n)(l,u,m);const[h,p]=(0,i.useState)((()=>(0,Ne.humanTimeDiff)(t.date_local)));(0,i.useEffect)((()=>{const e=setInterval((()=>{p((0,Ne.humanTimeDiff)(t.date_local))}),1e3);return()=>{clearInterval(e)}}),[t.date_local]);const y=(0,a.createElement)(a.Fragment,null,(0,a.createElement)("table",null,(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,"Date"),(0,a.createElement)("th",null,"Description"))),(0,a.createElement)("tbody",null,(0,a.createElement)("tr",null,(0,a.createElement)("td",null,t.date_gmt),(0,a.createElement)("td",null,(0,d.__)("GMT time","simple-history"))),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,t.date_local),(0,a.createElement)("td",null,(0,d.sprintf)(/* translators: 1: timezone string */ /* translators: 1: timezone string */
(0,d.__)("Website timezone (%1$s)","simple-history"),c))),c!==m&&(0,a.createElement)("tr",null,(0,a.createElement)("td",null,(0,Ne.dateI18n)("Y-m-d H:i:s",u,m)),(0,a.createElement)("td",null,(0,d.sprintf)(/* translators: 1: browser timezone */ /* translators: 1: browser timezone */
(0,d.__)("Browser local time (%1$s)","simple-history"),m)))))),f=(0,a.createElement)("time",{dateTime:t.date_gmt,className:"SimpleHistoryLogitem__when__liveRelative"},g," (",h,")");let _;return _="compact"===n?(0,a.createElement)("div",null,h):(0,a.createElement)(r.Tooltip,{text:y,delay:500},"modal"===n?(0,a.createElement)(r.__experimentalText,null,f):(0,a.createElement)(r.Button,{variant:"link",onClick:()=>{me({event:t})}},f)),(0,a.createElement)(Ie,{className:"SimpleHistoryLogitem__permalink SimpleHistoryLogitem__when"},_)}function Ae(e){const{event:t,eventVariant:n}=e,{initiator_data:s}=t;switch(t.initiator){case"wp_user":const e=s.user_display_name||s.user_login;let l;return l="compact"===n||"modal"===n?(0,a.createElement)("strong",null,e):(0,a.createElement)(r.Button,{href:s.user_profile_url,variant:"link"},(0,a.createElement)(a.Fragment,null,(0,a.createElement)("strong",null,e)," ",(0,a.createElement)("span",null,"(",s.user_email,")"))),(0,a.createElement)(Ie,null,l);case"web_user":return(0,a.createElement)(Ie,null,(0,a.createElement)("strong",null,(0,d.__)("Anonymous web user","simple-history")));case"wp_cli":return(0,a.createElement)(Ie,null,(0,a.createElement)("strong",null,(0,d.__)("WP-CLI","simple-history")));case"wp":return(0,a.createElement)(Ie,null,(0,a.createElement)("strong",null,(0,d.__)("WordPress","simple-history")));case"other":return(0,a.createElement)(Ie,null,(0,a.createElement)("strong",null,(0,d.__)("Other","simple-history")));default:return(0,a.createElement)(Ie,null,"Unknown initiator: ",(0,a.createElement)("code",null,t.initiator))}}const He=(0,ge.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ge.jsx)(de.Path,{d:"m13.06 12 6.47-6.47-1.06-1.06L12 10.94 5.53 4.47 4.47 5.53 10.94 12l-6.47 6.47 1.06 1.06L12 13.06l6.47 6.47 1.06-1.06L13.06 12Z"})}),Oe=[{key:"hostname",label:(0,d.__)("Hostname:","simple-history")},{key:"org",label:(0,d.__)("Org:","simple-history")},{key:"city",label:(0,d.__)("City:","simple-history")},{key:"region",label:(0,d.__)("Region:","simple-history")},{key:"country",label:(0,d.__)("Country:","simple-history")},{key:"loc",label:(0,d.__)("Location:","simple-history")}];function Fe(e){const{header:t,ipAddress:n,mapsApiKey:s,hasPremiumAddOn:l}=e,[o,c]=(0,i.useState)(!1),[m,u]=(0,i.useState)(!1),[g,h]=(0,i.useState)(),p=`https://ipinfo.io/${n.replace(/\.x$/,".0")}`;(0,i.useEffect)((()=>{m&&async function(){const e=await fetch(p,{method:"GET",headers:{Accept:"application/json"}}),t=await e.json();h(t),u(!1)}()}),[m,n,p]);const y=(0,i.createInterpolateElement)((0,d.__)("That IP address does not seem like a public one. It is probably a <a>bogon ip address</a>.","simple-history"),{a:(0,a.createElement)(r.ExternalLink,{href:"https://ipinfo.io/bogon",target:"_blank",rel:"noopener noreferrer"})}),f=s&&!g?.bogon&&g?.loc?(0,a.createElement)("tr",null,(0,a.createElement)("td",{colSpan:2},(0,a.createElement)("a",{href:`https://www.google.com/maps/place/${g.loc}/@${g.loc},6z`,target:"_blank",rel:"noopener noreferrer"},(0,a.createElement)("img",{src:`https://maps.googleapis.com/maps/api/staticmap?center=${g.loc}&zoom=7&size=350x100&scale=2&sensor=false&key=${s}`,width:"350",height:"100",alt:"Google Map"})))):null,_=l?null:(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{style:{display:"grid",placeItems:"center",width:"100%",height:100,backgroundImage:'url("/wp-content/plugins/simple-history/assets/images/map-img-blur.jpg")',backgroundSize:"cover",padding:"1rem"}},(0,a.createElement)(r.__experimentalText,null,(0,i.createInterpolateElement)((0,d.__)("See the location of the IP address on a map with <a>Simple History Premium</a> add-on.","simple-history"),{a:(0,a.createElement)(r.ExternalLink,{href:"https://simple-history.com/add-ons/premium/?utm_source=plugin&utm_medium=link&utm_campaign=ipinfo#GoogleMaps",target:"_blank",rel:"noopener noreferrer"})})))),v=g?(0,a.createElement)(a.Fragment,null,_,(0,a.createElement)("table",{className:"SimpleHistoryIpInfoDropin__ipInfoTable"},(0,a.createElement)("tbody",null,f,(0,a.createElement)("tr",null,(0,a.createElement)("td",{className:"SimpleHistoryIpInfoDropin__ipInfoTable__key"},(0,d.__)("IP address:","simple-history")),(0,a.createElement)("td",null,n)),(0,a.createElement)("tr",null,(0,a.createElement)("td",{className:"SimpleHistoryIpInfoDropin__ipInfoTable__key"},(0,d.__)("Header:","simple-history")),(0,a.createElement)("td",null,(0,a.createElement)("code",null,t))),g.bogon?(0,a.createElement)("tr",null,(0,a.createElement)("td",{className:"SimpleHistoryIpInfoDropin__ipInfoTable__key"},(0,d.__)("Error:","simple-history")),(0,a.createElement)("td",null,y)):null,Oe.map((e=>{const{key:t,label:n}=e,r=g[t];return r?(0,a.createElement)("tr",{key:t},(0,a.createElement)("td",{className:"SimpleHistoryIpInfoDropin__ipInfoTable__key"},n),(0,a.createElement)("td",null,r)):null})))),(0,a.createElement)(r.__experimentalText,{align:"right",isBlock:!0,variant:"muted",style:{marginTop:10}},(0,i.createInterpolateElement)((0,d.__)("IP info provided by <a>ipinfo.io</a>","simple-history"),{a:(0,a.createElement)(r.ExternalLink,{href:"https://ipinfo.io/",target:"_blank",rel:"noopener noreferrer"})}))):null;return(0,a.createElement)(r.Button,{title:t,onClick:e=>{"BUTTON"!==e.target.nodeName||(o?c(!1):(c(!0),u(!0)))},variant:"link"},n,o?(0,a.createElement)(r.Popover,{noArrow:!1,offset:10,placement:"top",animate:!0,shift:!0},(0,a.createElement)("div",{style:{minWidth:350,minHeight:100,padding:10,overflow:"hidden"}},(0,a.createElement)(r.Flex,{align:"start"},(0,a.createElement)("div",null,m?(0,a.createElement)("p",null,(0,d.__)("Getting IP info…","simple-history")):(0,a.createElement)(a.Fragment,null,v)),(0,a.createElement)(r.Button,{icon:He,onClick:()=>c(!1)})))):null)}function je(e){const{event:t,mapsApiKey:n,hasPremiumAddOn:r}=e,{ip_addresses:s}=t;if(!s)return null;const l=Object.keys(s).length;if(0===l)return null;const i=(0,d._n)("IP address:","IP addresses:",l,"simple-history"),o=[];let c=0;for(const[e,t]of Object.entries(s))o.push((0,a.createElement)(a.Fragment,null,(0,a.createElement)(Fe,{key:e,header:e,ipAddress:t,mapsApiKey:n,hasPremiumAddOn:r})," ",c<l-1?", ":"")),c++;return(0,a.createElement)(Ie,null,i," ",o)}function ze(e){const{event:t}=e,{via:n}=t;return n?(0,a.createElement)(Ie,null,n):null}function We(e){const{event:t,eventVariant:n,hasExtendedSettingsAddOn:r,hasPremiumAddOn:s}=e,{mapsApiKey:l}=e;return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__header"},(0,a.createElement)(Ae,{event:t,eventVariant:n}),(0,a.createElement)(Pe,{event:t,eventVariant:n}),(0,a.createElement)(je,{event:t,mapsApiKey:l,hasExtendedSettingsAddOn:r,hasPremiumAddOn:s}),(0,a.createElement)(ze,{event:t}))}function Be(e){const{event:t}=e,{initiator_data:n}=t;return(0,a.createElement)("img",{className:"SimpleHistoryLogitem__senderImage",src:n.user_avatar_url,alt:""})}function qe(e){const{event:t}=e,{initiator_data:n}=t;return(0,a.createElement)("img",{className:"SimpleHistoryLogitem__senderImage",src:n.user_avatar_url,alt:""})}function Ye(){return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__senderImage"})}function Re(e){const{event:t}=e,{initiator:n}=t;switch(n){case"wp_user":return(0,a.createElement)(Be,{event:t});case"web_user":return(0,a.createElement)(qe,{event:t});case"wp_cli":case"wp":case"other":return(0,a.createElement)(Ye,{event:t});default:return(0,a.createElement)("p",null,'Add image for initiator "',n,'"')}}function Qe(e){const{occasions:t,isLoadingOccasions:n,subsequent_occasions_count:r,occasionsCountMaxReturn:s}=e,l=Le({SimpleHistoryLogitems:!0,SimpleHistoryLogitem__occasionsItems:!0,haveOccasionsAdded:!1===n});return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__occasionsItemsWrap",style:{marginTop:"1rem",marginLeft:"-4.5rem",marginRight:"-1.5rem"}},(0,a.createElement)("ul",{className:l},t.map((e=>(0,a.createElement)(Ke,{key:e.id,event:e}))),r>s?(0,a.createElement)("li",{className:"SimpleHistoryLogitem SimpleHistoryLogitem--occasion SimpleHistoryLogitem--occasion-tooMany"},(0,a.createElement)("div",{className:"SimpleHistoryLogitem__firstcol"}),(0,a.createElement)("div",{className:"SimpleHistoryLogitem__secondcol"},(0,a.createElement)("div",{className:"SimpleHistoryLogitem__text"},(0,d.__)("Sorry, but there are too many similar events to show.","simple-history")))):null))}function Ve(e){const{event:t,hasExtendedSettingsAddOn:n}=e;return"SimpleUserLogger"!==t.logger||"user_login_failed"!==t.message_key&&"user_unknown_login_failed"!==t.message_key?null:(0,a.createElement)("div",{className:"SimpleHistoryLogitem__occasionsAddOns"},(0,a.createElement)("p",{className:"SimpleHistoryLogitem__occasionsAddOnsText"},n?(0,a.createElement)("a",{href:"options-general.php?page=simple_history_settings_menu_slug&selected-sub-tab=failed-login-attempts"},(0,d.__)("Configure failed login attempts","simple-history")):(0,a.createElement)(r.ExternalLink,{href:"https://simple-history.com/add-ons/premium/?utm_source=wpadmin#limit-number-of-failed-login-attempts"},(0,d.__)("Limit logged login attempts (Premium)","simple-history"))))}function Ge(e){const{event:t,eventVariant:n,hasExtendedSettingsAddOn:s}=e,{subsequent_occasions_count:l}=t,[o,m]=(0,i.useState)(!1),[g,h]=(0,i.useState)(!1),[p,y]=(0,i.useState)([]);if(1===l)return null;if("modal"===n)return null;const f=(0,a.createElement)(a.Fragment,null,(0,a.createElement)("div",{className:"SimpleHistoryLogitem__occasions"},(0,a.createElement)(r.Button,{variant:"link",onClick:e=>{(async()=>{m(!0);const e={type:"occasions",logRowID:t.id,occasionsID:t.occasions_id,occasionsCount:l-1,occasionsCountMaxReturn:15,per_page:5,_fields:["id","date_local","date_gmt","message","message_html","details_data","details_html","loglevel","occasions_id","subsequent_occasions_count","initiator","initiator_data","via"]},n=await c()({path:(0,u.addQueryArgs)("/simple-history/v1/events",e),parse:!1}),a=await n.json();y(a),m(!1),h(!0)})(),e.preventDefault()}},(0,d.sprintf)(/* translators: %s: number of similar events */ /* translators: %s: number of similar events */
(0,d._n)("+%1$s similar event","+%1$s similar events",l,"simple-history"),l)),(0,a.createElement)(Ve,{event:t,hasExtendedSettingsAddOn:s})));return(0,a.createElement)("div",null,g||o?null:f,o?(0,a.createElement)("span",null,(0,d.__)("Loading…","simple-history")):null,g?(0,a.createElement)(a.Fragment,null,(0,a.createElement)("span",null,(0,d.sprintf)(/* translators: %s: number of similar events */ /* translators: %s: number of similar events */
(0,d.__)("Showing %1$s more","simple-history"),l-1)),(0,a.createElement)(Qe,{isLoadingOccasions:o,isShowingOccasions:g,occasions:p,subsequent_occasions_count:l,occasionsCountMaxReturn:15})):null)}function Ue(e){const{event:t}=e,n=Le("SimpleHistoryLogitem--logleveltag",`SimpleHistoryLogitem--logleveltag-${t.loglevel}`);return(0,a.createElement)("div",{className:"SimpleHistoryLogitem__text"},(0,a.createElement)("span",{dangerouslySetInnerHTML:{__html:t.message_html}})," ",(0,a.createElement)("span",{className:n},t.loglevel))}function Ze({event:e}){const t=e.permalink,n=(0,d.__)("Copy link to event","simple-history"),s=(0,d.__)("Link copied to clipboard","simple-history"),[l,o]=(0,i.useState)(n),c=(0,m.useCopyToClipboard)(t,(()=>{o(s),setTimeout((()=>{o(n)}),2e3)}));return(0,a.createElement)(r.MenuItem,{icon:ke,iconPosition:"left",ref:c},l)}function $e({event:e,onClose:t}){return(0,a.createElement)(r.MenuItem,{icon:De,iconPosition:"left",onClick:()=>{me({event:e}),t()}},(0,d.__)("View event details","simple-history"))}function Xe(e){const{event:t}=e,n=e.eventVariant;return"modal"===n?null:(0,a.createElement)("div",{className:"SimpleHistoryLogitem__actions"},(0,a.createElement)(r.DropdownMenu,{label:(0,d.__)("Actions…","simple-history"),icon:he,popoverProps:{placement:"left-start",inline:!0}},(({onClose:e})=>(0,a.createElement)(a.Fragment,null,(0,a.createElement)(r.MenuGroup,null,(0,a.createElement)($e,{event:t,eventVariant:n,onClose:e}),(0,a.createElement)(Ze,{event:t}))))))}function Ke(e){const{event:t,variant:n="normal",mapsApiKey:r,hasExtendedSettingsAddOn:s,hasPremiumAddOn:l,isNewAfterFetchNewEvents:i}=e,o=Le("SimpleHistoryLogitem",`SimpleHistoryLogitem--variant-${n}`,`SimpleHistoryLogitem--loglevel-${t.loglevel}`,`SimpleHistoryLogitem--logger-${t.logger}`,`SimpleHistoryLogitem--initiator-${t.initiator}`,{"SimpleHistoryLogitem--newRowSinceReload":i});return(0,a.createElement)("li",{key:t.id,className:o},(0,a.createElement)("div",{className:"SimpleHistoryLogitem__firstcol"},(0,a.createElement)(Re,{event:t})),(0,a.createElement)("div",{className:"SimpleHistoryLogitem__secondcol"},(0,a.createElement)(We,{event:t,eventVariant:n,mapsApiKey:r,hasExtendedSettingsAddOn:s,hasPremiumAddOn:l}),(0,a.createElement)(Ue,{event:t,eventVariant:n}),(0,a.createElement)(Ce,{event:t,eventVariant:n}),(0,a.createElement)(Ge,{event:t,eventVariant:n,hasExtendedSettingsAddOn:s,hasPremiumAddOn:l}),(0,a.createElement)(Xe,{event:t,eventVariant:n})))}function Je(e){const{index:t}=e,n={backgroundColor:"var(--sh-color-gray-4)",width:ue(40,50)+"%",height:"1rem"},r={backgroundColor:"var(--sh-color-gray-4)",width:ue(55,75)+"%",height:"1.25rem"},s={backgroundColor:"var(--sh-color-gray-4)",width:ue(50,60)+"%",height:"3rem"};return(0,a.createElement)("li",{key:t,className:"SimpleHistoryLogitem SimpleHistoryLogitem--variant-normal SimpleHistoryLogitem--loglevel-debug SimpleHistoryLogitem--logger-WPHTTPRequestsLogger SimpleHistoryLogitem--initiator-wp_user"},(0,a.createElement)("div",{className:"SimpleHistoryLogitem__firstcol",style:{width:32,height:32,borderRadius:"50%",backgroundColor:"var(--sh-color-gray-4)"}}),(0,a.createElement)("div",{className:"SimpleHistoryLogitem__secondcol"},(0,a.createElement)("div",{className:"SimpleHistoryLogitem__header",style:n}),(0,a.createElement)("div",{className:"SimpleHistoryLogitem__text",style:r}),(0,a.createElement)("div",{className:"SimpleHistoryLogitem__details",style:s})))}function et(e){var t;const{eventsIsLoading:n,events:r,pagerSize:s}=e;if(!n||r.length>0)return null;const l=null!==(t=s.page)&&void 0!==t?t:0;return(0,a.createElement)("div",null,(0,a.createElement)("ul",{className:"SimpleHistoryLogitems"},Array.from({length:l}).map(((e,t)=>(0,a.createElement)(Je,{key:t,index:t})))))}const tt=(0,ge.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ge.jsx)(de.Path,{d:"M14.6 7l-1.2-1L8 12l5.4 6 1.2-1-4.6-5z"})}),nt=(0,ge.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ge.jsx)(de.Path,{d:"M10.6 6L9.4 7l4.6 5-4.6 5 1.2 1 5.4-6z"})}),at=(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#5f6368"},(0,a.createElement)("path",{d:"M250-250v-460h60v460h-60Zm430-3.85L453.85-480 680-706.15 722.15-664l-184 184 184 184L680-253.85Z"})),rt=(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#5f6368"},(0,a.createElement)("path",{d:"M280-253.85 237.85-296l184-184-184-184L280-706.15 506.15-480 280-253.85ZM650-250v-460h60v460h-60Z"}));function st(e){const{page:t,totalPages:n,setPage:s}=e;if(!t||!n)return null;const l=[{label:(0,d.__)("…","simple-history"),value:"custom"},...[...Array(n)].map(((e,t)=>({label:t+1,value:t+1})))];return(0,a.createElement)("div",null,(0,a.createElement)(r.__experimentalHStack,{spacing:4,justify:"center"},(0,a.createElement)(r.Button,{label:(0,d.__)("First page","simple-history"),size:"compact",onClick:()=>s(1),disabled:1===t,accessibleWhenDisabled:!0,icon:at}),(0,a.createElement)(r.Button,{label:(0,d.__)("Previous page","simple-history"),size:"compact",onClick:()=>s(t-1),disabled:1===t,accessibleWhenDisabled:!0,icon:tt}),(0,a.createElement)(r.__experimentalHStack,{justify:"flex-start",expanded:!1,spacing:2},(0,i.createInterpolateElement)((0,d.sprintf)(
// translators: %s: Total number of pages.
// translators: %s: Total number of pages.
(0,d._x)("Page <CurrentPageControl /> of %s","paging","simple-history"),n),{CurrentPageControl:(0,a.createElement)(r.SelectControl,{"aria-label":(0,d.__)("Current page","simple-history"),value:t,options:l,onChange:e=>{let t;t="custom"===e?prompt("Enter page number",1):e,t=parseInt(t,10),isNaN(t)||t<1?t=1:t>n&&(t=n),s(t)},size:"compact",__nextHasNoMarginBottom:!0})})),(0,a.createElement)(r.Button,{label:(0,d.__)("Next page","simple-history"),size:"compact",onClick:()=>s(t+1),disabled:t===n,accessibleWhenDisabled:!0,icon:nt}),(0,a.createElement)(r.Button,{label:(0,d.__)("Last page","simple-history"),size:"compact",onClick:()=>s(n),disabled:t===n,accessibleWhenDisabled:!0,icon:rt})))}function lt(e){const{eventsLoadingHasErrors:t,eventsLoadingErrorDetails:n}=e;if(!t)return null;const s=(0,u.addQueryArgs)("https://simple-history.com/support/load-events-error/",{utm_source:"wpadmin",utm_content:"fech-events-error-message",error:JSON.stringify(n)});return(0,a.createElement)("div",{style:{margin:"1rem"}},(0,a.createElement)(r.Notice,{status:"warning",isDismissible:!1},(0,a.createElement)(r.__experimentalText,{as:"p"},(0,d.__)("There was an error loading the events. Please try again later.","simple-history")),(0,a.createElement)("details",null,(0,a.createElement)("summary",{style:{marginTop:".5rem"}},(0,d.__)("View error details","simple-history")),(0,a.createElement)(r.__experimentalText,{as:"pre",style:{padding:"1rem"}},JSON.stringify(n,null,2)),(0,a.createElement)(r.__experimentalText,{as:"p"},(0,a.createElement)(r.ExternalLink,{href:s},"Search for error and solutions online.")),(0,a.createElement)(r.__experimentalText,{variant:"muted",as:"p"},"Error above will be sent to simple-history.com. Make sure it don't contain any personal or sensitive information."))))}function it(e){const{eventsIsLoading:t,events:n}=e;if(t)return null;if(n.length&&n.length>0)return null;const s=(0,a.createElement)("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 -960 960 960",width:"24px",fill:"#000000"},(0,a.createElement)("path",{d:"M280-80q-83 0-141.5-58.5T80-280q0-83 58.5-141.5T280-480q83 0 141.5 58.5T480-280q0 83-58.5 141.5T280-80Zm544-40L568-376q-12-13-25.5-26.5T516-428q38-24 61-64t23-88q0-75-52.5-127.5T420-760q-75 0-127.5 52.5T240-580q0 6 .5 11.5T242-557q-18 2-39.5 8T164-535q-2-11-3-22t-1-23q0-109 75.5-184.5T420-840q109 0 184.5 75.5T680-580q0 43-13.5 81.5T629-428l251 252-56 56Zm-615-61 71-71 70 71 29-28-71-71 71-71-28-28-71 71-71-71-28 28 71 71-71 71 28 28Z"})),l={fontSize:"1rem",fontWeight:"500",marginBlock:".25rem",color:"var(--sh-color-gray-2)"};return(0,a.createElement)("div",{style:{marginBlock:"2rem",display:"flex",flexDirection:"column",alignItems:"center"}},(0,a.createElement)(r.Icon,{icon:s,fill:"var(--sh-color-gray-2)",size:50,style:{marginBottom:"2rem"}}),(0,a.createElement)(r.__experimentalText,{as:"p",style:l},(0,d.__)("Your search did not match any history events.","simple-history")),(0,a.createElement)(r.__experimentalText,{as:"p",style:l},(0,d.__)("Try different search options or clear the search.","simple-history")))}function ot(e){const{events:t,page:n,pagerSize:s,setPage:l,eventsIsLoading:i,eventsMeta:o,prevEventsMaxId:c,mapsApiKey:m,hasExtendedSettingsAddOn:u,hasPremiumAddOn:d,eventsLoadingHasErrors:g,eventsLoadingErrorDetails:h}=e,p=o.totalPages;return(0,a.createElement)("div",{style:{backgroundColor:"white",minHeight:"300px",display:"flex",flexDirection:"column"}},(0,a.createElement)(et,{eventsIsLoading:i,pagerSize:s,events:t}),(0,a.createElement)(it,{eventsIsLoading:i,events:t}),(0,a.createElement)(lt,{eventsLoadingHasErrors:g,eventsLoadingErrorDetails:h}),(0,a.createElement)(ct,{eventsIsLoading:i,events:t,prevEventsMaxId:c,mapsApiKey:m,hasPremiumAddOn:d,hasExtendedSettingsAddOn:u}),(0,a.createElement)(r.__experimentalSpacer,{margin:4}),(0,a.createElement)(st,{page:n,totalPages:p,setPage:l}),(0,a.createElement)(r.__experimentalSpacer,{paddingBottom:4}))}function ct(e){const{events:t,prevEventsMaxId:n,mapsApiKey:r,hasExtendedSettingsAddOn:s,hasPremiumAddOn:l,eventsIsLoading:i}=e;if(!t||0===t.length)return null;const o=Le({SimpleHistoryLogitems:!0,"is-loading":i,"is-loaded":!i});return(0,a.createElement)("ul",{className:o},t.map((e=>(0,a.createElement)(Ke,{key:e.id,event:e,mapsApiKey:r,hasExtendedSettingsAddOn:s,hasPremiumAddOn:l,isNewAfterFetchNewEvents:e.id>n}))))}function mt(e){const{eventId:t,closeModal:n=null}=e,[s,l]=(0,i.useState)(null),[o,m]=(0,i.useState)(!0);return(0,i.useEffect)((()=>{(async()=>{m(!0);const e=await c()({path:(0,u.addQueryArgs)("/simple-history/v1/events/"+t,{_fields:["id","logger","occasions_id","subsequent_occasions_count","initiator_data","loglevel","message","message_html","message_key","details_data","details_html","message_uninterpolated","date_local","date_gmt","message","context","ip_addresses","details_data","via","initiator"]}),parse:!1}),n=await e.json();l(n),m(!1)})()}),[t]),(0,a.createElement)(r.Modal,{title:(0,d.__)("Event details","simple-history"),onRequestClose:n},(0,a.createElement)("div",{className:"SimpleHistory__modal"},o?(0,d.__)("Loading detailed events data…","simple-history"):(0,a.createElement)(a.Fragment,null,(0,a.createElement)(Ke,{event:s,variant:"modal"}),(0,a.createElement)("p",null,(0,a.createElement)(r.__experimentalText,null,(0,d.__)("This is potentially useful information and meta data that a logger has saved.","simple-history"))),(0,a.createElement)("h2",null,(0,d.__)("Event details","simple-history")),(0,a.createElement)("table",{className:"SimpleHistoryLogitem__moreDetailsContext"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,(0,d.__)("Key","simple-history")),(0,a.createElement)("th",null,(0,d.__)("Value","simple-history")))),(0,a.createElement)("tbody",null,(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"id"),(0,a.createElement)("td",null,s.id)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"logger"),(0,a.createElement)("td",null,s.logger)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"level"),(0,a.createElement)("td",null,s.loglevel)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"date_local"),(0,a.createElement)("td",null,s.date_local)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"date_gmt"),(0,a.createElement)("td",null,s.date_gmt)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"date_gmt"),(0,a.createElement)("td",null,s.date_gmt)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"message"),(0,a.createElement)("td",null,s.message)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"message_uninterpolated"),(0,a.createElement)("td",null,s.message_uninterpolated)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"initiator"),(0,a.createElement)("td",null,s.initiator)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"occasions_id"),(0,a.createElement)("td",null,s.occasions_id)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"subsequent_occasions_count"),(0,a.createElement)("td",null,s.subsequent_occasions_count)),(0,a.createElement)("tr",null,(0,a.createElement)("td",null,"via"),(0,a.createElement)("td",null,s.via)))),(0,a.createElement)("h2",null,(0,d.__)("Event context","simple-history")),(0,a.createElement)("table",{className:"SimpleHistoryLogitem__moreDetailsContext"},(0,a.createElement)("thead",null,(0,a.createElement)("tr",null,(0,a.createElement)("th",null,(0,d.__)("Key","simple-history")),(0,a.createElement)("th",null,(0,d.__)("Value","simple-history")))),(0,a.createElement)("tbody",null,Object.entries(s.context||{}).map((([e,t])=>(0,a.createElement)("tr",{key:e},(0,a.createElement)("td",null,e),(0,a.createElement)("td",null,t)))))))))}function ut(){const e=(()=>{const[e,t]=(0,i.useState)(window.location.hash),n=()=>{t(window.location.hash)};return(0,i.useEffect)((()=>(window.addEventListener("popstate",n),()=>{window.removeEventListener("popstate",n)})),[]),e})(),[t,n]=(0,i.useState)(!1),[r,s]=(0,i.useState)(null);(0,i.useEffect)((()=>{const t=e.match(/^#simple-history\/event\/(\d+)/);null!==t?(s(parseInt(t[1],10)),n(!0)):n(!1)}),[e]);return t?(0,a.createElement)(mt,{eventId:r,closeModal:()=>{n(!1),window.location.hash=""}}):null}function dt(e){const{dateOptions:t,selectedDateOption:n,setSelectedDateOption:s,searchText:l,setSearchText:o,selectedCustomDateFrom:c,setSelectedCustomDateFrom:m,selectedCustomDateTo:u,setSelectedCustomDateTo:g}=e,h=e=>e>new Date;return(0,i.useEffect)((()=>{c&&u&&c>u&&g(c)}),[c,u,g]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)("p",null,(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Dates","simple-history")),(0,a.createElement)("div",{style:{display:"inline-block",width:"310px"}},(0,a.createElement)(r.SelectControl,{options:t,value:n,onChange:e=>s(e)}))),"customRange"===n?(0,a.createElement)((function(){const e=(0,Ne.getSettings)().l10n.startOfWeek;return(0,a.createElement)(r.Flex,{justify:"start",gap:"15"},(0,a.createElement)(r.FlexItem,{style:{width:"95px"}}),(0,a.createElement)(r.FlexItem,null,(0,a.createElement)(r.BaseControl,{label:(0,d.__)("From date","simple-history")},(0,a.createElement)(r.DatePicker,{id:"simple-history-datepicker-from",startOfWeek:e,onChange:e=>{m(ee(k(e),le))},currentDate:c,isInvalidDate:h}))),(0,a.createElement)(r.FlexItem,null,(0,a.createElement)(r.BaseControl,{label:(0,d.__)("To date","simple-history")},(0,a.createElement)(r.DatePicker,{startOfWeek:e,onChange:e=>{g(ee(ne(e),le))},currentDate:u,isInvalidDate:h}))))}),null):null,(0,a.createElement)("p",null,(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Containing words","simple-history")),(0,a.createElement)("input",{type:"search",className:"SimpleHistoryFilterDropin-searchInput",value:l,onChange:e=>o(e.target.value)})))}function gt(e){const{messageTypesSuggestions:t,selectedLogLevels:n,setSelectedLogLevels:s,selectedMessageTypes:l,setSelectedMessageTypes:o,selectedUsersWithId:m,setSelectedUsersWithId:g}=e,[h,p]=(0,i.useState)([]),y=se.map((e=>e.label));return(0,a.createElement)("div",null,(0,a.createElement)(r.Flex,{align:"top",gap:"0",style:{margin:"0.5em 0"}},(0,a.createElement)(r.FlexItem,{style:{margin:".5em 0"}},(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Log levels","simple-history"))),(0,a.createElement)(r.FlexBlock,null,(0,a.createElement)("div",{className:"SimpleHistory__filters__loglevels__select",style:{width:"310px",backgroundColor:"white"}},(0,a.createElement)(r.FormTokenField,{__experimentalAutoSelectFirstMatch:!0,__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,placeholder:(0,d.__)("All log levels","simple-history"),onChange:e=>{s(e)},suggestions:y,value:n})))),(0,a.createElement)(r.Flex,{align:"top",gap:"0",style:{margin:"0.5em 0"}},(0,a.createElement)(r.FlexItem,{style:{margin:".5em 0"}},(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Message types","simple-history"))),(0,a.createElement)(r.FlexBlock,null,(0,a.createElement)("div",{className:"SimpleHistory__filters__loglevels__select",style:{width:"310px",backgroundColor:"white"}},(0,a.createElement)(r.FormTokenField,{__experimentalAutoSelectFirstMatch:!0,__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,label:"",placeholder:(0,d.__)("All message types","simple-history"),onChange:e=>{(e=>{e.map(((n,a)=>{if("string"==typeof n){const r=t.find((e=>e.value.trim()===n.trim()));r&&(e[a]=r)}return n})),o(e)})(e)},value:l.map((e=>(e.value=e.value.replace(ie,""),e))),suggestions:t.map((e=>e.value)),__experimentalRenderItem:e=>e.item.startsWith(ie)?e.item:(0,a.createElement)("strong",null,e.item)})))),(0,a.createElement)(r.Flex,{align:"top",gap:"0",style:{margin:"0.5em 0"}},(0,a.createElement)(r.FlexItem,{style:{margin:".5em 0"}},(0,a.createElement)("div",{className:"SimpleHistory__filters__filterLabel"},(0,d.__)("Users","simple-history"))),(0,a.createElement)(r.FlexBlock,null,(0,a.createElement)("div",{className:"SimpleHistory__filters__loglevels__select",style:{width:"310px",backgroundColor:"white"}},(0,a.createElement)(r.FormTokenField,{__experimentalAutoSelectFirstMatch:!0,__experimentalExpandOnFocus:!0,__experimentalShowHowTo:!1,label:"",placeholder:(0,d.__)("All users","simple-history"),onChange:e=>{(e=>{e.map(((t,n)=>{if("string"==typeof t){const a=h.find((e=>e.value===t));a&&(e[n]=a)}return t})),g(e)})(e)},onInputChange:e=>{(async e=>{e.length<2||c()({path:(0,u.addQueryArgs)("/simple-history/v1/search-user",{q:e})}).then((e=>{const t=[];e.forEach((e=>{t.push({id:e.id,value:e.display_name+" ("+e.user_email+")"})})),p(t)}))})(e)},suggestions:h.map((e=>e.value)),value:m})),(0,a.createElement)(r.BaseControl,{__nextHasNoMarginBottom:!0,help:(0,d.__)("Enter 2 or more characters to search for users.","simple-history")}))))}function ht(e){const{onReload:t,selectedLogLevels:n,setSelectedLogLevels:s,selectedMessageTypes:l,setSelectedMessageTypes:o,selectedDateOption:m,setSelectedDateOption:g,enteredSearchText:h,setEnteredSearchText:p,selectedCustomDateFrom:y,setSelectedCustomDateFrom:f,selectedCustomDateTo:_,setSelectedCustomDateTo:v,messageTypesSuggestions:E,setMessageTypesSuggestions:w,selectedUsersWithId:x,setSelectedUsersWithId:S,searchOptionsLoaded:b,setSearchOptionsLoaded:M,setPagerSize:T,setMapsApiKey:L,setHasExtendedSettingsAddOn:k,setHasPremiumAddOn:D,setIsExperimentalFeaturesEnabled:C,setEventsAdminPageURL:N}=e,[I,P]=(0,i.useState)(!1),[A,H]=(0,i.useState)(re);(0,i.useEffect)((()=>{c()({path:(0,u.addQueryArgs)("/simple-history/v1/search-options",{})}).then((e=>{const t=e.dates.result_months.map((e=>({label:(0,Ne.dateI18n)("F Y",e.yearMonth),value:`month:${e.yearMonth}`}))),n={label:(0,d.__)("All dates","simple-history"),value:"allDates"};H([...ae,...t,n]),g(`lastdays:${e.dates.daysToShow}`);const a=[];e.loggers.forEach((e=>{const t=e.search_data||{};t.search&&(a.push({value:t.search.label,search_options:t.search.options}),t?.search_all?.label&&a.push({value:ie+t.search_all.label,search_options:t.search_all.options}),t?.search_options&&t.search_options.forEach((e=>{a.push({value:ie+e.label,search_options:e.options})})))})),w(a),T(e.pager_size),L(e.maps_api_key),k(e.addons.has_extended_settings_add_on),D(e.addons.has_premium_add_on),C(e.experimental_features_enabled),N(e.events_admin_page_url),M(!0)}))}),[w,T,M,g,L,k,D,C,N]);const O=I?(0,d.__)("Collapse search options","simple-history"):(0,d.__)("Show search options","simple-history"),F=b?i.Fragment:r.Disabled;return(0,a.createElement)(F,null,(0,a.createElement)("div",{className:"SimpleHistory-filters"},(0,a.createElement)(dt,{dateOptions:A,selectedDateOption:m,setSelectedDateOption:g,searchText:h,setSearchText:p,selectedCustomDateFrom:y,setSelectedCustomDateFrom:f,selectedCustomDateTo:_,setSelectedCustomDateTo:v}),I?(0,a.createElement)(gt,{messageTypesSuggestions:E,setMessageTypesSuggestions:w,selectedLogLevels:n,setSelectedLogLevels:s,selectedMessageTypes:l,setSelectedMessageTypes:o,setSelectedUsersWithId:S,selectedUsersWithId:x}):null,(0,a.createElement)("p",{className:"SimpleHistory__filters__filterSubmitWrap"},(0,a.createElement)(r.Button,{variant:"secondary",onClick:t},(0,d.__)("Search events","simple-history")),(0,a.createElement)(r.Button,{variant:"tertiary",onClick:()=>P(!I),className:"SimpleHistoryFilterDropin-showMoreFilters SimpleHistoryFilterDropin-showMoreFilters--first js-SimpleHistoryFilterDropin-showMoreFilters"},O))))}const pt=(0,ge.jsx)(de.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,ge.jsx)(de.Path,{d:"m11.3 17.2-5-5c-.1-.1-.1-.3 0-.4l2.3-2.3-1.1-1-2.3 2.3c-.7.7-.7 1.8 0 2.5l5 5H7.5v1.5h5.3v-5.2h-1.5v2.6zm7.5-6.4-5-5h2.7V4.2h-5.2v5.2h1.5V6.8l5 5c.1.1.1.3 0 .4l-2.3 2.3 1.1 1.1 2.3-2.3c.6-.7.6-1.9-.1-2.5z"})});function yt(e){const{eventsQueryParams:t,eventsMaxId:n,onReload:s}=e,[l,o]=(0,i.useState)(0);(0,i.useEffect)((()=>{if(!t||!n)return;const e=setInterval((async()=>{const e={...t,since_id:n,_fields:null};try{const t=await c()({path:(0,u.addQueryArgs)("/simple-history/v1/events/has-updates",e),parse:!1}),n=(await t.json()).new_events_count;n>0&&o(n)}catch(e){console.error("Error when checking for new events:",e)}}),3e4);return()=>{clearInterval(e)}}),[t,n,l]);const m=(0,d.sprintf)(
// translators: %s: number of new events
// translators: %s: number of new events
(0,d._n)("%s new event","%s new events",l,"simple-history"),l);return(0,i.useEffect)((()=>{!function(e){let t=document.title;t=t.replace(/^\([\d!]+\) /,""),e&&(t="("+e+") "+t),document.title=t}(l)}),[l]),(0,a.createElement)("div",{className:Le({SimpleHistoryDropin__NewRowsNotifier:!0,"SimpleHistoryDropin__NewRowsNotifier--haveNewRows":l>0})},(0,a.createElement)(r.Button,{icon:pt,onClick:()=>{s(),o(0)},label:(0,d.__)("Click to load new events","simple-history"),showTooltip:!0,variant:"tertiary",style:{width:"100%",justifyContent:"center"}},m))}const ft=function(){const[e,t]=(0,i.useState)(!0),[n,r]=(0,i.useState)(!1),[s,l]=(0,i.useState)({errorCode:void 0,errorMessage:void 0}),[o,d]=(0,i.useState)([]),[g,h]=(0,i.useState)({}),[p,y]=(0,i.useState)(Date.now()),[f,_]=(0,i.useState)(),[v,E]=(0,i.useState)(),[w,x]=(0,i.useState)(!1),[S,b]=(0,i.useState)(1),[M,T]=(0,i.useState)({}),[L,k]=(0,i.useState)(""),[D,C]=(0,i.useState)(!1),[N,I]=(0,i.useState)(!1),[P,A]=(0,i.useState)(!1),[H,O]=(0,i.useState)(),[F,j]=(0,i.useState)(""),[z,W]=(0,i.useState)(oe),[B,q]=(0,i.useState)(ce),[Y,R]=(0,i.useState)(""),[Q,V]=(0,i.useState)([]),[G,U]=(0,i.useState)([]),[Z,$]=(0,i.useState)([]),[X,K]=(0,i.useState)([]),J=(0,i.useMemo)((()=>function(e){const{selectedLogLevels:t,selectedMessageTypes:n,selectedUsersWithId:a,enteredSearchText:r,selectedDateOption:s,selectedCustomDateFrom:l,selectedCustomDateTo:i,page:o,pagerSize:c}=e;let m=c.page;"dashboard"===window.pagenow&&(m=c.dashboard);const u={page:o,per_page:m,_fields:["id","logger","date_local","date_gmt","message","message_html","message_key","details_data","details_html","loglevel","occasions_id","subsequent_occasions_count","initiator","initiator_data","ip_addresses","via","permalink"]};if(r&&(u.search=r),s&&("customRange"===s?(u.date_from=l,u.date_to=i):u.dates=s),t.length){const e=[];t.forEach((t=>{const n=se.find((e=>e.label===t));n&&e.push(n.value)})),e.length&&(u.loglevels=e)}if(n.length){const e=[];n.forEach((t=>{t.search_options.forEach((t=>{e.push(t)}))})),u.messages=e.join(",")}if(a.length){const e=a.map((e=>e.id));u.users=e}return u}({selectedLogLevels:Q,selectedMessageTypes:Z,selectedUsersWithId:X,enteredSearchText:Y,selectedDateOption:F,selectedCustomDateFrom:z,selectedCustomDateTo:B,page:S,pagerSize:M})),[F,Y,Q,Z,X,z,B,S,M]);(0,i.useEffect)((()=>{b(1)}),[F,Y,Q,Z,z,B]);const ee=(0,i.useCallback)((async()=>{t(!0);try{const e=await c()({path:(0,u.addQueryArgs)("/simple-history/v1/events",J),parse:!1}),t=await e.json();h({total:parseInt(e.headers.get("X-Wp-Total"),10),totalPages:parseInt(e.headers.get("X-Wp-Totalpages"),10),link:e.headers.get("Link")}),t&&t.length&&1===S&&_(t[0].id),d(t)}catch(e){r(!0);const t={code:e.status,statusText:e.statusText,bodyJson:null,bodyText:null},n=e.headers.get("Content-Type");n&&n.includes("application/json")?t.bodyJson=await e.json():t.bodyText=await e.text(),l(t)}finally{t(!1)}}),[J,S]),te=(0,m.useDebounce)(ee,500);(0,i.useEffect)((()=>{w&&te()}),[te,w,p]);const ne=()=>{b(1),E(f),y(Date.now())};return(0,i.useEffect)((()=>{window.scrollTo({top:0,behavior:"smooth"})}),[S]),(0,a.createElement)(a.Fragment,null,(0,a.createElement)(ht,{selectedLogLevels:Q,setSelectedLogLevels:V,selectedMessageTypes:Z,setSelectedMessageTypes:$,selectedDateOption:F,setSelectedDateOption:j,enteredSearchText:Y,setEnteredSearchText:R,selectedCustomDateFrom:z,setSelectedCustomDateFrom:W,selectedCustomDateTo:B,setSelectedCustomDateTo:q,messageTypesSuggestions:G,setMessageTypesSuggestions:U,selectedUsersWithId:X,setSelectedUsersWithId:K,searchOptionsLoaded:w,setSearchOptionsLoaded:x,setPagerSize:T,setMapsApiKey:k,setHasExtendedSettingsAddOn:C,setHasPremiumAddOn:I,setIsExperimentalFeaturesEnabled:A,eventsAdminPageURL:H,setEventsAdminPageURL:O,setPage:b,onReload:ne}),(0,a.createElement)(Me,{isExperimentalFeaturesEnabled:P,eventsIsLoading:e,eventsTotal:g.total,eventsQueryParams:J}),(0,a.createElement)(yt,{eventsQueryParams:J,eventsMaxId:f,onReload:ne}),(0,a.createElement)(ot,{eventsIsLoading:e,events:o,eventsMeta:g,page:S,pagerSize:M,setPage:b,eventsMaxId:f,prevEventsMaxId:v,mapsApiKey:L,hasExtendedSettingsAddOn:D,hasPremiumAddOn:N,eventsLoadingHasErrors:n,eventsLoadingErrorDetails:s}),(0,a.createElement)(ut,null))},_t=(0,r.withFilters)("SimpleHistory.FilteredComponent")((e=>(0,a.createElement)(a.Fragment,null)));l()((()=>{const e=document.getElementById("simple-history-react-root");e&&i.createRoot&&(0,i.createRoot)(e).render((0,a.createElement)(r.SlotFillProvider,null,(0,a.createElement)(_t,null),(0,a.createElement)(ft,null)))}))})();