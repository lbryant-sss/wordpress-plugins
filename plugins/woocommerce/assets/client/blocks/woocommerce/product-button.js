import*as t from"@wordpress/interactivity";var e={962:(t,e,n)=>{n.r(e),n.d(e,{actions:()=>d,state:()=>c});var a=n(833);function o(t,e){return t.status.toString().startsWith("2")}function r(t){return Object.assign(new Error(t.message||"Unknown error."),{code:t.code||"unknown_error"})}let i=!1,s=3e3;const{state:c,actions:d}=(0,a.store)("woocommerce",{actions:{*addCartItem({id:t,quantity:e}){var n;let a=c.cart.items.findIndex((({id:e})=>t===e));const i=null!==(n=c.cart.items[a]?.quantity)&&void 0!==n?n:0;let s=null;const d={};-1!==a?(c.cart.items[a].quantity=e,s=c.cart.items[a].key||null,s&&(d.cartItemsPendingQuantity=[s])):(c.cart.items.push({id:t,quantity:e}),a=c.cart.items.length-1,d.productsPendingAdd=[t]);try{const t=yield fetch(`${c.restUrl}wc/store/v1/cart/items/${s||""}`,{method:s?"PUT":"POST",headers:{Nonce:c.nonce,"Content-Type":"application/json"},body:JSON.stringify(c.cart.items[a])}),e=yield t.json();if(!o(t))throw r(e);c.cart.items[a]=e,(({preserveCartData:t=!1})=>{((t,{bubbles:e=!1,cancelable:n=!1,element:a,detail:o={}})=>{if(!CustomEvent)return;a||(a=document.body);const r=new CustomEvent(t,{bubbles:e,cancelable:n,detail:o});a.dispatchEvent(r)})("wc-blocks_added_to_cart",{bubbles:!0,cancelable:!0,detail:{preserveCartData:t}})})({preserveCartData:!0}),function({quantityChanges:t}){window.dispatchEvent(new CustomEvent("wc-blocks_store_sync_required",{detail:{type:"from_iAPI",quantityChanges:t}}))}({quantityChanges:d})}catch(t){throw c.cart.items[a].quantity=i||0,t}},*refreshCartItems(){if(!i){i=!0;try{const t=yield fetch(`${c.restUrl}wc/store/v1/cart/items`,{headers:{"Content-Type":"application/json"}}),e=yield t.json();if(!o(t))throw r(e);c.cart.items=e,s=3e3}catch(t){setTimeout(d.refreshCartItems,s),s*=2}finally{i=!1}}}}},{lock:!0});window.addEventListener("wc-blocks_store_sync_required",(async t=>{"from_@wordpress/data"===t.detail.type&&d.refreshCartItems()}))},833:(e,n,a)=>{var o,r;e.exports=(o={getContext:()=>t.getContext,store:()=>t.store,useLayoutEffect:()=>t.useLayoutEffect},r={},a.d(r,o),r)}},n={};function a(t){var o=n[t];if(void 0!==o)return o.exports;var r=n[t]={exports:{}};return e[t](r,r.exports,a),r.exports}a.d=(t,e)=>{for(var n in e)a.o(e,n)&&!a.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},a.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),a.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t=a(833);const e=()=>(0,t.getContext)();var n=function(t){return t.IDLE="IDLE",t.SLIDE_OUT="SLIDE-OUT",t.SLIDE_IN="SLIDE-IN",t}(n||{});const{state:o}=(0,t.store)("woocommerce",{},{lock:"I acknowledge that using a private store means my plugin will inevitably break on the next store release."}),{state:r}=(0,t.store)("woocommerce/product-button",{state:{get quantity(){const{productId:t}=e(),n=o.cart.items.find((e=>e.id===t));return n?.quantity||0},get slideInAnimation(){const{animationStatus:t}=e();return t===n.SLIDE_IN},get slideOutAnimation(){const{animationStatus:t}=e();return t===n.SLIDE_OUT},get addToCartText(){const{animationStatus:t,tempQuantity:a,addToCartText:o}=e(),i=t===n.IDLE||t===n.SLIDE_OUT?a||0:r.quantity;return 0===i?o:r.inTheCartText.replace("###",i.toString())},get displayViewCart(){const{displayViewCart:t}=e();return!!t&&r.quantity>0}},actions:{*addCartItem(){const n=e(),{productId:o,quantityToAdd:i}=n,{actions:s}=yield Promise.resolve().then(a.bind(a,962));try{yield s.addCartItem({id:o,quantity:r.quantity+i})}catch(e){const n=e.message,{actions:a}=(0,t.store)("woocommerce/product-collection-notices",{},{lock:"I acknowledge that using a private store means my plugin will inevitably break on the next store release."});if("addNotice"in a){""!==r.noticeId&&a.removeNotice(r.noticeId);const t=a.addNotice({notice:n,type:"error",dismissible:!0});r.noticeId=t}console.error(e)}n.displayViewCart=!0},*refreshCartItems(){const{actions:t}=yield Promise.resolve().then(a.bind(a,962));t.refreshCartItems()},handleAnimationEnd(t){const a=e();"slideOut"===t.animationName?a.animationStatus=n.SLIDE_IN:"slideIn"===t.animationName&&(a.tempQuantity=r.quantity,a.animationStatus=n.IDLE)}},callbacks:{syncTempQuantityOnLoad(){const n=e();(0,t.useLayoutEffect)((()=>{n.tempQuantity=r.quantity}),[])},startAnimation(){const t=e();t.tempQuantity!==r.quantity&&t.animationStatus===n.IDLE&&(t.animationStatus=n.SLIDE_OUT)}}},{lock:!0})})();