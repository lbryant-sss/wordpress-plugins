"use strict";(globalThis.webpackChunk_wcAdmin_webpackJsonp=globalThis.webpackChunk_wcAdmin_webpackJsonp||[]).push([[6005],{12974:(e,t,o)=>{o.d(t,{Ay:()=>r});var s=o(13240);const n=["a","b","em","i","strong","p","br"],a=["target","href","rel","name","download"],r=e=>({__html:(0,s.sanitize)(e,{ALLOWED_TAGS:n,ALLOWED_ATTR:a})})},1275:(e,t,o)=>{o.d(t,{v:()=>l});var s=o(18537),n=o(56427),a=o(86087),r=o(12974),i=o(1069),c=o(39793);const l=({method:e,paymentMethodsState:t,setPaymentMethodsState:o,isExpanded:l,initialVisibilityStatus:d,...m})=>{var u,p,_,h;const g=(0,a.useRef)(null);void 0===d&&null===g.current&&void 0!==t[e.id]&&(g.current=(0,i.TO)(e,t[e.id]));const y=void 0!==d?null!=d&&d:null!==(u=g.current)&&void 0!==u&&u;return l||y?(0,c.jsx)("div",{id:e.id,className:"woocommerce-list__item woocommerce-list__item-enter-done",...m,children:(0,c.jsxs)("div",{className:"woocommerce-list__item-inner",children:["apple_google"!==e.id&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"woocommerce-list__item-before",children:(0,c.jsx)("img",{src:e.icon,alt:e.title+" logo"})}),(0,c.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,c.jsx)("span",{className:"woocommerce-list__item-title",children:e.title}),(0,c.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,r.Ay)((0,s.decodeEntities)(e.description))})]})]}),"apple_google"===e.id&&(0,c.jsxs)("div",{className:"woocommerce-list__item-multi",children:[(0,c.jsxs)("div",{className:"woocommerce-list__item-multi-row multi-row-space",children:[(0,c.jsx)("div",{className:"woocommerce-list__item-before",children:(0,c.jsx)("img",{src:e.icon,alt:e.title+" logo"})}),(0,c.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,c.jsx)("span",{className:"woocommerce-list__item-title",children:e.title}),(0,c.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,r.Ay)((0,s.decodeEntities)(e.description))})]})]}),(0,c.jsxs)("div",{className:"woocommerce-list__item-multi-row",children:[(0,c.jsx)("div",{className:"woocommerce-list__item-before",children:(0,c.jsx)("img",{src:e.extraIcon,alt:e.extraTitle+" logo"})}),(0,c.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,c.jsx)("span",{className:"woocommerce-list__item-title",children:e.extraTitle}),(0,c.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,r.Ay)((0,s.decodeEntities)(null!==(p=e.extraDescription)&&void 0!==p?p:""))})]})]})]}),(0,c.jsx)("div",{className:"woocommerce-list__item-after",children:(0,c.jsx)("div",{className:"woocommerce-list__item-after__actions wc-settings-prevent-change-event",children:(0,c.jsx)(n.ToggleControl,{checked:null!==(_=t[e.id])&&void 0!==_&&_,onChange:s=>{o({...t,[e.id]:s})},disabled:null!==(h=e.required)&&void 0!==h&&h,label:""})})})]})}):null}},7175:(e,t,o)=>{o.d(t,{A:()=>i});var s=o(56427),n=o(47804),a=o(56109),r=o(39793);function i({onClose:e}){return(0,r.jsxs)("div",{className:"settings-payments-onboarding-modal__header",children:[(0,r.jsx)("img",{src:`${a.GZ}images/woo-logo.svg`,alt:"Woo Logo",className:"settings-payments-onboarding-modal__header--logo"}),(0,r.jsx)(s.Button,{className:"settings-payments-onboarding-modal__header--close",onClick:e,children:(0,r.jsx)(s.Icon,{icon:n.A})})]})}},58016:(e,t,o)=>{o.d(t,{A:()=>p});var s=o(27723),n=o(33068),a=o(51609),r=o(87007),i=o(4921),c=o(56109),l=o(39793);function d({label:e,isCompleted:t,isActive:o}){return(0,l.jsxs)("div",{className:(0,i.A)("settings-payments-onboarding-modal__sidebar--list-item",{"is-active":o,"is-completed":t}),children:[(0,l.jsx)("span",{className:"settings-payments-onboarding-modal__sidebar--list-item-icon",children:t?(0,l.jsx)("img",{src:c.GZ+"images/onboarding/icons/complete.svg",alt:(0,s.__)("Step completed","woocommerce")}):(0,l.jsx)("img",{src:c.GZ+"images/onboarding/icons/pending.svg",alt:(0,s.__)("Step active","woocommerce")})}),(0,l.jsx)("span",{className:"settings-payments-onboarding-modal__sidebar--list-item-label",children:e})]})}function m({active:e,steps:t,justCompletedStepId:o,includeSidebar:n=!1,sidebarTitle:a}){const r=t.find((t=>t.id===e));if(!r)return null;const i=t.findIndex((t=>t.id===e))+1,c=e=>e.id===o||"completed"===e.status||i===t.length,m=t.sort(((e,t)=>{const o=c(e);return o===c(t)?0:o?-1:1}));return(0,l.jsxs)(l.Fragment,{children:[n&&(0,l.jsxs)("div",{className:"settings-payments-onboarding-modal__sidebar",children:[(0,l.jsxs)("div",{className:"settings-payments-onboarding-modal__sidebar--header",children:[(0,l.jsx)("h2",{className:"settings-payments-onboarding-modal__sidebar--header-title",children:a}),(0,l.jsx)("div",{className:"settings-payments-onboarding-modal__sidebar--header-steps",children:(0,s.sprintf)((0,s.__)("Step %1$s of %2$s","woocommerce"),i,t.length)})]}),(0,l.jsx)("div",{className:"settings-payments-onboarding-modal__sidebar--list",children:m.map((t=>(0,l.jsx)(d,{label:t.label,isCompleted:c(t),isActive:t.id===e},t.id)))})]}),(0,l.jsx)("div",{className:"settings-payments-onboarding-modal__content",children:(0,l.jsx)("div",{className:"settings-payments-onboarding-modal__step",id:r.id,children:r.content})})]})}var u=o(99096);function p({includeSidebar:e=!0}){const{steps:t,isLoading:o,currentStep:i,navigateToStep:c,justCompletedStepId:d}=(0,u.w)(),p=(0,n.zy)();return(0,a.useEffect)((()=>{var e;i&&!p.pathname.endsWith(null!==(e=i?.path)&&void 0!==e?e:"")&&c(i.id)}),[i,c,p.pathname]),o?(0,l.jsx)("div",{className:"settings-payments-onboarding-modal__loading",children:(0,l.jsx)(r.A,{})}):t&&t.length>0?(0,l.jsx)(n.BV,{children:(0,l.jsx)(n.qh,{path:"*",element:(0,l.jsx)("div",{className:"settings-payments-onboarding-modal__wrapper",children:(0,l.jsx)(m,{steps:t,active:null!==(_=i?.id)&&void 0!==_?_:"",justCompletedStepId:d,includeSidebar:e,sidebarTitle:(0,s.__)("Set up WooPayments","woocommerce")})})})}):null;var _}},87007:(e,t,o)=>{o.d(t,{A:()=>n}),o(51609);var s=o(39793);const n=()=>(0,s.jsx)("svg",{className:"stripe-spinner",width:"29",height:"29",viewBox:"0 0 29 29",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,s.jsx)("path",{d:"M14.3308 28.3333C14.0453 28.3333 13.7714 28.2199 13.5695 28.018C13.3675 27.816 13.2541 27.5422 13.2541 27.2566C13.2541 26.971 13.3675 26.6972 13.5695 26.4952C13.7714 26.2933 14.0453 26.1799 14.3308 26.1799C17.4727 26.1799 20.4859 24.9317 22.7076 22.7101C24.9293 20.4884 26.1774 17.4752 26.1774 14.3333C26.1774 11.1914 24.9293 8.17821 22.7076 5.95655C20.4859 3.73489 17.4727 2.48677 14.3308 2.48677C12.5754 2.48495 10.8416 2.87419 9.25541 3.62623C7.66923 4.37826 6.27049 5.4742 5.16082 6.83441C5.07124 6.94388 4.96097 7.03464 4.83631 7.1015C4.71165 7.16836 4.57504 7.21001 4.43428 7.22407C4.15001 7.25248 3.8661 7.16679 3.645 6.98587C3.42391 6.80494 3.28374 6.54359 3.25534 6.25932C3.22694 5.97505 3.31262 5.69114 3.49355 5.47005C4.80533 3.86303 6.45849 2.56827 8.33301 1.67977C10.2075 0.791267 12.2564 0.331321 14.3308 0.333319C22.0626 0.333319 28.3308 6.6015 28.3308 14.3333C28.3308 22.0651 22.0626 28.3333 14.3308 28.3333Z",fill:"#4F575D"})})},99096:(e,t,o)=>{o.d(t,{X:()=>m,w:()=>d});var s=o(86087),n=o(47143),a=o(40314),r=o(96476),i=o(39793);const c={buildStepURL:e=>(0,r.getNewPath)({path:e},e,{page:"wc-settings",tab:"checkout"})},l=(0,s.createContext)({steps:[],isLoading:!0,currentStep:void 0,context:{},navigateToStep:()=>{},navigateToNextStep:()=>{},getStepByKey:()=>{},refreshStoreData:()=>{},closeModal:()=>{},justCompletedStepId:null,setJustCompletedStepId:()=>{}}),d=()=>(0,s.useContext)(l),m=({children:e,onboardingSteps:t,closeModal:o,onFinish:d,urlStrategy:m,source:u})=>{const p=(0,r.getHistory)(),[_,h]=(0,s.useState)([]),[g,y]=(0,s.useState)(!0),[w,x]=(0,s.useState)([]),[v,b]=(0,s.useState)(null),f=(0,s.useCallback)((e=>{b(e)}),[]),{invalidateResolutionForStoreSelector:j}=(0,n.useDispatch)(a.woopaymentsOnboardingStore),{invalidateResolutionForStoreSelector:S}=(0,n.useDispatch)(a.paymentSettingsStore),{storeData:k,isStoreLoading:C}=(0,n.useSelect)((e=>({storeData:e(a.woopaymentsOnboardingStore).getOnboardingData(u),isStoreLoading:e(a.woopaymentsOnboardingStore).isOnboardingDataRequestPending()})),[u]),N=(0,s.useCallback)((e=>w.find((t=>t.id===e))),[w]),F=(0,s.useCallback)(((e,t)=>!e.dependencies||0===e.dependencies.length||e.dependencies.every((e=>{const o=t.find((t=>t.id===e));return"completed"===o?.status}))),[]),T=(0,s.useCallback)((e=>{const t=N(e);if(t?.path){const e=m||c,o=e.preserveParams?(0,r.getQuery)():{},s=e.preserveParams?.reduce(((e,t)=>(o[t]&&(e[t]=o[t]),e)),{})||{},n=e.buildStepURL(t.path,s);p.push(n)}}),[N,p,m]),A=w.find((e=>"completed"!==e.status&&F(e,w))),P=(0,s.useCallback)((()=>{const e=w.findIndex((e=>e.id===A?.id));if(-1!==e){if("completed"!==A?.status&&x(w.map((e=>e.id===A?.id?{...e,status:"completed"}:e))),e===w.length-1)return void d?.();const t=w.find((e=>"completed"!==e.status&&F(e,w)));t&&T(t.id)}}),[A,w,T,F]),B=()=>{h([]),y(!0),f(null),x([]),j("getOnboardingData")};return(0,s.useEffect)((()=>{!C&&k.steps.length>0&&(h(k.steps),y(!1))}),[k,C]),(0,s.useEffect)((()=>{const e=t.filter((e=>"backend"!==e.type||-1!==_.findIndex((t=>t.id===e.id)))).map((e=>{if("backend"===e.type){const t=_.find((t=>t.id===e.id));return Object.assign({},e,{status:t?.status||"not_started",dependencies:t?.dependencies||[],path:t?.path,context:t?.context,actions:t?.actions,errors:t?.errors})}return Object.assign({},e)})),o=e.map((t=>"frontend"===t.type?{...t,status:F(t,e)?"completed":"not_started"}:t));x(o)}),[_,F]),(0,s.useEffect)((()=>{B()}),[]),(0,i.jsx)(l.Provider,{value:{steps:w,context:k.context,isLoading:g,currentStep:A,navigateToStep:T,navigateToNextStep:P,getStepByKey:N,refreshStoreData:B,closeModal:()=>{o(),S("getPaymentProviders")},justCompletedStepId:v,setJustCompletedStepId:f},children:e})}},98404:(e,t,o)=>{o.d(t,{A:()=>ae});var s=o(51609),n=o.n(s),a=o(99096),r=o(7175),i=o(66087),c=o(39793);const l=(e={})=>{const[t,o]=(0,s.useState)(e),[n,a]=(0,s.useState)({}),[r,c]=(0,s.useState)({});return{data:t,setData:e=>o((t=>({...t,...e}))),errors:n,setErrors:e=>a((t=>(0,i.omitBy)({...t,...e},i.isNil))),touched:r,setTouched:e=>c((t=>({...t,...e})))}},d=(0,s.createContext)(null),m=({children:e,initialData:t})=>(0,c.jsx)(d.Provider,{value:l(t),children:e}),u=()=>{const e=(0,s.useContext)(d);if(!e)throw new Error("useBusinessVerificationContext() must be used within <BusinessVerificationContextProvider>");return e};var p=o(56427);const _=(0,s.createContext)(null),h=({children:e,...t})=>{const o=(e=>e.reduce(((e,t,o)=>{var s;return n().isValidElement(t)&&(e[null!==(s=t.props.name)&&void 0!==s?s:o]=t),e}),{}))(e),r=(({steps:e,initialStep:t,onStepChange:o,onComplete:n,onExit:r})=>{const i=Object.keys(e),{currentStep:c}=(0,a.w)(),[l,d]=(0,s.useState)(null!=t?t:i[0]);if("completed"===c?.context?.sub_steps[l]?.status){const e=i.indexOf(l),t=i[e+1];d(t)}const m=(i.indexOf(l)+1)/i.length;return{currentStep:l,progress:m,nextStep:()=>{const e=i.indexOf(l),t=i[e+1];t?(d(t),o?.(t)):n?.()},prevStep:()=>{const e=i.indexOf(l),t=i[e-1];t?(d(t),o?.(t)):r?.()},exit:()=>r?.()}})({steps:o,...t}),i=o[r.currentStep];return(0,c.jsx)(_.Provider,{value:r,children:i})},g=()=>{const e=(0,s.useContext)(_);if(!e)throw new Error("useStepperContext() must be used within <Stepper>");return e};var y=o(4921),w=o(24148),x=o(90700),v=o(72744),b=o(86087),f=o(27723),j=o(21913);const S=e=>e?.name||"",k=({selectedItem:e},{type:t,changes:o,props:{items:s}})=>{switch(t){case j.WM.stateChangeTypes.ToggleButtonKeyDownArrowDown:return{selectedItem:s[e?Math.min(s.indexOf(e)+1,s.length-1):0]};case j.WM.stateChangeTypes.ToggleButtonKeyDownArrowUp:return{selectedItem:s[e?Math.max(s.indexOf(e)-1,0):s.length-1]};default:return o}},C=function({name:e,className:t,label:o,describedBy:s,options:n,onChange:a,value:r,placeholder:i,children:l}){const{getLabelProps:d,getToggleButtonProps:m,getMenuProps:u,getItemProps:_,isOpen:h,highlightedIndex:g,selectedItem:C}=(0,j.WM)({initialSelectedItem:n[0],items:n,itemToString:S,onSelectedItemChange:a,selectedItem:r||{},stateReducer:k}),N=S(C),F=u({className:"components-custom-select-control__menu","aria-hidden":!h}),T=(0,b.useCallback)((e=>{e.stopPropagation(),F?.onKeyDown?.(e)}),[F]);return F["aria-activedescendant"]?.startsWith("downshift-null")&&delete F["aria-activedescendant"],(0,c.jsxs)("div",{className:(0,y.A)("woopayments components-custom-select-control",t),children:[(0,c.jsx)("label",{...d({className:"components-custom-select-control__label"}),children:o}),(0,c.jsxs)(p.Button,{...m({"aria-label":o,"aria-labelledby":void 0,"aria-describedby":s||(N?(0,f.sprintf)((0,f.__)("Currently selected: %s","woocommerce"),N):(0,f.__)("No selection","woocommerce")),className:(0,y.A)("components-custom-select-control__button",{placeholder:!N}),name:e}),children:[(0,c.jsx)("span",{className:"components-custom-select-control__button-value",children:N||i}),(0,c.jsx)(w.A,{icon:x.A,className:"components-custom-select-control__button-icon"})]}),(0,c.jsx)("ul",{...F,onKeyDown:T,children:h&&n.map(((e,t)=>(0,c.jsxs)("li",{..._({item:e,index:t,className:(0,y.A)(e.className,"components-custom-select-control__item",{"is-highlighted":t===g}),style:e.style}),children:[l?l(e):e.name,e===C&&(0,c.jsx)(w.A,{icon:v.A,className:"components-custom-select-control__item-icon"})]},e.key)))})]})};var N=o(56537);const F=({name:e,className:t,label:o,options:n,onChange:a,value:r,placeholder:i,searchable:l})=>{const d=(0,s.useRef)(null),m=(0,s.useRef)(),u=n.filter((e=>e.items?.length)).map((e=>e.key)),[p,_]=(0,s.useState)(new Set([u[0]])),[h,g]=(0,s.useState)(new Set([...u,...n[0]?.items||[]])),[b,S]=(0,s.useState)(""),k=n.filter((e=>h.has(e.key))),{isOpen:C,selectedItem:F,getToggleButtonProps:T,getMenuProps:A,getLabelProps:P,highlightedIndex:B,getItemProps:E}=(0,j.WM)({items:k,itemToString:e=>e?.name||"",selectedItem:r||{},onSelectedItemChange:a,stateReducer:(e,{changes:t,type:o})=>{if(l&&o===j.WM.stateChangeTypes.ToggleButtonKeyDownArrowDown)return e;if(t.selectedItem&&t.selectedItem.items){if(b)return e;const o=t.selectedItem.key;return p.has(o)?(p.delete(o),t.selectedItem.items.forEach((e=>h.delete(e)))):(p.add(o),t.selectedItem.items.forEach((e=>h.add(e)))),_(p),g(h),e}return t}}),I=A({className:"components-grouped-select-control__list","aria-hidden":!C,onFocus:()=>d.current?.focus(),onBlur:e=>{e.relatedTarget===d.current&&(e.nativeEvent.preventDownshiftDefault=!0)},onKeyDown:e=>{"Space"===e.code&&(e.nativeEvent.preventDownshiftDefault=!0)}});return(0,c.jsxs)("div",{className:(0,y.A)("woopayments components-grouped-select-control",t),children:[(0,c.jsx)("label",{...P({className:"components-grouped-select-control__label"}),children:o}),(0,c.jsxs)("button",{...T({type:"button",className:(0,y.A)("components-text-control__input components-grouped-select-control__button",{placeholder:!F?.name}),name:e}),children:[(0,c.jsx)("span",{className:"components-grouped-select-control__button-value",children:F?.name||i}),(0,c.jsx)(w.A,{icon:x.A,className:"components-grouped-select-control__button-icon"})]}),(0,c.jsx)("ul",{...I,children:C&&(0,c.jsxs)(c.Fragment,{children:[l&&(0,c.jsx)("input",{className:"components-grouped-select-control__search",ref:d,type:"text",value:b,onChange:({target:e})=>{if(m.current||(m.current={visibleItems:h}),""===e.value)g(m.current.visibleItems),m.current=void 0;else{const t=n.filter((t=>t?.group&&`${t.name} ${t.context||""}`.toLowerCase().includes(e.value.toLowerCase()))),o=t.map((e=>e?.group||"")),s=new Set([...t.map((e=>e.key)),...o]);g(s)}S(e.value)},tabIndex:-1,placeholder:(0,f.__)("Search…","woocommerce")}),(0,c.jsx)("div",{className:"components-grouped-select-control__list-container",children:k.map(((e,t)=>{const o=!!e.items;return(0,c.jsxs)("li",{...E({item:e,index:t,className:(0,y.A)("components-grouped-select-control__item",e.className,{"is-highlighted":t===B},{"is-group":o})}),children:[(0,c.jsx)("div",{className:"components-grouped-select-control__item-content",children:e.name}),e.key===F?.key&&(0,c.jsx)(w.A,{icon:v.A}),!b&&o&&(0,c.jsx)(w.A,{icon:p.has(e.key)?N.A:x.A})]},e.key)}))})]})})]})},T=(e,t,o)=>{const{error:s,...n}=t;return s?(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e,{...n,ref:o,className:(0,y.A)(n.className,"has-error")}),(0,c.jsx)("div",{className:"components-form-field__error",children:s})]}):(0,c.jsx)(e,{...n,ref:o})},A=((0,s.forwardRef)(((e,t)=>T(p.TextControl,e,t))),e=>T(C,e)),P=e=>T(F,e),B={generic:{individual:(0,f.__)("Select if you run your own business as an individual and are self-employed","woocommerce"),company:(0,f.__)("Select if you filed documentation to register your business with a government agency","woocommerce"),non_profit:(0,f.__)("Select if you run a non-business entity","woocommerce"),government_entity:(0,f.__)("Select if your business is classed as a government entity","woocommerce")},US:{individual:(0,f.__)("Select if you run your own business as an individual and are self-employed","woocommerce"),company:(0,f.__)("Select if you filed documentation to register your business with a government agency","woocommerce"),non_profit:(0,f.__)("Select if you have been granted tax-exempt status by the Internal Revenue Service (IRS)","woocommerce"),government_entity:(0,f.__)("Select if your business is classed as a government entity","woocommerce")}},E=e=>{const t=window.wcSettings.admin?.onboarding?.profile?.industry?.[0];if(t)return e[t]},I=()=>{const{woocommerce_share_key:e,woocommerce_coming_soon:t,woocommerce_private_link:o}=window.wcSettings?.admin?.siteVisibilitySettings||{};return"yes"!==t||"no"===o?"":e?"?woo-share="+e:""};var D=o(1455),L=o.n(D);var W=o(36849);const O={steps:{activate:{heading:(0,f.__)("Start accepting real payments","woocommerce"),subheading:(0,W.A)({mixedString:(0,f.__)("You are currently testing payments on your store. To activate real payments, you will need to provide some additional details about your business. {{link}}Learn more{{/link}}.","woocommerce"),components:{link:(0,c.jsx)("a",{rel:"external noopener noreferrer",target:"_blank",href:"https://woocommerce.com/document/woopayments/startup-guide/#sign-up-process"})}}),cta:(0,f.__)("Activate payments","woocommerce")},business:{heading:(0,f.__)("Let’s get your store ready to accept payments","woocommerce"),subheading:(0,f.__)("We’ll use these details to enable payments for your store. This information can’t be changed after your account is created.","woocommerce")},store:{heading:(0,f.__)("Please share a few more details","woocommerce"),subheading:(0,f.__)("This info will help us speed up the set up process.","woocommerce")},loading:{heading:(0,f.__)("One last step! Verify your identity with our partner","woocommerce"),subheading:(0,f.__)("This will take place in a secure environment through our partner. Once your business details are verified, you’ll be redirected back to your store dashboard.","woocommerce"),cta:(0,f.__)("Finish your verification process","woocommerce")},embedded:{heading:(0,f.__)("One last step! Verify your identity with our partner","woocommerce"),subheading:(0,f.__)("This info will verify your account","woocommerce")}},fields:{country:(0,f.__)("Where is your business located?","woocommerce"),business_type:(0,f.__)("What type of legal entity is your business?","woocommerce"),"company.structure":(0,f.__)("What category of legal entity identify your business?","woocommerce"),mcc:(0,f.__)("What type of goods or services does your business sell? ","woocommerce")},errors:{generic:(0,f.__)("Please provide a response","woocommerce"),country:(0,f.__)("Please provide a country","woocommerce"),business_type:(0,f.__)("Please provide a business type","woocommerce"),mcc:(0,f.__)("Please provide a type of goods or services","woocommerce")},placeholders:{generic:(0,f.__)("Select an option","woocommerce"),country:(0,f.__)("Select a country","woocommerce")},tos:(0,W.A)({mixedString:(0,f.sprintf)((0,f.__)("By using %1$s, you agree to be bound by our {{tosLink}}Terms of Service{{/tosLink}} (including {{merchantTermsLink}}%2$s merchant terms{{/merchantTermsLink}}) and acknowledge that you have read our {{privacyPolicyLink}}Privacy Policy{{/privacyPolicyLink}}.","woocommerce"),"WooPayments","WooPay"),components:{tosLink:(0,c.jsx)("a",{rel:"external noopener noreferrer",target:"_blank",href:"https://wordpress.com/tos/"}),merchantTermsLink:(0,c.jsx)("a",{rel:"external noopener noreferrer",target:"_blank",href:"https://wordpress.com/tos/#more-woopay-specifically"}),privacyPolicyLink:(0,c.jsx)("a",{rel:"external noopener noreferrer",target:"_blank",href:"https://automattic.com/privacy/"})}}),continue:(0,f.__)("Continue","woocommerce"),back:(0,f.__)("Back","woocommerce"),cancel:(0,f.__)("Cancel","woocommerce")},M=e=>{const{data:t,errors:o,setErrors:n,touched:a,setTouched:r}=u(),i=(o=t[e])=>{a[e]||r({[e]:!0});const s=((e,t)=>!!t)(0,o)?void 0:O.errors[e]||O.errors.generic;n({[e]:s})};return(0,s.useEffect)((()=>(i(),t[e]||r({[e]:!1}),()=>n({[e]:void 0}))),[]),{validate:i,error:()=>a[e]?o[e]:void 0}};var R=o(1069);const z=({children:e})=>{const{data:t,errors:o,touched:s,setTouched:n}=u(),{currentStep:r}=(0,a.w)(),{nextStep:l}=g();return(0,c.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{var e,a;if((0,i.isEmpty)(o)&&(e=>["business_type","country","mcc"].every((t=>Boolean(e[t]))))(t))return(0,R.W7)("woopayments_onboarding_modal_kyc_sub_step_completed",{sub_step_id:"business",country:t.country||"unknown",business_type:t.business_type||"unknown",mcc:t.mcc||"unknown"}),((e,t,o)=>{t&&L()({url:t,method:"POST",data:{sub_steps:{...o,[e]:{status:"completed"}}}})})("business",null!==(e=r?.actions?.save?.href)&&void 0!==e?e:void 0,null!==(a=r?.context?.sub_steps)&&void 0!==a?a:{}),l();n((0,i.mapValues)(s,(()=>!0)))})()},children:[e,(0,c.jsx)(p.Button,{variant:"primary",type:"submit",className:"stepper__cta",onClick:()=>{var e;(0,R.W7)("woopayments_onboarding_modal_click",{step_id:null!==(e=r?.id)&&void 0!==e?e:"unknown",sub_step_id:"business",action:"business_form_continue"})},children:O.continue})]})},q=({onChange:e,...t})=>{var o;const{name:s}=t,{data:n,setData:a}=u(),{validate:r,error:i}=M(s);return(0,c.jsx)(A,{label:O.fields[s],value:t.options?.find((e=>e.key===n[s])),placeholder:null!==(o=O.placeholders[s])&&void 0!==o?o:O.placeholders.generic,onChange:({selectedItem:t})=>{e?e?.(s,t):a({[s]:t?.key}),r(t?.key)},options:[],error:i(),...t})},H=({onChange:e,...t})=>{var o;const{name:s}=t,{data:n,setData:a}=u(),{validate:r,error:i}=M(s);return(0,c.jsx)(P,{label:O.fields[s],value:t.options?.find((e=>e.key===n[s])),placeholder:null!==(o=O.placeholders[s])&&void 0!==o?o:O.placeholders.generic,onChange:({selectedItem:t})=>{e?e?.(s,t):a({[s]:t?.key}),r(t?.key)},options:[],error:i(),...t})},U=()=>{var e;const{data:t,setData:o}=u(),{currentStep:s}=(0,a.w)(),n=(e=>Object.entries(e||[]).map((([e,t])=>({key:e,name:t,types:[]}))).sort(((e,t)=>e.name.localeCompare(t.name))))(s?.context?.fields?.available_countries||{}),r=(e=>(e||[]).map((e=>({...e,types:e.types.map((t=>({...t,description:B[e.key]?B[e.key][t.key]:B.generic[t.key]})))}))).sort(((e,t)=>e.name.localeCompare(t.name)))||[])(s?.context?.fields?.business_types||[]),i=((null!==(e=s?.context?.fields?.mccs_display_tree)&&void 0!==e?e:[])||[]).filter((e=>!!e?.items&&(e.items?.filter((e=>!e?.items))||[]).length)).reduce(((e,t)=>{const o=t.items?.map((e=>({key:e.id,name:e.title,group:t.id,context:e?.keywords?e.keywords.join(" "):""})))||[];return[...e,{key:t.id,name:t.title,items:o.map((e=>e.key))},...o]}),[]),l=r.find((e=>"PR"===t.country?"US"===e.key:e.key===t.country)),d=l?.types.sort(((e,t)=>"company"===e.key?-1:"company"===t.key?1:0)),m=d?.find((e=>e.key===t.business_type)),p=0===m?.structures.length||m?.structures.find((e=>e.key===t["company.structure"])),_=e=>{const t=s?.actions?.save?.href;t&&L()({url:t,method:"POST",data:{self_assessment:e}})},h=(e,t)=>{let s={[e]:t?.key};"business_type"===e?s={...s,"company.structure":void 0}:"country"===e&&(s={...s,business_type:void 0}),o(s),_(s)};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{"data-testid":"country-select",children:(0,c.jsx)(q,{name:"country",options:n,onChange:h})}),l&&l.types.length>0&&(0,c.jsx)("span",{"data-testid":"business-type-select",children:(0,c.jsx)(q,{name:"business_type",options:l.types,onChange:h,children:e=>(0,c.jsxs)("div",{children:[(0,c.jsx)("div",{children:e.name}),(0,c.jsx)("div",{className:"complete-business-info-task__option-description",children:e.description})]})})}),m&&m.structures.length>0&&(0,c.jsx)("span",{"data-testid":"business-structure-select",children:(0,c.jsx)(q,{name:"company.structure",options:m.structures,onChange:h})}),l&&m&&p&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("span",{"data-testid":"mcc-select",children:(0,c.jsx)(H,{name:"mcc",options:i,onChange:(e,s)=>{o({[e]:s?.key});const n={...t,[e]:s?.key};_(n)},searchable:!0})}),(0,c.jsx)("span",{className:"woopayments-onboarding__tos",children:O.tos})]})]})};var K=o(87007),V=o(20195),G=o(73290),$=o(94736),Z=o(92991),Y=o(8181);v.A,Z.A,$.A,G.A;const J=({children:e,actions:t=[],className:o,status:s="info",isDismissible:n=!0,onRemove:a})=>{((e,t)=>{const o="string"==typeof t?t:(0,b.renderToString)(t),s="error"===e?"assertive":"polite";(0,b.useEffect)((()=>{o&&(0,V.speak)(o,s)}),[o,s])})(s,e);const r=(0,y.A)(o,"woopayments-banner-notice","is-"+s);return(0,c.jsxs)("div",{className:r,children:[(0,c.jsxs)("div",{className:"woopayments-banner-notice__content",children:[e,t.length>0&&(0,c.jsx)("div",{className:"woopayments-banner-notice__actions",children:t.map((({className:e,label:t,variant:o,onClick:s,url:n,urlTarget:a},r)=>{let i=o;return"primary"!==o&&(i=n?"link":"secondary"),(0,c.jsx)(p.Button,{href:n,variant:i,onClick:n?void 0:s,className:e,target:a,children:t},r)}))})]}),n&&(0,c.jsx)(p.Button,{className:"woopayments-banner-notice__dismiss",icon:(0,c.jsx)(Y.A,{}),label:(0,f.__)("Dismiss this notice","woocommerce"),onClick:()=>a?.(),showTooltip:!1})]})};var X=o(2929),Q=o(86948);const ee={variables:{colorPrimary:"#873EFF",colorBackground:"#FFFFFF",buttonPrimaryColorBackground:"#3858E9",buttonPrimaryColorBorder:"#3858E9",buttonPrimaryColorText:"#FFFFFF",buttonSecondaryColorBackground:"#FFFFFF",buttonSecondaryColorBorder:"#3858E9",buttonSecondaryColorText:"#3858E9",colorText:"#101517",colorSecondaryText:"#50575E",actionPrimaryColorText:"#3858E9",actionSecondaryColorText:"#101517",colorBorder:"#DDDDDD",formHighlightColorBorder:"#3858E9",formAccentColor:"#3858E9",colorDanger:"#CC1818",offsetBackgroundColor:"#F0F0F0",formBackgroundColor:"#FFFFFF",badgeNeutralColorText:"#2C3338",badgeNeutralColorBackground:"#F6F7F7",badgeNeutralColorBorder:"#F6F7F7",badgeSuccessColorText:"#005C12",badgeSuccessColorBackground:"#EDFAEF",badgeSuccessColorBorder:"#EDFAEF",badgeWarningColorText:"#614200",badgeWarningColorBackground:"#FCF9E8",badgeWarningColorBorder:"#FCF9E8",badgeDangerColorText:"#8A2424",badgeDangerColorBackground:"#FCF0F1",badgeDangerColorBorder:"#FCF0F1",borderRadius:"2px",buttonBorderRadius:"2px",formBorderRadius:"2px",badgeBorderRadius:"2px",overlayBorderRadius:"8px",spacingUnit:"10px",fontFamily:"-apple-system, BlinkMacSystemFont, 'system-ui', 'Segoe UI', 'Helvetica Neue', 'Helvetica', 'Roboto', 'Arial', sans-serif",fontSizeBase:"16px",headingXlFontSize:"32px",headingXlFontWeight:"400",headingLgFontSize:"24px",headingLgFontWeight:"400",headingMdFontSize:"20px",headingMdFontWeight:"400",headingSmFontSize:"13px",headingSmFontWeight:"600",headingXsFontSize:"12px",headingXsFontWeight:"600",bodyMdFontWeight:"400",bodyMdFontSize:"16px",bodySmFontSize:"13px",bodySmFontWeight:"400",labelSmFontSize:"12px",labelSmFontWeight:"200",labelMdFontSize:"13px"}},te=({onboardingData:e,onExit:t,onLoaderStart:o,onLoadError:n,onStepChange:r,collectPayoutRequirements:l=!1})=>{const{stripeConnectInstance:d,initializationError:m}=(e=>{const[t,o]=(0,s.useState)(null),{currentStep:n}=(0,a.w)(),[r,c]=(0,s.useState)(null),[l,d]=(0,s.useState)(!0);return(0,s.useEffect)((()=>{(async()=>{try{var t;const s=await(async(e,t)=>{const o=(s=e,(0,i.toPairs)(s).reduce(((e,[t,o])=>null!==o?(0,i.set)(e,t,o):e),{}));var s;const n={};return Object.keys(o).length>0&&(n.self_assessment=o),await L()({url:t,method:"POST",data:n})})(e,null!==(t=n?.actions?.kyc_session?.href)&&void 0!==t?t:""),{clientSecret:a,publishableKey:r}=s.session;if(!r)throw new Error((0,f.__)("Unable to start onboarding. If this problem persists, please contact support.","woocommerce"));const c=(0,X.e)({publishableKey:r,fetchClientSecret:async()=>a,appearance:{overlays:"drawer",...ee},locale:s.session.locale.replace("_","-")});o(c)}catch(e){c(e instanceof Error?e.message:(0,f.__)("Unable to start onboarding. If this problem persists, please contact support.","woocommerce"))}finally{d(!1)}})()}),[e]),{stripeConnectInstance:t,initializationError:r,loading:l}})(e);return(0,c.jsxs)(c.Fragment,{children:[m&&(0,c.jsx)(J,{status:"error",children:m}),d&&(0,c.jsx)(Q.MT,{connectInstance:d,children:(0,c.jsx)(Q.hw,{onLoaderStart:o,onLoadError:n,onExit:t,onStepChange:e=>r?.(e.step),collectionOptions:{fields:l?"eventually_due":"currently_due",futureRequirements:"omit"}})})]})},oe=({collectPayoutRequirements:e=!1})=>{var t;const{data:o}=u(),{currentStep:n,navigateToNextStep:r}=(0,a.w)(),[i,l]=(0,s.useState)(!1),[d,m]=(0,s.useState)(!0),[p,_]=(0,s.useState)(null),h=null!==(t=n?.actions?.kyc_fallback?.href)&&void 0!==t?t:"";return(0,c.jsxs)(c.Fragment,{children:[p&&("invalid_request_error"===p.error.type?(0,c.jsx)(J,{className:"woopayments-banner-notice--embedded-kyc",status:"warning",isDismissible:!1,actions:[{label:"Learn more",variant:"primary",url:"https://woocommerce.com/document/woopayments/startup-guide/#requirements",urlTarget:"_blank"},{label:"Cancel",variant:"link",url:h}],children:(0,f.__)("Payment activation through our financial partner requires HTTPS and cannot be completed.","woocommerce")}):(0,c.jsx)(J,{className:"woopayments-banner-notice--embedded-kyc",status:"error",isDismissible:!1,children:p.error.message})),d&&(0,c.jsx)("div",{className:"embedded-kyc-loader-wrapper padded",children:(0,c.jsx)(K.A,{})}),i&&(0,c.jsx)("div",{className:"embedded-kyc-loader-wrapper",children:(0,c.jsx)(K.A,{})}),(0,c.jsx)(te,{onExit:async()=>{l(!0);try{var e;(await(async e=>await L()({url:e,method:"POST",data:{}}))(null!==(e=n?.actions?.kyc_session_finish?.href)&&void 0!==e?e:"")).success?r():window.location.href=h}catch(e){window.location.href=h}},onStepChange:t=>{(0,R.W7)("woopayments_onboarding_modal_kyc_step_change",{kyc_step_id:t,collect_payout_requirements:e})},onLoaderStart:()=>{(0,R.W7)("woopayments_onboarding_modal_kyc_started_loading",{collect_payout_requirements:e}),m(!1)},onLoadError:t=>{(0,R.W7)("woopayments_onboarding_modal_kyc_load_error",{error_type:t.error.type,error_message:t.error.message||"no_message",collect_payout_requirements:e}),_(t)},onboardingData:o,collectPayoutRequirements:e})]})},se=()=>{const{currentStep:e}=(0,a.w)(),{nextStep:t}=g(),[o,n]=(0,s.useState)(!1);return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h1",{className:"stepper__heading",children:O.steps.activate.heading}),(0,c.jsx)("p",{className:"stepper__subheading",children:O.steps.activate.subheading}),(0,c.jsx)("div",{className:"stepper__content",children:(0,c.jsx)(p.Button,{variant:"primary",className:"stepper__cta",onClick:()=>{(0,R.W7)("woopayments_onboarding_modal_click",{step:e?.id||"unknown",sub_step_id:"activate",action:"activate_payments"}),n(!0),(0,R.AC)().then((()=>(n(!1),t()))).catch((()=>{n(!1)}))},isBusy:o,disabled:o,children:O.steps.activate.cta})})]})},ne=({name:e,children:t,showHeading:o=!0})=>(0,c.jsx)(c.Fragment,{children:(0,c.jsxs)("div",{className:"stepper__wrapper",children:[o&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("h1",{className:"stepper__heading",children:O.steps[e].heading}),(0,c.jsx)("h2",{className:"stepper__subheading",children:O.steps[e].subheading})]}),(0,c.jsx)("div",{className:"stepper__content",children:t})]})}),ae=()=>{var e,t,o;const{currentStep:s,closeModal:n}=(0,a.w)(),i={business_name:window.wcSettings?.siteTitle,mcc:E(null!==(e=s?.context?.fields?.mccs_display_tree)&&void 0!==e?e:[]),site:"localhost"===location.hostname?"https://wcpay.test":window.wcSettings?.homeUrl+I(),country:s?.context?.fields?.location,...null!==(t=s?.context?.self_assessment)&&void 0!==t?t:{}},l=null!==(o=s?.context?.has_test_account)&&void 0!==o&&o;return(0,c.jsxs)("div",{className:"settings-payments-onboarding-modal__step-business-verification",children:[(0,c.jsx)(r.A,{onClose:n}),(0,c.jsx)("div",{className:"settings-payments-onboarding-modal__step-business-verification-content",children:(0,c.jsx)(m,{initialData:i,children:(0,c.jsxs)(h,{onStepChange:()=>window.scroll(0,0),onExit:()=>{},children:[l&&(0,c.jsx)(ne,{name:"activate",showHeading:!1,children:(0,c.jsx)(se,{})}),(0,c.jsx)(ne,{name:"business",children:(0,c.jsx)(z,{children:(0,c.jsx)(U,{})})}),(0,c.jsx)(ne,{name:"embedded",showHeading:!1,children:(0,c.jsx)(oe,{})})]})})})]})}},8148:(e,t,o)=>{o.d(t,{A:()=>l}),o(51609);var s=o(27723),n=o(56427),a=o(99096),r=o(7175),i=o(1069),c=o(39793);const l=()=>{const{context:e,closeModal:t}=(0,a.w)();return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(r.A,{onClose:t}),(0,c.jsx)("div",{className:"settings-payments-onboarding-modal__step--content",children:(0,c.jsxs)("div",{className:"settings-payments-onboarding-modal__step--content-finish",children:[(0,c.jsx)("h1",{className:"settings-payments-onboarding-modal__step--content-finish-title",children:(0,s.__)("You’re ready to accept payments!","woocommerce")}),(0,c.jsx)("p",{className:"settings-payments-onboarding-modal__step--content-finish-description",children:(0,s.__)("Great news — your WooPayments account has been activated. You can now start accepting payments on your store.","woocommerce")}),(0,c.jsx)(n.Button,{variant:"primary",className:"settings-payments-onboarding-modal__step--content-finish-primary-button",onClick:()=>{var t;(0,i.W7)("woopayments_onboarding_modal_click",{step:"finish",action:"go_to_payments_overview"}),window.location.href=null!==(t=e?.urls?.overview_page)&&void 0!==t?t:""},children:(0,s.__)("Go to Payments Overview","woocommerce")}),(0,c.jsxs)("div",{className:"divider",children:[(0,c.jsx)("span",{className:"divider-line"}),(0,c.jsx)("span",{className:"divider-text",children:(0,s.__)("OR","woocommerce")}),(0,c.jsx)("span",{className:"divider-line"})]}),(0,c.jsx)(n.Button,{variant:"secondary",className:"settings-payments-onboarding-modal__step--content-finish-secondary-button",onClick:()=>{(0,i.W7)("woopayments_onboarding_modal_click",{step:"finish",action:"close_window"}),t()},children:(0,s.__)("Close this window","woocommerce")})]})})]})}},91289:(e,t,o)=>{o.d(t,{A:()=>h});var s=o(27723),n=o(56427),a=o(83306),r=o(86087),i=o(1455),c=o.n(i),l=o(47804),d=o(4921),m=o(99096),u=o(1275),p=o(1069),_=o(39793);function h(){const{currentStep:e,navigateToNextStep:t,closeModal:o}=(0,m.w)(),[i,h]=(0,r.useState)(!1),[g,y]=(0,r.useState)({}),[w,x]=(0,r.useState)(null),[v,b]=(0,r.useState)(!1),f=e?.context?.pms_state,j=e?.context?.recommended_pms,S=(0,r.useMemo)((()=>j?(0,p.js)(j):[]),[j]),k=(0,r.useRef)(null),[C,N]=(0,r.useState)(!1);(0,r.useEffect)((()=>{f&&y(f)}),[f]);const F=(0,r.useMemo)((()=>(0,p.LI)(g)),[g]);(0,r.useEffect)((()=>{if(null===w&&S.length>0&&Object.keys(F).length>0&&S.every((e=>void 0!==F[e.id]))){const e={};S.forEach((t=>{e[t.id]=(0,p.TO)(t,F[t.id])})),x(e)}}),[S,F,w]);const T=(0,r.useMemo)((()=>!w||i?0:S.filter((e=>{var t;return!(null!==(t=w[e.id])&&void 0!==t&&t)})).length),[S,i,w]),A=t=>{y(t);const o=e?.actions?.save?.href;o&&c()({url:o,method:"POST",data:{payment_methods:t}})},P=()=>{const e=k.current;e&&N(e.scrollHeight>e.clientHeight)};return(0,r.useEffect)((()=>{const e=setTimeout((()=>{P()}),0);return window.addEventListener("resize",P),()=>{clearTimeout(e),window.removeEventListener("resize",P)}}),[]),(0,_.jsx)("div",{className:"settings-payments-onboarding-modal__step--content",children:(0,_.jsxs)("div",{className:"woocommerce-layout__header woocommerce-recommended-payment-methods",children:[(0,_.jsxs)("div",{className:"woocommerce-layout__header-wrapper",children:[(0,_.jsxs)("div",{className:"woocommerce-layout__header-title-and-close",children:[(0,_.jsx)("h1",{className:"components-truncate components-text woocommerce-layout__header-heading woocommerce-layout__header-left-align woocommerce-settings-payments-header__title",children:(0,s.__)("Choose your payment methods","woocommerce")}),(0,_.jsx)(n.Button,{className:"settings-payments-onboarding-modal__header--close",onClick:o,children:(0,_.jsx)(n.Icon,{icon:l.A})})]}),(0,_.jsx)("div",{className:"woocommerce-settings-payments-header__description",children:(0,s.__)("Select which payment methods you'd like to offer to your shoppers. You can update these at any time.","woocommerce")})]}),(0,_.jsx)("div",{className:"woocommerce-recommended-payment-methods__list",children:(0,_.jsxs)("div",{className:"settings-payments-methods__container",ref:k,children:[(0,_.jsx)("div",{className:"woocommerce-list",children:S?.map((e=>{var t;return(0,_.jsx)(u.v,{method:e,paymentMethodsState:(0,p.LI)(g),setPaymentMethodsState:e=>{y(e),A(e)},initialVisibilityStatus:w&&null!==(t=w[e.id])&&void 0!==t?t:null,isExpanded:i},e.id)}))}),!i&&T>0&&(0,_.jsx)("div",{className:"settings-payments-methods__show-more--wrapper",children:(0,_.jsx)(n.Button,{className:"settings-payments-methods__show-more",onClick:()=>{(0,p.W7)("woopayments_onboarding_modal_click",{step:e?.id||"unknown",action:"show_more",hidden_count:T}),h(!i),setTimeout((()=>{P()}),0)},tabIndex:0,"aria-expanded":i,children:(0,s.sprintf)((0,s.__)("Show more (%s)","woocommerce"),T)})})]})}),(0,_.jsx)("div",{className:(0,d.A)("woocommerce-recommended-payment-methods__list_footer",{"has-border":C}),children:(0,_.jsx)(n.Button,{className:"components-button is-primary",onClick:()=>{const o=e?.actions?.finish?.href;o&&(A(g),b(!0),c()({url:o,method:"POST"}).then((()=>{var e;(0,a.recordEvent)("wcpay_settings_payment_methods_continue",{displayed_payment_methods:Object.keys(g).join(", "),selected_payment_methods:Object.keys(g).filter((e=>g[e])).join(", "),deselected_payment_methods:Object.keys(g).filter((e=>!g[e])).join(", "),business_country:null!==(e=window.wcSettings?.admin?.woocommerce_payments_nox_profile?.business_country_code)&&void 0!==e?e:"unknown"}),b(!1),t()})))},isBusy:v,disabled:v,children:(0,s.__)("Continue","woocommerce")})})]})})}},33623:(e,t,o)=>{o.d(t,{A:()=>w});var s=o(51609),n=o(1455),a=o.n(n),r=o(85816),i=o(27723),c=o(36849),l=o(56427),d=o(98846),m=o(96476),u=o(7175),p=o(99096),_=o(56109),h=o(1069),g=o(39793);const y=({progress:e,message:t})=>(0,g.jsx)(r.Loader,{className:"woocommerce-payments-test-account-step__preloader",children:(0,g.jsxs)(r.Loader.Layout,{className:"woocommerce-payments-test-account-step__preloader-layout",children:[(0,g.jsx)(r.Loader.Illustration,{children:(0,g.jsx)("img",{src:`${_.GZ}images/onboarding/test-account-setup.svg`,alt:"setup",style:{maxWidth:"223px"}})}),(0,g.jsx)(r.Loader.Title,{children:(0,i.__)("Finishing payments setup","woocommerce")}),(0,g.jsx)(r.Loader.ProgressBar,{progress:null!=e?e:0}),(0,g.jsx)(r.Loader.Sequence,{interval:0,children:t||(0,i.__)("In just a few moments, you'll be ready to test payments on your store.","woocommerce")})]})}),w=()=>{const{currentStep:e,navigateToNextStep:t,closeModal:o,refreshStoreData:n,setJustCompletedStepId:r}=(0,p.w)(),[w,x]=(0,s.useState)("idle"),[v,b]=(0,s.useState)(20),[f,j]=(0,s.useState)(),[S,k]=(0,s.useState)(0),[C,N]=(0,s.useState)(0),F=(0,s.useRef)(null),T=(0,s.useRef)(null),A=(0,s.useRef)(null),P=()=>{null!==F.current&&(clearTimeout(F.current),F.current=null),null!==A.current&&(clearTimeout(A.current),A.current=null)},[B,E]=(0,s.useState)(!1),I=(0,s.useCallback)((()=>{x("idle"),b(0),j(void 0),k(0),T.current=null,P()}),[x,b,j,k]);return(0,s.useEffect)((()=>{if("idle"===w){if("completed"===e?.status)return x("success"),r(e.id),void b(100);if("blocked"===e?.status)return j(e?.errors?.[0]?.message||(0,i.__)("There are environment or store setup issues which are blocking progress. Please resolve them to proceed.","woocommerce")),void x("blocked");"not_started"===e?.status||"failed"===e?.status?(x("initializing"),b(10),(async()=>{e?.actions?.clean?.href&&(C>0||"failed"===e?.status)&&await a()({url:e?.actions?.clean?.href,method:"POST"})})().then((()=>a()({url:e?.actions?.init?.href,method:"POST"}))).then((e=>{e?.success?x("polling"):(j(e?.message||(0,i.__)("Creating test account failed. Please try again.","woocommerce")),x("error"))})).catch((e=>{j(e.message),x("error")}))):x("polling")}if("polling"===w){const t=()=>{P(),a()({url:e?.actions?.check?.href,method:"POST"}).then((o=>{if("completed"===o?.status)return void(F.current=window.setTimeout((()=>{x("success"),b(100),r(e?.id||"")}),1e3));let s=S,n=3e3,a=0;b((e=>(a=0===S?Math.min(e+5,90):1===S?Math.min(e+1,96):e,a))),0===S&&a>=90?(s=1,n=5e3,T.current=Date.now()):1===S?T.current&&Date.now()-T.current>3e4?(s=2,n=7e3):(s=1,n=5e3):2===S?(s=2,n=7e3):(s=0,n=3e3),k(s),F.current=window.setTimeout(t,n)})).catch((e=>{j(e.message),x("error"),P()}))};t()}return"initializing"===w&&null===A.current&&(A.current=window.setInterval((()=>{b((e=>e<30?Math.min(e+2,30):e))}),1e3)),"initializing"!==w&&null!==A.current&&(clearTimeout(A.current),A.current=null),()=>{P()}}),[w,e,C,S,r]),"success"===w?(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(u.A,{onClose:o}),(0,g.jsx)("div",{className:"settings-payments-onboarding-modal__step--content",children:(0,g.jsx)("div",{className:"woocommerce-payments-test-account-step__success_content_container",children:(0,g.jsxs)("div",{className:"woocommerce-woopayments-modal__content woocommerce-payments-test-account-step__success_content",children:[(0,g.jsx)("h1",{className:"woocommerce-payments-test-account-step__success_content_title",children:(0,i.__)("You're ready to test payments!","woocommerce")}),(0,g.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,g.jsx)("div",{className:"woocommerce-woopayments-modal__content__item__description",children:(0,g.jsx)("p",{children:(0,c.A)({mixedString:(0,i.__)("We've created a test account for you so that you can begin {{link}}testing payments on your store{{/link}}.","woocommerce"),components:{link:(0,g.jsx)(d.Link,{href:"https://woocommerce.com/document/woopayments/testing-and-troubleshooting/sandbox-mode/",target:"_blank",rel:"noreferrer",type:"external"}),break:(0,g.jsx)("br",{})}})})})}),(0,g.jsxs)("div",{className:"woocommerce-payments-test-account-step__success-whats-next",children:[(0,g.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,g.jsx)("h2",{children:(0,i.__)("What's next:","woocommerce")})}),(0,g.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex",children:[(0,g.jsx)("img",{src:_.GZ+"images/icons/store.svg",alt:"store icon"}),(0,g.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex__description",children:[(0,g.jsx)("h3",{children:(0,i.__)("Continue your store setup","woocommerce")}),(0,g.jsx)("div",{children:(0,i.__)("Finish completing the tasks required to launch your store.","woocommerce")})]})]}),(0,g.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex",children:[(0,g.jsx)("img",{src:_.GZ+"images/icons/dollar.svg",alt:"dollar icon"}),(0,g.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex__description",children:[(0,g.jsx)("h3",{children:(0,i.__)("Activate payments","woocommerce")}),(0,g.jsx)("div",{children:(0,g.jsx)("p",{children:(0,c.A)({mixedString:(0,i.__)("Provide some additional details about your business so you can begin accepting real payments. {{link}}Learn more{{/link}}","woocommerce"),components:{link:(0,g.jsx)(d.Link,{href:"https://woocommerce.com/document/woopayments/startup-guide/#sign-up-process",target:"_blank",rel:"noreferrer",type:"external"})}})})})]})]})]}),(0,g.jsx)(l.Button,{variant:"primary",onClick:()=>{(0,h.W7)("woopayments_onboarding_modal_click",{step:e?.id||"unknown",action:"continue_store_setup"}),(0,m.navigateTo)({url:(0,m.getNewPath)({},"",{page:"wc-admin"})})},children:(0,i.__)("Continue store setup","woocommerce")}),(0,g.jsxs)("div",{className:"woocommerce-payments-test-account-step__success_content_or-divider",children:[(0,g.jsx)("hr",{}),(0,i.__)("OR","woocommerce"),(0,g.jsx)("hr",{})]}),(0,g.jsx)(l.Button,{variant:"secondary",isBusy:B,disabled:B,onClick:()=>{(0,h.W7)("woopayments_onboarding_modal_click",{step:e?.id||"unknown",action:"activate_payments"}),E(!0),(0,h.AC)().then((()=>(E(!1),t(),n()))).catch((()=>{E(!1)}))},children:(0,i.__)("Activate payments","woocommerce")})]})})})]}):(0,g.jsxs)("div",{className:"woocommerce-payments-test-account-step",children:[(0,g.jsx)(u.A,{onClose:o}),("error"===w||"blocked"===w)&&(0,g.jsx)(l.Notice,{status:"blocked"===w?"error":"warning",isDismissible:!1,actions:"blocked"!==w?[{label:(0,i.__)("Try Again","woocommerce"),variant:"primary",onClick:()=>{(0,h.W7)("woopayments_onboarding_modal_click",{step:e?.id||"unknown",action:"try_again_on_error",retries:C+1}),I(),N((e=>e+1))}},{label:(0,i.__)("Cancel","woocommerce"),variant:"secondary",className:"woocommerce-payments-test-account-step__error-cancel-button",onClick:()=>{(0,h.W7)("woopayments_onboarding_modal_click",{step:e?.id||"unknown",action:"cancel_on_error",retries:C}),o()}}]:[],className:"woocommerce-payments-test-account-step__error",children:(0,g.jsx)("p",{className:"woocommerce-payments-test-account-step__error-message",children:f||(0,i.__)("An error occurred while creating your test account. Please try again.","woocommerce")})}),("initializing"===w||"polling"===w)&&(0,g.jsx)(y,{progress:v,message:(D=S,1===D?(0,i.__)("The test account creation is taking a bit longer than expected, but don't worry — we're on it! Please bear with us for a few seconds more as we set everything up for your store.","woocommerce"):2===D?(0,i.__)("Thank you for your patience! Unfortunately, the test account creation is taking a bit longer than we anticipated. But don't worry — we won't give up! Feel free to close this modal and check back later. We appreciate your understanding!","woocommerce"):void 0)})]});var D}},10432:(e,t,o)=>{o.d(t,{A:()=>d}),o(51609);var s=o(27723),n=o(56427),a=o(86087),r=o(99096),i=o(7175),c=o(1069),l=o(39793);const d=()=>{const{currentStep:e,closeModal:t}=(0,r.w)(),[o,d]=(0,a.useState)(!1);return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(i.A,{onClose:t}),(0,l.jsx)("div",{className:"settings-payments-onboarding-modal__step--content",children:(0,l.jsxs)("div",{className:"settings-payments-onboarding-modal__step--content-jetpack",children:[(0,l.jsx)("h1",{className:"settings-payments-onboarding-modal__step--content-jetpack-title",children:(0,s.__)("Connect to WordPress.com","woocommerce")}),(0,l.jsx)("p",{className:"settings-payments-onboarding-modal__step--content-jetpack-description",children:(0,s.__)("You’ll be briefly redirected to connect your store to your WordPress.com account and unlock the full features and functionality of WooPayments","woocommerce")}),(0,l.jsx)(n.Button,{variant:"primary",className:"settings-payments-onboarding-modal__step--content-jetpack-button",isBusy:o,disabled:o,onClick:()=>{var t;(0,c.W7)("woopayments_onboarding_modal_click",{step:e?.id||"unknown",action:"connect_to_wpcom"}),d(!0),window.location.href=null!==(t=e?.actions?.auth?.href)&&void 0!==t?t:""},children:(0,s.__)("Connect","woocommerce")})]})})]})}}}]);