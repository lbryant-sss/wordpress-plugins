"use strict";(globalThis.webpackChunk_wcAdmin_webpackJsonp=globalThis.webpackChunk_wcAdmin_webpackJsonp||[]).push([[1226],{12974:(e,t,n)=>{n.d(t,{Ay:()=>a});var s=n(13240);const o=["a","b","em","i","strong","p","br"],i=["target","href","rel","name","download"],a=e=>({__html:(0,s.sanitize)(e,{ALLOWED_TAGS:o,ALLOWED_ATTR:i})})},75753:(e,t,n)=>{n.d(t,{LO:()=>u,PE:()=>p,S:()=>m,CS:()=>g}),n(18982);var s=n(27723),o=n(56427),i=n(86087),a=n(47143),r=n(40314),c=n(96476),l=n(83306),d=n(39793);const m=({gatewayId:e,gatewayState:t,settingsHref:n,onboardingHref:m,isOffline:_,acceptIncentive:u=()=>{},gatewayHasRecommendedPaymentMethods:p,installingPlugin:g,buttonText:h=(0,s.__)("Enable","woocommerce"),incentive:y=null,setOnboardingModalOpen:w,onboardingType:v})=>{const[x,b]=(0,i.useState)(!1),{createErrorNotice:j}=(0,a.dispatch)("core/notices"),{togglePaymentGateway:f,invalidateResolutionForStoreSelector:S}=(0,a.useDispatch)(r.paymentSettingsStore),N=()=>{j((0,s.__)("An error occurred. You will be redirected to the settings page, try enabling the payment gateway there.","woocommerce"),{type:"snackbar",explicitDismiss:!0})};return(0,d.jsx)(o.Button,{variant:"primary",isBusy:x,disabled:x||!!g,onClick:o=>{if(o.preventDefault(),t.enabled)return;(0,l.recordEvent)("settings_payments_provider_enable_click",{provider_id:e});const i=window.woocommerce_admin.nonces?.gateway_toggle||"";if(!i)return N(),void(window.location.href=n);b(!0),y&&u(y.promo_id),f(e,window.woocommerce_admin.ajax_url,i).then((o=>{if("needs_setup"===o.data)if(t.account_connected)j((0,s.__)("The provider could not be enabled. Check the Manage page for details.","woocommerce"),{type:"snackbar",explicitDismiss:!0,actions:[{label:(0,s.__)("Manage","woocommerce"),url:n}]});else if((0,l.recordEvent)("settings_payments_provider_enable",{provider_id:e}),"native_in_context"===v&&w)w(!0);else{if(!p)return void(window.location.href=m);(0,c.getHistory)().push((0,c.getNewPath)({},"/payment-methods"))}S(_?"getOfflinePaymentGateways":"getPaymentProviders"),b(!1)})).catch((()=>{b(!1),N(),window.location.href=n}))},href:n,children:h})};var _=n(1069);const u=({acceptIncentive:e,installingPlugin:t,buttonText:n=(0,s.__)("Activate payments","woocommerce"),incentive:a=null,setOnboardingModalOpen:r,onboardingType:c})=>{const[l,m]=(0,i.useState)(!1);return(0,d.jsx)(o.Button,{variant:"primary",isBusy:l,disabled:l||!!t,onClick:()=>{m(!0),a&&e(a.promo_id),"native_in_context"===c?r(!0):window.location.href=(0,_.ZV)()},children:n})},p=({gatewayId:e,gatewayState:t,onboardingState:n,settingsHref:m,onboardingHref:_,gatewayHasRecommendedPaymentMethods:u,installingPlugin:p,buttonText:g=(0,s.__)("Complete setup","woocommerce"),setOnboardingModalOpen:h,onboardingType:y})=>{const[w,v]=(0,i.useState)(!1),{select:x}=(0,a.useSelect)((e=>({select:e})),[]),b=t.account_connected,j=n.started,f=n.completed;return(0,i.useEffect)((()=>{"woocommerce_payments"!==e||"native_in_context"!==y||f||x(r.woopaymentsOnboardingStore).getOnboardingData()}),[e,y,f,x]),(0,d.jsx)(o.Button,{variant:"primary",isBusy:w,disabled:w||!!p,onClick:()=>{if((0,l.recordEvent)("settings_payments_provider_complete_setup_click",{provider_id:e,onboarding_started:n.started,onboarding_completed:n.completed,onboarding_test_mode:n.test_mode}),v(!0),"native_in_context"===y)h(!0);else{if(b&&j)return b&&j&&!f?void(window.location.href=_):void(window.location.href=m);if(!u)return void(window.location.href=_);(0,c.getHistory)().push((0,c.getNewPath)({},"/payment-methods"))}v(!1)},children:g},e)},g=({gatewayId:e,settingsHref:t,isInstallingPlugin:n,buttonText:i=(0,s.__)("Manage","woocommerce")})=>(0,d.jsx)(o.Button,{variant:"secondary",href:t,disabled:n,onClick:()=>{(0,l.recordEvent)("settings_payments_provider_manage_click",{provider_id:e})},children:i})},1275:(e,t,n)=>{n.d(t,{v:()=>l});var s=n(18537),o=n(56427),i=n(86087),a=n(12974),r=n(1069),c=n(39793);const l=({method:e,paymentMethodsState:t,setPaymentMethodsState:n,isExpanded:l,initialVisibilityStatus:d,...m})=>{var _,u,p,g;const h=(0,i.useRef)(null);void 0===d&&null===h.current&&void 0!==t[e.id]&&(h.current=(0,r.TO)(e,t[e.id]));const y=void 0!==d?null!=d&&d:null!==(_=h.current)&&void 0!==_&&_;return l||y?(0,c.jsx)("div",{id:e.id,className:"woocommerce-list__item woocommerce-list__item-enter-done",...m,children:(0,c.jsxs)("div",{className:"woocommerce-list__item-inner",children:["apple_google"!==e.id&&(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)("div",{className:"woocommerce-list__item-before",children:(0,c.jsx)("img",{src:e.icon,alt:e.title+" logo"})}),(0,c.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,c.jsx)("span",{className:"woocommerce-list__item-title",children:e.title}),(0,c.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,a.Ay)((0,s.decodeEntities)(e.description))})]})]}),"apple_google"===e.id&&(0,c.jsxs)("div",{className:"woocommerce-list__item-multi",children:[(0,c.jsxs)("div",{className:"woocommerce-list__item-multi-row multi-row-space",children:[(0,c.jsx)("div",{className:"woocommerce-list__item-before",children:(0,c.jsx)("img",{src:e.icon,alt:e.title+" logo"})}),(0,c.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,c.jsx)("span",{className:"woocommerce-list__item-title",children:e.title}),(0,c.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,a.Ay)((0,s.decodeEntities)(e.description))})]})]}),(0,c.jsxs)("div",{className:"woocommerce-list__item-multi-row",children:[(0,c.jsx)("div",{className:"woocommerce-list__item-before",children:(0,c.jsx)("img",{src:e.extraIcon,alt:e.extraTitle+" logo"})}),(0,c.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,c.jsx)("span",{className:"woocommerce-list__item-title",children:e.extraTitle}),(0,c.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,a.Ay)((0,s.decodeEntities)(null!==(u=e.extraDescription)&&void 0!==u?u:""))})]})]})]}),(0,c.jsx)("div",{className:"woocommerce-list__item-after",children:(0,c.jsx)("div",{className:"woocommerce-list__item-after__actions wc-settings-prevent-change-event",children:(0,c.jsx)(o.ToggleControl,{checked:null!==(p=t[e.id])&&void 0!==p&&p,onChange:s=>{n({...t,[e.id]:s})},disabled:null!==(g=e.required)&&void 0!==g&&g,label:""})})})]})}):null}},60327:(e,t,n)=>{n.r(t),n.d(t,{SettingsPaymentsMain:()=>it,default:()=>at});var s=n(51609),o=n.n(s),i=n(27723),a=n(40314),r=n(47143),c=n(86087),l=n(1455),d=n.n(l),m=n(96476),_=n(83306),u=n(56427);function p(e){const{createNotice:t}=(0,r.dispatch)("core/notices");e.error_data&&e.errors&&Object.keys(e.errors).length?Object.keys(e.errors).forEach((n=>{t("error",e.errors[n].join(" "))})):e.message&&t(e.code?"error":"success",e.message)}var g=n(72553),h=n(18537),y=n(39793);const w=()=>(0,y.jsxs)("div",{className:"other-payment-gateways__content__grid-item",children:[(0,y.jsx)("div",{className:"grid-item-placeholder__img"}),(0,y.jsxs)("div",{className:"other-payment-gateways__content__grid-item__content grid-item-placeholder__content",children:[(0,y.jsx)("span",{className:"grid-item-placeholder__title"}),(0,y.jsx)("span",{className:"grid-item-placeholder__description"}),(0,y.jsx)("div",{className:"grid-item-placeholder__actions"})]})]});var v=n(98846),x=n(56109);const b=({variant:e})=>{const[t,n]=(0,c.useState)(!1),s=(0,c.useRef)(null),o=e=>{const t=e.target.closest(".woocommerce-official-extension-badge__container");s.current&&t!==s.current||n((e=>!e))};return(0,y.jsx)(v.Pill,{className:"woocommerce-official-extension-badge",children:(0,y.jsxs)("span",{className:"woocommerce-official-extension-badge__container",tabIndex:0,role:"button",ref:s,onClick:o,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||o(e)},children:[(0,y.jsx)("img",{src:x.GZ+"images/icons/official-extension.svg",alt:(0,i.__)("Official WooCommerce extension badge","woocommerce")}),"expanded"===e&&(0,y.jsx)("span",{children:(0,i.__)("Official","woocommerce")}),t&&(0,y.jsx)(u.Popover,{className:"woocommerce-official-extension-badge-popover",placement:"top-start",offset:4,variant:"unstyled",focusOnMount:!0,noArrow:!0,shift:!0,onFocusOutside:()=>{n(!1)},children:(0,y.jsx)("div",{className:"components-popover__content-container",children:(0,y.jsx)("p",{children:(0,c.createInterpolateElement)((0,i.__)("This is an Official WooCommerce payment extension. <learnMoreLink />","woocommerce"),{learnMoreLink:(0,y.jsx)(v.Link,{href:"https://woocommerce.com/learn-more-about-official-partner-badging/",target:"_blank",rel:"noreferrer",type:"external",children:(0,i.__)("Learn more","woocommerce")})})})})})]})})};var j=n(24148),f=n(73290);const S=({status:e,message:t,popoverContent:n})=>{const[s,o]=(0,c.useState)(!1),a=(0,c.useRef)(null),r=e=>{const t=e.target.closest(".woocommerce-status-badge__icon-container");a.current&&t!==a.current||o((e=>!e))};return(0,y.jsxs)(v.Pill,{className:`woocommerce-status-badge ${(()=>{switch(e){case"active":case"has_incentive":return"woocommerce-status-badge--success";case"needs_setup":case"test_mode":case"test_account":return"woocommerce-status-badge--warning";case"recommended":case"inactive":return"woocommerce-status-badge--info";default:return""}})()}`,children:[t||(()=>{switch(e){case"active":return(0,i.__)("Active","woocommerce");case"inactive":return(0,i.__)("Inactive","woocommerce");case"needs_setup":return(0,i.__)("Action needed","woocommerce");case"test_mode":return(0,i.__)("Test mode","woocommerce");case"test_account":return(0,i.__)("Test account","woocommerce");case"recommended":return(0,i.__)("Recommended","woocommerce");default:return""}})(),n&&(0,y.jsxs)("span",{className:"woocommerce-status-badge__icon-container",tabIndex:0,role:"button",ref:a,onClick:r,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||r(e)},children:[(0,y.jsx)(j.A,{className:"woocommerce-status-badge-icon",size:16,icon:f.A}),s&&(0,y.jsx)(u.Popover,{className:"woocommerce-status-badge-popover",placement:"top-start",offset:4,variant:"unstyled",focusOnMount:!0,noArrow:!0,shift:!0,onFocusOutside:()=>{o(!1)},children:(0,y.jsx)("div",{className:"components-popover__content-container",children:n})})]})]})},N=({incentive:e})=>(0,y.jsx)(S,{status:"has_incentive",message:e.badge,popoverContent:(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("p",{className:"woocommerce-incentive-popover__title",children:e.title}),(0,y.jsx)("p",{className:"woocommerce-incentive-popover__terms",children:(0,c.createInterpolateElement)((0,i.__)("See <termsLink /> for details.","woocommerce"),{termsLink:(0,y.jsx)(v.Link,{href:e.tc_url,target:"_blank",rel:"noreferrer",type:"external",children:(0,i.__)("Terms and Conditions","woocommerce")})})})]})}),k=({suggestions:e,suggestionCategories:t,installingPlugin:n,setupPlugin:s,isFetching:o,morePaymentOptionsLink:a})=>{const r="expanded"===new URLSearchParams(window.location.search).get("other_pes_section"),[l,d]=(0,c.useState)(r),[m,_]=(0,c.useState)(""),p=(0,c.useRef)(null),v=(e,t)=>{const n=e.target.closest(".other-payment-gateways__content__title__icon-container");p.current&&n!==p.current||_(t===m?"":t)},x=()=>{_("")},j=(0,c.useMemo)((()=>t.map((t=>({category:t,suggestions:e.filter((e=>e._type===t.id))})))),[e,t]),f=(0,c.useMemo)((()=>o?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("div",{className:"other-payment-gateways__header__title-image-placeholder"}),(0,y.jsx)("div",{className:"other-payment-gateways__header__title-image-placeholder"}),(0,y.jsx)("div",{className:"other-payment-gateways__header__title-image-placeholder"})]}):j.map((({suggestions:e})=>0===e.length?null:e.map((e=>(0,y.jsx)("img",{src:e.icon,alt:e.title+" small logo",width:"24",height:"24",className:"other-payment-gateways__header__title-image"},e.id)))))),[j,o]),S=(0,c.useMemo)((()=>o?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(w,{}),(0,y.jsx)(w,{}),(0,y.jsx)(w,{})]}):j.map((({category:e,suggestions:t})=>0===t.length?null:(0,y.jsxs)("div",{className:"other-payment-gateways__content__category-container",children:[(0,y.jsxs)("div",{className:"other-payment-gateways__content__title",children:[(0,y.jsx)("h3",{className:"other-payment-gateways__content__title__h3",children:(0,h.decodeEntities)(e.title)}),(0,y.jsxs)("span",{className:"other-payment-gateways__content__title__icon-container",onClick:t=>v(t,e.id),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||v(t,e.id)},tabIndex:0,role:"button",ref:p,children:[(0,y.jsx)(g.A,{icon:"info-outline",className:"other-payment-gateways__content__title__icon"}),e.id===m&&(0,y.jsx)(u.Popover,{className:"other-payment-gateways__content__title-popover",placement:"top-start",offset:4,variant:"unstyled",focusOnMount:!0,noArrow:!0,shift:!0,onFocusOutside:x,children:(0,y.jsx)("div",{className:"components-popover__content-container",children:(0,y.jsx)("p",{children:(0,h.decodeEntities)(e.description)})})})]})]}),(0,y.jsx)("div",{className:"other-payment-gateways__content__grid",children:t.map((e=>(0,y.jsxs)("div",{className:"other-payment-gateways__content__grid-item",children:[(0,y.jsx)("img",{className:"other-payment-gateways__content__grid-item-image",src:e.icon,alt:(0,h.decodeEntities)(e.title)+" logo"}),(0,y.jsxs)("div",{className:"other-payment-gateways__content__grid-item__content",children:[(0,y.jsxs)("span",{className:"other-payment-gateways__content__grid-item__content__title",children:[e.title,e?._incentive&&(0,y.jsx)(N,{incentive:e._incentive}),(0,y.jsx)(b,{variant:"expanded"})]}),(0,y.jsx)("span",{className:"other-payment-gateways__content__grid-item__content__description",children:(0,h.decodeEntities)(e.description)}),(0,y.jsx)("div",{className:"other-payment-gateways__content__grid-item__content__actions",children:(0,y.jsx)(u.Button,{variant:"link",onClick:()=>{var t;return s(e.id,e.plugin.slug,null,"not_installed"===e.plugin.status&&null!==(t=e._links?.attach?.href)&&void 0!==t?t:null)},isBusy:n===e.id,disabled:!!n,children:n===e.id?(0,i.__)("Installing","woocommerce"):(0,i.__)("Install","woocommerce")})})]})]},e.id)))})]},e.id)))),[j,n,s,o,m]);return(0,y.jsxs)("div",{className:"other-payment-gateways"+(l?" is-expanded":""),children:[(0,y.jsxs)("div",{className:"other-payment-gateways__header",onClick:()=>{d(!l)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||d(!l)},role:"button",tabIndex:0,"aria-expanded":l,children:[(0,y.jsxs)("div",{className:"other-payment-gateways__header__title",children:[(0,y.jsx)("span",{children:(0,i.__)("Other payment options","woocommerce")}),!l&&(0,y.jsx)(y.Fragment,{children:f})]}),(0,y.jsx)(g.A,{className:"other-payment-gateways__header__arrow",icon:l?"chevron-up":"chevron-down"})]}),l&&(0,y.jsxs)("div",{className:"other-payment-gateways__content",children:[S,(0,y.jsx)("div",{className:"other-payment-gateways__content__external-icon",children:a})]})]})};var C=n(4921),P=n(15703),E=n(46608),O=n(36849),T=n(21913),F=n(29491),I=n(90700),A=n(72744);const B=(e,t)=>{const n=t,{changes:s,type:o,props:i}=n,{items:a}=i,{selectedItem:r}=e;switch(o){case T.WM.stateChangeTypes.ItemClick:return{...s,isOpen:!0,highlightedIndex:e.highlightedIndex};case T.WM.stateChangeTypes.ToggleButtonKeyDownArrowDown:return{selectedItem:a[r?Math.min(a.indexOf(r)+1,a.length-1):0],isOpen:!0};case T.WM.stateChangeTypes.ToggleButtonKeyDownArrowUp:return{selectedItem:a[r?Math.max(a.indexOf(r)-1,0):a.length-1],isOpen:!0};default:return s}},D=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),M=({name:e,className:t,label:n,describedBy:o,options:a,onChange:r,value:l,placeholder:d,children:m})=>{var _;const[p,g]=(0,s.useState)(""),h=(0,F.useThrottle)((0,c.useCallback)(((e,t)=>new Set(t.filter((t=>{var n;return`${D(null!==(n=t.name)&&void 0!==n?n:"")}`.toLowerCase().includes(D(e.toLowerCase()))})))),[]),200),w=""!==p?null!==(_=h(p,a))&&void 0!==_?_:new Set:new Set(a),{getToggleButtonProps:v,getMenuProps:b,getItemProps:f,isOpen:S,highlightedIndex:N,selectedItem:k,closeMenu:P}=(0,T.WM)({initialSelectedItem:l,items:[...w],stateReducer:B}),E=((e,t)=>{const n=t.find((t=>t.key===e));return n?.name?n.name:""})(l.key,a),O=k?k.key:"",M=(0,s.useRef)(null),L=(0,s.useRef)(null),R=(0,c.useCallback)((e=>{const t=M.current,n=t?.querySelector(`[data-index="${e}"]`);n&&n.scrollIntoView({block:"nearest"})}),[M]),W=""!==p,H=b({className:"components-country-select-control__menu","aria-hidden":!S,ref:M}),U=(0,c.useCallback)((e=>{e.stopPropagation(),r(O),P()}),[r,O,P]),G=(0,c.useCallback)((e=>{e.stopPropagation(),"Enter"===e.key&&r(O)}),[r,O]),q=(0,c.useCallback)((e=>{e.preventDefault(),""!==p&&g(""),null!==k&&setTimeout((()=>{R(a.indexOf(k))}),10)}),[p,k]);return(0,c.useEffect)((()=>{if(S&&null!==k){const e=Array.from(w).indexOf(k);R(e)}}),[S]),(0,y.jsxs)("div",{className:(0,C.A)("woopayments components-country-select-control",t),children:[(0,y.jsxs)(u.Button,{...v({"aria-label":n,"aria-labelledby":void 0,"aria-describedby":o||(E?(0,i.sprintf)((0,i.__)("Currently selected: %s","woocommerce"),E):(0,i.__)("No selection","woocommerce")),className:(0,C.A)("components-country-select-control__button",{placeholder:!E}),name:e,onKeyDown:G}),children:[(0,y.jsxs)("span",{className:"components-country-select-control__button-value",children:[(0,y.jsx)("span",{className:"components-country-select-control__label",children:n}),E||d]}),(0,y.jsx)(j.A,{icon:I.A,className:"components-custom-select-control__button-icon"})]}),(0,y.jsx)("div",{...H,children:S&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsxs)("div",{className:"components-country-select-control__search wc-settings-prevent-change-event",children:[(0,y.jsx)("input",{className:"components-country-select-control__search--input",ref:L,type:"text",value:p,onChange:({target:e})=>g(e.value),tabIndex:-1,placeholder:(0,i.__)("Search","woocommerce")}),(0,y.jsx)("button",{className:"components-country-select-control__search--input-suffix",onClick:q,children:(z=W,z?(0,y.jsx)("img",{src:x.GZ+"images/icons/clear.svg",alt:(0,i.__)("Clear search","woocommerce")}):(0,y.jsx)("img",{src:x.GZ+"images/icons/search.svg",alt:(0,i.__)("Search","woocommerce")}))})]}),(0,y.jsx)("div",{className:"components-country-select-control__list",children:[...w].map(((e,t)=>(0,s.createElement)("div",{...f({item:e,index:t,key:e.key,className:(0,C.A)(e.className,"components-country-select-control__item",{"is-highlighted":t===N}),"data-index":t,style:e.style}),key:e.key},e.key===O&&(0,y.jsx)(j.A,{icon:A.A,className:"components-country-select-control__item-icon"}),m?m(e):e.name)))}),(0,y.jsx)("div",{className:"components-country-select-control__apply",children:(0,y.jsx)("button",{className:"components-button is-primary",onClick:U,children:(0,i.__)("Apply","woocommerce")})})]})})]});var z};var L=n(51881),R=n(15698),W=n(85816),H=n(12974);const U=({providerId:e,pluginFile:t,isSuggestion:n,suggestionId:s,suggestionHideUrl:o="",onToggle:l,links:d=[],canResetAccount:m=!1,setResetAccountModalVisible:p=()=>{},isEnabled:g=!1})=>{const{deactivatePlugin:h}=(0,r.useDispatch)(a.pluginsStore),[w,v]=(0,c.useState)(!1),[x,b]=(0,c.useState)(!1),[j,f]=(0,c.useState)(!1),{invalidateResolutionForStoreSelector:S,togglePaymentGateway:N,hidePaymentExtensionSuggestion:k}=(0,r.useDispatch)(a.paymentSettingsStore),{createErrorNotice:C,createSuccessNotice:P}=(0,r.useDispatch)("core/notices"),E={pricing:(0,i.__)("See pricing & fees","woocommerce"),about:(0,i.__)("Learn more","woocommerce"),terms:(0,i.__)("See Terms of Service","woocommerce"),support:(0,i.__)("Get support","woocommerce"),documentation:(0,i.__)("View documentation","woocommerce")},O=d.filter((e=>{switch(e._type){case"pricing":return!0;case"terms":case"about":return!g;case"documentation":case"support":return g;default:return!1}}));return(0,y.jsxs)(y.Fragment,{children:[O.map((e=>{const t=E[e._type];return t?(0,y.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,y.jsx)(u.Button,{target:"_blank",href:e.url,children:t})},e._type):null})),!!O.length&&(0,y.jsx)(u.CardDivider,{}),n&&(0,y.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,y.jsx)(u.Button,{onClick:()=>{f(!0),(0,_.recordEvent)("settings_payments_recommendations_dismiss",{pes_id:s}),k(o).then((()=>{S("getPaymentProviders"),f(!1),l()})).catch((()=>{C((0,i.__)("Failed to hide the payment extension suggestion.","woocommerce")),f(!1),l()}))},isBusy:j,disabled:j,children:(0,i.__)("Hide suggestion","woocommerce")})},"hide-suggestion"),m&&(0,y.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,y.jsx)(u.Button,{onClick:()=>{p(!0),l()},className:"components-button__danger",children:(0,i.__)("Reset account","woocommerce")})},"reset-account"),!n&&!g&&(0,y.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,y.jsx)(u.Button,{className:"components-button__danger",onClick:()=>{v(!0),h(t).then((()=>{P((0,i.__)("Plugin was successfully deactivated.","woocommerce")),S("getPaymentProviders"),v(!1),l()})).catch((()=>{C((0,i.__)("Failed to deactivate the plugin.","woocommerce")),v(!1),l()}))},isBusy:w,disabled:w,children:(0,i.__)("Deactivate","woocommerce")})},"deactivate"),!n&&g&&(0,y.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,y.jsx)(u.Button,{className:"components-button__danger",onClick:()=>{(0,_.recordEvent)("settings_payments_provider_disable_click",{provider_id:e});const t=window.woocommerce_admin.nonces?.gateway_toggle||"";t?(b(!0),N(e,window.woocommerce_admin.ajax_url,t).then((()=>{(0,_.recordEvent)("settings_payments_provider_disable",{provider_id:e}),S("getPaymentProviders"),b(!1),l()})).catch((()=>{C((0,i.__)("Failed to disable the plugin.","woocommerce")),b(!1),l()}))):C((0,i.__)("Failed to disable the plugin.","woocommerce"))},isBusy:x,disabled:x,children:(0,i.__)("Disable","woocommerce")})},"disable")]})};var G=n(1069);const q=({isOpen:e,onClose:t,isTestMode:n})=>{const[s,o]=(0,c.useState)(!1),{invalidateResolutionForStoreSelector:l}=(0,r.useDispatch)(a.paymentSettingsStore),{invalidateResolutionForStoreSelector:d}=(0,r.useDispatch)(a.woopaymentsOnboardingStore),{createNotice:m}=(0,r.useDispatch)("core/notices");return(0,y.jsx)(y.Fragment,{children:e&&(0,y.jsxs)(u.Modal,{title:(0,i.__)("Reset your test account","woocommerce"),className:"woocommerce-woopayments-modal",isDismissible:!0,onRequestClose:t,children:[(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content",children:[(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,y.jsx)("div",{children:(0,y.jsx)("span",{children:n?(0,i.sprintf)((0,i.__)("When you reset your test account, all payment data — including your %s account details, test transactions, and payouts history — will be lost. Your order history will remain. This action cannot be undone, but you can create a new test account at any time.","woocommerce"),"WooPayments"):(0,i.sprintf)((0,i.__)("When you reset your account, all payment data — including your %s account details, test transactions, and payouts history — will be lost. Your order history will remain. This action cannot be undone, but you can create a new test account at any time.","woocommerce"),"WooPayments")})})}),(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,y.jsx)("h3",{children:(0,i.__)("Are you sure you'd like to continue?","woocommerce")})})]}),(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__actions",children:(0,y.jsx)(u.Button,{className:"danger",variant:"secondary",isBusy:s,disabled:s,onClick:()=>{o(!0),(0,G.pF)().then((()=>{l("getPaymentProviders"),d("getOnboardingData")})).catch((()=>{m("error",(0,i.__)("Failed to reset your WooPayments account.","woocommerce"),{isDismissible:!0})})).finally((()=>{o(!1),t()}))},children:(0,i.__)("Yes, reset account","woocommerce")})})]})})},z=({isOpen:e,devMode:t,onClose:n})=>{const[s,o]=(0,c.useState)(!1),[a,r]=(0,c.useState)(!1);return(0,y.jsx)(y.Fragment,{children:e&&(0,y.jsxs)(u.Modal,{title:(0,i.__)("You're ready to test payments!","woocommerce"),className:"woocommerce-woopayments-modal",isDismissible:!0,onRequestClose:n,children:[(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content",children:[(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__content__item__description",children:(0,y.jsx)("p",{children:(0,O.A)({mixedString:(0,i.__)("We've created a test account for you so that you can begin testing payments on your store. {{break/}}Not sure what to test? Take a look at {{link}}how to test payments{{/link}}.","woocommerce"),components:{link:(0,y.jsx)(v.Link,{href:"https://woocommerce.com/document/woopayments/testing-and-troubleshooting/sandbox-mode/",target:"_blank",rel:"noreferrer",type:"external"}),break:(0,y.jsx)("br",{})}})})})}),(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,y.jsx)("h2",{children:(0,i.__)("What's next:","woocommerce")})}),(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex",children:[(0,y.jsx)("img",{src:x.GZ+"images/icons/store.svg",alt:"store icon"}),(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex__description",children:[(0,y.jsx)("h3",{children:(0,i.__)("Continue your store setup","woocommerce")}),(0,y.jsx)("div",{children:(0,i.__)("Finish completing the tasks required to launch your store.","woocommerce")})]})]}),!t&&(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex",children:[(0,y.jsx)("img",{src:x.GZ+"images/icons/dollar.svg",alt:"dollar icon"}),(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex__description",children:[(0,y.jsx)("h3",{children:(0,i.__)("Activate payments","woocommerce")}),(0,y.jsx)("div",{children:(0,y.jsx)("p",{children:(0,O.A)({mixedString:(0,i.__)("Provide some additional details about your business so you can begin accepting real payments. {{link}}Learn more{{/link}}","woocommerce"),components:{link:(0,y.jsx)(v.Link,{href:"https://woocommerce.com/document/woopayments/startup-guide/#sign-up-process",target:"_blank",rel:"noreferrer",type:"external"})}})})})]})]})]}),(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__actions",children:[(0,y.jsx)(u.Button,{variant:"primary",isBusy:a,disabled:a,onClick:()=>{(0,_.recordEvent)("settings_payments_continue_store_setup_click",{provider_id:"woocommerce_payments"}),r(!0),window.location.href=(0,P.getAdminLink)("admin.php?page=wc-admin")},children:(0,i.__)("Continue store setup","woocommerce")}),!t&&(0,y.jsx)(u.Button,{variant:"secondary",isBusy:s,disabled:s,onClick:()=>{(0,_.recordEvent)("settings_payments_switch_to_live_account_click",{provider_id:"woocommerce_payments"}),o(!0),window.location.href=(0,G.ZV)()},children:(0,i.__)("Activate payments","woocommerce")})]})]})})},$=({provider:e,label:t})=>{const[n,s]=(0,c.useState)(!1),o=(0,G.j4)(e.id)&&"gateway"===e._type&&e.state?.account_connected&&(e.onboarding?.state.test_mode||!e.onboarding?.state.completed);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(v.EllipsisMenu,{label:t,renderContent:({onToggle:t})=>(0,y.jsx)(U,{providerId:e.id,pluginFile:e.plugin.file,isSuggestion:"suggestion"===e._type,suggestionId:"suggestion"===e._type?e._suggestion_id:void 0,suggestionHideUrl:"suggestion"===e._type?e._links?.hide?.href:"",links:e.links,onToggle:t,isEnabled:e.state?.enabled,canResetAccount:o,setResetAccountModalVisible:s}),focusOnMount:!0}),(0,y.jsx)(q,{isOpen:n,onClose:()=>s(!1),isTestMode:e.onboarding?.state.test_mode})]})},K=({extension:e,installingPlugin:t,setupPlugin:n,pluginInstalled:s,acceptIncentive:o,shouldHighlightIncentive:a,...r})=>{const c=(0,G.O2)(e)?e._incentive:null;let l=(0,i.__)("Install","woocommerce");return s?l=(0,i.__)("Enable","woocommerce"):t===e.id&&(l=(0,i.__)("Installing","woocommerce")),(0,y.jsx)("div",{id:e.id,className:"transitions-disabled woocommerce-list__item woocommerce-list__item-enter-done "+((0,G.O2)(e)&&a?"has-incentive":""),...r,children:(0,y.jsxs)("div",{className:"woocommerce-list__item-inner",children:[(0,y.jsxs)("div",{className:"woocommerce-list__item-before",children:[(0,y.jsx)(R.Gh,{}),e.icon&&(0,y.jsx)("img",{className:"woocommerce-list__item-image",src:e.icon,alt:e.title+" logo"})]}),(0,y.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,y.jsxs)("span",{className:"woocommerce-list__item-title",children:[e.title," ",!(0,G.O2)(e)&&(0,G.j4)(e.id)&&(0,y.jsx)(S,{status:"recommended"}),c&&(0,y.jsx)(N,{incentive:c}),(0,y.jsx)(b,{variant:"expanded"})]}),(0,y.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,H.Ay)((0,h.decodeEntities)(e.description))}),(0,G.j4)(e.id)&&(0,y.jsx)(W.WooPaymentsMethodsLogos,{maxElements:10,tabletWidthBreakpoint:1080,mobileWidthBreakpoint:768,isWooPayEligible:(0,G.bU)(e)})]}),(0,y.jsx)("div",{className:"woocommerce-list__item-buttons",children:(0,y.jsx)("div",{className:"woocommerce-list__item-buttons__actions",children:(0,y.jsx)(u.Button,{variant:"primary",onClick:()=>{var t,i;s&&(0,_.recordEvent)("settings_payments_provider_enable_click",{provider_id:e.id}),c&&o(c.promo_id),n(e.id,e.plugin.slug,null!==(t=e.onboarding?._links.onboard.href)&&void 0!==t?t:null,s?null:null!==(i=e._links?.attach?.href)&&void 0!==i?i:null)},isBusy:t===e.id,disabled:!!t,children:l})})}),(0,y.jsx)("div",{className:"woocommerce-list__item-after",children:(0,y.jsx)("div",{className:"woocommerce-list__item-after__actions",children:(0,y.jsx)($,{label:(0,i.__)("Payment Provider Options","woocommerce"),provider:e})})})]})})};var Z=n(75753);const V=({buttonText:e=(0,i.__)("Reactivate payments","woocommerce"),settingsHref:t})=>{const[n,s]=(0,c.useState)(!1),{createSuccessNotice:o,createErrorNotice:l}=(0,r.dispatch)("core/notices"),{invalidateResolutionForStoreSelector:m}=(0,r.useDispatch)(a.paymentSettingsStore);return(0,y.jsx)(u.Button,{variant:"primary",isBusy:n,disabled:n,onClick:e=>{e.preventDefault(),s(!0),d()({path:"/wc/v3/payments/settings",method:"POST",data:{is_test_mode_enabled:!1}}).then((()=>{o((0,i.sprintf)((0,i.__)("%s is now processing live payments (real payment methods and charges).","woocommerce"),"WooPayments"),{type:"snackbar",explicitDismiss:!1}),m("getPaymentProviders"),s(!1)})).catch((()=>{s(!1),l((0,i.sprintf)((0,i.__)("An error occurred. You will be redirected to the %s settings page to manage payments processing mode from there.","woocommerce"),"WooPayments"),{type:"snackbar",explicitDismiss:!0}),window.location.href=t}))},href:t,children:e})},Y=({gateway:e,installingPlugin:t,acceptIncentive:n,shouldHighlightIncentive:s,setIsOnboardingModalOpen:o,...a})=>{var r;const c=(0,G.j4)(e.id),l=(0,G.O2)(e)?e._incentive:null,d=(null!==(r=e.onboarding.recommended_payment_methods)&&void 0!==r?r:[]).length>0,m=!e.state.account_connected||e.state.account_connected&&!e.onboarding.state.started||e.state.account_connected&&e.onboarding.state.started&&!e.onboarding.state.completed;return(0,y.jsx)("div",{id:e.id,className:`transitions-disabled woocommerce-list__item woocommerce-list__item-enter-done woocommerce-item__payment-gateway ${c?"woocommerce-item__woocommerce-payments":""} ${(0,G.O2)(e)&&s?"has-incentive":""}`,...a,children:(0,y.jsxs)("div",{className:"woocommerce-list__item-inner",children:[(0,y.jsxs)("div",{className:"woocommerce-list__item-before",children:[(0,y.jsx)(R.Gh,{}),e.icon&&(0,y.jsx)("img",{className:"woocommerce-list__item-image",src:e.icon,alt:e.title+" logo"})]}),(0,y.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,y.jsxs)("span",{className:"woocommerce-list__item-title",children:[e.title,l?(0,y.jsx)(N,{incentive:l}):(0,y.jsx)(S,{status:!e.state.enabled&&e.state.needs_setup?"needs_setup":e.state.enabled?e.onboarding.state.test_mode?"test_account":e.state.test_mode?"test_mode":"active":"inactive"}),e._suggestion_id&&(0,y.jsx)(b,{variant:"expanded"}),e.supports?.includes("subscriptions")&&(0,y.jsx)(u.Tooltip,{placement:"top",text:(0,i.__)("Supports recurring payments","woocommerce"),children:(0,y.jsx)("img",{className:"woocommerce-list__item-recurring-payments-icon",src:x.GZ+"images/icons/recurring-payments.svg",alt:(0,i.__)("Icon to indicate support for recurring payments","woocommerce")})})]}),(0,y.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,H.Ay)((0,h.decodeEntities)(e.description))}),c&&(0,y.jsx)(W.WooPaymentsMethodsLogos,{maxElements:10,tabletWidthBreakpoint:1080,mobileWidthBreakpoint:768,isWooPayEligible:(0,G.bU)(e)})]}),(0,y.jsx)("div",{className:"woocommerce-list__item-buttons",children:(0,y.jsxs)("div",{className:"woocommerce-list__item-buttons__actions",children:[!e.state.enabled&&!m&&(0,y.jsx)(Z.S,{gatewayId:e.id,gatewayState:e.state,settingsHref:e.management._links.settings.href,onboardingHref:e.onboarding._links.onboard.href,isOffline:!1,gatewayHasRecommendedPaymentMethods:d,installingPlugin:t,incentive:l,acceptIncentive:n,setOnboardingModalOpen:o,onboardingType:e.onboarding.type}),!m&&(0,y.jsx)(Z.CS,{gatewayId:e.id,settingsHref:e.management._links.settings.href,isInstallingPlugin:!!t}),m&&(0,y.jsx)(Z.PE,{gatewayId:e.id,gatewayState:e.state,onboardingState:e.onboarding.state,settingsHref:e.management._links.settings.href,onboardingHref:e.onboarding._links.onboard.href,gatewayHasRecommendedPaymentMethods:d,installingPlugin:t,setOnboardingModalOpen:o,onboardingType:e.onboarding.type}),(0,G.j4)(e.id)&&!e.state.dev_mode&&e.state.account_connected&&e.onboarding.state.completed&&e.onboarding.state.test_mode&&(0,y.jsx)(Z.LO,{acceptIncentive:n,installingPlugin:t,incentive:l,setOnboardingModalOpen:o,onboardingType:e.onboarding.type}),(0,G.j4)(e.id)&&!e.state.dev_mode&&e.state.account_connected&&e.onboarding.state.completed&&!e.onboarding.state.test_mode&&e.state.test_mode&&(0,y.jsx)(V,{settingsHref:e.management._links.settings.href})]})}),(0,y.jsx)("div",{className:"woocommerce-list__item-after",children:(0,y.jsx)("div",{className:"woocommerce-list__item-after__actions",children:(0,y.jsx)($,{label:(0,i.__)("Payment Provider Options","woocommerce"),provider:e})})})]})})},X=({providers:e,installedPluginSlugs:t,installingPlugin:n,setupPlugin:s,acceptIncentive:o,shouldHighlightIncentive:i,updateOrdering:r,setIsOnboardingModalOpen:c})=>(0,y.jsx)(R.q6,{items:e,className:"settings-payment-gateways__list",setItems:r,children:e.map((e=>{switch(e._type){case a.PaymentProviderType.Suggestion:const r=e,l=t.includes(e.plugin.slug);return(0,y.jsx)(R.Uq,{id:r.id,children:K({extension:r,installingPlugin:n,setupPlugin:s,pluginInstalled:l,acceptIncentive:o,shouldHighlightIncentive:i})},r.id);case a.PaymentProviderType.Gateway:const d=e;return(0,y.jsx)(R.Uq,{id:e.id,children:Y({gateway:d,installingPlugin:n,acceptIncentive:o,shouldHighlightIncentive:i,setIsOnboardingModalOpen:c})},e.id);case a.PaymentProviderType.OfflinePmsGroup:const m=e;return(0,y.jsx)(R.Uq,{id:m.id,children:(0,y.jsx)("div",{id:m.id,className:"transitions-disabled woocommerce-list__item clickable-list-item enter-done",onClick:()=>{window.location.href=m.management._links.settings.href},children:(0,y.jsxs)("div",{className:"woocommerce-list__item-inner",children:[(0,y.jsxs)("div",{className:"woocommerce-list__item-before",children:[(0,y.jsx)(R.Gh,{}),(0,y.jsx)("img",{src:m.icon,alt:m.title+" logo"})]}),(0,y.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,y.jsx)("span",{className:"woocommerce-list__item-title",children:m.title}),(0,y.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:{__html:m.description}})]}),(0,y.jsx)("div",{className:"woocommerce-list__item-after centered no-buttons",children:(0,y.jsx)("div",{className:"woocommerce-list__item-after__actions",children:(0,y.jsx)("a",{className:"woocommerce-list__item-after__actions__arrow",href:m.management._links.settings.href,children:(0,y.jsx)(g.A,{icon:"chevron-right"})})})})]})})},m.id);default:return null}}))}),Q=({providers:e,installedPluginSlugs:t,installingPlugin:n,setupPlugin:s,acceptIncentive:o,shouldHighlightIncentive:l,updateOrdering:m,isFetching:p,businessRegistrationCountry:g,setBusinessRegistrationCountry:w,setIsOnboardingModalOpen:x})=>{var b;const{invalidateResolution:j}=(0,r.useDispatch)(a.paymentSettingsStore),{invalidateResolution:f}=(0,r.useDispatch)(a.woopaymentsOnboardingStore),[S,N]=(0,c.useState)(!1),k=(0,c.useRef)(null),T=(window.wcSettings?.admin?.preloadSettings?.general?.woocommerce_default_country||"US").split(":")[0],F=(0,c.useMemo)((()=>Object.entries(window.wcSettings.countries||[]).map((([e,t])=>({key:e,name:(0,h.decodeEntities)(t),types:[]}))).sort(((e,t)=>e.name.localeCompare(t.name)))),[]),I=T!==g,A=(0,C.A)("settings-payment-gateways__header-select-container",{"has-alert":I}),B=e=>{const t=e.target.closest(".settings-payment-gateways__header-select-container--indicator");k.current&&t!==k.current||N((e=>!e))};return(0,y.jsxs)("div",{className:"settings-payment-gateways",children:[(0,y.jsxs)("div",{className:"settings-payment-gateways__header",children:[(0,y.jsx)("div",{className:"settings-payment-gateways__header-title",children:(0,i.__)("Payment providers","woocommerce")}),(0,y.jsxs)("div",{className:A,children:[(0,y.jsx)(M,{className:"woocommerce-select-control__country",label:(0,i.__)("Business location:","woocommerce"),placeholder:"",value:null!==(b=F.find((e=>e.key===g)))&&void 0!==b?b:{key:"US",name:"United States (US)"},options:F,onChange:e=>{d()({path:a.WC_ADMIN_NAMESPACE+"/settings/payments/country",method:"POST",data:{location:e}}).then((()=>{const t=g,n=e;(0,_.recordEvent)("settings_payments_business_location_update",{old_location:t,new_location:n}),w(e),window.wcSettings.admin.woocommerce_payments_nox_profile&&(window.wcSettings.admin.woocommerce_payments_nox_profile.business_country_code=e),j("getPaymentProviders",[e]),f("getOnboardingData",[])}))}}),I&&(0,y.jsxs)("div",{className:"settings-payment-gateways__header-select-container--indicator",tabIndex:0,role:"button",ref:k,onClick:B,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||B(e)},children:[(0,y.jsx)("div",{className:"settings-payment-gateways__header-select-container--indicator-icon",children:(0,y.jsx)(E.A,{})}),S&&(0,y.jsx)(u.Popover,{className:"settings-payment-gateways__header-select-container--indicator-popover",placement:"top-end",offset:4,variant:"unstyled",focusOnMount:!0,noArrow:!0,shift:!0,onFocusOutside:()=>{N(!1)},children:(0,y.jsx)("div",{className:"components-popover__content-container",children:(0,y.jsx)("p",{children:(0,O.A)({mixedString:(0,i.__)("Your business location does not match your store location. {{link}}Edit store location.{{/link}}","woocommerce"),components:{link:(0,y.jsx)(v.Link,{href:(0,P.getAdminLink)("admin.php?page=wc-settings&tab=general"),target:"_blank",type:"external"})}})})})})]})]})]}),p?(0,y.jsx)(L.i,{rows:5}):(0,y.jsx)(X,{providers:e,installedPluginSlugs:t,installingPlugin:n,setupPlugin:s,acceptIncentive:o,shouldHighlightIncentive:l,updateOrdering:m,setIsOnboardingModalOpen:x})]})},J=({incentive:e,provider:t,onboardingUrl:n,onDismiss:o,onAccept:a,setupPlugin:r})=>{const[l,d]=(0,c.useState)(!1),[m,p]=(0,c.useState)(!1),[g,h]=(0,c.useState)(!1),w="wc_settings_payments__banner";return(0,s.useEffect)((()=>{(0,_.recordEvent)("settings_payments_incentive_show",{incentive_id:e.promo_id,provider_id:t.id,display_context:w})}),[e.promo_id,t.id]),l||(0,G.$8)(e,w)||m?null:(0,y.jsx)(u.Card,{className:"woocommerce-incentive-banner",isRounded:!0,children:(0,y.jsxs)("div",{className:"woocommerce-incentive-banner__content",children:[(0,y.jsx)("div",{className:"woocommerce-incentive-banner__image",children:(0,y.jsx)("img",{src:x.GZ+"images/settings-payments/incentives-illustration.svg",alt:(0,i.__)("Incentive illustration","woocommerce")})}),(0,y.jsxs)(u.CardBody,{className:"woocommerce-incentive-banner__body",children:[(0,y.jsx)(S,{status:"has_incentive",message:(0,i.__)("Limited time offer","woocommerce")}),(0,y.jsxs)("div",{className:"woocommerce-incentive-banner__copy",children:[(0,y.jsx)("h2",{children:e.title}),(0,y.jsx)("p",{children:e.description})]}),(0,y.jsx)("div",{className:"woocommerce-incentive-banner__terms",children:(0,c.createInterpolateElement)((0,i.__)("See <termsLink /> for details.","woocommerce"),{termsLink:(0,y.jsx)(v.Link,{href:e.tc_url,target:"_blank",rel:"noreferrer",type:"external",children:(0,i.__)("Terms and Conditions","woocommerce")})})}),(0,y.jsxs)("div",{className:"woocommerce-incentive-banner__actions",children:[(0,y.jsx)(u.Button,{variant:"primary",isBusy:l,disabled:l,onClick:()=>{var s;(0,_.recordEvent)("settings_payments_incentive_accept",{incentive_id:e.promo_id,provider_id:t.id,display_context:w}),h(!0),a(e.promo_id),o(e._links.dismiss.href,w),d(!0),r(t.id,t.plugin.slug,n,"not_installed"===t.plugin.status&&null!==(s=t._links?.attach?.href)&&void 0!==s?s:null),h(!1)},children:e.cta_label}),(0,y.jsx)(u.Button,{variant:"tertiary",isBusy:g,disabled:g,onClick:()=>{(0,_.recordEvent)("settings_payments_incentive_dismiss",{incentive_id:e.promo_id,provider_id:t.id,display_context:w}),h(!0),o(e._links.dismiss.href,w),h(!1),p(!0)},children:(0,i.__)("Dismiss","woocommerce")})]})]})]})})},ee=({incentive:e,provider:t,onboardingUrl:n,onAccept:o,onDismiss:a,setupPlugin:r})=>{const[l,d]=(0,c.useState)(!1),[m,p]=(0,c.useState)(!0),g="wc_settings_payments__modal",h=(0,G.$8)(e,g);(0,s.useEffect)((()=>{(0,_.recordEvent)("settings_payments_incentive_show",{incentive_id:e.promo_id,provider_id:t.id,display_context:g})}),[e.promo_id,t.id]);const w=()=>{p(!1)};return h?null:(0,y.jsx)(y.Fragment,{children:m&&(0,y.jsx)(u.Modal,{title:"",className:"woocommerce-incentive-modal",onRequestClose:()=>{(0,_.recordEvent)("settings_payments_incentive_dismiss",{incentive_id:e.promo_id,provider_id:t.id,display_context:g}),a(e._links.dismiss.href,g),w()},children:(0,y.jsx)(u.Card,{className:"woocommerce-incentive-modal__card",children:(0,y.jsxs)("div",{className:"woocommerce-incentive-modal__content",children:[(0,y.jsx)(u.CardMedia,{className:"woocommerce-incentive-modal__media",children:(0,y.jsx)("img",{src:x.GZ+"images/settings-payments/incentives-illustration.svg",alt:(0,i.__)("Incentive illustration","woocommerce")})}),(0,y.jsxs)(u.CardBody,{className:"woocommerce-incentive-modal__body",children:[(0,y.jsx)("div",{children:(0,y.jsx)(S,{status:"has_incentive",message:(0,i.__)("Limited time offer","woocommerce")})}),(0,y.jsx)("h2",{children:e.title}),(0,y.jsx)("p",{children:e.description}),(0,y.jsx)("p",{className:"woocommerce-incentive-modal__terms",children:(0,c.createInterpolateElement)((0,i.__)("See <termsLink /> for details.","woocommerce"),{termsLink:(0,y.jsx)(v.Link,{href:e.tc_url,target:"_blank",rel:"noreferrer",type:"external",children:(0,i.__)("Terms and Conditions","woocommerce")})})}),(0,y.jsx)("div",{className:"woocommerce-incentive-model__actions",children:(0,y.jsx)(u.Button,{variant:"primary",isBusy:l,disabled:l,onClick:()=>{var s;(0,_.recordEvent)("settings_payments_incentive_accept",{incentive_id:e.promo_id,provider_id:t.id,display_context:g}),d(!0),o(e.promo_id),a(e._links.dismiss.href,g),w(),r(t.id,t.plugin.slug,n,"not_installed"===t.plugin.status&&null!==(s=t._links?.attach?.href)&&void 0!==s?s:null),d(!1)},children:e.cta_label})})]})]})})})})};var te=n(33068),ne=n(93832);function se({setIsOpen:e,children:t}){return(0,y.jsx)(u.Modal,{className:"settings-payments-onboarding-modal",isFullScreen:!0,__experimentalHideHeader:!0,onRequestClose:()=>e(!1),shouldCloseOnClickOutside:!1,children:t})}const oe=()=>(0,y.jsx)("svg",{className:"stripe-spinner",width:"29",height:"29",viewBox:"0 0 29 29",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,y.jsx)("path",{d:"M14.3308 28.3333C14.0453 28.3333 13.7714 28.2199 13.5695 28.018C13.3675 27.816 13.2541 27.5422 13.2541 27.2566C13.2541 26.971 13.3675 26.6972 13.5695 26.4952C13.7714 26.2933 14.0453 26.1799 14.3308 26.1799C17.4727 26.1799 20.4859 24.9317 22.7076 22.7101C24.9293 20.4884 26.1774 17.4752 26.1774 14.3333C26.1774 11.1914 24.9293 8.17821 22.7076 5.95655C20.4859 3.73489 17.4727 2.48677 14.3308 2.48677C12.5754 2.48495 10.8416 2.87419 9.25541 3.62623C7.66923 4.37826 6.27049 5.4742 5.16082 6.83441C5.07124 6.94388 4.96097 7.03464 4.83631 7.1015C4.71165 7.16836 4.57504 7.21001 4.43428 7.22407C4.15001 7.25248 3.8661 7.16679 3.645 6.98587C3.42391 6.80494 3.28374 6.54359 3.25534 6.25932C3.22694 5.97505 3.31262 5.69114 3.49355 5.47005C4.80533 3.86303 6.45849 2.56827 8.33301 1.67977C10.2075 0.791267 12.2564 0.331321 14.3308 0.333319C22.0626 0.333319 28.3308 6.6015 28.3308 14.3333C28.3308 22.0651 22.0626 28.3333 14.3308 28.3333Z",fill:"#4F575D"})});function ie({label:e,isCompleted:t,isActive:n}){return(0,y.jsxs)("div",{className:(0,C.A)("settings-payments-onboarding-modal__sidebar--list-item",{"is-active":n,"is-completed":t}),children:[(0,y.jsx)("span",{className:"settings-payments-onboarding-modal__sidebar--list-item-icon",children:t?(0,y.jsx)("img",{src:x.GZ+"images/onboarding/icons/complete.svg",alt:(0,i.__)("Step completed","woocommerce")}):(0,y.jsx)("img",{src:x.GZ+"images/onboarding/icons/pending.svg",alt:(0,i.__)("Step active","woocommerce")})}),(0,y.jsx)("span",{className:"settings-payments-onboarding-modal__sidebar--list-item-label",children:e})]})}function ae({active:e,steps:t,includeSidebar:n=!1,sidebarTitle:s}){const o=t.find((t=>t.id===e));if(!o)return null;const a=t.findIndex((t=>t.id===e))+1;return(0,y.jsxs)(y.Fragment,{children:[n&&(0,y.jsxs)("div",{className:"settings-payments-onboarding-modal__sidebar",children:[(0,y.jsxs)("div",{className:"settings-payments-onboarding-modal__sidebar--header",children:[(0,y.jsx)("h2",{className:"settings-payments-onboarding-modal__sidebar--header-title",children:s}),(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__sidebar--header-steps",children:(0,i.sprintf)((0,i.__)("Step %1$s of %2$s","woocommerce"),a,t.length)})]}),(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__sidebar--list",children:t.map((n=>(0,y.jsx)(ie,{label:n.label,isCompleted:"completed"===n.status||a===t.length,isActive:n.id===e},n.id)))})]}),(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__content",children:(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__step",id:o.id,children:o.content})})]})}var re=n(47804);function ce({onClose:e}){return(0,y.jsxs)("div",{className:"settings-payments-onboarding-modal__header",children:[(0,y.jsx)("img",{src:`${x.GZ}images/woo-logo.svg`,alt:"Woo Logo",className:"settings-payments-onboarding-modal__header--logo"}),(0,y.jsx)(u.Button,{className:"settings-payments-onboarding-modal__header--close",onClick:e,children:(0,y.jsx)(u.Icon,{icon:re.A})})]})}const le=()=>{const{currentStep:e,closeModal:t}=tt(),[n,s]=(0,c.useState)(!1);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ce,{onClose:t}),(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__step--content",children:(0,y.jsxs)("div",{className:"settings-payments-onboarding-modal__step--content-jetpack",children:[(0,y.jsx)("h1",{className:"settings-payments-onboarding-modal__step--content-jetpack-title",children:(0,i.__)("Connect to WordPress.com","woocommerce")}),(0,y.jsx)("p",{className:"settings-payments-onboarding-modal__step--content-jetpack-description",children:(0,i.__)("You’ll be briefly redirected to connect your store to your WordPress.com account and unlock the full features and functionality of WooPayments","woocommerce")}),(0,y.jsx)(u.Button,{variant:"primary",className:"settings-payments-onboarding-modal__step--content-jetpack-button",isBusy:n,disabled:n,onClick:()=>{var t;s(!0),window.location.href=null!==(t=e?.actions?.auth?.href)&&void 0!==t?t:""},children:(0,i.__)("Connect","woocommerce")})]})})]})};var de=n(66087);const me=(e={})=>{const[t,n]=(0,s.useState)(e),[o,i]=(0,s.useState)({}),[a,r]=(0,s.useState)({});return{data:t,setData:e=>n((t=>({...t,...e}))),errors:o,setErrors:e=>i((t=>(0,de.omitBy)({...t,...e},de.isNil))),touched:a,setTouched:e=>r((t=>({...t,...e})))}},_e=(0,s.createContext)(null),ue=({children:e,initialData:t})=>(0,y.jsx)(_e.Provider,{value:me(t),children:e}),pe=()=>{const e=(0,s.useContext)(_e);if(!e)throw new Error("useBusinessVerificationContext() must be used within <BusinessVerificationContextProvider>");return e},ge=(0,s.createContext)(null),he=({children:e,...t})=>{const n=(e=>e.reduce(((e,t,n)=>{var s;return o().isValidElement(t)&&(e[null!==(s=t.props.name)&&void 0!==s?s:n]=t),e}),{}))(e),i=(({steps:e,initialStep:t,onStepChange:n,onComplete:o,onExit:i})=>{const a=Object.keys(e),{currentStep:r}=tt(),[c,l]=(0,s.useState)(null!=t?t:a[0]);if("completed"===r?.context?.sub_steps[c]?.status){const e=a.indexOf(c),t=a[e+1];l(t)}const d=(a.indexOf(c)+1)/a.length;return{currentStep:c,progress:d,nextStep:()=>{const e=a.indexOf(c),t=a[e+1];t?(l(t),n?.(t)):o?.()},prevStep:()=>{const e=a.indexOf(c),t=a[e-1];t?(l(t),n?.(t)):i?.()},exit:()=>i?.()}})({steps:n,...t}),a=n[i.currentStep];return(0,y.jsx)(ge.Provider,{value:i,children:a})},ye=()=>{const e=(0,s.useContext)(ge);if(!e)throw new Error("useStepperContext() must be used within <Stepper>");return e},we=e=>e?.name||"",ve=({selectedItem:e},{type:t,changes:n,props:{items:s}})=>{switch(t){case T.WM.stateChangeTypes.ToggleButtonKeyDownArrowDown:return{selectedItem:s[e?Math.min(s.indexOf(e)+1,s.length-1):0]};case T.WM.stateChangeTypes.ToggleButtonKeyDownArrowUp:return{selectedItem:s[e?Math.max(s.indexOf(e)-1,0):s.length-1]};default:return n}},xe=function({name:e,className:t,label:n,describedBy:s,options:o,onChange:a,value:r,placeholder:l,children:d}){const{getLabelProps:m,getToggleButtonProps:_,getMenuProps:p,getItemProps:g,isOpen:h,highlightedIndex:w,selectedItem:v}=(0,T.WM)({initialSelectedItem:o[0],items:o,itemToString:we,onSelectedItemChange:a,selectedItem:r||{},stateReducer:ve}),x=we(v),b=p({className:"components-custom-select-control__menu","aria-hidden":!h}),f=(0,c.useCallback)((e=>{e.stopPropagation(),b?.onKeyDown?.(e)}),[b]);return b["aria-activedescendant"]?.startsWith("downshift-null")&&delete b["aria-activedescendant"],(0,y.jsxs)("div",{className:(0,C.A)("woopayments components-custom-select-control",t),children:[(0,y.jsx)("label",{...m({className:"components-custom-select-control__label"}),children:n}),(0,y.jsxs)(u.Button,{..._({"aria-label":n,"aria-labelledby":void 0,"aria-describedby":s||(x?(0,i.sprintf)((0,i.__)("Currently selected: %s","woocommerce"),x):(0,i.__)("No selection","woocommerce")),className:(0,C.A)("components-custom-select-control__button",{placeholder:!x}),name:e}),children:[(0,y.jsx)("span",{className:"components-custom-select-control__button-value",children:x||l}),(0,y.jsx)(j.A,{icon:I.A,className:"components-custom-select-control__button-icon"})]}),(0,y.jsx)("ul",{...b,onKeyDown:f,children:h&&o.map(((e,t)=>(0,y.jsxs)("li",{...g({item:e,index:t,className:(0,C.A)(e.className,"components-custom-select-control__item",{"is-highlighted":t===w}),style:e.style}),children:[d?d(e):e.name,e===v&&(0,y.jsx)(j.A,{icon:A.A,className:"components-custom-select-control__item-icon"})]},e.key)))})]})};var be=n(56537);const je=({name:e,className:t,label:n,options:o,onChange:a,value:r,placeholder:c,searchable:l})=>{const d=(0,s.useRef)(null),m=(0,s.useRef)(),_=o.filter((e=>e.items?.length)).map((e=>e.key)),[u,p]=(0,s.useState)(new Set([_[0]])),[g,h]=(0,s.useState)(new Set([..._,...o[0]?.items||[]])),[w,v]=(0,s.useState)(""),x=o.filter((e=>g.has(e.key))),{isOpen:b,selectedItem:f,getToggleButtonProps:S,getMenuProps:N,getLabelProps:k,highlightedIndex:P,getItemProps:E}=(0,T.WM)({items:x,itemToString:e=>e?.name||"",selectedItem:r||{},onSelectedItemChange:a,stateReducer:(e,{changes:t,type:n})=>{if(l&&n===T.WM.stateChangeTypes.ToggleButtonKeyDownArrowDown)return e;if(t.selectedItem&&t.selectedItem.items){if(w)return e;const n=t.selectedItem.key;return u.has(n)?(u.delete(n),t.selectedItem.items.forEach((e=>g.delete(e)))):(u.add(n),t.selectedItem.items.forEach((e=>g.add(e)))),p(u),h(g),e}return t}}),O=N({className:"components-grouped-select-control__list","aria-hidden":!b,onFocus:()=>d.current?.focus(),onBlur:e=>{e.relatedTarget===d.current&&(e.nativeEvent.preventDownshiftDefault=!0)},onKeyDown:e=>{"Space"===e.code&&(e.nativeEvent.preventDownshiftDefault=!0)}});return(0,y.jsxs)("div",{className:(0,C.A)("woopayments components-grouped-select-control",t),children:[(0,y.jsx)("label",{...k({className:"components-grouped-select-control__label"}),children:n}),(0,y.jsxs)("button",{...S({type:"button",className:(0,C.A)("components-text-control__input components-grouped-select-control__button",{placeholder:!f?.name}),name:e}),children:[(0,y.jsx)("span",{className:"components-grouped-select-control__button-value",children:f?.name||c}),(0,y.jsx)(j.A,{icon:I.A,className:"components-grouped-select-control__button-icon"})]}),(0,y.jsx)("ul",{...O,children:b&&(0,y.jsxs)(y.Fragment,{children:[l&&(0,y.jsx)("input",{className:"components-grouped-select-control__search",ref:d,type:"text",value:w,onChange:({target:e})=>{if(m.current||(m.current={visibleItems:g}),""===e.value)h(m.current.visibleItems),m.current=void 0;else{const t=o.filter((t=>t?.group&&`${t.name} ${t.context||""}`.toLowerCase().includes(e.value.toLowerCase()))),n=t.map((e=>e?.group||"")),s=new Set([...t.map((e=>e.key)),...n]);h(s)}v(e.value)},tabIndex:-1,placeholder:(0,i.__)("Search…","woocommerce")}),(0,y.jsx)("div",{className:"components-grouped-select-control__list-container",children:x.map(((e,t)=>{const n=!!e.items;return(0,y.jsxs)("li",{...E({item:e,index:t,className:(0,C.A)("components-grouped-select-control__item",e.className,{"is-highlighted":t===P},{"is-group":n})}),children:[(0,y.jsx)("div",{className:"components-grouped-select-control__item-content",children:e.name}),e.key===f?.key&&(0,y.jsx)(j.A,{icon:A.A}),!w&&n&&(0,y.jsx)(j.A,{icon:u.has(e.key)?be.A:I.A})]},e.key)}))})]})})]})},fe=(e,t,n)=>{const{error:s,...o}=t;return s?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(e,{...o,ref:n,className:(0,C.A)(o.className,"has-error")}),(0,y.jsx)("div",{className:"components-form-field__error",children:s})]}):(0,y.jsx)(e,{...o,ref:n})},Se=((0,s.forwardRef)(((e,t)=>fe(u.TextControl,e,t))),e=>fe(xe,e)),Ne=e=>fe(je,e),ke={generic:{individual:(0,i.__)("Select if you run your own business as an individual and are self-employed","woocommerce"),company:(0,i.__)("Select if you filed documentation to register your business with a government agency","woocommerce"),non_profit:(0,i.__)("Select if you run a non-business entity","woocommerce"),government_entity:(0,i.__)("Select if your business is classed as a government entity","woocommerce")},US:{individual:(0,i.__)("Select if you run your own business as an individual and are self-employed","woocommerce"),company:(0,i.__)("Select if you filed documentation to register your business with a government agency","woocommerce"),non_profit:(0,i.__)("Select if you have been granted tax-exempt status by the Internal Revenue Service (IRS)","woocommerce"),government_entity:(0,i.__)("Select if your business is classed as a government entity","woocommerce")}},Ce=e=>{const t=window.wcSettings.admin?.onboarding?.profile?.industry?.[0];if(t)return e[t]},Pe=()=>{const{woocommerce_share_key:e,woocommerce_coming_soon:t,woocommerce_private_link:n}=window.wcSettings?.admin?.siteVisibilitySettings||{};return"yes"!==t||"no"===n?"":e?"?woo-share="+e:""},Ee={steps:{activate:{heading:(0,i.__)("Start accepting real payments","woocommerce"),subheading:(0,O.A)({mixedString:(0,i.__)("You are currently testing payments on your store. To activate real payments, you will need to provide some additional details about your business. {{link}}Learn more{{/link}}.","woocommerce"),components:{link:(0,y.jsx)("a",{rel:"external noopener noreferrer",target:"_blank",href:"https://woocommerce.com/document/woopayments/startup-guide/#sign-up-process"})}}),cta:(0,i.__)("Activate payments","woocommerce")},business:{heading:(0,i.__)("Let’s get your store ready to accept payments","woocommerce"),subheading:(0,i.__)("We’ll use these details to enable payments for your store. This information can’t be changed after your account is created.","woocommerce")},store:{heading:(0,i.__)("Please share a few more details","woocommerce"),subheading:(0,i.__)("This info will help us speed up the set up process.","woocommerce")},loading:{heading:(0,i.__)("One last step! Verify your identity with our partner","woocommerce"),subheading:(0,i.__)("This will take place in a secure environment through our partner. Once your business details are verified, you’ll be redirected back to your store dashboard.","woocommerce"),cta:(0,i.__)("Finish your verification process","woocommerce")},embedded:{heading:(0,i.__)("One last step! Verify your identity with our partner","woocommerce"),subheading:(0,i.__)("This info will verify your account","woocommerce")}},fields:{country:(0,i.__)("Where is your business located?","woocommerce"),business_type:(0,i.__)("What type of legal entity is your business?","woocommerce"),"company.structure":(0,i.__)("What category of legal entity identify your business?","woocommerce"),mcc:(0,i.__)("What type of goods or services does your business sell? ","woocommerce")},errors:{generic:(0,i.__)("Please provide a response","woocommerce"),country:(0,i.__)("Please provide a country","woocommerce"),business_type:(0,i.__)("Please provide a business type","woocommerce"),mcc:(0,i.__)("Please provide a type of goods or services","woocommerce")},placeholders:{generic:(0,i.__)("Select an option","woocommerce"),country:(0,i.__)("Select a country","woocommerce")},tos:(0,O.A)({mixedString:(0,i.sprintf)((0,i.__)("By using %1$s, you agree to be bound by our {{tosLink}}Terms of Service{{/tosLink}} (including {{merchantTermsLink}}%2$s merchant terms{{/merchantTermsLink}}) and acknowledge that you have read our {{privacyPolicyLink}}Privacy Policy{{/privacyPolicyLink}}.","woocommerce"),"WooPayments","WooPay"),components:{tosLink:(0,y.jsx)("a",{rel:"external noopener noreferrer",target:"_blank",href:"https://wordpress.com/tos/"}),merchantTermsLink:(0,y.jsx)("a",{rel:"external noopener noreferrer",target:"_blank",href:"https://wordpress.com/tos/#more-woopay-specifically"}),privacyPolicyLink:(0,y.jsx)("a",{rel:"external noopener noreferrer",target:"_blank",href:"https://automattic.com/privacy/"})}}),inlineNotice:{title:(0,i.__)("Business Location:","woocommerce"),action:(0,i.__)("Change","woocommerce")},continue:(0,i.__)("Continue","woocommerce"),back:(0,i.__)("Back","woocommerce"),cancel:(0,i.__)("Cancel","woocommerce")},Oe=e=>{const{data:t,errors:n,setErrors:o,touched:i,setTouched:a}=pe(),r=(n=t[e])=>{i[e]||a({[e]:!0});const s=((e,t)=>!!t)(0,n)?void 0:Ee.errors[e]||Ee.errors.generic;o({[e]:s})};return(0,s.useEffect)((()=>(r(),t[e]||a({[e]:!1}),()=>o({[e]:void 0}))),[]),{validate:r,error:()=>i[e]?n[e]:void 0}},Te=({children:e})=>{const{data:t,errors:n,touched:s,setTouched:o}=pe(),{currentStep:i}=tt(),{nextStep:a}=ye();return(0,y.jsxs)("form",{onSubmit:e=>{e.preventDefault(),(()=>{var e,r;if((0,de.isEmpty)(n)&&(e=>["business_type","country","mcc"].every((t=>Boolean(e[t]))))(t))return((e,t,n)=>{t&&d()({url:t,method:"POST",data:{sub_steps:{...n,[e]:{status:"completed"}}}})})("business",null!==(e=i?.actions?.save?.href)&&void 0!==e?e:void 0,null!==(r=i?.context?.sub_steps)&&void 0!==r?r:{}),a();o((0,de.mapValues)(s,(()=>!0)))})()},children:[e,(0,y.jsx)(u.Button,{variant:"primary",type:"submit",className:"stepper__cta",children:Ee.continue})]})},Fe=({onChange:e,...t})=>{var n;const{name:s}=t,{data:o,setData:i}=pe(),{validate:a,error:r}=Oe(s);return(0,y.jsx)(Se,{label:Ee.fields[s],value:t.options?.find((e=>e.key===o[s])),placeholder:null!==(n=Ee.placeholders[s])&&void 0!==n?n:Ee.placeholders.generic,onChange:({selectedItem:t})=>{e?e?.(s,t):i({[s]:t?.key}),a(t?.key)},options:[],error:r(),...t})},Ie=({onChange:e,...t})=>{var n;const{name:s}=t,{data:o,setData:i}=pe(),{validate:a,error:r}=Oe(s);return(0,y.jsx)(Ne,{label:Ee.fields[s],value:t.options?.find((e=>e.key===o[s])),placeholder:null!==(n=Ee.placeholders[s])&&void 0!==n?n:Ee.placeholders.generic,onChange:({selectedItem:t})=>{e?e?.(s,t):i({[s]:t?.key}),a(t?.key)},options:[],error:r(),...t})},Ae=()=>{var e;const{data:t,setData:n}=pe(),{currentStep:s}=tt(),o=(e=>Object.entries(e||[]).map((([e,t])=>({key:e,name:t,types:[]}))).sort(((e,t)=>e.name.localeCompare(t.name))))(s?.context?.fields?.available_countries||{}),i=(e=>(e||[]).map((e=>({...e,types:e.types.map((t=>({...t,description:ke[e.key]?ke[e.key][t.key]:ke.generic[t.key]})))}))).sort(((e,t)=>e.name.localeCompare(t.name)))||[])(s?.context?.fields?.business_types||[]),a=((null!==(e=s?.context?.fields?.mccs_display_tree)&&void 0!==e?e:[])||[]).filter((e=>!!e?.items&&(e.items?.filter((e=>!e?.items))||[]).length)).reduce(((e,t)=>{const n=t.items?.map((e=>({key:e.id,name:e.title,group:t.id,context:e?.keywords?e.keywords.join(" "):""})))||[];return[...e,{key:t.id,name:t.title,items:n.map((e=>e.key))},...n]}),[]),r=i.find((e=>"PR"===t.country?"US"===e.key:e.key===t.country)),c=r?.types.sort(((e,t)=>"company"===e.key?-1:"company"===t.key?1:0)),l=c?.find((e=>e.key===t.business_type)),m=0===l?.structures.length||l?.structures.find((e=>e.key===t["company.structure"])),_=e=>{const t=s?.actions?.save?.href;t&&d()({url:t,method:"POST",data:{self_assessment:e}})},u=(e,t)=>{let s={[e]:t?.key};"business_type"===e?s={...s,"company.structure":void 0}:"country"===e&&(s={...s,business_type:void 0}),n(s),_(s)};return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{"data-testid":"country-select",children:(0,y.jsx)(Fe,{name:"country",options:o,onChange:u})}),r&&r.types.length>0&&(0,y.jsx)("span",{"data-testid":"business-type-select",children:(0,y.jsx)(Fe,{name:"business_type",options:r.types,onChange:u,children:e=>(0,y.jsxs)("div",{children:[(0,y.jsx)("div",{children:e.name}),(0,y.jsx)("div",{className:"complete-business-info-task__option-description",children:e.description})]})})}),l&&l.structures.length>0&&(0,y.jsx)("span",{"data-testid":"business-structure-select",children:(0,y.jsx)(Fe,{name:"company.structure",options:l.structures,onChange:u})}),r&&l&&m&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("span",{"data-testid":"mcc-select",children:(0,y.jsx)(Ie,{name:"mcc",options:a,onChange:(e,s)=>{n({[e]:s?.key});const o={...t,[e]:s?.key};_(o)},searchable:!0})}),(0,y.jsx)("span",{className:"woopayments-onboarding__tos",children:Ee.tos})]})]})};var Be=n(20195),De=n(94736),Me=n(92991),Le=n(8181);A.A,Me.A,De.A,f.A;const Re=({children:e,actions:t=[],className:n,status:s="info",isDismissible:o=!0,onRemove:a})=>{((e,t)=>{const n="string"==typeof t?t:(0,c.renderToString)(t),s="error"===e?"assertive":"polite";(0,c.useEffect)((()=>{n&&(0,Be.speak)(n,s)}),[n,s])})(s,e);const r=(0,C.A)(n,"woopayments-banner-notice","is-"+s);return(0,y.jsxs)("div",{className:r,children:[(0,y.jsxs)("div",{className:"woopayments-banner-notice__content",children:[e,t.length>0&&(0,y.jsx)("div",{className:"woopayments-banner-notice__actions",children:t.map((({className:e,label:t,variant:n,onClick:s,url:o,urlTarget:i},a)=>{let r=n;return"primary"!==n&&(r=o?"link":"secondary"),(0,y.jsx)(u.Button,{href:o,variant:r,onClick:o?void 0:s,className:e,target:i,children:t},a)}))})]}),o&&(0,y.jsx)(u.Button,{className:"woopayments-banner-notice__dismiss",icon:(0,y.jsx)(Le.A,{}),label:(0,i.__)("Dismiss this notice","woocommerce"),onClick:()=>a?.(),showTooltip:!1})]})};var We=n(2929),He=n(86948);const Ue={variables:{colorPrimary:"#873EFF",colorBackground:"#FFFFFF",buttonPrimaryColorBackground:"#3858E9",buttonPrimaryColorBorder:"#3858E9",buttonPrimaryColorText:"#FFFFFF",buttonSecondaryColorBackground:"#FFFFFF",buttonSecondaryColorBorder:"#3858E9",buttonSecondaryColorText:"#3858E9",colorText:"#101517",colorSecondaryText:"#50575E",actionPrimaryColorText:"#3858E9",actionSecondaryColorText:"#101517",colorBorder:"#DDDDDD",formHighlightColorBorder:"#3858E9",formAccentColor:"#3858E9",colorDanger:"#CC1818",offsetBackgroundColor:"#F0F0F0",formBackgroundColor:"#FFFFFF",badgeNeutralColorText:"#2C3338",badgeNeutralColorBackground:"#F6F7F7",badgeNeutralColorBorder:"#F6F7F7",badgeSuccessColorText:"#005C12",badgeSuccessColorBackground:"#EDFAEF",badgeSuccessColorBorder:"#EDFAEF",badgeWarningColorText:"#614200",badgeWarningColorBackground:"#FCF9E8",badgeWarningColorBorder:"#FCF9E8",badgeDangerColorText:"#8A2424",badgeDangerColorBackground:"#FCF0F1",badgeDangerColorBorder:"#FCF0F1",borderRadius:"2px",buttonBorderRadius:"2px",formBorderRadius:"2px",badgeBorderRadius:"2px",overlayBorderRadius:"8px",spacingUnit:"10px",fontFamily:"-apple-system, BlinkMacSystemFont, 'system-ui', 'Segoe UI', 'Helvetica Neue', 'Helvetica', 'Roboto', 'Arial', sans-serif",fontSizeBase:"16px",headingXlFontSize:"32px",headingXlFontWeight:"400",headingLgFontSize:"24px",headingLgFontWeight:"400",headingMdFontSize:"20px",headingMdFontWeight:"400",headingSmFontSize:"13px",headingSmFontWeight:"600",headingXsFontSize:"12px",headingXsFontWeight:"600",bodyMdFontWeight:"400",bodyMdFontSize:"16px",bodySmFontSize:"13px",bodySmFontWeight:"400",labelSmFontSize:"12px",labelSmFontWeight:"200",labelMdFontSize:"13px"}},Ge=({onboardingData:e,onExit:t,onLoaderStart:n,onLoadError:o,onStepChange:a,collectPayoutRequirements:r=!1})=>{const{stripeConnectInstance:c,initializationError:l}=(e=>{const[t,n]=(0,s.useState)(null),{currentStep:o}=tt(),[a,r]=(0,s.useState)(null),[c,l]=(0,s.useState)(!0);return(0,s.useEffect)((()=>{(async()=>{try{var t;const s=await(async(e,t)=>{const n=(s=e,(0,de.toPairs)(s).reduce(((e,[t,n])=>null!==n?(0,de.set)(e,t,n):e),{}));var s;const o={};return Object.keys(n).length>0&&(o.self_assessment=n),await d()({url:t,method:"POST",data:o})})(e,null!==(t=o?.actions?.kyc_session?.href)&&void 0!==t?t:""),{clientSecret:a,publishableKey:r}=s.session;if(!r)throw new Error((0,i.__)("Unable to start onboarding. If this problem persists, please contact support.","woocommerce"));const c=(0,We.e)({publishableKey:r,fetchClientSecret:async()=>a,appearance:{overlays:"drawer",...Ue},locale:s.session.locale.replace("_","-")});n(c)}catch(e){r(e instanceof Error?e.message:(0,i.__)("Unable to start onboarding. If this problem persists, please contact support.","woocommerce"))}finally{l(!1)}})()}),[e]),{stripeConnectInstance:t,initializationError:a,loading:c}})(e);return(0,y.jsxs)(y.Fragment,{children:[l&&(0,y.jsx)(Re,{status:"error",children:l}),c&&(0,y.jsx)(He.MT,{connectInstance:c,children:(0,y.jsx)(He.hw,{onLoaderStart:n,onLoadError:o,onExit:t,onStepChange:e=>a?.(e.step),collectionOptions:{fields:r?"eventually_due":"currently_due",futureRequirements:"omit"}})})]})},qe=({collectPayoutRequirements:e=!1})=>{var t;const{data:n}=pe(),{currentStep:o,navigateToNextStep:a}=tt(),[r,c]=(0,s.useState)(!1),[l,m]=(0,s.useState)(!0),[_,u]=(0,s.useState)(null),p=null!==(t=o?.actions?.kyc_fallback?.href)&&void 0!==t?t:"";return(0,y.jsxs)(y.Fragment,{children:[_&&("invalid_request_error"===_.error.type?(0,y.jsx)(Re,{className:"woopayments-banner-notice--embedded-kyc",status:"warning",isDismissible:!1,actions:[{label:"Learn more",variant:"primary",url:"https://woocommerce.com/document/woopayments/startup-guide/#requirements",urlTarget:"_blank"},{label:"Cancel",variant:"link",url:p}],children:(0,i.__)("Payment activation through our financial partner requires HTTPS and cannot be completed.","woocommerce")}):(0,y.jsx)(Re,{className:"woopayments-banner-notice--embedded-kyc",status:"error",isDismissible:!1,children:_.error.message})),l&&(0,y.jsx)("div",{className:"embedded-kyc-loader-wrapper padded",children:(0,y.jsx)(oe,{})}),r&&(0,y.jsx)("div",{className:"embedded-kyc-loader-wrapper",children:(0,y.jsx)(oe,{})}),(0,y.jsx)(Ge,{onExit:async()=>{c(!0);try{var e;(await(async e=>await d()({url:e,method:"POST",data:{}}))(null!==(e=o?.actions?.kyc_session_finish?.href)&&void 0!==e?e:"")).success?a():window.location.href=p}catch(e){window.location.href=p}},onStepChange:()=>{},onLoaderStart:()=>m(!1),onLoadError:e=>{u(e)},onboardingData:n,collectPayoutRequirements:e})]})},ze=()=>{const{nextStep:e}=ye(),[t,n]=(0,s.useState)(!1);return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("h1",{className:"stepper__heading",children:Ee.steps.activate.heading}),(0,y.jsx)("p",{className:"stepper__subheading",children:Ee.steps.activate.subheading}),(0,y.jsx)("div",{className:"stepper__content",children:(0,y.jsx)(u.Button,{variant:"primary",className:"stepper__cta",onClick:()=>{n(!0),(0,G.AC)().then((()=>(n(!1),e()))).catch((()=>{n(!1)}))},isBusy:t,disabled:t,children:Ee.steps.activate.cta})})]})},$e=({name:e,children:t,showHeading:n=!0})=>(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)("div",{className:"stepper__wrapper",children:[n&&(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)("h1",{className:"stepper__heading",children:Ee.steps[e].heading}),(0,y.jsx)("h2",{className:"stepper__subheading",children:Ee.steps[e].subheading})]}),(0,y.jsx)("div",{className:"stepper__content",children:t})]})}),Ke=()=>{var e,t,n;const{currentStep:s,closeModal:o}=tt(),i={business_name:window.wcSettings?.siteTitle,mcc:Ce(null!==(e=s?.context?.fields?.mccs_display_tree)&&void 0!==e?e:[]),site:"localhost"===location.hostname?"https://wcpay.test":window.wcSettings?.homeUrl+Pe(),country:(window.wcSettings?.admin?.preloadSettings?.general?.woocommerce_default_country||"US").split(":")[0],...null!==(t=s?.context?.self_assessment)&&void 0!==t?t:{}},a=null!==(n=s?.context?.has_test_account)&&void 0!==n&&n;return(0,y.jsxs)("div",{className:"settings-payments-onboarding-modal__step-business-verification",children:[(0,y.jsx)(ce,{onClose:o}),(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__step-business-verification-content",children:(0,y.jsx)(ue,{initialData:i,children:(0,y.jsxs)(he,{onStepChange:()=>window.scroll(0,0),onExit:()=>{},children:[a&&(0,y.jsx)($e,{name:"activate",showHeading:!1,children:(0,y.jsx)(ze,{})}),(0,y.jsx)($e,{name:"business",children:(0,y.jsx)(Te,{children:(0,y.jsx)(Ae,{})})}),(0,y.jsx)($e,{name:"embedded",showHeading:!1,children:(0,y.jsx)(qe,{})})]})})})]})};var Ze=n(1275);function Ve(){const{currentStep:e,navigateToNextStep:t,closeModal:n}=tt(),[s,o]=(0,c.useState)(!1),[a,r]=(0,c.useState)({}),[l,m]=(0,c.useState)(null),[p,g]=(0,c.useState)(!1),h=e?.context?.pms_state,w=e?.context?.recommended_pms,v=(0,c.useMemo)((()=>w?(0,G.js)(w):[]),[w]),x=(0,c.useRef)(null),[b,j]=(0,c.useState)(!1);(0,c.useEffect)((()=>{h&&r(h)}),[h]);const f=(0,c.useMemo)((()=>(0,G.LI)(a)),[a]);(0,c.useEffect)((()=>{if(null===l&&v.length>0&&Object.keys(f).length>0&&v.every((e=>void 0!==f[e.id]))){const e={};v.forEach((t=>{e[t.id]=(0,G.TO)(t,f[t.id])})),m(e)}}),[v,f,l]);const S=(0,c.useMemo)((()=>!l||s?0:v.filter((e=>{var t;return!(null!==(t=l[e.id])&&void 0!==t&&t)})).length),[v,s,l]),N=t=>{r(t);const n=e?.actions?.save?.href;n&&d()({url:n,method:"POST",data:{payment_methods:(0,G.v)(t)}})},k=()=>{const e=x.current;e&&j(e.scrollHeight>e.clientHeight)};return(0,c.useEffect)((()=>{const e=setTimeout((()=>{k()}),0);return window.addEventListener("resize",k),()=>{clearTimeout(e),window.removeEventListener("resize",k)}}),[]),(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__step--content",children:(0,y.jsxs)("div",{className:"woocommerce-layout__header woocommerce-recommended-payment-methods",children:[(0,y.jsxs)("div",{className:"woocommerce-layout__header-wrapper",children:[(0,y.jsxs)("div",{className:"woocommerce-layout__header-title-and-close",children:[(0,y.jsx)("h1",{className:"components-truncate components-text woocommerce-layout__header-heading woocommerce-layout__header-left-align woocommerce-settings-payments-header__title",children:(0,i.__)("Choose your payment methods","woocommerce")}),(0,y.jsx)(u.Button,{className:"settings-payments-onboarding-modal__header--close",onClick:n,children:(0,y.jsx)(u.Icon,{icon:re.A})})]}),(0,y.jsx)("div",{className:"woocommerce-settings-payments-header__description",children:(0,i.__)("Select which payment methods you'd like to offer to your shoppers. You can update these at any time.","woocommerce")})]}),(0,y.jsx)("div",{className:"woocommerce-recommended-payment-methods__list",children:(0,y.jsxs)("div",{className:"settings-payments-methods__container",ref:x,children:[(0,y.jsx)("div",{className:"woocommerce-list",children:v?.map((e=>{var t;return(0,y.jsx)(Ze.v,{method:e,paymentMethodsState:(0,G.LI)(a),setPaymentMethodsState:e=>{r(e),N(e)},initialVisibilityStatus:l&&null!==(t=l[e.id])&&void 0!==t?t:null,isExpanded:s},e.id)}))}),!s&&S>0&&(0,y.jsx)("div",{className:"settings-payments-methods__show-more--wrapper",children:(0,y.jsx)(u.Button,{className:"settings-payments-methods__show-more",onClick:()=>{o(!s),setTimeout((()=>{k()}),0)},tabIndex:0,"aria-expanded":s,children:(0,i.sprintf)((0,i.__)("Show more (%s)","woocommerce"),S)})})]})}),(0,y.jsx)("div",{className:(0,C.A)("woocommerce-recommended-payment-methods__list_footer",{"has-border":b}),children:(0,y.jsx)(u.Button,{className:"components-button is-primary",onClick:()=>{const n=e?.actions?.finish?.href;n&&(N(a),g(!0),d()({url:n,method:"POST"}).then((()=>{var e;(0,_.recordEvent)("wcpay_settings_payment_methods_continue",{displayed_payment_methods:Object.keys(a).join(", "),selected_payment_methods:Object.keys(a).filter((e=>a[e])).join(", "),deselected_payment_methods:Object.keys(a).filter((e=>!a[e])).join(", "),store_country:null!==(e=window.wcSettings?.admin?.woocommerce_payments_nox_profile?.business_country_code)&&void 0!==e?e:"unknown"}),g(!1),t()})))},isBusy:p,disabled:p,children:(0,i.__)("Continue","woocommerce")})})]})})}const Ye=({progress:e,message:t})=>(0,y.jsx)(W.Loader,{className:"woocommerce-payments-test-account-step__preloader",children:(0,y.jsxs)(W.Loader.Layout,{className:"woocommerce-payments-test-account-step__preloader-layout",children:[(0,y.jsx)(W.Loader.Illustration,{children:(0,y.jsx)("img",{src:`${x.GZ}images/onboarding/test-account-setup.svg`,alt:"setup",style:{maxWidth:"223px"}})}),(0,y.jsx)(W.Loader.Title,{children:(0,i.__)("Finishing payments setup","woocommerce")}),(0,y.jsx)(W.Loader.ProgressBar,{progress:null!=e?e:0}),(0,y.jsx)(W.Loader.Sequence,{interval:0,children:t||(0,i.__)("In just a few moments, you'll be ready to test payments on your store.","woocommerce")})]})}),Xe=()=>{const{currentStep:e,navigateToNextStep:t,closeModal:n,refreshStoreData:o}=tt(),[a,r]=(0,s.useState)("idle"),[c,l]=(0,s.useState)(20),[_,p]=(0,s.useState)(),[g,h]=(0,s.useState)(0),[w,b]=(0,s.useState)(0),j=(0,s.useRef)(null),f=(0,s.useRef)(null),S=()=>{null!==j.current&&(clearTimeout(j.current),j.current=null)},N=(0,s.useCallback)((()=>{r("idle"),l(0),p(void 0),h(0),f.current=null,S()}),[r,l,p,h]);return(0,s.useEffect)((()=>{if("idle"===a){const t=e?.errors?.[0];if(t)return p(t),void r("error");if("completed"===e?.status)return r("success"),void l(100);"not_started"===e?.status?(r("initializing"),d()({url:e?.actions?.init?.href,method:"POST"}).then((e=>{e?.success?r("polling"):(p(e?.message||(0,i.__)("Creating test account failed. Please try again.","woocommerce")),r("error"))})).catch((e=>{p(e.message),r("error")}))):r("polling")}if("polling"===a){const t=()=>{S(),d()({url:e?.actions?.check?.href,method:"POST"}).then((e=>{if("completed"===e?.status)return void(j.current=window.setTimeout((()=>{r("success"),l(100)}),1e3));let n=g,s=3e3,o=0;l((e=>(o=0===g?Math.min(e+5,90):1===g?Math.min(e+1,96):e,o))),0===g&&o>=90?(n=1,s=5e3,f.current=Date.now()):1===g?f.current&&Date.now()-f.current>3e4?(n=2,s=7e3):(n=1,s=5e3):2===g?(n=2,s=7e3):(n=0,s=3e3),h(n),j.current=window.setTimeout(t,s)})).catch((e=>{p(e.message),r("error"),S()}))};t()}return()=>{S()}}),[a,e,w,g]),(0,s.useEffect)((()=>{w>0&&N()}),[w,N]),"success"===a?(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ce,{onClose:n}),(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__step--content",children:(0,y.jsx)("div",{className:"woocommerce-payments-test-account-step__success_content_container",children:(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content woocommerce-payments-test-account-step__success_content",children:[(0,y.jsx)("h1",{className:"woocommerce-payments-test-account-step__success_content_title",children:(0,i.__)("You're ready to test payments!","woocommerce")}),(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__content__item__description",children:(0,y.jsx)("p",{children:(0,O.A)({mixedString:(0,i.__)("We've created a test account for you so that you can begin {{link}}testing payments on your store{{/link}}.","woocommerce"),components:{link:(0,y.jsx)(v.Link,{href:"https://woocommerce.com/document/woopayments/testing-and-troubleshooting/sandbox-mode/",target:"_blank",rel:"noreferrer",type:"external"}),break:(0,y.jsx)("br",{})}})})})}),(0,y.jsxs)("div",{className:"woocommerce-payments-test-account-step__success-whats-next",children:[(0,y.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,y.jsx)("h2",{children:(0,i.__)("What's next:","woocommerce")})}),(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex",children:[(0,y.jsx)("img",{src:x.GZ+"images/icons/store.svg",alt:"store icon"}),(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex__description",children:[(0,y.jsx)("h3",{children:(0,i.__)("Continue your store setup","woocommerce")}),(0,y.jsx)("div",{children:(0,i.__)("Finish completing the tasks required to launch your store.","woocommerce")})]})]}),(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex",children:[(0,y.jsx)("img",{src:x.GZ+"images/icons/dollar.svg",alt:"dollar icon"}),(0,y.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex__description",children:[(0,y.jsx)("h3",{children:(0,i.__)("Activate payments","woocommerce")}),(0,y.jsx)("div",{children:(0,y.jsx)("p",{children:(0,O.A)({mixedString:(0,i.__)("Provide some additional details about your business so you can being accepting real payments. {{link}}Learn more{{/link}}","woocommerce"),components:{link:(0,y.jsx)(v.Link,{href:"https://woocommerce.com/document/woopayments/startup-guide/#sign-up-process",target:"_blank",rel:"noreferrer",type:"external"})}})})})]})]})]}),(0,y.jsx)(u.Button,{variant:"primary",onClick:()=>{(0,m.navigateTo)({url:(0,m.getNewPath)({},"",{page:"wc-admin"})})},children:(0,i.__)("Continue store setup","woocommerce")}),(0,y.jsxs)("div",{className:"woocommerce-payments-test-account-step__success_content_or-divider",children:[(0,y.jsx)("hr",{}),(0,i.__)("OR","woocommerce"),(0,y.jsx)("hr",{})]}),(0,y.jsx)(u.Button,{variant:"secondary",onClick:()=>{t(),o()},children:(0,i.__)("Activate payments","woocommerce")})]})})})]}):(0,y.jsxs)("div",{className:"woocommerce-payments-test-account-step",children:[(0,y.jsx)(ce,{onClose:n}),"error"===a&&_&&(0,y.jsx)(u.Notice,{status:"warning",isDismissible:!1,actions:[{label:(0,i.__)("Try Again","woocommerce"),variant:"primary",onClick:()=>{b((e=>e+1))}},{label:(0,i.__)("Cancel","woocommerce"),variant:"secondary",className:"woocommerce-payments-test-account-step__error-cancel-button",onClick:n}],className:"woocommerce-payments-test-account-step__error",children:(0,y.jsx)("p",{className:"woocommerce-payments-test-account-step__error-message",children:_})}),("initializing"===a||"polling"===a)&&(0,y.jsx)(Ye,{progress:c,message:(k=g,1===k?(0,i.__)("The test account creation is taking a bit longer than expected, but don't worry — we're on it! Please bear with us for a few seconds more as we set everything up for your store.","woocommerce"):2===k?(0,i.__)("Thank you for your patience! Unfortunately, the test account creation is taking a bit longer than we anticipated. But don't worry — we won't give up! Feel free to close this modal and check back later. We appreciate your understanding!","woocommerce"):void 0)})]});var k},Qe=()=>{const{context:e,closeModal:t}=tt();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(ce,{onClose:t}),(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__step--content",children:(0,y.jsxs)("div",{className:"settings-payments-onboarding-modal__step--content-finish",children:[(0,y.jsx)("h1",{className:"settings-payments-onboarding-modal__step--content-finish-title",children:(0,i.__)("You’re ready to accept payments!","woocommerce")}),(0,y.jsx)("p",{className:"settings-payments-onboarding-modal__step--content-finish-description",children:(0,i.__)("Great news — your WooPayments account has been activated. You can now start accepting payments on your store.","woocommerce")}),(0,y.jsx)(u.Button,{variant:"primary",className:"settings-payments-onboarding-modal__step--content-finish-primary-button",onClick:()=>{var t;window.location.href=null!==(t=e?.urls?.overview_page)&&void 0!==t?t:""},children:(0,i.__)("Go to Payments Overview","woocommerce")}),(0,y.jsxs)("div",{className:"divider",children:[(0,y.jsx)("span",{className:"divider-line"}),(0,y.jsx)("span",{className:"divider-text",children:(0,i.__)("OR","woocommerce")}),(0,y.jsx)("span",{className:"divider-line"})]}),(0,y.jsx)(u.Button,{variant:"secondary",className:"settings-payments-onboarding-modal__step--content-finish-secondary-button",onClick:t,children:(0,i.__)("Close this window","woocommerce")})]})})]})},Je=[{id:"payment_methods",order:1,type:"backend",label:"Choose your payment methods",content:(0,y.jsx)(Ve,{})},{id:"wpcom_connection",order:2,type:"backend",label:"Connect with WordPress.com",content:(0,y.jsx)(le,{}),dependencies:["payment_methods"]},{id:"test_account",order:3,type:"backend",label:"Ready to test payments",dependencies:["wpcom_connection"],content:(0,y.jsx)(Xe,{})},{id:"business_verification",order:4,type:"backend",label:"Activate Payments",dependencies:["test_account"],content:(0,y.jsx)(Ke,{})},{id:"finish",order:5,type:"frontend",label:"Submit for verification",dependencies:["business_verification"],content:(0,y.jsx)(Qe,{})}],et=(0,c.createContext)({steps:[],isLoading:!0,currentStep:void 0,context:{},navigateToStep:()=>{},navigateToNextStep:()=>{},getStepByKey:()=>{},refreshStoreData:()=>{},closeModal:()=>{}}),tt=()=>(0,c.useContext)(et),nt=({children:e,closeModal:t})=>{const n=(0,m.getHistory)(),[s,o]=(0,c.useState)([]),[i,l]=(0,c.useState)(!0),[d,_]=(0,c.useState)([]),{invalidateResolutionForStoreSelector:u}=(0,r.useDispatch)(a.woopaymentsOnboardingStore),{invalidateResolutionForStoreSelector:p}=(0,r.useDispatch)(a.paymentSettingsStore),{storeData:g,isStoreLoading:h}=(0,r.useSelect)((e=>({storeData:e(a.woopaymentsOnboardingStore).getOnboardingData(),isStoreLoading:e(a.woopaymentsOnboardingStore).isOnboardingDataRequestPending()})),[]),w=(0,c.useCallback)((e=>d.find((t=>t.id===e))),[d]),v=(0,c.useCallback)(((e,t)=>!e.dependencies||0===e.dependencies.length||e.dependencies.every((e=>{const n=t.find((t=>t.id===e));return"completed"===n?.status}))),[]),x=(0,c.useCallback)((e=>{const t=w(e);if(t?.path){const e=(0,m.getNewPath)({path:t.path},t.path,{page:"wc-settings",tab:"checkout"});n.push(e)}}),[w,n]),b=d.find((e=>"completed"!==e.status&&v(e,d))),j=(0,c.useCallback)((()=>{const e=d.findIndex((e=>e.id===b?.id));if(-1!==e){"completed"!==b?.status&&_(d.map((e=>e.id===b?.id?{...e,status:"completed"}:e)));const e=d.find((e=>"completed"!==e.status&&v(e,d)));e&&x(e.id)}}),[b,d,x,v]),f=()=>{o([]),l(!0),_([]),u("getOnboardingData")};return(0,c.useEffect)((()=>{!h&&g.steps.length>0&&(o(g.steps),l(!1))}),[g,h]),(0,c.useEffect)((()=>{const e=Je.filter((e=>"backend"!==e.type||-1!==s.findIndex((t=>t.id===e.id)))).map((e=>{if("backend"===e.type){const t=s.find((t=>t.id===e.id));return Object.assign({},e,{status:t?.status||"not_started",dependencies:t?.dependencies||[],path:t?.path,context:t?.context,actions:t?.actions})}return Object.assign({},e)})),t=e.map((t=>"frontend"===t.type?{...t,status:v(t,e)?"completed":"not_started"}:t));_(t)}),[s,v]),(0,c.useEffect)((()=>{f()}),[]),(0,y.jsx)(et.Provider,{value:{steps:d,context:g.context,isLoading:i,currentStep:b,navigateToStep:x,navigateToNextStep:j,getStepByKey:w,refreshStoreData:f,closeModal:()=>{t(),p("getPaymentProviders")}},children:e})};function st(){const{steps:e,isLoading:t,currentStep:n,navigateToStep:o}=tt(),a=(0,te.zy)();return(0,s.useEffect)((()=>{var e;n&&a.pathname!==(null!==(e=n?.path)&&void 0!==e?e:"")&&o(n.id)}),[n,o,a.pathname]),t?(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__loading",children:(0,y.jsx)(oe,{})}):e&&e.length>0?(0,y.jsx)(te.BV,{children:(0,y.jsx)(te.qh,{path:"/woopayments/onboarding/*",element:(0,y.jsx)("div",{className:"settings-payments-onboarding-modal__wrapper",children:(0,y.jsx)(ae,{steps:e,active:null!==(r=n?.id)&&void 0!==r?r:"",includeSidebar:!0,sidebarTitle:(0,i.__)("Set up WooPayments","woocommerce")})})})}):null;var r}function ot({isOpen:e,setIsOpen:t,providerData:n}){const s=(0,te.zy)(),a=(0,m.getHistory)(),c="/woopayments/onboarding",{createErrorNotice:l}=(0,r.dispatch)("core/notices"),d=(0,ne.getQueryArg)(window.location.href,"wpcom_connection_return")||!1,_=n?.onboarding?.state?.wpcom_has_working_connection||!1;o().useEffect((()=>{!s.pathname.startsWith(c)||e||!_&&d||t(!0),!_&&d&&l((0,i.__)("Setup was cancelled!","woocommerce"),{type:"snackbar",explicitDismiss:!1})}),[s,e,t,d,_,l]),o().useEffect((()=>{if(e&&!s.pathname.startsWith(c)){const e=(0,m.getNewPath)({path:c},c,{page:"wc-settings",tab:"checkout"});a.push(e)}}),[e,s.pathname,a]);const u=()=>{const e=(0,m.getNewPath)({},"/wp-admin/admin.php",{page:"wc-settings",tab:"checkout"});a.push(e),t(!1)};return e?(0,y.jsx)(se,{setIsOpen:u,children:(0,y.jsx)(nt,{closeModal:u,children:(0,y.jsx)(st,{})})}):null}const it=()=>{var e,t;const[n,o]=(0,c.useState)(null),[l,g]=(0,c.useState)(null),{installAndActivatePlugins:h}=(0,r.useDispatch)(a.pluginsStore),{updateProviderOrdering:w,attachPaymentExtensionSuggestion:v}=(0,r.useDispatch)(a.paymentSettingsStore),[b,j]=(0,c.useState)(null),[f,S]=(0,c.useState)(!1),[N,C]=(0,c.useState)(window.wcSettings?.admin?.woocommerce_payments_nox_profile?.business_country_code||null),[P,E]=(0,c.useState)(!1),O=(0,x.Qk)("wcAdminAssetUrl");(0,c.useEffect)((()=>{(0,_.recordEvent)("settings_payments_pageview");const e=new URLSearchParams(window.location.search);"true"===e.get("test_drive_error")&&j((0,i.sprintf)((0,i.__)("%s: An error occurred while setting up your sandbox account — please try again.","woocommerce"),"WooPayments")),"1"===e.get("wcpay-connect-jetpack-error")&&j((0,i.sprintf)((0,i.__)("%s: There was a problem connecting your WordPress.com account — please try again.","woocommerce"),"WooPayments")),"true"===e.get("wcpay-sandbox-success")&&S(!0)}),[]);const T=(0,r.useSelect)((e=>e(a.pluginsStore).getInstalledPlugins()),[]),{invalidateResolutionForStoreSelector:F}=(0,r.useDispatch)(a.paymentSettingsStore),{providers:I,offlinePaymentGateways:A,suggestions:B,suggestionCategories:D,isFetching:M}=(0,r.useSelect)((e=>{const t=e(a.paymentSettingsStore);return{providers:t.getPaymentProviders(N),offlinePaymentGateways:t.getOfflinePaymentGateways(),suggestions:t.getSuggestions(),suggestionCategories:t.getSuggestionCategories(),isFetching:t.isFetching()}}),[N]),L=(0,s.useCallback)(((e,t)=>{d()({url:e,method:"POST",data:{context:t}})}),[]),R=(0,s.useCallback)((e=>{d()({path:`/wc-analytics/admin/notes/experimental-activate-promo/${e}`,method:"POST"})}),[]);(0,c.useEffect)((()=>{g(null)}),[I]);const W=I.find((e=>"_incentive"in e)),H=W?W._incentive:null;let U=!1,q=!1,$=!1;if(W&&H)if((0,G.sq)(H))if((0,G.$8)(H,"wc_settings_payments__modal")){if(!(0,G.$8)(H,"wc_settings_payments__banner")){const e=new Date;e.setDate(e.getDate()-30),(0,G.uH)(H,"wc_settings_payments__modal",e.getTime())?q=!0:$=!0}}else U=!0;else(0,G.uU)(H)&&((0,G.$8)(H,"wc_settings_payments__banner")?$=!0:q=!0);const K=(0,s.useRef)(!1);(0,c.useEffect)((()=>{if(M||!I.length||!B.length||K.current)return;K.current=!0;const e={woocommerce_payments_displayed:I.some((e=>(0,G.j4)(e.id)))};B.forEach((t=>{e[t.id.replace(/-/g,"_")+"_displayed"]=!0})),I.filter((e=>"suggestion"===e._type)).forEach((t=>{t._suggestion_id?e[t._suggestion_id.replace(/-/g,"_")+"_displayed"]=!0:t.plugin&&t.plugin.slug&&(e[t.plugin.slug.replace(/-/g,"_")+"_displayed"]=!0)})),(0,_.recordEvent)("settings_payments_recommendations_pageview",e)}),[B,I,M]);const Z=(0,s.useCallback)(((e,t,s,i)=>{n||(!s&&(0,G.j4)(e)&&(s=(0,G.ge)()),o(e),(0,_.recordEvent)("settings_payments_recommendations_setup",{extension_selected:t}),h([t]).then((async n=>{i&&v(i),p(n),F("getPaymentProviders"),(0,_.recordEvent)("settings_payments_provider_installed",{provider_id:e});const c=(await(0,r.resolveSelect)(a.paymentSettingsStore).getPaymentProviders(N)).find((n=>n.id===e||n?._suggestion_id===e||n.plugin.slug===t));if((0,_.recordEvent)("settings_payments_provider_enable",{provider_id:e}),"native_in_context"===c?.onboarding?.type)E(!0),o(null);else{var l;if((null!==(l=c?.onboarding?.recommended_payment_methods)&&void 0!==l?l:[]).length>0)return(0,m.getHistory)().push((0,m.getNewPath)({},"/payment-methods")),void o(null);o(null),s&&(window.location.href=s)}})).catch((e=>{p(e),o(null)})))}),[n,h,F,N]),V=(0,y.jsxs)(u.Button,{variant:"link",target:"_blank",href:"https://woocommerce.com/product-category/woocommerce-extensions/payment-gateways/",className:"more-payment-options-link",onClick:()=>{const e=I.map((e=>e.plugin&&e.plugin.slug?e.plugin.slug.replace(/-/g,"_"):e._suggestion_id?e._suggestion_id.replace(/-/g,"_"):e.id));A.forEach((t=>{e.push(t.id)})),B.forEach((t=>{t.plugin&&t.plugin.slug?e.push(t.plugin.slug.replace(/-/g,"_")):e.push(t.id.replace(/-/g,"_"))}));const t=[...new Set(e)];(0,_.recordEvent)("settings_payments_recommendations_other_options",{available_payment_methods:t.join(", ")})},children:[(0,y.jsx)("img",{src:O+"/icons/external-link.svg",alt:""}),(0,i.__)("More payment options","woocommerce")]});return(0,y.jsxs)(y.Fragment,{children:[U&&W&&H&&(0,y.jsx)(ee,{incentive:H,provider:W,onboardingUrl:null!==(e=W.onboarding?._links.onboard.href)&&void 0!==e?e:null,onDismiss:L,onAccept:R,setupPlugin:Z}),b&&(0,y.jsxs)("div",{className:"notice notice-error is-dismissible wcpay-settings-notice",children:[(0,y.jsx)("p",{children:b}),(0,y.jsx)("button",{type:"button",className:"notice-dismiss",onClick:()=>{j(null)}})]}),q&&W&&H&&(0,y.jsx)(J,{incentive:H,provider:W,onboardingUrl:null!==(t=W.onboarding?._links.onboard.href)&&void 0!==t?t:null,onDismiss:L,onAccept:R,setupPlugin:Z}),(0,y.jsxs)("div",{className:"settings-payments-main__container",children:[(0,y.jsx)(Q,{providers:l||I,installedPluginSlugs:T,installingPlugin:n,setupPlugin:Z,acceptIncentive:R,shouldHighlightIncentive:$,updateOrdering:function(e){const t=e.map((e=>e._order)).sort(((e,t)=>e-t)),n={};e.forEach(((e,s)=>{n[e.id]=t[s]})),w(n),g(e)},isFetching:M,businessRegistrationCountry:N,setBusinessRegistrationCountry:C,setIsOnboardingModalOpen:E}),!M&&0===B.length&&(0,y.jsx)("div",{className:"more-payment-options",children:V}),(M||B.length>0)&&(0,y.jsx)(k,{suggestions:B,suggestionCategories:D,installingPlugin:n,setupPlugin:Z,isFetching:M,morePaymentOptionsLink:V})]}),((0,G.ZT)(I)||(0,G.Pt)(I))&&(0,y.jsx)(ot,{isOpen:P,setIsOpen:E,providerData:(0,G.RY)(I)||{}}),(0,y.jsx)(z,{isOpen:f&&(0,G.Pt)(I),devMode:(0,G.MQ)(I),onClose:()=>S(!1)})]})},at=it}}]);