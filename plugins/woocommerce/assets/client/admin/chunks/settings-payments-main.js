"use strict";(globalThis.webpackChunk_wcAdmin_webpackJsonp=globalThis.webpackChunk_wcAdmin_webpackJsonp||[]).push([[5712],{5073:(e,t,s)=>{s.d(t,{l$:()=>_,My:()=>u,D2:()=>m,ls:()=>g}),s(5142);var n=s(65736),o=s(55609),i=s(69307),a=s(9818),c=s(67221),r=s(10431),l=s(81514);const m=({gatewayId:e,gatewayState:t,settingsHref:s,onboardingHref:m,isOffline:d,acceptIncentive:_=(()=>{}),gatewayHasRecommendedPaymentMethods:u,installingPlugin:g,buttonText:p=(0,n.__)("Enable","woocommerce"),incentive:h=null})=>{const[w,y]=(0,i.useState)(!1),{createErrorNotice:x}=(0,a.dispatch)("core/notices"),{togglePaymentGateway:v,invalidateResolutionForStoreSelector:j}=(0,a.useDispatch)(c.PAYMENT_SETTINGS_STORE_NAME),b=()=>{x((0,n.__)("An error occurred. You will be redirected to the settings page, try enabling the payment gateway there.","woocommerce"),{type:"snackbar",explicitDismiss:!0})};return(0,l.jsx)(o.Button,{variant:"primary",isBusy:w,disabled:w||!!g,onClick:o=>{if(o.preventDefault(),t.enabled)return;const i=window.woocommerce_admin.nonces?.gateway_toggle||"";if(!i)return b(),void(window.location.href=s);y(!0),h&&_(h.promo_id),v(e,window.woocommerce_admin.ajax_url,i).then((e=>{if("needs_setup"===e.data)if(t.account_connected)x((0,n.__)("The provider could not be enabled. Check the Manage page for details.","woocommerce"),{type:"snackbar",explicitDismiss:!0,actions:[{label:(0,n.__)("Manage","woocommerce"),url:s}]});else{if(!u)return void(window.location.href=m);(0,r.getHistory)().push((0,r.getNewPath)({},"/payment-methods"))}j(d?"getOfflinePaymentGateways":"getPaymentProviders"),y(!1)})).catch((()=>{y(!1),b(),window.location.href=s}))},href:s,children:p})};var d=s(44443);const _=({acceptIncentive:e,installingPlugin:t,buttonText:s=(0,n.__)("Activate payments","woocommerce"),incentive:a=null})=>{const[c,r]=(0,i.useState)(!1);return(0,l.jsx)(o.Button,{variant:"primary",isBusy:c,disabled:c||!!t,onClick:()=>{r(!0),a&&e(a.promo_id),window.location.href=(0,d.vA)()},children:s})},u=({gatewayId:e,gatewayState:t,onboardingState:s,settingsHref:a,onboardingHref:c,gatewayHasRecommendedPaymentMethods:m,installingPlugin:d,buttonText:_=(0,n.__)("Complete setup","woocommerce")})=>{const[u,g]=(0,i.useState)(!1),p=t.account_connected,h=s.started,w=s.completed;return(0,l.jsx)(o.Button,{variant:"primary",isBusy:u,disabled:u||!!d,onClick:()=>{if(g(!0),p&&h)return p&&h&&!w?void(window.location.href=c):void(window.location.href=a);m?((0,r.getHistory)().push((0,r.getNewPath)({},"/payment-methods")),g(!1)):window.location.href=c},children:_},e)},g=({settingsHref:e,installingPlugin:t,buttonText:s=(0,n.__)("Manage","woocommerce")})=>(0,l.jsx)(o.Button,{variant:"secondary",href:e,disabled:!!t,children:s})},99281:(e,t,s)=>{s.r(t),s.d(t,{SettingsPaymentsMain:()=>X,default:()=>ee});var n=s(99196),o=s(65736),i=s(67221),a=s(9818),c=s(69307),r=s(86989),l=s.n(r),m=s(10431),d=s(4174),_=s(72471),u=s(55609),g=s(22629),p=s(91978),h=s(81514);const w=()=>(0,h.jsxs)("div",{className:"other-payment-gateways__content__grid-item",children:[(0,h.jsx)("div",{className:"grid-item-placeholder__img"}),(0,h.jsxs)("div",{className:"other-payment-gateways__content__grid-item__content grid-item-placeholder__content",children:[(0,h.jsx)("span",{className:"grid-item-placeholder__title"}),(0,h.jsx)("span",{className:"grid-item-placeholder__description"}),(0,h.jsx)("div",{className:"grid-item-placeholder__actions"})]})]}),y=(0,p.O3)("wcAdminAssetUrl"),x=({suggestions:e,suggestionCategories:t,installingPlugin:s,setupPlugin:n,isFetching:i})=>{const a="expanded"===new URLSearchParams(window.location.search).get("other_pes_section"),[r,l]=(0,c.useState)(a),m=(0,c.useMemo)((()=>t.map((t=>({category:t,suggestions:e.filter((e=>e._type===t.id))})))),[e,t]),d=(0,c.useMemo)((()=>i?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("div",{className:"other-payment-gateways__header__title-image-placeholder"}),(0,h.jsx)("div",{className:"other-payment-gateways__header__title-image-placeholder"}),(0,h.jsx)("div",{className:"other-payment-gateways__header__title-image-placeholder"})]}):m.map((({suggestions:e})=>0===e.length?null:e.map((e=>(0,h.jsx)("img",{src:e.icon,alt:e.title+" small logo",width:"24",height:"24",className:"other-payment-gateways__header__title-image"},e.id)))))),[m,i]),p=(0,c.useMemo)((()=>i?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(w,{}),(0,h.jsx)(w,{}),(0,h.jsx)(w,{})]}):m.map((({category:e,suggestions:t})=>0===t.length?null:(0,h.jsxs)("div",{children:[(0,h.jsxs)("div",{className:"other-payment-gateways__content__title",children:[(0,h.jsx)("h3",{className:"other-payment-gateways__content__title__h3",children:(0,g.decodeEntities)(e.title)}),(0,h.jsx)(u.Tooltip,{text:(0,g.decodeEntities)(e.description),position:"top right",children:(0,h.jsx)(_.Z,{icon:"info-outline",className:"other-payment-gateways__content__title__tooltip"})})]}),(0,h.jsx)("div",{className:"other-payment-gateways__content__grid",children:t.map((e=>(0,h.jsxs)("div",{className:"other-payment-gateways__content__grid-item",children:[(0,h.jsx)("img",{className:"other-payment-gateways__content__grid-item-image",src:e.icon,alt:(0,g.decodeEntities)(e.title)+" logo"}),(0,h.jsxs)("div",{className:"other-payment-gateways__content__grid-item__content",children:[(0,h.jsx)("span",{className:"other-payment-gateways__content__grid-item__content__title",children:e.title}),(0,h.jsx)("span",{className:"other-payment-gateways__content__grid-item__content__description",children:(0,g.decodeEntities)(e.description)}),(0,h.jsx)("div",{className:"other-payment-gateways__content__grid-item__content__actions",children:(0,h.jsx)(u.Button,{variant:"primary",onClick:()=>n(e.id,e.plugin.slug,null),isBusy:s===e.id,disabled:!!s,children:(0,o.__)("Install","woocommerce")})})]})]},e.id)))})]},e.id)))),[m,s,n,i]);return i||0!==e.length?(0,h.jsxs)("div",{className:"other-payment-gateways",children:[(0,h.jsxs)("div",{className:"other-payment-gateways__header",onClick:()=>{l(!r)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||l(!r)},role:"button",tabIndex:0,"aria-expanded":r,children:[(0,h.jsxs)("div",{className:"other-payment-gateways__header__title",children:[(0,h.jsx)("span",{children:(0,o.__)("Other payment options","woocommerce")}),!r&&(0,h.jsx)(h.Fragment,{children:d})]}),(0,h.jsx)(_.Z,{icon:r?"chevron-up":"chevron-down"})]}),r&&(0,h.jsxs)("div",{className:"other-payment-gateways__content",children:[p,(0,h.jsx)("div",{className:"other-payment-gateways__content__external-icon",children:(0,h.jsxs)(u.Button,{variant:"link",target:"_blank",href:"https://woocommerce.com/product-category/woocommerce-extensions/payment-gateways/",children:[(0,h.jsx)("img",{src:y+"/icons/external-link.svg",alt:""}),(0,o.__)("More payment options","woocommerce")]})})]})]}):null};var v=s(80225),j=s(86020),b=s(74617),N=s(55),f=s(28302),k=s(41708),P=s(94333),S=s(59550),C=s(58176),T=s(56592);const E=(e,t)=>{const s=t,{changes:n,type:o,props:i}=s,{items:a}=i,{selectedItem:c}=e;switch(o){case k.L7.stateChangeTypes.ItemClick:return{...n,isOpen:!0,highlightedIndex:e.highlightedIndex};case k.L7.stateChangeTypes.ToggleButtonKeyDownArrowDown:return{selectedItem:a[c?Math.min(a.indexOf(c)+1,a.length-1):0],isOpen:!0};case k.L7.stateChangeTypes.ToggleButtonKeyDownArrowUp:return{selectedItem:a[c?Math.max(a.indexOf(c)-1,0):a.length-1],isOpen:!0};default:return n}},I=e=>e.normalize("NFD").replace(/[\u0300-\u036f]/g,""),A=({name:e,className:t,label:s,describedBy:i,options:a,onChange:r,value:l,placeholder:m,children:d})=>{var _;const[g,w]=(0,n.useState)(""),y=(0,P.useThrottle)((0,c.useCallback)(((e,t)=>new Set(t.filter((t=>{var s;return`${I(null!==(s=t.name)&&void 0!==s?s:"")}`.toLowerCase().includes(I(e.toLowerCase()))})))),[]),200),x=""!==g?null!==(_=y(g,a))&&void 0!==_?_:new Set:new Set(a),{getToggleButtonProps:j,getMenuProps:b,getItemProps:N,isOpen:f,highlightedIndex:A,selectedItem:M,closeMenu:B}=(0,k.L7)({initialSelectedItem:l,items:[...x],stateReducer:E}),R=((e,t)=>{const s=t.find((t=>t.key===e));return s?.name?s.name:""})(l.key,a),O=M?M.key:"",D=(0,n.useRef)(null),L=(0,n.useRef)(null),F=(0,c.useCallback)((e=>{const t=D.current,s=t?.querySelector(`[data-index="${e}"]`);s&&s.scrollIntoView({block:"nearest"})}),[D]),H=""!==g,G=b({className:"components-country-select-control__menu","aria-hidden":!f,ref:D}),Z=(0,c.useCallback)((e=>{e.stopPropagation(),r(O),B()}),[r,O,B]),W=(0,c.useCallback)((e=>{e.stopPropagation(),"Enter"===e.key&&r(O)}),[r,O]),U=(0,c.useCallback)((e=>{e.preventDefault(),""!==g&&w(""),null!==M&&setTimeout((()=>{F(a.indexOf(M))}),10)}),[g,M]);return(0,c.useEffect)((()=>{if(f&&null!==M){const e=Array.from(x).indexOf(M);F(e)}}),[f]),(0,h.jsxs)("div",{className:(0,v.Z)("woopayments components-country-select-control",t),children:[(0,h.jsxs)(u.Button,{...j({"aria-label":s,"aria-labelledby":void 0,"aria-describedby":i||(R?(0,o.sprintf)((0,o.__)("Currently selected: %s","woocommerce"),R):(0,o.__)("No selection","woocommerce")),className:(0,v.Z)("components-country-select-control__button",{placeholder:!R}),name:e,onKeyDown:W}),children:[(0,h.jsxs)("span",{className:"components-country-select-control__button-value",children:[(0,h.jsx)("span",{className:"components-country-select-control__label",children:s}),R||m]}),(0,h.jsx)(S.Z,{icon:C.Z,className:"components-custom-select-control__button-icon"})]}),(0,h.jsx)("div",{...G,children:f&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsxs)("div",{className:"components-country-select-control__search wc-settings-prevent-change-event",children:[(0,h.jsx)("input",{className:"components-country-select-control__search--input",ref:L,type:"text",value:g,onChange:({target:e})=>w(e.value),tabIndex:-1,placeholder:(0,o.__)("Search","woocommerce")}),(0,h.jsx)("button",{className:"components-country-select-control__search--input-suffix",onClick:U,children:(Y=H,Y?(0,h.jsx)("img",{src:p.vm+"images/icons/clear.svg",alt:(0,o.__)("Clear search","woocommerce")}):(0,h.jsx)("img",{src:p.vm+"images/icons/search.svg",alt:(0,o.__)("Search","woocommerce")}))})]}),(0,h.jsx)("div",{className:"components-country-select-control__list",children:[...x].map(((e,t)=>(0,n.createElement)("div",{...N({item:e,index:t,key:e.key,className:(0,v.Z)(e.className,"components-country-select-control__item",{"is-highlighted":t===A}),"data-index":t,style:e.style}),key:e.key},e.key===O&&(0,h.jsx)(S.Z,{icon:T.Z,className:"components-country-select-control__item-icon"}),d?d(e):e.name)))}),(0,h.jsx)("div",{className:"components-country-select-control__apply",children:(0,h.jsx)("button",{className:"components-button is-primary",onClick:Z,children:(0,o.__)("Apply","woocommerce")})})]})})]});var Y};var M=s(4622),B=s(47396),R=s(76025),O=s(9845);const D=({providerId:e,pluginFile:t,isSuggestion:s,suggestionHideUrl:n="",onToggle:r,links:l=[],canResetAccount:m=!1,setResetAccountModalVisible:d=(()=>{}),isEnabled:_=!1})=>{const{deactivatePlugin:g}=(0,a.useDispatch)(i.PLUGINS_STORE_NAME),[p,w]=(0,c.useState)(!1),[y,x]=(0,c.useState)(!1),[v,j]=(0,c.useState)(!1),{invalidateResolutionForStoreSelector:b,togglePaymentGateway:N,hidePaymentExtensionSuggestion:f}=(0,a.useDispatch)(i.PAYMENT_SETTINGS_STORE_NAME),{createErrorNotice:k,createSuccessNotice:P}=(0,a.useDispatch)("core/notices"),S={pricing:(0,o.__)("See pricing & fees","woocommerce"),about:(0,o.__)("Learn more","woocommerce"),terms:(0,o.__)("See Terms of Service","woocommerce"),support:(0,o.__)("Get support","woocommerce"),documentation:(0,o.__)("View documentation","woocommerce")};return(0,h.jsxs)(h.Fragment,{children:[l.filter((e=>{switch(e._type){case"pricing":return!0;case"terms":case"about":return!_;case"documentation":case"support":return _;default:return!1}})).map((e=>{const t=S[e._type];return t?(0,h.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,h.jsx)(u.Button,{target:"_blank",href:e.url,children:t})},e._type):null})),(0,h.jsx)(u.CardDivider,{}),s&&(0,h.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,h.jsx)(u.Button,{onClick:()=>{j(!0),f(n).then((()=>{b("getPaymentProviders"),j(!1),r()})).catch((()=>{k((0,o.__)("Failed to hide the payment extension suggestion.","woocommerce")),j(!1),r()}))},isBusy:v,disabled:v,children:(0,o.__)("Hide suggestion","woocommerce")})},"hide-suggestion"),m&&(0,h.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,h.jsx)(u.Button,{onClick:()=>{d(!0),r()},className:"components-button__danger",children:(0,o.__)("Reset account","woocommerce")})},"reset-account"),!s&&!_&&(0,h.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,h.jsx)(u.Button,{className:"components-button__danger",onClick:()=>{w(!0),g(t).then((()=>{P((0,o.__)("Plugin was successfully deactivated.","woocommerce")),b("getPaymentProviders"),w(!1),r()})).catch((()=>{k((0,o.__)("Failed to deactivate the plugin.","woocommerce")),w(!1),r()}))},isBusy:p,disabled:p,children:(0,o.__)("Deactivate","woocommerce")})},"deactivate"),!s&&_&&(0,h.jsx)("div",{className:"woocommerce-ellipsis-menu__content__item",children:(0,h.jsx)(u.Button,{className:"components-button__danger",onClick:()=>{const t=window.woocommerce_admin.nonces?.gateway_toggle||"";t?(x(!0),N(e,window.woocommerce_admin.ajax_url,t).then((()=>{b("getPaymentProviders"),x(!1),r()})).catch((()=>{k((0,o.__)("Failed to disable the plugin.","woocommerce")),x(!1),r()}))):k((0,o.__)("Failed to disable the plugin.","woocommerce"))},isBusy:y,disabled:y,children:(0,o.__)("Disable","woocommerce")})},"disable")]})};var L=s(44443);const F=({isOpen:e,onClose:t})=>{const[s,n]=(0,c.useState)(!1);return(0,h.jsx)(h.Fragment,{children:e&&(0,h.jsxs)(u.Modal,{title:(0,o.__)("Reset your test account","woocommerce"),className:"woocommerce-woopayments-modal",isDismissible:!0,onRequestClose:t,children:[(0,h.jsxs)("div",{className:"woocommerce-woopayments-modal__content",children:[(0,h.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,h.jsx)("div",{children:(0,h.jsx)("span",{children:(0,o.sprintf)((0,o.__)("When you reset your test account, all data — including your %s account details, test transactions, and payouts history — will be lost. This action cannot be undone, but you can create a new test account at any time.","woocommerce"),"WooPayments")})})}),(0,h.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,h.jsx)("h3",{children:(0,o.__)("Are you sure you'd like to continue?","woocommerce")})})]}),(0,h.jsx)("div",{className:"woocommerce-woopayments-modal__actions",children:(0,h.jsx)(u.Button,{className:"danger",variant:"secondary",isBusy:s,disabled:s,onClick:()=>{n(!0),window.location.href=(0,L.Pq)()},children:(0,o.__)("Yes, reset account","woocommerce")})})]})})},H=({isOpen:e,devMode:t,onClose:s})=>{const[n,i]=(0,c.useState)(!1),[a,r]=(0,c.useState)(!1);return(0,h.jsx)(h.Fragment,{children:e&&(0,h.jsxs)(u.Modal,{title:(0,o.__)("You're ready to test payments!","woocommerce"),className:"woocommerce-woopayments-modal",isDismissible:!0,onRequestClose:s,children:[(0,h.jsxs)("div",{className:"woocommerce-woopayments-modal__content",children:[(0,h.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,h.jsx)("div",{className:"woocommerce-woopayments-modal__content__item__description",children:(0,h.jsx)("p",{children:(0,f.Z)({mixedString:(0,o.__)("We've created a test account for you so that you can begin testing payments on your store. Not sure what to test? Take a look at {{link}}how to test payments{{/link}}.","woocommerce"),components:{link:(0,h.jsx)(j.Link,{href:"https://woocommerce.com/document/woopayments/testing-and-troubleshooting/sandbox-mode/",target:"_blank",rel:"noreferrer",type:"external"})}})})})}),(0,h.jsx)("div",{className:"woocommerce-woopayments-modal__content__item",children:(0,h.jsx)("h2",{children:(0,o.__)("What's next:","woocommerce")})}),(0,h.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex",children:[(0,h.jsx)("img",{src:p.vm+"images/icons/store.svg",alt:"store icon"}),(0,h.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex__description",children:[(0,h.jsx)("h3",{children:(0,o.__)("Continue your store setup","woocommerce")}),(0,h.jsx)("div",{children:(0,o.__)("Finish completing the tasks required to launch your store.","woocommerce")})]})]}),!t&&(0,h.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex",children:[(0,h.jsx)("img",{src:p.vm+"images/icons/dollar.svg",alt:"dollar icon"}),(0,h.jsxs)("div",{className:"woocommerce-woopayments-modal__content__item-flex__description",children:[(0,h.jsx)("h3",{children:(0,o.__)("Activate payments","woocommerce")}),(0,h.jsx)("div",{children:(0,h.jsx)("p",{children:(0,f.Z)({mixedString:(0,o.__)("Provide some additional details about your business so you can being accepting real payments. {{link}}Learn more{{/link}}","woocommerce"),components:{link:(0,h.jsx)(j.Link,{href:"https://woocommerce.com/document/woopayments/startup-guide/#sign-up-process",target:"_blank",rel:"noreferrer",type:"external"})}})})})]})]})]}),(0,h.jsxs)("div",{className:"woocommerce-woopayments-modal__actions",children:[(0,h.jsx)(u.Button,{variant:"primary",isBusy:a,disabled:a,onClick:()=>{r(!0),window.location.href=(0,b.getAdminLink)("admin.php?page=wc-admin")},children:(0,o.__)("Continue store setup","woocommerce")}),!t&&(0,h.jsx)(u.Button,{variant:"secondary",isBusy:n,disabled:n,onClick:()=>{i(!0),window.location.href=(0,L.vA)()},children:(0,o.__)("Activate payments","woocommerce")})]})]})})},G=({provider:e,label:t})=>{const[s,n]=(0,c.useState)(!1),o=(0,L.mz)(e.id)&&"gateway"===e._type&&e.state?.account_connected&&(e.onboarding?.state.test_mode||!e.onboarding?.state.completed);return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(j.EllipsisMenu,{label:t,renderContent:({onToggle:t})=>(0,h.jsx)(D,{providerId:e.id,pluginFile:e.plugin.file,isSuggestion:"suggestion"===e._type,suggestionHideUrl:"suggestion"===e._type?e._links?.hide?.href:"",links:e.links,onToggle:t,isEnabled:e.state?.enabled,canResetAccount:o,setResetAccountModalVisible:n})}),(0,h.jsx)(F,{isOpen:s,onClose:()=>n(!1)})]})};var Z=s(33002);const W=({status:e,message:t,popoverContent:s})=>{const[n,i]=(0,c.useState)(!1);return(0,h.jsxs)(j.Pill,{className:`woocommerce-status-badge ${(()=>{switch(e){case"active":case"has_incentive":return"woocommerce-status-badge--success";case"needs_setup":case"test_mode":case"test_account":return"woocommerce-status-badge--warning";case"recommended":case"inactive":return"woocommerce-status-badge--info";default:return""}})()}`,children:[t||(()=>{switch(e){case"active":return(0,o.__)("Active","woocommerce");case"inactive":return(0,o.__)("Inactive","woocommerce");case"needs_setup":return(0,o.__)("Action needed","woocommerce");case"test_mode":return(0,o.__)("Test mode","woocommerce");case"test_account":return(0,o.__)("Test account","woocommerce");case"recommended":return(0,o.__)("Recommended","woocommerce");default:return""}})(),s&&(0,h.jsx)("span",{className:"woocommerce-status-badge__icon-container",children:(0,h.jsx)(S.Z,{onClick:()=>{i(!n)},onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||i(!n)},tabIndex:0,role:"button",className:"woocommerce-status-badge-icon",size:14,icon:Z.Z})}),n&&(0,h.jsx)(u.Popover,{className:"woocommerce-status-badge-popover",position:"top right",noArrow:!0,onClose:()=>i(!1),children:(0,h.jsx)("div",{className:"settings-payment-gateways__popover-container",children:s})})]})},U=({incentive:e})=>(0,h.jsx)(W,{status:"has_incentive",message:e.badge,popoverContent:(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("p",{className:"woocommerce-incentive-popover__title",children:e.title}),(0,h.jsx)("p",{className:"woocommerce-incentive-popover__terms",children:(0,c.createInterpolateElement)((0,o.__)("See <termsLink /> for details.","woocommerce"),{termsLink:(0,h.jsx)(j.Link,{href:e.tc_url,target:"_blank",rel:"noreferrer",type:"external",children:(0,o.__)("Terms and Conditions","woocommerce")})})})]})}),Y=({extension:e,installingPlugin:t,setupPlugin:s,pluginInstalled:n,acceptIncentive:i,...a})=>{const c=(0,L.Kr)(e)?e._incentive:null,r=(0,L.Kr)(e)&&(!(0,L.Ir)(e._incentive)||(0,L.o0)(e._incentive,"wc_settings_payments__banner"));return(0,h.jsx)("div",{id:e.id,className:"transitions-disabled woocommerce-list__item woocommerce-list__item-enter-done "+(r?"has-incentive":""),...a,children:(0,h.jsxs)("div",{className:"woocommerce-list__item-inner",children:[(0,h.jsxs)("div",{className:"woocommerce-list__item-before",children:[(0,h.jsx)(B.mR,{}),e.icon&&(0,h.jsx)("img",{className:"woocommerce-list__item-image",src:e.icon,alt:e.title+" logo"})]}),(0,h.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,h.jsxs)("span",{className:"woocommerce-list__item-title",children:[e.title," ",!(0,L.Kr)(e)&&(0,L.mz)(e.id)&&(0,h.jsx)(W,{status:"recommended"}),c&&(0,h.jsx)(U,{incentive:c})]}),(0,h.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,O.ZP)((0,g.decodeEntities)(e.description))}),(0,L.mz)(e.id)&&(0,h.jsx)(R.WooPaymentsMethodsLogos,{maxElements:10,tabletWidthBreakpoint:1080,mobileWidthBreakpoint:768,isWooPayEligible:(0,L.Gf)(e)})]}),(0,h.jsx)("div",{className:"woocommerce-list__item-buttons",children:(0,h.jsx)("div",{className:"woocommerce-list__item-buttons__actions",children:(0,h.jsx)(u.Button,{variant:"primary",onClick:()=>{var t;c&&i(c.promo_id),s(e.id,e.plugin.slug,null!==(t=e.onboarding?._links.onboard.href)&&void 0!==t?t:null)},isBusy:t===e.id,disabled:!!t,children:n?(0,o.__)("Enable","woocommerce"):(0,o.__)("Install","woocommerce")})})}),(0,h.jsx)("div",{className:"woocommerce-list__item-after",children:(0,h.jsx)("div",{className:"woocommerce-list__item-after__actions",children:(0,h.jsx)(G,{label:(0,o.__)("Payment Provider Options","woocommerce"),provider:e})})})]})})};var K=s(5073);const z=({buttonText:e=(0,o.__)("Reactivate payments","woocommerce"),settingsHref:t})=>{const[s,n]=(0,c.useState)(!1),{createSuccessNotice:r,createErrorNotice:m}=(0,a.dispatch)("core/notices"),{invalidateResolutionForStoreSelector:d}=(0,a.useDispatch)(i.PAYMENT_SETTINGS_STORE_NAME);return(0,h.jsx)(u.Button,{variant:"primary",isBusy:s,disabled:s,onClick:e=>{e.preventDefault(),n(!0),l()({path:"/wc/v3/payments/settings",method:"POST",data:{is_test_mode_enabled:!1}}).then((()=>{r((0,o.sprintf)((0,o.__)("%s is now processing live payments (real payment methods and charges).","woocommerce"),"WooPayments"),{type:"snackbar",explicitDismiss:!1}),d("getPaymentProviders"),n(!1)})).catch((()=>{n(!1),m((0,o.sprintf)((0,o.__)("An error occurred. You will be redirected to the %s settings page to manage payments processing mode from there.","woocommerce"),"WooPayments"),{type:"snackbar",explicitDismiss:!0}),window.location.href=t}))},href:t,children:e})},$=({gateway:e,installingPlugin:t,acceptIncentive:s,...n})=>{var i;const a=(0,L.mz)(e.id),c=(0,L.Kr)(e)?e._incentive:null,r=c&&!c?.promo_id.includes("-action-"),l=(null!==(i=e.onboarding.recommended_payment_methods)&&void 0!==i?i:[]).length>0,m=!e.state.account_connected||e.state.account_connected&&!e.onboarding.state.started||e.state.account_connected&&e.onboarding.state.started&&!e.onboarding.state.completed;return(0,h.jsx)("div",{id:e.id,className:`transitions-disabled woocommerce-list__item woocommerce-list__item-enter-done woocommerce-item__payment-gateway ${a?"woocommerce-item__woocommerce-payments":""} ${r?"has-incentive":""}`,...n,children:(0,h.jsxs)("div",{className:"woocommerce-list__item-inner",children:[(0,h.jsxs)("div",{className:"woocommerce-list__item-before",children:[(0,h.jsx)(B.mR,{}),e.icon&&(0,h.jsx)("img",{className:"woocommerce-list__item-image",src:e.icon,alt:e.title+" logo"})]}),(0,h.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,h.jsxs)("span",{className:"woocommerce-list__item-title",children:[e.title,c?(0,h.jsx)(W,{status:"has_incentive",message:c.badge}):(0,h.jsx)(W,{status:!e.state.enabled&&e.state.needs_setup?"needs_setup":e.state.enabled?e.onboarding.state.test_mode?"test_account":e.state.test_mode?"test_mode":"active":"inactive"}),e.supports?.includes("subscriptions")&&(0,h.jsx)(u.Tooltip,{text:(0,o.__)("Supports recurring payments","woocommerce"),children:(0,h.jsx)("img",{src:p.vm+"images/icons/recurring-payments.svg",alt:(0,o.__)("Icon to indicate support for recurring payments","woocommerce")})})]}),(0,h.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:(0,O.ZP)((0,g.decodeEntities)(e.description))}),a&&(0,h.jsx)(R.WooPaymentsMethodsLogos,{maxElements:10,tabletWidthBreakpoint:1080,mobileWidthBreakpoint:768,isWooPayEligible:(0,L.Gf)(e)})]}),(0,h.jsx)("div",{className:"woocommerce-list__item-buttons",children:(0,h.jsxs)("div",{className:"woocommerce-list__item-buttons__actions",children:[!e.state.enabled&&!m&&(0,h.jsx)(K.D2,{gatewayId:e.id,gatewayState:e.state,settingsHref:e.management._links.settings.href,onboardingHref:e.onboarding._links.onboard.href,isOffline:!1,gatewayHasRecommendedPaymentMethods:l,installingPlugin:t,incentive:c,acceptIncentive:s}),!m&&(0,h.jsx)(K.ls,{settingsHref:e.management._links.settings.href,installingPlugin:t}),m&&(0,h.jsx)(K.My,{gatewayId:e.id,gatewayState:e.state,onboardingState:e.onboarding.state,settingsHref:e.management._links.settings.href,onboardingHref:e.onboarding._links.onboard.href,gatewayHasRecommendedPaymentMethods:l,installingPlugin:t}),(0,L.mz)(e.id)&&!e.state.dev_mode&&e.state.account_connected&&e.onboarding.state.completed&&e.onboarding.state.test_mode&&(0,h.jsx)(K.l$,{acceptIncentive:s,installingPlugin:t,incentive:c}),(0,L.mz)(e.id)&&!e.state.dev_mode&&e.state.account_connected&&e.onboarding.state.completed&&!e.onboarding.state.test_mode&&e.state.test_mode&&(0,h.jsx)(z,{settingsHref:e.management._links.settings.href})]})}),(0,h.jsx)("div",{className:"woocommerce-list__item-after",children:(0,h.jsx)("div",{className:"woocommerce-list__item-after__actions",children:(0,h.jsx)(G,{label:(0,o.__)("Payment Provider Options","woocommerce"),provider:e})})})]})})},q=({providers:e,installedPluginSlugs:t,installingPlugin:s,setupPlugin:n,acceptIncentive:o,updateOrdering:a})=>(0,h.jsx)(B.JN,{items:e,className:"settings-payment-gateways__list",setItems:a,children:e.map((e=>{switch(e._type){case i.PaymentProviderType.Suggestion:const a=e,c=t.includes(e.plugin.slug);return(0,h.jsx)(B.TR,{id:a.id,children:Y({extension:a,installingPlugin:s,setupPlugin:n,pluginInstalled:c,acceptIncentive:o})},a.id);case i.PaymentProviderType.Gateway:const r=e;return(0,h.jsx)(B.TR,{id:e.id,children:$({gateway:r,installingPlugin:s,acceptIncentive:o})},e.id);case i.PaymentProviderType.OfflinePmsGroup:const l=e;return(0,h.jsx)(B.TR,{id:l.id,children:(0,h.jsx)("div",{id:l.id,className:"transitions-disabled woocommerce-list__item clickable-list-item enter-done",onClick:()=>{window.location.href=l.management._links.settings.href},children:(0,h.jsxs)("div",{className:"woocommerce-list__item-inner",children:[(0,h.jsxs)("div",{className:"woocommerce-list__item-before",children:[(0,h.jsx)(B.mR,{}),(0,h.jsx)("img",{src:l.icon,alt:l.title+" logo"})]}),(0,h.jsxs)("div",{className:"woocommerce-list__item-text",children:[(0,h.jsx)("span",{className:"woocommerce-list__item-title",children:l.title}),(0,h.jsx)("span",{className:"woocommerce-list__item-content",dangerouslySetInnerHTML:{__html:l.description}})]}),(0,h.jsx)("div",{className:"woocommerce-list__item-after centered no-buttons",children:(0,h.jsx)("div",{className:"woocommerce-list__item-after__actions",children:(0,h.jsx)("a",{href:l.management._links.settings.href,children:(0,h.jsx)(_.Z,{icon:"chevron-right"})})})})]})})},l.id);default:return null}}))}),V=({providers:e,installedPluginSlugs:t,installingPlugin:s,setupPlugin:n,acceptIncentive:r,updateOrdering:m,isFetching:d,businessRegistrationCountry:_,setBusinessRegistrationCountry:p})=>{var w;const{invalidateResolution:y}=(0,a.useDispatch)(i.PAYMENT_SETTINGS_STORE_NAME),[x,k]=(0,c.useState)(!1),P=(window.wcSettings?.admin?.preloadSettings?.general?.woocommerce_default_country||"US").split(":")[0],S=(0,c.useMemo)((()=>Object.entries(window.wcSettings.countries||[]).map((([e,t])=>({key:e,name:(0,g.decodeEntities)(t),types:[]}))).sort(((e,t)=>e.name.localeCompare(t.name)))),[]),C=P!==_,T=(0,v.Z)("settings-payment-gateways__header-select-container",{"has-alert":C});return(0,h.jsxs)("div",{className:"settings-payment-gateways",children:[(0,h.jsxs)("div",{className:"settings-payment-gateways__header",children:[(0,h.jsx)("div",{className:"settings-payment-gateways__header-title",children:(0,o.__)("Payment providers","woocommerce")}),(0,h.jsxs)("div",{className:T,children:[(0,h.jsx)(A,{className:"woocommerce-select-control__country",label:(0,o.__)("Business location :","woocommerce"),placeholder:"",value:null!==(w=S.find((e=>e.key===_)))&&void 0!==w?w:{key:"US",name:"United States (US)"},options:S,onChange:e=>{l()({path:i.WC_ADMIN_NAMESPACE+"/settings/payments/country",method:"POST",data:{location:e}}).then((()=>{p(e),y("getPaymentProviders",[e])}))}}),C&&(0,h.jsxs)("div",{className:"settings-payment-gateways__header-select-container--indicator",onClick:()=>k(!x),onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1),tabIndex:0,role:"button",onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||k(!x)},children:[(0,h.jsx)("div",{className:"settings-payment-gateways__header-select-container--indicator-icon",children:(0,h.jsx)(N.Z,{})}),x&&(0,h.jsx)(u.Popover,{position:"top left",noArrow:!0,onClose:()=>k(!1),children:(0,h.jsx)("div",{className:"settings-payment-gateways__header-select-container--indicator-popover",children:(0,f.Z)({mixedString:(0,o.__)("Your business location does not match your store location. {{link}}Edit store location.{{/link}}","woocommerce"),components:{link:(0,h.jsx)(j.Link,{href:(0,b.getAdminLink)("admin.php?page=wc-settings&tab=general"),target:"_blank",type:"external"})}})})})]})]})]}),d?(0,h.jsx)(M.a,{rows:5}):(0,h.jsx)(q,{providers:e,installedPluginSlugs:t,installingPlugin:s,setupPlugin:n,acceptIncentive:r,updateOrdering:m})]})},J=({incentive:e,provider:t,onboardingUrl:s,onDismiss:n,onAccept:i,setupPlugin:a})=>{const[r,l]=(0,c.useState)(!1),[m,d]=(0,c.useState)(!1),[_,g]=(0,c.useState)(!1),w="wc_settings_payments__banner";return r||(0,L.o0)(e,w)||m?null:(0,h.jsx)(u.Card,{className:"woocommerce-incentive-banner",isRounded:!0,children:(0,h.jsxs)("div",{className:"woocommerce-incentive-banner__content",children:[(0,h.jsx)("img",{src:p.vm+"images/settings-payments/incentives-illustration.svg",alt:(0,o.__)("Incentive illustration","woocommerce")}),(0,h.jsxs)(u.CardBody,{className:"woocommerce-incentive-banner__body",children:[(0,h.jsx)(W,{status:"has_incentive",message:(0,o.__)("Limited time offer","woocommerce")}),(0,h.jsx)("h2",{children:e.title}),(0,h.jsx)("p",{children:e.description}),(0,h.jsx)("p",{className:"woocommerce-incentive-banner__terms",children:(0,c.createInterpolateElement)((0,o.__)("See <termsLink /> for details.","woocommerce"),{termsLink:(0,h.jsx)(j.Link,{href:e.tc_url,target:"_blank",rel:"noreferrer",type:"external",children:(0,o.__)("Terms and Conditions","woocommerce")})})}),(0,h.jsx)(u.Button,{variant:"primary",isBusy:r,disabled:r,onClick:()=>{g(!0),i(e.promo_id),n(e._links.dismiss.href,w),l(!0),a(t.id,t.plugin.slug,s),g(!1)},children:e.cta_label}),(0,h.jsx)(u.Button,{variant:"tertiary",isBusy:_,disabled:_,onClick:()=>{g(!0),n(e._links.dismiss.href,w),g(!1),d(!0)},children:(0,o.__)("Dismiss","woocommerce")})]})]})})},Q=({incentive:e,provider:t,onboardingUrl:s,onAccept:n,onDismiss:i,setupPlugin:a})=>{const[r,l]=(0,c.useState)(!1),[m,d]=(0,c.useState)(!0),_="wc_settings_payments__modal",g=(0,L.o0)(e,_),w=()=>{d(!1)};return g?null:(0,h.jsx)(h.Fragment,{children:m&&(0,h.jsx)(u.Modal,{title:"",className:"woocommerce-incentive-modal",onRequestClose:()=>{i(e._links.dismiss.href,_),w()},children:(0,h.jsx)(u.Card,{className:"woocommerce-incentive-modal__card",children:(0,h.jsxs)("div",{className:"woocommerce-incentive-modal__content",children:[(0,h.jsx)(u.CardMedia,{className:"woocommerce-incentive-modal__media",children:(0,h.jsx)("img",{src:p.vm+"images/settings-payments/incentives-illustration.svg",alt:(0,o.__)("Incentive illustration","woocommerce")})}),(0,h.jsxs)(u.CardBody,{className:"woocommerce-incentive-modal__body",children:[(0,h.jsx)("div",{children:(0,h.jsx)(W,{status:"has_incentive",message:(0,o.__)("Limited time offer","woocommerce")})}),(0,h.jsx)("h2",{children:e.title}),(0,h.jsx)("p",{children:e.description}),(0,h.jsx)("p",{className:"woocommerce-incentive-modal__terms",children:(0,c.createInterpolateElement)((0,o.__)("See <termsLink /> for details.","woocommerce"),{termsLink:(0,h.jsx)(j.Link,{href:e.tc_url,target:"_blank",rel:"noreferrer",type:"external",children:(0,o.__)("Terms and Conditions","woocommerce")})})}),(0,h.jsx)("div",{className:"woocommerce-incentive-model__actions",children:(0,h.jsx)(u.Button,{variant:"primary",isBusy:r,disabled:r,onClick:()=>{l(!0),n(e.promo_id),i(e._links.dismiss.href,_),w(),a(t.id,t.plugin.slug,s),l(!1)},children:e.cta_label})})]})]})})})})},X=()=>{var e,t;const[s,r]=(0,c.useState)(null),[_,u]=(0,c.useState)(null),{installAndActivatePlugins:g}=(0,a.useDispatch)(i.PLUGINS_STORE_NAME),{updateProviderOrdering:p}=(0,a.useDispatch)(i.PAYMENT_SETTINGS_STORE_NAME),[w,y]=(0,c.useState)(null),[v,j]=(0,c.useState)(!1),[b,N]=(0,c.useState)(window.wcSettings?.admin?.woocommerce_payments_nox_profile?.business_country_code||null),f=new URLSearchParams(window.location.search);(0,c.useEffect)((()=>{"true"===f.get("test_drive_error")&&y((0,o.sprintf)((0,o.__)("%s: An error occurred while setting up your sandbox account — please try again.","woocommerce"),"WooPayments")),"1"===f.get("wcpay-connect-jetpack-error")&&y((0,o.sprintf)((0,o.__)("%s: There was a problem connecting your WordPress.com account — please try again.","woocommerce"),"WooPayments")),"true"===f.get("wcpay-sandbox-success")&&j(!0)}),[]);const k=(0,a.useSelect)((e=>e(i.PLUGINS_STORE_NAME).getInstalledPlugins()),[]),{invalidateResolutionForStoreSelector:P}=(0,a.useDispatch)(i.PAYMENT_SETTINGS_STORE_NAME),{providers:S,suggestions:C,suggestionCategories:T,isFetching:E}=(0,a.useSelect)((e=>{const t=e(i.PAYMENT_SETTINGS_STORE_NAME);return{providers:t.getPaymentProviders(b),suggestions:t.getSuggestions(),suggestionCategories:t.getSuggestionCategories(),isFetching:t.isFetching()}}),[b]),I=(0,n.useCallback)(((e,t)=>{l()({url:e,method:"POST",data:{context:t}})}),[]),A=(0,n.useCallback)((e=>{l()({path:`/wc-analytics/admin/notes/experimental-activate-promo/${e}`,method:"POST"})}),[]);(0,c.useEffect)((()=>{u(null)}),[S]);const M=S.find((e=>"_incentive"in e)),B=M?M._incentive:null;let R=!1,O=!1;M&&B&&((0,L.NI)(B)?(0,L.o0)(B,"wc_settings_payments__modal")?(0,L.o0)(B,"wc_settings_payments__banner")||(O=!0):R=!0:(0,L.o0)(B,"wc_settings_payments__banner")||(O=!0));const D=(0,n.useCallback)(((e,t,n)=>{s||(!n&&(0,L.mz)(e)&&(n=(0,L.SN)()),r(e),g([t]).then((async s=>{var o;(0,d.a)(s),P("getPaymentProviders");const c=(await(0,a.resolveSelect)(i.PAYMENT_SETTINGS_STORE_NAME).getPaymentProviders(b)).find((s=>s.id===e||s?._suggestion_id===e||s.plugin.slug===t));if((null!==(o=c?.onboarding?.recommended_payment_methods)&&void 0!==o?o:[]).length>0)return(0,m.getHistory)().push((0,m.getNewPath)({},"/payment-methods")),void r(null);r(null),n&&(window.location.href=n)})).catch((e=>{(0,d.a)(e),r(null)})))}),[s,g,P,b]);return(0,h.jsxs)(h.Fragment,{children:[R&&M&&B&&(0,h.jsx)(Q,{incentive:B,provider:M,onboardingUrl:null!==(e=M.onboarding?._links.onboard.href)&&void 0!==e?e:null,onDismiss:I,onAccept:A,setupPlugin:D}),w&&(0,h.jsxs)("div",{className:"notice notice-error is-dismissible wcpay-settings-notice",children:[(0,h.jsx)("p",{children:w}),(0,h.jsx)("button",{type:"button",className:"notice-dismiss",onClick:()=>{y(null)}})]}),O&&M&&B&&(0,h.jsx)(J,{incentive:B,provider:M,onboardingUrl:null!==(t=M.onboarding?._links.onboard.href)&&void 0!==t?t:null,onDismiss:I,onAccept:A,setupPlugin:D}),(0,h.jsxs)("div",{className:"settings-payments-main__container",children:[(0,h.jsx)(V,{providers:_||S,installedPluginSlugs:k,installingPlugin:s,setupPlugin:D,acceptIncentive:A,updateOrdering:function(e){const t=e.map((e=>e._order)).sort(((e,t)=>e-t)),s={};e.forEach(((e,n)=>{s[e.id]=t[n]})),p(s),u(e)},isFetching:E,businessRegistrationCountry:b,setBusinessRegistrationCountry:N}),(0,h.jsx)(x,{suggestions:C,suggestionCategories:T,installingPlugin:s,setupPlugin:D,isFetching:E})]}),(0,h.jsx)(H,{isOpen:v&&(0,L.eP)(S),devMode:(0,L.Av)(S),onClose:()=>j(!1)})]})},ee=X}}]);