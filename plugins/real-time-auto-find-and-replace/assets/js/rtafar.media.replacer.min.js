(()=>{var e={49:e=>{function t(e){return t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},t(e)}var a={objectToQueryParams:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Object.keys(e).map((function(o){var r=e[o],i=n?"".concat(n,"[").concat(o,"]"):o;return"object"!==t(r)||Array.isArray(r)?"".concat(encodeURIComponent(i),"=").concat(encodeURIComponent(r)):a.objectToQueryParams(r,i)})).join("&")}};e.exports=a},354:e=>{var t={warning:function(e){return t.removeMsg("notice"),'<div class="notice notice-warning">'+e+"</div>"},error:function(e){return t.removeMsg("notice"),'<div class="notice notice-error">'+e+"</div>"},info:function(e){return t.removeMsg("notice"),'<div class="notice notice-info">'+e+"</div>"},success:function(e){return t.removeMsg("notice"),'<div class="notice notice-success">'+e+"</div>"},removeMsg:function(e){jQuery("."+e).hide("slow").remove()}};e.exports=t}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,a),r.exports}function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function o(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,r(n.key),n)}}function r(e){var t=function(e,t){if("object"!=n(e)||!e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var o=a.call(e,t||"default");if("object"!=n(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==n(t)?t:t+""}var i=a(49),l=a(354);new(function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.selectedFile=null,this.init()},t=[{key:"init",value:function(){this.bindEvents()}},{key:"bindEvents",value:function(){var e=this;jQuery(document).ready((function(){e.setupSearchInput(),e.setupReplaceButton(),e.setupPopupHandlers(),e.setupFileUploadHandlers(),e.setupUploadButton()}))}},{key:"setupSearchInput",value:function(){jQuery(".input-media-replace-query").on("keyup",(function(e){var t=jQuery(e.target).val();if(t.length>=2){var a={action:"query-attachments",post_id:0,query:{orderby:"date",s:t,order:"DESC",post_per_page:80,paged:1,post_mime_type:"image"}};fetch(ajaxurl,{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:i.objectToQueryParams(a)}).then((function(e){return e.json()})).then((function(e){if("object"===n(e.data)&&0!==Object.keys(e.data).length){var t=e.data.map((function(e){if("image"===e.type){var t="image"===e.type?e.url:e.thumb.src;return'<div class="image-item">\n                                        <img class="media-item-'.concat(e.id,'" data-id="').concat(e.id,'" src="').concat(t,'" alt="').concat(e.title,'" height="250px">\n                                        <button class="button-overlay btn-img-replace" data-id="').concat(e.id,'">Replace</button>\n                                    </div>')}})).join("");jQuery(".image-container").html(t)}else jQuery(".image-container").html("No images found. Try searching with a new word..")}))}else jQuery(".image-container").html("Please type at least 2 characters to get images..")}))}},{key:"setupReplaceButton",value:function(){var e=this;jQuery("body").on("click",".btn-img-replace",(function(t){jQuery(".notice").hide("slow"),jQuery("#popup1").addClass("show-popup").removeClass("hide-popup"),jQuery("#popup1 > .popup > .content").removeClass("hidden"),jQuery(".title-popup-media-replacer ").text("Upload New Media File");var a=jQuery(t.target).data("id");a?(e.enableDetailForm(),wp.media.attachment(a).fetch().then((function(e){jQuery(".preview-image-old").attr({src:e.url,"data-oldimgid":e.id}),jQuery(".ai-date").html(e.dateFormatted),jQuery(".author-info").html('<a href="'.concat(e.authorLink,'">').concat(e.authorName,"</a>")),jQuery(".ai-filename").html(e.filename),jQuery(".ai-filetype").html(e.mime),jQuery(".ai-filesize").html(e.filesizeHumanReadable),jQuery(".ai-dimensions").html("".concat(e.height," by ").concat(e.width)),jQuery("#attachment-details-two-column-alt-text").val(e.alt),jQuery("#attachment-details-two-column-title").val(e.title),jQuery("#attachment-details-two-column-caption").val(e.caption),jQuery("#attachment-details-two-column-description").val(e.description),jQuery(".attachment-details-copy-link").val(e.url)}))):alert("No attachment ID found.")}))}},{key:"setupPopupHandlers",value:function(){var e=this;jQuery("body").on("click",".popup a.close",(function(){jQuery("#popup1").addClass("hide-popup").removeClass("show-popup"),e.resetFormData()}))}},{key:"setupFileUploadHandlers",value:function(){var e=this,t=jQuery("#upload-container"),a=jQuery("#file-input");jQuery(".upload-preview"),t.on("dragover",(function(e){e.preventDefault(),t.addClass("dragover")})),t.on("dragleave",(function(){t.removeClass("dragover")})),t.on("drop",(function(a){a.preventDefault(),t.removeClass("dragover");var n=a.originalEvent.dataTransfer.files[0];n&&e.handleFileSelection(n)})),a.on("change",(function(t){var a=t.target.files[0];a&&e.handleFileSelection(a)}))}},{key:"handleFileSelection",value:function(e){var t=jQuery(".upload-preview");if(e.type.startsWith("image/")){this.selectedFile=e;var a=new FileReader;a.onload=function(e){t.attr("src",e.target.result)},a.readAsDataURL(e)}else alert("Please select a valid image file.")}},{key:"setupUploadButton",value:function(){var e=this;jQuery(".btn-media-replace").on("click",(function(t){var a=jQuery(t.target);if(jQuery(".response").html(""),a.prop("disabled",!0).text("Replacing..."),!e.selectedFile)return a.prop("disabled",!1).text("Replace"),void jQuery(".response").html(l.error("Error: Please select a new file to proceed with the replacement..."));jQuery(e).text("Replacing..");var n=jQuery(".preview-image-old").attr("data-oldimgid"),o=jQuery("#cs_token").val(),r=jQuery("#attachment-details-two-column-alt-text").val(),i=jQuery("#attachment-details-two-column-title").val(),c=jQuery("#attachment-details-two-column-caption").val(),u=jQuery("#attachment-details-two-column-description").val();e.disableDetailForm();var s=new FormData;s.append("media_file",e.selectedFile),s.append("attachment_id",n),s.append("cs_token",o),s.append("action","rtafar_ajax"),s.append("method","admin\\functions\\MediaImageReplacer@handleMediaReplace"),s.append("alt_text",r),s.append("caption",c),s.append("description",u),s.append("title",i),jQuery.ajax({url:ajaxurl,type:"POST",data:s,processData:!1,contentType:!1,success:function(t){t.success?(jQuery(".response").html(l.success(t.message)),jQuery(".media-item-"+t.media_id).attr("src",""),a.prop("disabled",!0).text("Success! Redirecting.."),setTimeout((function(){jQuery(".media-item-"+t.media_id).attr("src",t.new_media_url),e.enableDetailForm(),a.prop("disabled",!1).text("Replace"),e.closePopup()}),1e3)):jQuery(".response").html(l.error("Error: "+t.message))},error:function(){jQuery(".response").html(l.error("An error occurred while uploading the image."))}})}))}},{key:"resetFormData",value:function(){this.selectedFile=null,jQuery("#file-input").val(""),jQuery(".upload-preview").attr("src",rtafr.pimg)}},{key:"closePopup",value:function(){this.resetFormData(),jQuery("#popup1").addClass("hide-popup").removeClass("show-popup")}},{key:"enableDetailForm",value:function(){jQuery("#attachment-details-two-column-alt-text, #attachment-details-two-column-title, #attachment-details-two-column-caption, #attachment-details-two-column-description").removeAttr("readonly")}},{key:"disableDetailForm",value:function(){jQuery("#attachment-details-two-column-alt-text, #attachment-details-two-column-title, #attachment-details-two-column-caption, #attachment-details-two-column-description").prop("readonly",!0)}}],t&&o(e.prototype,t),a&&o(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,a}())})();