{"version":3,"file":"legacyAction.js","mappings":"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","sources":["webpack://post-expirator/./assets/jsx/components/FutureActionPanelAfterActionField.jsx","webpack://post-expirator/external var \"wp.components\"","webpack://post-expirator/external var \"wp.data\"","webpack://post-expirator/external var \"wp.element\"","webpack://post-expirator/external var \"wp.i18n\"","webpack://post-expirator/webpack/bootstrap","webpack://post-expirator/webpack/runtime/compat get default export","webpack://post-expirator/webpack/runtime/define property getters","webpack://post-expirator/webpack/runtime/hasOwnProperty shorthand","webpack://post-expirator/webpack/runtime/make namespace object","webpack://post-expirator/./assets/jsx/legacy-action/index.jsx"],"sourcesContent":["import { Slot, Fill } from '@wordpress/components';\n\nexport const FutureActionPanelAfterActionField = ({ children }) => (\n    <Fill name=\"FutureActionPanelAfterActionField\">\n        {children}\n    </Fill>\n);\n\nconst FutureActionPanelAfterActionFieldSlot = (props) => (\n    <Slot name=\"FutureActionPanelAfterActionField\" {...props} />\n);\n\nFutureActionPanelAfterActionField.Slot = FutureActionPanelAfterActionFieldSlot;\n\nexport default FutureActionPanelAfterActionField;\n","module.exports = wp.components;","module.exports = wp.data;","module.exports = wp.element;","module.exports = wp.i18n;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import { PanelRow, SelectControl } from '@wordpress/components';\nimport { __ } from '@wordpress/i18n';\nimport { useSelect, dispatch } from '@wordpress/data';\nimport { useEffect } from '@wordpress/element';\n\nimport { FutureActionPanelAfterActionField } from '../components/FutureActionPanelAfterActionField';\n\nconst { apiUrl, nonce, workflows } = futureWorkflows;\n\nconst Fields = ({ storeName }) => {\n    const defaultWorkflow = workflows.length > 0 ? workflows[0].value : 0;\n\n    const {\n        action,\n        workflowId,\n        postId,\n    } = useSelect((select) => {\n\n        const classicEditor = select('publishpress-future/future-action');\n        const blockEditor = select('core/edit-post');\n        const quickEdit = select('publishpress-future/future-action-quick-edit');\n        let postId = 0;\n\n        if (classicEditor && classicEditor.getPostId) {\n            postId = classicEditor.getPostId();\n        } else if (blockEditor && blockEditor.getCurrentPostId) {\n            postId = blockEditor.getCurrentPostId();\n        } else if (quickEdit && quickEdit.getPostId) {\n            postId = quickEdit.getPostId();\n        }\n\n        return {\n            action: select(storeName).getAction(),\n            workflowId: select(storeName).getExtraDataByName('workflowId') || defaultWorkflow,\n            postId: postId,\n        };\n    });\n\n    const {\n        setExtraDataByName,\n    } = dispatch(storeName);\n\n    const handleActionChange = (value) => {\n        setExtraDataByName('workflowId', value);\n    }\n\n    useEffect(() => {\n        if (postId) {\n            try {\n                wp.apiFetch({\n                    url: `${apiUrl}/post-expiration/${postId}`,\n                    headers: {\n                        'X-WP-Nonce': nonce,\n                    },\n                }).then((data) => {\n                    setExtraDataByName('workflowId', data.extraData.workflowId);\n                });\n            } catch (error) {\n                console.error(error);\n            }\n        }\n    }, []);\n\n    return (\n        <>\n            {workflows.length > 0 && action === 'trigger-workflow' &&\n                <PanelRow className='future-action-panel-content future-action-full-width'>\n                    <SelectControl\n                        label={__('Workflow to trigger', 'post-expirator')}\n                        value={workflowId}\n                        options={workflows}\n                        onChange={handleActionChange}\n                        className='future-action-workflow'\n                    />\n                    <input type='hidden' name='future_action_pro_workflow' value={workflowId} />\n                </PanelRow>\n            }\n\n            { workflows.length === 0 && action === 'trigger-workflow' &&\n                <PanelRow className='future-action-panel-content future-action-full-width'>\n                    <p>{__('No compatible workflows available.', 'post-expirator')}</p>\n                </PanelRow>\n            }\n        </>\n    );\n}\n\n\nconst LegacyActionFields = () => (\n    <FutureActionPanelAfterActionField>\n        {({ storeName }) => {\n            return <Fields storeName={storeName} />;\n        }}\n    </FutureActionPanelAfterActionField>\n\n);\n\nwp.plugins.registerPlugin('legacy-action-plugin', { render: LegacyActionFields, scope: 'publishpress-future' });\n"],"names":["Slot","Fill","FutureActionPanelAfterActionField","_ref","children","React","createElement","name","FutureActionPanelAfterActionFieldSlot","props","_extends","PanelRow","SelectControl","__","useSelect","dispatch","useEffect","_futureWorkflows","futureWorkflows","apiUrl","nonce","workflows","Fields","storeName","defaultWorkflow","length","value","_useSelect","select","classicEditor","blockEditor","quickEdit","postId","getPostId","getCurrentPostId","action","getAction","workflowId","getExtraDataByName","_dispatch","setExtraDataByName","handleActionChange","wp","apiFetch","url","concat","headers","then","data","extraData","error","console","Fragment","className","label","options","onChange","type","LegacyActionFields","_ref2","plugins","registerPlugin","render","scope"],"sourceRoot":""}