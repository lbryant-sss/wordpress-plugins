var V=Object.defineProperty;var E=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,G=Object.prototype.propertyIsEnumerable;var S=(i,m,t)=>m in i?V(i,m,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[m]=t,b=(i,m)=>{for(var t in m||(m={}))B.call(m,t)&&S(i,t,m[t]);if(E)for(var t of E(m))G.call(m,t)&&S(i,t,m[t]);return i};import{r as A,j as e,T as H,_ as a,M as J,u as Y,bj as K,J as Q,$ as W,e as X}from"./main-381.js";import{a8 as q,a9 as D,aa as g,ab as f}from"./bf-433-81.js";import{C as L}from"./bf-841-104.js";import{T as C}from"./bf-254-189.js";import{r as ee,a as se,b as le}from"./bf-977-94.js";import{S as ie}from"./bf-878-172.js";import{M as ae}from"./bf-445-114.js";function te({creatorConf:i,setCreatorConf:m}){var u,r,F,o,v;const[t,s]=A.useState(!1),d=(n,h)=>{var N;const p=b({},i);h==="update"&&(n.target.checked&&!((N=p==null?void 0:p.actions)!=null&&N.update)?(p.actions.update={insert:!0,criteria:""},s(!0)):delete p.actions.update),m(b({},p))},x=(n,h)=>{const p=b({},i);h==="criteria"&&(p.actions.update.criteria=n),h==="insert"&&(p.actions.update.insert=n),m(b({},p))},j=()=>{var n;if(!((n=i.actions)!=null&&n.update)){const h=b({},i);h.actions.update={insert:!0,criteria:""},m(b({},h))}s(!0)};return A.useEffect(()=>{var n,h;if(!t&&!((h=(n=i.actions)==null?void 0:n.update)!=null&&h.criteria)){const p=b({},i);delete p.actions.update,m(b({},p))}},[t]),e.jsxs("div",{className:"pos-rel",children:[e.jsx("div",{className:"d-flx flx-wrp",children:e.jsx(C,{action:j,children:e.jsx(H,{onChange:n=>d(n,"update"),checked:"update"in(i==null?void 0:i.actions),className:"wdt-200 mt-4 mr-2",value:"Upsert_Record",title:a("Update Record"),subTitle:a("Control how the record gets updated.")})})}),e.jsx(J,{md:!0,show:t,setModal:s,title:a("Update Row"),children:e.jsx("div",{className:"o-a",children:((u=i==null?void 0:i.actions)==null?void 0:u.update)&&e.jsxs(e.Fragment,{children:[e.jsx("small",{children:a("Enter the criteria to update records. Please use the below format.")}),e.jsx("br",{}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("small",{children:[a("Example:")," ",'(Email==\\"test@mail.com\\")']}),e.jsx("br",{}),e.jsx("br",{}),e.jsxs("small",{children:[a("Here Email is Zoho Creator Field link name. info:")," ",e.jsx("a",{href:"https://www.zoho.com/creator/help/api/v2/update-records.html",target:"_blank",rel:"noreferrer",children:a("Zoho Creator Criteria Guide")})]}),e.jsx("textarea",{name:"",rows:"5",className:"btcd-paper-inp mt-1",onChange:n=>x(n.target.value,"criteria"),value:(F=(r=i.actions)==null?void 0:r.update)==null?void 0:F.criteria})]}),e.jsx("div",{className:"font-w-m mt-3",children:a("Update Preferance")}),e.jsx("small",{children:a("insert new record if the above criteria doesn&apos;t met?")}),e.jsxs("div",{children:[e.jsx(L,{onChange:()=>x(!0,"insert"),radio:!0,checked:(o=i.actions.update)==null?void 0:o.insert,name:"up-row",title:a("Yes")}),e.jsx(L,{onChange:()=>x(!1,"insert"),radio:!0,checked:!((v=i.actions.update)!=null&&v.insert),name:"up-row",title:a("No")})]})]})})})]})}function P({i,formFields:m,uploadFields:t,field:s,creatorConf:d,setCreatorConf:x}){var v,n,h,p,N,c,y,w,I,k,M,U,R,_,z,O,$,T,Z;const{applicationId:j,formId:u}=d;let r;t?r=s.zohoFormField===""||((N=(p=(h=(n=(v=d.default)==null?void 0:v.fields)==null?void 0:n[j])==null?void 0:h[u])==null?void 0:p.requiredFileUploadFields)==null?void 0:N.indexOf(s.zohoFormField))===-1:r=s.zohoFormField===""||((k=(I=(w=(y=(c=d.default)==null?void 0:c.fields)==null?void 0:y[j])==null?void 0:w[u])==null?void 0:I.required)==null?void 0:k.indexOf(s.zohoFormField))===-1;const F=Y(W),{isPro:o}=F;return e.jsxs("div",{className:"flx mt-2 mr-1",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:s.formField||"",onChange:l=>q(l,i,d,x,t),children:[e.jsx("option",{value:"",children:a("Select Field")}),e.jsx("optgroup",{label:"Form Fields",children:t?m.map(l=>K.includes(l.type)&&e.jsx("option",{value:l.key,children:l.name},`ff-zhcrm-${l.key}`)):m.map(l=>l.type!=="file-up"&&e.jsx("option",{value:l.key,children:l.name},`ff-zhcrm-${l.key}`))}),e.jsx("option",{value:"custom",children:a("Custom...")}),e.jsx("optgroup",{label:`General Smart Codes ${o?"":"(PRO)"}`,children:o&&((M=ie)==null?void 0:M.map(l=>e.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`)))})]}),s.formField==="custom"&&e.jsx(ae,{onChange:l=>D(l,i,d,x),label:a("Custom Value"),className:"mr-2",type:"text",value:s.customValue,placeholder:a("Custom Value")}),e.jsxs("select",{className:"btcd-paper-inp",name:"zohoFormField",value:s.zohoFormField||"",disabled:!r,onChange:l=>q(l,i,d,x,t),children:[e.jsx("option",{value:"",children:a("Select Field")}),t?((z=(_=(R=(U=d.default)==null?void 0:U.fields)==null?void 0:R[j])==null?void 0:_[u])==null?void 0:z.fileUploadFields)&&Object.values(d.default.fields[j][u].fileUploadFields).map(l=>r?l.required===!1&&e.jsx("option",{value:l.apiName,children:l.displayLabel},l.displayLabel):e.jsx("option",{value:l.apiName,children:l.displayLabel},l.displayLabel)):((Z=(T=($=(O=d.default)==null?void 0:O.fields)==null?void 0:$[j])==null?void 0:T[u])==null?void 0:Z.fields)&&Object.values(d.default.fields[j][u].fields).map(l=>r?l.required===!1&&e.jsx("option",{value:l.apiName,children:l.displayLabel},l.displayLabel):e.jsx("option",{value:l.apiName,children:l.displayLabel},l.displayLabel))]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>g(i,d,x,t),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>f(i,d,x,t),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx(Q,{})})]})]})}function je({formID:i,formFields:m,handleInput:t,creatorConf:s,setCreatorConf:d,isLoading:x,setisLoading:j,setSnackbar:u}){var r,F,o,v,n,h,p,N;return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-100 d-in-b",children:a("Application:")}),e.jsxs("select",{onChange:t,name:"applicationId",value:s.applicationId,className:"btcd-paper-inp w-7",children:[e.jsx("option",{value:"",children:a("Select Application")}),((r=s==null?void 0:s.default)==null?void 0:r.applications)&&Object.values(s.default.applications).map(c=>e.jsx("option",{value:c.applicationId,children:c.applicationName},c.applicationId))]}),e.jsx("button",{onClick:()=>ee(i,s,d,j,u),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Creator Portals"'},type:"button",disabled:x,children:"↻"}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("b",{className:"wdt-100 d-in-b",children:a("Form:")}),e.jsxs("select",{onChange:t,name:"formId",value:s.formId,className:"btcd-paper-inp w-7",children:[e.jsx("option",{value:"",children:a("Select Form")}),((o=(F=s==null?void 0:s.default)==null?void 0:F.forms)==null?void 0:o[s.applicationId])&&Object.values(s.default.forms[s.applicationId]).map(c=>e.jsx("option",{value:c.formId,children:c.formName},c.formId))]}),e.jsx("button",{onClick:()=>se(i,s,d,j,u),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Creator Departments"'},type:"button",disabled:x,children:"↻"}),e.jsx("br",{}),e.jsx("br",{}),x&&e.jsx(X,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.formId&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mt-4",children:[e.jsx("b",{className:"wdt-100",children:a("Map Fields")}),e.jsx("button",{onClick:()=>le(i,s,d,j,u),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh Creator Fields")}'`},type:"button",disabled:x,children:"↻"})]}),e.jsx("div",{className:"btcd-hr mt-1"}),((h=(n=(v=s.default)==null?void 0:v.fields)==null?void 0:n[s==null?void 0:s.applicationId])==null?void 0:h[s==null?void 0:s.formId])&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Zoho Fields")})})]}),s.field_map.map((c,y)=>e.jsx(P,{i:y,field:c,creatorConf:s,formFields:m,setCreatorConf:d},`creator-m-${y+9}`)),e.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:e.jsx("button",{onClick:()=>g(s.field_map.length,s,d),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),Object.keys((p=s.default.fields[s.applicationId][s.formId])==null?void 0:p.fileUploadFields).length!==0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:a("Map File Upload Fields")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Form Fields")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:a("Zoho Fields")})})]}),(N=s==null?void 0:s.upload_field_map)==null?void 0:N.map((c,y)=>e.jsx(P,{i:y,field:c,creatorConf:s,formFields:m,setCreatorConf:d,uploadFields:!0},`creator-m-${y+9}`)),e.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:e.jsx("button",{onClick:()=>{var c;return g((c=s==null?void 0:s.upload_field_map)==null?void 0:c.length,s,d,!0)},className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{})]}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:a("Actions")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(te,{creatorConf:s,setCreatorConf:d})]})]})]})}export{je as Z};
