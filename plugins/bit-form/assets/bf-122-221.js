var _=Object.defineProperty;var N=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var g=(l,c,s)=>c in l?_(l,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):l[c]=s,b=(l,c)=>{for(var s in c||(c={}))A.call(c,s)&&g(l,s,c[s]);if(N)for(var s of N(c))M.call(c,s)&&g(l,s,c[s]);return l};import{r as F,j as e,T as y,_ as i,d as T,bo as k,e as S}from"./main-559.js";import{u as R,P as U}from"./bf-669-79.js";import{ac as z}from"./bf-946-81.js";import{h as w,g as E,a as O}from"./bf-163-91.js";function V({oneDriveConf:l,setOneDriveConf:c,formFields:s,formID:h,setSnackbar:x}){var u;l.folderMap?l.folderMap[0]:l.folder,F.useState(!1);const[m,r]=F.useState({show:!1}),f=(t,d,o)=>{const p=b({},l);d==="create_folder"?t.target.checked?p.actions.create_folder={name:"",suffix:!1}:(delete p.actions.create_folder,delete p.actions.share.folder):d==="attachments"&&(t!==""?p.actions.attachments=t:(delete p.actions.attachments,delete p.actions.share.file)),c(b({},p))},j=()=>{var t,d,o;(t=l.actions)!=null&&t.share||(l.actions.share={}),(o=(d=l.actions)==null?void 0:d.share)!=null&&o.file||(l.actions.share.file={permissions:[{email:"",access:"34",accessLabel:"View"},{email:"",access:"5",accessLabel:"Edit"},{email:"",access:"4",accessLabel:"Share"},{email:"",access:"6",accessLabel:"View and Comment"}],mail:"false"}),r({show:"attachments"})},a=(t,d)=>{const o=b({},l);d==="deleteFile"&&(t.target.checked?o.actions.delete_from_wp=!0:delete o.actions.delete_from_wp),c(b({},o))},n=()=>s.filter(t=>k.includes(t.type)).map(t=>({label:t.lbl,value:t.key}));return e.jsxs("div",{className:"pos-rel d-flx w-5",children:[e.jsxs("div",{className:"pos-rel d-flx flx-col w-8",children:[e.jsx(y,{onChange:j,checked:"attachments"in l.actions,className:"wdt-200 mt-4 mr-2",value:"Attachment",title:i("Upload Files"),subTitle:i("Add attachments from Bit-integration-pro to OneDrive folder.")}),!l.actions.attachments&&e.jsx("small",{style:{marginLeft:30,marginTop:10,color:"red",fontWeight:"bold"},children:i("This action is required.")})]}),e.jsx(T,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:"Ok",show:m.show==="attachments",close:()=>r({show:!1}),action:()=>r({show:!1}),title:i("Select Attachment"),children:e.jsxs("div",{style:{height:"95%"},children:[e.jsx("div",{className:"mt-2",children:i("Select file upload fields")}),e.jsx(R,{defaultValue:l.actions.attachments,className:"mt-2 w-10 mb-25",options:n(),onChange:t=>f(t,"attachments"),height:300})]})}),e.jsx("div",{className:"pos-rel d-flx flx-col w-8",children:e.jsx(y,{checked:((u=l.actions)==null?void 0:u.delete_from_wp)||!1,onChange:t=>a(t,"deleteFile"),className:"mt-4 mr-2",value:"delete_from_wp",title:i("Delete File From Wordpress"),subTitle:i("Delete file from Wordpress after upload in OneDrive")})})]})}function $({formID:l,formFields:c,oneDriveConf:s,setOneDriveConf:h,isLoading:x,setIsLoading:m,setSnackbar:r,setShowMdl:f}){var j;return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("b",{className:"wdt-150 d-in-b mr-2",children:i("Authorize App:")}),e.jsxs("select",{className:"btcd-paper-inp w-7",value:s.parentAppId,onChange:a=>w(a,s,h,l,m,r),name:"parentAppId",children:[e.jsx("option",{value:"",children:i("Select an App")}),z([s.type]).map(a=>e.jsx("option",{value:a.id,children:a.integration_name},a.id))]}),e.jsx("button",{"aria-label":"Add New",onClick:()=>f(!0),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Add New Authorize App"'},type:"button",disabled:x,children:e.jsx(U,{size:18})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("b",{className:"wdt-150 d-in-b mr-2",children:"Folder:"}),e.jsxs("select",{onChange:a=>w(a,s,h,l,m,r),name:"folder",value:s.folderMap[0]||s.folder,className:"btcd-paper-inp w-7",children:[e.jsx("option",{value:"",children:i("Select Folder")}),((j=s==null?void 0:s.default)==null?void 0:j.rootFolders)&&s.default.rootFolders.map(a=>e.jsx("option",{value:a.id,children:a.name},a.id))]}),e.jsx("button",{onClick:()=>E(l,s,h,m),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh All oneDrive Folders")}'`},type:"button",disabled:x,children:"↻"}),e.jsx("br",{}),s.folderMap.map((a,n)=>{var u,t;return e.jsxs("div",{children:[e.jsx("br",{}),e.jsxs("div",{className:"flx",children:[e.jsx("b",{className:"wdt-150 d-in-b mr-2"}),e.jsx("div",{className:"d-in-b",style:{width:(n+1)*10,marginLeft:1,marginRight:2,height:58,marginTop:-60},children:e.jsx("div",{className:"sub-tree"})}),e.jsxs("div",{className:"flx sub-folder w-7",children:[e.jsxs("select",{onChange:d=>w(d,s,h,l,m,r,n+1),name:"folder",value:s.folderMap[n+1]||s.folder,className:"btcd-paper-inp",children:[e.jsx("option",{value:s.folderMap[n],children:"/ root"}),((t=(u=s==null?void 0:s.default)==null?void 0:u.folders)==null?void 0:t[a])&&s.default.folders[a].map(d=>e.jsx("option",{value:d.id,children:d.name},d.id))]}),e.jsx("div",{className:"tooltip-box",children:e.jsx("button",{onClick:()=>O(l,s,h,m,r,n),className:"d-non icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${i("Refresh Sub Folders")}'`},type:"button",disabled:x,children:"↻"})})]})]})]},a)}),e.jsx("br",{}),e.jsx("br",{}),x&&e.jsx(S,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.folder&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:i("Actions")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(V,{oneDriveConf:s,setOneDriveConf:h,formFields:c,formID:l,setisLoading:m,setSnackbar:r})]})]})}export{$ as O};
