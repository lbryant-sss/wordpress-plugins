var J=Object.defineProperty;var M=Object.getOwnPropertySymbols;var K=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var $=(o,n,d)=>n in o?J(o,n,{enumerable:!0,configurable:!0,writable:!0,value:d}):o[n]=d,f=(o,n)=>{for(var d in n||(n={}))K.call(n,d)&&$(o,d,n[d]);if(M)for(var d of M(n))Q.call(n,d)&&$(o,d,n[d]);return o};import{G as V,g as X,r as h,c as j,j as e,S as Y,_ as l}from"./main-353.js";import{p as Z,S as T}from"./bf-371-208.js";import{C as b}from"./bf-821-79.js";import{a7 as ee}from"./bf-322-81.js";import{F as v,a as g,r as q,c as te,b as se}from"./bf-380-209.js";import"./bf-329-82.js";import"./bf-882-113.js";import"./bf-505-172.js";function he({formFields:o,setIntegration:n,integrations:d,allIntegURL:R}){var N;const D=V(),{id:_}=X(),[E,U]=h.useState([]),[z,F]=h.useState([]),[O,p]=h.useState([]),[B,G]=h.useState([]),[s,r]=h.useState(f({},d[_])),[L,u]=h.useState({show:!1});h.useEffect(()=>{j({},"bitforms_get_post_type").then(t=>{var a,c;t!=null&&t.success&&(U(Object.values((a=t==null?void 0:t.data)==null?void 0:a.post_types)),G((c=t==null?void 0:t.data)==null?void 0:c.users))}),j({post_type:s==null?void 0:s.post_type},"bitforms_get_custom_field").then(t=>{var a,c;t!=null&&t.success&&t!==void 0&&(F((a=t==null?void 0:t.data)==null?void 0:a.acfFields),p((c=t==null?void 0:t.data)==null?void 0:c.acfFile))})},[]);const x=(t,a,c)=>{const i=f({},s);c?i[t]=Number(a):i[t]=a,r(i)},W=(t,a)=>{const c=f({},s);c[t]=a,j({post_type:a},"bitforms_get_custom_field").then(i=>{var y,C,S,A,w,k,P,I;i!=null&&i.success&&i!==void 0&&(F((y=i==null?void 0:i.data)==null?void 0:y.acfFields),p((C=i==null?void 0:i.data)==null?void 0:C.acfFile),(S=i==null?void 0:i.data)!=null&&S.acfFields&&(c.acf_map=(w=(A=i==null?void 0:i.data)==null?void 0:A.acfFields)==null?void 0:w.filter(m=>m.required).map(m=>({formField:"",acfField:m.key,required:m.required})),((k=c==null?void 0:c.acf_map)==null?void 0:k.length)<1&&(c.acf_map=[{}])),(P=i==null?void 0:i.data)!=null&&P.acfFile&&(c.acf_file_map=i.data.acfFile.filter(m=>m.required).map(m=>({formField:"",acfFileUpload:m.key,required:m.required})),((I=c==null?void 0:c.acf_file_map)==null?void 0:I.length)<1&&(c.acf_file_map=[{}])),r(c))})},H=()=>{if(!te(s)){u({show:!0,msg:l("Please map mandatory fields")});return}if(!se(s)){u({show:!0,msg:l("Please map mandatory fields")});return}ee(d,n,R,s,D,_,"edit")};return e.jsxs("div",{style:{width:900},children:[e.jsx(Y,{snack:L,setSnackbar:u}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:l("Integration Name")})}),e.jsx("input",{className:"btcd-paper-inp w-5 mt-1",onChange:t=>x(t.target.name,t.target.value),name:"name",value:s.name,type:"text",placeholder:l("Integration Name...")}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:l("Post Type")}),e.jsx(b,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:[l("Select one of the defined WordPress post types Or custom post types for the post."),e.jsx("br",{})]})})]}),e.jsx("div",{children:e.jsxs("select",{name:"post_type",onChange:t=>W(t.target.name,t.target.value),value:s.post_type,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{disabled:!0,selected:!0,children:l("Select Post Type")}),E.map((t,a)=>e.jsx("option",{value:t==null?void 0:t.name,children:t==null?void 0:t.label},`acf-${a*2}`))]})}),e.jsxs("div",{className:"mt-3",children:[e.jsx("b",{children:l("Post Status")}),e.jsx(b,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:[l("Select the status for the post. If published status is selected and the post date is in the future, it will automatically be changed to scheduled"),e.jsx("br",{})]})})]}),e.jsxs("select",{name:"post_status",onChange:t=>x(t.target.name,t.target.value),value:s.post_status,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{value:"publish",children:"Publish"}),e.jsx("option",{value:"draft",children:"Draft"}),e.jsx("option",{value:"auto-draft",children:"Auto-Draft"}),e.jsx("option",{value:"private",children:"Private"}),e.jsx("option",{value:"pending",children:"Pending"})]}),e.jsxs("div",{className:"mt-3 flx",children:[e.jsx("b",{children:l("Author")}),e.jsx(b,{width:250,icnSize:17,className:"ml-2",children:e.jsxs("div",{className:"txt-body",children:[l("Select the user to be assigned to the post."),e.jsx("br",{})]})})]}),e.jsx("div",{children:e.jsxs("select",{name:"post_author",onChange:t=>x(t.target.name,t.target.value),value:s.post_author,className:"btcd-paper-inp w-5 mt-2",children:[e.jsx("option",{disabled:!0,selected:!0,children:l("Select Author")}),e.jsx("option",{value:"logged_in_user",children:"Logged In User"}),B.map((t,a)=>e.jsx("option",{value:t.ID,children:t.display_name},`acf-${a*2}`))]})}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:l("Comment Status")})}),e.jsxs("select",{name:"comment_status",onChange:t=>x(t.target.name,t.target.value),value:s.comment_status,className:"btcd-paper-inp w-5 mt-1",children:[e.jsx("option",{value:"open",children:"Open"}),e.jsx("option",{value:"closed",children:"Closed"})]}),e.jsx("br",{}),e.jsxs("div",{children:[e.jsx("div",{className:"mt-3 mb-1",children:e.jsx("b",{children:l("Field Mapping")})}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:l("Form Fields")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:l("Post Fields")})})]})]}),(N=s==null?void 0:s.post_map)==null?void 0:N.map((t,a)=>e.jsx(v,{i:a,type:"post",field:t,formFields:o,dataConf:s,setDataConf:r,customFields:Z},`analytics-m-${a+9}`)),e.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:e.jsx("button",{onClick:()=>{var t;return g("post_map",(t=s==null?void 0:s.post_map)==null?void 0:t.length,s,r)},className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("div",{children:e.jsxs("p",{className:"p-1 f-m",children:[e.jsx("strong",{children:"Note"})," ",": All your taxonomies will be mapped automatically from your form fields."]})}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mt-3 mb-1",children:[e.jsx("b",{children:l("ACF fields Mapping")}),e.jsx("button",{onClick:()=>q(s,p,p),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${l("Refresh ACF fields")}'`},type:"button",children:"↻"})]}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:l("Form Fields")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:l("ACF Fields")})})]})]}),s.acf_map.map((t,a)=>e.jsx(v,{i:a,type:"acf",field:t,formFields:o,dataConf:s,setDataConf:r,customFields:z,fieldType:"field"},`analytics-m-${a+9}`)),e.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:e.jsx("button",{onClick:()=>g("acf_map",s.acf_map.length,s,r),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsxs("div",{className:"mt-3 mb-1",children:[e.jsx("b",{children:l("ACF File Upload Fields Map")}),e.jsx("button",{onClick:()=>q(s,p,p),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${l("Refresh ACF fields")}'`},type:"button",children:"↻"})]}),e.jsx("div",{className:"btcd-hr"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:l("Form Fields")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:l("ACF Fields")})})]})]}),s.acf_file_map.map((t,a)=>e.jsx(v,{i:a,type:"acfFile",field:t,formFields:o,dataConf:s,setDataConf:r,customFields:O,fieldType:"file"},`analytics-m-${a+9}`)),e.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:e.jsx("button",{onClick:()=>g("acf_file_map",s.acf_file_map.length,s,r),className:"icn-btn sh-sm",type:"button",children:"+"})})]}),e.jsx(T,{onClick:()=>H()})]})}export{he as default};
