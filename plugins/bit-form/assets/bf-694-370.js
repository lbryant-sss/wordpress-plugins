var C=Object.defineProperty;var I=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var D=(a,t,s)=>t in a?C(a,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[t]=s,k=(a,t)=>{for(var s in t||(t={}))E.call(t,s)&&D(a,s,t[s]);if(I)for(var s of I(t))F.call(t,s)&&D(a,s,t[s]);return a};import{w as L,x as T,r,f as y,j as i,M as z,c6 as $,S as J}from"./main-461.js";import"./bf-908-79.js";import{S as P}from"./bf-90-262.js";import{ac as B,s as G,a7 as H}from"./bf-648-81.js";import{C as q}from"./bf-981-87.js";import{I as K}from"./bf-870-187.js";import{N as Q}from"./bf-427-108.js";import{g as R,O as N}from"./bf-131-90.js";import{O as V}from"./bf-914-223.js";import"./bf-824-88.js";function oe({formFields:a,setIntegration:t,integrations:s,allIntegURL:g}){const v=L(),{formID:p}=T(),[A,f]=r.useState(!1),[n,m]=r.useState(1),[O,h]=r.useState(!1),[M,u]=r.useState({show:!1}),[e,c]=r.useState({name:"OneDrive",type:"OneDrive",clientId:"",clientSecret:"",field_map:[{formField:"",OneDriveFormField:""}],folder:"",folderMap:[],foldersList:[],actions:{}}),w=B([e.type]),j=()=>{setTimeout(()=>{v(`${g}/new/${e.type}`)},1e3),h(!1)},_=(d,x)=>{if(d.integration_type===e.type){const l=JSON.parse(d.integration_details);c(o=>y(o,S=>{S.parentAppId=d.id,S.clientId=l.clientId,S.clientSecret=l.clientSecret,S.tokenDetails=l.tokenDetails})),m(2)}};r.useEffect(()=>{c(d=>y(d,x=>{const l=w.find(o=>o.id===e.parentAppId);if(l){const o=JSON.parse(l.integration_details);x.clientId=o.clientId,x.clientSecret=o.clientSecret,x.tokenDetails=o.tokenDetails}})),e!=null&&e.parentAppId&&R(p,e,c,f)},[e.parentAppId]),r.useEffect(()=>{window.opener&&G("oneDrive")},[]);const b=()=>{H(s,t,g,e,v)};return i.jsxs("div",{children:[i.jsx(z,{title:$("Authorize New One Drive App"),show:O,setModal:()=>h(!1),children:i.jsx(N,{formID:p,oneDriveConf:e,setOneDriveConf:c,step:n,setStep:m,isLoading:A,setIsLoading:f,setSnackbar:u,authorizedAction:j})}),i.jsx(J,{snack:M,setSnackbar:u}),i.jsx("div",{className:"txt-center w-9 mt-2 cal-width",children:i.jsx(P,{step:3,active:n})}),w.length>0&&n===1&&i.jsx(q,{allIntegURL:g,specificTypes:[e.type],onClickAction:_,allowAddNew:!0,addNewAction:()=>h(!0)}),n===1&&w.length===0&&i.jsx(N,{formID:p,oneDriveConf:e,setOneDriveConf:c,step:n,setStep:m,isLoading:A,setIsLoading:f,setSnackbar:u,authorizedAction:j}),i.jsxs("div",{className:"btcd-stp-page",style:k({},n===2&&{width:900,height:"100%",overflow:"visible"}),children:[i.jsx(V,{formID:p,formFields:a,oneDriveConf:e,setOneDriveConf:c,isLoading:A,setIsLoading:f,setSnackbar:u,setShowMdl:h}),i.jsx(Q,{nextPageHandler:()=>m(3),disabled:!e.actions.attachments||!e.folder})]}),i.jsx(K,{step:n,saveConfig:()=>b()})]})}export{oe as default};
