var bit_currency_field=function(){"use strict";return class{#t="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'/>";#e=null;#s=null;#i=null;#n=null;#r=null;#l=null;#c=null;#o=null;#a=null;#u=null;#h=null;#d=null;#p=null;#m=30;#y=!1;#f=[];#g;#C={};#b="";#E={maxHeight:370,searchCurrencyPlaceholder:"Search Currency",noCurrencyFoundText:"No Currency Found",selectedCurrencyClearable:!0,searchClearable:!0,selectedFlagImage:!0,defaultCurrencyKey:"",defaultValue:"",optionFlagImage:!0,inputFormatOptions:{formatter:"browser",showCurrencySymbol:!0,decimalSeparator:"."},valueFormatOptions:{formatter:"browser",showCurrencySymbol:!0,decimalSeparator:"."},attributes:{},classNames:{},assetsURL:""};#I=null;#v="";#w=[];constructor(t,e){Object.assign(this.#E,e),this.#C=e.window?e.window:window,this.#g=e.document?e.document:document,this.#e="string"==typeof t?this.#g.querySelector(t):t,"string"==typeof this.#E.options&&(this.#E.options=this.#S(this.#E.options)),this.#E.options=this.#E.options.filter(t=>!t.hide),this.#f=[...this.#E.options],this.fieldKey=this.#E.fieldKey,this.#b=e.assetsURL,this.init()}init(){this.#u=this.#x(`.${this.fieldKey}-currency-inner-wrp`),this.#h=this.#x(`.${this.fieldKey}-currency-amount-input`),this.#s=this.#x(`.${this.fieldKey}-currency-hidden-input`),this.#i=this.#x(`.${this.fieldKey}-input-clear-btn`),this.#l=this.#x(`.${this.fieldKey}-selected-currency-img`),this.#o=this.#x(`.${this.fieldKey}-option-search-wrp`),this.#a=this.#x(`.${this.fieldKey}-opt-search-input`),this.#n=this.#x(`.${this.fieldKey}-dpd-wrp`),this.#r=this.#x(`.${this.fieldKey}-option-wrp`),this.#d=this.#x(`.${this.fieldKey}-search-clear-btn`),this.#p=this.#x(`.${this.fieldKey}-option-list`),this.setMenu({open:!1}),this.#N(this.#e,"keydown",t=>{this.#F(t)}),this.#N(this.#n,"click",t=>{this.#A(t)}),this.#N(this.#n,"keyup",t=>{this.#A(t)}),this.#N(this.#h,"focus",()=>{this.#O()}),this.#N(this.#h,"blur",()=>{this.#$()}),this.#N(this.#h,"input",t=>{this.#L(t)}),this.#E.selectedCurrencyClearable&&this.#N(this.#i,"click",t=>{this.#V(t)}),this.#C.observeElm(this.#s,"value",(t,e)=>{this.#k(t,e)}),this.#E.defaultValue&&this.#T(),!this.#E.defaultValue&&this.#E.defaultCurrencyKey&&this.setSelectedCurrencyItem(this.#E.defaultCurrencyKey),this.#N(this.#p,"scroll",t=>{t.stopPagination()}),this.#E.searchClearable&&(this.#H(this.#a,"padding-right","35px"),this.#H(this.#d,"display","none"),this.#N(this.#d,"click",()=>{this.searchOptions("")})),this.#a.value="",this.#N(this.#a,"keyup",t=>{this.#W(t)})}#S(t){const e=t.split("->");let s=this.#C;return e.forEach(t=>{s=s[t]}),s}#O(){this.#K(this.#h,"type","number"),this.#h.value=this.#h.dataset.numValue||""}#P(t,e=0){const s=10**(e||0);return Math.round(t*s)/s}#$(){this.#K(this.#h,"type","text");const t=Number(this.#h.dataset.numValue);if(""===this.#h.dataset.numValue||Number.isNaN(t))return this.#h.value="",this.#s.value="",this.#K(this.#s,"value",""),void this.#B(this.#s,"blur");const{inputFormatOptions:e,valueFormatOptions:s}=this.#E,i=this.#M(t,e);this.#h.value=i,this.value=this.#M(t,s),this.#B(this.#s,"blur")}#M(t,e){const s=this.#D(),{defaultCurrencyKey:i}=this.#E,{formatter:n,roundToClosestInteger:r,showCurrencySymbol:l,currencyPosition:c,symbolPosition:o}=e,a=s?.i||i;if(!a)return t;r&&(t=this.#P(t));let u="";return"browser"===n?u=this.#R(t,a,e):"custom"!==n&&n?"none"===n&&(u=t):u=this.#U(t,e),"left-number"===o?u=`${s?.symbol||""}${u}`:"right-number"===o&&(u=`${u}${s?.symbol||""}`),l&&("left"===c?u=`${l?`${a} `:""}${u}`:"right"===c&&(u=`${u}${l?` ${a}`:""}`)),"left-currency"===o?u=`${s?.symbol||""}${u}`:"right-currency"===o&&(u=`${u}${s?.symbol||""}`),u}#R(t,e,s){const{showCurrencySymbol:i,roundToClosestInteger:n}=s;return new Intl.NumberFormat(navigator.language,{style:"currency",currency:e}).formatToParts(t).map(t=>!i&&"currency"===t.type||n&&("decimal"===t.type||"fraction"===t.type)?"":t.value).join("")}#U(t,e){const{decimalSeparator:s,roundToClosestFractionDigits:i,minimumFractionDigits:n=0,maximumFractionDigits:r=0,numberFormat:l=""}=e,[c]=l.split(s),[o,a=""]=t.toString().split("."),u=this.#z(o,c);let h=a;const d=h.length;if(d>0){const t=r>0;if(i&&h){let e;e=t&&d>r?r:n>0&&d<n?n:d,h=this.#P(Number(`0.${h}`),e).toString().replace("0.","")}t&&h&&(h=h.slice(0,r))}h.length<n&&(h=h.padEnd(n,"0"));let p="";return p=h?`${u}${s}${h}`:u,p}#z(t="",e=""){let s="",i=t.length-1;for(let n=e.length-1;n>=0;n--){const r=e[n],l=t[i];if(!l)break;"#"===r?(s=l+s,i--):s=r+s}return i>=0&&(s=t.substring(0,i+1)+s),s}#_(t=""){const{decimalSeparator:e}=this.#E.valueFormatOptions,s=new RegExp(`[^0-9${e}]`,"g");return t.replace(s,"")}#x(t){return this.#e.querySelector(t)}#N(t,e,s){t.addEventListener(e,s),this.#w.push({selector:t,eventType:e,cb:s})}#T(){this.#h.dataset.numValue=this.#_(this.#E.defaultValue),this.#k("",this.#E.defaultValue),this.#E.selectedCurrencyClearable&&this.#H(this.#i,"display","grid")}#F(t){const e=this.#g.activeElement;let s=null;const i=this.#q();if(t.target!==this.#h){if(i){const i=Number(e.dataset.index||-1);if("ArrowDown"===t.key||!t.shiftKey&&"Tab"===t.key){if(t.preventDefault(),e===this.#a)s=this.#x(".option:not(.disabled-opt)");else if(e.classList.contains("option")){const t=this.#j(i,"next"),e=this.#G(t);e?s=e:t+1<this.#f.length&&(this.virtualOptionList?.scrollToIndex(t),setTimeout(()=>{const e=this.#G(t);e&&e.focus()},50))}}else if("ArrowUp"===t.key||t.shiftKey&&"Tab"===t.key){if(t.preventDefault(),e===this.#a)s=this.#h,this.#q()&&this.setMenu({open:!1});else if(e.classList.contains("option")){const t=this.#j(i,"previous"),e=this.#G(t);e?s=e:t>0?(this.virtualOptionList?.scrollToIndex(t),setTimeout(()=>{const e=this.#G(t);e&&e.focus()},50)):e||(s=this.#a)}}else"Escape"===t.key&&this.setMenu({open:!1})}else if(t.key>="a"&&t.key<="z"){clearTimeout(this.#I),this.#v+=t.key,this.#I=setTimeout(()=>{this.#v=""},300);const e=this.#E.options.find(t=>!t.disabled&&t.lbl.toLowerCase().startsWith(this.#v));e&&this.setSelectedCurrencyItem(e.i)}else if("ArrowDown"===t.key||"ArrowUp"===t.key){t.preventDefault();const e=this.#Z(),s="ArrowDown"===t.key?"next":"previous",i=this.#j(e,s);i>-1&&i<this.#E.options.length&&(this.value=this.#E.options[i].val)}s&&s.focus()}}#B(t,e){const s=new Event(e);t.dispatchEvent(s)}#V(){this.#h.value="",this.#K(this.#s,"value",""),this.#K(this.#h,"data-num-value",""),this.setSelectedCurrencyItem(this.#E.defaultCurrencyKey),this.#B(this.#h,"input"),this.value="",this.#B(this.#s,"blur")}#G(t){return this.#x(`.${this.fieldKey}-option-list .option[data-index="${t}"]`)}#j(t=-1,e){if("next"===e){const e=this.#E.options.length;for(let s=t+1;s<e;s++)if(!this.#E.options[s].disabled)return s}else if("previous"===e)for(let e=t-1;e>=0;e--)if(!this.#E.options[e].disabled)return e}#J(t){this.#e.contains(t.target)||this.setMenu({open:!1})}#Q(t){return t?.match(/[a-zA-Z]+/)?.[0]||""}#k(t,e){const s=this.#Q(e),i=this.#E.options.find(t=>t.i===s);if((s&&i||!s&&this.#E.defaultCurrencyKey)&&t!==e){const t=this.#Q(this.#E.defaultValue);this.setSelectedCurrencyItem(s||t||this.#E.defaultCurrencyKey);const{decimalSeparator:i}=this.#E.valueFormatOptions,[n,r]=e.split(i),l=this.#_(n),c=this.#_(r),o=c?`${l}.${c}`:l;this.#K(this.#h,"data-num-value",o),this.#$()}"undefined"!=typeof bit_conditionals&&bit_conditionals({target:this.#s})}#L(t){const e=Number(t.target.value);this.#K(this.#h,"data-num-value",e||""),this.#E.selectedCurrencyClearable&&(e?this.#H(this.#i,"display","grid"):this.#H(this.#i,"display","none"))}#Z(){const t=this.#f.findIndex(t=>t.i===this.#c);return-1===t?0:t}#D(){return this.#E.options.find(t=>t.i===this.#c)}#X(t){return this.#g.createElement(t)}#Y(t,e){t.classList.add(e)}#tt(t,e){t.textContent=e}#K(t,e,s){t?.setAttribute?.(e,s)}#et(t,e){e.trim().split(/\b\s+\b/g).forEach(e=>this.#Y(t,e))}#st(t,e){const s=e.length;if(s)for(let i=0;i<s;i+=1)this.#K(t,e[i].key,e[i].value)}#H(t,e,s){t.style.setProperty(e,s,"important")}#it(){const t=this.#x(".option");if(!t)return;const e=this.#C.getComputedStyle(t),s=parseFloat(e.marginTop)+parseFloat(e.marginBottom),i=t.offsetHeight+s||0;i!==this.#m&&(this.#m=i,this.#p.innerHTML="",this.#nt())}#nt(){this.#p.innerHTML="";const t=this.#f.map((t,e)=>{const s=this.#X("li");if(this.#K(s,"data-key",t.i),this.#K(s,"data-index",e),"option"in this.#E.attributes){const t=this.#E.attributes.option;this.#st(s,t)}if(!t.i)return this.#tt(s,t.lbl),this.#Y(s,"opt-not-found"),s;if(this.#Y(s,"option"),"option"in this.#E.classNames){const t=this.#E.classNames.option;t&&this.#et(s,t)}const i=this.#X("span");if("opt-lbl-wrp"in this.#E.attributes){const t=this.#E.attributes["opt-lbl-wrp"];this.#st(i,t)}if(this.#Y(i,"opt-lbl-wrp"),"opt-lbl-wrp"in this.#E.classNames){const t=this.#E.classNames["opt-lbl-wrp"];t&&this.#et(i,t)}if(this.#E.optionFlagImage){const e=this.#X("img");if("opt-icn"in this.#E.attributes){const t=this.#E.attributes["opt-icn"];this.#st(e,t)}if(this.#Y(e,"opt-icn"),"opt-icn"in this.#E.classNames){const t=this.#E.classNames["opt-icn"];t&&this.#et(e,t)}e.src=`${this.#b}${t.img}`,e.alt=`${t.lbl} flag image`,e.loading="lazy",this.#K(e,"aria-hidden",!0),i.append(e)}const n=this.#X("span");if("opt-lbl"in this.#E.attributes){const t=this.#E.attributes["opt-lbl"];this.#st(n,t)}if(this.#Y(n,"opt-lbl"),"opt-lbl"in this.#E.classNames){const t=this.#E.classNames["opt-lbl"];t&&this.#et(n,t)}this.#tt(n,t.lbl),i.append(n);const r=this.#X("span");if("opt-suffix"in this.#E.attributes){const t=this.#E.attributes["opt-suffix"];this.#st(r,t)}if(this.#Y(r,"opt-suffix"),"opt-suffix"in this.#E.classNames){const t=this.#E.classNames["opt-suffix"];t&&this.#et(r,t)}return this.#tt(r,t.i),this.#K(s,"tabindex",this.#q()?"0":"-1"),this.#K(s,"role","option"),this.#K(s,"aria-posinset",e+1),this.#K(s,"aria-setsize",this.#f.length),this.#N(s,"click",t=>{this.#y=!0,this.setSelectedCurrencyItem(t.currentTarget.dataset.key)}),this.#N(s,"keyup",t=>{"Enter"===t.key&&(this.#y=!0,this.setSelectedCurrencyItem(t.currentTarget.dataset.key))}),t.disabled&&this.#Y(s,"disabled-opt"),s.append(i,r),this.#c===t.i?(this.#Y(s,"selected-opt"),this.#K(s,"aria-selected",!0)):this.#K(s,"aria-selected",!1),s});this.#p.append(...t)}#rt(){const t=this.#Q(this.#E.defaultValue);this.#c=t||this.#E.defaultCurrencyKey||"",this.#E.selectedFlagImage&&(this.#l.src=this.#t),this.setMenu({open:!1}),this.#K(this.#h,"data-num-value",""),this.#E.selectedCurrencyClearable&&this.#H(this.#i,"display","none"),this.#K(this.#s,"value",this.#E.defaultValue)}setSelectedCurrencyItem(t){if(this.#c=t,!this.#c)return void this.#rt();const e=this.#D();e&&(this.#E.selectedFlagImage&&(this.#l.src=`${this.#b}${e.img}`),this.setMenu({open:!1}),this.#$(),this.#y&&(!this.value&&this.#h.focus(),this.#y=!1))}#lt(){if(!this.#q())return;this.#nt();const t=this.#Z(),e=this.#x(`.option[data-index="${t}"]`);e&&e.scrollIntoView({block:"nearest",inline:"nearest"})}#ct(t){this.#a.value=t}#W(t){if("Enter"===t.key&&this.#f.length){const t=this.#x(".option")?.dataset.key;this.setSelectedCurrencyItem(t),this.searchOptions("")}else this.searchOptions(t.target.value)}#ot(t){if(""===t.target.value)return"required";const e=Number(t.target.value?.match(/[0-9.]+/)?.[0]),{minValue:s,maxValue:i}=this.#E;return""!==s&&e<s?"minValue":""!==i&&e>i?"maxValue":""}isValidated(){return this.#ot({target:this.#h})}searchOptions(t){this.#ct(t);let e=[];t?(e=this.#E.options.filter(e=>{const s=t.toLowerCase(),i=(e.lbl||"").toLowerCase(),n=(e.val||"").toLowerCase(),r=(e.i||"").toLowerCase();return!!i.includes(s)||!!n.includes(s)||!!r.includes(s)||void 0}),e.length||(e=[{i:0,lbl:this.#E.noCurrencyFoundText}]),this.#f=e,this.#E.searchClearable&&this.#H(this.#d,"display","grid")):(this.#f=this.#E.options,this.#E.searchClearable&&this.#H(this.#d,"display","none")),this.#lt()}#q(){return this.#e.classList.contains("menu-open")}#at(){const t=this.#u.getBoundingClientRect(),e=t.top,s=this.#C.innerHeight-t.bottom;s<e&&s<this.#E.maxHeight?(this.#H(this.#e,"flex-direction","column-reverse"),this.#H(this.#e,"bottom","0%")):(this.#H(this.#e,"flex-direction","column"),this.#H(this.#e,"bottom","auto"))}setMenu({open:t}){this.#H(this.#r,"max-height",`${t?this.#E.maxHeight:0}px`),t?(this.#at(),this.#Y(this.#e,"menu-open"),this.#N(this.#g,"click",t=>this.#J(t)),this.#K(this.#a,"tabindex",0),this.#K(this.#d,"tabindex",0),this.#K(this.#n,"aria-expanded",!0),this.#lt()):(this.#e.classList.remove("menu-open"),this.#g.removeEventListener("click",this.#J),setTimeout(()=>{this.searchOptions("")},100),this.#K(this.#a,"tabindex",-1),this.#K(this.#d,"tabindex",-1),this.#K(this.#n,"aria-expanded",!1))}#A(t){"Space"===t.code&&(this.#a.focus(),this.setMenu({open:!0})),"click"===t.type&&(this.#q()?this.setMenu({open:!1}):(this.#a.focus(),this.setMenu({open:!0})))}set value(t){this.#s.value=t||"",this.#K(this.#s,"value",t||"")}get value(){return this.#s.value}#ut(){this.#w.forEach(({selector:t,eventType:e,cb:s})=>{t.removeEventListener(e,s)})}destroy(){this.#p.innerHTML="",this.value=this.#E.defaultValue,this.#ut()}reset(){this.#rt(),this.destroy(),this.init()}}}();
