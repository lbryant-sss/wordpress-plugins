import{v as Z,w as M,r as i,f as A,j as t,M as T,S as C}from"./main-643.js";import"./bf-816-79.js";import{S as b}from"./bf-346-262.js";import{C as z}from"./bf-622-87.js";import{ac as P,s as L,a7 as _}from"./bf-397-81.js";import{I as $}from"./bf-840-187.js";import{N as B}from"./bf-170-108.js";import{Z as j}from"./bf-143-103.js";import{Z as J}from"./bf-898-201.js";import"./bf-53-88.js";import"./bf-539-189.js";function Y({formFields:I,setIntegration:k,integrations:y,allIntegURL:m}){const S=Z(),{formID:h}=M(),[f,u]=i.useState(!1),[N,w]=i.useState(!1),[a,l]=i.useState(1),[v,p]=i.useState({show:!1}),[e,c]=i.useState({name:"Zoho WorkDrive API",type:"Zoho WorkDrive",clientId:"",clientSecret:"",team:"",folder:"",folderMap:[],actions:{}}),x=P([e.type]),g=()=>{setTimeout(()=>{S(`${m}/new/${e.type}`)},1e3),w(!1)},E=(d,n)=>{if(d.integration_type===e.type){const o=JSON.parse(d.integration_details);c(s=>A(s,r=>{r.parentAppId=d.id,r.clientId=o.clientId,r.clientSecret=o.clientSecret,r.tokenDetails=o.tokenDetails,r.dataCenter=o.dataCenter,r.ownerEmail=o.ownerEmail})),l(2)}};i.useEffect(()=>{c(d=>A(d,n=>{const o=x.find(s=>s.id===e.parentAppId);if(o){const s=JSON.parse(o.integration_details);n.clientId=s.clientId,n.clientSecret=s.clientSecret,n.tokenDetails=s.tokenDetails,n.dataCenter=s.dataCenter,n.ownerEmail=s.ownerEmail}}))},[e.parentAppId]),i.useEffect(()=>{window.opener&&L("zohoWorkDrive")},[]);const D=()=>{setTimeout(()=>{document.getElementById("btcd-settings-wrp").scrollTop=0},300),e.team!==""&&e.folder!==""&&l(3)};return t.jsxs("div",{children:[t.jsx(T,{title:"Authorize New Zoho WorkDrive App",show:N,setModal:()=>w(!1),children:t.jsx(j,{formID:h,workDriveConf:e,setWorkDriveConf:c,step:a,setStep:l,isLoading:f,setisLoading:u,setSnackbar:p,authorizedAction:g})}),t.jsx(C,{snack:v,setSnackbar:p}),t.jsx("div",{className:"txt-center w-9 mt-2 cal-width",children:t.jsx(b,{step:3,active:a})}),x.length>0&&a===1&&t.jsx(z,{allIntegURL:m,specificTypes:[e.type],onClickAction:E,allowAddNew:!0,addNewAction:()=>w(!0)}),a===1&&x.length===0&&t.jsx(j,{formID:h,workDriveConf:e,setWorkDriveConf:c,step:a,setStep:l,isLoading:f,setisLoading:u,setSnackbar:p,authorizedAction:g}),t.jsxs("div",{className:"btcd-stp-page",style:{width:a===2&&900,height:a===2&&"100%"},children:[t.jsx(J,{formID:h,formFields:I,workDriveConf:e,setWorkDriveConf:c,isLoading:f,setisLoading:u,setSnackbar:p}),t.jsx(B,{nextPageHandler:()=>D(),disabled:e.team===""||e.folder===""})]}),t.jsx($,{step:a,saveConfig:()=>_(y,k,m,e,S)})]})}export{Y as default};
