var Y=Object.defineProperty;var z=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable;var L=(e,i,c)=>i in e?Y(e,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):e[i]=c,m=(e,i)=>{for(var c in i||(i={}))G.call(i,c)&&L(e,c,i[c]);if(z)for(var c of z(i))J.call(i,c)&&L(e,c,i[c]);return e};import{r as F,j as a,T as A,_ as r,M as I,bh as q,u as K,J as Q,$ as X,e as f}from"./main-381.js";import{a8 as P,a9 as D,aa as B,ab as C}from"./bf-433-81.js";import{u as aa}from"./bf-540-79.js";import{C as M}from"./bf-841-104.js";import{T as ea}from"./bf-254-189.js";import{r as sa,a as ta,b as ra}from"./bf-164-101.js";import{S as la}from"./bf-878-172.js";import{M as ia}from"./bf-445-114.js";function ca({sheetConf:e,setSheetConf:i,formFields:c}){var v,N,p,g,R,S,W,_,T,$,U,E,H,O,V;const[s,d]=F.useState(!1),[x,h]=F.useState({show:!1}),b=(t,o)=>{var k;const n=m({},e);o==="update"&&(t.target.checked&&!((k=n==null?void 0:n.actions)!=null&&k.update)?(n.actions.update={insert:!0,criteria:"",firstMatch:!1},d(!0)):delete n.actions.update),i(m({},n))},j=(t,o,n)=>{var Z;const k=m({},e);(Z=k.actions)!=null&&Z.share||(k.actions.share=[]),k.actions.share[t][o]=n,i(m({},k))},u=(t,o)=>{const n=m({},e);n.actions.update[o]=t,i(m({},n))},w=()=>{var t;if(!((t=e.actions)!=null&&t.update)){const o=m({},e);o.actions.update={insert:!0,criteria:"",firstMatch:!1},i(m({},o))}d(!0)},l=()=>{const t=m({},e);t.actions.share||(t.actions.share=[{email:"",field:"",access:"view",accessLabel:"Read Only"},{email:"",field:"",access:"view_and_comment",accessLabel:"Read/Comment"},{email:"",field:"",access:"edit",accessLabel:"Read/Edit"},{email:"",field:"",access:"share",accessLabel:"Co-Owner"},{email:"",field:"",access:"remove_share",accessLabel:"Remove Share"}]),i(m({},t)),h({show:"share"})},y=()=>{const t=[{title:"Form Fields",type:"group",childs:[]}];return t[0].childs=c.map(o=>({label:o.name,value:`\${${o.key}}`})),t};return F.useEffect(()=>{var t,o;if(!s&&!((o=(t=e.actions)==null?void 0:t.update)!=null&&o.criteria)){const n=m({},e);delete n.actions.update,i(m({},n))}},[s]),a.jsxs("div",{className:"pos-rel",children:[a.jsxs("div",{className:"d-flx flx-wrp",children:[((g=(p=(N=(v=e.default)==null?void 0:v.worksheets)==null?void 0:N.headers)==null?void 0:p[e.worksheet])==null?void 0:g[e.headerRow])&&a.jsx(ea,{action:w,children:a.jsx(A,{onChange:t=>b(t,"update"),checked:"update"in(e==null?void 0:e.actions),className:"wdt-200 mt-4 mr-2",value:"Upsert_Record",title:r("Update Row"),subTitle:r("Control how the row gets updated.")})}),a.jsx(A,{onChange:l,checked:((S=(R=e==null?void 0:e.actions)==null?void 0:R.share)==null?void 0:S.find(t=>t.email))||!1,className:"wdt-200 mt-4 mr-2",value:"user_share",title:r("Share Workbook"),subTitle:r("Share workbook with users pushed to Zoho Sheet.")})]}),a.jsx(I,{md:!0,show:s,setModal:d,title:r("Update Row"),children:a.jsx("div",{className:"o-a",children:((W=e==null?void 0:e.actions)==null?void 0:W.update)&&a.jsxs(a.Fragment,{children:[a.jsx("small",{children:r("Enter the criteria to update rows. Please use the below format.")}),a.jsx("br",{}),a.jsxs("div",{className:"mt-4",children:[a.jsxs("small",{children:["Example: ",'("Month"="March" or "Month"="April") and "Amount">30']}),a.jsx("br",{}),a.jsx("small",{children:"Here Month and Amount are Zoho Sheet's worksheet header name"})," ",a.jsx("span",{className:"icn-btn ml-2 tooltip",style:{"--tooltip-txt":'"Supported Relational Operators: =, !=, <, >, <=, >=, contains"',fontSize:15},children:a.jsx(q,{size:"15"})}),a.jsx("textarea",{name:"",rows:"5",className:"btcd-paper-inp mt-1",onChange:t=>u(t.target.value,"criteria"),value:(T=(_=e.actions)==null?void 0:_.update)==null?void 0:T.criteria})]}),a.jsx("div",{className:"font-w-m mt-3",children:r("Update Preferance")}),a.jsx("small",{children:r("update row for first match only?")}),a.jsxs("div",{children:[a.jsx(M,{onChange:()=>u(!0,"firstMatch"),radio:!0,checked:($=e.actions.update)==null?void 0:$.firstMatch,name:"firstMatch",title:r("Yes")}),a.jsx(M,{onChange:()=>u(!1,"firstMatch"),radio:!0,checked:!((U=e.actions.update)!=null&&U.firstMatch),name:"firstMatch",title:r("No")})]}),a.jsx("small",{children:r("insert new row if the above criteria doesn't met?")}),a.jsxs("div",{children:[a.jsx(M,{onChange:()=>u(!0,"insert"),radio:!0,checked:(E=e.actions.update)==null?void 0:E.insert,name:"up-row",title:r("Yes")}),a.jsx(M,{onChange:()=>u(!1,"insert"),radio:!0,checked:!((H=e.actions.update)!=null&&H.insert),name:"up-row",title:r("No")})]})]})})}),a.jsx(I,{md:!0,show:x.show==="share",setModal:()=>h({show:!1}),title:r("Share Settings"),children:a.jsx("div",{className:"o-a",style:{height:"95%"},children:((V=(O=e==null?void 0:e.actions)==null?void 0:O.share)==null?void 0:V.length)>0&&e.actions.share.map((t,o)=>a.jsxs("div",{className:"flx flx-between mt-2",children:[a.jsx(aa,{className:"btcd-paper-drpdwn w-7 mr-2",placeholder:"Input Email Address(s)",defaultValue:t.email,onChange:n=>j(o,"email",n),options:y(),customValue:!0}),a.jsx("input",{className:"btcd-paper-inp w-3",type:"text",value:t.accessLabel,readOnly:!0})]},t.accessLabel))})})]})}function da({i:e,formFields:i,field:c,sheetConf:s,setSheetConf:d}){var b,j,u,w;const x=K(X),{isPro:h}=x;return a.jsxs("div",{className:"flx mt-2 mr-1",children:[a.jsxs("div",{className:"flx integ-fld-wrp",children:[a.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:c.formField||"",onChange:l=>P(l,e,s,d),children:[a.jsx("option",{value:"",children:r("Select Field")}),a.jsx("optgroup",{label:"Form Fields",children:i.map(l=>l.type!=="file-up"&&a.jsx("option",{value:l.key,children:l.name},`ff-zhcrm-${l.key}`))}),a.jsx("option",{value:"custom",children:r("Custom...")}),a.jsx("optgroup",{label:`General Smart Codes ${h?"":"(PRO)"}`,children:h&&((b=la)==null?void 0:b.map(l=>a.jsx("option",{value:l.name,children:l.label},`ff-rm-${l.name}`)))})]}),c.formField==="custom"&&a.jsx(ia,{onChange:l=>D(l,e,s,d),label:r("Custom Value"),className:"mr-2",type:"text",value:c.customValue,placeholder:r("Custom Value")}),a.jsxs("select",{className:"btcd-paper-inp",name:"zohoFormField",value:c.zohoFormField||"",onChange:l=>P(l,e,s,d),children:[a.jsx("option",{value:"",children:r("Select Field")}),((w=(u=(j=s.default.worksheets)==null?void 0:j.headers)==null?void 0:u[s.worksheet])==null?void 0:w[s.headerRow])&&Object.values(s.default.worksheets.headers[s.worksheet][s.headerRow]).map(l=>a.jsx("option",{value:l,children:l},`${l}-1`))]})]}),a.jsx("button",{onClick:()=>B(e,s,d),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),a.jsx("button",{onClick:()=>C(e,s,d),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:a.jsx(Q,{})})]})}function wa({formID:e,formFields:i,handleInput:c,sheetConf:s,setSheetConf:d,isLoading:x,setisLoading:h,setSnackbar:b}){var j,u,w,l,y,v,N;return a.jsxs(a.Fragment,{children:[a.jsx("br",{}),a.jsx("b",{className:"wdt-150 d-in-b",children:r("Workbook:")}),a.jsxs("select",{onChange:c,name:"workbook",value:s.workbook,className:"btcd-paper-inp w-7",children:[a.jsx("option",{value:"",children:r("Select Workbook")}),((j=s==null?void 0:s.default)==null?void 0:j.workbooks)&&Object.keys(s.default.workbooks).map(p=>a.jsx("option",{value:s.default.workbooks[p].workbookId,children:s.default.workbooks[p].workbookName},p))]}),a.jsx("button",{onClick:()=>sa(e,s,d,h,b),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Sheet Workbooks"'},type:"button",disabled:x,children:"↻"}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("b",{className:"wdt-150 d-in-b",children:"Worksheet:"}),a.jsxs("select",{onChange:c,name:"worksheet",value:s.worksheet,className:"btcd-paper-inp w-7",children:[a.jsx("option",{value:"",children:r("Select Worksheet")}),((w=(u=s==null?void 0:s.default)==null?void 0:u.worksheets)==null?void 0:w[s.workbook])&&s.default.worksheets[s.workbook].map(p=>a.jsx("option",{value:p,children:p},p))]}),a.jsx("button",{onClick:()=>ta(e,s,d,h,b),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Sheet Worksheets"'},type:"button",disabled:x,children:"↻"}),a.jsx("br",{}),a.jsx("br",{}),a.jsx("b",{className:"wdt-150 d-in-b",children:r("Header Row:")}),a.jsx("input",{type:"number",min:"1",className:"btcd-paper-inp w-4",placeholder:"Header Row",onChange:c,value:s.headerRow,name:"headerRow"}),a.jsx("button",{onClick:()=>ra(e,s,d,h,b),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Worksheet Headers"'},type:"button",disabled:x,children:"↻"}),a.jsx("br",{}),a.jsx("small",{className:"mt-3 d-blk",style:{marginLeft:155,lineHeight:1.8},children:r("By default, first row of the worksheet is considered as header row. This can be used if tabular data starts from any row other than the first row.")}),a.jsx("br",{}),x&&a.jsx(f,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),((N=(v=(y=(l=s.default)==null?void 0:l.worksheets)==null?void 0:y.headers)==null?void 0:v[s.worksheet])==null?void 0:N[s.headerRow])&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-4",children:a.jsx("b",{className:"wdt-100",children:r("Map Fields")})}),a.jsx("div",{className:"btcd-hr mt-1"}),a.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[a.jsx("div",{className:"txt-dp",children:a.jsx("b",{children:r("Form Fields")})}),a.jsx("div",{className:"txt-dp",children:a.jsx("b",{children:r("Zoho Fields")})})]}),s.field_map.map((p,g)=>a.jsx(da,{i:g,field:p,sheetConf:s,formFields:i,setSheetConf:d},`sheet-m-${g+9}`)),a.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:a.jsx("button",{onClick:()=>B(s.field_map.length,s,d),className:"icn-btn sh-sm",type:"button",children:"+"})}),a.jsx("br",{}),a.jsx("br",{})]}),s.workbook&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"mt-4",children:a.jsx("b",{className:"wdt-100",children:r("Actions")})}),a.jsx("div",{className:"btcd-hr mt-1"}),a.jsx(ca,{sheetConf:s,setSheetConf:d,formFields:i})]})]})}export{wa as Z};
