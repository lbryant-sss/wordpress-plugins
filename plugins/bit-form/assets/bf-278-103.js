var $=Object.defineProperty;var R=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var S=(a,e,i)=>e in a?$(a,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):a[e]=i,m=(a,e)=>{for(var i in e||(e={}))E.call(e,i)&&S(a,i,e[i]);if(R)for(var i of R(e))U.call(e,i)&&S(a,i,e[i]);return a};import{_ as r,ae as A,$ as v,c as z,c8 as N,u as T,r as b,j as t,C}from"./main-509.js";import{t as k}from"./bf-890-82.js";import{a4 as Z,a5 as P,a6 as F}from"./bf-445-81.js";const G=(a,e,i,d,c,o,l,s,n)=>{let h=m({},e);if(l){const u=m({},s);u[a.target.name]="",n(m({},u))}switch(h[a.target.name]=a.target.value,a.target.name){case"template":h=L(h,d,i,c,o);break}i(m({},h))},L=(a,e,i,d,c)=>{var l,s;const o=m({},a);return o.table="",o.field_map=[{formField:"",zohoFormField:""}],delete o.templateActions,(s=(l=o==null?void 0:o.default)==null?void 0:l.templateDetails)!=null&&s[a.template]||O(e,o,i,d,c),o},K=(a,e,i,d,c)=>{d(!0);const o={formID:a,id:e.id,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails};z(o,"bitforms_zsign_refresh_templates").then(l=>{if(l&&l.success){const s=m({},e);s.default||(s.default={}),l.data.templates&&(s.default.templates=l.data.templates),l.data.tokenDetails&&(s.tokenDetails=l.data.tokenDetails),c({show:!0,msg:r("Templates refreshed")}),i(m({},s))}else l&&l.data&&l.data.data||!l.success&&typeof l.data=="string"?c({show:!0,msg:N(r("Templates refresh failed Cause: %s. please try again"),l.data.data||l.data)}):c({show:!0,msg:r("Templates refresh failed. please try again")});d(!1)}).catch(()=>d(!1))},O=(a,e,i,d,c)=>{const{template:o}=e;d(!0);const l={formID:a,id:e.id,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails,template:o};z(l,"bitforms_zsign_refresh_template_details").then(s=>{if(s&&s.success){const n=m({},e);n.default||(n.default={}),n.default.templateDetails||(n.default.templateDetails={}),s.data.templateDetails&&(n.default.templateDetails[o]=s.data.templateDetails),s.data.tokenDetails&&(n.tokenDetails=s.data.tokenDetails),c({show:!0,msg:r("Template Details refreshed")}),i(m({},n))}else s&&s.data&&s.data.data||!s.success&&typeof s.data=="string"?c({show:!0,msg:N(r("Template Details refresh failed Cause: %s. please try again"),s.data.data||s.data)}):c({show:!0,msg:r("Template Details refresh failed. please try again")});d(!1)}).catch(()=>d(!1))},Q=a=>{const e={},d=window.location.href.replace(`${window.opener.location.href}/redirect`,"").split("&");d&&d.forEach(c=>{const o=c.split("=");o[1]&&(e[o[0]]=o[1])}),localStorage.setItem(`__bitforms_${a}`,JSON.stringify(e)),window.close()},q=(a,e,i,d,c,o)=>{if(!a.dataCenter||!a.clientId||!a.clientSecret){i({dataCenter:a.dataCenter?"":r("Data center cann't be empty"),clientId:a.clientId?"":r("Client ID cann't be empty"),clientSecret:a.clientSecret?"":r("Secret key cann't be empty")});return}const l=A(v);c(!0);const s="ZohoSign.templates.CREATE,ZohoSign.templates.READ,ZohoSign.templates.UPDATE",n=`https://accounts.zoho.${a.dataCenter}/oauth/v2/auth?scope=${s}&response_type=code&client_id=${a.clientId}&prompt=Consent&access_type=offline&state=${encodeURIComponent(window.location.href)}/redirect&redirect_uri=${encodeURIComponent(l.zohoRedirectURL)}`,h=window.open(n,"zohoSign","width=400,height=609,toolbar=off"),u=setInterval(()=>{if(h.closed){clearInterval(u);let p={},j=!1;const f=localStorage.getItem("__bitforms_zohoSign");if(f&&(j=!0,p=JSON.parse(f),localStorage.removeItem("__bitforms_zohoSign")),!p.code||p.error||!p||!j){const x=p.error?`Cause: ${p.error}`:"";o({show:!0,msg:`${r("Authorization failed")} ${x}. ${r("please try again")}`}),c(!1)}else{const x=m({},a);x.accountServer=p["accounts-server"],V(p,x,e,d,c,o)}}},500)},V=(a,e,i,d,c,o)=>{const l=A(v),s=m({},a);s.dataCenter=e.dataCenter,s.clientId=e.clientId,s.clientSecret=e.clientSecret,s.redirectURI=encodeURIComponent(l.zohoRedirectURL),z(s,"bitforms_zsign_generate_token").then(n=>n).then(n=>{if(n&&n.success){const h=m({},e);h.tokenDetails=n.data,i(h),Z(h),d(!0),o({show:!0,msg:r("Authorized Successfully")})}else n&&n.data&&n.data.data||!n.success&&typeof n.data=="string"?o({show:!0,msg:`${r("Authorization failed Cause:")}${n.data.data||n.data}. ${r("please try again")}`}):o({show:!0,msg:r("Authorization failed. please try again")});c(!1)})};function W({formID:a,signConf:e,setSignConf:i,step:d,setstep:c,isLoading:o,setisLoading:l,setSnackbar:s,redirectLocation:n,isInfo:h,authorizedAction:u}){const p=T(v),{siteURL:j}=p,[f,x]=b.useState(!1),[w,_]=b.useState({dataCenter:"",clientId:"",clientSecret:""}),g=y=>{const D=m({},e),I=m({},w);I[y.target.name]="",D[y.target.name]=y.target.value,_(I),i(D)};return b.useEffect(()=>{f&&u()},[f]),t.jsxs(t.Fragment,{children:[t.jsx(P,{title:k.zohoSign.title,youTubeLink:k.zohoSign.link}),t.jsxs("div",{className:"btcd-stp-page",style:{width:900,height:"100%"},children:[t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:r("Integration Name:")})}),t.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:g,name:"name",value:e.name,type:"text",placeholder:r("Integration Name..."),disabled:h}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:r("Data Center:")})}),t.jsxs("select",{onChange:g,name:"dataCenter",value:e.dataCenter,className:"btcd-paper-inp w-6 mt-1",disabled:h,children:[t.jsx("option",{value:"",children:r("--Select a data center--")}),t.jsx("option",{value:"com",children:"zoho.com"}),t.jsx("option",{value:"eu",children:"zoho.eu"}),t.jsx("option",{value:"com.cn",children:"zoho.com.cn"}),t.jsx("option",{value:"in",children:"zoho.in"}),t.jsx("option",{value:"com.au",children:"zoho.com.au"})]}),t.jsx("div",{style:{color:"red"},children:w.dataCenter}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:r("Homepage URL:")})}),t.jsx(C,{value:j,className:"field-key-cpy w-6 ml-0",readOnly:h}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:r("Authorized Redirect URIs:")})}),t.jsx(C,{value:n||`${p.zohoRedirectURL}`,className:"field-key-cpy w-6 ml-0",readOnly:h}),t.jsxs("small",{className:"d-blk mt-5",children:[r("To get Client ID and SECRET , Please Visit")," ",t.jsx("a",{className:"btcd-link",href:`https://api-console.zoho.${(e==null?void 0:e.dataCenter)||"com"}/`,target:"_blank",rel:"noreferrer",children:r("Zoho API Console")})]}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:r("Client id:")})}),t.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:g,name:"clientId",value:e.clientId,type:"text",placeholder:r("Client id..."),disabled:h}),t.jsx("div",{style:{color:"red"},children:w.clientId}),t.jsx("div",{className:"mt-3",children:t.jsx("b",{children:r("Client secret:")})}),t.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:g,name:"clientSecret",value:e.clientSecret,type:"text",placeholder:r("Client secret..."),disabled:h}),t.jsx("div",{style:{color:"red"},children:w.clientSecret}),!h&&t.jsxs(t.Fragment,{children:[t.jsx(F,{isAuthorized:f,isLoading:o,handleAuthorize:()=>q(e,i,_,x,l,s)}),t.jsx("br",{})]})]})]})}var X=Object.freeze({__proto__:null,default:W});export{W as Z,O as a,X as b,G as h,K as r,Q as s};
