var bit_mollie_field=function(){"use strict";return class{#t="";#e="";#i=null;#n=null;#s={};#r=null;#l=null;#o=null;#c=null;#d=null;#a=null;#h=null;#m=null;#y=null;#u=null;#p=null;#f=[];#g=null;#I=null;#S=null;#b=null;constructor(t,e){this.#t="string"==typeof t?document.querySelector(t):t,Object.assign(this.#s,e),this.#e=this.#s.apiKey,this.#i=this.#s.contentId,this.#r=this.#s.payIntegID,this.#l=this.#s.fieldKey,this.#a=this.#s?.amountFld,this.#h=this.#s?.amount,this.#d=this.#s.amountType,this.#m=this.#s.currency,this.#y=`#form-${this.#i}`,this.#u=this.#i?.split("_")[1],this.#g=this.#s.description,this.#S=this.#s.payment_method,this.#b=this.#s.redirect_url,this.init()}init(){this.#I=this.#v(`.${this.#l}-mollie-btn`),this.#I&&this.#E()}#v(t){return document.querySelector(this.#y).querySelector(t)}#E(){this.#p=this.#v(".mollie-btn-spinner"),this.#B(this.#I,"click",(()=>{this.#I.disabled=!0,this.#p.classList.remove("d-none"),this.#F(this.#i).then((t=>{t&&this.#P()})).finally((()=>{this.#I.disabled=!1,this.#p.classList.add("d-none")}))}))}#B(t,e,i){t&&(t.addEventListener(e,i),this.#f.push({selector:t,eventType:e,cb:i}))}#$(t){if(t){const e=window.bf_globals[this.#i].fields[t]?.fieldName;if(!e)return;let i=this.#v(`[name="${e}"]`);if(i&&"radio"===i.type&&(i=this.#v(`[name="${e}"]:checked`)),i&&i.value)return i.value}return""}#K(t=""){const e=bfSelect(`${this.#y} .${this.#l}-err-wrp`),i=bfSelect(`.${this.#l}-err-txt`,e),n=bfSelect(`.${this.#l}-err-msg`,e);if(t){n.style.removeProperty("display"),i.innerHTML=t,setStyleProperty(e,"height",`${i.parentElement.scrollHeight}px`),setStyleProperty(e,"grid-template-rows","1fr"),setStyleProperty(e,"opacity",1);const s=this.#v(`${this.#y} .btcd-fld-itm.${this.#l}`);scrollToElm(s)}else i.innerHTML="",setStyleProperty(e,"grid-template-rows","0fr"),setStyleProperty(n,"display","none"),setStyleProperty(e,"height",0),setStyleProperty(e,"opacity",0)}#D(t){const e=t.toString();return/^\d+(\.\d{1,2})?$/.test(e),parseFloat(e).toFixed(2)}#P(){const t=this.#_(this.#$(this.#a));if("dynamic"===this.#d&&!t)return void this.#K("Amount field is required");this.#K();const e="fixed"===this.#d?this.#h:t;if(e){const t={payIntegID:this.#r,amount:this.#D(e),currency:this.#m,metadata:{formID:this.#u,entryID:this.#n,fieldKey:this.#l},method:this.#S,description:this.#g,redirectUrl:this.#b};bitsFetchFront(this.#i,t,"bitforms_mollie_create_payment").then((t=>{const{success:e,data:i}=t;if(e){if(this.#K(),i?.id){this.#L(i);const t=i._links.checkout.href;window.location.replace(t)}}else this.#K(i.detail)}))}}async#F(t){try{await isFormValidatedWithoutError(t)}catch(t){return this.#I.disabled=!1,Promise.reject()}const e=await saveFormProgress(t),i=e?.[t];return i?.success?(i.success&&(this.#n=i.data.entry_id),Promise.resolve(!0)):Promise.reject()}#L(t){const e=document.getElementById(`${this.#i}`);e.classList.add("pos-rel","form-loading");const i=document.getElementById(`form-${this.#i}`);if(null!=i){const t=bf_globals[this.#i];this.#n&&(t.entryId=this.#n);let n=bfSelect('button[type="submit"]',i);n||(n=document.createElement("button"),n.setAttribute("type","submit"),n.style.display="none",i.append(n)),n.click(),e.classList.remove("pos-rel","form-loading"),this.#n=null}}#q(){this.#f.forEach((({selector:t,eventType:e,cb:i})=>{t.removeEventListener(e,i)}))}#_(t){const e=t?.match(/[\d,.]*\d(?:\.\d+)?/);if(e){const t=e[0].replace(/,/g,"");return parseFloat(t)}return parseFloat(0)}destroy(){this.#I.disabled=!1,this.#q()}reset(){this.destroy(),this.init()}}}();
