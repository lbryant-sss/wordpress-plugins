var bit_multi_step_form=function(){"use strict";class t{#t=null;#e=[];#s=[];#i=[];#n=1;#r=1;#a=!0;#h=!0;#o=!0;#d=!0;#l=!0;#p="";#c=!1;#u=0;#f=[];#m=null;#S=null;constructor(t,e){this.#m=e.document||document,this.#S=e.window||window,this.#t="string"==typeof t?this.#m.querySelector(t):t,t&&(this.#b(e),this.init())}init(){this.#e=Array.from(this.#v(".next-step-btn")),this.#s=Array.from(this.#v(".prev-step-btn")),this.#g(),this.#y(),this.#w(),this.#E(),this.#_()}#g(){const t=this.#I(1),e=this.#C(".prev-step-btn",t);e&&(e.disabled=!0,e.classList.add("v-hide"),this.#s=this.#s.filter(t=>!1===t.isEqualNode(e)));const s=this.#v(`._frm-b${this.#u}-stp-cntnt[data-step]`).length,i=this.#I(s),n=this.#C(".next-step-btn",i);n&&(n.disabled=!0,n.classList.add("v-hide"),this.#e=this.#e.filter(t=>!1===t.isEqualNode(n)))}#x(t){t.preventDefault();const e=t.target.closest(`._frm-b${this.#u}-stp-hdr`);if(e.classList.contains("disabled"))return;const s=Number(e.getAttribute("data-step"));this.#n!==s&&(this.#h&&s>this.#n&&this.#f.push(this.#n),this.#n=s,this.#L(s))}#E(){if(!this.#d)return;const t=this.#v(`._frm-b${this.#u}-stp-hdr`);t&&t.forEach(t=>{const e=this.#C(`._frm-b${this.#u}-stp-icn-cntn`,t);e&&this.#$(e,"click",t=>{this.#x(t)});const s=this.#C(`._frm-b${this.#u}-stp-hdr-lbl`,t);s&&this.#$(s,"click",t=>{this.#x(t)})})}#_(){const t=this.#S.bf_globals[this.#p];t.extraFields||(t.extraFields={}),t.extraFields._bf_step_no={fieldName:"_bf_step_no",typ:"text"},this.#e?.length&&(t.extraFields["next-step-btn"]={typ:"button",btnTyp:"next-step",fieldName:"next-step-btn",valid:{}}),this.#s?.length&&(t.extraFields["prev-step-btn"]={typ:"button",btnTyp:"previous-step",fieldName:"prev-step-btn",valid:{}})}#b(t){"defaultStep"in t&&(this.#r=t.defaultStep),"validateOnStepChange"in t&&(this.#a=t.validateOnStepChange),"maintainStepHistory"in t&&(this.#h=t.maintainStepHistory),"saveProgress"in t&&(this.#o=t.saveProgress),"stepHeaderSwitchable"in t&&(this.#d=t.stepHeaderSwitchable),"showPercentage"in t&&(this.#l=t.showPercentage),this.#p=t.contentId,this.#u=this.#B()}#C(t,e){return(e||this.#t).querySelector(t)}#v(t,e){return(e||this.#t).querySelectorAll(t)}#$(t,e,s){t.addEventListener(e,s),this.#i.push({elm:t,event:e,handler:s})}#I(t=this.#n){return this.#C(`._frm-b${this.#u}-stp-cntnt[data-step="${t}"]`)}#H(){if(!this.#I(this.#n+1))return!1}#P(){if(!this.#I(this.#n-1))return!1}#B(){return Number(this.#p.split("_")[1])}#A(t){const e=window.bf_globals[this.#p].layout[t-1];if(!e)return;const s=e.layout.lg[0].i,i=this.#C(`.btcd-fld-itm.${s}`);setTimeout(()=>{i&&scrollToElm(i,{immediate:!0})},0)}#F(t){this.#v(`._frm-b${this.#u}-stp-hdr`).forEach(e=>{e.classList.remove("completed","active");const s=Number(e.getAttribute("data-step"));s<t?e.classList.add("completed"):s===t&&e.classList.add("active")})}#N(t){const e=this.#v(`._frm-b${this.#u}-stp-cntnt:not([data-step="${t}"])`),s=this.#C(`._frm-b${this.#u}-progress-fill`),i=e.length+1,n=Math.round((t-1)/i*100);s&&(s.style.width=`${n}%`),this.#l&&s&&(s.textContent=`${n}%`)}#W(t){const e=this.#C(`._frm-b${this.#u}-stp-cntnt[data-step="${t}"]`);e&&(e.classList.remove("deactive"),this.#v(`._frm-b${this.#u}-stp-cntnt:not([data-step="${t}"])`).forEach(t=>{t.classList.add("deactive")}))}#L(t){this.#W(t),this.#A(t),this.#F(t),this.#N(t),this.#c=!0}#T(t){const e=this.#I();if(!e)return;const s=this.#C(".next-step-btn",e);if(!s)return;const i=this.#C(".bf-spinner",s);t?(s.disabled=!0,i.classList.remove("d-none")):(s.removeAttribute("disabled"),i.classList.add("d-none"))}async#O(){this.#T(!0);try{"undefined"!=typeof isFormValidatedWithoutError&&await isFormValidatedWithoutError(this.#p,{step:this.#n})}catch(t){return Promise.resolve(!1)}finally{this.#T(!1)}return Promise.resolve(!0)}#k(){this.#o&&"undefined"!=typeof saveFormProgress&&saveFormProgress(this.#p)}#y(){this.#e.length&&this.#e.forEach(t=>{this.#$(t,"click",async t=>{if(this.#c=!1,"undefined"!=typeof bit_conditionals&&bit_conditionals(t),!this.#a||await this.#O()){if(this.#h&&this.#f.push(this.#n),!this.#c){this.#n+=1;const t=this.#C(`._frm-b${this.#u}-stp-hdr[data-step="${this.#n}"]`);t&&t.classList.remove("disabled"),this.#L(this.#n)}this.#k()}})})}get step(){return this.#n}set step(t){const e=Number(t);this.#I(e)&&(this.#h&&this.#n<e&&this.#f.push(this.#n),this.#n=e,this.#L(this.#n))}#w(){this.#s.length&&this.#s.forEach(t=>{this.#$(t,"click",t=>{"undefined"!=typeof bit_conditionals&&bit_conditionals(t),this.#h?this.#n=this.#f.pop():this.#n>0&&(this.#n-=1),this.#L(this.#n)})})}destroy(){}#q(){this.#i.forEach(({elm:t,event:e,handler:s})=>{t.removeEventListener(e,s)})}reset(){if(this.step=this.#r||1,this.#q(),this.#a){const t=this.#v(`._frm-b${this.#u}-stp-hdr:not([data-step="1"])`);t&&t.forEach(t=>t.classList.add("disabled"))}this.init()}}return function(e=null){(e?[e]:Object.keys(window?.bf_globals||{})).forEach(e=>{const s=window.bf_globals[e],i=s.formInfo?.multiStepSettings;if(i){const{formId:n}=s,r=bfSelect(`#form-${e}`),a=bfSelect(`._frm-b${n}-stp-cntnr`,r);s.inits.multi_step_form=new t(a,{contentId:e,...i})}})}}();
