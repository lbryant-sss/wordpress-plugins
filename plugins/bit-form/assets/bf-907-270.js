var se=Object.defineProperty,te=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var W=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var H=(n,a,l)=>a in n?se(n,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[a]=l,g=(n,a)=>{for(var l in a||(a={}))oe.call(a,l)&&H(n,l,a[l]);if(W)for(var l of W(a))ne.call(a,l)&&H(n,l,a[l]);return n},F=(n,a)=>te(n,ae(a));import{r as p,bn as le,y as z,j as e,g as K,u as V,x as ie,w as re,a as P,an as ce,c as A,_ as i,l as L,C as de,ed as me,E as he,K as ue,au as C,S as pe,d as xe,bc as be,b as we,ee as fe,bm as je,$ as Q,ef as ge,b6 as S,O as Z,I as q,f as ve,U as _e,aQ as Te,t as Ee,v as M}from"./main-461.js";import{P as ye}from"./bf-302-80.js";import{u as _}from"./bf-908-79.js";import{A as O}from"./bf-635-375.js";import{L as B}from"./bf-863-82.js";import{E as Ne}from"./bf-190-253.js";import{t as U}from"./bf-824-88.js";import"./bf-731-83.js";import"./bf-65-113.js";import"./bf-857-86.js";import"./bf-936-85.js";const Ae=le(()=>z(()=>import("./bf-441-380.js"),["./bf-441-380.js","./main-461.js","./main-461.css"],import.meta.url),{fallback:e.jsx("div",{children:"Loading..."})});function Ce(){const[n,a]=p.useState(!1),[l,m]=p.useState({show:!1}),[x,w]=K(fe),[o,f]=p.useState({show:!1,btnTxt:""}),h=V(je),r=V(Q),{formID:u,formType:j}=ie(),t=re(),{css:v}=P(),E=ce(ge);p.useEffect(()=>{E(),A({formID:u},"bitforms_get_views").then(s=>{if(s===void 0||!s.success)w([]),m({show:!0,msg:s.data});else if(s.success){const c=s.data.map(b=>F(g({},b),{shortcode:`[bitform-view id='${b.id}']`}));w(c)}})},[u]);const y=s=>e.jsxs("div",{style:{lineHeight:.7,fontWeight:500},children:[S(s,r.dateFormat),e.jsx("br",{}),e.jsx("br",{}),e.jsx("small",{children:S(s,r.timeFormat)})]}),k=()=>{var s;if(!Z((s=r==null?void 0:r.proInfo)==null?void 0:s.installedVersion,"2.9.0")){m({show:!0,msg:"To use this feature you need Bit Form Pro(Version: 2.9.0)"});return}t(`/form/settings/${j}/${u}/data-views/new`)},[$,I]=p.useState([{width:250,minWidth:80,Header:i("View Name"),accessor:"table_name",Cell:s=>e.jsx(L,{to:`/form/settings/${j}/${u}/data-views/${s.row.original.id}`,type:"button",className:"btcd-tabl-lnk",children:s.row.original.table_name})},{width:220,minWidth:200,Header:i("Short Code"),accessor:"shortcode",Cell:s=>e.jsx(de,{value:s.row.values.shortcode,className:`cpyTxt ${v({w:230})}`})},{width:160,minWidth:60,Header:i("Created"),accessor:"created_at",Cell:s=>y(s.row.original.created_at)}]);p.useEffect(()=>{const s=$.filter(c=>c.accessor!=="t_action");s.push({sticky:"right",width:100,minWidth:60,Header:"Actions",accessor:"t_action",Cell:c=>e.jsxs(me,{title:"Actions",w:165,h:107,children:[e.jsxs(L,{to:`/form/settings/${j}/${u}/data-views/${c.row.original.id}`,type:"button",className:"flx","aria-label":"actions",children:[e.jsx(he,{size:18}),i("Edit Table")]}),e.jsxs("button",{type:"button",onClick:()=>Y(c.row.original.id,c.row.index),children:[e.jsx(ue,{size:16}),"Â ",i("Delete")]})]})}),I([...s])},[h]);const G=p.useCallback(s=>{const c=[],b=[];for(let d=0;d<s.length;d+=1)c.push(s[d].id),b.push(s[d].original.id);const N=[...x],R=[...x];for(let d=c.length-1;d>=0;d-=1)R.splice(Number(c[d]),1);w(d=>C(d,{data:R,type:"set"})),A({tblId:b},"bitforms_bulk_table_delete_form").then(d=>{d===void 0||!d.success?w(ee=>C(ee,{data:N,type:"set"})):d.success&&m({show:!0,msg:d.data})})},[]),J=(s,c)=>{A({id:s},"bitforms_delete_atable").then(b=>{b.success&&(w(N=>C(N,{type:"remove",data:c})),m({show:!0,msg:i("Table Deleted Successfully")}))})},X=p.useCallback(s=>{I(s)},[]),D=()=>{o.show=!1,f(g({},o))},Y=(s,c)=>{o.action=()=>{J(s,c),D()},o.btnTxt=i("Delete"),o.btn2Txt=null,o.btnClass="",o.body=i("Are you sure to delete this table?"),o.show=!0,f(g({},o))};return e.jsxs("div",{id:"all-forms",children:[e.jsx(pe,{snack:l,setSnackbar:m}),e.jsx(xe,{show:o.show,body:o.body,action:o.action,close:D,btnTxt:o.btnTxt,btn2Txt:o.btn2Txt,btn2Action:o.btn2Action,btnClass:o.btnClass}),x.length?e.jsx("div",{children:e.jsx(be,{className:"f-table btcd-all-frm",leftHeaderClasses:v(Pe.leftHeader),height:525,columns:$,data:x,rowSeletable:!0,newTableId:h,resizable:!0,setBulkDelete:G,setTableCols:X,centerHeader:e.jsx("h3",{children:"Data View List (Beta)"}),rightHeader:e.jsx("button",{onClick:()=>k(),type:"button","data-testid":"create-table-btn",className:`round btcd-btn-lg blue blue-sh ${v(we.btn)}`,children:i("Create View")})})}):e.jsx(Ae,{setModal:a,createNewView:k})]})}var Ve=p.memo(Ce);const Pe={leftHeader:{width:"auto !important"}};function ke({size:n,stroke:a=2}){return e.jsxs("svg",{width:n,height:n,viewBox:"0 0 30 30",children:[e.jsx("path",{className:"svg-icn",strokeWidth:a,d:"M13.83,6.32H6.11a2.19,2.19,0,0,0-2.2,2.19v15.3A2.19,2.19,0,0,0,6.11,26H21.55a2.19,2.19,0,0,0,2.2-2.19V16.16"}),e.jsx("path",{className:"svg-icn",strokeWidth:a,d:"M22.1,4.68a2.35,2.35,0,0,1,3.31,0,2.31,2.31,0,0,1,0,3.28L14.93,18.35l-4.41,1.09,1.11-4.37Z"})]})}function $e(){var j;const[n,a]=K(Te),l=V(Q),{css:m}=P(),{userRoles:x,user:w}=l,o=Object.keys(x).filter(t=>t!=="administrator").map(t=>({label:x[t].name,value:t})),f=[{label:"All Logged In Users",value:"all_logged_in_users"},...o],{entryEditAccess:h,entryViewAccess:r}=n||{},u=(t,v)=>{q&&a(E=>ve(E,y=>{_e(y,t,v)}))};return e.jsxs("div",{children:[e.jsx("h3",{children:"Views And Edit Access"}),!Z((j=l==null?void 0:l.proInfo)==null?void 0:j.installedVersion,"2.9.0")&&e.jsxs("p",{children:[e.jsx("strong",{style:{color:"red"},children:" Note:"})," ","To use this feature you need Bit Form Pro(Version: 2.9.0)"," "]}),e.jsx(O,{customTitle:e.jsxs("span",{className:m({flx:"align-center"}),children:[e.jsx("span",{className:"mr-2",children:e.jsx(Ne,{size:18})}),e.jsx("b",{children:i("Prevent Public View of Entries")}),e.jsx("small",{className:"ml-1",children:i("(Allow only selected rules to View Entries)")}),e.jsx(B,g({},U.allowUserToView))]}),toggle:!0,action:t=>u("entryViewAccess->preventPublicAccess",t.target.checked),checked:r==null?void 0:r.preventPublicAccess,cls:"w-10 mt-3",isPro:!0,proProperty:"is_login",children:e.jsxs("div",{className:m({p:"5px 10px"}),children:[e.jsxs("div",{className:m(T.inputWrp),children:[e.jsx("span",{children:i("Allow Roles to view own entries")}),e.jsx(_,{defaultValue:(r==null?void 0:r.ownEntries)||[],className:"btcd-paper-drpdwn w-6",options:f,onChange:t=>u("entryViewAccess->ownEntries",t)})]}),e.jsxs("div",{className:m(T.inputWrp),children:[e.jsx("span",{children:i("Allow Roles to view Other's entries")}),e.jsx(_,{defaultValue:(r==null?void 0:r.othersEntries)||[],className:"btcd-paper-drpdwn w-6",options:f,onChange:t=>u("entryViewAccess->othersEntries",t)})]})]})}),e.jsx(O,{customTitle:e.jsxs("span",{className:m({dy:"flex"}),children:[e.jsx("span",{className:"mr-2",children:e.jsx(ke,{size:20})}),e.jsx("b",{children:i("Allow Users to Edit Form Entries")}),e.jsx(B,g({},U.allowUserToEdit))]}),toggle:!0,action:t=>u("entryEditAccess->allowEntriesEdit",t.target.checked),checked:h==null?void 0:h.allowEntriesEdit,cls:"w-10 mt-3",isPro:!0,proProperty:"is_login",children:e.jsxs("div",{className:m({p:"5px 10px"}),children:[e.jsxs("div",{className:m(T.inputWrp),children:[e.jsx("span",{children:i("Allow Roles to edit own entries")}),e.jsx(_,{defaultValue:(h==null?void 0:h.ownEntries)||[],className:"btcd-paper-drpdwn w-6",options:f,onChange:t=>u("entryEditAccess->ownEntries",t)})]}),e.jsxs("div",{className:m(T.inputWrp),children:[e.jsx("span",{children:i("Allow Roles to edit Other's entries")}),e.jsx(_,{defaultValue:(h==null?void 0:h.othersEntries)||[],className:"btcd-paper-drpdwn w-6",options:o,onChange:t=>u("entryEditAccess->othersEntries",t)})]})]})})]})}const T={inputWrp:{dy:"flex",jc:"space-between",ai:"center",mb:10}};function Ie(){const{css:n}=P();return e.jsxs("div",{className:n({pr:75}),children:[!q&&e.jsx(ye,{style:{height:"90%",left:"30px",width:"95%","margin-top":"40px"}}),e.jsx($e,{}),e.jsx("hr",{}),e.jsx(Ve,{})]})}const De=p.lazy(()=>z(()=>import("./bf-977-381.js"),["./bf-977-381.js","./main-461.js","./main-461.css","./bf-908-79.js","./bf-49-406.css","./bf-878-70.js","./bf-39-112.js","./bf-440-172.js","./bf-65-113.js","./bf-912-114.js","./bf-390-405.css","./bf-78-285.js","./bf-291-322.js","./bf-970-252.js","./bf-731-83.js","./bf-936-85.js","./bf-857-86.js","./bf-623-379.js","./bf-243-251.js","./bf-766-250.js","./bf-385-407.css","./bf-435-255.js","./bf-435-254.js","./bf-311-84.js","./bf-124-291.js","./bf-418-378.js","./bf-920-292.js","./bf-931-78.js","./bf-256-376.js","./bf-3-409.css","./bf-113-245.js","./bf-412-185.js","./bf-146-324.js","./bf-73-279.js","./bf-894-280.js","./bf-302-80.js","./bf-377-249.js"],import.meta.url));function Ze(){return e.jsxs(Ee,{children:[e.jsx(M,{index:!0,element:e.jsx(Ie,{})}),e.jsx(M,{path:"/:viewId",element:e.jsx(De,{})})]})}export{Ze as default};
