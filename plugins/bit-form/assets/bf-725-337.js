import{t as M,v,r as c,f as A,j as s,M as z,S as P,_ as F}from"./main-215.js";import"./bf-458-78.js";import{S as L}from"./bf-591-260.js";import{ac as T,s as C,a7 as $}from"./bf-221-80.js";import{I as b}from"./bf-141-186.js";import{N as J}from"./bf-518-107.js";import{r as I,Z as j,h as O,c as B}from"./bf-413-97.js";import{Z as G}from"./bf-524-195.js";import{C as q}from"./bf-234-86.js";import"./bf-190-87.js";import"./bf-945-171.js";import"./bf-912-113.js";function ae({formFields:y,setIntegration:k,integrations:N,allIntegURL:f}){const g=M(),{formID:l}=v(),[u,d]=c.useState(!1),[_,x]=c.useState(!1),[i,m]=c.useState(1),[E,o]=c.useState({show:!1}),[e,n]=c.useState({name:"Zoho Marketing Hub API",type:"Zoho Marketing Hub",clientId:"",clientSecret:"",list:"",field_map:[{formField:"",zohoFormField:""}]}),S=T([e.type]),w=()=>{setTimeout(()=>{g(`${f}/new/${e.type}`)},1e3),x(!1)},Z=(t,p)=>{if(t.integration_type===e.type){const r=JSON.parse(t.integration_details);n(a=>A(a,h=>{h.parentAppId=t.id,h.clientId=r.clientId,h.clientSecret=r.clientSecret,h.tokenDetails=r.tokenDetails,h.dataCenter=r.dataCenter,h.ownerEmail=r.ownerEmail})),m(2)}};c.useEffect(()=>{n(t=>A(t,p=>{const r=S.find(a=>a.id===e.parentAppId);if(r){const a=JSON.parse(r.integration_details);p.clientId=a.clientId,p.clientSecret=a.clientSecret,p.tokenDetails=a.tokenDetails,p.dataCenter=a.dataCenter,p.ownerEmail=a.ownerEmail}})),e!=null&&e.parentAppId&&I(l,e,n,d,o)},[e.parentAppId]),c.useEffect(()=>{window.opener&&C("zohoMarketingHub")},[]);const D=t=>{if(t===3){if(!B(e)){o({show:!0,msg:F("Please map mandatory fields")});return}e.list!==""&&e.field_map.length>0&&m(t)}else m(t),t===2&&!e.list&&I(l,e,n,d,o)};return s.jsxs("div",{children:[s.jsx(z,{title:"Authorize New Zoho Marketing Hub App",show:_,setModal:()=>x(!1),children:s.jsx(j,{formID:l,marketingHubConf:e,setMarketingHubConf:n,step:i,setStep:m,isLoading:u,setisLoading:d,setSnackbar:o,authorizedAction:w})}),s.jsx(P,{snack:E,setSnackbar:o}),s.jsx("div",{className:"txt-center w-9 mt-2 cal-width",children:s.jsx(L,{step:3,active:i})}),S.length>0&&i===1&&s.jsx(q,{allIntegURL:f,specificTypes:[e.type],onClickAction:Z,allowAddNew:!0,addNewAction:()=>x(!0)}),i===1&&S.length===0&&s.jsx(j,{formID:l,marketingHubConf:e,setMarketingHubConf:n,step:i,setStep:m,isLoading:u,setisLoading:d,setSnackbar:o,authorizedAction:w}),s.jsxs("div",{className:"btcd-stp-page",style:{width:i===2&&900,height:i===2&&"100%"},children:[s.jsx(G,{formID:l,formFields:y,handleInput:t=>O(t,l,e,n,d,o),marketingHubConf:e,setMarketingHubConf:n,isLoading:u,setisLoading:d,setSnackbar:o}),s.jsx(J,{nextPageHandler:()=>D(3),disabled:e.list===""||e.table===""||e.field_map.length<1})]}),s.jsx(b,{step:i,saveConfig:()=>$(N,k,f,e,g)})]})}export{ae as default};
