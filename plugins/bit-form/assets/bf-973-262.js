var Ke=Object.defineProperty,Ve=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var Me=Object.getOwnPropertySymbols;var Ge=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var De=(l,t,i)=>t in l?Ke(l,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):l[t]=i,$=(l,t)=>{for(var i in t||(t={}))Ge.call(t,i)&&De(l,i,t[i]);if(Me)for(var i of Me(t))Ie.call(t,i)&&De(l,i,t[i]);return l},T=(l,t)=>Ve(l,Le(t));import{a as X,r as ge,j as e,i as le,u as Y,aq as J,h as H,T as Ce,_ as a,aQ as Z,aO as et,aP as tt,K as st,aK as K,$ as Qe,bp as lt,f as B,ae as ye,aF as Ae,bo as ot,db as at,bw as it,ap as nt,I as ke,ao as _e,W as Fe,bm as z,aR as ct,aT as Ee,e7 as rt,e6 as dt,d as Ye,A as mt,O as pt,c as ht,z as ut}from"./main-729.js";import{S as ft,a as xt,D as bt,b as kt}from"./bf-660-255.js";import{S as vt}from"./bf-141-330.js";import{o as ne,M as re,D as Ne,q as ve}from"./bf-525-70.js";import{t as Pe}from"./bf-515-82.js";import{A as jt}from"./bf-865-83.js";import{g as q,e as ae,i as Be,u as Oe,h as Re,P as wt}from"./bf-47-79.js";import{C as yt}from"./bf-595-86.js";import{C as G}from"./bf-234-105.js";import{C as Xe}from"./bf-470-377.js";import{M as Se}from"./bf-644-113.js";import"./bf-708-88.js";function ze({title:l,titleOutline:t,accordionActions:i,children:n}){const{css:p}=X(),[r,N]=ge.useState(!0),w=()=>{N(x=>!x)};return e.jsxs("div",{className:p(L.section),children:[e.jsxs("div",{className:`${p(L.titleWrp)}`,children:[e.jsxs("button",{type:"button",className:`${p(L.title,t?L.titleOutline:{})} btcd-logic-blk`,onClick:w,children:[l,e.jsx("span",{className:p(L.titleIcn),children:e.jsx(yt,{size:15,rotate:!r})})]}),e.jsx("div",{className:`${p(L.accrActions)} accr-actions`,children:i})]}),r&&e.jsx("div",{className:p(L.content),children:n}),!r&&e.jsx("div",{className:p(L.content),children:e.jsxs("button",{className:p(L.collapsedAccrdn),type:"button",onClick:w,children:[e.jsx("span",{className:p(L.collapsedCrl)}),e.jsx("span",{className:p(L.collapsedCrl)}),e.jsx("span",{className:p(L.collapsedCrl)})]})})]})}const L={section:{pb:12},accrActions:{dy:"none"},titleWrp:{flx:1,":hover .accr-actions":{flx:1}},title:{bc:"var(--b-50)",h:35,fs:14,p:"0 15px",brs:30,cr:"#fff",fw:600,lh:"29px",cur:"pointer",us:"none",b:0,oe:0,flx:"center"},titleOutline:{b:"2px solid var(--b-50)",bc:"#fff",cr:"var(--b-50)",p:"0 13px"},titleIcn:{ml:8,flx:"center"},content:{my:5,ml:45},collapsedAccrdn:{b:0,oe:0,bc:"#D9D9D9",w:65,brs:10,h:20,flx:"center",rg:5,cg:5,curp:1,mt:15,":focus":{oe:"none"}},collapsedCrl:{dy:"inline-block",w:5,h:5,bc:"#AAAAAA",brs:"50%"}};function Ue({lgcGrpInd:l,condGrpInd:t,actionKey:i,enableAction:n,checkKeyInArr:p,getValueFromArr:r,title:N}){const{css:w}=X(),[x,f]=le(Z),o=Y(et),m=Y(tt),u=Y(st),b=J(K),_=Y(Qe),j=()=>{const c=[];return u.map(y=>{lt.includes(y.type)&&c.push({label:y.name,value:y.key})}),c},S=()=>u.filter(c=>c.type==="email").length>0,F=()=>{const c=[];if(S()){const y=[];u.map(s=>{s.type==="email"&&y.push({label:s.name,value:`\${${s.key}}`})}),c.push({title:"Form Fields",type:"group",childs:y})}return _.userMail&&Array.isArray(_.userMail)&&c.push({title:"WP Emails",type:"group",childs:_.userMail}),c},k=(c,y)=>{const s=B(x,h=>{const{success:v}=h[l].conditions[t].actions,C=v.find(A=>A.type===i);C&&(C.details[c]=y)});f(s),b(h=>T($({},h),{unsaved:!0}))};return e.jsxs("div",{className:w(H.mt2),children:[e.jsx(Ce,{onChange:c=>n(c.target.checked,i),title:N,checked:p(i),className:w(H.flxc)}),p(i)&&e.jsxs("div",{className:w({mt:5,ml:28}),children:[e.jsx("label",{className:"f-m f-5",children:a("Email Template:")}),e.jsx("div",{className:"mt-1"}),e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:c=>k("id",c.target.value),value:r(i,"id"),children:[e.jsx("option",{value:"",children:a("Select Email Template")}),o==null?void 0:o.map((c,y)=>e.jsx("option",{value:c.id?JSON.stringify({id:String(c.id)}):JSON.stringify({index:String(y)}),children:c.title},`sem-${y+2.3}`))]}),e.jsx(ne,{action:c=>k("to",c?c.split(","):[]),value:r(i,"to"),placeholder:a("Add Email Receiver"),title:e.jsx("span",{className:"f-m f-5",children:a("To")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:F(r(i,"to"))}),e.jsx(ne,{action:c=>k("from",c),placeholder:a("Add mail from address"),value:r(i,"from"),title:e.jsx("span",{className:"f-m f-5",children:a("From Mail")}),titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:F(r(i,"from")),tip:a('Some servers block emails if "From Email" differs from the authenticated (login) emailâ€” use the same email to ensure delivery.')}),e.jsx("div",{className:"mt-1"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"from_name",className:"f-m f-5",children:a("From Name")}),e.jsx("div",{className:"mt-2"}),e.jsx("input",{id:"from_name",type:"text",className:"btcd-paper-inp",style:{height:"35px",width:"69%",background:"var(--b-79-96)"},value:r(i,"from_name"),onChange:c=>k("from_name",c.target.value),placeholder:"Add mail from name"})]}),e.jsx(ne,{action:c=>k("cc",c?c.split(","):[]),value:r(i,"cc"),placeholder:a("Add Email CC"),title:e.jsx("span",{className:"f-m f-5",children:a("CC")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:F(r(i,"cc"))}),e.jsx(ne,{action:c=>k("bcc",c?c.split(","):[]),placeholder:a("Add Email BCC"),value:r(i,"bcc"),title:e.jsx("span",{className:"f-m f-5",children:a("BCC")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:F(r(i,"bcc"))}),e.jsx(ne,{action:c=>k("replyto",c?c.split(","):[]),placeholder:a("Reply To"),value:r(i,"replyto"),title:e.jsx("span",{className:"f-m f-5",children:a("Reply To")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:F(r(i,"replyto"))}),e.jsx(ne,{action:c=>k("attachment",c?c.split(","):[]),placeholder:a("Attachment"),value:r(i,"attachment"),title:e.jsx("span",{className:"f-m f-5",children:a("Attachment")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",options:j()}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"pdf-template",className:"f-m f-5",children:a("PDF Attachment Template:")}),e.jsx("div",{className:"mt-1"}),e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:c=>k("pdfId",c.target.value),value:r(i,"pdfId"),children:[e.jsx("option",{value:"",children:a("Select PDF Template")}),m==null?void 0:m.map((c,y)=>e.jsx("option",{value:c.id?JSON.stringify({id:String(c.id)}):JSON.stringify({index:String(y)}),children:c.title},`sem-${y+2.3}`))]})]})]})]})}const Nt=["text","username","number","email","password","tel","url","search","select","textarea","html-select","currency","phone-number"],gt=(l,t="")=>{if(t==="")return l;const i=t.split("."),n=i.length-1;return i.slice(0,n).forEach(r=>{l=l[r]}),i.length?l[i[n]]:l},Ct=[{key:"_bf_form",name:"Form"}],Ze=l=>{const t=[];return l.forEach(i=>{typeof i=="object"&&!Array.isArray(i)?t.push(i):Array.isArray(i)&&t.push(...Ze(i))}),t},At=()=>{const l=ye(it),t=Array.isArray(l)&&l.length>1,i=ye(nt),n=t?i.multiStepSettings.btnSettings:{},{show:p,prevBtn:r,nextBtn:N}=n,w={};return t&&(w._bf_step_no={typ:"text",key:"_bf_step_no",lbl:"Active Step"}),p&&(r&&(w[r.key]=$({},r)),N&&(w[N.key]=$({},N))),w},we=l=>{var o;const t=ye(Ae),i=$($({},t),At()),n=ye(ot),p=at(i,[]),r=Ze(l.logics||[]),N=((o=l==null?void 0:l.actions)==null?void 0:o.fields)||[],w=[...r,...N].map(m=>m.field).filter(m=>m),x=p.filter(m=>m.type==="repeater").map(m=>m.key);let f="";if(x.forEach(m=>{n[m].lg.map(j=>j.i).some(j=>w.includes(j))&&(f=m)}),f){x.splice(x.indexOf(f),1);const m=x.reduce((u,b)=>{const j=n[b].lg.map(S=>S.i);return[...u,...j]},[]);return p.filter(u=>!m.includes(u.key)&&!x.includes(u.key))}return p};function _t({action:l,lgcGrp:t,lgcGrpInd:i,actionInd:n,condGrpInd:p,actionType:r,formFields:N}){var U,je,de,me,pe,he,ue,fe;const w=J(Z),x=Y(Ae),f=J(K),{css:o}=X();let m="",u="";N!==null&&N.map(W=>{W.key===l.field&&(u=W.type,m=W.key)});const b=()=>{var d,D,P,I,V,ee,Q,ie;if(u==="razorpay")return;let W;if(W=(D=(d=x==null?void 0:x[m])==null?void 0:d.opt)==null?void 0:D.map(M=>({label:M.lbl,value:M.val||M.lbl})),u==="select"){const{optionsList:M}=(x==null?void 0:x[m])||{};if(l.action==="value")return M.reduce((E,oe)=>{const te=Object.keys(oe)[0],xe=Object.values(oe)[0];return E.push({type:"group",title:te,childs:xe.map(be=>({label:be.lbl,value:be.val||be.lbl}))}),E},[]);if(l.action==="activelist")return M.reduce((E,oe)=>{const te=Object.keys(oe)[0];return E.push({label:te,value:te}),E},[])}if(["decision-box","gdpr"].includes(u)){const M=x==null?void 0:x[m];return[{label:(P=M==null?void 0:M.msg)==null?void 0:P.checked,value:(I=M==null?void 0:M.msg)==null?void 0:I.checked},{label:(V=M==null?void 0:M.msg)==null?void 0:V.unchecked,value:(ee=M==null?void 0:M.msg)==null?void 0:ee.unchecked}]}return W||(W=(ie=(Q=x==null?void 0:x[m])==null?void 0:Q.options)==null?void 0:ie.map(M=>({label:M.lbl,value:M.val||M.code||M.i||M.lbl}))),W},_=W=>{w(d=>B(d,D=>{const{fields:P}=D[i].conditions[p].actions;P[n].action=W})),f(d=>T($({},d),{unsaved:!0}))},j=W=>{w(d=>B(d,D=>{const{fields:P}=D[i].conditions[p].actions;P[n].val=W})),f(d=>T($({},d),{unsaved:!0}))},S=W=>{w(d=>B(d,D=>{const{fields:P}=D[i].conditions[p].actions;P[n].field=W,typeof P[n].val=="undefined"&&(P[n].val="")})),f(d=>T($({},d),{unsaved:!0}))},F=()=>{w(W=>B(W,d=>{const{fields:D}=d[i].conditions[p].actions;D.length>1&&D.splice(n,1)})),f(W=>T($({},W),{unsaved:!0}))},k=()=>{w(W=>B(W,d=>{const{fields:D}=d[i].conditions[p].actions,P=$({},D[n]);D.splice(n+1,0,P)})),f(W=>T($({},W),{unsaved:!0}))},c=((U=x[l.field])==null?void 0:U.typ)||"",y=((je=x[l.field])==null?void 0:je.typ)!=="file-up"&&((de=x[l.field])==null?void 0:de.typ)!=="advanced-file-up",s=((me=x[l.field])==null?void 0:me.typ)!=="button",h=((pe=x[l.field])==null?void 0:pe.typ)==="title",v=["advanced-datetime"].includes((he=x[l.field])==null?void 0:he.typ),C=r!=="onsubmit",A=r!=="onvalidate",g=["decision-box","gdpr"].includes((ue=x[l.field])==null?void 0:ue.typ),O=Nt.includes((fe=x[l.field])==null?void 0:fe.typ),R=l.field==="_bf_form";return e.jsxs("div",{className:"flx pos-rel btcd-logic-blk",children:[e.jsxs(re,{label:"Form Fields",value:l.field||"",onChange:W=>S(W.target.value),style:{width:720},children:[e.jsx("option",{value:"",children:a("Select One")}),N.map(W=>e.jsx("option",{value:W.key,children:W.name},`ff-Ab-${W.key}`)),Ct.map(W=>e.jsx("option",{value:W.key,children:W.name},`ff-Ab-${W.key}`))]}),e.jsx("div",{className:o({w:100,flx:"align-center",h:35,mt:5}),children:e.jsx("div",{className:o({w:"100%",bd:"#b9c5ff",h:"0.5px"})})}),e.jsxs(re,{label:"Action",onChange:W=>_(W.target.value),value:l.action||"",style:{width:400},className:"w-4",children:[e.jsx("option",{value:"",children:a("Select One")}),R&&e.jsx("option",T($({value:"save_draft"},!ke&&{disabled:!0}),{children:a(`Save Draft ${ke?"":"(PRO)"}`)})),!R&&e.jsxs(e.Fragment,{children:[!s&&t.action_type==="oninput"&&e.jsx("option",{value:"click",children:a("Click")}),y&&s&&A&&e.jsx("option",{value:"value",children:a("Value")}),C&&A&&e.jsx("option",{value:"enable",children:a("Enable")}),C&&A&&e.jsx("option",{value:"disable",children:a("Disable")}),C&&A&&y&&s&&e.jsx("option",{value:"readonly",children:a("Readonly")}),C&&A&&y&&s&&e.jsx("option",{value:"writeable",children:a("Writeable")}),C&&A&&e.jsx("option",{value:"hide",children:a("Hide")}),C&&A&&e.jsx("option",{value:"show",children:a("Show")}),r==="onvalidate"&&e.jsx("option",{value:"required",children:a("Required")}),r==="onvalidate"&&e.jsx("option",{value:"notrequired",children:a("Not Required")}),c==="select"&&e.jsx("option",{value:"activelist",children:a("Active List")}),C&&A&&y&&s&&e.jsx("option",{value:g?"ct":"lbl",children:a("Label")}),C&&A&&y&&s&&e.jsx("option",{value:"sub-titl",children:a("Sub Title")}),O&&e.jsx("option",{value:"placeholder",children:a("Placeholder")}),C&&A&&y&&s&&!h&&e.jsx("option",{value:"hlp-txt",children:a("Helper Text")}),v&&e.jsx("option",{value:"config-option",children:a("Config Option")}),h&&e.jsx("option",{value:"title",children:a("Title")})]})]}),["value","activelist","lbl","ct","sub-titl","hlp-txt","title","placeholder","config-option"].includes(l.action)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:o({w:100,flx:"align-center",h:35,mt:5}),children:e.jsx("div",{className:o({w:"100%",bd:"#b9c5ff",h:"0.5px"})})}),e.jsx(Xe,{label:"Value",type:u.match(/select|check|radio|number|range|hidden/g)?"text":u,onChange:j,value:l.val||"",options:b(),formFields:N})]}),e.jsxs("div",{className:"btcd-li-side-btn",children:[e.jsx(q,{onClick:k,icn:!0,className:"ml-2 sh-sm white",children:e.jsx(_e,{})}),e.jsx(q,{onClick:F,icn:!0,className:"ml-2 sh-sm white",children:e.jsx(Fe,{})})]})]})}function Ft({lgcGrp:l,lgcGrpInd:t,condGrp:i,condGrpInd:n}){const{css:p}=X(),[r,N]=le(Z),w=J(K),{fields:x}=i.actions,f=()=>{const o=B(r,m=>{const{fields:u}=m[t].conditions[n].actions;let b="disable";m[t].action_type==="onsubmit"&&(b="value"),u.push({field:"",action:b})});N(o),w(m=>T($({},m),{unsaved:!0}))};return e.jsxs("div",{className:p(H.mt2),children:[e.jsx("div",{className:p($t.title),children:e.jsx("b",{className:"txt-dp",children:a("Field Actions")})}),x==null?void 0:x.map((o,m)=>e.jsx("div",{className:`mt-2 ${i.cond_type==="always"&&"ml-4"}`,children:e.jsx(_t,{lgcGrp:l,lgcGrpInd:t,condGrpInd:n,action:o,actionInd:m,actionType:l.action_type,formFields:we(i)})},`atn-${m+22}`)),e.jsx(ae,{msg:"Add More",children:e.jsx(q,{onClick:()=>f(),icn:!0,className:`blue sh-sm mt-2 ${i.cond_type==="always"&&"ml-4"}`,children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})})]})}const $t={title:{mb:7},chip:{mnh:30,dy:"flex !important",ai:"center",w:60,mt:9,mb:9}};function Ot({lgcGrpInd:l,condGrpInd:t,enableAction:i,checkKeyInArr:n,getValueFromArr:p}){const{css:r}=X(),[N,w]=le(Z),x=J(K),f=Y(ct),o=m=>{const u=B(N,b=>{const{success:_}=b[l].conditions[t].actions,j=_.find(S=>S.type==="integ");j&&(j.details.id=m.map(S=>S.value))});w(u),x(b=>T($({},b),{unsaved:!0}))};return e.jsxs("div",{className:r(H.mt2),children:[e.jsx(Ce,{onChange:m=>i(m.target.checked,"integ"),title:a("Integration"),checked:n("integ"),className:r(H.flxc)}),n("integ")&&e.jsx(ne,{action:m=>o(m),jsonValue:!0,value:p("integ","id"),titleClassName:r({mt:5,ml:28,w:"67.5%"}),className:"w-10",isMultiple:ke,options:f==null?void 0:f.map((m,u)=>({label:m.name,value:m.id?JSON.stringify({id:String(m.id)}):JSON.stringify({index:String(u)})})),placeholder:a("Select Integation")})]})}function St({lgcGrpInd:l,condGrpInd:t,enableAction:i,checkKeyInArr:n,getValueFromArr:p}){var m,u;const{css:r}=X(),[N,w]=le(Z),x=J(K),f=Y(Ee),o=b=>{const _=B(N,j=>{const{success:S}=j[l].conditions[t].actions,F=S.find(k=>k.type==="redirectPage");F&&(F.details.id=b)});w(_),x(j=>T($({},j),{unsaved:!0}))};return e.jsxs("div",{className:r(H.mt2),children:[e.jsx(Ce,{onChange:b=>i(b.target.checked,"redirectPage"),title:a("Redirect URL"),checked:n("redirectPage"),className:r(H.flxc)}),n("redirectPage")&&e.jsx("div",{className:r({mt:5,ml:28}),children:e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:b=>o(b.target.value),value:p("redirectPage","id"),children:[e.jsx("option",{value:"",children:a("Select Page To Redirect")}),(u=(m=f==null?void 0:f.type)==null?void 0:m.redirectPage)==null?void 0:u.map((b,_)=>e.jsx("option",{value:b.id?JSON.stringify({id:String(b.id)}):JSON.stringify({index:String(_)}),children:b.title},`sr-${_+2.5}`))]})})]})}function Tt({lgcGrpInd:l,condGrpInd:t,enableAction:i,checkKeyInArr:n,getValueFromArr:p}){var m,u;const{css:r}=X(),[N,w]=le(Z),x=J(K),f=Y(Ee),o=b=>{const _=B(N,j=>{const{success:S}=j[l].conditions[t].actions,F=S.find(k=>k.type==="successMsg");F&&(F.details.id=b)});w(_),x(j=>T($({},j),{unsaved:!0}))};return e.jsxs("div",{className:r(H.mt2),children:[e.jsx(Ce,{onChange:b=>i(b.target.checked,"successMsg"),title:a("Success Message"),checked:n("successMsg"),className:r(H.flxc)}),n("successMsg")&&e.jsx("div",{className:r({mt:5,ml:28}),children:e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:b=>o(b.target.value),value:p("successMsg","id"),children:[e.jsx("option",{value:"",children:a("Select Message")}),(u=(m=f==null?void 0:f.type)==null?void 0:m.successMsg)==null?void 0:u.map((b,_)=>e.jsx("option",{value:b.id?JSON.stringify({id:String(b.id)}):JSON.stringify({index:String(_)}),children:b.title},`sm-${_+2.3}`))]})})]})}function Wt({lgcGrpInd:l,condGrp:t,condGrpInd:i}){var f,o;const[n,p]=le(Z),r=J(K),N=Y(Ee),{failure:w}=t.actions,x=m=>{const u=B(n,b=>{b[l].conditions[i].actions.failure=m});p(u),r(b=>T($({},b),{unsaved:!0}))};return e.jsxs(re,{onChange:m=>x(m.target.value),value:w,label:"Error Message",className:"w-7 mt-3",children:[e.jsx("option",{value:"",children:a("Select Message")}),(o=(f=N==null?void 0:N.type)==null?void 0:f.successMsg)==null?void 0:o.map((m,u)=>e.jsx("option",{value:m.id?JSON.stringify({id:String(m.id)}):JSON.stringify({index:String(u)}),children:m.title},`vm-${u+2.7}`))]})}function qe({lgcGrp:l,lgcGrpInd:t,condGrp:i,condGrpInd:n}){var b,_,j;const{css:p}=X(),[r,N]=le(Z),w=J(K),{success:x}=i.actions,f=(S,F)=>{const k=B(r,c=>{const{success:y}=c[t].conditions[n].actions;if(S)F==="mailNotify"?y.push({type:F,details:{}}):F==="dblOptin"?y.push({type:F,details:{}}):y.push({type:F,details:{id:""}});else for(let s=0;s<y.length;s+=1)if(y[s].type===F){y.splice(s,1);break}});N(k),w(c=>T($({},c),{unsaved:!0}))},o=S=>x==null?void 0:x.some(F=>F.type===S),m=S=>{const F=B(r,k=>{const{actions:c}=k[t].conditions[n];c.avoid_delete=S});N(F),w(k=>T($({},k),{unsaved:!0}))},u=(S,F)=>{const k=x.find(c=>c.type===S);return k!==void 0?k.details[F]:""};return e.jsxs(e.Fragment,{children:[l.action_type!=="onvalidate"&&l.action_run!=="delete"&&e.jsx(Ft,{lgcGrp:l,lgcGrpInd:t,condGrp:i,condGrpInd:n}),(l.action_type==="onsubmit"||l.action_run==="delete")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:p(H.mt3,H.mb1),children:e.jsx("b",{className:"txt-dp",children:a("Additional Actions")})}),e.jsxs("div",{className:i.cond_type==="always"?"ml-4":"",children:[l.action_run!=="delete"&&e.jsx(Tt,{lgcGrpInd:t,condGrpInd:n,enableAction:f,checkKeyInArr:o,getValueFromArr:u}),!l.action_run.match(/^(delete|edit)$/)&&e.jsx(St,{lgcGrpInd:t,condGrpInd:n,enableAction:f,checkKeyInArr:o,getValueFromArr:u}),l.action_run!=="delete"&&e.jsx(Ot,{lgcGrpInd:t,condGrpInd:n,enableAction:f,checkKeyInArr:o,getValueFromArr:u}),e.jsx(Ue,{title:a("Email Notification"),lgcGrpInd:t,condGrpInd:n,actionKey:"mailNotify",enableAction:f,checkKeyInArr:o,getValueFromArr:u}),e.jsx(Ue,{title:a("Double Opt-in"),lgcGrpInd:t,condGrpInd:n,actionKey:"dblOptin",enableAction:f,checkKeyInArr:o,getValueFromArr:u})]})]}),l.action_run==="delete"&&e.jsx(G,{className:p({mt:5,ml:i.cond_type==="always"?12:-8}),onChange:S=>m(S.target.checked),checked:(j=(_=(b=r[t])==null?void 0:b.conditions[n])==null?void 0:_.actions)==null?void 0:j.avoid_delete,title:e.jsx("small",{className:"txt-dp",children:"Prevent Delete"})}),l.action_type==="onvalidate"&&l.action_run!=="delete"&&e.jsx(Wt,{lgcGrpInd:t,condGrp:i,condGrpInd:n})]})}const Bt={change:{label:a("Change"),notFields:["button","user"]},equal:{label:a("Equal"),notFields:["button","repeater"]},not_equal:{label:a("Not Equal"),notFields:["button","user","repeater"]},null:{label:a("Is Null"),notFields:["button","user","repeater"]},not_null:{label:a("Is Not Null"),notFields:["button","user","repeater"]},contain:{label:a("Contain"),notFields:["button","date","time","datetime-local","month","week","user","repeater"]},contain_all:{label:a("Contain All"),fields:["select"]},not_contain:{label:a("Not Contain"),notFields:["button","date","time","datetime-local","advanced-datetime","month","week","user","repeater"]},greater:{label:a("Greater Than"),fields:["number","date","time","datetime-local","advanced-datetime"]},less:{label:a("Less Than"),fields:["number","date","time","datetime-local","advanced-datetime"]},greater_or_equal:{label:a("Greater Than or Equal"),fields:["number","date","time","datetime-local","advanced-datetime"]},less_or_equal:{label:a("Less Than or Equal"),fields:["number","date","time","datetime-local","advanced-datetime"]},start_with:{label:a("Start With"),notFields:["button","color","url","password","email","date","time","datetime-local","advanced-datetime","month","week","user","repeater"]},end_with:{label:a("End With"),notFields:["button","color","url","password","email","date","time","datetime-local","advanced-datetime","month","week","user","repeater"]},between:{label:a("Between"),fields:["number","date","time","datetime-local","advanced-datetime"]},on_click:{label:a("On Click"),fields:["button.btnTyp:button","button.btnTyp:next-step","button.btnTyp:previous-step"]}};function Te({logic:l,fieldVal:t,delLogic:i,lgcInd:n,subLgcInd:p,subSubLgcInd:r,value:N,addInlineLogic:w,cloneInLineLogic:x,changeLogic:f,logicValue:o,changeValue:m,changeSmartKey:u,changeFormField:b,smartTagAllowed:_,formFields:j}){var de,me,pe,he,ue,fe,W;const{css:S}=X(),F=Y(Ae);let k=!1,c="",y="",s="";(de=j==null?void 0:j.find)==null||de.call(j,d=>{if(d.key===t)return d.type.match(/^(check|radio|select|html-select|image-select|hidden)$/)?c="text":c=d.type,y=d.type,s=d.key,!0});const h=[{label:a("Logged In"),value:"logged_in"},{label:a("Logged Out"),value:"logged_out"}],v=()=>{var D,P,I,V,ee,Q,ie,M;if(y==="razorpay")return;let d;if(y==="user"?d=h:d=(P=(D=F==null?void 0:F[s])==null?void 0:D.opt)==null?void 0:P.map(E=>({label:E.lbl,value:E.val||E.lbl})),y==="select"){const{optionsList:E}=(F==null?void 0:F[s])||{};return E.reduce((oe,te)=>{const xe=Object.keys(te)[0],be=Object.values(te)[0];return oe.push({type:"group",title:xe,childs:be.map($e=>({label:$e.lbl,value:$e.val||$e.lbl}))}),oe},[])}if(["decision-box","gdpr"].includes(c)){const E=F==null?void 0:F[s];return[{label:(I=E==null?void 0:E.msg)==null?void 0:I.checked,value:(V=E==null?void 0:E.msg)==null?void 0:V.checked},{label:(ee=E==null?void 0:E.msg)==null?void 0:ee.unchecked,value:(Q=E==null?void 0:E.msg)==null?void 0:Q.unchecked}]}return d||(d=(M=(ie=F==null?void 0:F[s])==null?void 0:ie.options)==null?void 0:M.map(E=>({label:E.lbl,value:E.val||E.code||E.i||E.lbl}))),d},C=(d,D)=>D.find(P=>{if(P===d)return!0;if(!P.includes("."))return!1;const I=P.indexOf("."),V=P.substring(0,I);if(d!==V)return!1;const ee=P.substring(I+1);if(!ee)return!1;const[Q,ie]=ee.split(":"),M=Q.split("."),E=j.find(te=>te.key===s)||{};return M.reduce((te,xe)=>te[xe],E)===ie}),A=d=>Be.find(D=>d===`\${${D.name}}`);c||(c=((me=A(t))==null?void 0:me.type)||""),k||(k=((pe=A(t))==null?void 0:pe.singleSelect)||!1);const g=d=>{var I;const D=((I=A(t))==null?void 0:I.type)||d;return D?Object.entries(Bt).reduce((V,[ee,Q])=>Q.notFields&&C(D,Q.notFields)?V:Q.fields?C(D,Q.fields)?[...V,{key:ee,lbl:Q.label}]:V:[...V,{key:ee,lbl:Q.label}],[]):[]},O=d=>d==="${_bf_custom_date_format()}"?a("Date Format"):d==="${_bf_user_meta_key()}"?a("Meta Key"):d==="${_bf_query_param()}"?a("Query Param"):"Smart Key",R=d=>c.match(/date|advanced-datetime/g)?d==null?void 0:d.replace(/^'|'$/g,""):d,U=d=>c.match(/date|advanced-datetime/g)&&(d!=null&&d.includes("-"))?`'${d}'`:d,je=["change","null","not_null","on_click"];return e.jsxs("div",{className:`${S(Je.lgcBlk)} btcd-logic-blk`,children:[e.jsxs("div",{className:S(Je.processDgrm),children:[e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Form Fields",value:t,onChange:d=>b(d.target.value,n,p,r),children:[e.jsx("option",{value:"",children:a("Select Form Field")}),!!j.length&&e.jsx("optgroup",{label:"Form Fields",children:j.map(d=>!rt.includes(d.type)&&e.jsx("option",{value:d.key,children:d.name},`ff-lb-${d.key}`))}),_&&e.jsx("optgroup",{label:`General Smart Codes ${ke?"":"(PRO)"}`,children:(he=Be)==null?void 0:he.map(({name:d,label:D})=>e.jsx("option",{value:`\${${d}}`,disabled:!ke,children:D},`ff-rm-${d}`))})]})})}),((ue=A(t))==null?void 0:ue.functionParam)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Field Parameter",onChange:d=>u(d.target.value,n,p,r),value:l.smartKey||"",children:[e.jsx("option",{value:"",children:a("Select Form Field")}),!!j.length&&e.jsx("optgroup",{label:"Form Fields",children:j.map(d=>!d.type.match(/^(file-up|recaptcha)$/)&&e.jsx("option",{value:d.key,children:d.name},`ff-lb-${d.key}`))})]})})}),((fe=A(t))==null?void 0:fe.custom)&&!((W=A(t))!=null&&W.functionParam)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsx(Se,{label:O(t),type:"text",onChange:d=>u(d.target.value,n,p,r),value:l.smartKey||""})})}),e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Logic",value:o,onChange:d=>f(d.target.value,n,p,r),children:[e.jsx("option",{value:"",children:a("Select One")}),g(c).map(({key:d,lbl:D})=>e.jsx("option",{value:d,children:D},d))]})})}),o!=="between"&&o!=="not between"&&!je.includes(o)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:c.match(/user|select|check|radio/g)?e.jsx(Oe,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:N||"",onChange:d=>m(d,n,p,r),options:v(),fldType:c,singleSelect:k}):e.jsx(Xe,{label:"Value",type:c.match(/select|check|radio|number|range/g)?"text":c,disabled:o==="null"||o==="not_null",onChange:d=>m(U(d),n,p,r),value:R(N)||"",options:v(),formFields:j})})}),(o==="between"||o==="not between")&&e.jsx("div",{className:"block-wrapper",children:e.jsxs("div",{className:"block-group",children:[e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:y.match(/select|check|radio/g)?e.jsx(Oe,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:N.min||"",onChange:d=>m(d,n,p,r,"min"),options:v(),customValue:!0,fldType:y}):e.jsx(Se,{label:"Min Value",type:c,disabled:o==="null"||o==="not_null",onChange:d=>m(U(d.target.value),n,p,r,"min"),value:R(N.min)||""})})}),e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:y.match(/select|check|radio/g)?e.jsx(Oe,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:N.max||"",onChange:d=>m(d,n,p,r,"max"),options:v(),customValue:!0,fldType:y}):e.jsx(Se,{label:"Max Value",type:c,disabled:o==="null"||o==="not_null",onChange:d=>m(U(d.target.value),n,p,r,"max"),value:R(N.max)||""})})})]})})]}),e.jsxs("div",{className:"btcd-li-side-btn",children:[e.jsx(q,{onClick:()=>x(n,p,r),icn:!0,className:"ml-2 white sh-sm",children:e.jsx(_e,{size:"16"})}),e.jsx(q,{onClick:()=>i(n,p,r),icn:!0,className:"ml-2 white mr-2 sh-sm",children:e.jsx(Fe,{size:"16"})}),e.jsxs(q,{onClick:()=>w("and",n,p,r),className:"white mr-2 sh-sm",children:[e.jsx(z,{size:"10",className:"icn-rotate-45 mr-1"}),"AND"]}),e.jsxs(q,{onClick:()=>w("or",n,p,r),className:"white sh-sm",children:[e.jsx(z,{size:"10",className:"icn-rotate-45 mr-1"}),"OR"]})]})]})}const Je={lgcBlk:{pn:"relative",dy:"flex",cg:15,rg:15,my:5,":hover":{bc:"#F0F0F0"}},lgcGrp:{b:"0.5px solid #D5D5D5",brs:8,p:10,ml:20},blkItm:{w:"100%"},processDgrm:{"--linethick":"1px","--linewidth":"1.5em","--line-color":"#b9c5ff",flx:"align-center",w:"100%",m:0,p:0,ls:"none",ta:"center","& > .block-wrapper":{flex:"1 1 auto"},"& .block-wrapper>.block-content":{cr:"#666",brs:10},"& .block-wrapper::before, & .block-wrapper::after, & .block-group::before, & .block-group::after, & .block-content::before, & .block-content::after":{bse:"solid",bcr:"var(--line-color)"},"& .block-wrapper .block-group .block-wrapper:first-child .block-content::before, &  .block-wrapper .block-group .block-wrapper:first-child::before":{btlr:10},"&  .block-wrapper .block-group .block-wrapper:first-child .block-content::after, & .block-wrapper .block-group .block-wrapper:first-child::after":{btrr:10},"&  .block-wrapper .block-group .block-wrapper:last-child .block-content::before, &  .block-wrapper .block-group .block-wrapper:last-child::before":{bblr:10},"&  .block-wrapper .block-group .block-wrapper:last-child .block-content::after, &  .block-wrapper .block-group .block-wrapper:last-child::after":{bbrr:10},"& ol, & .block-group, & .block-wrapper":{ls:"none",ta:"center"},"& .block-wrapper":{pn:"relative",mb:0,w:"100%"},"& > .block-wrapper, & ol > .block-wrapper, & .block-group > .block-wrapper":{p:"4px 0"},"&  .block-group":{pn:"relative",pl:"var(--linewidth)"},"& .block-group::before, &  .block-group::after":{pn:"absolute",ct:'""',tp:"50%",w:"var(--linewidth)",dy:"block",bwh:"var(--linethick) 0 0"},"& .block-group::before":{lt:0},"&  .block-group::after":{rt:0},"&  .block-group>.block-wrapper::after, &  .block-group>.block-wrapper::before":{pn:"absolute",ct:'""',tp:0,bm:0,w:"var(--linewidth)",h:"100%",dy:"block"},"&  .block-group>.block-wrapper::before":{lt:0,bwh:"0 0 0 var(--linethick)"},"&  .block-group>.block-wrapper::after":{rt:0,bwh:"0 var(--linethick) 0 0"},"&  .block-group>.block-wrapper:first-child::before, &  .block-group>.block-wrapper:first-child::after":{tp:"50%",bm:"auto",h:"50%"},"&  .block-group>.block-wrapper:last-child::before, &  .block-group>.block-wrapper:last-child::after":{tp:0,bm:"auto",h:"50%"},"&  .block-group>.block-wrapper:first-child:last-child::before, &  .block-group>.block-wrapper:first-child:last-child::after":{tp:0,bm:"auto",h:"50%"},"&  .block-wrapper>.block-content":{pn:"relative",ml:"var(--linewidth)"},"& >.block-wrapper:first-child>.block-content":{ml:0},"&  .block-wrapper:not(:last-child) .block-wrapper>.block-content":{mr:"var(--linewidth)"},"&  .block-wrapper>.block-content::before, &  .block-wrapper>.block-content::after":{ct:'""',tp:"50%",w:"var(--linewidth)",pn:"absolute",bwh:"var(--linethick) 0 0",h:"50%"},"&  .block-wrapper>.block-content::after":{rt:"calc(0em - var(--linewidth) + 2px)",mr:"calc(0px - var(--linethick))"},"&  .block-wrapper>.block-content::before":{lt:"calc(0em - var(--linewidth) + 2px)",ml:"calc(0px - var(--linethick))"},"&  .block-wrapper:last-child>.block-content::after, & .block-wrapper:last-child>.block-content::before":{tp:0,bwh:"0 0 var(--linethick)"},"& >.block-wrapper:first-child>.block-content::before, & >.block-wrapper:first-child>.block-group::before, & >.block-wrapper:first-child>.block-group>.block-wrapper::before, & >.block-wrapper:first-child>.block-group>.block-wrapper>.block-content:first-child::before, & >.block-wrapper:first-child>.block-group>.block-wrapper>ol>.block-wrapper:first-child>.block-content::before, & >.block-wrapper:last-child>.block-content::after, & >.block-wrapper:last-child>.block-group::after":{b:0},"& >.block-wrapper>.block-content::after,  &  ol>.block-wrapper>.block-content::after, & >.block-wrapper>.block-group::after,  &  ol>.block-wrapper>.block-group::after":{dy:"none"},"& >.block-wrapper>.block-content, &  ol>.block-wrapper>.block-content":{mr:0},"& >.block-wrapper>.block-group,  &  ol>.block-wrapper>.block-group":{pr:0},"& >.block-wrapper:last-child>.block-content::after,  &  ol>.block-wrapper:last-child>.block-content::after,  & >.block-wrapper:last-child>.block-group::after,  &  ol>.block-wrapper:last-child>.block-group::after":{dy:"block"},"& >.block-wrapper:last-child>.block-content, & ol>.block-wrapper:last-child>.block-content":{mr:0},"&  .block-wrapper:last-child>.block-group::after,  &  .block-wrapper:last-child>.block-group>.block-wrapper::after,  &  .block-wrapper:last-child>.block-group>.block-wrapper>.block-content::after":{dy:"none"}}};function We({logic:l,nested:t,onChange:i,className:n=null}){return e.jsx("div",{children:e.jsxs("select",{value:l,onChange:i,className:`btcd-logic-chip ${n} ${t&&"scl-8"}`,children:[e.jsx("option",{value:"or",children:a("OR")}),e.jsx("option",{value:"and",children:a("AND")})]})})}function Et({lgcGrp:l,lgcGrpInd:t,condGrp:i,condGrpInd:n}){var y;const{css:p}=X(),[r,N]=le(Z),w=J(K),x=Y(Ae),f=(s,h,v)=>{const C=B(r,A=>{const g=A[t].conditions[n].logics;if(g.length>1)if(v!==void 0)if(g[s][h].length===v+1)if(g[s][h].length===3){const O=g[s][h][v-2];g[s].splice(h,1),g[s].push(O)}else g[s][h].splice(v-1,2);else if(g[s][h].length===3){const O=g[s][h][v+2];g[s].splice(h,1),g[s].push(O)}else g[s][h].splice(v,2);else if(h!==void 0)if(g[s].length===h+1)if(g[s].length===3){const O=g[s][h-2];g.splice(s,1),g.splice(s,0,O)}else g[s].splice(h-1,2);else if(g[s].length===3){const O=g[s][h+2];g.splice(s,1),g.splice(s,0,O)}else g[s].splice(h,2);else s!==0?g.splice(s-1,2):g.splice(s,2)});N(C),w(A=>T($({},A),{unsaved:!0}))},o=(s,h,v,C)=>{const A=B(r,g=>{const O=g[t].conditions[n].logics;C!==void 0?(s==="null"&&(O[h][v][C].val=""),O[h][v][C].logic=s):v!==void 0?(s==="null"&&(O[h][v].val=""),O[h][v].logic=s):(s==="null"&&(O[h].val=""),O[h].logic=s)});N(A),w(g=>T($({},g),{unsaved:!0}))},m=(s,h,v,C)=>{const A=B(r,g=>{const O=g[t].conditions[n].logics;C!==void 0?O[h][v][C]=s:v!==void 0?O[h][v]=s:O[h]=s});N(A),w(g=>T($({},g),{unsaved:!0}))},u=(s,h,v,C)=>C!==void 0?s[h][v][C]:v!==void 0?s[h][v]:s[h],b=(s,h,v,C,A="")=>{const g=B(r,O=>{const R=O[t].conditions[n].logics,U=u(R,h,v,C);A?(typeof U.val=="string"&&(U.val={}),U.val[A]=s):U.val=s});N(g),w(O=>T($({},O),{unsaved:!0}))},_=(s,h,v,C)=>{const A=Be.find(O=>O.name===s),g=B(r,O=>{const R=O[t].conditions[n].logics,U=u(R,h,v,C);U.field=s,typeof U.val=="undefined"&&(U.val=""),A!=null&&A.custom||delete U.smartKey});N(g),w(O=>T($({},O),{unsaved:!0}))},j=(s,h,v,C)=>{const A=B(r,g=>{const O=g[t].conditions[n].logics;C!==void 0?O[h][v].splice(C+1,0,s,{field:"",logic:"",val:""}):v!==void 0?O[h].splice(v+1,0,s,{field:"",logic:"",val:""}):O.splice(h+1,0,s,{field:"",logic:"",val:""})});N(A),w(g=>T($({},g),{unsaved:!0}))},S=(s,h,v)=>{let C=v!==void 0?r[t].conditions[n].logics[s][h][v-1]:h!==void 0?r[t].conditions[n].logics[s][h-1]:r[t].conditions[n].logics[s-1];C==="and"||C==="or"||(C="and");const A=B(r,g=>{const O=g[t].conditions[n].logics;if(v!==void 0){const R=$({},O[s][h][v]);O[s][h].splice(v+1,0,C,R)}else if(h!==void 0){const R=$({},O[s][h]);O[s].splice(h+1,0,C,R)}else{const R=$({},O[s]);O.splice(s+1,0,C,R)}});N(A),w(g=>T($({},g),{unsaved:!0}))},F=(s,h,v,C)=>{const A=B(r,g=>{const O=g[t].conditions[n].logics,R=u(O,h,v,C);R.smartKey=s});N(A),w(g=>T($({},g),{unsaved:!0}))},k=(s,h)=>{if(l.action_type!=="oninput")return!0;const v=s.findIndex(C=>C.field&&C.field in x);return v>=0&&v!==h},c=(s,h,v=0)=>{const C=[s],A={field:"",logic:"",val:""};v?C.push([A,s,A]):C.push(A),N(g=>B(g,O=>{const{logics:R}=g[t].conditions[n],U=[...R[h],...C];O[t].conditions[n].logics[h]=U}))};return(y=i==null?void 0:i.logics)==null?void 0:y.map((s,h)=>e.jsxs("span",{children:[typeof s=="object"&&!Array.isArray(s)&&e.jsx(Te,{logic:s,fieldVal:s.field,changeFormField:_,changeValue:b,changeSmartKey:F,logicValue:s.logic,changeLogic:o,addInlineLogic:j,cloneInLineLogic:S,delLogic:f,lgcGrpInd:t,lgcInd:h,value:s.val,actionType:l==null?void 0:l.action_type,smartTagAllowed:k(i.logics,h),formFields:we(i)}),typeof s=="string"&&e.jsx(We,{logic:s,onChange:v=>m(v.target.value,h)}),Array.isArray(s)&&e.jsxs("div",{className:"p-2 br-10 btcd-logic-grp mt-2 mb-2 pl-4 pr-4",children:[s.map((v,C)=>e.jsxs("span",{children:[typeof v=="object"&&!Array.isArray(v)&&e.jsx(Te,{logic:v,fieldVal:v.field,changeFormField:_,changeValue:b,changeSmartKey:F,logicValue:v.logic,changeLogic:o,addInlineLogic:j,cloneInLineLogic:S,delLogic:f,lgcGrpInd:t,lgcInd:h,subLgcInd:C,value:v.val,actionType:l==null?void 0:l.action_type,smartTagAllowed:k(s,C),formFields:we(i)}),typeof v=="string"&&e.jsx(We,{logic:v,nested:!0,onChange:A=>m(A.target.value,h,C)}),Array.isArray(v)&&e.jsxs("div",{className:"p-2 br-10 btcd-logic-grp mt-2 mb-2 pl-4 pr-4",children:[v.map((A,g)=>e.jsxs("span",{children:[typeof A=="object"&&!Array.isArray(A)&&e.jsx(Te,{logic:A,fieldVal:A.field,changeFormField:_,changeValue:b,changeSmartKey:F,logicValue:A.logic,changeLogic:o,addInlineLogic:j,cloneInLineLogic:S,delLogic:f,lgcGrpInd:t,lgcInd:h,subLgcInd:C,subSubLgcInd:g,value:A.val,actionType:l==null?void 0:l.action_type,smartTagAllowed:k(v,g),formFields:we(i)}),typeof A=="string"&&e.jsx(We,{logic:A,nested:!0,onChange:O=>m(O.target.value,h,C,g)})]},`subsubLogic-${g+90}`)),e.jsxs(Ne,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>j("and",h,C,v.length),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>j("or",h,C,v.length),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]})]})]})]})]},`subLogic-${C*7}`)),e.jsxs(Ne,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>c("and",h),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>c("or",h),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]}),e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>c("and",h,1),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND Group"]}),e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>c("or",h,1),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR Group"]})]})]})]})]},`logic-${h+44}`))}const ce={addItemBtn:{dy:"block",w:"100%",b:0,oe:0,brs:8,ta:"left",cr:"#444",fs:12,fw:500,p:5,pr:20,bd:"none",curp:1,":hover":{bc:"#EFEFEF"}}};function Mt({lgcGrpInd:l,lgcGrp:t}){var x;const{css:i}=X(),n=J(Z),p=J(K),r=f=>f.replace(/-/g," ").split(" ").map(o=>dt(o)).join(" "),N=f=>{Re(),n(o=>B(o,m=>{const{conditions:u}=m[l],b=T($({},ve),{cond_type:f});f==="else"&&delete b.logics,f==="else-if"&&u[u.length-1].cond_type==="else"?u.splice(u.length-1,0,b):u.push(b)})),p(o=>T($({},o),{unsaved:!0}))},w=(f,o,m="",u=0)=>{Re();const b=[f],_={field:"",logic:"",val:""};u?b.push([_,f,_]):b.push(_),n(j=>B(j,S=>{let F=S[l].conditions[o].logics;F=gt(F,m),F.push(...b)})),p(j=>T($({},j),{unsaved:!0}))};return e.jsxs("div",{className:i(se.container),children:[e.jsxs("div",{className:i(se.section),children:[t.action_behaviour==="cond"&&e.jsxs("div",{className:i(se.sideBdr),children:[e.jsx("div",{className:i(se.sideBdrLn)}),e.jsx("div",{className:i(se.sideBdrCrl)})]}),(x=t==null?void 0:t.conditions)==null?void 0:x.map((f,o)=>e.jsxs(ge.Fragment,{children:[t.action_behaviour==="cond"&&f.cond_type!=="else"&&e.jsxs(ze,{title:r(f.cond_type),accordionActions:f.cond_type!=="if"&&e.jsx(He,{lgcGrpInd:l,condGrpInd:o}),children:[e.jsx(Et,{lgcGrp:t,lgcGrpInd:l,condGrp:f,condGrpInd:o}),e.jsx("div",{className:"mt-1",children:e.jsxs(Ne,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:i(se.addItemBtn),onClick:()=>w("and",o),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:i(se.addItemBtn),onClick:()=>w("or",o),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]}),e.jsxs("button",{type:"button",className:i(se.addItemBtn),onClick:()=>w("and",o,"",1),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND Group"]}),e.jsxs("button",{type:"button",className:i(se.addItemBtn),onClick:()=>w("or",o,"",1),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR Group"]})]})]})})]},f.cond_type+0),t.action_behaviour==="cond"&&e.jsx(ze,{title:f.cond_type==="else"?"Else":"Then",titleOutline:f.cond_type!=="else",accordionActions:f.cond_type==="else"&&e.jsx(He,{lgcGrpInd:l,condGrpInd:o,add:!1,clone:!1}),children:e.jsx(qe,{lgcGrp:t,lgcGrpInd:l,condGrp:f,condGrpInd:o})},f.cond_type+1),t.action_behaviour!=="cond"&&e.jsx(qe,{lgcGrp:t,lgcGrpInd:l,condGrp:f,condGrpInd:o})]},`wkf-${o+99}`))]}),t.action_behaviour==="cond"&&e.jsxs(Ne,{place:"bottom",children:[e.jsx(ae,{msg:"Add Condition",children:e.jsx(q,{icn:!0,className:"blue sh-sm ml-2",children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:i(se.addItemBtn),onClick:()=>N("else-if"),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),'Add "Else If"']}),t.conditions[t.conditions.length-1].cond_type!=="else"&&e.jsxs("button",{type:"button",className:i(se.addItemBtn),onClick:()=>N("else"),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),'Add "Else"']})]})]})]})}const He=({lgcGrpInd:l,condGrpInd:t,add:i,clone:n,remove:p})=>{const[r,N]=ge.useState({show:!1}),w=J(Z),x=J(K),f=()=>{N({show:!1})},o=()=>{N({show:!1}),w(j=>B(j,S=>{S[l].conditions.splice(t,1)})),x(j=>T($({},j),{unsaved:!0}))},m=()=>{N({btnTxt:"Delete",body:"Are you sure to delete this logic?",btnClass:"",action:()=>{o(),f()},show:!0})},u=()=>{w(j=>B(j,S=>{S[l].conditions.splice(t+1,0,mt(S[l].conditions[t]))})),x(j=>T($({},j),{unsaved:!0}))},b=()=>{w(j=>B(j,S=>{S[l].conditions.splice(t+1,0,T($({},ve),{cond_type:"else-if"}))})),x(j=>T($({},j),{unsaved:!0}))},_=j=>typeof j=="boolean"?j:!0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[_(i)&&e.jsx(ae,{msg:"Add Else If",children:e.jsx(q,{onClick:b,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(wt,{size:"16"})})}),_(n)&&e.jsx(ae,{msg:"Clone",children:e.jsx(q,{onClick:u,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(_e,{size:"16"})})}),_(p)&&e.jsx(ae,{msg:"Delete",children:e.jsx(q,{onClick:m,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(Fe,{size:"16"})})})]}),e.jsx(Ye,{show:r.show,close:f,btnTxt:r.btnTxt,btnClass:r.btnClass,body:r.body,action:r.action})]})},se={container:{mt:10},section:{pn:"relative",w:"100%",zx:1,mb:10,pb:10},sideBdr:{flx:"center",fd:"column",w:50,pn:"absolute",h:"100%",zx:-1},sideBdrLn:{w:2,bc:"var(--b-50)",h:"100%"},sideBdrCrl:{brs:"50%",bc:"var(--b-50)",h:8,w:8,mt:-1},addItemBtn:{dy:"block",w:"100%",b:0,oe:0,brs:8,ta:"left",cr:"#444",fs:12,fw:500,p:5,pr:20,bd:"none",curp:1,":hover":{bc:"#EFEFEF"}}};function Dt({lgcGrpInd:l,lgcGrp:t}){var f;const[i,n]=le(Z),p=J(K),{css:r}=X(),N=o=>{const m=B(i,u=>{o==="delete"?delete u[l].action_type:u[l].action_type===void 0&&(u[l].action_type="onload"),u[l].action_run=o});n(m),p(u=>T($({},u),{unsaved:!0}))},w=o=>{const m=B(i,u=>{o==="onsubmit"&&u[l].conditions.forEach(_=>{var S,F;const j=(F=(S=_.actions)==null?void 0:S.fields)==null?void 0:F.length;for(let k=0;k<j;k+=1)_.actions.fields[k].action="value"}),o!=null&&o.match(/^(onvalidate|oninput)$/)&&(u[l].action_behaviour="cond"),u[l].conditions.forEach(_=>{o==="onvalidate"?(_.actions.failure||(_.actions.failure=""),delete _.actions.fields,delete _.actions.success):(_.actions.fields||(_.actions.fields=[{field:"",action:"value"}]),_.actions.success||(_.actions.success=[]),delete _.actions.failure)});const[b]=u[l].conditions;b.cond_type="if",b.logics||(b.logics=ve.logics),u[l].action_type=o});n(m),p(u=>T($({},u),{unsaved:!0}))},x=o=>{const m=B(i,u=>{u[l].action_behaviour=o;const[b]=u[l].conditions;b.cond_type=o==="cond"?"if":o,o==="always"?delete b.logics:o==="cond"&&(b.logics=ve.logics),u[l].conditions=[b]});n(m),p(u=>T($({},u),{unsaved:!0}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:a("Action Run When:")})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[e.jsx(G,{radio:!0,onChange:o=>N(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Record Create/Edit")}),checked:t.action_run==="create_edit",value:"create_edit"}),e.jsx(G,{radio:!0,onChange:o=>N(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Record Create")}),checked:t.action_run==="create",value:"create"}),e.jsx(G,{radio:!0,onChange:o=>N(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Record Edit")}),checked:t.action_run==="edit",value:"edit"}),e.jsx(G,{radio:!0,onChange:o=>N(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Record Delete")}),checked:t.action_run==="delete",value:"delete"})]})]}),t.action_run!=="delete"&&e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:a("Action Effect:")})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[e.jsxs("div",{className:r(Pt.actionEffectGroup),children:[e.jsx(G,{radio:!0,onChange:o=>w(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Always")}),checked:t.action_type==="always",value:"always"}),e.jsx(G,{radio:!0,onChange:o=>w(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Only on Form Load")}),checked:t.action_type==="onload",value:"onload"}),e.jsx(G,{radio:!0,onChange:o=>w(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Only on Field Input")}),checked:t.action_type==="oninput",value:"oninput"})]}),e.jsx(G,{radio:!0,onChange:o=>w(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Only on Form Validate")}),checked:t.action_type==="onvalidate",value:"onvalidate"}),e.jsx(G,{radio:!0,onChange:o=>w(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Only on Form Submit")}),checked:t.action_type==="onsubmit",value:"onsubmit"})]})]}),e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:a("Action Behaviour:")})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[!((f=t==null?void 0:t.action_type)!=null&&f.match(/^(onvalidate|oninput)$/))&&e.jsx(G,{radio:!0,onChange:o=>x(o.target.value),name:`ab-${l+121}`,title:e.jsx("small",{className:"txt-dp",children:a("Always")}),checked:t.action_behaviour==="always",value:"always"}),e.jsx(G,{radio:!0,onChange:o=>x(o.target.value),title:e.jsx("small",{className:"txt-dp",children:a("Condition")}),checked:t.action_behaviour==="cond",value:"cond"})]})]})]})}const Pt={actionEffectGroup:{dy:"inline-block",b:"1px solid var(--gray-3)",brs:8}};function Gt(){const l=Y(pt),[t,i]=ge.useState({show:!1}),[n,p]=le(Z),r=J(K),{css:N}=X(),w=Y(Qe),{isPro:x}=w,f=k=>{switch(k){case"onload":return a("On Load");case"oninput":return a("On Field Input");case"onvalidate":return a("On Form Validate");case"onsubmit":return a("On Form Submit");case"create_edit":return a("Record Create/Edit");case"create":return a("Record Create");case"edit":return a("Record Edit");case"delete":return a("Record Delete");case"always":return a("Always");case"cond":return a("With Condition")}},o=()=>{const k=B(n,c=>{c.unshift({title:`Action ${n.length+1}`,action_type:"always",action_run:"create_edit",action_behaviour:"cond",conditions:[$({},ve)],status:1})});p(k),r(c=>T($({},c),{unsaved:!0}))},m=k=>{if(n[k].id){const c=ht({formID:l,id:n[k].id},"bitforms_delete_workflow").then(y=>{if(y!==void 0&&y.success){const s=B(n,h=>{h.splice(k,1)});p(s)}});ut.promise(c,{success:"Successfully Deleted.",loading:"Deleting...",error:"Error occurred, Try again."})}else{const c=B(n,y=>{y.splice(k,1)});p(c)}},u=(k,c)=>{const y=B(n,s=>{s[c].title=k.target.value});p(y),r(s=>T($({},s),{unsaved:!0}))},b=(k,c)=>{const y=B(n,s=>{s[c].status=k.target.checked});p(y),r(s=>T($({},s),{unsaved:!0}))},_=()=>{t.show=!1,i($({},t))},j=k=>{t.btnTxt="Delete",t.body="Are you sure to delete this conditional logic?",t.btnClass="",t.action=()=>{m(k),_()},t.show=!0,i($({},t))},S=k=>{const c=B(n,y=>{const s=$({},y[k]);s.title=`${s.title} (Clone-${n.length+1})`,delete s.id,y.splice(k+1,0,s)});p(c),r(y=>T($({},y),{unsaved:!0}))},F=({oldIndex:k,newIndex:c})=>{k!==c&&(p(y=>kt(y,k,c)),r(y=>T($({},y),{unsaved:!0})))};return e.jsxs("div",{className:"btcd-workflow",style:{width:"93%"},children:[e.jsx(Ye,{show:t.show,close:_,btnTxt:t.btnTxt,btnClass:t.btnClass,body:t.body,action:t.action}),e.jsx("h2",{children:a("Conditional Logics")}),e.jsxs("h5",{children:["How to configure conditional logics: Â ",e.jsx("a",{href:Pe.conditionalLogic.link,target:"_blank",rel:"noreferrer",className:"yt-txt ml-1 mr-1",children:"YouTube"}),e.jsx("a",{href:Pe.conditionalLogicDoc.link,target:"_blank",rel:"noreferrer",className:"doc-txt",children:"Documentation"})]}),(!x&&!n.length||x)&&e.jsxs(q,{className:"blue",onClick:o,children:[e.jsx(z,{size:"10",className:"icn-rotate-45 mr-1"}),a("Add Conditional Logic")]}),n.length===0&&e.jsxs("div",{className:N(H.btcdEmpty,H.txCenter),children:[e.jsx(vt,{size:"50"}),a("Empty")]}),e.jsx(ft,{onSortEnd:F,useDragHandle:!0,children:n.map((k,c)=>e.jsxs(xt,{index:c,children:[e.jsxs("div",{className:"workflow-grp d-flx mt-2",children:[e.jsxs(jt,{customTitle:e.jsx(bt,{className:"workflow-drg-handle mr-1 flx"}),title:k.title,header:e.jsxs("small",{className:"f-right txt-dp mr-4",children:[e.jsxs("span",{className:"mr-2",children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),f(k.action_run)]}),k.action_type!==void 0&&e.jsxs("span",{className:"mr-2",children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),f(k.action_type)]}),e.jsxs("span",{children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),f(k.action_behaviour)]})]}),toggle:!0,checked:k.status,action:y=>b(y,c),titleEditable:!0,onTitleChange:y=>u(y,c),notScroll:!0,cls:x?"w-9":"w-10",children:[e.jsx(Dt,{lgcGrpInd:c,lgcGrp:k}),e.jsx(Mt,{lgcGrpInd:c,lgcGrp:k})]}),x&&e.jsxs("div",{className:"mt-2 flx flx-start",children:[e.jsx(q,{onClick:()=>S(c),icn:!0,className:"ml-2 sh-sm btcd-menu-btn tooltip",style:{"--tooltip-txt":'"Clone Action"'},children:e.jsx(_e,{size:"16"})}),e.jsx(q,{onClick:()=>j(c),icn:!0,className:"sh-sm btcd-menu-btn tooltip",style:{"--tooltip-txt":'"Delete Action"'},children:e.jsx(Fe,{size:"16"})})]})]}),!x&&e.jsxs("div",{className:"txt-center bg-pro p-5 mt-2",children:[a("For"),"Â ",e.jsx("span",{className:"txt-pro",children:a("UNLIMITED")}),"Â ",a("Conditional Logics"),",Â ",e.jsx("a",{href:"https://www.bitapps.pro/bit-form",target:"_blank",rel:"noreferrer",children:e.jsx("b",{className:"txt-pro",children:a("Buy Premium")})})]})]},`workflows-grp-${c+13}`))}),n.length>1&&e.jsxs("div",{className:N(H.w9,{fs:13},H.mt4),children:[e.jsx("strong",{children:a("Note:")})," ",a("Conditional Logics are triggered based on the order of the logic groups. The higher the logic group, the higher the priority. If you want to change the priority, you can sort by drag and drop the logic group.")]})]})}export{Gt as default};
