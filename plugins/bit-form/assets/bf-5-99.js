var E=Object.defineProperty,U=Object.defineProperties;var b=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var L=Object.prototype.hasOwnProperty,M=Object.prototype.propertyIsEnumerable;var C=(t,e,s)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s,p=(t,e)=>{for(var s in e||(e={}))L.call(e,s)&&C(t,s,e[s]);if(A)for(var s of A(e))M.call(e,s)&&C(t,s,e[s]);return t},D=(t,e)=>U(t,b(e));import{_ as i,ae as S,$ as w,c as I,u as Z,r as y,j as a,C as N}from"./main-509.js";import{t as F}from"./bf-890-82.js";import{a4 as P,a5 as O,a6 as q}from"./bf-445-81.js";const Y=(t,e,s,d,n,l,o,r,c)=>{let h=p({},s);if(o){const u=p({},r);u[t.target.name]="",c(p({},u))}switch(h[t.target.name]=t.target.value,t.target.name){case"list":h=V(h,e,d,n,l);break}d(p({},h))},V=(t,e,s,d,n)=>{var o,r;const l=p({},t);return l.field_map=[{formField:"",zohoFormField:"Contact Email"}],(r=(o=l==null?void 0:l.default)==null?void 0:o.fields)!=null&&r[l.list]||k(e,l,s,d,n),l},T=(t,e,s,d,n)=>{d(!0);const l={formID:t,id:e.id,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails};I(l,"bitforms_zmarketingHub_refresh_lists").then(o=>{if(o&&o.success){const r=p({},e);o.data.lists&&(r.default=D(p({},r.default),{lists:o.data.lists})),o.data.tokenDetails&&(r.tokenDetails=o.data.tokenDetails),n({show:!0,msg:i("Lists refreshed")}),s(p({},r))}else o&&o.data&&o.data.data||!o.success&&typeof o.data=="string"?n({show:!0,msg:`${i("Lists refresh failed Cause:")}${o.data.data||o.data}. ${i("please try again")}`}):n({show:!0,msg:i("Lists refresh failed. please try again")});d(!1)}).catch(()=>d(!1))},k=(t,e,s,d,n)=>{const{list:l}=e;if(!l)return;d(!0);const o={formID:t,list:l,dataCenter:e.dataCenter,clientId:e.clientId,clientSecret:e.clientSecret,tokenDetails:e.tokenDetails};I(o,"bitforms_zmarketingHub_refresh_contact_fields").then(r=>{if(r&&r.success){const c=p({},e);r.data.fields?(c.default.fields||(c.default.fields={}),c.default.fields[l]=r.data,n({show:!0,msg:i("Contact Fields refreshed")})):n({show:!0,msg:i("Zoho didn't provide fields names for this list")}),r.data.tokenDetails&&(c.tokenDetails=r.data.tokenDetails),s(p({},c))}else n({show:!0,msg:i("Contact Fields refresh failed. please try again")});d(!1)}).catch(()=>d(!1))},H=t=>!((t!=null&&t.field_map?t.field_map.filter(s=>{var d,n,l;return!s.formField&&s.zohoFormField&&((l=(n=(d=t==null?void 0:t.default)==null?void 0:d.fields)==null?void 0:n[t.list])==null?void 0:l.required.indexOf(s.zohoFormField))!==-1}):[]).length>0),B=(t,e,s,d,n,l)=>{if(!t.dataCenter||!t.clientId||!t.clientSecret){s({dataCenter:t.dataCenter?"":i("Data center cann't be empty"),clientId:t.clientId?"":i("Client ID cann't be empty"),clientSecret:t.clientSecret?"":i("Secret key cann't be empty")});return}const o=S(w);n(!0);const r="ZohoMarketingHub.lead.READ,ZohoMarketingHub.lead.CREATE,ZohoMarketingHub.lead.UPDATE",c=`https://accounts.zoho.${t.dataCenter}/oauth/v2/auth?scope=${r}&response_type=code&client_id=${t.clientId}&prompt=Consent&access_type=offline&state=${encodeURIComponent(window.location.href)}/redirect&redirect_uri=${encodeURIComponent(o.zohoRedirectURL)}`,h=window.open(c,"zohoMarkatingHub","width=400,height=609,toolbar=off"),u=setInterval(()=>{if(h.closed){clearInterval(u);let m={},j=!1;const f=localStorage.getItem("__bitforms_zohoMarkatingHub");if(f&&(j=!0,m=JSON.parse(f),localStorage.removeItem("__bitforms_zohoMarkatingHub")),!m.code||m.error||!m||!j){const x=m.error?`Cause: ${m.error}`:"";l({show:!0,msg:`${i("Authorization failed")} ${x}. ${i("please try again")}`}),n(!1)}else{const x=p({},t);x.accountServer=m["accounts-server"],J(m,x,e,d,n,l)}}},500)},J=(t,e,s,d,n,l)=>{const o=S(w),r=p({},t);r.dataCenter=e.dataCenter,r.clientId=e.clientId,r.clientSecret=e.clientSecret,r.redirectURI=encodeURIComponent(o.zohoRedirectURL),I(r,"bitforms_zmarketingHub_generate_token").then(c=>{if(c&&c.success){const h=p({},e);h.tokenDetails=c.data,s(h),P(h),d(!0),l({show:!0,msg:i("Authorized Successfully")})}else c&&c.data&&c.data.data||!c.success&&typeof c.data=="string"?l({show:!0,msg:`${i("Authorization failed Cause:")}${c.data.data||c.data}. ${i("please try again")}`}):l({show:!0,msg:i("Authorization failed. please try again")});n(!1)})};function W({formID:t,marketingHubConf:e,setMarketingHubConf:s,step:d,setstep:n,isLoading:l,setisLoading:o,setSnackbar:r,redirectLocation:c,isInfo:h,authorizedAction:u}){const m=Z(w),{siteURL:j}=m,[f,x]=y.useState(!1),[z,R]=y.useState({dataCenter:"",clientId:"",clientSecret:""}),v=_=>{const g=p({},e),$=p({},z);$[_.target.name]="",g[_.target.name]=_.target.value,R($),s(g)};return y.useEffect(()=>{f&&u()},[f]),a.jsxs(a.Fragment,{children:[a.jsx(O,{title:F.zohoMarketingHub.title,youTubeLink:F.zohoMarketingHub.link}),a.jsxs("div",{className:"btcd-stp-page",style:{width:900,height:"100%"},children:[a.jsx("div",{className:"mt-3",children:a.jsx("b",{children:i("Integration Name:")})}),a.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:v,name:"name",value:e.name,type:"text",placeholder:i("Integration Name..."),disabled:h}),a.jsx("div",{className:"mt-3",children:a.jsx("b",{children:i("Data Center:")})}),a.jsxs("select",{onChange:v,name:"dataCenter",value:e.dataCenter,className:"btcd-paper-inp w-6 mt-1",disabled:h,children:[a.jsx("option",{value:"",children:i("--Select a data center--")}),a.jsx("option",{value:"com",children:"zoho.com"}),a.jsx("option",{value:"eu",children:"zoho.eu"}),a.jsx("option",{value:"com.cn",children:"zoho.com.cn"}),a.jsx("option",{value:"in",children:"zoho.in"}),a.jsx("option",{value:"com.au",children:"zoho.com.au"})]}),a.jsx("div",{style:{color:"red"},children:z.dataCenter}),a.jsx("div",{className:"mt-3",children:a.jsx("b",{children:i("Homepage URL:")})}),a.jsx(N,{value:j,className:"field-key-cpy w-6 ml-0",readOnly:h}),a.jsx("div",{className:"mt-3",children:a.jsx("b",{children:i("Authorized Redirect URIs:")})}),a.jsx(N,{value:c||`${m.zohoRedirectURL}`,className:"field-key-cpy w-6 ml-0",readOnly:h}),a.jsxs("small",{className:"d-blk mt-5",children:[i("To get Client ID and SECRET , Please Visit")," ",a.jsx("a",{className:"btcd-link",href:`https://api-console.zoho.${(e==null?void 0:e.dataCenter)||"com"}/`,target:"_blank",rel:"noreferrer",children:i("Zoho API Console")})]}),a.jsx("div",{className:"mt-3",children:a.jsx("b",{children:i("Client id:")})}),a.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:v,name:"clientId",value:e.clientId,type:"text",placeholder:i("Client id..."),disabled:h}),a.jsx("div",{style:{color:"red"},children:z.clientId}),a.jsx("div",{className:"mt-3",children:a.jsx("b",{children:i("Client secret:")})}),a.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:v,name:"clientSecret",value:e.clientSecret,type:"text",placeholder:i("Client secret..."),disabled:h}),a.jsx("div",{style:{color:"red"},children:z.clientSecret}),!h&&a.jsxs(a.Fragment,{children:[a.jsx(q,{isAuthorized:f,isLoading:l,handleAuthorize:()=>B(e,s,R,x,o,r)}),a.jsx("br",{})]})]})]})}var ee=Object.freeze({__proto__:null,default:W});export{W as Z,k as a,ee as b,H as c,Y as h,T as r};
