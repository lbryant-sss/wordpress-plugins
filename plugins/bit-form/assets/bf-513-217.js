var R=Object.defineProperty;var A=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var T=(t,u,e)=>u in t?R(t,u,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[u]=e,m=(t,u)=>{for(var e in u||(u={}))k.call(u,e)&&T(t,e,u[e]);if(A)for(var e of A(u))$.call(u,e)&&T(t,e,u[e]);return t};import{c as F,c5 as a,j as s,T as q,u as M,J as P,$ as V,r as L,e as O}from"./main-381.js";import{P as E,u as z}from"./bf-540-79.js";import{ac as H,aa as U}from"./bf-433-81.js";import{S as B}from"./bf-878-172.js";import{M as D}from"./bf-445-114.js";const v=(t,u,e)=>{const l=m({},u);l.name=t.target.value,e(m({},l))},G=(t,u,e,l)=>{const h={api_key:t.api_key,api_url:t.api_url};F(h,"bitforms_aCampaign_lists").then(i=>{if(i&&i.success){const r=m({},t);i.data.activeCampaignLists?(r.default||(r.default={}),r.default.activeCampaignLists=i.data.activeCampaignLists,l({show:!0,msg:a("ActiveCampaign lists refreshed")})):l({show:!0,msg:a("No ActiveCampaign lists found. Try changing the header row number or try again")}),u(m({},r))}else l({show:!0,msg:a("ActiveCampaign lists refresh failed. please try again")});e(!1)}).catch(()=>e(!1))},I=(t,u,e,l)=>{const h={api_key:t.api_key,api_url:t.api_url};F(h,"bitforms_aCampaign_tags").then(i=>{if(i&&i.success){const r=m({},t);i.data.activeCampaignTags?(r.default||(r.default={}),r.default.activeCampaignTags=i.data.activeCampaignTags,l({show:!0,msg:a("ActiveCampaign tags refreshed")})):l({show:!0,msg:a("No ActiveCampaign tags found. Try changing the header row number or try again")}),u(m({},r))}else l({show:!0,msg:a("ActiveCampaign tags refresh failed. please try again")});e(!1)}).catch(()=>e(!1))},g=(t,u,e,l)=>{const h={api_key:t.api_key,api_url:t.api_url};F(h,"bitforms_aCampaign_headers").then(i=>{if(i&&i.success){const r=m({},t);if(i.data.activeCampaignField){r.default||(r.default={}),r.default.fields=i.data.activeCampaignField;const{fields:p}=r.default;r.field_map=Object.values(p).filter(x=>x.required).map(x=>({formField:"",activeCampaignField:x.fieldId,required:!0})),l({show:!0,msg:a("ActiveCampaign fields refreshed")})}else l({show:!0,msg:a("No ActiveCampaign fields found. Try changing the header row number or try again")});u(m({},r))}else l({show:!0,msg:a("ActiveCampaign fields refresh failed. please try again")});e(!1)}).catch(()=>e(!1))},C=t=>!((t!=null&&t.field_map?t.field_map.filter(e=>!e.formField&&e.activeCampaignField&&e.required):[]).length>0);function J({activeCampaingConf:t,setActiveCampaingConf:u}){var l;const e=(h,i)=>{const r=m({},t);i==="update"&&(h.target.checked?r.actions.update=!0:delete r.actions.update),u(m({},r))};return s.jsx("div",{className:"pos-rel d-flx w-8",children:s.jsx(q,{checked:((l=t.actions)==null?void 0:l.update)||!1,onChange:h=>e(h,"update"),className:"wdt-200 mt-4 mr-2",value:"user_share",title:a("Update ActiveCampaign"),subTitle:a("Update Responses with ActiveCampaign existing email?")})})}function K({i:t,formFields:u,field:e,activeCampaingConf:l,setActiveCampaingConf:h}){var N,f,c,n;const i=e.required,r=M(V),{isPro:p}=r,x=((N=l==null?void 0:l.default)==null?void 0:N.fields)&&Object.values((f=l==null?void 0:l.default)==null?void 0:f.fields).filter(d=>!d.required),y=d=>{const o=m({},l);o.field_map.splice(d,0,{}),h(o)},w=d=>{const o=m({},l);o.field_map.length>1&&o.field_map.splice(d,1),h(o)},b=(d,o)=>{const j=m({},l);j.field_map[o][d.target.name]=d.target.value,d.target.value==="custom"&&(j.field_map[o].customValue=""),h(j)},_=(d,o)=>{const j=m({},l);j.field_map[o].customValue=d.target.value,h(j)};return s.jsxs("div",{className:"flx mt-2 mr-1",children:[s.jsxs("div",{className:"flx integ-fld-wrp",children:[s.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:e.formField||"",onChange:d=>b(d,t),children:[s.jsx("option",{value:"",children:a("Select Field")}),s.jsx("optgroup",{label:"Form Fields",children:u.map(d=>d.type!=="file-up"&&s.jsx("option",{value:d.key,children:d.name},`ff-zhcrm-${d.key}`))}),s.jsx("option",{value:"custom",children:a("Custom...")}),s.jsx("optgroup",{label:`General Smart Codes ${p?"":"(PRO)"}`,children:p&&((c=B)==null?void 0:c.map(d=>s.jsx("option",{value:d.name,children:d.label},`ff-rm-${d.name}`)))})]}),e.formField==="custom"&&s.jsx(D,{onChange:d=>_(d,t),label:a("Custom Value"),className:"mr-2",type:"text",value:e.customValue,placeholder:a("Custom Value")}),s.jsxs("select",{className:"btcd-paper-inp",name:"activeCampaignField",value:e.activeCampaignField,onChange:d=>b(d,t),disabled:i,children:[s.jsx("option",{value:"",children:a("Select Field")}),i?((n=l==null?void 0:l.default)==null?void 0:n.fields)&&Object.values(l.default.fields).map(d=>s.jsx("option",{value:d.fieldId,children:d.fieldName},`${d.fieldId}-1`)):x&&x.map(d=>s.jsx("option",{value:d.fieldId,children:d.fieldName},`${d.fieldId}-1`))]})]}),!i&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>y(t),className:"icn-btn sh-sm ml-2",type:"button",children:"+"}),s.jsx("button",{onClick:()=>w(t),className:"icn-btn sh-sm ml-2",type:"button","aria-label":"btn",children:s.jsx(P,{})})]})]})}function ee({formID:t,formFields:u,activeCampaingConf:e,setActiveCampaingConf:l,isLoading:h,setIsLoading:i,setSnackbar:r,setShowMdl:p}){var b,_,N,f;const x=c=>{const n=m({},e);c?n.tagIds=c?c.split(","):[]:delete n.tagIds,l(m({},n))},y=c=>{const n=m({},e);c.target.value?n[c.target.name]=c.target.value:delete n.listId,g(n,l,i,r)},w=(b=e==null?void 0:e.default)==null?void 0:b.activeCampaignLists;return L.useEffect(()=>{w&&I(e,l,i,r)},[w]),s.jsxs(s.Fragment,{children:[s.jsx("br",{}),s.jsx("b",{className:"wdt-200 d-in-b",children:a("Connected API:")}),s.jsxs("select",{className:"btcd-paper-inp w-5",value:e.parentAppId,onChange:y,name:"parentAppId",children:[s.jsx("option",{value:"",children:a("Select an App")}),H([e.type]).map(c=>s.jsx("option",{value:c.id,children:c.integration_name},c.id))]}),s.jsx("button",{"aria-label":"Add New",onClick:()=>p(!0),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Add New API"'},type:"button",disabled:h,children:s.jsx(E,{size:18})}),s.jsx("br",{}),s.jsx("br",{}),s.jsx("b",{className:"wdt-200 d-in-b",children:a("List:")}),s.jsxs("select",{value:e==null?void 0:e.listId,name:"listId",id:"",className:"btcd-paper-inp w-5",onChange:y,children:[s.jsx("option",{value:"",children:a("Select List")}),((_=e==null?void 0:e.default)==null?void 0:_.activeCampaignLists)&&Object.keys(e.default.activeCampaignLists).map(c=>s.jsx("option",{value:e.default.activeCampaignLists[c].listId,children:e.default.activeCampaignLists[c].listName},`${c+1}`))]}),s.jsx("button",{onClick:()=>G(e,l,i,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Activecapmaign list"'},type:"button",disabled:h,children:"↻"}),s.jsx("br",{}),s.jsx("br",{}),s.jsxs("div",{className:"d-flx",children:[s.jsx("b",{style:{marginTop:"15px"},className:"wdt-200 d-in-b",children:a("Tags: ")}),s.jsx(z,{defaultValue:e==null?void 0:e.tagIds,className:"btcd-paper-drpdwn w-5",options:((N=e==null?void 0:e.default)==null?void 0:N.activeCampaignTags)&&Object.keys(e.default.activeCampaignTags).map(c=>({label:e.default.activeCampaignTags[c].tagName,value:e.default.activeCampaignTags[c].tagId})),onChange:c=>x(c)}),s.jsx("button",{onClick:()=>I(e,l,i,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh Activecapmaign Tags")}'`},type:"button",disabled:h,children:"↻"})]}),s.jsx("br",{}),h&&s.jsx(O,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),s.jsxs("div",{className:"mt-4",children:[s.jsx("b",{className:"wdt-100",children:a("Map Fields")}),s.jsx("button",{onClick:()=>g(e,l,i,r),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`'${a("Refresh Activecapmaign Field")}'`},type:"button",disabled:h,children:"↻"})]}),((e==null?void 0:e.listId)||((f=e==null?void 0:e.default)==null?void 0:f.fields))&&s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"btcd-hr mt-1"}),s.jsxs("div",{className:"flx flx-around mt-2 mb-1",children:[s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:a("Form Fields")})}),s.jsx("div",{className:"txt-dp",children:s.jsx("b",{children:a("ActiveCampaign Fields")})})]}),e.field_map.map((c,n)=>s.jsx(K,{i:n,field:c,activeCampaingConf:e,formFields:u,setActiveCampaingConf:l},`Activecampaign-m-${n+9}`)),s.jsx("div",{className:"txt-center  mt-2",style:{marginRight:85},children:s.jsx("button",{onClick:()=>U(e.field_map.length,e,l),className:"icn-btn sh-sm",type:"button",children:"+"})}),s.jsx("br",{}),s.jsx("br",{}),s.jsx("div",{className:"mt-4",children:s.jsx("b",{className:"wdt-100",children:a("Actions")})}),s.jsx("div",{className:"btcd-hr mt-1"}),s.jsx(J,{activeCampaingConf:e,setActiveCampaingConf:l})]})]})}export{ee as A,C as c,v as h,G as r};
