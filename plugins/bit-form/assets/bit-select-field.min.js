var bit_select_field=function(){"use strict";return class{#t=null;#e=null;#s=null;#i=null;#n=null;#l=null;#o=null;#h=null;#a=null;#r=null;#p=null;#c=!1;#d=null;#u=null;#m="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg'/>";#g="";#f=[];#O=[];#b=null;#C={};#E=!1;#y={separator:",",selectedOptImage:!1,dropdownIcn:"",selectedOptClearable:!0,searchClearable:!0,optionIcon:!0,defaultValue:"",placeholder:"Select an option",searchPlaceholder:"Search option",maxHeight:370,closeOnSelect:!1,showChip:!0,options:[],attributes:{},classNames:{},activeList:0,onChange:()=>{}};#w=null;#I="";#v=[];constructor(t,e){Object.assign(this.#y,e),this.#b=e.document?e.document:document,this.#C=e.window?e.window:window,this.#t="string"==typeof t?this.#b.querySelector(t):t,this.fieldKey=this.#y.fieldKey,this.init()}init(){this.#s=this.#S(`.${this.fieldKey}-dpd-hidden-input`),this.#i=this.#S(`.${this.fieldKey}-opt-search-input`),this.#n=this.#S(`.${this.fieldKey}-option-wrp`),this.#l=this.#S(`.${this.fieldKey}-dpd-wrp`),this.#o=this.#S(`.${this.fieldKey}-selected-opt-wrp`),this.#h=this.#S(`.${this.fieldKey}-selected-opt-img`),this.#a=this.#S(`.${this.fieldKey}-selected-opt-lbl`),this.#r=this.#S(`.${this.fieldKey}-selected-opt-clear-btn`),this.#p=this.#y.searchClearable?this.#S(`.${this.fieldKey}-search-clear-btn`):{},this.#x(this.#l,"click",(t=>{this.#A(t)})),this.#x(this.#l,"keyup",(t=>{this.#A(t)})),this.#x(this.#l,"blur",(t=>{this.#L(t)})),this.#x(this.#t,"keydown",(t=>{this.#k(t)})),this.#T(),this.#y.defaultValue&&this.setSelectedOption(this.#y.defaultValue),this.#y.defaultValue||this.#N(),this.#y.selectedOptImage&&(this.#h.src=this.#m),this.#y.searchClearable&&(this.#V(this.#p,"display","none"),this.#x(this.#p,"click",(()=>{this.searchOptions("")}))),this.#i.placeholder=this.#y.searchPlaceholder,this.#i.value="",this.#x(this.#i,"keyup",(t=>{this.#W(t)})),this.#c=this.#y.allowCustomOption,this.#C.observeElm(this.#s,"value",((t,e)=>{this.#P(t,e,this.#E)}))}#T(){const t=this.#S(`.${this.fieldKey}-option-list[data-list-index="${this.#y.activeList}"]`);this.#u=this.#S(`.${this.fieldKey}-option-list.active-list`),this.#u.innerHTML=t.innerHTML,this.#B(),this.#y.options=this.#M(),this.#O=[...this.#y.options],this.#x(this.#u,"scroll",(t=>t.stopPropagation()))}#S(t,e){return e?e.querySelector(t):this.#t.querySelector(t)}#F(t){return this.#t.querySelectorAll(t)}#x(t,e,s){t?.addEventListener(e,s),this.#v.push({selector:t,eventType:e,cb:s})}#H(t,e){t.appendChild(e)}#N(){this.#s.value&&(this.setSelectedOption(this.#s.value),this.#D())}#$(t,e){const s=new Event(e);t.dispatchEvent(s)}#P(t,e){t!==e&&this.setSelectedOption(e),"undefined"!=typeof bit_conditionals&&bit_conditionals({target:this.#s})}#K(t=-1,e){if("next"===e){const e=this.#O.length;for(let s=t+1;s<e;s+=1){const t=this.#O[s];if("group"!==t.type&&!t.disabled&&!t.disableOnMax)return s}}else if("previous"===e)for(let e=t-1;e>=0;e-=1){const t=this.#O[e];if("group"!==t.type&&!t.disabled&&!t.disableOnMax)return e}}#R(t){return this.#S(`${this.#j()} .option[data-index="${t}"]`)}#k(t){const e=this.#b.activeElement;let s=null;if(this.#q()){const i=Number(e.dataset.index||-1);if("ArrowDown"===t.key||!t.shiftKey&&"Tab"===t.key){t.preventDefault();let n=0,l=null;e===this.#i?(n=this.#K(-1,"next"),this.#c&&0===n&&"block"!==this.#_(this.#d)&&(n=1),l=this.#R(n)):e.classList.contains("option")&&(n=this.#K(i,"next"),l=this.#R(n)),l&&(s=l)}else if("ArrowUp"===t.key||t.shiftKey&&"Tab"===t.key){if(t.preventDefault(),e===this.#i)s=this.#l,this.#q()&&this.setMenu({open:!1});else if(e.classList.contains("option")){let t=this.#K(i,"previous");this.#z&&0===t&&"block"!==this.#_(this.#d)&&(t=-1);const e=this.#R(t);e?s=e:e||(s=this.#i)}}else"Escape"===t.key&&this.setMenu({open:!1})}else if(t.key>="a"&&t.key<="z"){clearTimeout(this.#w),this.#I+=t.key,this.#w=setTimeout((()=>{this.#I=""}),300);const e=this.#y.options.find((t=>"group"!==t.type&&!t.disabled&&t.lbl.toLowerCase().startsWith(this.#I)));e&&this.setSelectedOption(e.val)}else if("ArrowDown"===t.key||"ArrowUp"===t.key){if(this.#y.multipleSelect)return;t.preventDefault();const e=this.#U(),s="ArrowDown"===t.key?"next":"previous";let i=this.#K(e,s);this.#c&&0===i&&(i=1),i>-1&&i<this.#y.options.length&&(this.value=this.#y.options[i].val)}else if(("ArrowRight"===t.key||"ArrowLeft"===t.key)&&e.classList.contains("chip-clear-btn")){let i=null;"ArrowRight"===t.key?i=e.parentElement.nextElementSibling:"ArrowLeft"===t.key&&(i=e.parentElement.previousElementSibling),i&&(s=this.#S(".chip-clear-btn",i))}s&&s.focus()}#j(){return`.${this.fieldKey}-option-list.active-list`}#M(){const t=Array.from(this.#F(`${this.#j()} .option`)),e=t=>{const e={},s=t.querySelector(".opt-lbl"),{value:i}=t.dataset;e.lbl=s.textContent,e.val=i||e.lbl,this.#G(t,"disabled-opt")&&(e.disabled=!0);const n=t.querySelector(".opt-icn");this.#y.optionIcon&&n?.src&&(e.icn=n.src);const{attributes:l}=t,o=l.length;e.attributes={};for(let s=0;s<o;s+=1){const i=l[s].nodeName;e.attributes[i]=t.getAttribute(i)}return e},s=[],{length:i}=t;for(let n=0;n<i;n+=1){const l=t[n];let o={},h=null;if(l.classList.contains("opt-group-title")){o=e(l),o.type="group",s.push(o),h=n;for(let l=n+1;l<i;l+=1){const i=t[l];if(!i.classList.contains("opt-group-child")){n=l-1;break}{const t=e(i);t.groupIndex=h,n=l,s.push(t)}}}else o=e(l),s.push(o)}return s}#J(t){t?.stopPropagation(),this.#g="",this.#y.selectedOptImage&&(this.#h.src=this.#m,this.#Q(this.#h)),this.value="",this.#y.multipleSelect&&this.#y.showChip&&this.#X([]),this.#y.showChip||this.#Y(this.#a,this.#y.placeholder),this.#y.selectedOptClearable&&this.#V(this.#r,"display","none"),this.#Z(),this.#E||this.#$(this.#s,"blur")}#tt(t){return[...this.#y.options,...this.#f].find((e=>e.val===t))}#X(t){if(this.#Y(this.#a,""),this.#e=this.#t.parentElement,!t.length)return this.#e.style.removeProperty("min-height"),this.#y.selectedOptImage&&this.#V(this.#h,"display","block"),void this.#Y(this.#a,this.#y.placeholder);this.#y.selectedOptImage&&this.#V(this.#h,"display","none"),t.forEach(((t,e)=>{const s=this.#et("div");this.#st(s,"chip-wrp");const i=this.#y.customClasses?.["chip-wrp"];i&&this.#it(s,i);const n=this.#y.customAttributes?.["chip-wrp"];if(n&&this.#nt(s,n),"chip-wrp"in this.#y.attributes){const t=this.#y.attributes["chip-wrp"];this.#nt(s,t)}if(this.#y.selectedOptImage&&this.#y.optionIcon){const e=this.#et("img");if(this.#st(e,"chip-icn"),"chip-icn"in this.#y.attributes){const t=this.#y.attributes["chip-icn"];this.#nt(e,t)}const i=this.#tt(t);this.#lt(e,"src",i.icn||this.#m),this.#Q(e,i.icn),this.#lt(e,"alt",i.lbl);const n=this.#y.customClasses?.["chip-icn"];n&&this.#it(e,n);const l=this.#y.customAttributes?.["chip-icn"];l&&this.#nt(e,l),this.#H(s,e)}const l=this.#et("span");if(this.#st(l,"chip-lbl"),"chip-lbl"in this.#y.attributes){const t=this.#y.attributes["chip-lbl"];this.#nt(l,t)}const o=this.#y.customClasses?.["chip-lbl"];o&&this.#it(l,o);const h=this.#y.customAttributes?.["chip-lbl"];h&&this.#nt(l,h);const a=this.#tt(t);this.#Y(l,a?a.lbl:t),this.#H(s,l);const r=this.#et("button");if(this.#st(r,"chip-clear-btn"),"chip-clear-btn"in this.#y.attributes){const t=this.#y.attributes["chip-clear-btn"];this.#nt(r,t)}const p=this.#y.customClasses?.["chip-clear-btn"];p&&this.#it(r,p);const c=this.#y.customAttributes?.["chip-clear-btn"];c&&this.#nt(r,c),r.innerHTML=this.#r.innerHTML,this.#x(r,"click",(t=>{this.#ot(t,e)})),this.#x(r,"keyup",(t=>{"Backspace"===t.key&&this.#ot(t,e)})),this.#H(s,r),this.#H(this.#a,s)})),this.#e=this.#t.parentElement,this.#V(this.#e,"min-height",this.#t.offsetHeight-this.#n.offsetHeight+"px")}#ot(t,e){t.stopPropagation();const s=this.#g.split(this.#y.separator);s.splice(e,1),this.setSelectedOption(s.join(this.#y.separator)),this.#D()}#Q(t=null,e=0){e?this.#ht(t,"placeholder-img"):this.#st(t,"placeholder-img")}#Z(t=!1){if(t){const t=this.#g.split(this.#y.separator);this.#O=this.#O.map((e=>{const s=e;return e.disabled||t.includes(e.val)?s.disableOnMax=!1:s.disableOnMax=!0,s}))}else this.#O=this.#O.map((t=>{const e=t;return delete e.disableOnMax,e}));this.#D()}setSelectedOption(t){let e=null,s=t.split(this.#y.separator);s=s.filter((t=>this.#tt(t))),this.#y.multipleSelect?(1===s.length?e=this.#tt(s[0]):s.length>1&&(e={lbl:`${s.length} options selected`}),this.#y.disableOnMax&&this.#y.mx&&s.length>=this.#y.mx?this.#Z(!0):this.#Z(!1)):e=this.#tt(t),this.#g=t,this.#g||this.#J(),e&&(this.value=t,this.#y.selectedOptImage&&(this.#y.multipleSelect?s.length>1?(this.#h.src=this.#m,this.#Q(this.#h)):1===s.length?(this.#h.src=e.icn||this.#m,this.#Q(this.#h,e.icn)):(this.#h.src=this.#m,this.#Q(this.#h)):(this.#h.src=e.icn||this.#m,this.#Q(this.#h,e.icn))),this.#y.multipleSelect&&this.#y.showChip&&this.#X(s),this.#y.showChip||this.#Y(this.#a,e.lbl),this.#y.closeOnSelect&&this.setMenu({open:!1}),this.#y.selectedOptClearable&&(this.#V(this.#r,"display","grid"),this.#x(this.#r,"click",(t=>{this.#J(t)}))),this.#y.onChange&&this.#y.onChange(t),this.#E||this.#$(this.#s,"blur"))}#U(){return this.#O.findIndex((t=>t.val===this.#g))}#et(t){return this.#b.createElement(t)}#at(t,e){t.tabIndex=e}#st(t,e){t.classList.add(e)}#ht(t,e){t.classList.remove(e)}#_(t){return t?.style.display||""}#G(t,e){return t.classList.contains(e)}#Y(t,e){t.textContent=e}#V(t,e,s){t.style.setProperty(e,s,"important")}#rt(t){return t&&t.split(this.#y.separator)||[]}#pt(t){return t.join(this.#y.separator)}#ct(t){t.stopPropagation();const e=t.currentTarget,s=e.dataset.value;if(this.#c&&e.classList.contains("create-opt")&&this.#z(s),this.#y.multipleSelect){const t=this.#rt(this.#g);if(t.includes(s)){const i=t.indexOf(s);t.splice(i,1),this.#ht(e,"selected-opt")}else t.push(s),this.#st(e,"selected-opt");this.#g=this.#pt(t)}else{const t=this.#S(".selected-opt");t&&this.#ht(t,"selected-opt"),this.#st(e,"selected-opt"),this.#g=s}this.setSelectedOption(this.#g),setTimeout((()=>{this.#S(`${this.#j()} .option[data-value="${s}"]`).focus()}),0)}#D(){this.#dt()}#ut(){return this.#F(`${this.#j()} .option:not(.opt-group-title):not(.create-opt)`)}#B(){const t=this.#ut(),e=t.length;for(let s=0;s<e;s+=1){const e=t[s];this.#x(e,"click",(t=>{this.#ct(t)})),this.#x(e,"keyup",(t=>{"Enter"===t.key&&this.#ct(t)}))}}#mt(){const t=this.#ut(),e=this.#q(),s=t.length;for(let i=0;i<s;i+=1){const s=t[i];e?this.#at(s,0):this.#at(s,-1)}}#lt(t,e,s){t?.setAttribute?.(e,s)}#it(t,e){e.trim().split(/\b\s+\b/g).forEach((e=>this.#st(t,e)))}#nt(t,e){const s=e.length;if(s)for(let i=0;i<s;i+=1)this.#lt(t,e[i].key,e[i].value)}#dt(){this.#u.innerHTML="";const t=this.#g.split(this.#y.separator),e=this.#O.length;for(let s=0;s<e;s+=1){const e=this.#O[s],i=this.#et("li");if("not-found"===e.i)return this.#Y(i,e.lbl),this.#st(i,"opt-not-found"),void this.#H(this.#u,i);this.#st(i,"option");const n=this.#et("span");if(this.#st(n,"opt-lbl-wrp"),"opt-lbl-wrp"in this.#y.classNames){const t=this.#y.classNames["opt-lbl-wrp"];t&&this.#it(n,t)}if("opt-lbl-wrp"in this.#y.attributes){const t=this.#y.attributes["opt-lbl-wrp"];this.#nt(n,t)}if(this.#y.optionIcon){const t=this.#et("img");if(this.#st(t,"opt-icn"),"opt-icn"in this.#y.classNames){const e=this.#y.classNames["opt-icn"];e&&this.#it(t,e)}if("opt-icn"in this.#y.attributes){const e=this.#y.attributes["opt-icn"];this.#nt(t,e)}t.src=e.icn||this.#m,this.#Q(t,e.icn),t.alt=e.lbl,t.loading="lazy",n.append(t)}const l=this.#et("span");if(this.#st(l,"opt-lbl"),"opt-lbl"in this.#y.classNames){const t=this.#y.classNames["opt-lbl"];t&&this.#it(l,t)}if("opt-lbl"in this.#y.attributes){const t=this.#y.attributes["opt-lbl"];this.#nt(l,t)}this.#Y(l,e.lbl),n.append(l);const o=this.#et("span");if(this.#st(o,"opt-prefix"),"opt-prefix"in this.#y.classNames){const t=this.#y.classNames["opt-prefix"];t&&this.#it(o,t)}if("opt-prefix"in this.#y.attributes){const t=this.#y.attributes["opt-prefix"];this.#nt(l,t)}this.#Y(o,e.code),i.append(n,o),Object.keys(e.attributes).map((t=>{this.#lt(i,t,e.attributes[t])})),t.includes(e.val)?(this.#st(i,"selected-opt"),this.#lt(i,"aria-selected",!0)):this.#lt(i,"aria-selected",!1),"group"===e.type?this.#st(i,"opt-group-title"):("groupIndex"in e&&this.#st(i,"opt-group-child"),this.#lt(i,"data-index",s),this.#lt(i,"data-value",e.val),this.#lt(i,"role","option"),this.#lt(i,"aria-posinset",s+1),this.#lt(i,"aria-setsize",this.#O.length),this.#at(i,this.#q()?"0":"-1"),e.disabled?this.#st(i,"disabled-opt"):e.disableOnMax?this.#st(i,"disable-on-max"):(this.#x(i,"click",(t=>{this.#ct(t)})),this.#x(i,"keyup",(t=>{"Enter"===t.key&&this.#ct(t)})))),this.#H(this.#u,i)}}#W(t){if(t.stopPropagation(),"Enter"===t.key&&this.#O.length){const e=this.#O?.[0].i;if(e&&(this.setSelectedOption(e),this.searchOptions("")),this.#c&&"none"!==this.#_(this.#d)){const{value:e}=t.target;if(this.#z(e),this.#y.multipleSelect){const t=this.#rt(this.#g);t.push(e),this.#g=this.#pt(t)}else this.#g=e;this.#D(),this.setSelectedOption(this.#g)}}else this.searchOptions(t.target.value)}#z(t){let e=t.trim();if(e.includes&&e){const t=this.#f.length;for(let s=0;s<t;s+=1)if(this.#f[s].lbl.toLowerCase()===e){e="";break}if(e){const t={lbl:e,val:e,attributes:{}};this.#f.push(t),this.#O.push(t),this.searchOptions("")}}}searchOptions(t){this.#gt(t);let e=[],s=!1;if(t){const i=this.#y.options.length,n=[],l=t.toLowerCase();for(let t=0;t<i;t+=1){const i=this.#y.options[t];if("type"in i)continue;const o=i.lbl.toLowerCase();if(o.includes(l)){if("groupIndex"in i&&!n.includes(i.groupIndex)){const t=i.groupIndex;n.push(t),e.push(this.#y.options[t])}e.push(i),o===l&&(s=!0)}}const o=this.#f.length;for(let t=0;t<o;t+=1){const i=this.#f[t],n=i.lbl.toLowerCase();n.includes(l)&&(e.push(i),n===l&&(s=!0))}e.length||(e=[{i:"not-found",lbl:"No Option Found"}]),this.#O=this.#c?[this.#y.options[0]]:[],this.#O.push(...e),this.#y.searchClearable&&this.#V(this.#p,"display","grid")}else this.#O=this.#y.options,this.#y.searchClearable&&this.#V(this.#p,"display","none"),this.#c&&(this.#d=this.#S(`${this.#j()} .create-opt`),this.#V(this.#d,"display","none"),this.#O=this.#O.concat(this.#f));this.#D(),this.#d=this.#S(`${this.#j()} .create-opt`),s&&this.#c?this.#V(this.#d,"display","none"):this.#c&&t.trim()&&(this.#V(this.#d,"display","block"),this.#d.querySelector(".opt-lbl").innerText=`Create: ${t}`,this.#lt(this.#d,"data-value",t))}#gt(t){this.#i.value=t}#ft(t){this.#t.contains(t.target)||this.setMenu({open:!1})}#q(){return this.#G(this.#t,"menu-open")}#Ot(){const t=this.#l.getBoundingClientRect(),e=t.top,s=this.#C.innerHeight-t.bottom;s<e&&s<this.#y.maxHeight?(this.#V(this.#t,"flex-direction","column-reverse"),this.#V(this.#t,"bottom","0%")):(this.#V(this.#t,"flex-direction","column"),this.#V(this.#t,"bottom","auto"))}setMenu({open:t}){this.#V(this.#n,"max-height",`${t?this.#y.maxHeight:0}px`),t?(this.#Ot(),this.#st(this.#t,"menu-open"),this.#x(this.#b,"click",(t=>this.#ft(t))),this.#at(this.#i,0),this.#at(this.#p,0),this.#l.setAttribute("aria-expanded","true"),this.#lt(this.#u,"aria-hidden",!1),this.#lt(this.#i,"aria-hidden",!1),this.#D()):(this.#ht(this.#t,"menu-open"),this.#b.removeEventListener("click",this.#ft),setTimeout((()=>{this.searchOptions("")}),100),this.#at(this.#i,-1),this.#at(this.#p,-1),this.#l.setAttribute("aria-expanded","false"),this.#lt(this.#u,"aria-hidden",!0),this.#lt(this.#i,"aria-hidden",!0)),this.#mt()}#A(t){"Space"===t.code&&(this.#i.focus(),this.setMenu({open:!0})),"click"===t.type&&(this.#q()?this.setMenu({open:!1}):(this.#i.focus(),this.setMenu({open:!0})))}#L(t){t.target.parentElement?.contains(t.relatedTarget)||this.#$(this.#s,"blur")}set activelist(t){const e=this.#S(`.${this.fieldKey}-option-list[data-list="${t}"]`);if(e){const t=e.getAttribute("data-list-index");this.#y.activeList=t,this.setSelectedOption(""),this.#T()}}set disabled(t){"true"===String(t).toLowerCase()?(this.#t.classList.add("disabled"),this.#s.disabled=!0,this.#at(this.#l,-1),this.#at(this.#r,-1),this.#lt(this.#l,"aria-label","Dropdown disabled"),this.setMenu({open:!1})):"false"===String(t).toLowerCase()&&(this.#ht(this.#t,"disabled"),this.#s.removeAttribute("disabled"),this.#at(this.#l,0),this.#at(this.#r,0),this.#lt(this.#l,"aria-label",this.#y.placeholder))}get disabled(){return this.#s.disabled}set readonly(t){"true"===String(t).toLowerCase()?(this.#st(this.#t,"disabled"),this.#s.readOnly=!0,this.#at(this.#l,-1),this.#at(this.#r,-1),this.setMenu({open:!1})):"false"===String(t).toLowerCase()&&(this.#ht(this.#t,"disabled"),this.#s.removeAttribute("readonly"),this.#at(this.#l,0),this.#at(this.#r,0))}get readonly(){return this.#s.readOnly}set value(t){this.#s.value=t,this.#lt(this.#s,"value",t)}get value(){return this.#s.value}#bt(){this.#v.forEach((({selector:t,eventType:e,cb:s})=>{t.removeEventListener(e,s)}))}destroy(){this.value="",this.#bt()}reset(){this.#E=!0,this.#J(),this.destroy(),this.init(),setTimeout((()=>{this.#E=!1}),1)}}}();
