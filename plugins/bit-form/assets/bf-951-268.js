var Y=Object.defineProperty,Z=Object.defineProperties;var ee=Object.getOwnPropertyDescriptors;var D=Object.getOwnPropertySymbols;var se=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var P=(n,o,a)=>o in n?Y(n,o,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[o]=a,j=(n,o)=>{for(var a in o||(o={}))se.call(o,a)&&P(n,a,o[a]);if(D)for(var a of D(o))te.call(o,a)&&P(n,a,o[a]);return n},O=(n,o)=>Z(n,ee(o));import{r as u,bl as ae,w as W,j as e,g as M,u as C,v as oe,t as le,a as A,al as ie,c as v,_ as d,l as L,C as ne,eb as re,E as ce,H as de,as as y,S as me,d as ue,ba as he,b as be,ec as pe,bk as xe,$ as B,ed as fe,b4 as R,K as z,I as U,f as we,P as je,aO as ge,q as _e,s as F}from"./main-215.js";import{P as Te}from"./bf-788-79.js";import{u as H}from"./bf-458-78.js";import{A as Ee}from"./bf-906-373.js";import{L as ve}from"./bf-308-81.js";import{L as ye}from"./bf-319-376.js";import{t as Ce}from"./bf-190-87.js";import"./bf-678-82.js";import"./bf-985-112.js";import"./bf-851-85.js";import"./bf-175-84.js";const Ae=ae(()=>W(()=>import("./bf-355-379.js"),["./bf-355-379.js","./main-215.js","./main-215.css"],import.meta.url),{fallback:e.jsx("div",{children:"Loading..."})});function Ve(){const[n,o]=u.useState(!1),[a,m]=u.useState({show:!1}),[p,f]=M(pe),[t,g]=u.useState({show:!1,btnTxt:""}),c=C(xe),h=C(B),{formID:b,formType:r}=oe(),_=le(),{css:w}=A(),T=ie(fe);u.useEffect(()=>{T(),v({formID:b},"bitforms_get_views").then(s=>{if(s===void 0||!s.success)f([]),m({show:!0,msg:s.data});else if(s.success){const l=s.data.map(x=>O(j({},x),{shortcode:`[bitform-view id='${x.id}']`}));f(l)}})},[b]);const q=s=>e.jsxs("div",{style:{lineHeight:.7,fontWeight:500},children:[R(s,h.dateFormat),e.jsx("br",{}),e.jsx("br",{}),e.jsx("small",{children:R(s,h.timeFormat)})]}),V=()=>{var s;if(!z((s=h==null?void 0:h.proInfo)==null?void 0:s.installedVersion,"2.9.0")){m({show:!0,msg:"To use this feature you need Bit Form Pro(Version: 2.9.0)"});return}_(`/form/settings/${r}/${b}/data-views/new`)},[N,$]=u.useState([{width:250,minWidth:80,Header:d("View Name"),accessor:"table_name",Cell:s=>e.jsx(L,{to:`/form/settings/${r}/${b}/data-views/${s.row.original.id}`,type:"button",className:"btcd-tabl-lnk",children:s.row.original.table_name})},{width:220,minWidth:200,Header:d("Short Code"),accessor:"shortcode",Cell:s=>e.jsx(ne,{value:s.row.values.shortcode,className:`cpyTxt ${w({w:230})}`})},{width:160,minWidth:60,Header:d("Created"),accessor:"created_at",Cell:s=>q(s.row.original.created_at)}]);u.useEffect(()=>{const s=N.filter(l=>l.accessor!=="t_action");s.push({sticky:"right",width:100,minWidth:60,Header:"Actions",accessor:"t_action",Cell:l=>e.jsxs(re,{title:"Actions",w:165,h:107,children:[e.jsxs(L,{to:`/form/settings/${r}/${b}/data-views/${l.row.original.id}`,type:"button",className:"flx","aria-label":"actions",children:[e.jsx(ce,{size:18}),d("Edit Table")]}),e.jsxs("button",{type:"button",onClick:()=>Q(l.row.original.id,l.row.index),children:[e.jsx(de,{size:16}),"Â ",d("Delete")]})]})}),$([...s])},[c]);const K=u.useCallback(s=>{const l=[],x=[];for(let i=0;i<s.length;i+=1)l.push(s[i].id),x.push(s[i].original.id);const E=[...p],I=[...p];for(let i=l.length-1;i>=0;i-=1)I.splice(Number(l[i]),1);f(i=>y(i,{data:I,type:"set"})),v({tblId:x},"bitforms_bulk_table_delete_form").then(i=>{i===void 0||!i.success?f(X=>y(X,{data:E,type:"set"})):i.success&&m({show:!0,msg:i.data})})},[]),G=(s,l)=>{v({id:s},"bitforms_delete_atable").then(x=>{x.success&&(f(E=>y(E,{type:"remove",data:l})),m({show:!0,msg:d("Table Deleted Successfully")}))})},J=u.useCallback(s=>{$(s)},[]),k=()=>{t.show=!1,g(j({},t))},Q=(s,l)=>{t.action=()=>{G(s,l),k()},t.btnTxt=d("Delete"),t.btn2Txt=null,t.btnClass="",t.body=d("Are you sure to delete this table?"),t.show=!0,g(j({},t))};return e.jsxs("div",{id:"all-forms",children:[e.jsx(me,{snack:a,setSnackbar:m}),e.jsx(ue,{show:t.show,body:t.body,action:t.action,close:k,btnTxt:t.btnTxt,btn2Txt:t.btn2Txt,btn2Action:t.btn2Action,btnClass:t.btnClass}),p.length?e.jsx("div",{children:e.jsx(he,{className:"f-table btcd-all-frm",leftHeaderClasses:w($e.leftHeader),height:525,columns:N,data:p,rowSeletable:!0,newTableId:c,resizable:!0,setBulkDelete:K,setTableCols:J,centerHeader:e.jsx("h3",{children:"Data View List (Beta)"}),rightHeader:e.jsx("button",{onClick:()=>V(),type:"button","data-testid":"create-table-btn",className:`round btcd-btn-lg blue blue-sh ${w(be.btn)}`,children:d("Create View")})})}):e.jsx(Ae,{setModal:o,createNewView:V})]})}var Ne=u.memo(Ve);const $e={leftHeader:{width:"auto !important"}};function ke(){var b;const[n,o]=M(ge),a=C(B),{css:m}=A(),{userRoles:p,user:f}=a,t=Object.keys(p).map(r=>({label:p[r].name,value:r})),g=[{label:"All Logged In Users",value:"all_logged_in_users"},...t],{entryEditAccess:c}=n||{},h=(r,_)=>{U&&o(w=>we(w,T=>{je(T,r,_)}))};return e.jsxs("div",{children:[e.jsx("h3",{children:"Views And Edit Access (Beta)"}),!z((b=a==null?void 0:a.proInfo)==null?void 0:b.installedVersion,"2.9.0")&&e.jsxs("p",{children:[e.jsx("strong",{style:{color:"red"},children:" Note:"})," ","To use this feature you need Bit Form Pro(Version: 2.9.0)"," "]}),e.jsx(Ee,{customTitle:e.jsxs("span",{className:m({dy:"flex"}),children:[e.jsxs("b",{children:[e.jsx("span",{className:"mr-2",children:e.jsx(ye,{size:20})}),d("Allow Users to Edit Form Entries")]}),e.jsx(ve,j({},Ce.allowUserToEdit))]}),toggle:!0,action:r=>h("entryEditAccess->allowEntriesEdit",r.target.checked),checked:c==null?void 0:c.allowEntriesEdit,cls:"w-10 mt-3",isPro:!0,proProperty:"is_login",children:e.jsxs("div",{className:m({p:"5px 10px"}),children:[e.jsxs("div",{className:m(S.inputWrp),children:[e.jsx("span",{children:d("Allow Roles to edit won entries")}),e.jsx(H,{defaultValue:(c==null?void 0:c.allowEditOwnEntries)||[],className:"btcd-paper-drpdwn w-6",options:g,onChange:r=>h("entryEditAccess->allowEditOwnEntries",r)})]}),e.jsxs("div",{className:m(S.inputWrp),children:[e.jsx("span",{children:d("Allow Roles to edit Other's entries")}),e.jsx(H,{defaultValue:(c==null?void 0:c.allowEditOtherEntries)||[],className:"btcd-paper-drpdwn w-6",options:t,onChange:r=>h("entryEditAccess->allowEditOtherEntries",r)})]})]})})]})}const S={inputWrp:{dy:"flex",jc:"space-between",ai:"center",mb:10}};function Ie(){const{css:n}=A();return e.jsxs("div",{className:n({pr:75}),children:[!U&&e.jsx(Te,{style:{height:"90%",left:"30px",width:"95%","margin-top":"40px"}}),e.jsx(ke,{}),e.jsx("hr",{}),e.jsx(Ne,{})]})}const De=u.lazy(()=>W(()=>import("./bf-547-380.js"),["./bf-547-380.js","./main-215.js","./main-215.css","./bf-458-78.js","./bf-438-405.css","./bf-613-69.js","./bf-262-111.js","./bf-945-171.js","./bf-985-112.js","./bf-912-113.js","./bf-836-404.css","./bf-687-283.js","./bf-251-320.js","./bf-345-251.js","./bf-678-82.js","./bf-175-84.js","./bf-851-85.js","./bf-746-378.js","./bf-780-250.js","./bf-60-249.js","./bf-761-406.css","./bf-337-253.js","./bf-828-252.js","./bf-868-83.js","./bf-188-289.js","./bf-325-377.js","./bf-453-290.js","./bf-658-77.js","./bf-61-374.js","./bf-439-408.css","./bf-955-244.js","./bf-804-184.js","./bf-984-322.js","./bf-605-277.js","./bf-314-278.js","./bf-788-79.js","./bf-6-248.js"],import.meta.url));function Ke(){return e.jsxs(_e,{children:[e.jsx(F,{index:!0,element:e.jsx(Ie,{})}),e.jsx(F,{path:"/:viewId",element:e.jsx(De,{})})]})}export{Ke as default};
