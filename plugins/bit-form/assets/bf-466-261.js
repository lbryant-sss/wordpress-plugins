var Ye=Object.defineProperty,Ze=Object.defineProperties;var Ve=Object.getOwnPropertyDescriptors;var Be=Object.getOwnPropertySymbols;var Ke=Object.prototype.hasOwnProperty,Le=Object.prototype.propertyIsEnumerable;var Ee=(s,t,o)=>t in s?Ye(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o,F=(s,t)=>{for(var o in t||(t={}))Ke.call(t,o)&&Ee(s,o,t[o]);if(Be)for(var o of Be(t))Le.call(t,o)&&Ee(s,o,t[o]);return s},W=(s,t)=>Ze(s,Ve(t));import{a as Y,r as ye,j as e,i as le,u as X,aq as J,h as H,T as Ne,_ as i,aQ as Z,aO as Ge,aP as Ie,K as et,aK as V,$ as Je,bp as tt,f as B,af as je,aF as ge,bo as st,db as lt,bw as ot,ap as at,I as be,ao as Ce,X as Ae,bm as R,aR as it,aT as We,e6 as nt,e5 as ct,d as He,A as rt,O as dt,c as mt,V as pt}from"./main-216.js";import{S as ht,a as ut,D as ft,b as xt}from"./bf-393-254.js";import{S as bt}from"./bf-660-326.js";import{o as ne,M as re,D as we,q as ke}from"./bf-522-70.js";import{t as Me}from"./bf-822-82.js";import{A as kt}from"./bf-368-83.js";import{g as q,e as ae,i as Te,u as Fe,h as Pe,P as vt}from"./bf-869-79.js";import{C as jt}from"./bf-322-86.js";import{C as G}from"./bf-137-105.js";import{C as Qe}from"./bf-360-373.js";import{M as $e}from"./bf-417-113.js";import"./bf-262-88.js";function De({title:s,titleOutline:t,accordionActions:o,children:n}){const{css:d}=Y(),[c,N]=ye.useState(!0),C=()=>{N(j=>!j)};return e.jsxs("div",{className:d(L.section),children:[e.jsxs("div",{className:`${d(L.titleWrp)}`,children:[e.jsxs("button",{type:"button",className:`${d(L.title,t?L.titleOutline:{})} btcd-logic-blk`,onClick:C,children:[s,e.jsx("span",{className:d(L.titleIcn),children:e.jsx(jt,{size:15,rotate:!c})})]}),e.jsx("div",{className:`${d(L.accrActions)} accr-actions`,children:o})]}),c&&e.jsx("div",{className:d(L.content),children:n}),!c&&e.jsx("div",{className:d(L.content),children:e.jsxs("button",{className:d(L.collapsedAccrdn),type:"button",onClick:C,children:[e.jsx("span",{className:d(L.collapsedCrl)}),e.jsx("span",{className:d(L.collapsedCrl)}),e.jsx("span",{className:d(L.collapsedCrl)})]})})]})}const L={section:{pb:12},accrActions:{dy:"none"},titleWrp:{flx:1,":hover .accr-actions":{flx:1}},title:{bc:"var(--b-50)",h:35,fs:14,p:"0 15px",brs:30,cr:"#fff",fw:600,lh:"29px",cur:"pointer",us:"none",b:0,oe:0,flx:"center"},titleOutline:{b:"2px solid var(--b-50)",bc:"#fff",cr:"var(--b-50)",p:"0 13px"},titleIcn:{ml:8,flx:"center"},content:{my:5,ml:45},collapsedAccrdn:{b:0,oe:0,bc:"#D9D9D9",w:65,brs:10,h:20,flx:"center",rg:5,cg:5,curp:1,mt:15,":focus":{oe:"none"}},collapsedCrl:{dy:"inline-block",w:5,h:5,bc:"#AAAAAA",brs:"50%"}};function Re({lgcGrpInd:s,condGrpInd:t,actionKey:o,enableAction:n,checkKeyInArr:d,getValueFromArr:c,title:N}){const{css:C}=Y(),[j,b]=le(Z),l=X(Ge),r=X(Ie),m=X(et),f=J(V),w=X(Je),v=()=>{const p=[];return m.map(S=>{tt.includes(S.type)&&p.push({label:S.name,value:S.key})}),p},O=()=>m.filter(p=>p.type==="email").length>0,k=()=>{const p=[];if(O()){const S=[];m.map(a=>{a.type==="email"&&S.push({label:a.name,value:`\${${a.key}}`})}),p.push({title:"Form Fields",type:"group",childs:S})}return w.userMail&&Array.isArray(w.userMail)&&p.push({title:"WP Emails",type:"group",childs:w.userMail}),p},A=(p,S)=>{const a=B(j,h=>{const{success:x}=h[s].conditions[t].actions,g=x.find($=>$.type===o);g&&(g.details[p]=S)});b(a),f(h=>W(F({},h),{unsaved:!0}))};return e.jsxs("div",{className:C(H.mt2),children:[e.jsx(Ne,{onChange:p=>n(p.target.checked,o),title:N,checked:d(o),className:C(H.flxc)}),d(o)&&e.jsxs("div",{className:C({mt:5,ml:28}),children:[e.jsx("label",{className:"f-m f-5",children:i("Email Template:")}),e.jsx("div",{className:"mt-1"}),e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:p=>A("id",p.target.value),value:c(o,"id"),children:[e.jsx("option",{value:"",children:i("Select Email Template")}),l==null?void 0:l.map((p,S)=>e.jsx("option",{value:p.id?JSON.stringify({id:String(p.id)}):JSON.stringify({index:String(S)}),children:p.title},`sem-${S+2.3}`))]}),e.jsx(ne,{action:p=>A("to",p?p.split(","):[]),value:c(o,"to"),placeholder:i("Add Email Receiver"),title:e.jsx("span",{className:"f-m f-5",children:i("To")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:k(c(o,"to"))}),e.jsx(ne,{action:p=>A("from",p),placeholder:i("Add mail from address"),value:c(o,"from"),title:e.jsx("span",{className:"f-m f-5",children:i("From Mail")}),titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:k(c(o,"from")),tip:i('Some servers block emails if "From Email" differs from the authenticated (login) emailâ€” use the same email to ensure delivery.')}),e.jsx("div",{className:"mt-1"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"from_name",className:"f-m f-5",children:i("From Name")}),e.jsx("div",{className:"mt-2"}),e.jsx("input",{id:"from_name",type:"text",className:"btcd-paper-inp",style:{height:"35px",width:"69%",background:"var(--b-79-96)"},value:c(o,"from_name"),onChange:p=>A("from_name",p.target.value),placeholder:"Add mail from name"})]}),e.jsx(ne,{action:p=>A("cc",p?p.split(","):[]),value:c(o,"cc"),placeholder:i("Add Email CC"),title:e.jsx("span",{className:"f-m f-5",children:i("CC")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:k(c(o,"cc"))}),e.jsx(ne,{action:p=>A("bcc",p?p.split(","):[]),placeholder:i("Add Email BCC"),value:c(o,"bcc"),title:e.jsx("span",{className:"f-m f-5",children:i("BCC")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:k(c(o,"bcc"))}),e.jsx(ne,{action:p=>A("replyto",p?p.split(","):[]),placeholder:i("Reply To"),value:c(o,"replyto"),title:e.jsx("span",{className:"f-m f-5",children:i("Reply To")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:k(c(o,"replyto"))}),e.jsx(ne,{action:p=>A("attachment",p?p.split(","):[]),placeholder:i("Attachment"),value:c(o,"attachment"),title:e.jsx("span",{className:"f-m f-5",children:i("Attachment")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",options:v()}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"pdf-template",className:"f-m f-5",children:i("PDF Attachment Template:")}),e.jsx("div",{className:"mt-1"}),e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:p=>A("pdfId",p.target.value),value:c(o,"pdfId"),children:[e.jsx("option",{value:"",children:i("Select PDF Template")}),r==null?void 0:r.map((p,S)=>e.jsx("option",{value:p.id?JSON.stringify({id:String(p.id)}):JSON.stringify({index:String(S)}),children:p.title},`sem-${S+2.3}`))]})]})]})]})}const wt=["text","username","number","email","password","tel","url","search","select","textarea","html-select","currency","phone-number"],yt=(s,t="")=>{if(t==="")return s;const o=t.split("."),n=o.length-1;return o.slice(0,n).forEach(c=>{s=s[c]}),o.length?s[o[n]]:s},Nt=[{key:"_bf_form",name:"Form"},{key:"_bf_step_no",name:"Step No."}],Xe=s=>{const t=[];return s.forEach(o=>{typeof o=="object"&&!Array.isArray(o)?t.push(o):Array.isArray(o)&&t.push(...Xe(o))}),t},gt=()=>{const s=je(ot),t=Array.isArray(s)&&s.length>1,o=je(at),n=t?o.multiStepSettings.btnSettings:{},{show:d,prevBtn:c,nextBtn:N}=n;return d?{[c.key]:F({},c),[N.key]:F({},N)}:{}},ve=s=>{var l;const t=je(ge),o=F(F({},t),gt()),n=je(st),d=lt(o,[]),c=Xe(s.logics||[]),N=((l=s==null?void 0:s.actions)==null?void 0:l.fields)||[],C=[...c,...N].map(r=>r.field).filter(r=>r),j=d.filter(r=>r.type==="repeater").map(r=>r.key);let b="";if(j.forEach(r=>{n[r].lg.map(v=>v.i).some(v=>C.includes(v))&&(b=r)}),b){j.splice(j.indexOf(b),1);const r=j.reduce((m,f)=>{const v=n[f].lg.map(O=>O.i);return[...m,...v]},[]);return d.filter(m=>!r.includes(m.key)&&!j.includes(m.key))}return d};function Ct({action:s,lgcGrp:t,lgcGrpInd:o,actionInd:n,condGrpInd:d,actionType:c,formFields:N}){var z,U,de,me,pe,he,ue;const C=J(Z),j=X(ge),b=J(V),{css:l}=Y();let r="",m="";N!==null&&N.map(T=>{T.key===s.field&&(m=T.type,r=T.key)});const f=()=>{var u,P,D,I,K,ee,Q,ie;if(m==="razorpay")return;let T;if(T=(P=(u=j==null?void 0:j[r])==null?void 0:u.opt)==null?void 0:P.map(M=>({label:M.lbl,value:M.val||M.lbl})),m==="select"){const{optionsList:M}=(j==null?void 0:j[r])||{};if(s.action==="value")return M.reduce((E,oe)=>{const te=Object.keys(oe)[0],fe=Object.values(oe)[0];return E.push({type:"group",title:te,childs:fe.map(xe=>({label:xe.lbl,value:xe.val||xe.lbl}))}),E},[]);if(s.action==="activelist")return M.reduce((E,oe)=>{const te=Object.keys(oe)[0];return E.push({label:te,value:te}),E},[])}if(["decision-box","gdpr"].includes(m)){const M=j==null?void 0:j[r];return[{label:(D=M==null?void 0:M.msg)==null?void 0:D.checked,value:(I=M==null?void 0:M.msg)==null?void 0:I.checked},{label:(K=M==null?void 0:M.msg)==null?void 0:K.unchecked,value:(ee=M==null?void 0:M.msg)==null?void 0:ee.unchecked}]}return T||(T=(ie=(Q=j==null?void 0:j[r])==null?void 0:Q.options)==null?void 0:ie.map(M=>({label:M.lbl,value:M.val||M.code||M.i||M.lbl}))),T},w=T=>{C(u=>B(u,P=>{const{fields:D}=P[o].conditions[d].actions;D[n].action=T})),b(u=>W(F({},u),{unsaved:!0}))},v=T=>{C(u=>B(u,P=>{const{fields:D}=P[o].conditions[d].actions;D[n].val=T})),b(u=>W(F({},u),{unsaved:!0}))},O=T=>{C(u=>B(u,P=>{const{fields:D}=P[o].conditions[d].actions;D[n].field=T,typeof D[n].val=="undefined"&&(D[n].val="")})),b(u=>W(F({},u),{unsaved:!0}))},k=()=>{C(T=>B(T,u=>{const{fields:P}=u[o].conditions[d].actions;P.length>1&&P.splice(n,1)})),b(T=>W(F({},T),{unsaved:!0}))},A=()=>{C(T=>B(T,u=>{const{fields:P}=u[o].conditions[d].actions,D=F({},P[n]);P.splice(n+1,0,D)})),b(T=>W(F({},T),{unsaved:!0}))},p=((z=j[s.field])==null?void 0:z.typ)||"",S=((U=j[s.field])==null?void 0:U.typ)!=="file-up"&&((de=j[s.field])==null?void 0:de.typ)!=="advanced-file-up",a=((me=j[s.field])==null?void 0:me.typ)!=="button",h=((pe=j[s.field])==null?void 0:pe.typ)==="title",x=c!=="onsubmit",g=c!=="onvalidate",$=["decision-box","gdpr"].includes((he=j[s.field])==null?void 0:he.typ),y=wt.includes((ue=j[s.field])==null?void 0:ue.typ),_=s.field==="_bf_form";return e.jsxs("div",{className:"flx pos-rel btcd-logic-blk",children:[e.jsxs(re,{label:"Form Fields",value:s.field||"",onChange:T=>O(T.target.value),style:{width:720},children:[e.jsx("option",{value:"",children:i("Select One")}),N.map(T=>e.jsx("option",{value:T.key,children:T.name},`ff-Ab-${T.key}`)),Nt.map(T=>e.jsx("option",{value:T.key,children:T.name},`ff-Ab-${T.key}`))]}),e.jsx("div",{className:l({w:100,flx:"align-center",h:35,mt:5}),children:e.jsx("div",{className:l({w:"100%",bd:"#b9c5ff",h:"0.5px"})})}),e.jsxs(re,{label:"Action",onChange:T=>w(T.target.value),value:s.action||"",style:{width:400},className:"w-4",children:[e.jsx("option",{value:"",children:i("Select One")}),_&&e.jsx("option",W(F({value:"save_draft"},!be&&{disabled:!0}),{children:i(`Save Draft ${be?"":"(PRO)"}`)})),!_&&e.jsxs(e.Fragment,{children:[!a&&t.action_type==="oninput"&&e.jsx("option",{value:"click",children:i("Click")}),S&&a&&g&&e.jsx("option",{value:"value",children:i("Value")}),x&&g&&e.jsx("option",{value:"enable",children:i("Enable")}),x&&g&&e.jsx("option",{value:"disable",children:i("Disable")}),x&&g&&S&&a&&e.jsx("option",{value:"readonly",children:i("Readonly")}),x&&g&&S&&a&&e.jsx("option",{value:"writeable",children:i("Writeable")}),x&&g&&e.jsx("option",{value:"hide",children:i("Hide")}),x&&g&&e.jsx("option",{value:"show",children:i("Show")}),c==="onvalidate"&&e.jsx("option",{value:"required",children:i("Required")}),c==="onvalidate"&&e.jsx("option",{value:"notrequired",children:i("Not Required")}),p==="select"&&e.jsx("option",{value:"activelist",children:i("Active List")}),x&&g&&S&&a&&e.jsx("option",{value:$?"ct":"lbl",children:i("Label")}),x&&g&&S&&a&&e.jsx("option",{value:"sub-titl",children:i("Sub Title")}),y&&e.jsx("option",{value:"placeholder",children:i("Placeholder")}),x&&g&&S&&a&&!h&&e.jsx("option",{value:"hlp-txt",children:i("Helper Text")}),h&&e.jsx("option",{value:"title",children:i("Title")})]})]}),["value","activelist","lbl","ct","sub-titl","hlp-txt","title","placeholder"].includes(s.action)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:l({w:100,flx:"align-center",h:35,mt:5}),children:e.jsx("div",{className:l({w:"100%",bd:"#b9c5ff",h:"0.5px"})})}),e.jsx(Qe,{label:"Value",type:m.match(/select|check|radio|number|range|hidden/g)?"text":m,onChange:v,value:s.val||"",options:f(),formFields:N})]}),e.jsxs("div",{className:"btcd-li-side-btn",children:[e.jsx(q,{onClick:A,icn:!0,className:"ml-2 sh-sm white",children:e.jsx(Ce,{})}),e.jsx(q,{onClick:k,icn:!0,className:"ml-2 sh-sm white",children:e.jsx(Ae,{})})]})]})}function At({lgcGrp:s,lgcGrpInd:t,condGrp:o,condGrpInd:n}){const{css:d}=Y(),[c,N]=le(Z),C=J(V),{fields:j}=o.actions,b=()=>{const l=B(c,r=>{const{fields:m}=r[t].conditions[n].actions;let f="disable";r[t].action_type==="onsubmit"&&(f="value"),m.push({field:"",action:f})});N(l),C(r=>W(F({},r),{unsaved:!0}))};return e.jsxs("div",{className:d(H.mt2),children:[e.jsx("div",{className:d(_t.title),children:e.jsx("b",{className:"txt-dp",children:"Field Actions"})}),j.map((l,r)=>e.jsx("div",{className:`mt-2 ${o.cond_type==="always"&&"ml-4"}`,children:e.jsx(Ct,{lgcGrp:s,lgcGrpInd:t,condGrpInd:n,action:l,actionInd:r,actionType:s.action_type,formFields:ve(o)})},`atn-${r+22}`)),e.jsx(ae,{msg:"Add More",children:e.jsx(q,{onClick:()=>b(),icn:!0,className:`blue sh-sm mt-2 ${o.cond_type==="always"&&"ml-4"}`,children:e.jsx(R,{size:"14",className:"icn-rotate-45"})})})]})}const _t={title:{mb:7},chip:{mnh:30,dy:"flex !important",ai:"center",w:60,mt:9,mb:9}};function Ft({lgcGrpInd:s,condGrpInd:t,enableAction:o,checkKeyInArr:n,getValueFromArr:d}){const{css:c}=Y(),[N,C]=le(Z),j=J(V),b=X(it),l=r=>{const m=B(N,f=>{const{success:w}=f[s].conditions[t].actions,v=w.find(O=>O.type==="integ");v&&(v.details.id=r.map(O=>O.value))});C(m),j(f=>W(F({},f),{unsaved:!0}))};return e.jsxs("div",{className:c(H.mt2),children:[e.jsx(Ne,{onChange:r=>o(r.target.checked,"integ"),title:i("Integration"),checked:n("integ"),className:c(H.flxc)}),n("integ")&&e.jsx(ne,{action:r=>l(r),jsonValue:!0,value:d("integ","id"),titleClassName:c({mt:5,ml:28,w:"67.5%"}),className:"w-10",isMultiple:be,options:b==null?void 0:b.map((r,m)=>({label:r.name,value:r.id?JSON.stringify({id:String(r.id)}):JSON.stringify({index:String(m)})})),placeholder:i("Select Integation")})]})}function $t({lgcGrpInd:s,condGrpInd:t,enableAction:o,checkKeyInArr:n,getValueFromArr:d}){var r,m;const{css:c}=Y(),[N,C]=le(Z),j=J(V),b=X(We),l=f=>{const w=B(N,v=>{const{success:O}=v[s].conditions[t].actions,k=O.find(A=>A.type==="redirectPage");k&&(k.details.id=f)});C(w),j(v=>W(F({},v),{unsaved:!0}))};return e.jsxs("div",{className:c(H.mt2),children:[e.jsx(Ne,{onChange:f=>o(f.target.checked,"redirectPage"),title:i("Redirect URL"),checked:n("redirectPage"),className:c(H.flxc)}),n("redirectPage")&&e.jsx("div",{className:c({mt:5,ml:28}),children:e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:f=>l(f.target.value),value:d("redirectPage","id"),children:[e.jsx("option",{value:"",children:i("Select Page To Redirect")}),(m=(r=b==null?void 0:b.type)==null?void 0:r.redirectPage)==null?void 0:m.map((f,w)=>e.jsx("option",{value:f.id?JSON.stringify({id:String(f.id)}):JSON.stringify({index:String(w)}),children:f.title},`sr-${w+2.5}`))]})})]})}function St({lgcGrpInd:s,condGrpInd:t,enableAction:o,checkKeyInArr:n,getValueFromArr:d}){var r,m;const{css:c}=Y(),[N,C]=le(Z),j=J(V),b=X(We),l=f=>{const w=B(N,v=>{const{success:O}=v[s].conditions[t].actions,k=O.find(A=>A.type==="successMsg");k&&(k.details.id=f)});C(w),j(v=>W(F({},v),{unsaved:!0}))};return e.jsxs("div",{className:c(H.mt2),children:[e.jsx(Ne,{onChange:f=>o(f.target.checked,"successMsg"),title:i("Success Message"),checked:n("successMsg"),className:c(H.flxc)}),n("successMsg")&&e.jsx("div",{className:c({mt:5,ml:28}),children:e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:f=>l(f.target.value),value:d("successMsg","id"),children:[e.jsx("option",{value:"",children:i("Select Message")}),(m=(r=b==null?void 0:b.type)==null?void 0:r.successMsg)==null?void 0:m.map((f,w)=>e.jsx("option",{value:f.id?JSON.stringify({id:String(f.id)}):JSON.stringify({index:String(w)}),children:f.title},`sm-${w+2.3}`))]})})]})}function Ot({lgcGrpInd:s,condGrp:t,condGrpInd:o}){var b,l;const[n,d]=le(Z),c=J(V),N=X(We),{failure:C}=t.actions,j=r=>{const m=B(n,f=>{f[s].conditions[o].actions.failure=r});d(m),c(f=>W(F({},f),{unsaved:!0}))};return e.jsxs(re,{onChange:r=>j(r.target.value),value:C,label:"Error Message",className:"w-7 mt-3",children:[e.jsx("option",{value:"",children:i("Select Message")}),(l=(b=N==null?void 0:N.type)==null?void 0:b.successMsg)==null?void 0:l.map((r,m)=>e.jsx("option",{value:r.id?JSON.stringify({id:String(r.id)}):JSON.stringify({index:String(m)}),children:r.title},`vm-${m+2.7}`))]})}function ze({lgcGrp:s,lgcGrpInd:t,condGrp:o,condGrpInd:n}){const{css:d}=Y(),[c,N]=le(Z),C=J(V),{success:j}=o.actions,b=(f,w)=>{const v=B(c,O=>{const{success:k}=O[t].conditions[n].actions;if(f)w==="mailNotify"?k.push({type:w,details:{}}):w==="dblOptin"?k.push({type:w,details:{}}):k.push({type:w,details:{id:""}});else for(let A=0;A<k.length;A+=1)if(k[A].type===w){k.splice(A,1);break}});N(v),C(O=>W(F({},O),{unsaved:!0}))},l=f=>j==null?void 0:j.some(w=>w.type===f),r=f=>{const w=B(c,v=>{const{actions:O}=v[t].conditions[n];O.avoid_delete=f});N(w),C(v=>W(F({},v),{unsaved:!0}))},m=(f,w)=>{const v=j.find(O=>O.type===f);return v!==void 0?v.details[w]:""};return e.jsxs(e.Fragment,{children:[s.action_type!=="onvalidate"&&s.action_run!=="delete"&&e.jsx(At,{lgcGrp:s,lgcGrpInd:t,condGrp:o,condGrpInd:n}),(s.action_type==="onsubmit"||s.action_run==="delete")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:d(H.mt3,H.mb1),children:e.jsx("b",{className:"txt-dp",children:"Additional Actions"})}),e.jsxs("div",{className:o.cond_type==="always"?"ml-4":"",children:[s.action_run!=="delete"&&e.jsx(St,{lgcGrpInd:t,condGrpInd:n,enableAction:b,checkKeyInArr:l,getValueFromArr:m}),!s.action_run.match(/^(delete|edit)$/)&&e.jsx($t,{lgcGrpInd:t,condGrpInd:n,enableAction:b,checkKeyInArr:l,getValueFromArr:m}),s.action_run!=="delete"&&e.jsx(Ft,{lgcGrpInd:t,condGrpInd:n,enableAction:b,checkKeyInArr:l,getValueFromArr:m}),e.jsx(Re,{title:i("Email Notification"),lgcGrpInd:t,condGrpInd:n,actionKey:"mailNotify",enableAction:b,checkKeyInArr:l,getValueFromArr:m}),e.jsx(Re,{title:i("Double Opt-in"),lgcGrpInd:t,condGrpInd:n,actionKey:"dblOptin",enableAction:b,checkKeyInArr:l,getValueFromArr:m})]})]}),s.action_run==="delete"&&e.jsx(G,{className:d({mt:5,ml:o.cond_type==="always"?12:-8}),onChange:f=>r(f.target.checked),checked:c[t].avoid_delete,title:e.jsx("small",{className:"txt-dp",children:"Prevent Delete"})}),s.action_type==="onvalidate"&&s.action_run!=="delete"&&e.jsx(Ot,{lgcGrpInd:t,condGrp:o,condGrpInd:n})]})}const Tt={change:{label:i("Change"),notFields:["button","user"]},equal:{label:i("Equal"),notFields:["button","repeater"]},not_equal:{label:i("Not Equal"),notFields:["button","user","repeater"]},null:{label:i("Is Null"),notFields:["button","user","repeater"]},not_null:{label:i("Is Not Null"),notFields:["button","user","repeater"]},contain:{label:i("Contain"),notFields:["button","date","time","datetime-local","month","week","user","repeater"]},contain_all:{label:i("Contain All"),fields:["select"]},not_contain:{label:i("Not Contain"),notFields:["button","date","time","datetime-local","month","week","user","repeater"]},greater:{label:i("Greater Than"),fields:["number","date","time","datetime-local"]},less:{label:i("Less Than"),fields:["number","date","time","datetime-local"]},greater_or_equal:{label:i("Greater Than or Equal"),fields:["number","date","time","datetime-local"]},less_or_equal:{label:i("Less Than or Equal"),fields:["number","date","time","datetime-local"]},start_with:{label:i("Start With"),notFields:["button","color","url","password","email","date","time","datetime-local","month","week","user","repeater"]},end_with:{label:i("End With"),notFields:["button","color","url","password","email","date","time","datetime-local","month","week","user","repeater"]},between:{label:i("Between"),fields:["number","date","time","datetime-local"]},on_click:{label:i("On Click"),fields:["button.btnTyp:button","button.btnTyp:next-step","button.btnTyp:previuos-step"]}};function Se({logic:s,fieldVal:t,delLogic:o,lgcInd:n,subLgcInd:d,subSubLgcInd:c,value:N,addInlineLogic:C,cloneInLineLogic:j,changeLogic:b,logicValue:l,changeValue:r,changeSmartKey:m,changeFormField:f,smartTagAllowed:w,formFields:v}){var U,de,me,pe,he,ue,T;const{css:O}=Y(),k=X(ge);let A=!1,p="",S="",a="";(U=v==null?void 0:v.find)==null||U.call(v,u=>{if(u.key===t)return u.type.match(/^(check|radio|select|html-select|image-select|hidden)$/)?p="text":p=u.type,S=u.type,a=u.key,!0});const h=[{label:i("Logged In"),value:"logged_in"},{label:i("Logged Out"),value:"logged_out"}],x=()=>{var P,D,I,K,ee,Q,ie,M;if(S==="razorpay")return;let u;if(S==="user"?u=h:u=(D=(P=k==null?void 0:k[a])==null?void 0:P.opt)==null?void 0:D.map(E=>({label:E.lbl,value:E.val||E.lbl})),S==="select"){const{optionsList:E}=(k==null?void 0:k[a])||{};return E.reduce((oe,te)=>{const fe=Object.keys(te)[0],xe=Object.values(te)[0];return oe.push({type:"group",title:fe,childs:xe.map(_e=>({label:_e.lbl,value:_e.val||_e.lbl}))}),oe},[])}if(["decision-box","gdpr"].includes(p)){const E=k==null?void 0:k[a];return[{label:(I=E==null?void 0:E.msg)==null?void 0:I.checked,value:(K=E==null?void 0:E.msg)==null?void 0:K.checked},{label:(ee=E==null?void 0:E.msg)==null?void 0:ee.unchecked,value:(Q=E==null?void 0:E.msg)==null?void 0:Q.unchecked}]}return u||(u=(M=(ie=k==null?void 0:k[a])==null?void 0:ie.options)==null?void 0:M.map(E=>({label:E.lbl,value:E.val||E.code||E.i||E.lbl}))),u},g=(u,P)=>P.find(D=>{if(D===u)return!0;if(!D.includes("."))return!1;const I=D.indexOf("."),K=D.substring(0,I);if(u!==K)return!1;const ee=D.substring(I+1);if(!ee)return!1;const[Q,ie]=ee.split(":"),M=Q.split("."),E=v.find(te=>te.key===a)||{};return M.reduce((te,fe)=>te[fe],E)===ie}),$=u=>Te.find(P=>u===`\${${P.name}}`);p||(p=((de=$(t))==null?void 0:de.type)||""),A||(A=((me=$(t))==null?void 0:me.singleSelect)||!1);const y=u=>{var I;const P=((I=$(t))==null?void 0:I.type)||u;return P?Object.entries(Tt).reduce((K,[ee,Q])=>Q.notFields&&g(P,Q.notFields)?K:Q.fields?g(P,Q.fields)?[...K,{key:ee,lbl:Q.label}]:K:[...K,{key:ee,lbl:Q.label}],[]):[]},_=u=>u==="${_bf_custom_date_format()}"?i("Date Format"):u==="${_bf_user_meta_key()}"?i("Meta Key"):u==="${_bf_query_param()}"?i("Query Param"):"Smart Key",z=["change","null","not_null","on_click"];return e.jsxs("div",{className:`${O(Ue.lgcBlk)} btcd-logic-blk`,children:[e.jsxs("div",{className:O(Ue.processDgrm),children:[e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Form Fields",value:t,onChange:u=>f(u.target.value,n,d,c),children:[e.jsx("option",{value:"",children:i("Select Form Field")}),!!v.length&&e.jsx("optgroup",{label:"Form Fields",children:v.map(u=>!nt.includes(u.type)&&e.jsx("option",{value:u.key,children:u.name},`ff-lb-${u.key}`))}),w&&e.jsx("optgroup",{label:`General Smart Codes ${be?"":"(PRO)"}`,children:(pe=Te)==null?void 0:pe.map(({name:u,label:P})=>e.jsx("option",{value:`\${${u}}`,disabled:!be,children:P},`ff-rm-${u}`))})]})})}),((he=$(t))==null?void 0:he.functionParam)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Field Parameter",onChange:u=>m(u.target.value,n,d,c),value:s.smartKey||"",children:[e.jsx("option",{value:"",children:i("Select Form Field")}),!!v.length&&e.jsx("optgroup",{label:"Form Fields",children:v.map(u=>!u.type.match(/^(file-up|recaptcha)$/)&&e.jsx("option",{value:u.key,children:u.name},`ff-lb-${u.key}`))})]})})}),((ue=$(t))==null?void 0:ue.custom)&&!((T=$(t))!=null&&T.functionParam)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsx($e,{label:_(t),type:"text",onChange:u=>m(u.target.value,n,d,c),value:s.smartKey||""})})}),e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Logic",value:l,onChange:u=>b(u.target.value,n,d,c),children:[e.jsx("option",{value:"",children:i("Select One")}),y(p).map(({key:u,lbl:P})=>e.jsx("option",{value:u,children:P},u))]})})}),l!=="between"&&l!=="not between"&&!z.includes(l)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:p.match(/user|select|check|radio/g)?e.jsx(Fe,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:N||"",onChange:u=>r(u,n,d,c),options:x(),fldType:p,singleSelect:A}):e.jsx(Qe,{label:"Value",type:p.match(/select|check|radio|number|range/g)?"text":p,disabled:l==="null"||l==="not_null",onChange:u=>r(u,n,d,c),value:N||"",options:x(),formFields:v})})}),(l==="between"||l==="not between")&&e.jsx("div",{className:"block-wrapper",children:e.jsxs("div",{className:"block-group",children:[e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:S.match(/select|check|radio/g)?e.jsx(Fe,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:N.min||"",onChange:u=>r(u,n,d,c,"min"),options:x(),customValue:!0,fldType:S}):e.jsx($e,{label:"Min Value",type:p,disabled:l==="null"||l==="not_null",onChange:u=>r(u.target.value,n,d,c,"min"),value:N.min||""})})}),e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:S.match(/select|check|radio/g)?e.jsx(Fe,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:N.max||"",onChange:u=>r(u,n,d,c,"max"),options:x(),customValue:!0,fldType:S}):e.jsx($e,{label:"Max Value",type:p,disabled:l==="null"||l==="not_null",onChange:u=>r(u.target.value,n,d,c,"max"),value:N.max||""})})})]})})]}),e.jsxs("div",{className:"btcd-li-side-btn",children:[e.jsx(q,{onClick:()=>j(n,d,c),icn:!0,className:"ml-2 white sh-sm",children:e.jsx(Ce,{size:"16"})}),e.jsx(q,{onClick:()=>o(n,d,c),icn:!0,className:"ml-2 white mr-2 sh-sm",children:e.jsx(Ae,{size:"16"})}),e.jsxs(q,{onClick:()=>C("and",n,d,c),className:"white mr-2 sh-sm",children:[e.jsx(R,{size:"10",className:"icn-rotate-45 mr-1"}),"AND"]}),e.jsxs(q,{onClick:()=>C("or",n,d,c),className:"white sh-sm",children:[e.jsx(R,{size:"10",className:"icn-rotate-45 mr-1"}),"OR"]})]})]})}const Ue={lgcBlk:{pn:"relative",dy:"flex",cg:15,rg:15,my:5,":hover":{bc:"#F0F0F0"}},lgcGrp:{b:"0.5px solid #D5D5D5",brs:8,p:10,ml:20},blkItm:{w:"100%"},processDgrm:{"--linethick":"1px","--linewidth":"1.5em","--line-color":"#b9c5ff",flx:"align-center",w:"100%",m:0,p:0,ls:"none",ta:"center","& > .block-wrapper":{flex:"1 1 auto"},"& .block-wrapper>.block-content":{cr:"#666",brs:10},"& .block-wrapper::before, & .block-wrapper::after, & .block-group::before, & .block-group::after, & .block-content::before, & .block-content::after":{bse:"solid",bcr:"var(--line-color)"},"& .block-wrapper .block-group .block-wrapper:first-child .block-content::before, &  .block-wrapper .block-group .block-wrapper:first-child::before":{btlr:10},"&  .block-wrapper .block-group .block-wrapper:first-child .block-content::after, & .block-wrapper .block-group .block-wrapper:first-child::after":{btrr:10},"&  .block-wrapper .block-group .block-wrapper:last-child .block-content::before, &  .block-wrapper .block-group .block-wrapper:last-child::before":{bblr:10},"&  .block-wrapper .block-group .block-wrapper:last-child .block-content::after, &  .block-wrapper .block-group .block-wrapper:last-child::after":{bbrr:10},"& ol, & .block-group, & .block-wrapper":{ls:"none",ta:"center"},"& .block-wrapper":{pn:"relative",mb:0,w:"100%"},"& > .block-wrapper, & ol > .block-wrapper, & .block-group > .block-wrapper":{p:"4px 0"},"&  .block-group":{pn:"relative",pl:"var(--linewidth)"},"& .block-group::before, &  .block-group::after":{pn:"absolute",ct:'""',tp:"50%",w:"var(--linewidth)",dy:"block",bwh:"var(--linethick) 0 0"},"& .block-group::before":{lt:0},"&  .block-group::after":{rt:0},"&  .block-group>.block-wrapper::after, &  .block-group>.block-wrapper::before":{pn:"absolute",ct:'""',tp:0,bm:0,w:"var(--linewidth)",h:"100%",dy:"block"},"&  .block-group>.block-wrapper::before":{lt:0,bwh:"0 0 0 var(--linethick)"},"&  .block-group>.block-wrapper::after":{rt:0,bwh:"0 var(--linethick) 0 0"},"&  .block-group>.block-wrapper:first-child::before, &  .block-group>.block-wrapper:first-child::after":{tp:"50%",bm:"auto",h:"50%"},"&  .block-group>.block-wrapper:last-child::before, &  .block-group>.block-wrapper:last-child::after":{tp:0,bm:"auto",h:"50%"},"&  .block-group>.block-wrapper:first-child:last-child::before, &  .block-group>.block-wrapper:first-child:last-child::after":{tp:0,bm:"auto",h:"50%"},"&  .block-wrapper>.block-content":{pn:"relative",ml:"var(--linewidth)"},"& >.block-wrapper:first-child>.block-content":{ml:0},"&  .block-wrapper:not(:last-child) .block-wrapper>.block-content":{mr:"var(--linewidth)"},"&  .block-wrapper>.block-content::before, &  .block-wrapper>.block-content::after":{ct:'""',tp:"50%",w:"var(--linewidth)",pn:"absolute",bwh:"var(--linethick) 0 0",h:"50%"},"&  .block-wrapper>.block-content::after":{rt:"calc(0em - var(--linewidth) + 2px)",mr:"calc(0px - var(--linethick))"},"&  .block-wrapper>.block-content::before":{lt:"calc(0em - var(--linewidth) + 2px)",ml:"calc(0px - var(--linethick))"},"&  .block-wrapper:last-child>.block-content::after, & .block-wrapper:last-child>.block-content::before":{tp:0,bwh:"0 0 var(--linethick)"},"& >.block-wrapper:first-child>.block-content::before, & >.block-wrapper:first-child>.block-group::before, & >.block-wrapper:first-child>.block-group>.block-wrapper::before, & >.block-wrapper:first-child>.block-group>.block-wrapper>.block-content:first-child::before, & >.block-wrapper:first-child>.block-group>.block-wrapper>ol>.block-wrapper:first-child>.block-content::before, & >.block-wrapper:last-child>.block-content::after, & >.block-wrapper:last-child>.block-group::after":{b:0},"& >.block-wrapper>.block-content::after,  &  ol>.block-wrapper>.block-content::after, & >.block-wrapper>.block-group::after,  &  ol>.block-wrapper>.block-group::after":{dy:"none"},"& >.block-wrapper>.block-content, &  ol>.block-wrapper>.block-content":{mr:0},"& >.block-wrapper>.block-group,  &  ol>.block-wrapper>.block-group":{pr:0},"& >.block-wrapper:last-child>.block-content::after,  &  ol>.block-wrapper:last-child>.block-content::after,  & >.block-wrapper:last-child>.block-group::after,  &  ol>.block-wrapper:last-child>.block-group::after":{dy:"block"},"& >.block-wrapper:last-child>.block-content, & ol>.block-wrapper:last-child>.block-content":{mr:0},"&  .block-wrapper:last-child>.block-group::after,  &  .block-wrapper:last-child>.block-group>.block-wrapper::after,  &  .block-wrapper:last-child>.block-group>.block-wrapper>.block-content::after":{dy:"none"}}};function Oe({logic:s,nested:t,onChange:o,className:n=null}){return e.jsx("div",{children:e.jsxs("select",{value:s,onChange:o,className:`btcd-logic-chip ${n} ${t&&"scl-8"}`,children:[e.jsx("option",{value:"or",children:i("OR")}),e.jsx("option",{value:"and",children:i("AND")})]})})}function Wt({lgcGrp:s,lgcGrpInd:t,condGrp:o,condGrpInd:n}){var S;const{css:d}=Y(),[c,N]=le(Z),C=J(V),j=X(ge),b=(a,h,x)=>{const g=B(c,$=>{const y=$[t].conditions[n].logics;if(y.length>1)if(x!==void 0)if(y[a][h].length===x+1)if(y[a][h].length===3){const _=y[a][h][x-2];y[a].splice(h,1),y[a].push(_)}else y[a][h].splice(x-1,2);else if(y[a][h].length===3){const _=y[a][h][x+2];y[a].splice(h,1),y[a].push(_)}else y[a][h].splice(x,2);else if(h!==void 0)if(y[a].length===h+1)if(y[a].length===3){const _=y[a][h-2];y.splice(a,1),y.splice(a,0,_)}else y[a].splice(h-1,2);else if(y[a].length===3){const _=y[a][h+2];y.splice(a,1),y.splice(a,0,_)}else y[a].splice(h,2);else a!==0?y.splice(a-1,2):y.splice(a,2)});N(g),C($=>W(F({},$),{unsaved:!0}))},l=(a,h,x,g)=>{const $=B(c,y=>{const _=y[t].conditions[n].logics;g!==void 0?(a==="null"&&(_[h][x][g].val=""),_[h][x][g].logic=a):x!==void 0?(a==="null"&&(_[h][x].val=""),_[h][x].logic=a):(a==="null"&&(_[h].val=""),_[h].logic=a)});N($),C(y=>W(F({},y),{unsaved:!0}))},r=(a,h,x,g)=>{const $=B(c,y=>{const _=y[t].conditions[n].logics;g!==void 0?_[h][x][g]=a:x!==void 0?_[h][x]=a:_[h]=a});N($),C(y=>W(F({},y),{unsaved:!0}))},m=(a,h,x,g)=>g!==void 0?a[h][x][g]:x!==void 0?a[h][x]:a[h],f=(a,h,x,g,$="")=>{const y=B(c,_=>{const z=_[t].conditions[n].logics,U=m(z,h,x,g);$?(typeof U.val=="string"&&(U.val={}),U.val[$]=a):U.val=a});N(y),C(_=>W(F({},_),{unsaved:!0}))},w=(a,h,x,g)=>{const $=Te.find(_=>_.name===a),y=B(c,_=>{const z=_[t].conditions[n].logics,U=m(z,h,x,g);U.field=a,typeof U.val=="undefined"&&(U.val=""),$!=null&&$.custom||delete U.smartKey});N(y),C(_=>W(F({},_),{unsaved:!0}))},v=(a,h,x,g)=>{const $=B(c,y=>{const _=y[t].conditions[n].logics;g!==void 0?_[h][x].splice(g+1,0,a,{field:"",logic:"",val:""}):x!==void 0?_[h].splice(x+1,0,a,{field:"",logic:"",val:""}):_.splice(h+1,0,a,{field:"",logic:"",val:""})});N($),C(y=>W(F({},y),{unsaved:!0}))},O=(a,h,x)=>{let g=x!==void 0?c[t].conditions[n].logics[a][h][x-1]:h!==void 0?c[t].conditions[n].logics[a][h-1]:c[t].conditions[n].logics[a-1];g==="and"||g==="or"||(g="and");const $=B(c,y=>{const _=y[t].conditions[n].logics;if(x!==void 0){const z=F({},_[a][h][x]);_[a][h].splice(x+1,0,g,z)}else if(h!==void 0){const z=F({},_[a][h]);_[a].splice(h+1,0,g,z)}else{const z=F({},_[a]);_.splice(a+1,0,g,z)}});N($),C(y=>W(F({},y),{unsaved:!0}))},k=(a,h,x,g)=>{const $=B(c,y=>{const _=y[t].conditions[n].logics,z=m(_,h,x,g);z.smartKey=a});N($),C(y=>W(F({},y),{unsaved:!0}))},A=(a,h)=>{if(s.action_type!=="oninput")return!0;const x=a.findIndex(g=>g.field&&g.field in j);return x>=0&&x!==h},p=(a,h,x=0)=>{const g=[a],$={field:"",logic:"",val:""};x?g.push([$,a,$]):g.push($),N(y=>B(y,_=>{const{logics:z}=y[t].conditions[n],U=[...z[h],...g];_[t].conditions[n].logics[h]=U}))};return(S=o==null?void 0:o.logics)==null?void 0:S.map((a,h)=>e.jsxs("span",{children:[typeof a=="object"&&!Array.isArray(a)&&e.jsx(Se,{logic:a,fieldVal:a.field,changeFormField:w,changeValue:f,changeSmartKey:k,logicValue:a.logic,changeLogic:l,addInlineLogic:v,cloneInLineLogic:O,delLogic:b,lgcGrpInd:t,lgcInd:h,value:a.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:A(o.logics,h),formFields:ve(o)}),typeof a=="string"&&e.jsx(Oe,{logic:a,onChange:x=>r(x.target.value,h)}),Array.isArray(a)&&e.jsxs("div",{className:"p-2 br-10 btcd-logic-grp mt-2 mb-2 pl-4 pr-4",children:[a.map((x,g)=>e.jsxs("span",{children:[typeof x=="object"&&!Array.isArray(x)&&e.jsx(Se,{logic:x,fieldVal:x.field,changeFormField:w,changeValue:f,changeSmartKey:k,logicValue:x.logic,changeLogic:l,addInlineLogic:v,cloneInLineLogic:O,delLogic:b,lgcGrpInd:t,lgcInd:h,subLgcInd:g,value:x.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:A(a,g),formFields:ve(o)}),typeof x=="string"&&e.jsx(Oe,{logic:x,nested:!0,onChange:$=>r($.target.value,h,g)}),Array.isArray(x)&&e.jsxs("div",{className:"p-2 br-10 btcd-logic-grp mt-2 mb-2 pl-4 pr-4",children:[x.map(($,y)=>e.jsxs("span",{children:[typeof $=="object"&&!Array.isArray($)&&e.jsx(Se,{logic:$,fieldVal:$.field,changeFormField:w,changeValue:f,changeSmartKey:k,logicValue:$.logic,changeLogic:l,addInlineLogic:v,cloneInLineLogic:O,delLogic:b,lgcGrpInd:t,lgcInd:h,subLgcInd:g,subSubLgcInd:y,value:$.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:A(x,y),formFields:ve(o)}),typeof $=="string"&&e.jsx(Oe,{logic:$,nested:!0,onChange:_=>r(_.target.value,h,g,y)})]},`subsubLogic-${y+90}`)),e.jsxs(we,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(R,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:d(ce.addItemBtn),onClick:()=>v("and",h,g,x.length),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:d(ce.addItemBtn),onClick:()=>v("or",h,g,x.length),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]})]})]})]})]},`subLogic-${g*7}`)),e.jsxs(we,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(R,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:d(ce.addItemBtn),onClick:()=>p("and",h),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:d(ce.addItemBtn),onClick:()=>p("or",h),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]}),e.jsxs("button",{type:"button",className:d(ce.addItemBtn),onClick:()=>p("and",h,1),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND Group"]}),e.jsxs("button",{type:"button",className:d(ce.addItemBtn),onClick:()=>p("or",h,1),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR Group"]})]})]})]})]},`logic-${h+44}`))}const ce={addItemBtn:{dy:"block",w:"100%",b:0,oe:0,brs:8,ta:"left",cr:"#444",fs:12,fw:500,p:5,pr:20,bd:"none",curp:1,":hover":{bc:"#EFEFEF"}}};function Bt({lgcGrpInd:s,lgcGrp:t}){var j;const{css:o}=Y(),n=J(Z),d=J(V),c=b=>b.replace(/-/g," ").split(" ").map(l=>ct(l)).join(" "),N=b=>{Pe(),n(l=>B(l,r=>{const{conditions:m}=r[s],f=W(F({},ke),{cond_type:b});b==="else"&&delete f.logics,b==="else-if"&&m[m.length-1].cond_type==="else"?m.splice(m.length-1,0,f):m.push(f)})),d(l=>W(F({},l),{unsaved:!0}))},C=(b,l,r="",m=0)=>{Pe();const f=[b],w={field:"",logic:"",val:""};m?f.push([w,b,w]):f.push(w),n(v=>B(v,O=>{let k=O[s].conditions[l].logics;k=yt(k,r),k.push(...f)})),d(v=>W(F({},v),{unsaved:!0}))};return e.jsxs("div",{className:o(se.container),children:[e.jsxs("div",{className:o(se.section),children:[t.action_behaviour==="cond"&&e.jsxs("div",{className:o(se.sideBdr),children:[e.jsx("div",{className:o(se.sideBdrLn)}),e.jsx("div",{className:o(se.sideBdrCrl)})]}),(j=t==null?void 0:t.conditions)==null?void 0:j.map((b,l)=>e.jsxs(ye.Fragment,{children:[t.action_behaviour==="cond"&&b.cond_type!=="else"&&e.jsxs(De,{title:c(b.cond_type),accordionActions:b.cond_type!=="if"&&e.jsx(qe,{lgcGrpInd:s,condGrpInd:l}),children:[e.jsx(Wt,{lgcGrp:t,lgcGrpInd:s,condGrp:b,condGrpInd:l}),e.jsx("div",{className:"mt-1",children:e.jsxs(we,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(R,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:o(se.addItemBtn),onClick:()=>C("and",l),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:o(se.addItemBtn),onClick:()=>C("or",l),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]}),e.jsxs("button",{type:"button",className:o(se.addItemBtn),onClick:()=>C("and",l,"",1),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND Group"]}),e.jsxs("button",{type:"button",className:o(se.addItemBtn),onClick:()=>C("or",l,"",1),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR Group"]})]})]})})]},b.cond_type+0),t.action_behaviour==="cond"&&e.jsx(De,{title:b.cond_type==="else"?"Else":"Then",titleOutline:b.cond_type!=="else",accordionActions:b.cond_type==="else"&&e.jsx(qe,{lgcGrpInd:s,condGrpInd:l,add:!1,clone:!1}),children:e.jsx(ze,{lgcGrp:t,lgcGrpInd:s,condGrp:b,condGrpInd:l})},b.cond_type+1),t.action_behaviour!=="cond"&&e.jsx(ze,{lgcGrp:t,lgcGrpInd:s,condGrp:b,condGrpInd:l})]},`wkf-${l+99}`))]}),t.action_behaviour==="cond"&&e.jsxs(we,{place:"bottom",children:[e.jsx(ae,{msg:"Add Condition",children:e.jsx(q,{icn:!0,className:"blue sh-sm ml-2",children:e.jsx(R,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:o(se.addItemBtn),onClick:()=>N("else-if"),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),'Add "Else If"']}),t.conditions[t.conditions.length-1].cond_type!=="else"&&e.jsxs("button",{type:"button",className:o(se.addItemBtn),onClick:()=>N("else"),children:[e.jsx(R,{size:"9",className:"icn-rotate-45 mr-1"}),'Add "Else"']})]})]})]})}const qe=({lgcGrpInd:s,condGrpInd:t,add:o,clone:n,remove:d})=>{const[c,N]=ye.useState({show:!1}),C=J(Z),j=J(V),b=()=>{N({show:!1})},l=()=>{N({show:!1}),C(v=>B(v,O=>{O[s].conditions.splice(t,1)})),j(v=>W(F({},v),{unsaved:!0}))},r=()=>{N({btnTxt:"Delete",body:"Are you sure to delete this logic?",btnClass:"",action:()=>{l(),b()},show:!0})},m=()=>{C(v=>B(v,O=>{O[s].conditions.splice(t+1,0,rt(O[s].conditions[t]))})),j(v=>W(F({},v),{unsaved:!0}))},f=()=>{C(v=>B(v,O=>{O[s].conditions.splice(t+1,0,W(F({},ke),{cond_type:"else-if"}))})),j(v=>W(F({},v),{unsaved:!0}))},w=v=>typeof v=="boolean"?v:!0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[w(o)&&e.jsx(ae,{msg:"Add Else If",children:e.jsx(q,{onClick:f,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(vt,{size:"16"})})}),w(n)&&e.jsx(ae,{msg:"Clone",children:e.jsx(q,{onClick:m,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(Ce,{size:"16"})})}),w(d)&&e.jsx(ae,{msg:"Delete",children:e.jsx(q,{onClick:r,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(Ae,{size:"16"})})})]}),e.jsx(He,{show:c.show,close:b,btnTxt:c.btnTxt,btnClass:c.btnClass,body:c.body,action:c.action})]})},se={container:{mt:10},section:{pn:"relative",w:"100%",zx:1,mb:10,pb:10},sideBdr:{flx:"center",fd:"column",w:50,pn:"absolute",h:"100%",zx:-1},sideBdrLn:{w:2,bc:"var(--b-50)",h:"100%"},sideBdrCrl:{brs:"50%",bc:"var(--b-50)",h:8,w:8,mt:-1},addItemBtn:{dy:"block",w:"100%",b:0,oe:0,brs:8,ta:"left",cr:"#444",fs:12,fw:500,p:5,pr:20,bd:"none",curp:1,":hover":{bc:"#EFEFEF"}}};function Et({lgcGrpInd:s,lgcGrp:t}){var b;const[o,n]=le(Z),d=J(V),{css:c}=Y(),N=l=>{const r=B(o,m=>{l==="delete"?delete m[s].action_type:m[s].action_type===void 0&&(m[s].action_type="onload"),m[s].action_run=l});n(r),d(m=>W(F({},m),{unsaved:!0}))},C=l=>{const r=B(o,m=>{l==="onsubmit"&&m[s].conditions.forEach(w=>{var O,k;const v=(k=(O=w.actions)==null?void 0:O.fields)==null?void 0:k.length;for(let A=0;A<v;A+=1)w.actions.fields[A].action="value"}),l!=null&&l.match(/^(onvalidate|oninput)$/)&&(m[s].action_behaviour="cond"),m[s].conditions.forEach(w=>{l==="onvalidate"?(w.actions.failure||(w.actions.failure=""),delete w.actions.fields,delete w.actions.success):(w.actions.fields||(w.actions.fields=[{field:"",action:"value"}]),w.actions.success||(w.actions.success=[]),delete w.actions.failure)});const[f]=m[s].conditions;f.cond_type="if",f.logics||(f.logics=ke.logics),m[s].action_type=l});n(r),d(m=>W(F({},m),{unsaved:!0}))},j=l=>{const r=B(o,m=>{m[s].action_behaviour=l;const[f]=m[s].conditions;f.cond_type=l==="cond"?"if":l,l==="always"?delete f.logics:l==="cond"&&(f.logics=ke.logics),m[s].conditions=[f]});n(r),d(m=>W(F({},m),{unsaved:!0}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Run When:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[e.jsx(G,{radio:!0,onChange:l=>N(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Create/Edit")}),checked:t.action_run==="create_edit",value:"create_edit"}),e.jsx(G,{radio:!0,onChange:l=>N(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Create")}),checked:t.action_run==="create",value:"create"}),e.jsx(G,{radio:!0,onChange:l=>N(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Edit")}),checked:t.action_run==="edit",value:"edit"}),e.jsx(G,{radio:!0,onChange:l=>N(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Delete")}),checked:t.action_run==="delete",value:"delete"})]})]}),t.action_run!=="delete"&&e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Effect:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[e.jsxs("div",{className:c(Mt.actionEffectGroup),children:[e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Always")}),checked:t.action_type==="always",value:"always"}),e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Load")}),checked:t.action_type==="onload",value:"onload"}),e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Field Input")}),checked:t.action_type==="oninput",value:"oninput"})]}),e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Validate")}),checked:t.action_type==="onvalidate",value:"onvalidate"}),e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Submit")}),checked:t.action_type==="onsubmit",value:"onsubmit"})]})]}),e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Behaviour:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[!((b=t==null?void 0:t.action_type)!=null&&b.match(/^(onvalidate|oninput)$/))&&e.jsx(G,{radio:!0,onChange:l=>j(l.target.value),name:`ab-${s+121}`,title:e.jsx("small",{className:"txt-dp",children:i("Always")}),checked:t.action_behaviour==="always",value:"always"}),e.jsx(G,{radio:!0,onChange:l=>j(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Condition")}),checked:t.action_behaviour==="cond",value:"cond"})]})]})]})}const Mt={actionEffectGroup:{dy:"inline-block",b:"1px solid var(--gray-3)",brs:8}};function Kt(){const s=X(dt),[t,o]=ye.useState({show:!1}),[n,d]=le(Z),c=J(V),{css:N}=Y(),C=X(Je),{isPro:j}=C,b=k=>{switch(k){case"onload":return i("On Load");case"oninput":return i("On Field Input");case"onvalidate":return i("On Form Validate");case"onsubmit":return i("On Form Submit");case"create_edit":return i("Record Create/Edit");case"create":return i("Record Create");case"edit":return i("Record Edit");case"delete":return i("Record Delete");case"always":return i("Always");case"cond":return i("With Condition")}},l=()=>{const k=B(n,A=>{A.unshift({title:`Action ${n.length+1}`,action_type:"always",action_run:"create_edit",action_behaviour:"cond",conditions:[F({},ke)]})});d(k),c(A=>W(F({},A),{unsaved:!0}))},r=k=>{if(n[k].id){const A=mt({formID:s,id:n[k].id},"bitforms_delete_workflow").then(p=>{if(p!==void 0&&p.success){const S=B(n,a=>{a.splice(k,1)});d(S)}});pt.promise(A,{success:"Successfully Deleted.",loading:"Deleting...",error:"Error occurred, Try again."})}else{const A=B(n,p=>{p.splice(k,1)});d(A)}},m=(k,A)=>{const p=B(n,S=>{S[A].title=k.target.value});d(p),c(S=>W(F({},S),{unsaved:!0}))},f=()=>{t.show=!1,o(F({},t))},w=k=>{t.btnTxt="Delete",t.body="Are you sure to delete this conditional logic?",t.btnClass="",t.action=()=>{r(k),f()},t.show=!0,o(F({},t))},v=k=>{const A=B(n,p=>{const S=F({},p[k]);S.title=`${S.title} (Clone-${n.length+1})`,delete S.id,p.splice(k+1,0,S)});d(A)},O=({oldIndex:k,newIndex:A})=>{k!==A&&(d(p=>xt(p,k,A)),c(p=>W(F({},p),{unsaved:!0})))};return e.jsxs("div",{className:"btcd-workflow",style:{width:"93%"},children:[e.jsx(He,{show:t.show,close:f,btnTxt:t.btnTxt,btnClass:t.btnClass,body:t.body,action:t.action}),e.jsx("h2",{children:i("Conditional Logics")}),e.jsxs("h5",{children:["How to configure conditional logics: Â ",e.jsx("a",{href:Me.conditionalLogic.link,target:"_blank",rel:"noreferrer",className:"yt-txt ml-1 mr-1",children:"YouTube"}),e.jsx("a",{href:Me.conditionalLogicDoc.link,target:"_blank",rel:"noreferrer",className:"doc-txt",children:"Documentation"})]}),(!j&&!n.length||j)&&e.jsxs(q,{className:"blue",onClick:l,children:[e.jsx(R,{size:"10",className:"icn-rotate-45 mr-1"}),i("Add Conditional Logic")]}),n.length===0&&e.jsxs("div",{className:N(H.btcdEmpty,H.txCenter),children:[e.jsx(bt,{size:"50"}),i("Empty")]}),e.jsx(ht,{onSortEnd:O,useDragHandle:!0,children:n.map((k,A)=>e.jsxs(ut,{index:A,children:[e.jsxs("div",{className:"workflow-grp d-flx mt-2",children:[e.jsxs(kt,{customTitle:e.jsx(ft,{className:"workflow-drg-handle mr-1 flx"}),title:k.title,header:e.jsxs("small",{className:"f-right txt-dp mr-4",children:[e.jsxs("span",{className:"mr-2",children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),b(k.action_run)]}),k.action_type!==void 0&&e.jsxs("span",{className:"mr-2",children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),b(k.action_type)]}),e.jsxs("span",{children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),b(k.action_behaviour)]})]}),titleEditable:!0,onTitleChange:p=>m(p,A),notScroll:!0,cls:j?"w-9":"w-10",children:[e.jsx(Et,{lgcGrpInd:A,lgcGrp:k}),e.jsx(Bt,{lgcGrpInd:A,lgcGrp:k})]}),j&&e.jsxs("div",{className:"mt-2 flx flx-start",children:[e.jsx(q,{onClick:()=>w(A),icn:!0,className:"ml-2 sh-sm btcd-menu-btn tooltip",style:{"--tooltip-txt":'"Delete Action"'},children:e.jsx(Ae,{size:"16"})}),e.jsx(q,{onClick:()=>v(A),icn:!0,className:"sh-sm btcd-menu-btn tooltip",style:{"--tooltip-txt":'"Clone Action"'},children:e.jsx(Ce,{size:"16"})})]})]}),!j&&e.jsxs("div",{className:"txt-center bg-pro p-5 mt-2",children:[i("For"),"Â ",e.jsx("span",{className:"txt-pro",children:i("UNLIMITED")}),"Â ",i("Conditional Logics"),",Â ",e.jsx("a",{href:"https://www.bitapps.pro/bit-form",target:"_blank",rel:"noreferrer",children:e.jsx("b",{className:"txt-pro",children:i("Buy Premium")})})]})]},`workflows-grp-${A+13}`))}),n.length>1&&e.jsxs("div",{className:N(H.w9,{fs:13},H.mt4),children:[e.jsx("strong",{children:"Note: "}),"Conditional Logics are triggered based on the order of the logic groups. The higher the logic group, the higher the priority. If you want to change the priority, you can sort by drag and drop the logic group."]})]})}export{Kt as default};
