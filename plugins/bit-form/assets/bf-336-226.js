var M=Object.defineProperty;var w=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var y=(s,t,a)=>t in s?M(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,p=(s,t)=>{for(var a in t||(t={}))I.call(t,a)&&y(s,a,t[a]);if(w)for(var a of w(t))R.call(t,a)&&y(s,a,t[a]);return s};import{r as v,j as e,T as _,_ as n,d as k,e as N,u as $,X as G,$ as O}from"./main-200.js";import{u as S,j as q}from"./bf-602-79.js";import{g as A,a as U,m as z}from"./bf-889-183.js";import{M as E}from"./bf-543-114.js";const V=(s,t,a)=>{const l=p({},t);l.field_map.splice(s,0,{}),a(p({},l))},B=(s,t,a)=>{const l=p({},t);l.field_map.length>1&&l.field_map.splice(s,1),a(p({},l))},T=(s,t,a,l)=>{const u=p({},a);u.field_map[t][s.target.name]=s.target.value,s.target.value==="custom"&&(u.field_map[t].customValue=""),l(p({},u))},D=(s,t,a,l)=>{const u=p({},a);u.field_map[t].customValue=s.target.value,l(p({},u))};function P({mailerLiteConf:s,setMailerLiteConf:t,formFields:a}){var c,g,F;const[l,u]=v.useState({show:!1,action:()=>{}}),[r,j]=v.useState(!1),h=(d,i)=>{const o=p({},s);i==="group"&&(A(s,t,j),d.target.checked?o.actions.group=!0:delete o.actions.group,u({show:i})),i==="mailer_lite_type"&&(d.target.checked?o.actions.mailer_lite_type=!0:delete o.actions.mailer_lite_type,u({show:i})),i==="update"&&(d.target.checked?o.actions.update=!0:delete o.actions.update),i==="double_opt_in"&&(d.target.checked?o.actions.double_opt_in=!0:delete o.actions.double_opt_in),t(p({},o))},m=()=>{u({show:!1})},b=(d,i)=>{const o=p({},s);i==="group_ids"&&d.length?(o.actions.group=!0,o.actions.update=!0):i==="group_ids"&&d.length<1&&delete o.actions.group,i==="mailer_lite_type"&&d.length?o.actions.mailer_lite_type=!0:i==="mailer_lite_type"&&d.length<1&&delete o.actions.mailer_lite_type,o[i]=d,t(p({},o))},x=[{label:"Active",value:"active"},{label:"Unsubscribed",value:"unsubscribed"},{label:"Bounced",value:"bounced"},{label:"Spam Complaints",value:"junk"},{label:"Unconfirmed",value:"unconfirmed"}];return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"pos-rel d-flx w-8",children:[e.jsx(_,{checked:(s==null?void 0:s.group_ids.length)||!1,onChange:d=>h(d,"group"),className:"wdt-200 mt-4 mr-2",value:"group",title:n("Groups"),subTitle:n("Add Groups")}),e.jsx(_,{checked:(s==null?void 0:s.mailer_lite_type)||!1,onChange:d=>h(d,"mailer_lite_type"),className:"wdt-200 mt-4 mr-2",value:"type",title:n("Status"),subTitle:n("Add Subscriber Status")}),(s==null?void 0:s.version)!=="v2"&&e.jsx(_,{checked:((c=s.actions)==null?void 0:c.double_opt_in)||!1,onChange:d=>h(d,"double_opt_in"),className:"wdt-200 mt-4 mr-2",value:"double_opt_in",title:n("Double Opt-in"),subTitle:n("Add Double Opt-in")}),e.jsx(_,{checked:((g=s.actions)==null?void 0:g.update)||!1,isInfo:s==null?void 0:s.group_ids.length,onChange:d=>h(d,"update"),className:"wdt-200 mt-4 mr-2",value:"user_share",title:n("Update Subscriber"),subTitle:n("Update Responses with MailerLite exist Subscriber?")})]}),e.jsxs(k,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok"),show:l.show==="group",close:m,action:m,title:n("Groups"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),r?e.jsx(N,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsxs("div",{className:"flx flx-between mt-2",children:[e.jsx(S,{className:"msl-wrp-options",defaultValue:s==null?void 0:s.group_ids,options:(F=s==null?void 0:s.groups)==null?void 0:F.map(d=>({label:d.name,value:d.group_id})),onChange:d=>b(d,"group_ids"),customValue:!0}),e.jsx("button",{onClick:()=>A(s,t,j),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":`${n("Refresh Groups")}'`},type:"button",disabled:r,children:"↻"})]})]}),e.jsxs(k,{className:"custom-conf-mdl",mainMdlCls:"o-v",btnClass:"blue",btnTxt:n("Ok"),show:l.show==="mailer_lite_type",close:m,action:m,title:n("Type"),children:[e.jsx("div",{className:"btcd-hr mt-2 mb-2"}),r?e.jsx(N,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:45,transform:"scale(0.5)"}}):e.jsx("div",{className:"flx flx-between mt-2",children:e.jsx(S,{className:"msl-wrp-options",defaultValue:s==null?void 0:s.mailer_lite_type,options:x.map(d=>({label:d.label,value:d.value})),onChange:d=>b(d,"mailer_lite_type"),customValue:!0,singleSelect:!0})})]})]})}function f({i:s,formFields:t,field:a,mailerLiteConf:l,setMailerLiteConf:u}){var b,x;if(((b=l==null?void 0:l.field_map)==null?void 0:b.length)===1&&a.mailerLiteFormField===""){const c=p({},l),g=U(c);c.field_map=g,u(c)}const r=(l==null?void 0:l.mailerLiteFields.filter(c=>c.required===!0))||[],j=(l==null?void 0:l.mailerLiteFields.filter(c=>c.required===!1))||[],h=$(O),{isPro:m}=h;return e.jsx("div",{className:"flx mt-2 mb-2 btcbi-field-map",children:e.jsxs("div",{className:"pos-rel flx",children:[e.jsxs("div",{className:"flx integ-fld-wrp",children:[e.jsxs("select",{className:"btcd-paper-inp mr-2",name:"formField",value:a.formField||"",onChange:c=>T(c,s,l,u),children:[e.jsx("option",{value:"",children:n("Select Field")}),e.jsx("optgroup",{label:"Form Fields",children:t==null?void 0:t.map(c=>e.jsx("option",{value:c.key,children:c.name},`ff-rm-${c.key}`))}),e.jsx("option",{value:"custom",children:n("Custom...")}),e.jsx("optgroup",{label:`General Smart Codes ${m?"":"(PRO)"}`,children:m&&((x=q)==null?void 0:x.map(c=>e.jsx("option",{value:c.name,children:c.label},`ff-rm-${c.name}`)))})]}),a.formField==="custom"&&e.jsx(E,{onChange:c=>D(c,s,l,u),label:n("Custom Value"),className:"mr-2",type:"text",value:a.customValue,placeholder:n("Custom Value")}),e.jsxs("select",{className:"btcd-paper-inp",disabled:s<r.length,name:"mailerLiteFormField",value:s<r?r[s].label||"":a.mailerLiteFormField||"",onChange:c=>T(c,s,l,u),children:[e.jsx("option",{value:"",children:n("Select Field")}),s<r.length?e.jsx("option",{value:r[s].key,children:r[s].label},r[s].key):j.map(({key:c,label:g})=>e.jsx("option",{value:c,children:g},c))]})]}),s>=r.length&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>V(s,l,u),className:"icn-btn sh-sm ml-2 mr-1",type:"button",children:"+"}),e.jsx("button",{onClick:()=>B(s,l,u),className:"icn-btn sh-sm ml-1",type:"button","aria-label":"btn",children:e.jsx(G,{size:"15"})})]})]})})}function W({formFields:s,mailerLiteConf:t,setMailerLiteConf:a,isLoading:l,setIsLoading:u,setSnackbar:r}){const[j,h]=v.useState(!1),[m,b]=v.useState({name:"",auth_token:""});return e.jsxs(e.Fragment,{children:[e.jsx("br",{}),e.jsx("div",{className:"mt-5",children:e.jsxs("b",{className:"wdt-100",children:[n("Field Map"),e.jsx("button",{onClick:()=>z(t,a,b,h,u,"refreshFields"),className:"icn-btn sh-sm ml-2 mr-2 tooltip",style:{"--tooltip-txt":'"Refresh Fields"'},type:"button",disabled:l,children:"↻"})]})}),e.jsx("br",{}),l&&e.jsx(N,{style:{display:"flex",justifyContent:"center",alignItems:"center",height:100,transform:"scale(0.7)"}}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsxs("div",{className:"flx flx-around mt-2 mb-2 btcbi-field-map-label",children:[e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("Form Fields")})}),e.jsx("div",{className:"txt-dp",children:e.jsx("b",{children:n("MailerLite Fields")})})]}),t==null?void 0:t.field_map.map((x,c)=>e.jsx(f,{i:c,field:x,mailerLiteConf:t,formFields:s,setMailerLiteConf:a,setSnackbar:r},`rp-m-${c+9}`)),e.jsx("div",{className:"txt-center btcbi-field-map-button mt-2",children:e.jsx("button",{onClick:()=>V(t.field_map.length,t,a),className:"icn-btn sh-sm",type:"button",children:"+"})}),e.jsx("br",{}),e.jsx("br",{}),e.jsx("div",{className:"mt-4",children:e.jsx("b",{className:"wdt-100",children:n("Actions")})}),e.jsx("div",{className:"btcd-hr mt-1"}),e.jsx(P,{mailerLiteConf:t,setMailerLiteConf:a,formFields:s})]})}export{W as M};
