var Qe=Object.defineProperty,Ye=Object.defineProperties;var Xe=Object.getOwnPropertyDescriptors;var Oe=Object.getOwnPropertySymbols;var Ze=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var Te=(s,t,o)=>t in s?Qe(s,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):s[t]=o,$=(s,t)=>{for(var o in t||(t={}))Ze.call(t,o)&&Te(s,o,t[o]);if(Oe)for(var o of Oe(t))Ve.call(t,o)&&Te(s,o,t[o]);return s},B=(s,t)=>Ye(s,Xe(t));import{a as L,r as we,j as e,g as se,u as H,al as z,ai as U,T as ye,_ as i,aL as Q,aJ as Ke,aK as Le,z as Ie,aF as Y,$ as Ue,bj as Ge,f as W,aa as je,aA as Ne,bi as et,d6 as tt,bq as st,ak as lt,I as be,J as ge,bf as D,aM as ot,aO as Be,e0 as at,d$ as it,aj as nt,d as qe,q as ct,B as rt,c as dt,V as mt}from"./main-381.js";import{S as pt,a as ht,D as ut,b as ft}from"./bf-739-256.js";import{S as bt}from"./bf-315-328.js";import{o as ie,M as ce,D as ve,q as xe}from"./bf-500-70.js";import{t as We}from"./bf-35-88.js";import{A as xt}from"./bf-671-375.js";import{B as J}from"./bf-461-113.js";import{d as oe,u as Ae,h as Ee,P as kt}from"./bf-540-79.js";import{C as jt}from"./bf-375-83.js";import{C as K}from"./bf-841-104.js";import{C as Je}from"./bf-746-376.js";import{S as $e}from"./bf-878-172.js";import{M as _e}from"./bf-445-114.js";import"./bf-964-112.js";import"./bf-79-86.js";function Me({title:s,titleOutline:t,accordionActions:o,children:r}){const{css:d}=L(),[c,w]=we.useState(!0),A=()=>{w(j=>!j)};return e.jsxs("div",{className:d(V.section),children:[e.jsxs("div",{className:`${d(V.titleWrp)}`,children:[e.jsxs("button",{type:"button",className:`${d(V.title,t?V.titleOutline:{})} btcd-logic-blk`,onClick:A,children:[s,e.jsx("span",{className:d(V.titleIcn),children:e.jsx(jt,{size:15,rotate:!c})})]}),e.jsx("div",{className:`${d(V.accrActions)} accr-actions`,children:o})]}),c&&e.jsx("div",{className:d(V.content),children:r}),!c&&e.jsx("div",{className:d(V.content),children:e.jsxs("button",{className:d(V.collapsedAccrdn),type:"button",onClick:A,children:[e.jsx("span",{className:d(V.collapsedCrl)}),e.jsx("span",{className:d(V.collapsedCrl)}),e.jsx("span",{className:d(V.collapsedCrl)})]})})]})}const V={section:{pb:12},accrActions:{dy:"none"},titleWrp:{flx:1,":hover .accr-actions":{flx:1}},title:{bc:"var(--b-50)",h:35,fs:14,p:"0 15px",brs:30,cr:"#fff",fw:600,lh:"29px",cur:"pointer",us:"none",b:0,oe:0,flx:"center"},titleOutline:{b:"2px solid var(--b-50)",bc:"#fff",cr:"var(--b-50)",p:"0 13px"},titleIcn:{ml:8,flx:"center"},content:{my:5,ml:45},collapsedAccrdn:{b:0,oe:0,bc:"#D9D9D9",w:65,brs:10,h:20,flx:"center",rg:5,cg:5,curp:1,mt:15,":focus":{oe:"none"}},collapsedCrl:{dy:"inline-block",w:5,h:5,bc:"#AAAAAA",brs:"50%"}};function Pe({lgcGrpInd:s,condGrpInd:t,actionKey:o,enableAction:r,checkKeyInArr:d,getValueFromArr:c,title:w}){const{css:A}=L(),[j,l]=se(Q),b=H(Ke),n=H(Le),k=H(Ie),m=z(Y),y=H(Ue),v=()=>{const x=[];return k.map(a=>{Ge.includes(a.type)&&x.push({label:a.name,value:a.key})}),x},h=()=>k.filter(x=>x.type==="email").length>0,g=()=>{const x=[];if(h()){const a=[];k.map(u=>{u.type==="email"&&a.push({label:u.name,value:`\${${u.key}}`})}),x.push({title:"Form Fields",type:"group",childs:a})}return y.userMail&&Array.isArray(y.userMail)&&x.push({title:"WP Emails",type:"group",childs:y.userMail}),x},_=(x,a)=>{const u=W(j,f=>{const{success:C}=f[s].conditions[t].actions,F=C.find(N=>N.type===o);F&&(F.details[x]=a)});l(u),m(f=>B($({},f),{unsaved:!0}))};return e.jsxs("div",{className:A(U.mt2),children:[e.jsx(ye,{onChange:x=>r(x.target.checked,o),title:w,checked:d(o),className:A(U.flxc)}),d(o)&&e.jsxs("div",{className:A({mt:5,ml:28}),children:[e.jsx("label",{className:"f-m f-5",children:i("Email Template:")}),e.jsx("div",{className:"mt-1"}),e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:x=>_("id",x.target.value),value:c(o,"id"),children:[e.jsx("option",{value:"",children:i("Select Email Template")}),b==null?void 0:b.map((x,a)=>e.jsx("option",{value:x.id?JSON.stringify({id:String(x.id)}):JSON.stringify({index:String(a)}),children:x.title},`sem-${a+2.3}`))]}),e.jsx(ie,{action:x=>_("to",x?x.split(","):[]),value:c(o,"to"),placeholder:i("Add Email Receiver"),title:e.jsx("span",{className:"f-m f-5",children:i("To")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:g(c(o,"to"))}),e.jsx(ie,{action:x=>_("from",x),placeholder:i("Add mail from address"),value:c(o,"from"),title:e.jsx("span",{className:"f-m f-5",children:i("From Mail")}),titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:g(c(o,"from"))}),e.jsx("div",{className:"mt-1"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"from_name",className:"f-m f-5",children:i("From Name")}),e.jsx("div",{className:"mt-2"}),e.jsx("input",{id:"from_name",type:"text",className:"btcd-paper-inp",style:{height:"35px",width:"69%",background:"var(--b-79-96)"},value:c(o,"from_name"),onChange:x=>_("from_name",x.target.value),placeholder:"Add mail from name"})]}),e.jsx(ie,{action:x=>_("cc",x?x.split(","):[]),value:c(o,"cc"),placeholder:i("Add Email CC"),title:e.jsx("span",{className:"f-m f-5",children:i("CC")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:g(c(o,"cc"))}),e.jsx(ie,{action:x=>_("bcc",x?x.split(","):[]),placeholder:i("Add Email BCC"),value:c(o,"bcc"),title:e.jsx("span",{className:"f-m f-5",children:i("BCC")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:g(c(o,"bcc"))}),e.jsx(ie,{action:x=>_("replyto",x?x.split(","):[]),placeholder:i("Reply To"),value:c(o,"replyto"),title:e.jsx("span",{className:"f-m f-5",children:i("Reply To")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:g(c(o,"replyto"))}),e.jsx(ie,{action:x=>_("attachment",x?x.split(","):[]),placeholder:i("Attachment"),value:c(o,"attachment"),title:e.jsx("span",{className:"f-m f-5",children:i("Attachment")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",options:v()}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"pdf-template",className:"f-m f-5",children:i("PDF Attachment Template:")}),e.jsx("div",{className:"mt-1"}),e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:x=>_("pdfId",x.target.value),value:c(o,"pdfId"),children:[e.jsx("option",{value:"",children:i("Select PDF Template")}),n==null?void 0:n.map((x,a)=>e.jsx("option",{value:x.id?JSON.stringify({id:String(x.id)}):JSON.stringify({index:String(a)}),children:x.title},`sem-${a+2.3}`))]})]})]})]})}const vt=["text","username","number","email","password","tel","url","search","select","textarea","html-select","currency","phone-number"],wt=(s,t="")=>{if(t==="")return s;const o=t.split("."),r=o.length-1;return o.slice(0,r).forEach(c=>{s=s[c]}),o.length?s[o[r]]:s},yt=[{key:"_bf_form",name:"Form"},{key:"_bf_step_no",name:"Step No."}],He=s=>{const t=[];return s.forEach(o=>{typeof o=="object"&&!Array.isArray(o)?t.push(o):Array.isArray(o)&&t.push(...He(o))}),t},Nt=()=>{const s=je(st),t=Array.isArray(s)&&s.length>1,o=je(lt),r=t?o.multiStepSettings.btnSettings:{},{show:d,prevBtn:c,nextBtn:w}=r;return d?{[c.key]:$({},c),[w.key]:$({},w)}:{}},ke=s=>{var b;const t=je(Ne),o=$($({},t),Nt()),r=je(et),d=tt(o,[]),c=He(s.logics||[]),w=((b=s==null?void 0:s.actions)==null?void 0:b.fields)||[],A=[...c,...w].map(n=>n.field).filter(n=>n),j=d.filter(n=>n.type==="repeater").map(n=>n.key);let l="";if(j.forEach(n=>{r[n].lg.map(v=>v.i).some(v=>A.includes(v))&&(l=n)}),l){j.splice(j.indexOf(l),1);const n=j.reduce((k,m)=>{const v=r[m].lg.map(h=>h.i);return[...k,...v]},[]);return d.filter(k=>!n.includes(k.key)&&!j.includes(k.key))}return d};function gt({action:s,lgcGrp:t,lgcGrpInd:o,actionInd:r,condGrpInd:d,actionType:c,formFields:w}){var X,P,re,de,me,pe,he;const A=z(Q),j=H(Ne),l=z(Y),{css:b}=L();let n="",k="";w!==null&&w.map(O=>{O.key===s.field&&(k=O.type,n=O.key)});const m=()=>{var p,M,R,I,Z,G,q,ae;if(k==="razorpay")return;let O;if(O=(M=(p=j==null?void 0:j[n])==null?void 0:p.opt)==null?void 0:M.map(E=>({label:E.lbl,value:E.val||E.lbl})),k==="select"){const{optionsList:E}=(j==null?void 0:j[n])||{};if(s.action==="value")return E.reduce((T,le)=>{const ee=Object.keys(le)[0],ue=Object.values(le)[0];return T.push({type:"group",title:ee,childs:ue.map(fe=>({label:fe.lbl,value:fe.val||fe.lbl}))}),T},[]);if(s.action==="activelist")return E.reduce((T,le)=>{const ee=Object.keys(le)[0];return T.push({label:ee,value:ee}),T},[])}if(["decision-box","gdpr"].includes(k)){const E=j==null?void 0:j[n];return[{label:(R=E==null?void 0:E.msg)==null?void 0:R.checked,value:(I=E==null?void 0:E.msg)==null?void 0:I.checked},{label:(Z=E==null?void 0:E.msg)==null?void 0:Z.unchecked,value:(G=E==null?void 0:E.msg)==null?void 0:G.unchecked}]}return O||(O=(ae=(q=j==null?void 0:j[n])==null?void 0:q.options)==null?void 0:ae.map(E=>({label:E.lbl,value:E.val||E.code||E.i||E.lbl}))),O},y=O=>{A(p=>W(p,M=>{const{fields:R}=M[o].conditions[d].actions;R[r].action=O})),l(p=>B($({},p),{unsaved:!0}))},v=O=>{A(p=>W(p,M=>{const{fields:R}=M[o].conditions[d].actions;R[r].val=O})),l(p=>B($({},p),{unsaved:!0}))},h=O=>{A(p=>W(p,M=>{const{fields:R}=M[o].conditions[d].actions;R[r].field=O,R[r].val=""})),l(p=>B($({},p),{unsaved:!0}))},g=()=>{A(O=>W(O,p=>{const{fields:M}=p[o].conditions[d].actions;M.length>1&&M.splice(r,1)})),l(O=>B($({},O),{unsaved:!0}))},_=((X=j[s.field])==null?void 0:X.typ)||"",x=((P=j[s.field])==null?void 0:P.typ)!=="file-up"&&((re=j[s.field])==null?void 0:re.typ)!=="advanced-file-up",a=((de=j[s.field])==null?void 0:de.typ)!=="button",u=((me=j[s.field])==null?void 0:me.typ)==="title",f=c!=="onsubmit",C=c!=="onvalidate",F=["decision-box","gdpr"].includes((pe=j[s.field])==null?void 0:pe.typ),N=vt.includes((he=j[s.field])==null?void 0:he.typ),S=s.field==="_bf_form";return e.jsxs("div",{className:"flx pos-rel btcd-logic-blk",children:[e.jsxs(ce,{label:"Form Fields",value:s.field||"",onChange:O=>h(O.target.value),style:{width:720},children:[e.jsx("option",{value:"",children:i("Select One")}),w.map(O=>e.jsx("option",{value:O.key,children:O.name},`ff-Ab-${O.key}`)),yt.map(O=>e.jsx("option",{value:O.key,children:O.name},`ff-Ab-${O.key}`))]}),e.jsx("div",{className:b({w:100,flx:"align-center",h:35,mt:5}),children:e.jsx("div",{className:b({w:"100%",bd:"#b9c5ff",h:"0.5px"})})}),e.jsxs(ce,{label:"Action",onChange:O=>y(O.target.value),value:s.action||"",style:{width:400},className:"w-4",children:[e.jsx("option",{value:"",children:i("Select One")}),S&&e.jsx("option",B($({value:"save_draft"},!be&&{disabled:!0}),{children:i(`Save Draft ${be?"":"(PRO)"}`)})),!S&&e.jsxs(e.Fragment,{children:[!a&&t.action_type==="oninput"&&e.jsx("option",{value:"click",children:i("Click")}),x&&a&&C&&e.jsx("option",{value:"value",children:i("Value")}),f&&C&&e.jsx("option",{value:"enable",children:i("Enable")}),f&&C&&e.jsx("option",{value:"disable",children:i("Disable")}),f&&C&&x&&a&&e.jsx("option",{value:"readonly",children:i("Readonly")}),f&&C&&x&&a&&e.jsx("option",{value:"writeable",children:i("Writeable")}),f&&C&&e.jsx("option",{value:"hide",children:i("Hide")}),f&&C&&e.jsx("option",{value:"show",children:i("Show")}),c==="onvalidate"&&e.jsx("option",{value:"required",children:i("Required")}),c==="onvalidate"&&e.jsx("option",{value:"notrequired",children:i("Not Required")}),_==="select"&&e.jsx("option",{value:"activelist",children:i("Active List")}),f&&C&&x&&a&&e.jsx("option",{value:F?"ct":"lbl",children:i("Label")}),f&&C&&x&&a&&e.jsx("option",{value:"sub-titl",children:i("Sub Title")}),N&&e.jsx("option",{value:"placeholder",children:i("Placeholder")}),f&&C&&x&&a&&!u&&e.jsx("option",{value:"hlp-txt",children:i("Helper Text")}),u&&e.jsx("option",{value:"title",children:i("Title")})]})]}),["value","activelist","lbl","ct","sub-titl","hlp-txt","title","placeholder"].includes(s.action)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:b({w:100,flx:"align-center",h:35,mt:5}),children:e.jsx("div",{className:b({w:"100%",bd:"#b9c5ff",h:"0.5px"})})}),e.jsx(Je,{label:"Value",type:k.match(/select|check|radio|number|range|hidden/g)?"text":k,onChange:v,value:s.val||"",options:m(),formFields:w})]}),e.jsx("div",{className:"btcd-li-side-btn",children:e.jsx(J,{onClick:g,icn:!0,className:"ml-2 sh-sm white",children:e.jsx(ge,{})})})]})}function Ct({lgcGrp:s,lgcGrpInd:t,condGrp:o,condGrpInd:r}){const{css:d}=L(),[c,w]=se(Q),A=z(Y),{fields:j}=o.actions,l=()=>{const b=W(c,n=>{const{fields:k}=n[t].conditions[r].actions;let m="disable";n[t].action_type==="onsubmit"&&(m="value"),k.push({field:"",action:m})});w(b),A(n=>B($({},n),{unsaved:!0}))};return e.jsxs("div",{className:d(U.mt2),children:[e.jsx("div",{className:d(At.title),children:e.jsx("b",{className:"txt-dp",children:"Field Actions"})}),j.map((b,n)=>e.jsx("div",{className:`mt-2 ${o.cond_type==="always"&&"ml-4"}`,children:e.jsx(gt,{lgcGrp:s,lgcGrpInd:t,condGrpInd:r,action:b,actionInd:n,actionType:s.action_type,formFields:ke(o)})},`atn-${n+22}`)),e.jsx(oe,{msg:"Add More",children:e.jsx(J,{onClick:()=>l(),icn:!0,className:`blue sh-sm mt-2 ${o.cond_type==="always"&&"ml-4"}`,children:e.jsx(D,{size:"14",className:"icn-rotate-45"})})})]})}const At={title:{mb:7},chip:{mnh:30,dy:"flex !important",ai:"center",w:60,mt:9,mb:9}};function _t({lgcGrpInd:s,condGrpInd:t,enableAction:o,checkKeyInArr:r,getValueFromArr:d}){const{css:c}=L(),[w,A]=se(Q),j=z(Y),l=H(ot),b=n=>{const k=W(w,m=>{const{success:y}=m[s].conditions[t].actions,v=y.find(h=>h.type==="integ");v&&(v.details.id=n.map(h=>h.value))});A(k),j(m=>B($({},m),{unsaved:!0}))};return e.jsxs("div",{className:c(U.mt2),children:[e.jsx(ye,{onChange:n=>o(n.target.checked,"integ"),title:i("Integration"),checked:r("integ"),className:c(U.flxc)}),r("integ")&&e.jsx(ie,{action:n=>b(n),jsonValue:!0,value:d("integ","id"),titleClassName:c({mt:5,ml:28,w:"67.5%"}),className:"w-10",isMultiple:be,options:l==null?void 0:l.map((n,k)=>({label:n.name,value:n.id?JSON.stringify({id:String(n.id)}):JSON.stringify({index:String(k)})})),placeholder:i("Select Integation")})]})}function Ft({lgcGrpInd:s,condGrpInd:t,enableAction:o,checkKeyInArr:r,getValueFromArr:d}){var n,k;const{css:c}=L(),[w,A]=se(Q),j=z(Y),l=H(Be),b=m=>{const y=W(w,v=>{const{success:h}=v[s].conditions[t].actions,g=h.find(_=>_.type==="redirectPage");g&&(g.details.id=m)});A(y),j(v=>B($({},v),{unsaved:!0}))};return e.jsxs("div",{className:c(U.mt2),children:[e.jsx(ye,{onChange:m=>o(m.target.checked,"redirectPage"),title:i("Redirect URL"),checked:r("redirectPage"),className:c(U.flxc)}),r("redirectPage")&&e.jsx("div",{className:c({mt:5,ml:28}),children:e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:m=>b(m.target.value),value:d("redirectPage","id"),children:[e.jsx("option",{value:"",children:i("Select Page To Redirect")}),(k=(n=l==null?void 0:l.type)==null?void 0:n.redirectPage)==null?void 0:k.map((m,y)=>e.jsx("option",{value:m.id?JSON.stringify({id:String(m.id)}):JSON.stringify({index:String(y)}),children:m.title},`sr-${y+2.5}`))]})})]})}function St({lgcGrpInd:s,condGrpInd:t,enableAction:o,checkKeyInArr:r,getValueFromArr:d}){var n,k;const{css:c}=L(),[w,A]=se(Q),j=z(Y),l=H(Be),b=m=>{const y=W(w,v=>{const{success:h}=v[s].conditions[t].actions,g=h.find(_=>_.type==="successMsg");g&&(g.details.id=m)});A(y),j(v=>B($({},v),{unsaved:!0}))};return e.jsxs("div",{className:c(U.mt2),children:[e.jsx(ye,{onChange:m=>o(m.target.checked,"successMsg"),title:i("Success Message"),checked:r("successMsg"),className:c(U.flxc)}),r("successMsg")&&e.jsx("div",{className:c({mt:5,ml:28}),children:e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:m=>b(m.target.value),value:d("successMsg","id"),children:[e.jsx("option",{value:"",children:i("Select Message")}),(k=(n=l==null?void 0:l.type)==null?void 0:n.successMsg)==null?void 0:k.map((m,y)=>e.jsx("option",{value:m.id?JSON.stringify({id:String(m.id)}):JSON.stringify({index:String(y)}),children:m.title},`sm-${y+2.3}`))]})})]})}function $t({lgcGrpInd:s,condGrp:t,condGrpInd:o}){var l,b;const[r,d]=se(Q),c=z(Y),w=H(Be),{failure:A}=t.actions,j=n=>{const k=W(r,m=>{m[s].conditions[o].actions.failure=n});d(k),c(m=>B($({},m),{unsaved:!0}))};return e.jsxs(ce,{onChange:n=>j(n.target.value),value:A,label:"Error Message",className:"w-7 mt-3",children:[e.jsx("option",{value:"",children:i("Select Message")}),(b=(l=w==null?void 0:w.type)==null?void 0:l.successMsg)==null?void 0:b.map((n,k)=>e.jsx("option",{value:n.id?JSON.stringify({id:String(n.id)}):JSON.stringify({index:String(k)}),children:n.title},`vm-${k+2.7}`))]})}function De({lgcGrp:s,lgcGrpInd:t,condGrp:o,condGrpInd:r}){const{css:d}=L(),[c,w]=se(Q),A=z(Y),{success:j}=o.actions,l=(m,y)=>{const v=W(c,h=>{const{success:g}=h[t].conditions[r].actions;if(m)y==="mailNotify"?g.push({type:y,details:{}}):y==="dblOptin"?g.push({type:y,details:{}}):g.push({type:y,details:{id:""}});else for(let _=0;_<g.length;_+=1)if(g[_].type===y){g.splice(_,1);break}});w(v),A(h=>B($({},h),{unsaved:!0}))},b=m=>j==null?void 0:j.some(y=>y.type===m),n=m=>{const y=W(c,v=>{const{actions:h}=v[t].conditions[r];h.avoid_delete=m});w(y),A(v=>B($({},v),{unsaved:!0}))},k=(m,y)=>{const v=j.find(h=>h.type===m);return v!==void 0?v.details[y]:""};return e.jsxs(e.Fragment,{children:[s.action_type!=="onvalidate"&&s.action_run!=="delete"&&e.jsx(Ct,{lgcGrp:s,lgcGrpInd:t,condGrp:o,condGrpInd:r}),(s.action_type==="onsubmit"||s.action_run==="delete")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:d(U.mt3,U.mb1),children:e.jsx("b",{className:"txt-dp",children:"Additional Actions"})}),e.jsxs("div",{className:o.cond_type==="always"?"ml-4":"",children:[s.action_run!=="delete"&&e.jsx(St,{lgcGrpInd:t,condGrpInd:r,enableAction:l,checkKeyInArr:b,getValueFromArr:k}),!s.action_run.match(/^(delete|edit)$/)&&e.jsx(Ft,{lgcGrpInd:t,condGrpInd:r,enableAction:l,checkKeyInArr:b,getValueFromArr:k}),s.action_run!=="delete"&&e.jsx(_t,{lgcGrpInd:t,condGrpInd:r,enableAction:l,checkKeyInArr:b,getValueFromArr:k}),e.jsx(Pe,{title:i("Email Notification"),lgcGrpInd:t,condGrpInd:r,actionKey:"mailNotify",enableAction:l,checkKeyInArr:b,getValueFromArr:k}),e.jsx(Pe,{title:i("Double Opt-in"),lgcGrpInd:t,condGrpInd:r,actionKey:"dblOptin",enableAction:l,checkKeyInArr:b,getValueFromArr:k})]})]}),s.action_run==="delete"&&e.jsx(K,{className:d({mt:5,ml:o.cond_type==="always"?12:-8}),onChange:m=>n(m.target.checked),checked:c[t].avoid_delete,title:e.jsx("small",{className:"txt-dp",children:"Prevent Delete"})}),s.action_type==="onvalidate"&&s.action_run!=="delete"&&e.jsx($t,{lgcGrpInd:t,condGrp:o,condGrpInd:r})]})}const Bt={change:{label:i("Change"),notFields:["button","user"]},equal:{label:i("Equal"),notFields:["button","repeater"]},not_equal:{label:i("Not Equal"),notFields:["button","user","repeater"]},null:{label:i("Is Null"),notFields:["button","user","repeater"]},not_null:{label:i("Is Not Null"),notFields:["button","user","repeater"]},contain:{label:i("Contain"),notFields:["button","date","time","datetime-local","month","week","user","repeater"]},contain_all:{label:i("Contain All"),fields:["select"]},not_contain:{label:i("Not Contain"),notFields:["button","date","time","datetime-local","month","week","user","repeater"]},greater:{label:i("Greater Than"),fields:["number","date","time","datetime-local"]},less:{label:i("Less Than"),fields:["number","date","time","datetime-local"]},greater_or_equal:{label:i("Greater Than or Equal"),fields:["number","date","time","datetime-local"]},less_or_equal:{label:i("Less Than or Equal"),fields:["number","date","time","datetime-local"]},start_with:{label:i("Start With"),notFields:["button","color","url","password","email","date","time","datetime-local","month","week","user","repeater"]},end_with:{label:i("End With"),notFields:["button","color","url","password","email","date","time","datetime-local","month","week","user","repeater"]},between:{label:i("Between"),fields:["number","date","time","datetime-local"]},on_click:{label:i("On Click"),fields:["button.btnTyp:button","button.btnTyp:next-step","button.btnTyp:previuos-step"]}};function Fe({logic:s,fieldVal:t,delLogic:o,lgcInd:r,subLgcInd:d,subSubLgcInd:c,value:w,addInlineLogic:A,changeLogic:j,logicValue:l,changeValue:b,changeSmartKey:n,changeFormField:k,smartTagAllowed:m,formFields:y}){var P,re,de,me,pe,he,O;const{css:v}=L(),h=H(Ne);let g=!1,_="",x="",a="";(P=y==null?void 0:y.find)==null||P.call(y,p=>{if(p.key===t)return p.type.match(/^(check|radio|select|html-select|image-select|hidden)$/)?_="text":_=p.type,x=p.type,a=p.key,!0});const u=[{label:i("Logged In"),value:"logged_in"},{label:i("Logged Out"),value:"logged_out"}],f=()=>{var M,R,I,Z,G,q,ae,E;if(x==="razorpay")return;let p;if(x==="user"?p=u:p=(R=(M=h==null?void 0:h[a])==null?void 0:M.opt)==null?void 0:R.map(T=>({label:T.lbl,value:T.val||T.lbl})),x==="select"){const{optionsList:T}=(h==null?void 0:h[a])||{};return T.reduce((le,ee)=>{const ue=Object.keys(ee)[0],fe=Object.values(ee)[0];return le.push({type:"group",title:ue,childs:fe.map(Ce=>({label:Ce.lbl,value:Ce.val||Ce.lbl}))}),le},[])}if(["decision-box","gdpr"].includes(_)){const T=h==null?void 0:h[a];return[{label:(I=T==null?void 0:T.msg)==null?void 0:I.checked,value:(Z=T==null?void 0:T.msg)==null?void 0:Z.checked},{label:(G=T==null?void 0:T.msg)==null?void 0:G.unchecked,value:(q=T==null?void 0:T.msg)==null?void 0:q.unchecked}]}return p||(p=(E=(ae=h==null?void 0:h[a])==null?void 0:ae.options)==null?void 0:E.map(T=>({label:T.lbl,value:T.val||T.code||T.i||T.lbl}))),p},C=(p,M)=>M.find(R=>{if(R===p)return!0;if(!R.includes("."))return!1;const I=R.indexOf("."),Z=R.substring(0,I);if(p!==Z)return!1;const G=R.substring(I+1);if(!G)return!1;const[q,ae]=G.split(":"),E=q.split("."),T=y.find(ee=>ee.key===a)||{};return E.reduce((ee,ue)=>ee[ue],T)===ae}),F=p=>$e.find(M=>p===`\${${M.name}}`);_||(_=((re=F(t))==null?void 0:re.type)||""),g||(g=((de=F(t))==null?void 0:de.singleSelect)||!1);const N=p=>{var I;const M=((I=F(t))==null?void 0:I.type)||p;return M?Object.entries(Bt).reduce((Z,[G,q])=>q.notFields&&C(M,q.notFields)?Z:q.fields?C(M,q.fields)?[...Z,{key:G,lbl:q.label}]:Z:[...Z,{key:G,lbl:q.label}],[]):[]},S=p=>p==="${_bf_custom_date_format()}"?i("Date Format"):p==="${_bf_user_meta_key()}"?i("Meta Key"):p==="${_bf_query_param()}"?i("Query Param"):"Smart Key",X=["change","null","not_null","on_click"];return e.jsxs("div",{className:`${v(Re.lgcBlk)} btcd-logic-blk`,children:[e.jsxs("div",{className:v(Re.processDgrm),children:[e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(ce,{label:"Form Fields",value:t,onChange:p=>k(p.target.value,r,d,c),children:[e.jsx("option",{value:"",children:i("Select Form Field")}),!!y.length&&e.jsx("optgroup",{label:"Form Fields",children:y.map(p=>!at.includes(p.type)&&e.jsx("option",{value:p.key,children:p.name},`ff-lb-${p.key}`))}),m&&e.jsx("optgroup",{label:`General Smart Codes ${be?"":"(PRO)"}`,children:(me=$e)==null?void 0:me.map(({name:p,label:M})=>e.jsx("option",{value:`\${${p}}`,disabled:!be,children:M},`ff-rm-${p}`))})]})})}),((pe=F(t))==null?void 0:pe.functionParam)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(ce,{label:"Field Parameter",onChange:p=>n(p.target.value,r,d,c),value:s.smartKey||"",children:[e.jsx("option",{value:"",children:i("Select Form Field")}),!!y.length&&e.jsx("optgroup",{label:"Form Fields",children:y.map(p=>!p.type.match(/^(file-up|recaptcha)$/)&&e.jsx("option",{value:p.key,children:p.name},`ff-lb-${p.key}`))})]})})}),((he=F(t))==null?void 0:he.custom)&&!((O=F(t))!=null&&O.functionParam)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsx(_e,{label:S(t),type:"text",onChange:p=>n(p.target.value,r,d,c),value:s.smartKey||""})})}),e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(ce,{label:"Logic",value:l,onChange:p=>j(p.target.value,r,d,c),children:[e.jsx("option",{value:"",children:i("Select One")}),N(_).map(({key:p,lbl:M})=>e.jsx("option",{value:p,children:M},p))]})})}),l!=="between"&&l!=="not between"&&!X.includes(l)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:_.match(/user|select|check|radio/g)?e.jsx(Ae,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:w||"",onChange:p=>b(p,r,d,c),options:f(),fldType:_,singleSelect:g}):e.jsx(Je,{label:"Value",type:_.match(/select|check|radio|number|range/g)?"text":_,disabled:l==="null"||l==="not_null",onChange:p=>b(p,r,d,c),value:w||"",options:f(),formFields:y})})}),(l==="between"||l==="not between")&&e.jsx("div",{className:"block-wrapper",children:e.jsxs("div",{className:"block-group",children:[e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:x.match(/select|check|radio/g)?e.jsx(Ae,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:w.min||"",onChange:p=>b(p,r,d,c,"min"),options:f(),customValue:!0,fldType:x}):e.jsx(_e,{label:"Min Value",type:_,disabled:l==="null"||l==="not_null",onChange:p=>b(p.target.value,r,d,c,"min"),value:w.min||""})})}),e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:x.match(/select|check|radio/g)?e.jsx(Ae,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:w.max||"",onChange:p=>b(p,r,d,c,"max"),options:f(),customValue:!0,fldType:x}):e.jsx(_e,{label:"Max Value",type:_,disabled:l==="null"||l==="not_null",onChange:p=>b(p.target.value,r,d,c,"max"),value:w.max||""})})})]})})]}),e.jsxs("div",{className:"btcd-li-side-btn",children:[e.jsx(J,{onClick:()=>o(r,d,c),icn:!0,className:"ml-2 white mr-2 sh-sm",children:e.jsx(ge,{size:"16"})}),e.jsxs(J,{onClick:()=>A("and",r,d,c),className:"white mr-2 sh-sm",children:[e.jsx(D,{size:"10",className:"icn-rotate-45 mr-1"}),"AND"]}),e.jsxs(J,{onClick:()=>A("or",r,d,c),className:"white sh-sm",children:[e.jsx(D,{size:"10",className:"icn-rotate-45 mr-1"}),"OR"]})]})]})}const Re={lgcBlk:{pn:"relative",dy:"flex",cg:15,rg:15,my:5,":hover":{bc:"#F0F0F0"}},lgcGrp:{b:"0.5px solid #D5D5D5",brs:8,p:10,ml:20},blkItm:{w:"100%"},processDgrm:{"--linethick":"1px","--linewidth":"1.5em","--line-color":"#b9c5ff",flx:"align-center",w:"100%",m:0,p:0,ls:"none",ta:"center","& > .block-wrapper":{flex:"1 1 auto"},"& .block-wrapper>.block-content":{cr:"#666",brs:10},"& .block-wrapper::before, & .block-wrapper::after, & .block-group::before, & .block-group::after, & .block-content::before, & .block-content::after":{bse:"solid",bcr:"var(--line-color)"},"& .block-wrapper .block-group .block-wrapper:first-child .block-content::before, &  .block-wrapper .block-group .block-wrapper:first-child::before":{btlr:10},"&  .block-wrapper .block-group .block-wrapper:first-child .block-content::after, & .block-wrapper .block-group .block-wrapper:first-child::after":{btrr:10},"&  .block-wrapper .block-group .block-wrapper:last-child .block-content::before, &  .block-wrapper .block-group .block-wrapper:last-child::before":{bblr:10},"&  .block-wrapper .block-group .block-wrapper:last-child .block-content::after, &  .block-wrapper .block-group .block-wrapper:last-child::after":{bbrr:10},"& ol, & .block-group, & .block-wrapper":{ls:"none",ta:"center"},"& .block-wrapper":{pn:"relative",mb:0,w:"100%"},"& > .block-wrapper, & ol > .block-wrapper, & .block-group > .block-wrapper":{p:"4px 0"},"&  .block-group":{pn:"relative",pl:"var(--linewidth)"},"& .block-group::before, &  .block-group::after":{pn:"absolute",ct:'""',tp:"50%",w:"var(--linewidth)",dy:"block",bwh:"var(--linethick) 0 0"},"& .block-group::before":{lt:0},"&  .block-group::after":{rt:0},"&  .block-group>.block-wrapper::after, &  .block-group>.block-wrapper::before":{pn:"absolute",ct:'""',tp:0,bm:0,w:"var(--linewidth)",h:"100%",dy:"block"},"&  .block-group>.block-wrapper::before":{lt:0,bwh:"0 0 0 var(--linethick)"},"&  .block-group>.block-wrapper::after":{rt:0,bwh:"0 var(--linethick) 0 0"},"&  .block-group>.block-wrapper:first-child::before, &  .block-group>.block-wrapper:first-child::after":{tp:"50%",bm:"auto",h:"50%"},"&  .block-group>.block-wrapper:last-child::before, &  .block-group>.block-wrapper:last-child::after":{tp:0,bm:"auto",h:"50%"},"&  .block-group>.block-wrapper:first-child:last-child::before, &  .block-group>.block-wrapper:first-child:last-child::after":{tp:0,bm:"auto",h:"50%"},"&  .block-wrapper>.block-content":{pn:"relative",ml:"var(--linewidth)"},"& >.block-wrapper:first-child>.block-content":{ml:0},"&  .block-wrapper:not(:last-child) .block-wrapper>.block-content":{mr:"var(--linewidth)"},"&  .block-wrapper>.block-content::before, &  .block-wrapper>.block-content::after":{ct:'""',tp:"50%",w:"var(--linewidth)",pn:"absolute",bwh:"var(--linethick) 0 0",h:"50%"},"&  .block-wrapper>.block-content::after":{rt:"calc(0em - var(--linewidth) + 2px)",mr:"calc(0px - var(--linethick))"},"&  .block-wrapper>.block-content::before":{lt:"calc(0em - var(--linewidth) + 2px)",ml:"calc(0px - var(--linethick))"},"&  .block-wrapper:last-child>.block-content::after, & .block-wrapper:last-child>.block-content::before":{tp:0,bwh:"0 0 var(--linethick)"},"& >.block-wrapper:first-child>.block-content::before, & >.block-wrapper:first-child>.block-group::before, & >.block-wrapper:first-child>.block-group>.block-wrapper::before, & >.block-wrapper:first-child>.block-group>.block-wrapper>.block-content:first-child::before, & >.block-wrapper:first-child>.block-group>.block-wrapper>ol>.block-wrapper:first-child>.block-content::before, & >.block-wrapper:last-child>.block-content::after, & >.block-wrapper:last-child>.block-group::after":{b:0},"& >.block-wrapper>.block-content::after,  &  ol>.block-wrapper>.block-content::after, & >.block-wrapper>.block-group::after,  &  ol>.block-wrapper>.block-group::after":{dy:"none"},"& >.block-wrapper>.block-content, &  ol>.block-wrapper>.block-content":{mr:0},"& >.block-wrapper>.block-group,  &  ol>.block-wrapper>.block-group":{pr:0},"& >.block-wrapper:last-child>.block-content::after,  &  ol>.block-wrapper:last-child>.block-content::after,  & >.block-wrapper:last-child>.block-group::after,  &  ol>.block-wrapper:last-child>.block-group::after":{dy:"block"},"& >.block-wrapper:last-child>.block-content, & ol>.block-wrapper:last-child>.block-content":{mr:0},"&  .block-wrapper:last-child>.block-group::after,  &  .block-wrapper:last-child>.block-group>.block-wrapper::after,  &  .block-wrapper:last-child>.block-group>.block-wrapper>.block-content::after":{dy:"none"}}};function Se({logic:s,nested:t,onChange:o,className:r=null}){return e.jsx("div",{children:e.jsxs("select",{value:s,onChange:o,className:`btcd-logic-chip ${r} ${t&&"scl-8"}`,children:[e.jsx("option",{value:"or",children:i("OR")}),e.jsx("option",{value:"and",children:i("AND")})]})})}function Ot({lgcGrp:s,lgcGrpInd:t,condGrp:o,condGrpInd:r}){var x;const{css:d}=L(),[c,w]=se(Q),A=z(Y),j=H(Ne),l=(a,u,f)=>{const C=W(c,F=>{const N=F[t].conditions[r].logics;if(N.length>1)if(f!==void 0)if(N[a][u].length===f+1)if(N[a][u].length===3){const S=N[a][u][f-2];N[a].splice(u,1),N[a].push(S)}else N[a][u].splice(f-1,2);else if(N[a][u].length===3){const S=N[a][u][f+2];N[a].splice(u,1),N[a].push(S)}else N[a][u].splice(f,2);else if(u!==void 0)if(N[a].length===u+1)if(N[a].length===3){const S=N[a][u-2];N.splice(a,1),N.splice(a,0,S)}else N[a].splice(u-1,2);else if(N[a].length===3){const S=N[a][u+2];N.splice(a,1),N.splice(a,0,S)}else N[a].splice(u,2);else a!==0?N.splice(a-1,2):N.splice(a,2)});w(C),A(F=>B($({},F),{unsaved:!0}))},b=(a,u,f,C)=>{const F=W(c,N=>{const S=N[t].conditions[r].logics;C!==void 0?(a==="null"&&(S[u][f][C].val=""),S[u][f][C].logic=a):f!==void 0?(a==="null"&&(S[u][f].val=""),S[u][f].logic=a):(a==="null"&&(S[u].val=""),S[u].logic=a)});w(F),A(N=>B($({},N),{unsaved:!0}))},n=(a,u,f,C)=>{const F=W(c,N=>{const S=N[t].conditions[r].logics;C!==void 0?S[u][f][C]=a:f!==void 0?S[u][f]=a:S[u]=a});w(F),A(N=>B($({},N),{unsaved:!0}))},k=(a,u,f,C)=>C!==void 0?a[u][f][C]:f!==void 0?a[u][f]:a[u],m=(a,u,f,C,F="")=>{const N=W(c,S=>{const X=S[t].conditions[r].logics,P=k(X,u,f,C);F?(typeof P.val=="string"&&(P.val={}),P.val[F]=a):P.val=a});w(N),A(S=>B($({},S),{unsaved:!0}))},y=(a,u,f,C)=>{const F=$e.find(S=>S.name===a),N=W(c,S=>{const X=S[t].conditions[r].logics,P=k(X,u,f,C);P.field=a,P.val="",F!=null&&F.custom||delete P.smartKey});w(N),A(S=>B($({},S),{unsaved:!0}))},v=(a,u,f,C)=>{const F=W(c,N=>{const S=N[t].conditions[r].logics;C!==void 0?S[u][f].splice(C+1,0,a,{field:"",logic:"",val:""}):f!==void 0?S[u].splice(f+1,0,a,{field:"",logic:"",val:""}):S.splice(u+1,0,a,{field:"",logic:"",val:""})});w(F),A(N=>B($({},N),{unsaved:!0}))},h=(a,u,f,C)=>{const F=W(c,N=>{const S=N[t].conditions[r].logics,X=k(S,u,f,C);X.smartKey=a});w(F),A(N=>B($({},N),{unsaved:!0}))},g=(a,u)=>{if(s.action_type!=="oninput")return!0;const f=a.findIndex(C=>C.field&&C.field in j);return f>=0&&f!==u},_=(a,u,f=0)=>{const C=[a],F={field:"",logic:"",val:""};f?C.push([F,a,F]):C.push(F),w(N=>W(N,S=>{const{logics:X}=N[t].conditions[r],P=[...X[u],...C];S[t].conditions[r].logics[u]=P}))};return(x=o==null?void 0:o.logics)==null?void 0:x.map((a,u)=>e.jsxs("span",{children:[typeof a=="object"&&!Array.isArray(a)&&e.jsx(Fe,{logic:a,fieldVal:a.field,changeFormField:y,changeValue:m,changeSmartKey:h,logicValue:a.logic,changeLogic:b,addInlineLogic:v,delLogic:l,lgcGrpInd:t,lgcInd:u,value:a.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:g(o.logics,u),formFields:ke(o)}),typeof a=="string"&&e.jsx(Se,{logic:a,onChange:f=>n(f.target.value,u)}),Array.isArray(a)&&e.jsxs("div",{className:"p-2 br-10 btcd-logic-grp mt-2 mb-2 pl-4 pr-4",children:[a.map((f,C)=>e.jsxs("span",{children:[typeof f=="object"&&!Array.isArray(f)&&e.jsx(Fe,{logic:f,fieldVal:f.field,changeFormField:y,changeValue:m,changeSmartKey:h,logicValue:f.logic,changeLogic:b,addInlineLogic:v,delLogic:l,lgcGrpInd:t,lgcInd:u,subLgcInd:C,value:f.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:g(a,C),formFields:ke(o)}),typeof f=="string"&&e.jsx(Se,{logic:f,nested:!0,onChange:F=>n(F.target.value,u,C)}),Array.isArray(f)&&e.jsxs("div",{className:"p-2 br-10 btcd-logic-grp mt-2 mb-2 pl-4 pr-4",children:[f.map((F,N)=>e.jsxs("span",{children:[typeof F=="object"&&!Array.isArray(F)&&e.jsx(Fe,{logic:F,fieldVal:F.field,changeFormField:y,changeValue:m,changeSmartKey:h,logicValue:F.logic,changeLogic:b,addInlineLogic:v,delLogic:l,lgcGrpInd:t,lgcInd:u,subLgcInd:C,subSubLgcInd:N,value:F.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:g(f,N),formFields:ke(o)}),typeof F=="string"&&e.jsx(Se,{logic:F,nested:!0,onChange:S=>n(S.target.value,u,C,N)})]},`subsubLogic-${N+90}`)),e.jsxs(ve,{place:"bottom",children:[e.jsx(oe,{msg:"Add Logic",children:e.jsx(J,{icn:!0,className:"blue sh-sm",children:e.jsx(D,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:d(ne.addItemBtn),onClick:()=>v("and",u,C,f.length),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:d(ne.addItemBtn),onClick:()=>v("or",u,C,f.length),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]})]})]})]})]},`subLogic-${C*7}`)),e.jsxs(ve,{place:"bottom",children:[e.jsx(oe,{msg:"Add Logic",children:e.jsx(J,{icn:!0,className:"blue sh-sm",children:e.jsx(D,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:d(ne.addItemBtn),onClick:()=>_("and",u),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:d(ne.addItemBtn),onClick:()=>_("or",u),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]}),e.jsxs("button",{type:"button",className:d(ne.addItemBtn),onClick:()=>_("and",u,1),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND Group"]}),e.jsxs("button",{type:"button",className:d(ne.addItemBtn),onClick:()=>_("or",u,1),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR Group"]})]})]})]})]},`logic-${u+44}`))}const ne={addItemBtn:{dy:"block",w:"100%",b:0,oe:0,brs:8,ta:"left",cr:"#444",fs:12,fw:500,p:5,pr:20,bd:"none",curp:1,":hover":{bc:"#EFEFEF"}}};function Tt({lgcGrpInd:s,lgcGrp:t}){var j;const{css:o}=L(),r=z(Q),d=z(Y),c=l=>l.replace(/-/g," ").split(" ").map(b=>it(b)).join(" "),w=l=>{Ee(),r(b=>W(b,n=>{const{conditions:k}=n[s],m=B($({},xe),{cond_type:l});l==="else"&&delete m.logics,l==="else-if"&&k[k.length-1].cond_type==="else"?k.splice(k.length-1,0,m):k.push(m)})),d(b=>B($({},b),{unsaved:!0}))},A=(l,b,n="",k=0)=>{Ee();const m=[l],y={field:"",logic:"",val:""};k?m.push([y,l,y]):m.push(y),r(v=>W(v,h=>{let g=h[s].conditions[b].logics;g=wt(g,n),g.push(...m)})),d(v=>B($({},v),{unsaved:!0}))};return e.jsxs("div",{className:o(te.container),children:[e.jsxs("div",{className:o(te.section),children:[t.action_behaviour==="cond"&&e.jsxs("div",{className:o(te.sideBdr),children:[e.jsx("div",{className:o(te.sideBdrLn)}),e.jsx("div",{className:o(te.sideBdrCrl)})]}),(j=t==null?void 0:t.conditions)==null?void 0:j.map((l,b)=>e.jsxs(we.Fragment,{children:[t.action_behaviour==="cond"&&l.cond_type!=="else"&&e.jsxs(Me,{title:c(l.cond_type),accordionActions:l.cond_type!=="if"&&e.jsx(ze,{lgcGrpInd:s,condGrpInd:b}),children:[e.jsx(Ot,{lgcGrp:t,lgcGrpInd:s,condGrp:l,condGrpInd:b}),e.jsx("div",{className:"mt-1",children:e.jsxs(ve,{place:"bottom",children:[e.jsx(oe,{msg:"Add Logic",children:e.jsx(J,{icn:!0,className:"blue sh-sm",children:e.jsx(D,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:o(te.addItemBtn),onClick:()=>A("and",b),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:o(te.addItemBtn),onClick:()=>A("or",b),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]}),e.jsxs("button",{type:"button",className:o(te.addItemBtn),onClick:()=>A("and",b,"",1),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND Group"]}),e.jsxs("button",{type:"button",className:o(te.addItemBtn),onClick:()=>A("or",b,"",1),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR Group"]})]})]})})]},l.cond_type+0),t.action_behaviour==="cond"&&e.jsx(Me,{title:l.cond_type==="else"?"Else":"Then",titleOutline:l.cond_type!=="else",accordionActions:l.cond_type==="else"&&e.jsx(ze,{lgcGrpInd:s,condGrpInd:b,add:!1,clone:!1}),children:e.jsx(De,{lgcGrp:t,lgcGrpInd:s,condGrp:l,condGrpInd:b})},l.cond_type+1),t.action_behaviour!=="cond"&&e.jsx(De,{lgcGrp:t,lgcGrpInd:s,condGrp:l,condGrpInd:b})]},`wkf-${b+99}`))]}),t.action_behaviour==="cond"&&e.jsxs(ve,{place:"bottom",children:[e.jsx(oe,{msg:"Add Condition",children:e.jsx(J,{icn:!0,className:"blue sh-sm ml-2",children:e.jsx(D,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:o(te.addItemBtn),onClick:()=>w("else-if"),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add Else If"]}),t.conditions[t.conditions.length-1].cond_type!=="else"&&e.jsxs("button",{type:"button",className:o(te.addItemBtn),onClick:()=>w("else"),children:[e.jsx(D,{size:"9",className:"icn-rotate-45 mr-1"}),"Add Else"]})]})]})]})}const ze=({lgcGrpInd:s,condGrpInd:t,add:o,clone:r,remove:d})=>{const[c,w]=we.useState({show:!1}),A=z(Q),j=z(Y),l=()=>{w({show:!1})},b=()=>{w({show:!1}),A(v=>W(v,h=>{h[s].conditions.splice(t,1)})),j(v=>B($({},v),{unsaved:!0}))},n=()=>{w({btnTxt:"Delete",body:"Are you sure to delete this logic?",btnClass:"",action:()=>{b(),l()},show:!0})},k=()=>{A(v=>W(v,h=>{h[s].conditions.splice(t+1,0,ct(h[s].conditions[t]))})),j(v=>B($({},v),{unsaved:!0}))},m=()=>{A(v=>W(v,h=>{h[s].conditions.splice(t+1,0,B($({},xe),{cond_type:"else-if"}))})),j(v=>B($({},v),{unsaved:!0}))},y=v=>typeof v=="boolean"?v:!0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[y(o)&&e.jsx(oe,{msg:"Add Else If",children:e.jsx(J,{onClick:m,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(kt,{size:"16"})})}),y(r)&&e.jsx(oe,{msg:"Clone",children:e.jsx(J,{onClick:k,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(nt,{size:"16"})})}),y(d)&&e.jsx(oe,{msg:"Delete",children:e.jsx(J,{onClick:n,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(ge,{size:"16"})})})]}),e.jsx(qe,{show:c.show,close:l,btnTxt:c.btnTxt,btnClass:c.btnClass,body:c.body,action:c.action})]})},te={container:{mt:10},section:{pn:"relative",w:"100%",zx:1,mb:10,pb:10},sideBdr:{flx:"center",fd:"column",w:50,pn:"absolute",h:"100%",zx:-1},sideBdrLn:{w:2,bc:"var(--b-50)",h:"100%"},sideBdrCrl:{brs:"50%",bc:"var(--b-50)",h:8,w:8,mt:-1},addItemBtn:{dy:"block",w:"100%",b:0,oe:0,brs:8,ta:"left",cr:"#444",fs:12,fw:500,p:5,pr:20,bd:"none",curp:1,":hover":{bc:"#EFEFEF"}}};function Wt({lgcGrpInd:s,lgcGrp:t}){var j;const[o,r]=se(Q),d=z(Y),c=l=>{const b=W(o,n=>{l==="delete"?delete n[s].action_type:n[s].action_type===void 0&&(n[s].action_type="onload"),n[s].action_run=l});r(b),d(n=>B($({},n),{unsaved:!0}))},w=l=>{const b=W(o,n=>{l==="onsubmit"&&n[s].conditions.forEach(m=>{var v,h;const y=(h=(v=m.actions)==null?void 0:v.fields)==null?void 0:h.length;for(let g=0;g<y;g+=1)m.actions.fields[g].action="value"}),n[s].action_behaviour="cond",n[s].conditions.forEach(m=>{l==="onvalidate"?(m.actions.failure="",delete m.actions.fields,delete m.actions.success):(m.actions.fields=[{field:"",action:"value"}],m.actions.success=[],delete m.actions.failure)});const[k]=n[s].conditions;k.cond_type="if",k.logics||(k.logics=xe.logics),n[s].action_type=l});r(b),d(n=>B($({},n),{unsaved:!0}))},A=l=>{const b=W(o,n=>{n[s].action_behaviour=l;const[k]=n[s].conditions;k.cond_type=l==="cond"?"if":l,l==="always"?delete k.logics:l==="cond"&&(k.logics=xe.logics),n[s].conditions=[k]});r(b),d(n=>B($({},n),{unsaved:!0}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Run When:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[e.jsx(K,{radio:!0,onChange:l=>c(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Create/Edit")}),checked:t.action_run==="create_edit",value:"create_edit"}),e.jsx(K,{radio:!0,onChange:l=>c(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Create")}),checked:t.action_run==="create",value:"create"}),e.jsx(K,{radio:!0,onChange:l=>c(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Edit")}),checked:t.action_run==="edit",value:"edit"}),e.jsx(K,{radio:!0,onChange:l=>c(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Delete")}),checked:t.action_run==="delete",value:"delete"})]})]}),t.action_run!=="delete"&&e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Effect:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[e.jsx(K,{radio:!0,onChange:l=>w(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Always")}),checked:t.action_type==="always",value:"always"}),e.jsx(K,{radio:!0,onChange:l=>w(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Load")}),checked:t.action_type==="onload",value:"onload"}),e.jsx(K,{radio:!0,onChange:l=>w(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Field Input")}),checked:t.action_type==="oninput",value:"oninput"}),e.jsx(K,{radio:!0,onChange:l=>w(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Validate")}),checked:t.action_type==="onvalidate",value:"onvalidate"}),e.jsx(K,{radio:!0,onChange:l=>w(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Submit")}),checked:t.action_type==="onsubmit",value:"onsubmit"})]})]}),e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Behaviour:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[!((j=t==null?void 0:t.action_type)!=null&&j.match(/^(onvalidate|oninput)$/))&&e.jsx(K,{radio:!0,onChange:l=>A(l.target.value),name:`ab-${s+121}`,title:e.jsx("small",{className:"txt-dp",children:i("Always")}),checked:t.action_behaviour==="always",value:"always"}),e.jsx(K,{radio:!0,onChange:l=>A(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Condition")}),checked:t.action_behaviour==="cond",value:"cond"})]})]})]})}function Lt(){const s=H(rt),[t,o]=we.useState({show:!1}),[r,d]=se(Q),c=z(Y),{css:w}=L(),A=H(Ue),{isPro:j}=A,l=h=>{switch(h){case"onload":return i("On Load");case"oninput":return i("On Field Input");case"onvalidate":return i("On Form Validate");case"onsubmit":return i("On Form Submit");case"create_edit":return i("Record Create/Edit");case"create":return i("Record Create");case"edit":return i("Record Edit");case"delete":return i("Record Delete");case"always":return i("Always");case"cond":return i("With Condition")}},b=()=>{const h=W(r,g=>{g.unshift({title:`Action ${r.length+1}`,action_type:"always",action_run:"create_edit",action_behaviour:"cond",conditions:[$({},xe)]})});d(h),c(g=>B($({},g),{unsaved:!0}))},n=h=>{if(r[h].id){const g=dt({formID:s,id:r[h].id},"bitforms_delete_workflow").then(_=>{if(_!==void 0&&_.success){const x=W(r,a=>{a.splice(h,1)});d(x)}});mt.promise(g,{success:"Successfully Deleted.",loading:"Deleting...",error:"Error occurred, Try again."})}else{const g=W(r,_=>{_.splice(h,1)});d(g)}},k=(h,g)=>{const _=W(r,x=>{x[g].title=h.target.value});d(_),c(x=>B($({},x),{unsaved:!0}))},m=()=>{t.show=!1,o($({},t))},y=h=>{t.btnTxt="Delete",t.body="Are you sure to delete this conditional logic?",t.btnClass="",t.action=()=>{n(h),m()},t.show=!0,o($({},t))},v=({oldIndex:h,newIndex:g})=>{h!==g&&(d(_=>ft(_,h,g)),c(_=>B($({},_),{unsaved:!0})))};return e.jsxs("div",{className:"btcd-workflow",style:{width:"93%"},children:[e.jsx(qe,{show:t.show,close:m,btnTxt:t.btnTxt,btnClass:t.btnClass,body:t.body,action:t.action}),e.jsx("h2",{children:i("Conditional Logics")}),e.jsxs("h5",{children:["How to configure conditional logics:  ",e.jsx("a",{href:We.conditionalLogic.link,target:"_blank",rel:"noreferrer",className:"yt-txt ml-1 mr-1",children:"YouTube"}),e.jsx("a",{href:We.conditionalLogicDoc.link,target:"_blank",rel:"noreferrer",className:"doc-txt",children:"Documentation"})]}),(!j&&!r.length||j)&&e.jsxs(J,{className:"blue",onClick:b,children:[e.jsx(D,{size:"10",className:"icn-rotate-45 mr-1"}),i("Add Conditional Logic")]}),r.length===0&&e.jsxs("div",{className:w(U.btcdEmpty,U.txCenter),children:[e.jsx(bt,{size:"50"}),i("Empty")]}),e.jsx(pt,{onSortEnd:v,useDragHandle:!0,children:r.map((h,g)=>e.jsxs(ht,{index:g,children:[e.jsxs("div",{className:"workflow-grp d-flx mt-2",children:[e.jsxs(xt,{customTitle:e.jsx(ut,{className:"workflow-drg-handle mr-1 flx"}),title:h.title,header:e.jsxs("small",{className:"f-right txt-dp mr-4",children:[e.jsxs("span",{className:"mr-2",children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),l(h.action_run)]}),h.action_type!==void 0&&e.jsxs("span",{className:"mr-2",children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),l(h.action_type)]}),e.jsxs("span",{children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),l(h.action_behaviour)]})]}),titleEditable:!0,onTitleChange:_=>k(_,g),notScroll:!0,cls:j?"w-9":"w-10",children:[e.jsx(Wt,{lgcGrpInd:g,lgcGrp:h}),e.jsx(Tt,{lgcGrpInd:g,lgcGrp:h})]}),j&&e.jsx("div",{className:"mt-2",children:e.jsx(J,{onClick:()=>y(g),icn:!0,className:"ml-2 sh-sm btcd-menu-btn tooltip",style:{"--tooltip-txt":'"Delete Action"'},children:e.jsx(ge,{size:"16"})})})]}),!j&&e.jsxs("div",{className:"txt-center bg-pro p-5 mt-2",children:[i("For")," ",e.jsx("span",{className:"txt-pro",children:i("UNLIMITED")})," ",i("Conditional Logics"),", ",e.jsx("a",{href:"https://www.bitapps.pro/bit-form",target:"_blank",rel:"noreferrer",children:e.jsx("b",{className:"txt-pro",children:i("Buy Premium")})})]})]},`workflows-grp-${g+13}`))}),r.length>1&&e.jsxs("div",{className:w(U.w9,{fs:13},U.mt4),children:[e.jsx("strong",{children:"Note: "}),"Conditional Logics are triggered based on the order of the logic groups. The higher the logic group, the higher the priority. If you want to change the priority, you can sort by drag and drop the logic group."]})]})}export{Lt as default};
