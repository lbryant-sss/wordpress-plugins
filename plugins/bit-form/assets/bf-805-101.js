var q=Object.defineProperty;var N=Object.getOwnPropertySymbols;var O=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable;var U=(t,a,l)=>a in t?q(t,a,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[a]=l,r=(t,a)=>{for(var l in a||(a={}))O.call(a,l)&&U(t,l,a[l]);if(N)for(var l of N(a))b.call(a,l)&&U(t,l,a[l]);return t};import{_ as c,ae as A,$ as w,c as F,c8 as R,u as E,r as D,j as o,C as S}from"./main-559.js";import{t as $}from"./bf-215-82.js";import{a4 as M,a5 as L,a6 as P}from"./bf-946-81.js";const Y=(t,a,l,h,m,d,e,i,s,n)=>{let f=r({},l);if(a===0){if(i){const p=r({},s);p[t.target.name]="",n(r({},p))}f[t.target.name]=t.target.value}else f.relatedlists[a-1][t.target.name]=t.target.value;switch(t.target.name){case"module":f=Z(a,f,m,h,d,e);break}h(r({},f))},C=(t,a,l,h,m,d,e)=>{var i,s;t&&!((s=(i=l==null?void 0:l.default)==null?void 0:i.relatedlists)!=null&&s[l.module])&&H(m,l,h,d,e),a(t)},Z=(t,a,l,h,m,d)=>{var s,n;const e=r({},a),i=t===0?e.module:e.relatedlists[t-1].module;return t===0?(e.actions={},e.field_map=[{formField:"",zohoFormField:""}],e.upload_field_map=[{formField:"",zohoFormField:""}],t&&(e.relatedlists[t-1]={})):(e.relatedlists[t-1].field_map=[{formField:"",zohoFormField:""}],e.relatedlists[t-1].upload_field_map=[{formField:"",zohoFormField:""}],e.relatedlists[t-1].actions={}),(n=(s=e.default)==null?void 0:s.moduleData)!=null&&n[i]?t===0?(e.field_map=u(t,e),Object.keys(e.default.moduleData[i].fileUploadFields).length>0&&(e.upload_field_map=u(t,e,!0))):(e.relatedlists[t-1].field_map=u(t,e),Object.keys(e.default.moduleData[i].fileUploadFields).length>0&&(e.relatedlists[t-1].upload_field_map=u(t,e,!0))):V(t,l,e,h,m,d),e},T=(t,a,l,h,m)=>{h(!0);const d={formID:t,id:a.id,dataCenter:a.dataCenter,clientId:a.clientId,clientSecret:a.clientSecret,tokenDetails:a.tokenDetails};F(d,"bitforms_zrecruit_refresh_modules").then(e=>{if(e&&e.success){const i=r({},a);i.default||(i.default={}),e.data.modules&&(i.default.modules=e.data.modules),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),l(r({},i)),m({show:!0,msg:c("Modules refreshed")})}else e&&e.data&&e.data.data||!e.success&&typeof e.data=="string"?m({show:!0,msg:R(c("Modules refresh failed Cause: %s. please try again"),e.data.data||e.data)}):m({show:!0,msg:c("Modules refresh failed. please try again")});h(!1)}).catch(()=>h(!1))},ee=(t,a,l,h,m)=>{h(!0);const d={formID:t,id:a.id,dataCenter:a.dataCenter,clientId:a.clientId,clientSecret:a.clientSecret,tokenDetails:a.tokenDetails};F(d,"bitforms_zrecruit_refresh_notetypes").then(e=>{if(e&&e.success){const i=r({},a);i.default||(i.default={}),e.data.noteTypes&&(i.default.noteTypes=e.data.noteTypes),e.data.tokenDetails&&(i.tokenDetails=e.data.tokenDetails),l(r({},i)),m({show:!0,msg:c("Note Types refreshed")})}else e&&e.data&&e.data.data||!e.success&&typeof e.data=="string"?m({show:!0,msg:R(c("Note Types refresh failed Cause: %s. please try again"),e.data.data||e.data)}):m({show:!0,msg:c("Note Types refresh failed. please try again")});h(!1)}).catch(()=>h(!1))},H=(t,a,l,h,m)=>{if(!a.module)return;h(!0);const d={formID:t,module:a.module,dataCenter:a.dataCenter,clientId:a.clientId,clientSecret:a.clientSecret,tokenDetails:a.tokenDetails};F(d,"bitforms_zrecruit_refresh_related_lists").then(e=>{var i;if(e&&e.success){const s=r({},a);e.data.related_modules&&(s.default.relatedlists||(s.default.relatedlists={}),s.default.relatedlists[s.module]=e.data.related_modules),e.data.tokenDetails&&(s.tokenDetails=e.data.tokenDetails),l(r({},s)),m({show:!0,msg:c("RelatedLists refreshed")})}else(i=e==null?void 0:e.data)!=null&&i.data||!e.success&&typeof e.data=="string"?m({show:!0,msg:R(c("RelatedLists refresh failed Cause: %s. please try again"),e.data.data||e.data)}):m({show:!0,msg:c("RelatedLists refresh failed. please try again")});h(!1)}).catch(()=>h(!1))},V=(t,a,l,h,m,d)=>{const e=t===0?l.module:l.relatedlists[t-1].module;if(!e)return;m(!0);const i={formID:a,module:e,dataCenter:l.dataCenter,clientId:l.clientId,clientSecret:l.clientSecret,tokenDetails:l.tokenDetails};F(i,"bitforms_zrecruit_get_fields").then(s=>{if(s&&s.success){const n=r({},l);s.data.fieldDetails&&(n.default.moduleData||(n.default.moduleData={}),n.default.moduleData[e]=s.data.fieldDetails,t===0?(n.field_map=u(t,n),Object.keys(n.default.moduleData[e].fileUploadFields).length>0&&(n.upload_field_map=u(t,n,!0))):(n.relatedlists[t-1].field_map=u(t,n),Object.keys(n.default.moduleData[e].fileUploadFields).length>0&&(n.relatedlists[t-1].upload_field_map=u(t,n,!0)))),s.data.tokenDetails&&(n.tokenDetails=s.data.tokenDetails),h(r({},n))}else d({show:!0,msg:c("Fields refresh failed. please try again")});m(!1)}).catch(()=>m(!1))},u=(t,a,l)=>{var m,d;const h=t===0?a.module:a.relatedlists[t-1].module;return l?a.default.moduleData[h].requiredFileUploadFields.length>0?(m=a.default.moduleData[h].requiredFileUploadFields)==null?void 0:m.map(e=>({formField:"",zohoFormField:e})):[{formField:"",zohoFormField:""}]:a.default.moduleData[h].required.length>0?(d=a.default.moduleData[h].required)==null?void 0:d.map(e=>({formField:"",zohoFormField:e})):[{formField:"",zohoFormField:""}]},te=t=>{const a=t!=null&&t.field_map?t.field_map.filter(d=>{var e,i,s;return!d.formField&&d.zohoFormField&&((s=(i=(e=t==null?void 0:t.default)==null?void 0:e.moduleData)==null?void 0:i[t.module])==null?void 0:s.required.indexOf(d.zohoFormField))!==-1}):[],l=t!=null&&t.upload_field_map?t.upload_field_map.filter(d=>{var e,i,s;return!d.formField&&d.zohoFormField&&((s=(i=(e=t==null?void 0:t.default)==null?void 0:e.moduleData)==null?void 0:i[t.module])==null?void 0:s.requiredFileUploadFields.indexOf(d.zohoFormField))!==-1}):[],h=t.relatedlists.map(d=>d.field_map.filter(e=>!e.formField&&e.zohoFormField)),m=t.relatedlists.map(d=>d.upload_field_map.filter(e=>!e.formField&&e.zohoFormField));return!(a.length>0||l.length>0||h.some(d=>d.length)||m.some(d=>d.length))},B=(t,a,l,h,m,d)=>{if(!t.dataCenter||!t.clientId||!t.clientSecret){l({dataCenter:t.dataCenter?"":c("Data center cann't be empty"),clientId:t.clientId?"":c("Client ID cann't be empty"),clientSecret:t.clientSecret?"":c("Secret key cann't be empty")});return}const e=A(w);m(!0);const i="ZohoRecruit.users.ALL,ZohoRecruit.modules.all",s=`https://accounts.zoho.${t.dataCenter}/oauth/v2/auth?scope=${i}&response_type=code&client_id=${t.clientId}&prompt=Consent&access_type=offline&state=${encodeURIComponent(window.location.href)}/redirect&redirect_uri=${encodeURIComponent(e.zohoRedirectURL)}`,n=window.open(s,"zohoRecruit","width=400,height=609,toolbar=off"),f=setInterval(()=>{if(n.closed){clearInterval(f);let p={},y=!1;const g=localStorage.getItem("__bitforms_zohoRecruit");if(g&&(y=!0,p=JSON.parse(g),localStorage.removeItem("__bitforms_zohoRecruit")),!p.code||p.error||!p||!y){const _=p.error?`Cause: ${p.error}`:"";d({show:!0,msg:`${c("Authorization failed")} ${_}. ${c("please try again")}`}),m(!1)}else{const _=r({},t);_.accountServer=p["accounts-server"],J(p,_,a,h,m,d)}}},500)},J=(t,a,l,h,m,d)=>{const e=A(w),i=r({},t);i.dataCenter=a.dataCenter,i.clientId=a.clientId,i.clientSecret=a.clientSecret,i.redirectURI=encodeURIComponent(e.zohoRedirectURL),F(i,"bitforms_zrecruit_generate_token").then(s=>s).then(s=>{if(s&&s.success){const n=r({},a);n.tokenDetails=s.data,l(n),M(n),h(!0),d({show:!0,msg:c("Authorized Successfully")})}else s&&s.data&&s.data.data||!s.success&&typeof s.data=="string"?d({show:!0,msg:`${c("Authorization failed Cause:")}${s.data.data||s.data}. ${c("please try again")}`}):d({show:!0,msg:c("Authorization failed. please try again")});m(!1)})};function W({formID:t,recruitConf:a,setRecruitConf:l,step:h,setstep:m,isLoading:d,setisLoading:e,setSnackbar:i,redirectLocation:s,isInfo:n,authorizedAction:f}){const p=E(w),{siteURL:y}=p,[g,_]=D.useState(!1),[z,k]=D.useState({dataCenter:"",clientId:"",clientSecret:""}),x=j=>{const v=r({},a),I=r({},z);I[j.target.name]="",v[j.target.name]=j.target.value,k(I),l(v)};return D.useEffect(()=>{g&&f()},[g]),o.jsxs(o.Fragment,{children:[o.jsx(L,{title:$.zohoRecruit.title,youTubeLink:$.zohoRecruit.link}),o.jsxs("div",{className:"btcd-stp-page",style:{width:900,height:"100%"},children:[o.jsx("div",{className:"mt-3",children:o.jsx("b",{children:c("Integration Name:")})}),o.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:x,name:"name",value:a.name,type:"text",placeholder:c("Integration Name..."),disabled:n}),o.jsx("div",{className:"mt-3",children:o.jsx("b",{children:c("Data Center:")})}),o.jsxs("select",{onChange:x,name:"dataCenter",value:a.dataCenter,className:"btcd-paper-inp w-6 mt-1",disabled:n,children:[o.jsx("option",{value:"",children:c("--Select a data center--")}),o.jsx("option",{value:"com",children:"zoho.com"}),o.jsx("option",{value:"eu",children:"zoho.eu"}),o.jsx("option",{value:"com.cn",children:"zoho.com.cn"}),o.jsx("option",{value:"in",children:"zoho.in"}),o.jsx("option",{value:"com.au",children:"zoho.com.au"})]}),o.jsx("div",{style:{color:"red"},children:z.dataCenter}),o.jsx("div",{className:"mt-3",children:o.jsx("b",{children:c("Homepage URL:")})}),o.jsx(S,{value:y,className:"field-key-cpy w-6 ml-0",readOnly:n}),o.jsx("div",{className:"mt-3",children:o.jsx("b",{children:c("Authorized Redirect URIs:")})}),o.jsx(S,{value:s||`${p.zohoRedirectURL}`,className:"field-key-cpy w-6 ml-0",readOnly:n}),o.jsxs("small",{className:"d-blk mt-5",children:[c("To get Client ID and SECRET , Please Visit")," ",o.jsx("a",{className:"btcd-link",href:`https://api-console.zoho.${(a==null?void 0:a.dataCenter)||"com"}/`,target:"_blank",rel:"noreferrer",children:c("Zoho API Console")})]}),o.jsx("div",{className:"mt-3",children:o.jsx("b",{children:c("Client id:")})}),o.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:x,name:"clientId",value:a.clientId,type:"text",placeholder:c("Client id..."),disabled:n}),o.jsx("div",{style:{color:"red"},children:z.clientId}),o.jsx("div",{className:"mt-3",children:o.jsx("b",{children:c("Client secret:")})}),o.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:x,name:"clientSecret",value:a.clientSecret,type:"text",placeholder:c("Client secret..."),disabled:n}),o.jsx("div",{style:{color:"red"},children:z.clientSecret}),!n&&o.jsxs(o.Fragment,{children:[o.jsx(P,{isAuthorized:g,isloading:d,handleAuthorize:()=>B(a,l,k,_,e,i)}),o.jsx("br",{})]})]})]})}var ae=Object.freeze({__proto__:null,default:W});export{W as Z,C as a,H as b,te as c,T as d,ae as e,Y as h,ee as r};
