var S=Object.defineProperty;var I=Object.getOwnPropertySymbols;var f=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var w=(t,s,o)=>s in t?S(t,s,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[s]=o,l=(t,s)=>{for(var o in s||(s={}))f.call(s,o)&&w(t,o,s[o]);if(I)for(var o of I(s))E.call(s,o)&&w(t,o,s[o]);return t};import{_ as n,ae as $,$ as z,c as k,u as U,r as C,j as e,C as _}from"./main-559.js";import{t as N}from"./bf-215-82.js";import{a4 as M,a5 as Z,a6 as D}from"./bf-946-81.js";function B(t,s,o,j,m,d,u,r,a){const i=l({},s);if(u){const p=l({},r);p[t.target.name]="",a(l({},p))}i[t.target.name]=t.target.value,o(l({},i))}const L=(t,s,o,j,m,d)=>{if(!t.dataCenter||!t.clientId||!t.clientSecret){o({dataCenter:t.dataCenter?"":n("Data center cann't be empty"),clientId:t.clientId?"":n("Client ID cann't be empty"),clientSecret:t.clientSecret?"":n("Secret key cann't be empty")});return}const u=$(z);m(!0);const r="ZohoMail.accounts.Read,ZohoMail.messages.CREATE,ZohoMail.messages.UPDATE,ZohoMail.Attachments.CREATE,ZohoMail.Attachments.READ,ZohoMail.Attachments.UPDATE",a=`https://accounts.zoho.${t.dataCenter}/oauth/v2/auth?scope=${r}&response_type=code&client_id=${t.clientId}&prompt=Consent&access_type=offline&state=${encodeURIComponent(window.location.href)}/redirect&redirect_uri=${encodeURIComponent(u.zohoRedirectURL)}`,i=window.open(a,"zohoMail","width=400,height=609,toolbar=off"),p=setInterval(()=>{if(i.closed){clearInterval(p);let c={},x=!1;const g=localStorage.getItem("__bitforms_zohoMail");if(g&&(x=!0,c=JSON.parse(g),localStorage.removeItem("__bitforms_zohoMail")),!c.code||c.error||!c||!x){const h=c.error?`Cause: ${c.error}`:"";d({show:!0,msg:`${n("Authorization failed")} ${h}. ${n("please try again")}`}),m(!1)}else{const h=l({},t);h.accountServer=c["accounts-server"],P(c,h,s,j,m,d)}}},500)},P=(t,s,o,j,m,d)=>{const u=$(z),r=l({},t);r.dataCenter=s.dataCenter,r.clientId=s.clientId,r.clientSecret=s.clientSecret,r.redirectURI=encodeURIComponent(u.zohoRedirectURL),k(r,"bitforms_zmail_generate_token").then(a=>a).then(a=>{if(a&&a.success){const i=l({},s);i.tokenDetails=a.data,o(i),M(i),j(!0),d({show:!0,msg:n("Authorized Successfully")})}else a&&a.data&&a.data.data||!a.success&&typeof a.data=="string"?d({show:!0,msg:`${n("Authorization failed Cause:")}${a.data.data||a.data}. ${n("please try again")}`}):d({show:!0,msg:n("Authorization failed. please try again")});m(!1)})};function O({mailConf:t,setMailConf:s,step:o,setstep:j,isLoading:m,setisLoading:d,setSnackbar:u,redirectLocation:r,isInfo:a,authorizedAction:i}){const p=U(z),{siteURL:c}=p,[x,g]=C.useState(!1),[h,y]=C.useState({dataCenter:"",clientId:"",clientSecret:""}),b=v=>{const A=l({},t),R=l({},h);R[v.target.name]="",A[v.target.name]=v.target.value,y(R),s(A)};return C.useEffect(()=>{x&&i()},[x]),e.jsxs(e.Fragment,{children:[e.jsx(Z,{title:N.zohoMail.title,youTubeLink:N.zohoMail.link}),e.jsxs("div",{className:"btcd-stp-page",style:{width:900,height:"100%"},children:[e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Integration Name:")})}),e.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:b,name:"name",value:t.name,type:"text",placeholder:n("Integration Name..."),disabled:a}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Data Center:")})}),e.jsxs("select",{onChange:b,name:"dataCenter",value:t.dataCenter,className:"btcd-paper-inp w-6 mt-1",disabled:a,children:[e.jsx("option",{value:"",children:n("--Select a data center--")}),e.jsx("option",{value:"com",children:"zoho.com"}),e.jsx("option",{value:"eu",children:"zoho.eu"}),e.jsx("option",{value:"com.cn",children:"zoho.com.cn"}),e.jsx("option",{value:"in",children:"zoho.in"}),e.jsx("option",{value:"com.au",children:"zoho.com.au"})]}),e.jsx("div",{style:{color:"red"},children:h.dataCenter}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Homepage URL:")})}),e.jsx(_,{value:c,className:"field-key-cpy w-6 ml-0",readOnly:a}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Authorized Redirect URIs:")})}),e.jsx(_,{value:r||`${p.zohoRedirectURL}`,className:"field-key-cpy w-6 ml-0",readOnly:a}),e.jsxs("small",{className:"d-blk mt-5",children:[n("To get Client ID and SECRET , Please Visit")," ",e.jsx("a",{className:"btcd-link",href:`https://api-console.zoho.${(t==null?void 0:t.dataCenter)||"com"}/`,target:"_blank",rel:"noreferrer",children:n("Zoho API Console")})]}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Client id:")})}),e.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:b,name:"clientId",value:t.clientId,type:"text",placeholder:n("Client id..."),disabled:a}),e.jsx("div",{style:{color:"red"},children:h.clientId}),e.jsx("div",{className:"mt-3",children:e.jsx("b",{children:n("Client secret:")})}),e.jsx("input",{className:"btcd-paper-inp w-6 mt-1",onChange:b,name:"clientSecret",value:t.clientSecret,type:"text",placeholder:n("Client secret..."),disabled:a}),e.jsx("div",{style:{color:"red"},children:h.clientSecret}),!a&&e.jsxs(e.Fragment,{children:[e.jsx(D,{isAuthorized:x,isLoading:m,handleAuthorize:()=>L(t,s,y,g,d,u)}),e.jsx("br",{})]})]})]})}var J=Object.freeze({__proto__:null,default:O});export{O as Z,J as a,B as h};
