var Ke=Object.defineProperty,Ve=Object.defineProperties;var Le=Object.getOwnPropertyDescriptors;var Me=Object.getOwnPropertySymbols;var Ge=Object.prototype.hasOwnProperty,Ie=Object.prototype.propertyIsEnumerable;var De=(s,t,a)=>t in s?Ke(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a,S=(s,t)=>{for(var a in t||(t={}))Ge.call(t,a)&&De(s,a,t[a]);if(Me)for(var a of Me(t))Ie.call(t,a)&&De(s,a,t[a]);return s},W=(s,t)=>Ve(s,Le(t));import{a as X,r as ge,j as e,i as le,u as Y,ap as J,h as H,T as Ce,_ as i,aP as Z,aN as et,aO as tt,J as st,aJ as K,$ as Qe,bo as lt,f as B,ae as ye,aE as Ae,bn as ot,da as at,bv as it,ao as nt,I as ke,an as _e,W as Fe,bl as z,aQ as ct,aS as Ee,e6 as rt,e5 as dt,d as Ye,z as mt,N as pt,c as ht,V as ut}from"./main-509.js";import{S as ft,a as xt,D as bt,b as kt}from"./bf-102-254.js";import{S as vt}from"./bf-836-329.js";import{o as ne,M as re,D as Ne,q as ve}from"./bf-469-70.js";import{t as Pe}from"./bf-890-82.js";import{A as jt}from"./bf-892-83.js";import{g as q,e as ae,i as Be,u as Se,h as Re,P as wt}from"./bf-760-79.js";import{C as yt}from"./bf-106-86.js";import{C as G}from"./bf-413-105.js";import{C as Xe}from"./bf-915-376.js";import{M as Oe}from"./bf-870-113.js";import"./bf-478-88.js";function ze({title:s,titleOutline:t,accordionActions:a,children:n}){const{css:p}=X(),[c,y]=ge.useState(!0),C=()=>{y(k=>!k)};return e.jsxs("div",{className:p(L.section),children:[e.jsxs("div",{className:`${p(L.titleWrp)}`,children:[e.jsxs("button",{type:"button",className:`${p(L.title,t?L.titleOutline:{})} btcd-logic-blk`,onClick:C,children:[s,e.jsx("span",{className:p(L.titleIcn),children:e.jsx(yt,{size:15,rotate:!c})})]}),e.jsx("div",{className:`${p(L.accrActions)} accr-actions`,children:a})]}),c&&e.jsx("div",{className:p(L.content),children:n}),!c&&e.jsx("div",{className:p(L.content),children:e.jsxs("button",{className:p(L.collapsedAccrdn),type:"button",onClick:C,children:[e.jsx("span",{className:p(L.collapsedCrl)}),e.jsx("span",{className:p(L.collapsedCrl)}),e.jsx("span",{className:p(L.collapsedCrl)})]})})]})}const L={section:{pb:12},accrActions:{dy:"none"},titleWrp:{flx:1,":hover .accr-actions":{flx:1}},title:{bc:"var(--b-50)",h:35,fs:14,p:"0 15px",brs:30,cr:"#fff",fw:600,lh:"29px",cur:"pointer",us:"none",b:0,oe:0,flx:"center"},titleOutline:{b:"2px solid var(--b-50)",bc:"#fff",cr:"var(--b-50)",p:"0 13px"},titleIcn:{ml:8,flx:"center"},content:{my:5,ml:45},collapsedAccrdn:{b:0,oe:0,bc:"#D9D9D9",w:65,brs:10,h:20,flx:"center",rg:5,cg:5,curp:1,mt:15,":focus":{oe:"none"}},collapsedCrl:{dy:"inline-block",w:5,h:5,bc:"#AAAAAA",brs:"50%"}};function Ue({lgcGrpInd:s,condGrpInd:t,actionKey:a,enableAction:n,checkKeyInArr:p,getValueFromArr:c,title:y}){const{css:C}=X(),[k,x]=le(Z),l=Y(et),m=Y(tt),h=Y(st),b=J(K),_=Y(Qe),j=()=>{const r=[];return h.map(F=>{lt.includes(F.type)&&r.push({label:F.name,value:F.key})}),r},O=()=>h.filter(r=>r.type==="email").length>0,f=()=>{const r=[];if(O()){const F=[];h.map(o=>{o.type==="email"&&F.push({label:o.name,value:`\${${o.key}}`})}),r.push({title:"Form Fields",type:"group",childs:F})}return _.userMail&&Array.isArray(_.userMail)&&r.push({title:"WP Emails",type:"group",childs:_.userMail}),r},N=(r,F)=>{const o=B(k,u=>{const{success:v}=u[s].conditions[t].actions,g=v.find(A=>A.type===a);g&&(g.details[r]=F)});x(o),b(u=>W(S({},u),{unsaved:!0}))};return e.jsxs("div",{className:C(H.mt2),children:[e.jsx(Ce,{onChange:r=>n(r.target.checked,a),title:y,checked:p(a),className:C(H.flxc)}),p(a)&&e.jsxs("div",{className:C({mt:5,ml:28}),children:[e.jsx("label",{className:"f-m f-5",children:i("Email Template:")}),e.jsx("div",{className:"mt-1"}),e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:r=>N("id",r.target.value),value:c(a,"id"),children:[e.jsx("option",{value:"",children:i("Select Email Template")}),l==null?void 0:l.map((r,F)=>e.jsx("option",{value:r.id?JSON.stringify({id:String(r.id)}):JSON.stringify({index:String(F)}),children:r.title},`sem-${F+2.3}`))]}),e.jsx(ne,{action:r=>N("to",r?r.split(","):[]),value:c(a,"to"),placeholder:i("Add Email Receiver"),title:e.jsx("span",{className:"f-m f-5",children:i("To")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:f(c(a,"to"))}),e.jsx(ne,{action:r=>N("from",r),placeholder:i("Add mail from address"),value:c(a,"from"),title:e.jsx("span",{className:"f-m f-5",children:i("From Mail")}),titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:f(c(a,"from")),tip:i('Some servers block emails if "From Email" differs from the authenticated (login) emailâ€” use the same email to ensure delivery.')}),e.jsx("div",{className:"mt-1"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"from_name",className:"f-m f-5",children:i("From Name")}),e.jsx("div",{className:"mt-2"}),e.jsx("input",{id:"from_name",type:"text",className:"btcd-paper-inp",style:{height:"35px",width:"69%",background:"var(--b-79-96)"},value:c(a,"from_name"),onChange:r=>N("from_name",r.target.value),placeholder:"Add mail from name"})]}),e.jsx(ne,{action:r=>N("cc",r?r.split(","):[]),value:c(a,"cc"),placeholder:i("Add Email CC"),title:e.jsx("span",{className:"f-m f-5",children:i("CC")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:f(c(a,"cc"))}),e.jsx(ne,{action:r=>N("bcc",r?r.split(","):[]),placeholder:i("Add Email BCC"),value:c(a,"bcc"),title:e.jsx("span",{className:"f-m f-5",children:i("BCC")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:f(c(a,"bcc"))}),e.jsx(ne,{action:r=>N("replyto",r?r.split(","):[]),placeholder:i("Reply To"),value:c(a,"replyto"),title:e.jsx("span",{className:"f-m f-5",children:i("Reply To")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",addable:!0,options:f(c(a,"replyto"))}),e.jsx(ne,{action:r=>N("attachment",r?r.split(","):[]),placeholder:i("Attachment"),value:c(a,"attachment"),title:e.jsx("span",{className:"f-m f-5",children:i("Attachment")}),isMultiple:!0,titleClassName:"w-7 mt-2",className:"w-10 mt-1",options:j()}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"pdf-template",className:"f-m f-5",children:i("PDF Attachment Template:")}),e.jsx("div",{className:"mt-1"}),e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:r=>N("pdfId",r.target.value),value:c(a,"pdfId"),children:[e.jsx("option",{value:"",children:i("Select PDF Template")}),m==null?void 0:m.map((r,F)=>e.jsx("option",{value:r.id?JSON.stringify({id:String(r.id)}):JSON.stringify({index:String(F)}),children:r.title},`sem-${F+2.3}`))]})]})]})]})}const Nt=["text","username","number","email","password","tel","url","search","select","textarea","html-select","currency","phone-number"],gt=(s,t="")=>{if(t==="")return s;const a=t.split("."),n=a.length-1;return a.slice(0,n).forEach(c=>{s=s[c]}),a.length?s[a[n]]:s},Ct=[{key:"_bf_form",name:"Form"},{key:"_bf_step_no",name:"Step No."}],Ze=s=>{const t=[];return s.forEach(a=>{typeof a=="object"&&!Array.isArray(a)?t.push(a):Array.isArray(a)&&t.push(...Ze(a))}),t},At=()=>{const s=ye(it),t=Array.isArray(s)&&s.length>1,a=ye(nt),n=t?a.multiStepSettings.btnSettings:{},{show:p,prevBtn:c,nextBtn:y}=n;return p?{[c.key]:S({},c),[y.key]:S({},y)}:{}},we=s=>{var l;const t=ye(Ae),a=S(S({},t),At()),n=ye(ot),p=at(a,[]),c=Ze(s.logics||[]),y=((l=s==null?void 0:s.actions)==null?void 0:l.fields)||[],C=[...c,...y].map(m=>m.field).filter(m=>m),k=p.filter(m=>m.type==="repeater").map(m=>m.key);let x="";if(k.forEach(m=>{n[m].lg.map(j=>j.i).some(j=>C.includes(j))&&(x=m)}),x){k.splice(k.indexOf(x),1);const m=k.reduce((h,b)=>{const j=n[b].lg.map(O=>O.i);return[...h,...j]},[]);return p.filter(h=>!m.includes(h.key)&&!k.includes(h.key))}return p};function _t({action:s,lgcGrp:t,lgcGrpInd:a,actionInd:n,condGrpInd:p,actionType:c,formFields:y}){var U,je,de,me,pe,he,ue,fe;const C=J(Z),k=Y(Ae),x=J(K),{css:l}=X();let m="",h="";y!==null&&y.map(T=>{T.key===s.field&&(h=T.type,m=T.key)});const b=()=>{var d,D,P,I,V,ee,Q,ie;if(h==="razorpay")return;let T;if(T=(D=(d=k==null?void 0:k[m])==null?void 0:d.opt)==null?void 0:D.map(M=>({label:M.lbl,value:M.val||M.lbl})),h==="select"){const{optionsList:M}=(k==null?void 0:k[m])||{};if(s.action==="value")return M.reduce((E,oe)=>{const te=Object.keys(oe)[0],xe=Object.values(oe)[0];return E.push({type:"group",title:te,childs:xe.map(be=>({label:be.lbl,value:be.val||be.lbl}))}),E},[]);if(s.action==="activelist")return M.reduce((E,oe)=>{const te=Object.keys(oe)[0];return E.push({label:te,value:te}),E},[])}if(["decision-box","gdpr"].includes(h)){const M=k==null?void 0:k[m];return[{label:(P=M==null?void 0:M.msg)==null?void 0:P.checked,value:(I=M==null?void 0:M.msg)==null?void 0:I.checked},{label:(V=M==null?void 0:M.msg)==null?void 0:V.unchecked,value:(ee=M==null?void 0:M.msg)==null?void 0:ee.unchecked}]}return T||(T=(ie=(Q=k==null?void 0:k[m])==null?void 0:Q.options)==null?void 0:ie.map(M=>({label:M.lbl,value:M.val||M.code||M.i||M.lbl}))),T},_=T=>{C(d=>B(d,D=>{const{fields:P}=D[a].conditions[p].actions;P[n].action=T})),x(d=>W(S({},d),{unsaved:!0}))},j=T=>{C(d=>B(d,D=>{const{fields:P}=D[a].conditions[p].actions;P[n].val=T})),x(d=>W(S({},d),{unsaved:!0}))},O=T=>{C(d=>B(d,D=>{const{fields:P}=D[a].conditions[p].actions;P[n].field=T,typeof P[n].val=="undefined"&&(P[n].val="")})),x(d=>W(S({},d),{unsaved:!0}))},f=()=>{C(T=>B(T,d=>{const{fields:D}=d[a].conditions[p].actions;D.length>1&&D.splice(n,1)})),x(T=>W(S({},T),{unsaved:!0}))},N=()=>{C(T=>B(T,d=>{const{fields:D}=d[a].conditions[p].actions,P=S({},D[n]);D.splice(n+1,0,P)})),x(T=>W(S({},T),{unsaved:!0}))},r=((U=k[s.field])==null?void 0:U.typ)||"",F=((je=k[s.field])==null?void 0:je.typ)!=="file-up"&&((de=k[s.field])==null?void 0:de.typ)!=="advanced-file-up",o=((me=k[s.field])==null?void 0:me.typ)!=="button",u=((pe=k[s.field])==null?void 0:pe.typ)==="title",v=["advanced-datetime"].includes((he=k[s.field])==null?void 0:he.typ),g=c!=="onsubmit",A=c!=="onvalidate",w=["decision-box","gdpr"].includes((ue=k[s.field])==null?void 0:ue.typ),$=Nt.includes((fe=k[s.field])==null?void 0:fe.typ),R=s.field==="_bf_form";return e.jsxs("div",{className:"flx pos-rel btcd-logic-blk",children:[e.jsxs(re,{label:"Form Fields",value:s.field||"",onChange:T=>O(T.target.value),style:{width:720},children:[e.jsx("option",{value:"",children:i("Select One")}),y.map(T=>e.jsx("option",{value:T.key,children:T.name},`ff-Ab-${T.key}`)),Ct.map(T=>e.jsx("option",{value:T.key,children:T.name},`ff-Ab-${T.key}`))]}),e.jsx("div",{className:l({w:100,flx:"align-center",h:35,mt:5}),children:e.jsx("div",{className:l({w:"100%",bd:"#b9c5ff",h:"0.5px"})})}),e.jsxs(re,{label:"Action",onChange:T=>_(T.target.value),value:s.action||"",style:{width:400},className:"w-4",children:[e.jsx("option",{value:"",children:i("Select One")}),R&&e.jsx("option",W(S({value:"save_draft"},!ke&&{disabled:!0}),{children:i(`Save Draft ${ke?"":"(PRO)"}`)})),!R&&e.jsxs(e.Fragment,{children:[!o&&t.action_type==="oninput"&&e.jsx("option",{value:"click",children:i("Click")}),F&&o&&A&&e.jsx("option",{value:"value",children:i("Value")}),g&&A&&e.jsx("option",{value:"enable",children:i("Enable")}),g&&A&&e.jsx("option",{value:"disable",children:i("Disable")}),g&&A&&F&&o&&e.jsx("option",{value:"readonly",children:i("Readonly")}),g&&A&&F&&o&&e.jsx("option",{value:"writeable",children:i("Writeable")}),g&&A&&e.jsx("option",{value:"hide",children:i("Hide")}),g&&A&&e.jsx("option",{value:"show",children:i("Show")}),c==="onvalidate"&&e.jsx("option",{value:"required",children:i("Required")}),c==="onvalidate"&&e.jsx("option",{value:"notrequired",children:i("Not Required")}),r==="select"&&e.jsx("option",{value:"activelist",children:i("Active List")}),g&&A&&F&&o&&e.jsx("option",{value:w?"ct":"lbl",children:i("Label")}),g&&A&&F&&o&&e.jsx("option",{value:"sub-titl",children:i("Sub Title")}),$&&e.jsx("option",{value:"placeholder",children:i("Placeholder")}),g&&A&&F&&o&&!u&&e.jsx("option",{value:"hlp-txt",children:i("Helper Text")}),v&&e.jsx("option",{value:"config-option",children:i("Config Option")}),u&&e.jsx("option",{value:"title",children:i("Title")})]})]}),["value","activelist","lbl","ct","sub-titl","hlp-txt","title","placeholder","config-option"].includes(s.action)&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:l({w:100,flx:"align-center",h:35,mt:5}),children:e.jsx("div",{className:l({w:"100%",bd:"#b9c5ff",h:"0.5px"})})}),e.jsx(Xe,{label:"Value",type:h.match(/select|check|radio|number|range|hidden/g)?"text":h,onChange:j,value:s.val||"",options:b(),formFields:y})]}),e.jsxs("div",{className:"btcd-li-side-btn",children:[e.jsx(q,{onClick:N,icn:!0,className:"ml-2 sh-sm white",children:e.jsx(_e,{})}),e.jsx(q,{onClick:f,icn:!0,className:"ml-2 sh-sm white",children:e.jsx(Fe,{})})]})]})}function Ft({lgcGrp:s,lgcGrpInd:t,condGrp:a,condGrpInd:n}){const{css:p}=X(),[c,y]=le(Z),C=J(K),{fields:k}=a.actions,x=()=>{const l=B(c,m=>{const{fields:h}=m[t].conditions[n].actions;let b="disable";m[t].action_type==="onsubmit"&&(b="value"),h.push({field:"",action:b})});y(l),C(m=>W(S({},m),{unsaved:!0}))};return e.jsxs("div",{className:p(H.mt2),children:[e.jsx("div",{className:p($t.title),children:e.jsx("b",{className:"txt-dp",children:"Field Actions"})}),k==null?void 0:k.map((l,m)=>e.jsx("div",{className:`mt-2 ${a.cond_type==="always"&&"ml-4"}`,children:e.jsx(_t,{lgcGrp:s,lgcGrpInd:t,condGrpInd:n,action:l,actionInd:m,actionType:s.action_type,formFields:we(a)})},`atn-${m+22}`)),e.jsx(ae,{msg:"Add More",children:e.jsx(q,{onClick:()=>x(),icn:!0,className:`blue sh-sm mt-2 ${a.cond_type==="always"&&"ml-4"}`,children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})})]})}const $t={title:{mb:7},chip:{mnh:30,dy:"flex !important",ai:"center",w:60,mt:9,mb:9}};function St({lgcGrpInd:s,condGrpInd:t,enableAction:a,checkKeyInArr:n,getValueFromArr:p}){const{css:c}=X(),[y,C]=le(Z),k=J(K),x=Y(ct),l=m=>{const h=B(y,b=>{const{success:_}=b[s].conditions[t].actions,j=_.find(O=>O.type==="integ");j&&(j.details.id=m.map(O=>O.value))});C(h),k(b=>W(S({},b),{unsaved:!0}))};return e.jsxs("div",{className:c(H.mt2),children:[e.jsx(Ce,{onChange:m=>a(m.target.checked,"integ"),title:i("Integration"),checked:n("integ"),className:c(H.flxc)}),n("integ")&&e.jsx(ne,{action:m=>l(m),jsonValue:!0,value:p("integ","id"),titleClassName:c({mt:5,ml:28,w:"67.5%"}),className:"w-10",isMultiple:ke,options:x==null?void 0:x.map((m,h)=>({label:m.name,value:m.id?JSON.stringify({id:String(m.id)}):JSON.stringify({index:String(h)})})),placeholder:i("Select Integation")})]})}function Ot({lgcGrpInd:s,condGrpInd:t,enableAction:a,checkKeyInArr:n,getValueFromArr:p}){var m,h;const{css:c}=X(),[y,C]=le(Z),k=J(K),x=Y(Ee),l=b=>{const _=B(y,j=>{const{success:O}=j[s].conditions[t].actions,f=O.find(N=>N.type==="redirectPage");f&&(f.details.id=b)});C(_),k(j=>W(S({},j),{unsaved:!0}))};return e.jsxs("div",{className:c(H.mt2),children:[e.jsx(Ce,{onChange:b=>a(b.target.checked,"redirectPage"),title:i("Redirect URL"),checked:n("redirectPage"),className:c(H.flxc)}),n("redirectPage")&&e.jsx("div",{className:c({mt:5,ml:28}),children:e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:b=>l(b.target.value),value:p("redirectPage","id"),children:[e.jsx("option",{value:"",children:i("Select Page To Redirect")}),(h=(m=x==null?void 0:x.type)==null?void 0:m.redirectPage)==null?void 0:h.map((b,_)=>e.jsx("option",{value:b.id?JSON.stringify({id:String(b.id)}):JSON.stringify({index:String(_)}),children:b.title},`sr-${_+2.5}`))]})})]})}function Tt({lgcGrpInd:s,condGrpInd:t,enableAction:a,checkKeyInArr:n,getValueFromArr:p}){var m,h;const{css:c}=X(),[y,C]=le(Z),k=J(K),x=Y(Ee),l=b=>{const _=B(y,j=>{const{success:O}=j[s].conditions[t].actions,f=O.find(N=>N.type==="successMsg");f&&(f.details.id=b)});C(_),k(j=>W(S({},j),{unsaved:!0}))};return e.jsxs("div",{className:c(H.mt2),children:[e.jsx(Ce,{onChange:b=>a(b.target.checked,"successMsg"),title:i("Success Message"),checked:n("successMsg"),className:c(H.flxc)}),n("successMsg")&&e.jsx("div",{className:c({mt:5,ml:28}),children:e.jsxs("select",{className:"btcd-paper-inp w-7",onChange:b=>l(b.target.value),value:p("successMsg","id"),children:[e.jsx("option",{value:"",children:i("Select Message")}),(h=(m=x==null?void 0:x.type)==null?void 0:m.successMsg)==null?void 0:h.map((b,_)=>e.jsx("option",{value:b.id?JSON.stringify({id:String(b.id)}):JSON.stringify({index:String(_)}),children:b.title},`sm-${_+2.3}`))]})})]})}function Wt({lgcGrpInd:s,condGrp:t,condGrpInd:a}){var x,l;const[n,p]=le(Z),c=J(K),y=Y(Ee),{failure:C}=t.actions,k=m=>{const h=B(n,b=>{b[s].conditions[a].actions.failure=m});p(h),c(b=>W(S({},b),{unsaved:!0}))};return e.jsxs(re,{onChange:m=>k(m.target.value),value:C,label:"Error Message",className:"w-7 mt-3",children:[e.jsx("option",{value:"",children:i("Select Message")}),(l=(x=y==null?void 0:y.type)==null?void 0:x.successMsg)==null?void 0:l.map((m,h)=>e.jsx("option",{value:m.id?JSON.stringify({id:String(m.id)}):JSON.stringify({index:String(h)}),children:m.title},`vm-${h+2.7}`))]})}function qe({lgcGrp:s,lgcGrpInd:t,condGrp:a,condGrpInd:n}){var b,_,j;const{css:p}=X(),[c,y]=le(Z),C=J(K),{success:k}=a.actions,x=(O,f)=>{const N=B(c,r=>{const{success:F}=r[t].conditions[n].actions;if(O)f==="mailNotify"?F.push({type:f,details:{}}):f==="dblOptin"?F.push({type:f,details:{}}):F.push({type:f,details:{id:""}});else for(let o=0;o<F.length;o+=1)if(F[o].type===f){F.splice(o,1);break}});y(N),C(r=>W(S({},r),{unsaved:!0}))},l=O=>k==null?void 0:k.some(f=>f.type===O),m=O=>{const f=B(c,N=>{const{actions:r}=N[t].conditions[n];r.avoid_delete=O});y(f),C(N=>W(S({},N),{unsaved:!0}))},h=(O,f)=>{const N=k.find(r=>r.type===O);return N!==void 0?N.details[f]:""};return e.jsxs(e.Fragment,{children:[s.action_type!=="onvalidate"&&s.action_run!=="delete"&&e.jsx(Ft,{lgcGrp:s,lgcGrpInd:t,condGrp:a,condGrpInd:n}),(s.action_type==="onsubmit"||s.action_run==="delete")&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:p(H.mt3,H.mb1),children:e.jsx("b",{className:"txt-dp",children:"Additional Actions"})}),e.jsxs("div",{className:a.cond_type==="always"?"ml-4":"",children:[s.action_run!=="delete"&&e.jsx(Tt,{lgcGrpInd:t,condGrpInd:n,enableAction:x,checkKeyInArr:l,getValueFromArr:h}),!s.action_run.match(/^(delete|edit)$/)&&e.jsx(Ot,{lgcGrpInd:t,condGrpInd:n,enableAction:x,checkKeyInArr:l,getValueFromArr:h}),s.action_run!=="delete"&&e.jsx(St,{lgcGrpInd:t,condGrpInd:n,enableAction:x,checkKeyInArr:l,getValueFromArr:h}),e.jsx(Ue,{title:i("Email Notification"),lgcGrpInd:t,condGrpInd:n,actionKey:"mailNotify",enableAction:x,checkKeyInArr:l,getValueFromArr:h}),e.jsx(Ue,{title:i("Double Opt-in"),lgcGrpInd:t,condGrpInd:n,actionKey:"dblOptin",enableAction:x,checkKeyInArr:l,getValueFromArr:h})]})]}),s.action_run==="delete"&&e.jsx(G,{className:p({mt:5,ml:a.cond_type==="always"?12:-8}),onChange:O=>m(O.target.checked),checked:(j=(_=(b=c[t])==null?void 0:b.conditions[n])==null?void 0:_.actions)==null?void 0:j.avoid_delete,title:e.jsx("small",{className:"txt-dp",children:"Prevent Delete"})}),s.action_type==="onvalidate"&&s.action_run!=="delete"&&e.jsx(Wt,{lgcGrpInd:t,condGrp:a,condGrpInd:n})]})}const Bt={change:{label:i("Change"),notFields:["button","user"]},equal:{label:i("Equal"),notFields:["button","repeater"]},not_equal:{label:i("Not Equal"),notFields:["button","user","repeater"]},null:{label:i("Is Null"),notFields:["button","user","repeater"]},not_null:{label:i("Is Not Null"),notFields:["button","user","repeater"]},contain:{label:i("Contain"),notFields:["button","date","time","datetime-local","month","week","user","repeater"]},contain_all:{label:i("Contain All"),fields:["select"]},not_contain:{label:i("Not Contain"),notFields:["button","date","time","datetime-local","advanced-datetime","month","week","user","repeater"]},greater:{label:i("Greater Than"),fields:["number","date","time","datetime-local","advanced-datetime"]},less:{label:i("Less Than"),fields:["number","date","time","datetime-local","advanced-datetime"]},greater_or_equal:{label:i("Greater Than or Equal"),fields:["number","date","time","datetime-local","advanced-datetime"]},less_or_equal:{label:i("Less Than or Equal"),fields:["number","date","time","datetime-local","advanced-datetime"]},start_with:{label:i("Start With"),notFields:["button","color","url","password","email","date","time","datetime-local","advanced-datetime","month","week","user","repeater"]},end_with:{label:i("End With"),notFields:["button","color","url","password","email","date","time","datetime-local","advanced-datetime","month","week","user","repeater"]},between:{label:i("Between"),fields:["number","date","time","datetime-local","advanced-datetime"]},on_click:{label:i("On Click"),fields:["button.btnTyp:button","button.btnTyp:next-step","button.btnTyp:previuos-step"]}};function Te({logic:s,fieldVal:t,delLogic:a,lgcInd:n,subLgcInd:p,subSubLgcInd:c,value:y,addInlineLogic:C,cloneInLineLogic:k,changeLogic:x,logicValue:l,changeValue:m,changeSmartKey:h,changeFormField:b,smartTagAllowed:_,formFields:j}){var de,me,pe,he,ue,fe,T;const{css:O}=X(),f=Y(Ae);let N=!1,r="",F="",o="";(de=j==null?void 0:j.find)==null||de.call(j,d=>{if(d.key===t)return d.type.match(/^(check|radio|select|html-select|image-select|hidden)$/)?r="text":r=d.type,F=d.type,o=d.key,!0});const u=[{label:i("Logged In"),value:"logged_in"},{label:i("Logged Out"),value:"logged_out"}],v=()=>{var D,P,I,V,ee,Q,ie,M;if(F==="razorpay")return;let d;if(F==="user"?d=u:d=(P=(D=f==null?void 0:f[o])==null?void 0:D.opt)==null?void 0:P.map(E=>({label:E.lbl,value:E.val||E.lbl})),F==="select"){const{optionsList:E}=(f==null?void 0:f[o])||{};return E.reduce((oe,te)=>{const xe=Object.keys(te)[0],be=Object.values(te)[0];return oe.push({type:"group",title:xe,childs:be.map($e=>({label:$e.lbl,value:$e.val||$e.lbl}))}),oe},[])}if(["decision-box","gdpr"].includes(r)){const E=f==null?void 0:f[o];return[{label:(I=E==null?void 0:E.msg)==null?void 0:I.checked,value:(V=E==null?void 0:E.msg)==null?void 0:V.checked},{label:(ee=E==null?void 0:E.msg)==null?void 0:ee.unchecked,value:(Q=E==null?void 0:E.msg)==null?void 0:Q.unchecked}]}return d||(d=(M=(ie=f==null?void 0:f[o])==null?void 0:ie.options)==null?void 0:M.map(E=>({label:E.lbl,value:E.val||E.code||E.i||E.lbl}))),d},g=(d,D)=>D.find(P=>{if(P===d)return!0;if(!P.includes("."))return!1;const I=P.indexOf("."),V=P.substring(0,I);if(d!==V)return!1;const ee=P.substring(I+1);if(!ee)return!1;const[Q,ie]=ee.split(":"),M=Q.split("."),E=j.find(te=>te.key===o)||{};return M.reduce((te,xe)=>te[xe],E)===ie}),A=d=>Be.find(D=>d===`\${${D.name}}`);r||(r=((me=A(t))==null?void 0:me.type)||""),N||(N=((pe=A(t))==null?void 0:pe.singleSelect)||!1);const w=d=>{var I;const D=((I=A(t))==null?void 0:I.type)||d;return D?Object.entries(Bt).reduce((V,[ee,Q])=>Q.notFields&&g(D,Q.notFields)?V:Q.fields?g(D,Q.fields)?[...V,{key:ee,lbl:Q.label}]:V:[...V,{key:ee,lbl:Q.label}],[]):[]},$=d=>d==="${_bf_custom_date_format()}"?i("Date Format"):d==="${_bf_user_meta_key()}"?i("Meta Key"):d==="${_bf_query_param()}"?i("Query Param"):"Smart Key",R=d=>r.match(/date|advanced-datetime/g)?d==null?void 0:d.replace(/^'|'$/g,""):d,U=d=>r.match(/date|advanced-datetime/g)&&(d!=null&&d.includes("-"))?`'${d}'`:d,je=["change","null","not_null","on_click"];return e.jsxs("div",{className:`${O(Je.lgcBlk)} btcd-logic-blk`,children:[e.jsxs("div",{className:O(Je.processDgrm),children:[e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Form Fields",value:t,onChange:d=>b(d.target.value,n,p,c),children:[e.jsx("option",{value:"",children:i("Select Form Field")}),!!j.length&&e.jsx("optgroup",{label:"Form Fields",children:j.map(d=>!rt.includes(d.type)&&e.jsx("option",{value:d.key,children:d.name},`ff-lb-${d.key}`))}),_&&e.jsx("optgroup",{label:`General Smart Codes ${ke?"":"(PRO)"}`,children:(he=Be)==null?void 0:he.map(({name:d,label:D})=>e.jsx("option",{value:`\${${d}}`,disabled:!ke,children:D},`ff-rm-${d}`))})]})})}),((ue=A(t))==null?void 0:ue.functionParam)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Field Parameter",onChange:d=>h(d.target.value,n,p,c),value:s.smartKey||"",children:[e.jsx("option",{value:"",children:i("Select Form Field")}),!!j.length&&e.jsx("optgroup",{label:"Form Fields",children:j.map(d=>!d.type.match(/^(file-up|recaptcha)$/)&&e.jsx("option",{value:d.key,children:d.name},`ff-lb-${d.key}`))})]})})}),((fe=A(t))==null?void 0:fe.custom)&&!((T=A(t))!=null&&T.functionParam)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsx(Oe,{label:$(t),type:"text",onChange:d=>h(d.target.value,n,p,c),value:s.smartKey||""})})}),e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:e.jsxs(re,{label:"Logic",value:l,onChange:d=>x(d.target.value,n,p,c),children:[e.jsx("option",{value:"",children:i("Select One")}),w(r).map(({key:d,lbl:D})=>e.jsx("option",{value:d,children:D},d))]})})}),l!=="between"&&l!=="not between"&&!je.includes(l)&&e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:r.match(/user|select|check|radio/g)?e.jsx(Se,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:y||"",onChange:d=>m(d,n,p,c),options:v(),fldType:r,singleSelect:N}):e.jsx(Xe,{label:"Value",type:r.match(/select|check|radio|number|range/g)?"text":r,disabled:l==="null"||l==="not_null",onChange:d=>m(U(d),n,p,c),value:R(y)||"",options:v(),formFields:j})})}),(l==="between"||l==="not between")&&e.jsx("div",{className:"block-wrapper",children:e.jsxs("div",{className:"block-group",children:[e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:F.match(/select|check|radio/g)?e.jsx(Se,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:y.min||"",onChange:d=>m(d,n,p,c,"min"),options:v(),customValue:!0,fldType:F}):e.jsx(Oe,{label:"Min Value",type:r,disabled:l==="null"||l==="not_null",onChange:d=>m(U(d.target.value),n,p,c,"min"),value:R(y.min)||""})})}),e.jsx("div",{className:"block-wrapper",children:e.jsx("div",{className:"block-content",children:F.match(/select|check|radio/g)?e.jsx(Se,{className:"msl-wrp-options btcd-paper-drpdwn",defaultValue:y.max||"",onChange:d=>m(d,n,p,c,"max"),options:v(),customValue:!0,fldType:F}):e.jsx(Oe,{label:"Max Value",type:r,disabled:l==="null"||l==="not_null",onChange:d=>m(U(d.target.value),n,p,c,"max"),value:R(y.max)||""})})})]})})]}),e.jsxs("div",{className:"btcd-li-side-btn",children:[e.jsx(q,{onClick:()=>k(n,p,c),icn:!0,className:"ml-2 white sh-sm",children:e.jsx(_e,{size:"16"})}),e.jsx(q,{onClick:()=>a(n,p,c),icn:!0,className:"ml-2 white mr-2 sh-sm",children:e.jsx(Fe,{size:"16"})}),e.jsxs(q,{onClick:()=>C("and",n,p,c),className:"white mr-2 sh-sm",children:[e.jsx(z,{size:"10",className:"icn-rotate-45 mr-1"}),"AND"]}),e.jsxs(q,{onClick:()=>C("or",n,p,c),className:"white sh-sm",children:[e.jsx(z,{size:"10",className:"icn-rotate-45 mr-1"}),"OR"]})]})]})}const Je={lgcBlk:{pn:"relative",dy:"flex",cg:15,rg:15,my:5,":hover":{bc:"#F0F0F0"}},lgcGrp:{b:"0.5px solid #D5D5D5",brs:8,p:10,ml:20},blkItm:{w:"100%"},processDgrm:{"--linethick":"1px","--linewidth":"1.5em","--line-color":"#b9c5ff",flx:"align-center",w:"100%",m:0,p:0,ls:"none",ta:"center","& > .block-wrapper":{flex:"1 1 auto"},"& .block-wrapper>.block-content":{cr:"#666",brs:10},"& .block-wrapper::before, & .block-wrapper::after, & .block-group::before, & .block-group::after, & .block-content::before, & .block-content::after":{bse:"solid",bcr:"var(--line-color)"},"& .block-wrapper .block-group .block-wrapper:first-child .block-content::before, &  .block-wrapper .block-group .block-wrapper:first-child::before":{btlr:10},"&  .block-wrapper .block-group .block-wrapper:first-child .block-content::after, & .block-wrapper .block-group .block-wrapper:first-child::after":{btrr:10},"&  .block-wrapper .block-group .block-wrapper:last-child .block-content::before, &  .block-wrapper .block-group .block-wrapper:last-child::before":{bblr:10},"&  .block-wrapper .block-group .block-wrapper:last-child .block-content::after, &  .block-wrapper .block-group .block-wrapper:last-child::after":{bbrr:10},"& ol, & .block-group, & .block-wrapper":{ls:"none",ta:"center"},"& .block-wrapper":{pn:"relative",mb:0,w:"100%"},"& > .block-wrapper, & ol > .block-wrapper, & .block-group > .block-wrapper":{p:"4px 0"},"&  .block-group":{pn:"relative",pl:"var(--linewidth)"},"& .block-group::before, &  .block-group::after":{pn:"absolute",ct:'""',tp:"50%",w:"var(--linewidth)",dy:"block",bwh:"var(--linethick) 0 0"},"& .block-group::before":{lt:0},"&  .block-group::after":{rt:0},"&  .block-group>.block-wrapper::after, &  .block-group>.block-wrapper::before":{pn:"absolute",ct:'""',tp:0,bm:0,w:"var(--linewidth)",h:"100%",dy:"block"},"&  .block-group>.block-wrapper::before":{lt:0,bwh:"0 0 0 var(--linethick)"},"&  .block-group>.block-wrapper::after":{rt:0,bwh:"0 var(--linethick) 0 0"},"&  .block-group>.block-wrapper:first-child::before, &  .block-group>.block-wrapper:first-child::after":{tp:"50%",bm:"auto",h:"50%"},"&  .block-group>.block-wrapper:last-child::before, &  .block-group>.block-wrapper:last-child::after":{tp:0,bm:"auto",h:"50%"},"&  .block-group>.block-wrapper:first-child:last-child::before, &  .block-group>.block-wrapper:first-child:last-child::after":{tp:0,bm:"auto",h:"50%"},"&  .block-wrapper>.block-content":{pn:"relative",ml:"var(--linewidth)"},"& >.block-wrapper:first-child>.block-content":{ml:0},"&  .block-wrapper:not(:last-child) .block-wrapper>.block-content":{mr:"var(--linewidth)"},"&  .block-wrapper>.block-content::before, &  .block-wrapper>.block-content::after":{ct:'""',tp:"50%",w:"var(--linewidth)",pn:"absolute",bwh:"var(--linethick) 0 0",h:"50%"},"&  .block-wrapper>.block-content::after":{rt:"calc(0em - var(--linewidth) + 2px)",mr:"calc(0px - var(--linethick))"},"&  .block-wrapper>.block-content::before":{lt:"calc(0em - var(--linewidth) + 2px)",ml:"calc(0px - var(--linethick))"},"&  .block-wrapper:last-child>.block-content::after, & .block-wrapper:last-child>.block-content::before":{tp:0,bwh:"0 0 var(--linethick)"},"& >.block-wrapper:first-child>.block-content::before, & >.block-wrapper:first-child>.block-group::before, & >.block-wrapper:first-child>.block-group>.block-wrapper::before, & >.block-wrapper:first-child>.block-group>.block-wrapper>.block-content:first-child::before, & >.block-wrapper:first-child>.block-group>.block-wrapper>ol>.block-wrapper:first-child>.block-content::before, & >.block-wrapper:last-child>.block-content::after, & >.block-wrapper:last-child>.block-group::after":{b:0},"& >.block-wrapper>.block-content::after,  &  ol>.block-wrapper>.block-content::after, & >.block-wrapper>.block-group::after,  &  ol>.block-wrapper>.block-group::after":{dy:"none"},"& >.block-wrapper>.block-content, &  ol>.block-wrapper>.block-content":{mr:0},"& >.block-wrapper>.block-group,  &  ol>.block-wrapper>.block-group":{pr:0},"& >.block-wrapper:last-child>.block-content::after,  &  ol>.block-wrapper:last-child>.block-content::after,  & >.block-wrapper:last-child>.block-group::after,  &  ol>.block-wrapper:last-child>.block-group::after":{dy:"block"},"& >.block-wrapper:last-child>.block-content, & ol>.block-wrapper:last-child>.block-content":{mr:0},"&  .block-wrapper:last-child>.block-group::after,  &  .block-wrapper:last-child>.block-group>.block-wrapper::after,  &  .block-wrapper:last-child>.block-group>.block-wrapper>.block-content::after":{dy:"none"}}};function We({logic:s,nested:t,onChange:a,className:n=null}){return e.jsx("div",{children:e.jsxs("select",{value:s,onChange:a,className:`btcd-logic-chip ${n} ${t&&"scl-8"}`,children:[e.jsx("option",{value:"or",children:i("OR")}),e.jsx("option",{value:"and",children:i("AND")})]})})}function Et({lgcGrp:s,lgcGrpInd:t,condGrp:a,condGrpInd:n}){var F;const{css:p}=X(),[c,y]=le(Z),C=J(K),k=Y(Ae),x=(o,u,v)=>{const g=B(c,A=>{const w=A[t].conditions[n].logics;if(w.length>1)if(v!==void 0)if(w[o][u].length===v+1)if(w[o][u].length===3){const $=w[o][u][v-2];w[o].splice(u,1),w[o].push($)}else w[o][u].splice(v-1,2);else if(w[o][u].length===3){const $=w[o][u][v+2];w[o].splice(u,1),w[o].push($)}else w[o][u].splice(v,2);else if(u!==void 0)if(w[o].length===u+1)if(w[o].length===3){const $=w[o][u-2];w.splice(o,1),w.splice(o,0,$)}else w[o].splice(u-1,2);else if(w[o].length===3){const $=w[o][u+2];w.splice(o,1),w.splice(o,0,$)}else w[o].splice(u,2);else o!==0?w.splice(o-1,2):w.splice(o,2)});y(g),C(A=>W(S({},A),{unsaved:!0}))},l=(o,u,v,g)=>{const A=B(c,w=>{const $=w[t].conditions[n].logics;g!==void 0?(o==="null"&&($[u][v][g].val=""),$[u][v][g].logic=o):v!==void 0?(o==="null"&&($[u][v].val=""),$[u][v].logic=o):(o==="null"&&($[u].val=""),$[u].logic=o)});y(A),C(w=>W(S({},w),{unsaved:!0}))},m=(o,u,v,g)=>{const A=B(c,w=>{const $=w[t].conditions[n].logics;g!==void 0?$[u][v][g]=o:v!==void 0?$[u][v]=o:$[u]=o});y(A),C(w=>W(S({},w),{unsaved:!0}))},h=(o,u,v,g)=>g!==void 0?o[u][v][g]:v!==void 0?o[u][v]:o[u],b=(o,u,v,g,A="")=>{const w=B(c,$=>{const R=$[t].conditions[n].logics,U=h(R,u,v,g);A?(typeof U.val=="string"&&(U.val={}),U.val[A]=o):U.val=o});y(w),C($=>W(S({},$),{unsaved:!0}))},_=(o,u,v,g)=>{const A=Be.find($=>$.name===o),w=B(c,$=>{const R=$[t].conditions[n].logics,U=h(R,u,v,g);U.field=o,typeof U.val=="undefined"&&(U.val=""),A!=null&&A.custom||delete U.smartKey});y(w),C($=>W(S({},$),{unsaved:!0}))},j=(o,u,v,g)=>{const A=B(c,w=>{const $=w[t].conditions[n].logics;g!==void 0?$[u][v].splice(g+1,0,o,{field:"",logic:"",val:""}):v!==void 0?$[u].splice(v+1,0,o,{field:"",logic:"",val:""}):$.splice(u+1,0,o,{field:"",logic:"",val:""})});y(A),C(w=>W(S({},w),{unsaved:!0}))},O=(o,u,v)=>{let g=v!==void 0?c[t].conditions[n].logics[o][u][v-1]:u!==void 0?c[t].conditions[n].logics[o][u-1]:c[t].conditions[n].logics[o-1];g==="and"||g==="or"||(g="and");const A=B(c,w=>{const $=w[t].conditions[n].logics;if(v!==void 0){const R=S({},$[o][u][v]);$[o][u].splice(v+1,0,g,R)}else if(u!==void 0){const R=S({},$[o][u]);$[o].splice(u+1,0,g,R)}else{const R=S({},$[o]);$.splice(o+1,0,g,R)}});y(A),C(w=>W(S({},w),{unsaved:!0}))},f=(o,u,v,g)=>{const A=B(c,w=>{const $=w[t].conditions[n].logics,R=h($,u,v,g);R.smartKey=o});y(A),C(w=>W(S({},w),{unsaved:!0}))},N=(o,u)=>{if(s.action_type!=="oninput")return!0;const v=o.findIndex(g=>g.field&&g.field in k);return v>=0&&v!==u},r=(o,u,v=0)=>{const g=[o],A={field:"",logic:"",val:""};v?g.push([A,o,A]):g.push(A),y(w=>B(w,$=>{const{logics:R}=w[t].conditions[n],U=[...R[u],...g];$[t].conditions[n].logics[u]=U}))};return(F=a==null?void 0:a.logics)==null?void 0:F.map((o,u)=>e.jsxs("span",{children:[typeof o=="object"&&!Array.isArray(o)&&e.jsx(Te,{logic:o,fieldVal:o.field,changeFormField:_,changeValue:b,changeSmartKey:f,logicValue:o.logic,changeLogic:l,addInlineLogic:j,cloneInLineLogic:O,delLogic:x,lgcGrpInd:t,lgcInd:u,value:o.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:N(a.logics,u),formFields:we(a)}),typeof o=="string"&&e.jsx(We,{logic:o,onChange:v=>m(v.target.value,u)}),Array.isArray(o)&&e.jsxs("div",{className:"p-2 br-10 btcd-logic-grp mt-2 mb-2 pl-4 pr-4",children:[o.map((v,g)=>e.jsxs("span",{children:[typeof v=="object"&&!Array.isArray(v)&&e.jsx(Te,{logic:v,fieldVal:v.field,changeFormField:_,changeValue:b,changeSmartKey:f,logicValue:v.logic,changeLogic:l,addInlineLogic:j,cloneInLineLogic:O,delLogic:x,lgcGrpInd:t,lgcInd:u,subLgcInd:g,value:v.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:N(o,g),formFields:we(a)}),typeof v=="string"&&e.jsx(We,{logic:v,nested:!0,onChange:A=>m(A.target.value,u,g)}),Array.isArray(v)&&e.jsxs("div",{className:"p-2 br-10 btcd-logic-grp mt-2 mb-2 pl-4 pr-4",children:[v.map((A,w)=>e.jsxs("span",{children:[typeof A=="object"&&!Array.isArray(A)&&e.jsx(Te,{logic:A,fieldVal:A.field,changeFormField:_,changeValue:b,changeSmartKey:f,logicValue:A.logic,changeLogic:l,addInlineLogic:j,cloneInLineLogic:O,delLogic:x,lgcGrpInd:t,lgcInd:u,subLgcInd:g,subSubLgcInd:w,value:A.val,actionType:s==null?void 0:s.action_type,smartTagAllowed:N(v,w),formFields:we(a)}),typeof A=="string"&&e.jsx(We,{logic:A,nested:!0,onChange:$=>m($.target.value,u,g,w)})]},`subsubLogic-${w+90}`)),e.jsxs(Ne,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>j("and",u,g,v.length),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>j("or",u,g,v.length),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]})]})]})]})]},`subLogic-${g*7}`)),e.jsxs(Ne,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>r("and",u),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>r("or",u),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]}),e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>r("and",u,1),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND Group"]}),e.jsxs("button",{type:"button",className:p(ce.addItemBtn),onClick:()=>r("or",u,1),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR Group"]})]})]})]})]},`logic-${u+44}`))}const ce={addItemBtn:{dy:"block",w:"100%",b:0,oe:0,brs:8,ta:"left",cr:"#444",fs:12,fw:500,p:5,pr:20,bd:"none",curp:1,":hover":{bc:"#EFEFEF"}}};function Mt({lgcGrpInd:s,lgcGrp:t}){var k;const{css:a}=X(),n=J(Z),p=J(K),c=x=>x.replace(/-/g," ").split(" ").map(l=>dt(l)).join(" "),y=x=>{Re(),n(l=>B(l,m=>{const{conditions:h}=m[s],b=W(S({},ve),{cond_type:x});x==="else"&&delete b.logics,x==="else-if"&&h[h.length-1].cond_type==="else"?h.splice(h.length-1,0,b):h.push(b)})),p(l=>W(S({},l),{unsaved:!0}))},C=(x,l,m="",h=0)=>{Re();const b=[x],_={field:"",logic:"",val:""};h?b.push([_,x,_]):b.push(_),n(j=>B(j,O=>{let f=O[s].conditions[l].logics;f=gt(f,m),f.push(...b)})),p(j=>W(S({},j),{unsaved:!0}))};return e.jsxs("div",{className:a(se.container),children:[e.jsxs("div",{className:a(se.section),children:[t.action_behaviour==="cond"&&e.jsxs("div",{className:a(se.sideBdr),children:[e.jsx("div",{className:a(se.sideBdrLn)}),e.jsx("div",{className:a(se.sideBdrCrl)})]}),(k=t==null?void 0:t.conditions)==null?void 0:k.map((x,l)=>e.jsxs(ge.Fragment,{children:[t.action_behaviour==="cond"&&x.cond_type!=="else"&&e.jsxs(ze,{title:c(x.cond_type),accordionActions:x.cond_type!=="if"&&e.jsx(He,{lgcGrpInd:s,condGrpInd:l}),children:[e.jsx(Et,{lgcGrp:t,lgcGrpInd:s,condGrp:x,condGrpInd:l}),e.jsx("div",{className:"mt-1",children:e.jsxs(Ne,{place:"bottom",children:[e.jsx(ae,{msg:"Add Logic",children:e.jsx(q,{icn:!0,className:"blue sh-sm",children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:a(se.addItemBtn),onClick:()=>C("and",l),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND"]}),e.jsxs("button",{type:"button",className:a(se.addItemBtn),onClick:()=>C("or",l),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR"]}),e.jsxs("button",{type:"button",className:a(se.addItemBtn),onClick:()=>C("and",l,"",1),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add AND Group"]}),e.jsxs("button",{type:"button",className:a(se.addItemBtn),onClick:()=>C("or",l,"",1),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),"Add OR Group"]})]})]})})]},x.cond_type+0),t.action_behaviour==="cond"&&e.jsx(ze,{title:x.cond_type==="else"?"Else":"Then",titleOutline:x.cond_type!=="else",accordionActions:x.cond_type==="else"&&e.jsx(He,{lgcGrpInd:s,condGrpInd:l,add:!1,clone:!1}),children:e.jsx(qe,{lgcGrp:t,lgcGrpInd:s,condGrp:x,condGrpInd:l})},x.cond_type+1),t.action_behaviour!=="cond"&&e.jsx(qe,{lgcGrp:t,lgcGrpInd:s,condGrp:x,condGrpInd:l})]},`wkf-${l+99}`))]}),t.action_behaviour==="cond"&&e.jsxs(Ne,{place:"bottom",children:[e.jsx(ae,{msg:"Add Condition",children:e.jsx(q,{icn:!0,className:"blue sh-sm ml-2",children:e.jsx(z,{size:"14",className:"icn-rotate-45"})})}),e.jsxs("div",{children:[e.jsxs("button",{type:"button",className:a(se.addItemBtn),onClick:()=>y("else-if"),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),'Add "Else If"']}),t.conditions[t.conditions.length-1].cond_type!=="else"&&e.jsxs("button",{type:"button",className:a(se.addItemBtn),onClick:()=>y("else"),children:[e.jsx(z,{size:"9",className:"icn-rotate-45 mr-1"}),'Add "Else"']})]})]})]})}const He=({lgcGrpInd:s,condGrpInd:t,add:a,clone:n,remove:p})=>{const[c,y]=ge.useState({show:!1}),C=J(Z),k=J(K),x=()=>{y({show:!1})},l=()=>{y({show:!1}),C(j=>B(j,O=>{O[s].conditions.splice(t,1)})),k(j=>W(S({},j),{unsaved:!0}))},m=()=>{y({btnTxt:"Delete",body:"Are you sure to delete this logic?",btnClass:"",action:()=>{l(),x()},show:!0})},h=()=>{C(j=>B(j,O=>{O[s].conditions.splice(t+1,0,mt(O[s].conditions[t]))})),k(j=>W(S({},j),{unsaved:!0}))},b=()=>{C(j=>B(j,O=>{O[s].conditions.splice(t+1,0,W(S({},ve),{cond_type:"else-if"}))})),k(j=>W(S({},j),{unsaved:!0}))},_=j=>typeof j=="boolean"?j:!0;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[_(a)&&e.jsx(ae,{msg:"Add Else If",children:e.jsx(q,{onClick:b,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(wt,{size:"16"})})}),_(n)&&e.jsx(ae,{msg:"Clone",children:e.jsx(q,{onClick:h,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(_e,{size:"16"})})}),_(p)&&e.jsx(ae,{msg:"Delete",children:e.jsx(q,{onClick:m,icn:!0,className:"white ml-2 sh-sm",children:e.jsx(Fe,{size:"16"})})})]}),e.jsx(Ye,{show:c.show,close:x,btnTxt:c.btnTxt,btnClass:c.btnClass,body:c.body,action:c.action})]})},se={container:{mt:10},section:{pn:"relative",w:"100%",zx:1,mb:10,pb:10},sideBdr:{flx:"center",fd:"column",w:50,pn:"absolute",h:"100%",zx:-1},sideBdrLn:{w:2,bc:"var(--b-50)",h:"100%"},sideBdrCrl:{brs:"50%",bc:"var(--b-50)",h:8,w:8,mt:-1},addItemBtn:{dy:"block",w:"100%",b:0,oe:0,brs:8,ta:"left",cr:"#444",fs:12,fw:500,p:5,pr:20,bd:"none",curp:1,":hover":{bc:"#EFEFEF"}}};function Dt({lgcGrpInd:s,lgcGrp:t}){var x;const[a,n]=le(Z),p=J(K),{css:c}=X(),y=l=>{const m=B(a,h=>{l==="delete"?delete h[s].action_type:h[s].action_type===void 0&&(h[s].action_type="onload"),h[s].action_run=l});n(m),p(h=>W(S({},h),{unsaved:!0}))},C=l=>{const m=B(a,h=>{l==="onsubmit"&&h[s].conditions.forEach(_=>{var O,f;const j=(f=(O=_.actions)==null?void 0:O.fields)==null?void 0:f.length;for(let N=0;N<j;N+=1)_.actions.fields[N].action="value"}),l!=null&&l.match(/^(onvalidate|oninput)$/)&&(h[s].action_behaviour="cond"),h[s].conditions.forEach(_=>{l==="onvalidate"?(_.actions.failure||(_.actions.failure=""),delete _.actions.fields,delete _.actions.success):(_.actions.fields||(_.actions.fields=[{field:"",action:"value"}]),_.actions.success||(_.actions.success=[]),delete _.actions.failure)});const[b]=h[s].conditions;b.cond_type="if",b.logics||(b.logics=ve.logics),h[s].action_type=l});n(m),p(h=>W(S({},h),{unsaved:!0}))},k=l=>{const m=B(a,h=>{h[s].action_behaviour=l;const[b]=h[s].conditions;b.cond_type=l==="cond"?"if":l,l==="always"?delete b.logics:l==="cond"&&(b.logics=ve.logics),h[s].conditions=[b]});n(m),p(h=>W(S({},h),{unsaved:!0}))};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Run When:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[e.jsx(G,{radio:!0,onChange:l=>y(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Create/Edit")}),checked:t.action_run==="create_edit",value:"create_edit"}),e.jsx(G,{radio:!0,onChange:l=>y(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Create")}),checked:t.action_run==="create",value:"create"}),e.jsx(G,{radio:!0,onChange:l=>y(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Edit")}),checked:t.action_run==="edit",value:"edit"}),e.jsx(G,{radio:!0,onChange:l=>y(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Record Delete")}),checked:t.action_run==="delete",value:"delete"})]})]}),t.action_run!=="delete"&&e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Effect:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[e.jsxs("div",{className:c(Pt.actionEffectGroup),children:[e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Always")}),checked:t.action_type==="always",value:"always"}),e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Load")}),checked:t.action_type==="onload",value:"onload"}),e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Field Input")}),checked:t.action_type==="oninput",value:"oninput"})]}),e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Validate")}),checked:t.action_type==="onvalidate",value:"onvalidate"}),e.jsx(G,{radio:!0,onChange:l=>C(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Only on Form Submit")}),checked:t.action_type==="onsubmit",value:"onsubmit"})]})]}),e.jsxs("div",{children:[e.jsx("b",{className:"txt-dp",children:e.jsx("small",{children:"Action Behaviour:"})}),e.jsx("br",{}),e.jsxs("div",{className:"ml-2",children:[!((x=t==null?void 0:t.action_type)!=null&&x.match(/^(onvalidate|oninput)$/))&&e.jsx(G,{radio:!0,onChange:l=>k(l.target.value),name:`ab-${s+121}`,title:e.jsx("small",{className:"txt-dp",children:i("Always")}),checked:t.action_behaviour==="always",value:"always"}),e.jsx(G,{radio:!0,onChange:l=>k(l.target.value),title:e.jsx("small",{className:"txt-dp",children:i("Condition")}),checked:t.action_behaviour==="cond",value:"cond"})]})]})]})}const Pt={actionEffectGroup:{dy:"inline-block",b:"1px solid var(--gray-3)",brs:8}};function Gt(){const s=Y(pt),[t,a]=ge.useState({show:!1}),[n,p]=le(Z),c=J(K),{css:y}=X(),C=Y(Qe),{isPro:k}=C,x=f=>{switch(f){case"onload":return i("On Load");case"oninput":return i("On Field Input");case"onvalidate":return i("On Form Validate");case"onsubmit":return i("On Form Submit");case"create_edit":return i("Record Create/Edit");case"create":return i("Record Create");case"edit":return i("Record Edit");case"delete":return i("Record Delete");case"always":return i("Always");case"cond":return i("With Condition")}},l=()=>{const f=B(n,N=>{N.unshift({title:`Action ${n.length+1}`,action_type:"always",action_run:"create_edit",action_behaviour:"cond",conditions:[S({},ve)]})});p(f),c(N=>W(S({},N),{unsaved:!0}))},m=f=>{if(n[f].id){const N=ht({formID:s,id:n[f].id},"bitforms_delete_workflow").then(r=>{if(r!==void 0&&r.success){const F=B(n,o=>{o.splice(f,1)});p(F)}});ut.promise(N,{success:"Successfully Deleted.",loading:"Deleting...",error:"Error occurred, Try again."})}else{const N=B(n,r=>{r.splice(f,1)});p(N)}},h=(f,N)=>{const r=B(n,F=>{F[N].title=f.target.value});p(r),c(F=>W(S({},F),{unsaved:!0}))},b=()=>{t.show=!1,a(S({},t))},_=f=>{t.btnTxt="Delete",t.body="Are you sure to delete this conditional logic?",t.btnClass="",t.action=()=>{m(f),b()},t.show=!0,a(S({},t))},j=f=>{const N=B(n,r=>{const F=S({},r[f]);F.title=`${F.title} (Clone-${n.length+1})`,delete F.id,r.splice(f+1,0,F)});p(N)},O=({oldIndex:f,newIndex:N})=>{f!==N&&(p(r=>kt(r,f,N)),c(r=>W(S({},r),{unsaved:!0})))};return e.jsxs("div",{className:"btcd-workflow",style:{width:"93%"},children:[e.jsx(Ye,{show:t.show,close:b,btnTxt:t.btnTxt,btnClass:t.btnClass,body:t.body,action:t.action}),e.jsx("h2",{children:i("Conditional Logics")}),e.jsxs("h5",{children:["How to configure conditional logics: Â ",e.jsx("a",{href:Pe.conditionalLogic.link,target:"_blank",rel:"noreferrer",className:"yt-txt ml-1 mr-1",children:"YouTube"}),e.jsx("a",{href:Pe.conditionalLogicDoc.link,target:"_blank",rel:"noreferrer",className:"doc-txt",children:"Documentation"})]}),(!k&&!n.length||k)&&e.jsxs(q,{className:"blue",onClick:l,children:[e.jsx(z,{size:"10",className:"icn-rotate-45 mr-1"}),i("Add Conditional Logic")]}),n.length===0&&e.jsxs("div",{className:y(H.btcdEmpty,H.txCenter),children:[e.jsx(vt,{size:"50"}),i("Empty")]}),e.jsx(ft,{onSortEnd:O,useDragHandle:!0,children:n.map((f,N)=>e.jsxs(xt,{index:N,children:[e.jsxs("div",{className:"workflow-grp d-flx mt-2",children:[e.jsxs(jt,{customTitle:e.jsx(bt,{className:"workflow-drg-handle mr-1 flx"}),title:f.title,header:e.jsxs("small",{className:"f-right txt-dp mr-4",children:[e.jsxs("span",{className:"mr-2",children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),x(f.action_run)]}),f.action_type!==void 0&&e.jsxs("span",{className:"mr-2",children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),x(f.action_type)]}),e.jsxs("span",{children:[e.jsx("i",{className:"btcd-chat-dot mr-1"}),x(f.action_behaviour)]})]}),titleEditable:!0,onTitleChange:r=>h(r,N),notScroll:!0,cls:k?"w-9":"w-10",children:[e.jsx(Dt,{lgcGrpInd:N,lgcGrp:f}),e.jsx(Mt,{lgcGrpInd:N,lgcGrp:f})]}),k&&e.jsxs("div",{className:"mt-2 flx flx-start",children:[e.jsx(q,{onClick:()=>j(N),icn:!0,className:"ml-2 sh-sm btcd-menu-btn tooltip",style:{"--tooltip-txt":'"Clone Action"'},children:e.jsx(_e,{size:"16"})}),e.jsx(q,{onClick:()=>_(N),icn:!0,className:"sh-sm btcd-menu-btn tooltip",style:{"--tooltip-txt":'"Delete Action"'},children:e.jsx(Fe,{size:"16"})})]})]}),!k&&e.jsxs("div",{className:"txt-center bg-pro p-5 mt-2",children:[i("For"),"Â ",e.jsx("span",{className:"txt-pro",children:i("UNLIMITED")}),"Â ",i("Conditional Logics"),",Â ",e.jsx("a",{href:"https://www.bitapps.pro/bit-form",target:"_blank",rel:"noreferrer",children:e.jsx("b",{className:"txt-pro",children:i("Buy Premium")})})]})]},`workflows-grp-${N+13}`))}),n.length>1&&e.jsxs("div",{className:y(H.w9,{fs:13},H.mt4),children:[e.jsx("strong",{children:"Note: "}),"Conditional Logics are triggered based on the order of the logic groups. The higher the logic group, the higher the priority. If you want to change the priority, you can sort by drag and drop the logic group."]})]})}export{Gt as default};
