(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[1841],{3075:e=>{e.exports=function(){return this.wp.i18n}()},8601:e=>{e.exports=function(){return this.wp.element}()},11431:e=>{e.exports=function(){return this.wp.a11y}()},17232:e=>{e.exports=function(){return this.wp.domReady}()},31987:e=>{e.exports=function(){return this.wp.data}()},32633:(e,t,n)=>{"use strict";n.d(t,{wn:()=>E,X$:()=>v});var l=n(58168),r=n(51609),o=n(54625),a=n(39959),i=n(3075),s=n(89897),c=n(8601),d=n(88356),m=n(98883),u=n(47926),p=n(81923),f=n(16718),g=n(43345);const h=(0,f.SL)(g.Ay),b=(0,p.A)(h,{target:"ejy4qm0"})(".itsec-rjsf-object-fieldset{display:grid;grid-template-columns:[label fields] minmax(0, 1fr);grid-template-rows:auto;grid-gap:.5rem 0;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){grid-template-columns:[label] 10rem [fields] minmax(0, 1fr);}}.itsec-rjsf-section-description{margin-top:0;grid-column:fields;}>.field-object>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field,&>.itsec-rjsf-section-title{grid-column:label;font-size:1rem;padding-right:1rem;margin-top:0;&:not(:first-child){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;@media (min-width: ",(({theme:{breaks:e}})=>e.small),"px){&+*{border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:.5rem;padding-top:1rem;}}}}&>.form-group:not(.field-object){grid-column:label/fields-end;}&>.itsec-rjsf-section-title~.form-group{grid-column:fields;}&>.itsec-rjsf-section-title:has(+ .itsec-highlighted-search-result){border-left:5px solid ",(({theme:e})=>e.colors.border.info),";background:#f9f7fd;margin-bottom:0;padding-top:1rem!important;}&>.field-object{grid-column:label/fields-end;}&>.field-description{margin-top:0;}}.itsec-rjsf-object-fieldset>*>.itsec-rjsf-object-fieldset{&>.itsec-rjsf-title-field{grid-column:label;font-size:1rem;padding-right:1rem;}&>.form-group{grid-column:fields;}&>.field-description{grid-column:fields;margin-top:0;}}.components-base-control__label,.components-input-control__label,label,caption,legend{color:",(({theme:e})=>e.colors.text.dark),";}.itsec-highlighted-search-result{background:#f9f7fd;padding-bottom:1rem;padding-top:1rem!important;.components-base-control__label,.components-input-control__label,label,caption{border-bottom:3px solid ",(({theme:e})=>e.colors.border.info),";padding-bottom:3px;margin-bottom:6px;}.components-base-control__field{margin-bottom:12px;}}.field-object:not(:first-child):not(:empty){border-top:1px solid ",(({theme:e})=>e.colors.border.normal),";margin-top:1rem;padding-top:1rem;}.field-object:empty{display:none;}.itsec-rjsf-title-field+.field-object:not(:first-child),.itsec-rjsf-section-description+.field-object:not(:first-child){border-top:none;margin-top:0;padding-top:0;}");function E({saveLabel:e,isSaving:t,saveDisabled:n,cancelLabel:o,onCancel:i,cancelRoute:c,undoLabel:d,undoDisabled:m,onUndo:p,children:f,errors:g,apiError:h,schemaError:b,withCard:x,alignActions:_,...w}){let S=(0,s.useInstanceId)(E,"itsec-schema-form");S=w.id||S;const C=(0,r.createElement)(React.Fragment,null,(0,r.createElement)(u.VS,{errors:g,apiError:h,schemaError:b}),(0,r.createElement)(v,(0,l.A)({},w,{id:S})));return(0,r.createElement)(a.Flex,{direction:"column",gap:7,justify:"start",expanded:!1},(0,r.createElement)(a.FlexItem,null,x&&(0,r.createElement)(a.Card,null,(0,r.createElement)(a.CardBody,null,C)),!x&&C),(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(y,{id:S,saveLabel:e,cancelLabel:o,isSaving:t,saveDisabled:n,onCancel:i,cancelRoute:c,undoLabel:d,undoDisabled:m,onUndo:p,align:_},f)))}const v=(0,c.forwardRef)((({className:e,...t},n)=>(0,r.createElement)(b,(0,l.A)({},t,{ref:n,className:e}),(0,r.createElement)(React.Fragment,null))));function y({id:e,saveLabel:t=(0,i.__)("Save","better-wp-security"),isSaving:n,saveDisabled:l,cancelLabel:s=(0,i.__)("Cancel","better-wp-security"),onCancel:c,cancelRoute:p,undoLabel:f=(0,i.__)("Undo Changes","better-wp-security"),undoDisabled:g,onUndo:h,align:b,children:E}){return(0,r.createElement)(a.Flex,{align:b},c&&(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(d.$n,{variant:"tertiary",type:"button",onClick:c},s)),p&&(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(o.N_,{component:(0,m.kk)(d.$n),variant:"tertiary",type:"button",to:p},s)),!b&&(0,r.createElement)(u.g8,null),E,h&&(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(d.$n,{variant:"secondary",disabled:g,onClick:h},f)),(0,r.createElement)(a.FlexItem,null,(0,r.createElement)(d.$n,{variant:"primary",isBusy:n,disabled:n||l,form:e,type:"submit"},t)))}},38125:e=>{e.exports=function(){return this.wp.plugins}()},39959:e=>{e.exports=function(){return this.wp.components}()},40747:(e,t,n)=>{"use strict";n.r(t),n.d(t,{AfterImportExportToolsFill:()=>Y,BeforeImportExportToolsFill:()=>X,ExportFill:()=>Q,PageContainer:()=>H,PageHeader:()=>y,ToolFill:()=>P});var l=n(51609),r=n(8601),o=n(17232),a=n.n(o),i=n(3075),s=n(81923),c=n(56347),d=n(7e3),m=n(79487),u=n(39959),p=n(38125),f=n(88356),g=n(47926),h=n(54625),b=n(47406),E=n(98883);const v=(0,s.A)(h.N_,{target:"e1jry2z10"})({name:"8dk3vg",styles:"margin-bottom:1rem"});function y(){const{pathname:e}=(0,c.zy)();return(0,l.createElement)("header",null,"/tools"!==e&&(0,l.createElement)(v,{to:"/tools",component:(0,E.kk)(f.$n),icon:b.A,variant:"tertiary",text:(0,i.__)("Back to list","better-wp-security")}),(0,l.createElement)(f.DZ,{level:1,text:(0,i.__)("Tools","better-wp-security"),weight:f.uL.NORMAL}),(0,l.createElement)(f.EY,{size:f.$C.SMALL,variant:f.J3.MUTED,text:(0,i.__)("Advanced tools to help you manage your siteâ€™s security.","better-wp-security")}))}var x=n(58168),_=n(46942),w=n.n(_),S=n(66087),C=n(89897),N=n(31987),A=n(46627),F=n(32633),k=n(62932);const O=(0,s.A)("div",{target:"e13vre549"})({name:"1cwpjew",styles:"display:grid;grid-template-columns:repeat( auto-fit, minmax(min(800px, 100%), 1fr) );gap:2rem;margin-top:1rem"}),L=(0,s.A)(u.Card,{target:"e13vre548"})("display:flex;flex-direction:column;margin-bottom:0.75rem;box-shadow:none!important;border:1px solid ",(({theme:e})=>e.colors.border.normal),";>div:first-child{display:flex;flex-direction:column;}"),j=(0,s.A)(f.DZ,{target:"e13vre547"})({name:"ol9ofu",styles:"font-size:0.875rem"}),I=(0,s.A)(u.CardBody,{target:"e13vre546"})({name:"v1mh8",styles:"flex-grow:2;display:flex;flex-direction:column"}),R=(0,s.A)("div",{target:"e13vre545"})({name:"1gok8e8",styles:"margin-bottom:0.5rem"}),T=(0,s.A)("div",{target:"e13vre544"})({name:"1k0t4vh",styles:"width:90%"}),D=(0,s.A)(g.VK,{target:"e13vre543"})("font-size:0.75rem;color:",(({theme:e})=>e.colors.text.muted),";"),$=(0,s.A)("div",{target:"e13vre542"})({name:"l2ils0",styles:"flex:0 0 90%"}),B=(0,s.A)("div",{target:"e13vre541"})("display:flex;margin-top:auto;@media screen and (min-width: ",(({theme:e})=>e.breaks.medium),"px){flex-direction:",(({hasMessage:e})=>e?"column":"row"),";}"),M=(0,s.A)(f.Mf,{target:"e13vre540"})({name:"14mfhm0",styles:"margin:0.5rem 0"});function K(){const{tools:e,activeModules:t,isLoaded:n}=(0,N.useSelect)((e=>({tools:e(A.toolsStore).getResolvedTools(),activeModules:e(A.MODULES_STORE_NAME).getActiveModules(),isLoaded:e(A.toolsStore).hasFinishedResolution("getTools")})),[]),o=(0,r.useMemo)((()=>e.filter((e=>t.includes(e.module)&&!1!==e.available))),[e,t]);return(0,l.createElement)(O,null,o.length>0&&n&&o.map((e=>(0,l.createElement)(q,{key:e.slug,tool:e}))))}function q({tool:e,className:t,...n}){const{result:o,isRunning:a}=(0,N.useSelect)((t=>({result:t(A.toolsStore).getLastResult(e.slug),isRunning:t(A.toolsStore).isRunning(e.slug)})),[e.slug]),[i,s]=(0,r.useState)([]);return(0,r.useEffect)((()=>s([])),[e]),(0,l.createElement)(L,(0,x.A)({className:w()(t,"itsec-tool"),isRounded:!0,size:"small"},n),(0,l.createElement)(u.CardHeader,{size:"small"},(0,l.createElement)(j,{level:3,variant:f.J3.DARK,weight:600,text:e.title})),(0,l.createElement)(I,null,(0,l.createElement)(V,{result:o,schemaError:i}),(0,l.createElement)(T,null,(0,l.createElement)(f.EY,{variant:f.J3.DARK,text:e.description}),e.help&&(0,l.createElement)(D,{content:e.help,tagName:"p"})),(0,l.createElement)(z,{tool:e.slug}),(0,l.createElement)(W,{tool:e,setSchemaError:s,isRunning:a})))}function V({result:e,schemaError:t}){var n,r,o;return(0,l.createElement)(R,null,(0,l.createElement)(g.VS,{schemaError:t,apiError:e?.error}),(0,l.createElement)(f.Mf,{messages:null!==(n=e?.success)&&void 0!==n?n:[],type:"success"}),(0,l.createElement)(f.Mf,{messages:null!==(r=e?.warning)&&void 0!==r?r:[],type:"warning"}),(0,l.createElement)(f.Mf,{messages:null!==(o=e?.info)&&void 0!==o?o:[],type:"info"}))}function W({tool:e,setSchemaError:t,isRunning:n}){const o=function(e){const{activeModules:t,settings:n}=(0,N.useSelect)((t=>({settings:(0,S.mapValues)(e.condition?.settings||{},((e,n)=>t(A.MODULES_STORE_NAME).getSettings(n))),activeModules:t(A.MODULES_STORE_NAME).getActiveModules()})),[e]);if(!e.condition)return!0;if(e.condition["active-modules"])for(const n of e.condition["active-modules"])if(!t?.includes(n))return!1;if(e.condition.settings){const t=(0,k.qD)();for(const[l,r]of Object.entries(e.condition.settings))if(!t.compile(r)(n[l]))return!1}return!0}(e),a=(0,C.useInstanceId)(W,"itsec-tool-form"),s=(0,r.useMemo)((()=>({disableInlineErrors:!0,tool:e.slug})),[e.slug]),{runTool:c}=(0,N.useDispatch)(A.toolsStore),d=!o&&e.condition?.description;return(0,l.createElement)(B,{hasMessage:d},e.form&&o&&(0,l.createElement)($,null,(0,l.createElement)(F.X$,{id:a,idPrefix:`itsec_tool_${e.slug}`,schema:e.form,uiSchema:e.form.uiSchema,formContext:s,showErrorList:!1,onError:t,onSubmit:({formData:n})=>{t([]),c(e.slug,n)}})),!o&&e.condition?.description&&(0,l.createElement)(M,{type:"warning",messages:[e.condition.description]}),(0,l.createElement)(u.Flex,{className:"itsec-tool__actions",justify:"flex-end",align:"flex-end"},(0,l.createElement)(u.FlexItem,null,(0,l.createElement)(f.$n,{variant:"primary",className:"itsec-tool__trigger",type:e.form?"submit":"button",form:e.form?a:void 0,onClick:e.form?void 0:()=>c(e.slug),isBusy:n,disabled:!o},(0,i.__)("Run","better-wp-security"))),(0,l.createElement)(z,{tool:e.slug,fillProps:{isActive:o},area:"actions"},(e=>r.Children.map(e,((e,t)=>(0,l.createElement)(r.Fragment,{key:t},e&&(0,l.createElement)(u.FlexItem,null,e))))))))}function P({tool:e,area:t="main",...n}){return(0,l.createElement)(u.Fill,(0,x.A)({name:`Tool${t}${e}`},n))}function z({tool:e,area:t="main",...n}){return(0,l.createElement)(u.Slot,(0,x.A)({name:`Tool${t}${e}`},n))}const H=(0,s.A)("div",{target:"e1h1ua4f1"})({name:"94gy5t",styles:"width:100%;max-width:1680px;align-self:center;padding:1rem 1.25rem"}),U=(0,s.A)(f.DZ,{target:"e1h1ua4f0"})({name:"akdqam",styles:"margin-top:1rem"}),{Slot:J,Fill:X}=(0,u.createSlotFill)("BeforeImportExportTools"),{Slot:G,Fill:Y}=(0,u.createSlotFill)("AfterImportExportTools"),{Slot:Z,Fill:Q}=(0,u.createSlotFill)("Export");function ee(){const[e,t]=(0,r.useState)(!1);return(0,l.createElement)(H,null,(0,l.createElement)(y,null),(0,l.createElement)(J,null,(e=>(0,l.createElement)(te,{fills:e,setHasTools:t}))),e&&(0,l.createElement)(U,{level:2,size:f.$C.LARGE,variant:f.J3.DARK,weight:600,text:(0,i.__)("Additional Tools","better-wp-security")}),(0,l.createElement)(K,null),(0,l.createElement)(G,null))}function te({fills:e,setHasTools:t}){return(0,r.useEffect)((()=>t(e.length>0)),[e,t]),e}function ne(){return(0,l.createElement)(Z,null)}const le=(0,s.A)(f.ui,{target:"e1nmkgzj0"})({name:"1fttcpj",styles:"display:flex;flex-direction:column"});function re({history:e}){return(0,l.createElement)(m.b,{theme:f.$f},(0,l.createElement)(c.Ix,{history:e},(0,l.createElement)(d.HX,{ReactRouterRoute:c.qh},(0,l.createElement)(le,{className:"itsec-tools",variant:f.ls.UNDER_PAGE},(0,l.createElement)(u.SlotFillProvider,null,(0,l.createElement)(p.PluginArea,null),(0,l.createElement)(u.Popover.Slot,null),(0,l.createElement)(g.Nr,null),(0,l.createElement)(c.dO,null,(0,l.createElement)(c.qh,{path:"/export",component:ne}),(0,l.createElement)(c.qh,{path:"/tools",component:ee}),(0,l.createElement)(c.qh,{path:"/"},(0,l.createElement)(c.rd,{to:"/tools"}))))))))}var oe=n(75413);n.p=window.itsecWebpackPublicPath,(0,i.setLocaleData)({"":{}},"ithemes-security-pro");const ae=(0,oe.n)(document.location,{page:"itsec-tools"});a()((()=>{const e=document.getElementById("itsec-tools-root");e&&(0,r.createRoot)(e).render((0,l.createElement)(re,{history:ae}))}))},43345:(e,t,n)=>{"use strict";n.d(t,{bV:()=>g,Ay:()=>P});var l={};n.r(l),n.d(l,{BaseInputTemplate:()=>m,ErrorListTemplate:()=>u,FieldTemplate:()=>b,ObjectFieldTemplate:()=>y,TitleFieldTemplate:()=>w});var r={};n.r(r),n.d(r,{CheckboxWidget:()=>C,CheckboxesWidget:()=>N,IncludeExcludeWidget:()=>T,RadioWidget:()=>j,SelectWidget:()=>O,TextareaWidget:()=>L,ToggleWidget:()=>S});var o={};n.r(o),n.d(o,{EntitySelectField:()=>B,FileTreeField:()=>W,TextareaListField:()=>M});var a=n(66087),i=n(58168),s=n(51609),c=n(39959),d=n(52238);const m=function(e){const{id:t,label:n,value:l,readonly:r,disabled:o,onBlur:m,onFocus:u,options:p,onChange:f,schema:g,uiSchema:h={},...b}=e;p.inputType?b.type=p.inputType:b.type||("number"===g.type?(b.type="number",b.step="any"):"integer"===g.type?(b.type="number",b.step="1"):b.type="text"),p.autocomplete&&(b.autoComplete=p.autocomplete),g.multipleOf&&(b.step=g.multipleOf),void 0!==g.minimum&&(b.min=g.minimum),void 0!==g.maximum&&(b.max=g.maximum);const E=h["ui:description"]||g.description;return(0,s.createElement)(c.TextControl,(0,i.A)({label:n,help:(0,s.createElement)(d.VK,{noWrap:!0,content:E}),readOnly:r,disabled:o,value:l||""},(0,a.omit)(b,["autofocus","formContext","registry","rawErrors","hideLabel","hideError"]),{onChange:e=>f(""===e?p.emptyValue:e),onBlur:m&&(e=>m(b.id,e.target.value)),onFocus:u&&(e=>u(b.id,e.target.value))}))};function u({errors:e}){return(0,s.createElement)(d.VS,{errors:e.map((({stack:e}={})=>e)).filter((e=>!!e))})}var p=n(57936),f=n(3075);function g({name:e,...t}){return(0,s.createElement)(c.Fill,(0,i.A)({name:`RjsfField${e}`},t))}function h({name:e,...t}){return(0,s.createElement)(c.Slot,(0,i.A)({name:`RjsfField${e}`},t))}function b(e){const{children:t,errors:n,hidden:l,schema:r,uiSchema:o,formContext:a,onChange:i}=e;if(l)return null;const{resettable:d}=(0,p.$R)(o);return(0,s.createElement)(E,e,t,(0,s.createElement)(h,{name:e.id,fillProps:e}),d&&(0,s.createElement)(c.Button,{className:"itsec-rjsf-reset-field",variant:"secondary",onClick:()=>i(r.default)},(0,f.__)("Restore Default","better-wp-security")),!0!==a?.disableInlineErrors&&n)}function E(e){const{id:t,classNames:n,disabled:l,label:r,onKeyChange:o,onDropPropertyClick:a,readonly:i,required:d,schema:m,uiSchema:u}=e,f=`${r} Key`,g=m.hasOwnProperty(p.Rr),{removable:h}=(0,p.$R)(u);return g&&!1!==h?(0,s.createElement)("div",{className:n},(0,s.createElement)("div",{className:"row"},(0,s.createElement)("div",{className:"col-xs-5 form-additional"},(0,s.createElement)(c.TextControl,{label:f,required:d,id:`${t}-key`,onBlur:e=>o(e.target.value)})),(0,s.createElement)("div",{className:"form-additional form-group col-xs-5"},e.children),(0,s.createElement)("div",{className:"col-xs-2"},(0,s.createElement)(c.Button,{icon:"no-alt",isDestructive:!0,disabled:l||i,onClick:a(r)})))):(0,s.createElement)("div",{className:n},e.children)}var v=n(8601);function y(e){const{schema:t,uiSchema:n,properties:l,registry:r,title:o,description:a,idSchema:i,required:c}=e;if(!l.length)return null;const m=(0,p.$R)(n),u=(0,p.$F)("TitleFieldTemplate",r,m),f=(0,p.$F)("DescriptionFieldTemplate",r,m),g=(n["ui:sections"]||[]).reduce(((e,n)=>({...e,[n.fields.find((e=>!!t.properties[e]))]:n})),{});return(0,s.createElement)("div",{className:"itsec-rjsf-object-fieldset",id:i.$id},o&&(0,s.createElement)(u,{id:(0,p.EH)(i),title:o,required:c,schema:t,uiSchema:n,registry:r}),a&&(0,s.createElement)(f,{id:(0,p.IR)(i),description:(0,s.createElement)(d.VK,{noWrap:!0,content:e.description}),schema:t,uiSchema:n,registry:r}),l.map((({name:e,content:t})=>g[e]?(0,s.createElement)(v.Fragment,{key:e},(0,s.createElement)("h3",{className:"itsec-rjsf-section-title"},g[e].title),g[e].description&&(0,s.createElement)("p",{className:"itsec-rjsf-section-description"},(0,s.createElement)(d.VK,{noWrap:!0,content:g[e].description})),t):t)),(0,p.Xl)(t,n,e.formData)&&(0,s.createElement)(x,{className:"object-property-expand",onClick:e.onAddClick(t),disabled:e.disabled||e.readonly}))}function x({className:e,onClick:t,disabled:n}){return(0,s.createElement)("div",{className:"row"},(0,s.createElement)("p",{className:`col-xs-3 col-xs-offset-9 text-right ${e}`},(0,s.createElement)(c.Button,{icon:"plus-alt2",className:"btn-add col-xs-12","aria-label":(0,f.__)("Add","better-wp-security"),tabIndex:"0",onClick:t,disabled:n})))}const _="*";function w(e){const{id:t,title:n,required:l}=e;return(0,s.createElement)("span",{className:"itsec-rjsf-title-field",id:t},n,l&&(0,s.createElement)("span",{className:"required"},_))}function S({schema:e,uiSchema:t={},id:n,value:l,disabled:r,readonly:o,label:a,onBlur:i,onFocus:m,onChange:u}){const f=(0,p.l1)(e),g=t["ui:description"]||e.description;return(0,s.createElement)(c.ToggleControl,{checked:l||!1,onChange:u,required:f,disabled:r,readOnly:o,label:a,help:(0,s.createElement)(d.VK,{noWrap:!0,content:g}),onBlur:i&&(e=>i(n,e.target.checked)),onFocus:m&&(e=>m(n,e.target.checked))})}function C({schema:e,uiSchema:t={},id:n,value:l,disabled:r,readonly:o,label:a,onBlur:i,onFocus:m,onChange:u}){const f=(0,p.l1)(e),g=t["ui:description"]||e.description;return(0,s.createElement)(c.CheckboxControl,{checked:l||!1,onChange:u,required:f,disabled:r,readOnly:o,label:a,help:(0,s.createElement)(d.VK,{noWrap:!0,content:g}),onBlur:i&&(e=>i(n,e.target.checked)),onFocus:m&&(e=>m(n,e.target.checked))})}function N(e){const{disabled:t,options:n,value:l,readonly:r,onChange:o,label:a,schema:i,uiSchema:c={}}=e,{enumOptions:m,enumDisabled:u=[],style:p}=n,f=c["ui:description"]||i.description,g=m.map((e=>({...e,disabled:u.includes(e.value),help:e.schema.description&&(0,s.createElement)(d.VK,{noWrap:!0,content:e.schema.description})})));return(0,s.createElement)(d.iI,{value:l||[],onChange:o,options:g,label:a||c["ui:title"]||i.title,help:(0,s.createElement)(d.VK,{noWrap:!0,content:f}),readOnly:r,disabled:t,style:p})}const A=new Set(["number","integer"]);function F(e,t){const{type:n,items:l}=e;if(""===t)return;if("array"===n&&l&&A.has(l.type))return t.map(p.i);if("boolean"===n)return"true"===t;if("number"===n||"integer"===n)return(0,p.i)(t);const r=function(e){return e.enum?e.enum:e.oneOf&&e.oneOf.every((e=>e.enum&&1===e.enum.length))?e.oneOf.map((e=>e.enum[0])):[]}(e);if(r.length>0){if(r.every((e=>"number"===(0,p.A6)(e))))return(0,p.i)(t);if(r.every((e=>"boolean"===(0,p.A6)(e))))return"true"===t}return t}function k(e,t){return t?[].slice.call(e.target.options).filter((e=>e.selected)).map((e=>e.value)):e.target.value}const O=function(e){const{schema:t,uiSchema:n={},id:l,options:r,value:o,label:a,required:i,disabled:m,readonly:u,multiple:p,onChange:f,onBlur:g,onFocus:h,placeholder:b}=e,{enumOptions:E,enumDisabled:v}=r,y=p?[]:"",x=[];p||void 0!==t.default||x.push({value:"",label:b});for(const e of E)x.push({...e,disabled:v&&v.includes(e.value)});const _=n["ui:description"]||t.description;return(0,s.createElement)(c.SelectControl,{multiple:p,options:x,value:void 0===o?y:o,label:a,help:(0,s.createElement)(d.VK,{noWrap:!0,content:_}),required:i,disabled:m,readOnly:u,onChange:e=>f(F(t,e)),onBlur:g&&(e=>g(l,F(t,k(e,p)))),onFocus:h&&(e=>h(l,F(t,k(e,p))))})};function L({schema:e,uiSchema:t={},id:n,value:l,disabled:r,readonly:o,label:m,onBlur:u,onFocus:f,onChange:g,...h}){const b=(0,p.$R)(t),{rows:E,placeholder:v,description:y=e.description}=b;return(0,s.createElement)(c.TextareaControl,(0,i.A)({value:void 0===l?"":l,onChange:g,disabled:r,readOnly:o,label:m,help:(0,s.createElement)(d.VK,{noWrap:!0,content:y}),onBlur:u&&(e=>u(n,e.target.value)),onFocus:f&&(e=>f(n,e.target.value)),rows:E,placeholder:v},(0,a.without)(h,["autofocus","formContext","registry","rawErrors"])))}function j({schema:e,uiSchema:t={},id:n,options:l,value:r,label:o,required:a,disabled:i,readonly:m,onChange:u,onBlur:p,onFocus:f}){const{enumOptions:g}=l,h=t["ui:description"]||e.description;return(0,s.createElement)(c.RadioControl,{selected:r,options:g,label:o,help:(0,s.createElement)(d.VK,{noWrap:!0,content:h}),required:a,disabled:i,readOnly:m,onChange:t=>u(F(e,t)),onBlur:p&&(t=>p(n,F(e,t.target.value))),onFocus:f&&(t=>f(n,F(e,t.target.value)))})}var I=n(11431),R=n(79860);function T({id:e,disabled:t,options:n,value:l,onChange:r,schema:o,autofocus:i,readonly:d}){const{enumOptions:m,enumDisabled:u=[],excludeList:{title:p=(0,f.__)("Excluded","better-wp-security"),description:g=(0,f.__)("The list of items to exclude from the selection.","better-wp-security"),button:h=(0,f.__)("Include","better-wp-security")}={},includeList:{title:b=(0,f.__)("Included","better-wp-security"),description:E=(0,f.__)("The list of items to include in the selection.","better-wp-security"),button:y=(0,f.__)("Exclude","better-wp-security")}={},title:x=o.title,description:_=o.description}=n;(0,v.useEffect)((()=>{const e=m.map((e=>e.value)),t=l.filter((t=>e.includes(t)));t.length!==l.length&&r(t)}),[l,m,r]);const[w,S]=(0,a.partition)(m,(e=>!l.includes(e.value)));return(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget"},x&&(0,s.createElement)(c.BaseControl.VisualLabel,null,x),_&&(0,s.createElement)("p",null,_),(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__sides",id:e},(0,s.createElement)(D,{id:e+"__exclude",options:w,label:p,description:g,button:h,disabled:t||d,disabledOptions:u,autofocus:i,onToggle:e=>{(0,I.speak)((0,f.sprintf)((0,f.__)("Moved %1$s to %2$s.","better-wp-security"),(0,a.find)(w,{value:e}).label,b)),r([...l,e])}}),(0,s.createElement)(D,{id:e+"__include",options:S,label:b,description:E,button:y,disabled:t||d,disabledOptions:u,onToggle:e=>{(0,I.speak)((0,f.sprintf)((0,f.__)("Moved %1$s to %2$s.","better-wp-security"),(0,a.find)(S,{value:e}).label,p)),r(l.filter((t=>t!==e)))}})))}function D({id:e,label:t,description:n,options:l,button:r,onToggle:o,disabled:i,disabledOptions:m=[],autofocus:u}){const p=e+"__option__",[f,g]=(0,v.useState)("");return f&&!(0,a.find)(l,{value:f})&&g(""),(0,s.createElement)("div",{className:"itsec-rjsf-include-exclude-widget__side"},(0,s.createElement)(c.BaseControl,{id:e,help:(0,s.createElement)(d.VK,{noWrap:!0,content:n}),className:"itsec-rjsf-include-exclude-widget__listbox"},(0,s.createElement)("span",{className:"components-base-control__label",id:e+"__label"},t),(0,s.createElement)(d.NL,{role:"listbox",id:e,active:f&&p+f,"aria-labelledby":e+"__label","aria-describedby":n&&e+"__help",onNavigate:e=>g(e.substr(p.length)),onKeyDown:({keyCode:e})=>{if(!f||e!==R.DELETE&&e!==R.BACKSPACE)return;const t=(0,a.findIndex)(l,{value:f}),n=t+1<l.length?t+1:t-1;o(f),g(l[n]?.value||"")},autoFocus:u},l.map((e=>(0,s.createElement)("div",{id:p+e.value,key:e.value,role:i||m.includes(e.value)?"presentation":"option","aria-selected":e.value===f||void 0,onClick:i||m.includes(e.value)?void 0:()=>g(e.value)},e.label))))),(0,s.createElement)(c.Button,{variant:"secondary",disabled:!f,className:"itsec-rjsf-include-exclude-widget__move",onClick:()=>o(f),"aria-keyshortcuts":"Delete Backspace"},r))}var $=n(47926);function B({uiSchema:e,schema:t,idSchema:n,name:l,formData:r,disabled:o,readonly:a,onChange:i}){const c=(0,p.$R)(e);return(0,s.createElement)($.F5,{id:n.$id,value:r,disabled:o,readonly:a,onChange:i,isMultiple:"array"===t.type,label:e["ui:title"]||t.title||l,description:e["ui:description"]||t.description,path:c.path,query:c.query,labelAttr:c.labelAttr,idAttr:c.idAttr,searchArg:c.searchArg})}function M({uiSchema:e,schema:t,name:n,formData:l,disabled:r,readonly:o,onChange:a}){const i=e["ui:title"]||t.title||n,c=e["ui:description"]||t.description,m=(0,p.$R)(e),{rows:u,placeholder:f}=m;return(0,s.createElement)(d.KK,{label:i,help:(0,s.createElement)(d.VK,{noWrap:!0,content:c}),disabled:r,readonly:o,rows:u,value:l,onChange:a,placeholder:f})}var K=n(85631),q=n.n(K),V=n(77172);function W({idSchema:e,formData:t,onChange:n,uiSchema:l,schema:r,name:o,disabled:i,readonly:m,autofocus:u}){const p=e.$id,g=l["ui:title"]||r.title||o,h=l["ui:description"]||r.description,[b,E]=(0,v.useState)([]),[y,x]=(0,v.useState)("");(0,v.useEffect)((()=>{q()({path:(0,V.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:"/"})}).then(E)}),[]);const _=e=>{n(t.includes(e)?t.filter((t=>t!==e)):[...t,e])};return(0,s.createElement)("div",{className:"itsec-rjsf-file-tree"},h&&(0,s.createElement)(d.VK,{content:h,tagName:"p"}),(0,s.createElement)("div",{className:"itsec-rjsf-file-tree__controls"},(0,s.createElement)("div",null,(0,s.createElement)(d.PH,{tree:b,id:p,label:(0,f.__)("File Selector","better-wp-security"),active:y,setActive:x,onActivate:_,onLoad:async e=>{const t=await q()({path:(0,V.addQueryArgs)("/ithemes-security/rpc/file-change/file-tree",{directory:e})}),n=(0,a.cloneDeep)(b);(0,d.Ir)(n,(n=>{if(n.id===e)return n.children=t,d.Ir.halt})),E(n)}}),(0,s.createElement)(c.Button,{variant:"secondary",disabled:!y,className:"itsec-rjsf-file-tree__select",onClick:()=>_(y),"aria-keyshortcuts":"Enter Space"},(0,f.__)("Select","better-wp-security"))),(0,s.createElement)(d.KK,{value:t,onChange:n,className:"itsec-rjsf-file-tree__list",label:g,disabled:i,readonly:m,autoFocus:u})))}const P={templates:l,widgets:r,fields:o,validator:(0,n(62932).iY)()}},46627:e=>{e.exports=function(){return this.itsec.packages.data}()},47406:(e,t,n)=>{"use strict";n.d(t,{A:()=>o});var l=n(51609),r=n(55933);const o=(0,l.createElement)(r.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},(0,l.createElement)(r.Path,{d:"M20 11.2H6.8l3.7-3.7-1-1L3.9 12l5.6 5.5 1-1-3.7-3.7H20z"}))},51609:e=>{"use strict";e.exports=window.React},55933:e=>{e.exports=function(){return this.wp.primitives}()},62247:e=>{e.exports=function(){return this.wp.isShallowEqual}()},66087:e=>{"use strict";e.exports=window.lodash},75413:(e,t,n)=>{"use strict";n.d(t,{n:()=>a});var l=n(17929),r=n(86663),o=n(66087);function a(e,t){const n=(0,l.zR)(),a=n=>{const o="string"==typeof n?(0,l.Rr)(n):n,a=(0,r.parse)(o.search?.substring(1))||{};return{...o,pathname:e.pathname,search:"?"+(0,r.stringify)({...a,path:o.pathname,...t})}};return{get length(){return n.length},get action(){return n.action},get location(){const e=(0,r.parse)(n.location.search.substring(1)),l=e.path||"/";return{...n.location,pathname:l,search:"?"+(0,r.stringify)((0,o.omit)(e,["path",Object.keys(t)]))}},createHref:e=>n.createHref(a(e)),push:(e,t)=>{n.push(a(e),t)},replace:(e,t)=>{n.replace(a(e),t)},go:(...e)=>n.go.apply(n,e),goBack:(...e)=>n.goBack.apply(n,e),goForward:(...e)=>n.goForward.apply(n,e),block:(...e)=>n.block.apply(n,e),listen(e){return n.listen((()=>{e(this.location,this.action)}))}}}},75795:e=>{"use strict";e.exports=window.ReactDOM},76154:e=>{"use strict";e.exports=window.moment},77172:e=>{e.exports=function(){return this.wp.url}()},79860:e=>{e.exports=function(){return this.wp.keycodes}()},85631:e=>{e.exports=function(){return this.wp.apiFetch}()},89897:e=>{e.exports=function(){return this.wp.compose}()},89959:e=>{e.exports=function(){return this.wp.date}()}},e=>{e.O(0,[9427,8356,2038,3733,8363,5152,4887,2932,3520,7926,2238],(()=>e(e.s=40747)));var t=e.O();((window.itsec=window.itsec||{}).pages=window.itsec.pages||{}).tools=t}]);