"use strict";(globalThis.itsecWebpackJsonP=globalThis.itsecWebpackJsonP||[]).push([[2932],{62932:(t,e,r)=>{r.d(e,{Z$:()=>j,Q7:()=>y,AR:()=>b,cM:()=>C,n7:()=>A,pC:()=>S,qD:()=>D,tO:()=>F,TE:()=>R,Cc:()=>I,Ng:()=>P,ZB:()=>M,d7:()=>w,KK:()=>E,Wy:()=>L,dD:()=>k,_t:()=>N,z6:()=>v,_D:()=>x,Mr:()=>W,aZ:()=>O});var s=r(66087),n=r(63282),i=r.n(n),o=r(8601),a=r(77172),c=r(3075),u=r(64467);function h(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function f(t,e,r){return t.set(l(t,e),r),r}function d(t,e){return t.get(l(t,e))}function l(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var g=new WeakMap,p=new WeakMap;class b{constructor(t=void 0,e=void 0,r=void 0){h(this,g,{}),h(this,p,{}),(0,u.A)(this,"add",((t,e,r)=>(d(g,this)[t]||(d(g,this)[t]=[]),d(g,this)[t].push(e),r&&(d(p,this)[t]||(d(p,this)[t]=[]),d(p,this)[t].push(r)),this))),(0,u.A)(this,"hasErrors",(()=>this.getErrorCodes().length>0)),(0,u.A)(this,"getErrorCodes",(()=>Object.keys(d(g,this)))),(0,u.A)(this,"getErrorCode",(()=>this.getErrorCodes()[0])),(0,u.A)(this,"getErrorMessages",((t=void 0)=>{if(t)return d(g,this)[t];const e=[];for(const t in d(g,this))d(g,this).hasOwnProperty(t)&&e.concat(d(g,this)[t]);return e})),(0,u.A)(this,"getErrorMessage",((t=void 0)=>(t=t||this.getErrorCode(),this.getErrorMessages(t)[0]))),(0,u.A)(this,"getErrorData",((t=void 0)=>(t=t||this.getErrorCode(),d(p,this)[t]))),(0,u.A)(this,"getAllErrorMessages",(()=>{const t=[];for(const e in d(g,this))d(g,this).hasOwnProperty(e)&&t.push(...d(g,this)[e]);return t})),t&&(e&&(d(g,this)[t]=[e]),r&&(d(p,this)[t]=r))}static fromPHPObject(t){const e=new b;return f(g,e,t.errors),f(p,e,t.error_data),e}static fromApiError(t){const e=new b;if(d(g,e)[t.code]=[t.message],d(p,e)[t.code]=[t.data],t.additional_errors)for(const r of t.additional_errors)d(g,e)[r.code]=[r.message],r.data&&(d(p,e)||f(p,e,[]),d(p,e)[r.code].push(r.data));return e}}class m extends Error{constructor(t,...e){super(t.message||(0,c.__)("An unknown error occurred.","better-wp-security"),...e),Error.captureStackTrace&&Error.captureStackTrace(this,m),this.__response=t;for(const e in t)t.hasOwnProperty(e)&&Object.defineProperty(this,e,{value:t[e],configurable:!0,enumerable:!0,writable:!0})}toString(){return this.__response.toString()}getResponse(){return this.__response}}class y{constructor(t,e,r,s=[],n=[],i=[]){(0,u.A)(this,"type",void 0),(0,u.A)(this,"error",void 0),(0,u.A)(this,"data",void 0),(0,u.A)(this,"success",void 0),(0,u.A)(this,"info",void 0),(0,u.A)(this,"warning",void 0),this.type=t,this.error=e,this.data=r,this.success=s,this.info=n,this.warning=i,Object.seal(this)}isSuccess(){return this.type===y.SUCCESS}static async fromResponse(t){const e=e=>{const r=t.headers?.get(`X-Messages-${e}`);return r?JSON.parse(r):[]},r=204!==t.status&&t.json?await t.json():null,s=A(r),n=s.hasErrors()?y.ERROR:y.SUCCESS,i=e("Success"),o=e("Info"),a=e("Warning");return new y(n,s,r,i,o,a)}}Object.defineProperty(y,"SUCCESS",{value:"success",writable:!1,enumerable:!1,configurable:!1}),Object.defineProperty(y,"ERROR",{value:"error",writable:!1,enumerable:!1,configurable:!1});const _=(0,o.createContext)({getUrl(t,e){t="settings"===t?"itsec":"itsec-"+t;const r=(0,a.removeQueryArgs)(document.location.href,...Object.keys((0,a.getQueryArgs)(document.location.href)));return(0,a.addQueryArgs)(r,e?{page:t,path:e}:{page:t})}});function O(t,e){const{getUrl:r}=(0,o.useContext)(_);return r(t,e)}function v(t){if(t<=999)return t.toString();if(t<=9999){const e=(t/1e3).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","k"):`${e}k`}if(t<=99999)return t.toString().substring(0,2)+"k";if(t<=999999)return t.toString().substring(0,3)+"k";if(t<=9999999){const e=(t/1e6).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","m"):`${e}m`}if(t<=99999999)return t.toString().substring(0,2)+"m";if(t<=999999999)return t.toString().substring(0,3)+"m";if(t<=9999999999){const e=(t/1e9).toFixed(1);return"0"===e.charAt(e.length-1)?e.replace(".0","b"):`${e}b`}return t}function E(t){if(!(0,s.isPlainObject)(t))return!1;const e=Object.keys(t);return 2===e.length&&e.includes("errors")&&e.includes("error_data")}function w(t){if(!(0,s.isPlainObject)(t))return!1;const e=Object.keys(t);return(3===e.length||4===e.length)&&!(4===e.length&&!e.includes("additional_errors"))&&e.includes("code")&&e.includes("message")&&e.includes("data")}function A(t){return t instanceof b?t:E(t)?b.fromPHPObject(t):w(t)?b.fromApiError(t):new b}function S(t){const e={};for(const[r,s]of t)e[r]=s;return e}function C(t,e){const r=[[],[]];for(const s of t)r[e(s)?0:1].push(s);return r}function k(t){if(t instanceof Error)throw t;throw new m(t)}const j="https://secure.gravatar.com/avatar/d7a973c7dab26985da5f961be7b74480?s=96&d=mm&f=y&r=g";function M(t,e,r=!0){return(0,s.get)(t,["_links","self",0,"targetHints",e],r?void 0:[])}function P(t){return R(t,"self")}function N(t){const e=t.indexOf("/ithemes-security/");if(-1!==e)return t.substring(e)}function R(t,e){return(0,s.get)(t,["_links",e,0,"href"])}function I(t,e){if(t&&t.links)for(const r of t.links)if(r.rel===e)return r}function L(t,e){if("object"!==t.type)return t;let r;for(const n in e)e.hasOwnProperty(n)&&"hidden"===e[n]["ui:widget"]&&(r||(r=(0,s.cloneDeep)(t)),delete r.properties[n]);return r||t}function W(t){let e=[];if(!t)return e;const r=t instanceof b?t:A((0,s.pick)(t,["code","message","data"]));return"rest_invalid_param"===r.getErrorCode()&&(e=Object.values(r.getErrorData().params)),[...r.getAllErrorMessages(),...e]}function x(t){const e=new Date;if(t>e)return(0,c.__)("Online Recently","better-wp-security");const r=Math.floor((e-t)/1e3);let s=r/31536e3;return s>1?(0,c.sprintf)((0,c.__)("%s years","better-wp-security"),Math.floor(s)):(s=r/2592e3,s>1?(0,c.sprintf)((0,c.__)("%s months","better-wp-security"),Math.floor(s)):(s=r/86400,s>1?(0,c.sprintf)((0,c.__)("%s days","better-wp-security"),Math.floor(s)):(s=r/3600,s>1?(0,c.sprintf)((0,c.__)("%s hours","better-wp-security"),Math.floor(s)):(s=r/60,s>1?(0,c.sprintf)((0,c.__)("%s minutes","better-wp-security"),Math.floor(s)):(0,c.sprintf)((0,c.__)("%s seconds","better-wp-security"),Math.floor(s))))))}function D(){return D.instance||(D.instance=new(i())({strict:!1}),D.instance.addFormat("html",{type:"string",validate:()=>!0}),D.instance.addFormat("relative-file-path",{type:"string",validate:t=>!t.includes("../")}),D.instance.addFormat("file-path",{type:"string",validate:t=>!!t.startsWith("/")&&!t.includes("../")}),D.instance.addFormat("directory",{type:"string",validate:t=>!!t.startsWith("/")&&!t.includes("../")})),D.instance}function F(t){if(!t)return"";const e=t.toUpperCase().split("").map((t=>127397+t.charCodeAt()));return String.fromCodePoint(...e)}}}]);